/* @preserve 20191214 */
if("undefined"!=typeof sendNSCommand){PJF.constants.logDebug&&(console.log=function(t){try{sendNSCommand("logJs",t)}catch(e){}}),console.info=function(t){try{sendNSCommand("logJs",t)}catch(e){}};var handleError=function(t,e,i){return sendNSCommand("logError",t,e,i),!1};window.onerror=handleError}!function(){var o="blue",a={};function s(t){var e=document.head||document.getElementsByTagName("head")[0];e&&e.appendChild(t)}!function(t){if(!t){if("undefined"==typeof sendNSCommand)return;var e=sendNSCommand("getClientEnv","skinName");"0"==e[0]&&(t=e[1])}if(t&&t!==o)if(a[t]){for(var t in a)a[t].disabled=!0;a[t].disabled=!1}else{var i=document.createElement("link"),n=window.CONTEXT_PATH+"css/pjf-";i.rel="stylesheet",i.type="text/css",i.href=n+t+".css",s(a[t]=i)}}();var t="CN000";if("undefined"!=typeof sendNSCommand){var e=sendNSCommand("getClientEnv","curOrg.instSvrlLgPsnID");"0"==e[0]&&(t=e[1])}
for(var i=new RegExp("<style.*psnId\\s*=\\s*[\"']"+t+"[\"'][^>]*>([\\s\\S]*?)</style>","g"),n=function(){
/*@preserve
    <!-- DC002 韩文webkit乱码问题(按理别的可能也有) -->
    <style psnId = "DC002">
    .datagrid-body table div {
      font-family: Arial, Helvetica, sans-serif;
    }
    .pjf_table_div table td {
      font-family: Arial, Helvetica, sans-serif;
    }
    </style>
  */}.toString(),r="",c=i.exec(n);c;)r+=c[1],c=i.exec(n);var l=document.createElement("style");l.type="text/css",l.styleSheet?l.styleSheet.cssText=r:l.appendChild(document.createTextNode(r)),s(l)}(),function($){var reEscape=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g");function fnFormatResult(t,e,i){i.replace(reEscape,"\\$1");return t}function Autocomplete(t,e){this.el=$(t),this.el.attr("autocomplete","off"),this.suggestions=[],this.data=[],this.disabled=!1,this.enabled=!0,this.readonly=!1,this.badQueries=[],this.selectedIndex=-1,this.selectedIndexCopy=-1,this.currentValue=this.el.val(),this.intervalId=0,this.intervalId1=0,this.intervalId2=0,this.cachedResponse=[],this.onChangeInterval=null,this.ignoreValueChange=!1,this.url=e.url,this.isLocal=!1,this.options={autoSubmit:!1,minChars:1,maxHeight:300,maxLength:Number.MAX_VALUE,input:null,deferRequestBy:0,width:0,blankAjax:null,highlight:!0,params:{},fnFormatResult:fnFormatResult,
delimiter:null,zIndex:9999,name:null,spanId:null,inputId:null,lookup:null,id:null,blur:null,focus:null,onChange:null,required:!1,missingMessage:resource.DEFAULT_MISSINGMESSAGE,defaultValue:null,autoCheck:!0,queryName:null,cpsReq:null,count:null,formatter:null,storeData:null,isAuto:!1,queryNameToJsonData:!1,ajaxParam:null,focusSelectAll:!0,ignoreSpace:!1,noFilter:!1,triggerFocus:!1,helpTip:!1,fenciFlag:!0,enterFirst:!1,fuzzyFlag:!0},this.params=e,this.setOptions(e),this.initialize()}$.fn.autocomplete=function(t,e){var i=this.data("autocomplete");return"string"!=typeof t?(null!=i&&i.destroy(this),i=new Autocomplete(this.get(0)||$("<input />"),t),this.data("autocomplete",i),i):"function"==typeof i[t]?i[t](e,arguments[2]):void 0},Autocomplete.prototype={killerFn:null,searchkey:null,initialize:function(){var me,uid,autocompleteElId;me=this,this.el.siblings("input:hidden").each(function(){me.options.name&&$(this).attr("name")==me.options.name&&$(this).remove()}),
this.options.inputId||(this.options.inputId=(new Date).getTime()+"_"+Math.floor(1048576*Math.random()).toString(16)),this.options.helpId||(this.options.helpId=(new Date).getTime()+"_"+Math.floor(1048576*Math.random()).toString(16)),this.el.attr("autocompleteId",this.params.autocompleteid),this.options.input=new PJF.ui.textfield({dom:this.el.attr("id"),required:this.options.required,missingMessage:this.options.missingMessage,requireTrim:this.options.requireTrim,focusSelectAll:!1}),me.container=null,this.el.removeAttr("error"),this.options.width?$(this.el).css("width",me.options.width):this.options.width=this.el.width();var offset=$(this.el).offset(),name=this.options.name;null==name?$("<input type='hidden' id='"+this.options.inputId+"'/>").insertAfter(this.el):$("<input type='hidden' name='"+name+"' id='"+this.options.inputId+"'/>").insertAfter(this.el),!0===me.options.helpTip&&($('<span id="'+me.options.helpId+'"></span>').insertAfter(this.el),me.helpTip=new PJF.ui.helpTip({
dom:me.options.helpId,helpMessage:me.options.helpMessage})),uid=(new Date).getTime()+"_"+Math.floor(1048576*Math.random()).toString(16),autocompleteElId="Autocomplete_"+uid,this.killerFn=function(t){0===$(t.target).parents(".autocomplete").size()&&$(t.target).attr("id")!=me.el.attr("id")&&(me.killSuggestions(),me.disableKillerFn())},window.opera?this.el.keypress(function(t){me.onKeyPress(t,PJF.constants.KEYBOARD_ENABLE)}):(this.el.unbind("keydown"),this.el.keydown(function(t){me.onKeyPress(t,PJF.constants.KEYBOARD_ENABLE)})),me.options.blankAjax?this.el.keyup(function(e){me.disabled||me.el.hasClass("pjf_readonly_input")||(window.clearInterval(me.intervalId2),me.intervalId2=window.setInterval(function(){var currentSearchKey=me.el.val();if(currentSearchKey=me.fnBeforeRequest(currentSearchKey),""!=currentSearchKey&&currentSearchKey!=me.searchkey){if(me.searchkey=currentSearchKey,me.options.blankAjax.data[me.options.queryName]=currentSearchKey,me.options.queryNameToJsonData){
me.options.blankAjax.data.jsonData=me.options.blankAjax.data.jsonData?me.options.blankAjax.data.jsonData:"{}";var tmpJsonData=eval("("+me.options.blankAjax.data.jsonData+")");tmpJsonData[me.options.queryName]=currentSearchKey,me.options.blankAjax.data.jsonData=PJF.util.json2str(tmpJsonData)}var reqParams={success:function(t){var e=[];e=me.options.blankAjax.convertData?me.options.blankAjax.convertData(t):t,me.options.lookup={suggestions:e,data:[]},"boolean"!=typeof me.options.isAdapt||me.options.isAdapt?me.onValueChange():me.getSuggestions(""),window.clearInterval(me.intervalId2)},failure:function(t){"function"==typeof me.options.fnFailure&&me.options.fnFailure(t),me.options.lookup={suggestions:[],data:[]},window.clearInterval(me.intervalId2)}};$.extend(reqParams,me.options.blankAjax),PJF.communication.ajax(reqParams)}},300))}):this.el.keyup(function(e){if(!me.disabled&&!me.el.hasClass("pjf_readonly_input")){if(me.options.cpsReq){var value=$(this).val()
;null==me.options.count&&(me.options.count=2),(!me.options.ignoreSpace||" "==value[value.length-1])&&$.trim(value).length>=me.options.count&&32==e.keyCode&&38!=e.keyCode&&40!=e.keyCode?(me.options.params[me.options.queryName]=me.fnBeforeRequest($.trim(value)),me.el.val($.trim(value)),PJF.communication.cpsJsonReq({fwServiceId:me.options.cpsReq.fwServiceId,fwTranId:me.options.cpsReq.fwTranId,jsonData:PJF.util.json2str(me.options.params),sqlId:me.options.cpsReq.sqlId,success:function(t){if(me.options.storeData=null,me.options.storeData=t,me.options.cpsReq.convertData){var e=me.options.cpsReq.convertData(t);me.options.lookup=null,me.options.lookup={suggestions:e,data:[]},me.el.trigger("focus")}else me.options.lookup=null,me.options.lookup={suggestions:t,data:[]},me.el.trigger("focus")},failure:function(t){"function"==typeof me.options.fnFailure&&me.options.fnFailure(t),me.options.lookup={suggestions:[],data:[]}}}),
me.onValueChange()):$.trim(value).length<me.el.val().length&&me.el.val($.trim(value))}if(me.options.ajaxParam){var value=$(this).val();if(null==me.options.count&&(me.options.count=2),(!me.options.ignoreSpace||" "==value[value.length-1])&&$.trim(value).length>=me.options.count&&32==e.keyCode&&38!=e.keyCode&&40!=e.keyCode){if(me.options.ajaxParam.data[me.options.queryName]=me.fnBeforeRequest($.trim(value)),me.options.queryNameToJsonData){me.options.ajaxParam.data.jsonData=me.options.ajaxParam.data.jsonData?me.options.ajaxParam.data.jsonData:"{}";var tmpJsonData=eval("("+me.options.ajaxParam.data.jsonData+")");tmpJsonData[me.options.queryName]=me.fnBeforeRequest($.trim(value)),me.options.ajaxParam.data.jsonData=PJF.util.json2str(tmpJsonData)}me.el.val($.trim(value));var setting={success:function(t){if(me.options.storeData=t,me.options.ajaxParam.convertData){var e=me.options.ajaxParam.convertData(t);me.options.lookup=null,me.options.lookup={suggestions:e,data:[]},me.el.trigger("focus")
}else me.options.lookup=null,me.options.lookup={suggestions:t,data:[]},me.el.trigger("focus")},failure:function(t){"function"==typeof me.options.fnFailure&&me.options.fnFailure(t),me.options.lookup={suggestions:[],data:[]}}};$.extend(setting,me.options.ajaxParam),PJF.communication.ajax(setting),me.onValueChange()}else $.trim(value).length<me.el.val().length&&me.el.val($.trim(value))}me.onKeyUp(e),me.fixPosition()}}),this.el.blur(function(){me.disabled||me.el.hasClass("pjf_readonly_input")||(me.enableKillerFn(),"function"==typeof me.options.blur&&me.options.blur(),me.selectedIndexCopy=-1)}),this.el.click(function(t,e){me.mainContainerId||(me.mainContainerId="AutocompleteContainter_"+uid,$('<div id="'+me.mainContainerId+'" style="position:absolute;z-index:9999;"><div class="autocomplete-w1"><div class="autocomplete" id="'+autocompleteElId+'" style="display:none; min-height:0%"></div></div></div>').appendTo("body"),me.container=$("#"+autocompleteElId),$("#"+me.mainContainerId).css({
zIndex:me.options.zIndex}),me.fixPosition()),me.disabled||me.el.hasClass("pjf_readonly_input")&&!me.options.triggerFocus||("function"==typeof me.options.focus&&me.options.focus(),me.onValueChange(),e&&($("#"+me.mainContainerId).hide(),me.el.trigger("blur")),me.fixPosition())}),this.el.focus(function(t,e){me.el.trigger("click",e)}),this.el.change(function(){me.disabled||me.el.hasClass("pjf_readonly_input")||me.fixPosition()}),this.options.defaultValue&&!this.url&&this.setDefaultValue(this.options.defaultValue)},setHelpTip:function(t,e){var i=this;if(!1===e)i.helpTip&&i.helpTip.destroy(),i.helpTip=null;else if(i.helpTip)i.helpTip.setHelpMsg(t);else{var n=PJF.util.generateUUid();$('<span id="'+n+'"></span>').insertAfter(i.el),i.helpTip=new PJF.ui.helpTip({dom:n,helpMessage:t})}},fnBeforeRequest:function(t){var e=t;if("function"==typeof this.options.beforeRequest){var i=this.options.beforeRequest(t);void 0!==i&&(e=i)}return e},extendOptions:function(t){$.extend(this.options,t)},
setOptions:function(t){var e=this.options,i=this;if(this.extendOptions(t),e.lookup)if(this.isLocal=!0,$.isArray(e.lookup)&&0<e.lookup.length){if(e.lookup[0].key==undefined)for(var n=0;n<e.lookup.length;n++){var o=new Object;o.key=e.lookup[n],o.value=e.lookup[n],e.lookup[n]=o}e.lookup={suggestions:e.lookup,data:[]}}else e.lookup={suggestions:[],data:[]};(e.cpsReq||e.blankAjax||e.ajaxParam)&&(this.isLocal=!0,e.lookup={suggestions:[],data:[]}),this.url&&(i.isLocal=!0,$.ajax({url:i.url,type:"get",dataType:"json",data:i.options.params,success:function(t){if(i.options.formatter){var e=i.options.formatter(t);i.options.lookup={suggestions:e,data:[]}}else i.options.lookup={suggestions:t,data:[]};null!=i.options.defaultValue&&i.setDefaultValue(i.options.defaultValue)},failure:function(){i.options.lookup={suggestions:[],data:[]}}}))},clearCache:function(){this.cachedResponse=[],this.badQueries=[]},disable:function(){this.disabled=!0,
this.el.attr("disabled","disabled").addClass("pjf_disabled_input")},enable:function(){this.disabled=!1,this.el.removeAttr("disabled","disabled").removeClass("pjf_disabled_input")},isDisabled:function(){return this.disabled},isDisplay:function(){return"none"!=this.el.css("display")},fixPosition:function(){var t=this.el.offset(),e=this;this.container.removeClass("autocomplete").addClass("autocomplete1");var i=this.container.height();this.container.width();i>=e.options.maxHeight?(this.container.css({maxHeight:e.options.maxHeight+"px","overflow-y":"auto"}),$.browser.msie&&$.browser.version<"7"&&this.container.css({height:e.options.maxHeight+"px","overflow-y":"auto"})):this.container.css({"overflow-y":"hidden"}),this.container.css("width",e.options.width+"px"),$.browser.msie&&$.browser.version<"8.0"&&this.container.css({"padding-bottom":"17px"}),$("#"+this.mainContainerId).css({top:t.top+this.el.innerHeight()+2+"px",left:t.left+"px"}),
e.intervalId1||(e.intervalId1=window.setInterval(function(){if("block"==e.container.css("display")){var t=e.el.offset();$("#"+e.mainContainerId).css({top:t.top+e.el.innerHeight()+2+"px",left:t.left+"px"})}},300)),e.options.containerWidth&&e.container.css({width:e.options.containerWidth+"px"})},setParam:function(t){$.extend(this.options.params,t)},setRequired:function(t){(this.options.required=t)?$("#"+this.options.id).addClass("validatebox-invalid invalid_box"):($("#"+this.options.id).removeClass("validatebox-invalid invalid_box validatebox-tipcolor"),$("#"+this.options.id).parent().find(".errorbox_ipt_help").remove(),$("#"+this.options.id).css("border-color","#C5C5C5")),this.options.input.setRequired(t)},getSelectValue:function(){return $("#"+this.options.inputId).val()},getSelectText:function(){return $(this.el).val()},setObject:function(t){$(this.el).val(t.value),$("#"+this.options.inputId).val(t.key),this.options.required&&($(this.el).addClass("validatebox-invalid"),
$(this.el).removeAttr("error"),this.el.siblings("div.errorbox_ipt_help").remove(),this.el.removeClass("validatebox-tipcolor error-border").css("border","1px solid #C5C5C5"))},setReadOnly:function(t){t?($(this.el).attr("readonly","readonly").addClass("pjf_readonly_input"),this.readonly=!0):($(this.el).removeAttr("readonly","readonly").removeClass("pjf_readonly_input"),this.readonly=!1)},isReadOnly:function(){return this.readonly},setDefaultValue:function(t,e){var i,n=this,o=-1;$("#"+this.options.inputId).val(t);for(var a=!1,s=n.getSuggestionsLocal("").suggestions,r=0;r<s.length;r++){var c=s[r];t==c.key&&($(n.el).val(c.value),a=!0,o=r,i=c)}var l=n.el;if(n.options.required&&e&&(""==t||null==t?l.addClass("validatebox-invalid"):l.checkTip({show:function(){return!0}})),a?n.options.required&&(n.el.removeAttr("error"),n.el.siblings("div.errorbox_ipt_help").remove(),n.el.removeClass("validatebox-tipcolor error-border")):($(n.el).val(""),$("#"+this.options.inputId).val("")),
n.options.triggerChange&&-1<o&&i){var d=n.options.onChange,u=n.options.storeData;$.isFunction(d)&&d(u,i)}},clearValue:function(){$("#"+this.options.inputId).val(""),this.el.val(""),this.ignoreValueChange=!1},addOptions:function(t){var e=this.options;if(e.lookup||e.isLocal){this.isLocal=!0;var i=e.lookup.suggestions.concat(t);e.lookup.suggestions=i}else{this.isLocal=!0,e.lookup={suggestions:[],data:[]};i=e.lookup.suggestions.concat(t);e.lookup.suggestions=i}},removeOptions:function(t){for(var e=this.options.lookup.suggestions,i=e.length-1;0<=i;i--)for(var n=0;n<t.length;n++)e[i].key==t[n]&&this.options.lookup.suggestions.splice(i,1)},removeAll:function(){this.options.lookup&&(this.options.lookup.suggestions=[])},enableKillerFn:function(){var t=this;$(document).bind("click",t.killerFn);var e=$.trim(this.el.val());if(""==e||null==e){var i=$("#"+this.options.inputId).val();$("#"+this.options.inputId).val(""),i&&t.options.onChange&&t.options.onChange(t.options.storeData,{})
}else if(null!=e&&""!=e){for(var n=!1,o=t.getSuggestionsLocal("").suggestions,a=$("#"+t.options.inputId).val(),s=0;s<o.length;s++){if(e==(l=o[s]).value&&a==l.key){n=!0;var r=$("#"+t.options.inputId).val();$("#"+t.options.inputId).val(l.key),t.el.removeAttr("error"),r!=l.key&&t.options.onChange&&t.options.onChange(t.options.storeData,l);break}}if(n&&t.options.required&&t.el.siblings("div.errorbox_ipt_help").remove(),!n&&t.options.autoCheck){r=$("#"+t.options.inputId).val();var c=t.el;$("#"+t.options.inputId).val(""),t.options.required&&t.el.checkTip({show:function(){return!1},Message:t.options.missingMessage}),""!=r&&t.options.onChange&&t.options.onChange(t.options.storeData,{})}if(!n&&!t.options.autoCheck){r=$("#"+t.options.inputId).val();$("#"+t.options.inputId).val($.trim(t.el.val()));var l,d=$("#"+t.options.inputId).val();c=t.el;if(t.options.required&&(""==d||null==d?c.checkTip({show:function(){return!1},Message:t.options.missingMessage}):c.checkTip({show:function(){return!0}})),
""!=d&&null!=d&&t.el.parent().find(".errorbox_ipt_help").remove(),r!=t.el.val())(l={}).key=t.el.val(),l.value=t.el.val(),t.options.onChange&&t.options.onChange(t.options.storeDate,{key:d,value:d})}}},disableKillerFn:function(){$(document).unbind("click",this.killerFn)},killSuggestions:function(){var t=this;this.stopKillSuggestions(),this.intervalId=window.setInterval(function(){t.hide(),t.stopKillSuggestions()},300)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},onValueChanged:function(){this.change(this.selectedIndex)},onKeyPress:function(t,e){var i=this;if(!this.disabled&&this.enabled&&!this.el.hasClass("pjf_readonly_input")){switch(t.keyCode){case 27:this.el.val(this.currentValue),this.hide();break;case 9:if(KEYBOARD_NEW_ENABLE)if(this.container&&"block"==this.container.css("display"))this.select(this.selectedIndexCopy),this.selectedIndexCopy=-1,PJF.ui.componentMgr.getNextComp(i).focus();else PJF.ui.componentMgr.getNextComp(i).focus();break;case 107:
this.container&&i.onValueChange();break;case 13:if(-1===this.selectedIndexCopy){var n=this.options.lookup?this.options.lookup.suggestions:this.options.lookup;$.isArray(n)&&0<n.length&&!0===this.options.enterFirst?(this.onValueChange(),this.select(0)):this.hide()}if(e){if(this.container&&"block"==this.container.css("display"))this.select(this.selectedIndexCopy),this.selectedIndexCopy=-1,PJF.ui.componentMgr.getNextComp(i).focus();else PJF.ui.componentMgr.getNextComp(i).focus()}else{if(-1===this.selectedIndexCopy)return void this.hide();this.select(this.selectedIndexCopy)}break;case 38:if(e)if(this.container&&"block"==this.container.css("display"))if(-1<i.selectedIndexCopy)this.moveUp();else PJF.ui.componentMgr.getPreviousComp(i).focus(),this.container&&this.container.hide();else PJF.ui.componentMgr.getPreviousComp(i).focus(),this.container&&this.container.hide();else this.moveUp();break;case 40:
if(e)if(this.container&&"block"==this.container.css("display"))this.moveDown();else PJF.ui.componentMgr.getNextComp(i).focus(),this.container&&this.container.hide();else this.moveDown();break;default:return}t.stopImmediatePropagation(),t.preventDefault()}},onKeyUp:function(t){if(!this.disabled&&!this.el.hasClass("pjf_readonly_input")){switch(t.keyCode){case 38:case 40:return}if(clearInterval(this.onChangeInterval),this.currentValue!==this.el.val())if(0<this.options.deferRequestBy){var e=this;this.onChangeInterval=setInterval(function(){e.onValueChange()},this.options.deferRequestBy)}else this.onValueChange()}},onValueChange:function(){clearInterval(this.onChangeInterval),this.currentValue=this.el.val();var t=this.getQuery(this.currentValue);this.selectedIndex=-1,this.ignoreValueChange?this.ignoreValueChange=!1:(""===t||(t.length,this.options.minChars),this.getSuggestions(t))},getQuery:function(t){var e,i;return(e=this.options.delimiter)?(i=t.split(e),$.trim(i[i.length-1])):$.trim(t)},
getSuggestionsLocal:function(t){var e,i,n,o;if(this.options.noFilter&&(t=""),n=(i=this.options.lookup)&&i.suggestions.length,e={suggestions:[],data:[]},""===t){for(h=0;h<n;h++)o=i.suggestions[h],e.suggestions.push(o),e.data.push(i.data[h]);return e}t=t.toLowerCase();var a=[];if(!0!==this.options.fenciFlag||this.options.fuzzyFlag)for(var s=0;s<t.length;s++)a.push(t.charAt(s));else if(PJF.communication.client.isInP2()){var r=PJF.communication.client.doCommonCommand("FenciCommandHandler",t);if(0==r[0]&&1<r.length)for(var c=1;c<r.length;c++)a.push(r[c]);else a.push(t)}else a.push(t);for(var l={suggestions:i.suggestions,data:i.data},d=0;d<a.length;d++){for(var u={suggestions:[],data:[]},h=0;h<l.suggestions.length;h++){var p=(o=l.suggestions[h]).value.toLowerCase().indexOf(a[d],o.lastIndex?o.lastIndex+1:0);0<=p&&(o.lastIndex=p,u.suggestions.push(o),u.data.push(l.data[h]))}l=u}for(h=0;h<i.suggestions.length;h++)delete i.suggestions[h].lastIndex;return l},getSuggestions:function(t){var e,i
;(e=this.isLocal?this.getSuggestionsLocal(t):this.cachedResponse[t])&&$.isArray(e.suggestions)?(this.suggestions=e.suggestions,this.data=e.data,this.suggest()):this.isBadQuery(t)||((i=this).options.params.query=t,$.ajax({type:"get",url:this.url,data:this.options.queryName+"="+t,success:function(t){i.processResponse(t)}}))},isBadQuery:function(t){for(var e=this.badQueries.length;e--;)if(0===t.indexOf(this.badQueries[e]))return!0;return!1},hide:function(){this.selectedIndex=-1,clearInterval(this.intervalId1),this.intervalId1=0,this.container&&this.container.hide()},hideDiv:function(){this.container&&this.container.css("display","none")},suggest:function(){if($.isArray(this.suggestions)&&0!==this.suggestions.length){var i,t,e,n,o,a;t=(i=this).suggestions.length,e=this.options.fnFormatResult,n=this.getQuery(this.currentValue),this.container.hide().empty();var s=""
;for(o=0;o<t&&o<this.options.maxLength;o++)s+='<div  value="'+(a=this.suggestions[o]).key+'" index="'+o+'">'+e(a.value,this.data[o],n)+"</div>";this.container.append(s),this.container.children("div").bind("mouseover",function(t){var e=$(t.target).attr("index");e&&i.activate(e)}).bind("click",function(t){var e=$(t.target).attr("index");e&&i.select(e)}),this.enabled=!0,this.container.show(),$("#"+i.mainContainerId).show(),i.selectedIndex=-1,i.selectedIndexCopy=-1}else this.hide()},processResponse:function(t){this.suggestions=t,this.data=[],this.suggest()},activate:function(t){var e,i;return e=this.container.children(),-1!==this.selectedIndex&&e.length>this.selectedIndex&&$(e.get(this.selectedIndex)).removeClass(),this.selectedIndex=t,-1!==this.selectedIndex&&e.length>this.selectedIndex&&(i=e.get(this.selectedIndex),$(i).addClass("selected")),i},deactivate:function(t,e){t.className="",this.selectedIndex===e&&(this.selectedIndex=-1)},select:function(t){var e=this,i=this.suggestions[t]
;if(i){this.el.val();if(this.el.val(i.value),this.options.autoSubmit){var n=this.el.parents("form");0<n.length&&n.get(0).submit()}this.ignoreValueChange=!0,this.hide();var o=$("#"+e.options.inputId).val();$("#"+e.options.inputId).val(i.key);var a=$("#"+e.options.inputId).val(),s=this.el;""==a||null==a?s.checkTip({show:function(){return!1},Message:e.options.missingMessage}):s.checkTip({show:function(){return!0}}),""!=a&&null!=a&&e.el.parent().find(".errorbox_ipt_help").remove();var r=e.options.onChange,c=e.options.storeData;$.isFunction(r)&&o!=i.key&&r(c,i)}},change:function(t){var e,i,n;if(e=(n=this).suggestions[t])o=n.suggestions[t],a=n.data[t],n.el.val(n.getValue(o));else if("1"===e){var o,a;o=n.su}else o="",a=-1;i=n.options.onChange,$.isFunction(i)&&i(o,a)},scrollPosition:function(t){var e=this.container;e.scrollLeft(1);var i=e.scrollLeft();e.scrollLeft(0);var n=e.height()-(0<i?17:0),o=parseInt(e.scrollTop()/27),a=parseInt(n/27)
;if(this.selectedIndexCopy+1<=o+1||this.selectedIndexCopy+1>o+a){var s=0;"up"==t&&(s=27*this.selectedIndexCopy),"down"==t&&(s=27-n%27+27*(this.selectedIndexCopy-a)),e.scrollTop(s)}},moveUp:function(){var t=this.container.children();0!=this.selectedIndexCopy&&(this.selectedIndexCopy-=1),$(t.get(this.selectedIndexCopy)).addClass("selected"),$(t.get(this.selectedIndexCopy+1)).removeClass("selected"),this.scrollPosition("up")},moveDown:function(){var t=this.suggestions.length,e=this.container.children();this.selectedIndexCopy<t-1?(this.selectedIndexCopy!=t-1&&(this.selectedIndexCopy+=1),$(e.get(this.selectedIndexCopy)).addClass("selected"),0<=this.selectedIndexCopy-1&&$(e.get(this.selectedIndexCopy-1)).removeClass("selected")):$(e.get(t-1)).addClass("selected"),this.scrollPosition("down")},adjustScroll:function(t){var e,i,n;e=this.activate(t).offsetTop,n=(i=this.container.scrollTop())+this.options.maxHeight-25,
e<i?this.container.scrollTop(e):n<e&&this.container.scrollTop(e-this.options.maxHeight+25),this.options.isAuto&&this.el.val(this.getValue(this.suggestions[t]))},getValue:function(t){var e,i,n;return(e=this.options.delimiter)?1===(n=(i=this.currentValue).split(e)).length?t.value:i.substr(0,i.length-n[n.length-1].length)+t:t.value},destroy:function(t){$("#"+this.mainContainerId).remove(),t.unbind(),$.removeData(t[0])},newDestroy:function(t){this.options.input.destroy(),$("#"+this.mainContainerId).remove(),t.unbind(),$.removeData(t[0])},onBlur:function(){this.el.trigger("blur")},onFocus:function(){this.el.trigger("focus")},focus:function(){this.el.trigger("focus"),this.container&&this.container.hide(),this.options.focusSelectAll&&(this.el[0].selectionStart=0,this.el[0].selectionEnd=99999)}}}(jQuery),function(a){function s(t,e){var i=a.data(t,"pjfdatebox"),n=i.options;a(t).combo("setValue",e).combo("setText",e),i.calendar.calendar("moveTo",n.parser(e))}a.fn.pjfdatebox=function(e,t){
if("string"==typeof e){var i=a.fn.pjfdatebox.methods[e];return i?i(this,t):this.combo(e,t)}return e=e||{},this.each(function(){var i,n,o,t=a.data(this,"pjfdatebox");t?a.extend(t.options,e):a.data(this,"pjfdatebox",{options:a.extend({},a.fn.pjfdatebox.defaults,a.fn.pjfdatebox.parseOptions(this),e)}),i=this,n=a.data(i,"pjfdatebox"),o=n.options,a(i).addClass("datebox-f"),a(i).combo(a.extend({},o,{onShowPanel:function(){n.calendar.calendar("resize"),o.onShowPanel.call(i)}})),a(i).combo("textbox").parent().addClass("datebox"),a(i).combo("textbox").parent()[0].id="span_datebox",n.calendar||function(){var t=a(i).combo("panel");n.calendar=a("<div></div>").appendTo(t).wrap('<div class="datebox-calendar-inner"></div>'),n.calendar.calendar({fit:!0,border:!1,weeks:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],onSelect:function(t){var e=o.formatter(t);s(i,e),n.calendar.calendar("options").current=t,a(i).combo("hidePanel"),o.onSelect.call(i,t)}
}),s(i,o.value);var e=a('<div class="datebox-button"></div>').appendTo(t);a('<a href="javascript:void(0)" class="datebox-current"></a>').html(o.currentText).appendTo(e),a('<a href="javascript:void(0)" class="datebox-close"></a>').html(o.closeText).appendTo(e),e.find(".datebox-current,.datebox-close").hover(function(){a(this).addClass("datebox-button-hover")},function(){a(this).removeClass("datebox-button-hover")}),e.find(".datebox-current").click(function(){n.calendar.calendar({year:(new Date).getFullYear(),month:(new Date).getMonth()+1,current:new Date})}),e.find(".datebox-close").click(function(){a(i).combo("hidePanel")})}()})},a.fn.pjfdatebox.methods={options:function(t){return a.data(t[0],"pjfdatebox").options},calendar:function(t){return a.data(t[0],"pjfdatebox").calendar},setValue:function(t,e){return t.each(function(){s(this,e)})}},a.fn.pjfdatebox.parseOptions=function(t){a(t);return a.extend({},a.fn.combo.parseOptions(t),{})},
a.fn.pjfdatebox.defaults=a.extend({},a.fn.combo.defaults,{panelWidth:180,panelHeight:"auto",keyHandler:{up:function(){},down:function(){},enter:function(){var t,e,i;t=this,e=a.data(t,"pjfdatebox").options,i=a.data(t,"pjfdatebox").calendar,s(t,e.formatter(i.calendar("options").current)),a(t).combo("hidePanel")},query:function(t){s(this,t)}},currentText:"今天",closeText:"关闭",okText:"确定",datePattern:"y-m-d",formatter:function(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},parser:function(t){var e=Date.parse(t);return isNaN(e)?new Date:new Date(e)},onSelect:function(t){}})}(jQuery),function(a){function n(t){a(t).unbind(".cardbox"),a(t).bind("keypress.cardbox",function(t){return 45==t.which||46!=t.which&&(48<=t.which&&t.which<=57&&0==t.ctrlKey&&0==t.shiftKey||0==t.which||8==t.which||1!=t.ctrlKey||67!=t.which&&t.which,!0)}).bind("dragenter.cardbox",function(){return!1}).bind("blur.cardbox",function(){!function(t){var e=a(t).val()
;if(!PJF.orgInfo||"CN000"==PJF.orgInfo.instSvrlLgPsnID||!/^[a-zA-z]/.test(e)){for(var i=a.data(t,"cardbox").options.groupSeparator,n=a(t).val(),o=/(\S{4})(\S+)/;o.test(n);)n=n.replace(o,"$1"+i+"$2");a(t).val(n)}}(t)}).bind("focus.cardbox",function(){!function(t){var e=a.data(t,"cardbox").options,i=a(t).val();if(e.groupSeparator){var n=new RegExp("\\"+e.groupSeparator,"g");n.test(i)&&a(t).val(i.replace(n,""))}}(t)})}function o(t,e){var i=a.data(t,"cardbox").options;e?(i.disabled=!0,a(t).attr("disabled",!0)):(i.disabled=!1,a(t).removeAttr("disabled"))}a.fn.cardbox=function(i){if("string"==typeof i)switch(i){case"disable":return this.each(function(){o(this,!0)});case"enable":return this.each(function(){o(this,!1)})}return i=i||{},this.each(function(){var t=a.data(this,"cardbox");if(t)a.extend(t.options,i);else{var e=a(this);t=a.data(this,"cardbox",{options:a.extend({},a.fn.cardbox.defaults,{disabled:!!e.attr("disabled")||undefined},i)}),e.removeAttr("disabled"),a(this).css({
imeMode:"disabled"})}o(this,t.options.disabled),n(this)})},a.fn.cardbox.defaults={disabled:!1,groupSeparator:","}}(jQuery),function($){var PROGRESS_BAR_MAX_LENGTH=230,PROGRESS_BAR_STEP=5,PROGRESS_BAR_MOVE_TIME=500;function getUID(){return(new Date).getTime()+"s"+Math.floor(1048576*Math.random()).toString(16)}function getFileName(t){var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\"),n=Math.max(e,i);return n<0?t:t.substring(n+1)}function Uploading(){this.initialize()}function FileUpload(t,e){this.el=$(t);this.el.attr("id");this.params={url:null,id:null,buttonName:resource.FILEUPLOAD_BUTOON_NAME,success:null,failure:null,dataType:null,failure:null,data:null,loadingId:null,maskBody:!1,required:!1,missingMessage:resource.DEFAULT_MISSINGMESSAGE,whiteList:null,blackList:null,showBar:!0,outOfLimitSize:!1},$.extend(this.params,e);var i=Math.floor(1048576*Math.random()).toString(16);this.el.attr("id")
;null!=this.params.id&&""!=this.params.id?this.fileInputName=this.params.id:this.fileInputName="upload",this.fileInputID="upload"+i,this.fileTextID=i+"FileText",this.selectButtonID=i+"FileSelect",this.uploadButtonID=i+"Button",this.progressbarDiv=i+"ProgressBar",this.scanId=i+"scan",this.isDisabled=!1,this.initialize()}Uploading.prototype={finish:!1,initialize:function(){var t=this;t.uid=getUID(),t.frameId="jUploadFrame"+t.uid,t.formId="jUploadForm"+t.uid},getProgressBarHtml:function(t){var e=this,i=$("#"+t.fileInputID).val();i=getFileName(i);var n=getUID();e.progressBarID=n+"Bar",e.progressBarDivID=n+"Div",e.progressBarDelID=n+"Del"
;var o='<div class=\'clear\'></div><div class="pjf_fileupload_progressbar_box clear" id="'+e.progressBarDivID+'"><span class="pjf_fileupload_file_name" title=\''+i+"'>"+i+'</span><div class="pjf_fileupload_progressbar"><div id="'+e.progressBarID+'" style="width:20%;" class="pjf_fileupload_progressbar_value "></div></div><span class=""><a  id="'+e.progressBarDelID+'"></a></span></div>';t.el.append(o)},createUploadIframe:function(){var t='<iframe id="'+this.frameId+'" name="'+this.frameId+'" class="pjf_fileupload_iframe"/>';jQuery(t).appendTo(document.body)},createUploadForm:function(fileElementId,params){var me=this,form=jQuery('<form  action="" method="POST" name="'+me.formId+'" id="'+me.formId+'" enctype="multipart/form-data"></form>');this.fileuploadName=$("#"+fileElementId).val();var oldElement=jQuery("#"+fileElementId),newElement=jQuery(oldElement).clone();for(var key in jQuery(oldElement).before(newElement),jQuery(oldElement).appendTo(form),jQuery("#"+fileElementId).val(""),
params.data)form.append("<input type='hidden' name = '"+key+"' value='"+params.data[key]+"'></input>");var inputJq=form.find("input[name='jsonData']");if(0==inputJq.length&&params.url&&-1!==params.url.indexOf("ecpJson")&&(inputJq=$('<input type="hidden" name="jsonData">'),form.append(inputJq)),0<inputJq.length){var uNo;if(PJF.communication.client.isInP2()){var uuid=PJF.communication.client.getUniqueNo();"array"==PJF.util.getType(uuid)&&0==uuid[0]&&(uNo=uuid[1])}var token=PJF.util.getLoginToken(),jsonData=inputJq.val();try{jsonData=jsonData?eval("("+jsonData+")"):{},token&&(jsonData._login_tk=token),uNo&&(jsonData.ATCH_BTCH_NO=uNo),form.find("input[name='jsonData']").val(JSON.stringify(jsonData))}catch(e){console.info("pjf ui upload添加login token失败:"+e.message)}}if(PJF.communication.client.isInP2()&&PJF.util.getValue(window,"PJF.userInfo.userCode")){var jsonData=form.find("input[name='jsonData']").val();jsonData&&(PJF.html.addFormParam(form,{_terminal_type:PJF.constants.termType,
OPER_CODE:PJF.util.getValue(window,"PJF.userInfo.userCode")}),PJF.html.addFormParam(form,{macData:PJF.communication.client.macContent(jsonData)[1]}))}return jQuery(form).css("position","absolute"),jQuery(form).css("top","-1200px"),jQuery(form).css("left","-1200px"),jQuery(form).appendTo("body"),form},uploadHttpData:function(r,type){if($.browser.safari){if("xml"==type||"text"==type)return r;if("json"==type)return eval("("+r+")")}var data=!type;return data="xml"==type||data?r.responseXML:r.responseText,"json"==type&&eval("data = "+data),"html"==type&&jQuery("<div>").html(data).evalScripts(),data},ajaxFileUpload:function(c){var l=this,t=c.fileupload;c.showBar&&(l.getProgressBarHtml(t),l.progressBarFn());var d=l.createUploadForm(t.fileInputID,t.params);this.createUploadIframe();var u={},i=function(t){if($.browser.safari)void 0===u&&(u={}),u=t;else{var e=$("#"+l.frameId)[0];try{e.contentWindow?(u.responseText=e.contentWindow.document.body?e.contentWindow.document.body.innerHTML:null,
u.responseXML=e.contentWindow.document.XMLDocument?e.contentWindow.document.XMLDocument:e.contentWindow.document):e.contentDocument&&(u.responseText=e.contentDocument.document.body?e.contentDocument.document.body.innerHTML:null,u.responseXML=e.contentDocument.document.XMLDocument?e.contentDocument.document.XMLDocument:e.contentDocument.document)}catch(r){return clearInterval(l.interval),void(c.failure?c.failure():l.uploadError(r))}}if(u){try{l.finish=!0;var i=c.dataType,n=l.uploadHttpData(u,i);$("#"+l.progressBarID).width(PROGRESS_BAR_MAX_LENGTH),clearInterval(l.interval);var o=l.fileuploadName,a=o.lastIndexOf("\\"),s=o.substring(a+1,o.length);c.success(n,s),c.fileupload.params.delClick&&($("#"+l.progressBarDelID).text(resource.FILEUPLOAD_DELETE).parent().addClass("pjf_fileupload_file_operate"),$("#"+l.progressBarDelID).live("click",function(){c.fileupload.params.delClick(n)&&$("#"+l.progressBarDivID).remove()}))}catch(r){return clearInterval(l.interval),
void(c.failure?c.failure():l.uploadError(r))}$(e).unbind(),$(e).remove(),$(d).remove(),u=null}};try{if($.browser.safari){d=PJF.html.getDom(l.formId);var e=new FormData(document.forms.namedItem(l.formId)),n=new XMLHttpRequest;return n.open("POST",c.fileupload.params.url,!0),n.onload=function(t){if(4==n.readyState&&200==n.status)try{i(this.responseText)}catch(e){new PJF.ui.messageBox({style:"warning",title:resource.FILEUPLOAD_MESSAGE,content:resource.FILEUPLOAD_DECRYPT_DATA}),c.failure&&c.failure()}else new PJF.ui.messageBox({style:"warning",title:resource.FILEUPLOAD_MESSAGE,content:resource.FILEUPLOAD_ERROR}),c.failure&&c.failure()},void n.send(e)}$(d).attr("action",c.fileupload.params.url),$(d).attr("method","POST"),$(d).attr("target",l.frameId),d.encoding?$(d).attr("encoding","multipart/form-data"):$(d).attr("enctype","multipart/form-data"),d.submit()}catch(o){return clearInterval(l.interval),void(c.failure&&c.failure())}$("#"+l.frameId).ready().load(i)},progressBarFn:function(){
var t=this,e=setInterval(function(){t.progressBarFnAction()},PROGRESS_BAR_MOVE_TIME);t.interval=e},progressBarFnAction:function(){var t=this.progressBarID,e=$("#"+t).width();PROGRESS_BAR_MAX_LENGTH<=(e+=PROGRESS_BAR_STEP)&&(e=0),1==this.finish&&(e=PROGRESS_BAR_MAX_LENGTH),$("#"+t).width(e)},deleteFn:function(){var t=$("#"+this.frameId),e=$("#"+this.formId),i=$("#"+this.progressBarDivID);t.unbind(),t.remove(),e.remove(),i.remove()},uploadError:function(t){new PJF.ui.messageBox({style:"warning",title:resource.ERROR_TITLE,content:resource.FILEUPLOAD_ERROR})}},$.fn.fileupload=function(t,e){var i;return"string"!=typeof t?i=new FileUpload(this.get(0),t):"function"==typeof(i=this.data("upload"))[t]?i[t](e):void 0},FileUpload.prototype={initialize:function(){var r=this,t=this.el;if(this.getUploadHtml(r.el,r.fileInputID,r.fileInputName,r.fileTextID,r.selectButtonID,r.uploadButtonID,r.params.buttonName,r.params.url,r.params.required,r.params.missingMessage),
r.params.url&&$.browser.version<7&&t.closest("li").css("width","auto"),r.params.tips){t.append("<div class='pjf_fileupload_tips'>("+r.params.tips+")</div>"),t.closest("li").addClass("pjf_fileupload_li"),t.closest("li").width(770);var e=r.params.tips.replace(/[\u4e00-\u9fa5]/g,"");2*(r.params.tips.length-e.length)+e.length<55&&$(".pjf_fileupload_tips").css("line-height","24px")}$("#"+r.uploadButtonID).click(function(){if(!r.isDisabled){var t=$("#"+r.fileInputID).val();if(""==t)return new PJF.ui.messageBox({style:"warning",title:resource.FILEUPLOAD_MESSAGE,content:resource.FILEUPLOAD_CHOOSEFILE_MSG}),!1;var e=t.lastIndexOf("\\"),i=t.substring(e+1,t.length),n=i.substring(i.lastIndexOf(".")).toLowerCase();if(r.params.whiteList){var o=!1;for(var a in r.params.whiteList)n==r.params.whiteList[a].toLowerCase()&&(o=!0);if(!o)return void new PJF.ui.messageBox({style:"warning",title:resource.FILEUPLOAD_MESSAGE,
content:'<B style="font-size:12px;font-family:Microsoft Yahei;">'+resource.FILEUPLOAD_FORBID_MSG+'</B><p style="line-height:150%;color:#000000;font-family:Microsoft Yahei;">'+resource.FILEUPLOAD_ALLOW_FILETYPE+r.params.whiteList.toString()+"<p>"})}if(r.params.blackList)for(var a in r.params.blackList)if(n==r.params.blackList[a].toLowerCase())return void new PJF.ui.messageBox({style:"warning",title:resource.FILEUPLOAD_ALLOW_FILETYPE,content:resource.FILEUPLOAD_FORBID_MSG});if(r.params.outOfLimitSize){var s=resource.FILEUPLOAD_LIMITSIZE_MSG+r.params.maxFileSize+"kb";new PJF.ui.messageBox({style:"warning",title:resource.FILEUPLOAD_MESSAGE,content:s})}else{if(!r.params.beforeUpload||!1!==r.params.beforeUpload())r.disabledUpload(),r.params.maskBody&&new PJF.ui.loading({id:r.params.loadingId,maskBody:r.params.maskBody}),(new Uploading).ajaxFileUpload({fileupload:r,dataType:r.params.dataType,data:{},success:r.params.success,failure:r.params.failure,showBar:r.params.showBar}),r.enableUpload()}
}})},getUploadHtml:function(d,u,t,h,e,i,n,o,a,s){var p=this;$.browser.msie&&$.browser.version;var r="<input  type='file' "+(this.params.multiple?"multiple='multiple'":"")+" class='pjf_fileupload_span' id='"+u+"' name='"+t+"' />",c=this.scanId,l='<div  style="float:left"><input type="text" name=\''+h+"' id='"+h+"' class='left ipt_text' readonly/></div><div class='pjf_fileupload_div'><span id='"+c+"'></span></div>";l+='<script type="text/javascript">  new PJF.ui.linkButton({id:\''+c+"',dom:'"+c+"',style:'assistant',name:'"+resource.FILEUPLOAD_BROWSE_TEXT+"'});<\/script>",null!=o&&(l=l+"<div class='pjf_fileupload_div'><span   id='"+i+"' name='"+i+"'></span></div>",l+='<script type="text/javascript">  new PJF.ui.linkButton({id:\''+i+"',dom:'"+i+"',style:'assistant',name:'"+n+"'});<\/script>"),$(l).appendTo(d),$("#"+c).children().append(r),$.browser.safari&&PJF.communication.client.isInP2()&&$("#"+u).bind("click",function(){
PJF.communication.client.clickMouse?PJF.communication.client.clickMouse():(new PJF.ui.loading({maskBody:!0,id:"maskuploading"}),setTimeout(function(){$(document).bind("click.maskfileuploading",function(){PJF.ui.componentMgr.get("maskuploading").destroy(),$(document).unbind(".maskfileuploading")})},10))});var f="myFileType"+getUID(),m={};m[this.validateKeyName=f]={key:f,fn:function(t){for(var e=t.split(","),i=[],n=0;n<e.length;n++){var o=e[n].lastIndexOf("\\"),a=e[n].substring(o+1,e[n].length),s=a.substring(a.lastIndexOf(".")).toLowerCase();i.push(s)}if(p.params.whiteList){for(var r=!1,c=0;c<i.length;c++){for(var n in r=!1,p.params.whiteList)if(i[c]==p.params.whiteList[n].toLowerCase()){r=!0;break}if(!r)break}if(!r){var l=resource.FILEUPLOAD_FORBID_MSG+resource.FILEUPLOAD_ALLOW_FILETYPE+p.params.whiteList.toString();return p.fileUpload_textfield.setMessage("invalidMessage",l),!1}}
if(p.params.blackList)for(var n in p.params.blackList)for(c=0;c<i.length;c++)if(i[c]==p.params.blackList[n].toLowerCase()){l=resource.FILEUPLOAD_FORBID_MSG;return p.fileUpload_textfield.setMessage("invalidMessage",l),!1}if(p.params.maxFileSize&&PJF.communication.client.isInP2())for(n=0;n<e.length;n++){var d=PJF.communication.client.checkFileSize(e[n]);if(0==parseInt(d[0])){var u=d[1];if(parseFloat(u)>parseFloat(p.params.maxFileSize)){l=resource.FILEUPLOAD_LIMITSIZE_MSG+p.params.maxFileSize+"kb";return p.fileUpload_textfield.setMessage("invalidMessage",l),!(p.params.outOfLimitSize=!0)}}}return!0}},PJF.apply(PJF.validator.base,m);var g=resource.FILEUPLOAD_FORBID_MSG;p.params.whiteList&&(g=resource.FILEUPLOAD_FORBID_MSG+resource.FILEUPLOAD_ALLOW_FILETYPE+p.params.whiteList.toString()),p.fileUpload_textfield=new PJF.ui.textfield({dom:h,required:a,validType:f,invalidMessage:g,missingMessage:s}),$("#"+h).attr("readonly",!0),$("#"+c).live("mouseover",function(){
$(this).find(".pjf_linkBtn_assistant").addClass("pjf_linkBtn_assistant_over").addClass("pjf_linkBtn_over").children().first().addClass("pjf_linkBtn_right_over").addClass("pjf_linkBtn_assistant_right_over")}),$("#"+c).live("mouseout",function(){$(this).find(".pjf_linkBtn_assistant").removeClass("pjf_linkBtn_assistant_over").removeClass("pjf_linkBtn_over").children().first().removeClass("pjf_linkBtn_right_over").removeClass("pjf_linkBtn_assistant_right_over")}),$("#"+u).live("change",function(){var t=$(this).val();if(p.params.multiple){var e=t.lastIndexOf("\\"),i=t.substring(0,e+1);t="";for(var n=document.getElementById(u).files,o=0;o<n.length;o++)t+=i+n[o].name,o<n.length-1&&(t+=",")}if($("#"+h).val(t),$("#"+h).trigger("focus"),$("#"+h).trigger("blur"),p.params.showImg){d.find("img").remove(),$(".pjf_fileupload_progressbar_box").remove();var a=t.lastIndexOf("\\"),s=t.substring(a+1,t.length),r=s.substring(s.lastIndexOf(".")).toLowerCase()
;if($.browser.safari&&PJF.communication.client.isInP2()&&(t="file:///"+t),p.params.whiteList){for(var o in p.params.whiteList)if(r==p.params.whiteList[o].toLowerCase()){if(/\w+\.(jpg|jpeg|png)$/.test(t)){$("<div class='clear' style='width:480px;'><img class='fileuploadimg' src='"+t+"' style='margin-top:10px;clear:both;'/></div>").appendTo(d);var c=p.params.imgWidth?p.params.imgWidth:"300px",l=p.params.imgHeight?p.params.imgHeight:"200px";d.find(".fileuploadimg").css("width",c),d.find(".fileuploadimg").css("height",l)}return}}else if(/\w+\.(jpg|jpeg|png)$/.test(t)){$("<div class='clear' style='width:480px;'><img class='fileuploadimg' src='"+t+"' style='margin-top:10px;clear:both;'/></div>").appendTo(d);c=p.params.imgWidth?p.params.imgWidth:"300px",l=p.params.imgHeight?p.params.imgHeight:"200px";d.find(".fileuploadimg").css("width",c),d.find(".fileuploadimg").css("height",l)}}})},enableUpload:function(){$("#"+this.selectButtonID).removeAttr("disabled"),
$("#"+this.uploadButtonID).removeAttr("disabled")},disabledUpload:function(){$("#"+this.fileTextID).val(""),$("#"+this.selectButtonID).attr("disabled","disabled"),$("#"+this.uploadButtonID).attr("disabled","disabled")},disable:function(){var t=PJF.ui.componentMgr.get(this.uploadButtonID);t&&t.disable(),$("#"+this.fileInputID).attr("disabled","disabled");var e=PJF.ui.componentMgr.get(this.scanId);e&&e.disable(),this.isDisabled=!0},enable:function(){var t=PJF.ui.componentMgr.get(this.uploadButtonID);t&&t.enable(),$("#"+this.fileInputID).removeAttr("disabled");var e=PJF.ui.componentMgr.get(this.scanId);e&&e.enable();var i="<input  type='file' "+(this.params.multiple?"multiple='multiple'":"")+" class='pjf_fileupload_span' id='"+this.fileInputID+"' name='"+this.fileInputName+"' />";$("#"+this.scanId).children().append(i),this.isDisabled=!1},getUploadFileName:function(){var t=$("#"+this.fileTextID).val();if(this.params.multiple){var e=[],i=t.split(",");for(var n in i){
var o=i[n].lastIndexOf("\\");e.push(i[n].substring(o+1,i[n].length))}return e}o=t.lastIndexOf("\\");return t.substring(o+1,t.length)},setValue:function(t){$("#"+this.fileTextID).val(t)},getValue:function(){return $("#"+this.fileTextID).val()},clear:function(){$.browser.safari?document.getElementById(this.fileInputID).outerHTML=document.getElementById(this.fileInputID).outerHTML:(document.getElementById(this.fileInputID).type="text",$("#"+this.fileInputID).val(""),document.getElementById(this.fileInputID).type="file"),$("#"+this.fileTextID).val("")}}}(jQuery),function(){function Navigation(t,e){this.el=$(t),this.options={data:{},onclick:null,currentValue:null},$.extend(this.options,e),this.initialize(),this.options.onclick||$(t).find("a").css("cursor","default")}function isSingle(t,e){return"string"==typeof t}$.fn.navigation=function(t){if(null!=t&&null!=t.data){var e=new Navigation(this.get(0),t);return this.data("navigation",e),e}},Navigation.prototype={initialize:function(){
"vertical"==this.options.type?this.zxdhHtml(this):"crosswise"==this.options.type?this.hxdh2Html(this):this.hxdhHtml(this)},hxdhHtml:function(navigationDom){for(var me=this,data=navigationDom.options.data,domId=navigationDom.el.attr("id"),html="<div><ul class='pjf_hxlc_h'>",i=0;i<data.length;i++){var indexId=null==data[i].id?eval(i+1):data[i].id,liId=domId+"_li_"+indexId,aId=domId+"_a_"+indexId,indexNo=data[i].indexNo,label=data[i].label,childData=data[i].childData;html=html+"<li class='' id='"+liId+"'><a id='"+aId+"'>",html=null!=indexNo?html+"<span>"+indexNo+"</span>":html+"<span>"+eval(i+1)+"</span>",html=html+label+"</a><b></b></li>",me.el.data(aId,data[i]),$("#"+aId).die().live("click",function(){var t=$(this).attr("id");me.click(me.el.data(t))})}if(html+="</ul></div>",$(html).appendTo(navigationDom.el),this.options.isFloat){var _div=$("div .pjf_hxlc_h").parent().parent(),offset=$(this).scrollTop(),y=_div.attr("id"),pos=$("#"+y).position().top;$(window).bind("scroll",function(){
$("#"+y).css({position:"absolute",top:pos});var t=$(this).scrollTop()+"px";$("#"+y).animate({top:t},{duration:500,queue:!1})})}},hxdh2Html:function(navigationDom){var me=this,data=navigationDom.options.data,domId=navigationDom.el.attr("id"),html="<div><ul class='pjf_hxlc_h'>";this.navLiArray=[],this.navChildUlArray=[],this.data=data,this.childAllNodeId=[];for(var i=0;i<data.length;i++){var indexId=null==data[i].id?eval(i+1):data[i].id,liId=domId+"_li_"+indexId;this.navLiArray.push(liId);var aId=domId+"_a_"+indexId,indexNo=data[i].indexNo,label=data[i].label,childData=data[i].childData;if(this.childNodeId=[],childData!=undefined&&0<childData.length){for(var c=0;c<childData.length;c++){var indexChildId=null==childData[c].childId?eval(c+1):childData[c].childId;indexChildId=liId+"_"+indexChildId,this.childNodeId.push(indexChildId)}this.childAllNodeId.push(this.childNodeId)}html=html+"<li class='' id='"+liId+"'><a id='"+aId+"'>",
html=null!=indexNo?html+"<span>"+indexNo+"</span>":html+"<span>"+eval(i+1)+"</span>",html=html+label+"</a><b></b></li>",me.el.data(aId,data[i]),$("#"+aId).die().live("click",function(){var t=$(this).attr("id");me.click(me.el.data(t))})}html+="</ul></div>",html+='<div id="childNavigation_Div" style="overflow-y:auto;overflow-x:hidden;"><ul id="childImg"></ul></div>',$(html).appendTo(navigationDom.el);var childImgHtml='<li id="pointer" class="hiddenChildDiv">';childImgHtml+='<a id="pointImgId" class="pointerImg">&emsp;</a></li>',$("#childImg").append(childImgHtml);for(var liIds=[],i=0;i<this.navLiArray.length;i++){var BDivId=this.navLiArray[i]+"_";this.navChildUlArray.push(BDivId);var indexNo=data[i].indexNo,label=data[i].label,childData=data[i].childData,childDivId=BDivId,childDivHtml='<ul id="'+childDivId+'" class="pjf_hxlc_h_toff"></ul>';if($("#childImg").after(childDivHtml),0==i){if(0<childData.length)for(var j=0;j<childData.length;j++){
var childNodeId=null==childData[j].childId?eval(j+1):childData[j].childId;childNodeId=this.navLiArray[i]+"_"+childNodeId;var childStepDivId=childNodeId,childStepDivHtml;childStepDivHtml=0==j?'<li id="'+childStepDivId+'" class=""><a class="astyle3"><label style="position:absolute;left:-5px">'+childData[j].label+"</label></a></li>":'<li id="'+childStepDivId+'" class="" style="position:relative;left:-'+140*j+'px"><b class="bstyle"></b><a class="astyle3"><label>'+childData[j].label+"</label></a></li>",$("#"+childDivId).append(childStepDivHtml),childStepDivHtml="",me.el.data(childStepDivId,childData[j]),$("#"+childStepDivId).die().live("click",function(){var t=$(this).attr("id");me.click(me.el.data(t))})}}else if(0<childData.length)for(var j=0;j<childData.length;j++){var childNodeId=null==childData[j].childId?eval(j+1):childData[j].childId;childNodeId=this.navLiArray[i]+"_"+childNodeId;var childStepDivId=childNodeId,childStepDivHtml
;childStepDivHtml=0==j?'<li id="'+childStepDivId+'" class=""><a class="astyle3"><label >'+childData[j].label+"</label></a></li>":'<li id="'+childStepDivId+'" class="" style="position:relative;left:-'+140*j+'px"><b class="bstyle"></b><a class="astyle3"><label>'+childData[j].label+"</label></a></li>",$("#"+childDivId).append(childStepDivHtml),childStepDivHtml="",me.el.data(childStepDivId,childData[j]),$("#"+childStepDivId).die().live("click",function(){var t=$(this).attr("id");me.click(me.el.data(t))})}}if(this.options.isFloat){var _div=$("div .pjf_hxlc_h").parent().parent(),offset=$(this).scrollTop(),y=_div.attr("id"),pos=$("#"+y).position().top;$(window).bind("scroll",function(){$("#"+y).css({position:"absolute",top:pos});var t=$(this).scrollTop()+"px";$("#"+y).animate({top:t},{duration:500,queue:!1})})}},zxdhHtml:function(navigationDom){
for(var me=this,data=navigationDom.options.data,domId=navigationDom.el.attr("id"),html="<div><ul class='pjf_zxlc'>",preIsSingle=!0,i=0;i<data.length;i++){var indexId=null==data[i].id?eval(i+1):data[i].id,curHtml="",liId=domId+"_li_"+indexId,aId,labels=data[i].label;if(curHtml="<li class='",0==preIsSingle&&(curHtml+="pjf_liuc_two"),curHtml=curHtml+"' id='"+liId+"'>","string"==typeof labels)aId=domId+"_a_"+indexId,curHtml=curHtml+"<span  style= 'float:none;'><a id='"+aId+"'>"+labels+"</a></span>",me.el.data(aId,data[i]),me.bindClick(me,aId);else{curHtml+='<div class = "pjf_zxlc_div">';for(var j=0;j<labels.length;j++)aId=domId+"_a_"+indexId+"_"+j,
0==j?labels[j]?curHtml=curHtml+'<span  style ="margin-right:10px"><a id=\''+aId+"'>"+labels[j]+"</a></span>":data[data.length-1].label instanceof Array?data[data.length-1].label instanceof Array&&(curHtml+='<div class= "pjf_zxlc_li_branch_no_button_up_line" style ="margin-right:10px"></div>'):curHtml+='<div class= "pjf_zxlc_li_branch_no_button_up_line" style ="margin-right:10px"><div class= "pjf_zxlc_li_branch_no_button_in_line_left"></div></div>':labels[j]?curHtml=curHtml+'<span  style ="margin-left:10px"><a id=\''+aId+"'>"+labels[j]+"</a></span>":data[data.length-1].label instanceof Array?data[data.length-1].label instanceof Array&&(curHtml+='<div class= "pjf_zxlc_li_branch_no_button_up_line" style ="margin-left:10px"></div>'):curHtml+='<div class= "pjf_zxlc_li_branch_no_button_up_line" style ="margin-left:10px"><div class= "pjf_zxlc_li_branch_no_button_in_line_right"></div></div>',me.el.data(aId,data[i]),me.bindClick(me,aId);curHtml+="</div>"}curHtml+="</li>",
i+1<data.length&&(i==data.length-1||data[i].label instanceof Array||data[i+1].label instanceof Array?i!=data.length-1&&!(data[i].label instanceof Array)&&data[i+1].label instanceof Array&&2==data[i+1].label.length?curHtml+="<li ><div class='pjf_zxlc_li_branch_up'></div></li>":i!=data.length-1&&data[i].label instanceof Array&&2==data[i].label.length&&data[i+1].label instanceof Array&&2==data[i+1].label.length&&""!=data[i+1].label[0]&&""!=data[i+1].label[1]?curHtml+="<li><div class='pjf_zxlc_li_branch_tip_tip'></div></li>":i!=data.length-1&&data[i].label instanceof Array&&2==data[i].label.length&&""==data[i+1].label[0]&&2==data[i+1].label.length&&!(data[data.length-1].label instanceof Array)?curHtml+="<li><div class='pjf_zxlc_li_branch_line_tip'></div></li>":i!=data.length-1&&data[i].label instanceof Array&&2==data[i].label.length&&""==data[i+1].label[1]&&2==data[i+1].label.length&&!(data[data.length-1].label instanceof Array)?curHtml+="<li><div class='pjf_zxlc_li_branch_tip_line'></div></li>":i!=data.length-1&&data[i].label instanceof Array&&!(data[i+1].label instanceof Array)?curHtml+="<li><div class='pjf_zxlc_li_branch_down'></div></li>":data[data.length-1].label instanceof Array?i!=data.length-1&&data[i].label instanceof Array&&2==data[i].label.length&&""==data[i+1].label[0]&&2==data[i+1].label.length?curHtml+="<li><div class='pjf_zxlc_li_branch_right_tip'></div></li>":i!=data.length-1&&data[i].label instanceof Array&&2==data[i].label.length&&""==data[i+1].label[1]&&2==data[i+1].label.length&&(curHtml+="<li><div class='pjf_zxlc_li_branch_left_tip'></div></li>"):i==data.length-1||data[i].label instanceof Array||data[i+1].label instanceof Array?i!=data.length-1&&data[i+1].label instanceof Array&&1==data[i+1].label.length&&(curHtml+="<li style='height:12px;' class='pjf_zxlc_li_img_one'></li>"):curHtml+="<li style='height:12px;' class='pjf_zxlc_li_img_one'></li>":curHtml+="<li ><div class='pjf_zxlc_li_branch_one'></div></li>"),
html+=curHtml}html+="</ul></div>",$(html).appendTo(navigationDom.el),this.addPNGFilter(navigationDom.el)},addPNGFilter:function(t){var e="Microsoft Internet Explorer"==navigator.appName&&4==parseInt(navigator.appVersion)&&-1!=navigator.appVersion.indexOf("MSIE 6.0");if(jQuery.browser.msie&&e)for(var i=t.find("[class^='pjf_zxlc_li_branch']"),n=0;n<i.length;n++){var o=$(i[n]),a=o.css("background-image");if("none"!=a){var s=a.split('url("')[1].split('")')[0];o.get(0).runtimeStyle&&(o.css("background-image","none"),o.get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+s+"',sizingMethod='srop')")}}},bindClick:function(s,t){$("#"+t).die().live("click",function(){var t=$(this).attr("id"),e=s.el.data(t),i=$("#"+t).html(),n=(new Array,{});if(e.label instanceof Array){for(var o,a=0;a<e.label.length;a++)e.label[a]==i&&(o=a);n.label=i,n.indexNo=e.indexNo[o],s.click(n)}else s.click(e)})},setNavigation:function(t,e){
var i=this.el.attr("id"),n=$("#"+i).children("div");if(1<n.length){for(var o=$(n[1]).attr("id"),a=this.navLiArray,s=this.navChildUlArray,r=this.el.attr("id")+"_a_"+t,c=this.el.attr("id")+"_li_"+t,l=$("#"+o).find("li"),d=0;d<a.length;d++)if(c==a[d]){var u=$("#"+c).offset();y=$("#"+a[d]).offset().left,C=(P=d<a.length-1?$("#"+a[d+1]).offset().left:$("#"+a[d]).offset().left+80)-y-30,C/=2,C=Math.floor(C),console.log(C);var h=u.left+C;$(l[0]).removeClass(),$(l[0]).attr({style:"position:relative;top:5px;left:"+h+"px"})}for(var p=0;p<s.length;p++){if(console.log(c+"_"),console.log(s[p]),c+"_"==s[p])0==$("#"+(c+"_")).children("li").length?$("#childImg").addClass("hiddenChildDiv"):$("#childImg").removeClass(),$("#"+s[p]).removeClass(),$("#"+s[p]).addClass("pjf_hxlc_h_t");else $("#"+s[p]).removeClass(),$("#"+s[p]).addClass("pjf_hxlc_h_toff")}if("done"==e){if(0<t.indexOf("_")?(this.el.find("#"+r).parent().removeClass(),
this.el.find("#"+r).parent().addClass("pjf_liuc_finish_branch")):($("#"+c).removeClass(),$("#"+c).addClass("pjf_hxlc_h_finish pjf_liuc_finish")),!$("#"+c).hasClass("pjf_hxlc_h_current pjf_liuc_now")){$("#pointer").removeClass().addClass("hiddenChildDiv");for(p=0;p<s.length;p++)c+"_"==s[p]&&($("#"+s[p]).removeClass(),$("#"+s[p]).addClass("pjf_hxlc_h_toff"))}}else if("doing"==e){var f;0<t.indexOf("_")?(this.el.find("#"+r).parent().removeClass(),this.el.find("#"+r).parent().addClass("pjf_liuc_now_branch")):($("#"+c).removeClass(),$("#"+c).addClass("pjf_hxlc_h_current pjf_liuc_now"));for(var m=0;m<a.length;m++){var g,v,_;if(0==m)g=$("#"+a[m]).offset().left;if(m==a.length-1)v=$("#"+a[m]).offset().left;_=Math.round(v-g),f=Math.round(_),m==a.length-1&&(f+=100)}if($("#"+c).hasClass("pjf_hxlc_h_current pjf_liuc_now")){var b;for(h=(u=$("#"+c).offset()).left,p=0;p<s.length;p++)if(c+"_"==s[p]){for(var y,P,C,I=$("#"+s[p]).children("li"),F=0;F<I.length;F++){if(0==F)y=$(I[F]).offset().left
;if(F==I.length-1)P=$(I[F]).offset().left}C=P-y,C=Math.round(C)+160,console.log("88888888888888888888888888888"),console.log(C),console.log(f),f<C&&0==p?(C=300*I.length,console.log("jjjjjjjjjjjjjiiiiiiiii"),$("#"+s[p]).removeClass(),$("#"+s[p]).addClass("pjf_hxlc_h_t"),$("#"+s[p]).attr({style:"width:"+C+"px;margin-left:-20px"})):f<C&&0!=p?(C=300*I.length,$("#"+s[p]).removeClass(),$("#"+s[p]).addClass("pjf_hxlc_h_t"),$("#"+s[p]).attr({style:"width:"+C+"px;margin-left:30px"})):(0<C?b=f-C:(b=f+C,b=Math.round(b)/2),$("#"+s[p]).removeClass(),$("#"+s[p]).addClass("pjf_hxlc_h_t"),h<b?(C=300*I.length,$("#"+s[p]).attr({style:"width:"+C+"px;margin-left:"+h+"px"})):(C=300*I.length,$("#"+s[p]).attr({style:"width:"+C+"px;margin-left:"+b+"px"})))}}else $("#pointer").removeClass().addClass("hiddenChildDiv")}else if("undo"==e&&(0<t.indexOf("_")?this.el.find("#"+r).parent().removeClass():$("#"+c).removeClass(),!$("#"+c).hasClass("pjf_hxlc_h_current pjf_liuc_now"))){
$("#pointer").removeClass().addClass("hiddenChildDiv"),$("#childId0").removeClass().addClass("hiddenChildDiv");for(p=0;p<s.length;p++)c+"_"==s[p]&&($("#"+s[p]).removeClass(),$("#"+s[p]).addClass("pjf_hxlc_h_toff"))}}else{r=this.el.attr("id")+"_a_"+t,c=this.el.attr("id")+"_li_"+t;"done"==e?0<t.indexOf("_")?(this.el.find("#"+r).parent().removeClass(),this.el.find("#"+r).parent().addClass("pjf_liuc_finish_branch")):($("#"+c).removeClass(),$("#"+c).addClass("pjf_hxlc_h_finish pjf_liuc_finish")):"doing"==e?0<t.indexOf("_")?(this.el.find("#"+r).parent().removeClass(),this.el.find("#"+r).parent().addClass("pjf_liuc_now_branch")):($("#"+c).removeClass(),$("#"+c).addClass("pjf_hxlc_h_current pjf_liuc_now")):0<t.indexOf("_")?this.el.find("#"+r).parent().removeClass():$("#"+c).removeClass()}},setChildNavigation:function(t,e){var i,n=this.el.attr("id"),o=$("#"+n).children("div"),a=(n=this.el.attr("id"),o=$("#"+n).children("div"),$(o[1]).attr("id")),s=(this.navLiArray,this.navChildUlArray)
;console.log("==========childNavigation=====================");for(var r=0;r<s.length;r++)$("#"+s[r]).hasClass("pjf_hxlc_h_t")&&(i=s[r]+t);var c,l;$("#"+a).find("li");if("childDoing"==e){console.log("开始设置二级导航=================="+(s.length-1));for(var d=0;d<s.length;d++){var u=$("#"+s[d]).children("li");console.log(u);for(var h=0;h<u.length;h++)if(i==$(u[h]).attr("id")){var p=$(u[h]).attr("id");c=$("#"+p).children("a"),""==(l=$("#"+p).children("b")).length||$(l[0]).removeClass().addClass("bstyle2"),$(c[0]).removeClass().addClass("astyle1")}}u=[],c=[],i="",l=[]}else if("childUndo"==e){for(d=0;d<s.length;d++)for(u=$("#"+s[d]).children("li"),h=0;h<u.length;h++)if(i==$(u[h]).attr("id")){p=$(u[h]).attr("id");c=$("#"+p).children("a"),""==(l=$("#"+p).children("b")).length||$(l[0]).removeClass().addClass("bstyle"),$(c[0]).removeClass().addClass("astyle3")}u=[],c=[],i="",l=[]}else{for(d=0;d<s.length;d++)for(u=$("#"+s[d]).children("li"),h=0;h<u.length;h++)if(i==$(u[h]).attr("id")){
p=$(u[h]).attr("id");c=$("#"+p).children("a"),l=$("#"+p).children("b"),console.log("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"),""==l.length||$(l[0]).removeClass().addClass("bstyle2"),$(c[0]).removeClass().addClass("astyle6")}u=[],c=[],i="",l=[]}},click:function(t){null!=this.options.onclick&&this.options.onclick(t)}}}(jQuery),function($){var optionValue="name",optionText="desc";function Select(t,e){this.el=$(t);var i=Math.floor(1048576*Math.random()).toString(16);this.options={showDatas:e.data,data:null,id:this.el.attr("id")+"_select_"+i,parentId:this.el.attr("id")+"_parent"+i,name:this.el.attr("id"),defaultValue:null,nullOption:!1,nullOptionLabel:resource.SELECT_NULLlOPTION_LABEL,onChange:null,disabled:!1,multiple:!1,width:null,dropDivWidth:null,inputId:null,data:[],divId:null,spanId:null,formatter:null,selectIndex:-1,hideDivId:null,required:!1,containerId:null,keyBoardArray:[],missingMessage:resource.SELECT_MISSING_MSG,maxHeight:200,mulClick:null,isCheck:!0,isClick:!1,cancelClick:null,
triggerChange:!0,focusSelectAll:!0,filter:!0,helpTip:!1,enterSelect:!1,fenciFlag:!0,pinyinFlag:!0,addDivFlag:!1},this.params=e,$.extend(this.options,e),this.initialize(),this.el.data("select",this)}$.fn.select=function(t,e,i){var n;return"string"!=typeof t?n=new Select(this.get(0),t):"function"==typeof(n=this.data("select"))[t]?n[t](e,i):void 0},Select.prototype={initialize:function(){var n=this;function t(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0,o=0;o<36;o++)8==o||13==o||18==o||23==o?i[o]="-":14==o?i[o]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[o]=e[19==o?3&t|8:t]);return i.join("").replace(/-/g,"")}this.options.divId||(this.options.divId=t()),this.options.inputId||(this.options.inputId=t()),this.options.spanId||(this.options.spanId=t()),this.options.helpId||(this.options.helpId=t()),this.options.containerId||(this.options.containerId=t()),this.options.parentId||(this.options.parentId=t()),
this.el.is("select")?(this.options.id=this.el.attr("id"),this.adapter()):this.insert(),$("#"+this.options.id).css("background","none");$("#"+this.options.id).offset();var e=$("#"+this.options.id).siblings(".pjf_single_span"),i=$("#"+this.options.id).siblings(".pjf_span_disable");if(0<e.length)this.options.spanId=$("#"+this.options.id).siblings(".pjf_single_span").attr("id"),this.options.inputId=$("#"+this.options.id).siblings("input").attr("id"),$("#"+this.options.id).siblings(".pjf_single_span").unbind("click"),$("#"+this.options.inputId).unbind("focus");else if(0<i.length)this.options.spanId=$("#"+this.options.id).siblings(".pjf_span_disable").attr("id"),this.options.inputId=$("#"+this.options.id).siblings("input").attr("id"),$("#"+this.options.id).siblings(".pjf_span_disable").unbind("click"),$("#"+this.options.inputId).unbind("focus");else{
var o='<input  type="text"  id="'+this.options.inputId+'" readonly="readonly" class="pjf_select validatebox-text pjf_select_input"/><span id="'+this.options.spanId+'" class="pjf_single_span" ></span>';if($("#"+this.options.id).css("display","none"),$("#"+this.options.id).parent().append(o),this.options.width&&$("#"+this.options.inputId).css("width",this.options.width-23+"px"),!0===n.options.helpTip){var a='<span id="'+this.options.helpId+'"></span>';$("#"+this.options.id).parent().after(a),n.helpTip=new PJF.ui.helpTip({dom:this.options.helpId,helpMessage:this.options.helpMessage})}}if(this.options.multiple?($("#"+this.options.spanId).removeClass("pjf_single_span").addClass("pjf_span"),$("#"+this.options.id).attr("multiple","multiple"),this.multiple()):(this.single(),$("#"+this.options.id).attr("disabled")&&($("#"+n.options.inputId).attr("disabled","disabled").addClass("pjf_disabled_input"),$("#"+n.options.spanId).unbind("click").remove("pjf_single_span").addClass("pjf_span_disable"))),
this.options.disabled&&this.disabled(),this.options.defaultValue){if($.isArray(this.options.defaultValue))for(var s=this.options.defaultValue,r=this.options.defaultValue.length,c=0;c<r;c++)$("#"+this.options.id).find("option").each(function(){$(this).attr("value")==s[c]&&$(this).attr("selected",!0),""==$(this).attr("value")&&$(this).removeAttr("selected")});else $("#"+this.options.id).val(this.options.defaultValue);var l=new Array;$("#"+this.options.id).find("option").each(function(t){if($(this).attr("selected")){var e=$(this).val(),i=$(this).text();n.options.multiple?""!=e&&e!=undefined&&null!=e&&l.push(i):l.push(i)}}),$("#"+n.options.inputId).val(l.toString())}(n=this).options.required&&($("#"+n.options.id).val()||$("#"+n.options.inputId).attr("error",n.options.missingMessage),$("#"+n.options.inputId).addClass("validatebox-invalid invalid_box")),n.options.onChange&&$("#"+n.options.id).change(function(){n.options.onChange()}),
$.browser.msie&&$.browser.version<7&&$("#"+n.options.id).parent().css("margin-left","-3px");$("#"+n.options.id);$("#"+n.options.inputId).bind("blur",function(){if(!n.options.multiple){var t=$("#"+n.options.id).find("option:selected").text();$(this).val(t)}$(this).parent().removeClass("focus-border-select"),n.options.isCheck&&(n.hideDiv(),window.clearInterval(n.intervalId));$(this).hasClass("pjf_readonly_input");if(n.options.required&&n.options.isCheck){mCheck=$("#"+n.options.inputId);var e=$("#"+n.options.id).val();null==e||""==e||e==undefined?(mCheck.checkTip({show:function(){return!1},Message:n.options.missingMessage}),$("#"+n.options.inputId).parent().addClass("focus-border-select-error")):($("#"+n.options.inputId).parent().removeClass("focus-border-select-error"),mCheck.checkTip({show:function(){return!0}}),$("#"+n.options.id).parent().find(".errorbox_ipt_help").remove())}}),!0!==n.options.filter||n.options.multiple||(n.options.showDatas=n.getShowDatas(),n.filter())},
setHelpTip:function(t,e){var i=this;if(!1===e)i.helpTip&&i.helpTip.destroy(),i.helpTip=null;else if(i.helpTip)i.helpTip.setHelpMsg(t);else{var n=PJF.util.generateUUid();$("#"+i.options.id).parent().after('<span id="'+n+'"></span>'),i.helpTip=new PJF.ui.helpTip({dom:n,helpMessage:t})}},getShowDatas:function(){var o=[];return $("#"+this.options.id).find("option").each(function(){var t=new Object,e=$(this).val(),i=$(this).text(),n=i.substring(0,i.indexOf(":"));t.name=e,t.desc=i,""!=n&&(t.index=n),o.push(t)}),o},filter:function(){var t=$("#"+this.options.inputId);t.removeAttr("readonly"),this.previousValue=t.val()},single:function(){var e=this;$("#"+e.options.id).find("option").each(function(t){$(this).attr("selected")&&$("#"+e.options.inputId).val($(this).text())}),$("#"+e.options.spanId).bind("click",function(){PJF.constants.KEYBOARD_ENABLE&&e.addSingleDiv(),$("#"+e.options.inputId).trigger("focus")}),$("#"+this.options.inputId).bind("click",function(){
PJF.constants.KEYBOARD_ENABLE&&e.addSingleDiv(),$("#"+e.options.inputId).trigger("focus")}),window.opera?$("#"+e.options.inputId).keypress(function(t){e.keyPress(t)}):($("#"+e.options.inputId).keydown(function(t){e.keyPress(t)}),e.options.filter&&!e.options.multiple&&$("#"+e.options.inputId).keyup(function(t){e.keyPressUp(t,!0)})),$("#"+e.options.inputId).bind("focus",function(){$(this).parent().addClass("focus-border-select"),PJF.constants.KEYBOARD_ENABLE||e.addSingleDiv()})},addSingleDiv:function(){var s=this;if(s.keyPressUp({keyCode:32}),s.options.hideDivId&&clearTimeout(s.options.hideDivId),!(!1===s.options.filter&&"block"==$("#"+s.options.divId).css("display")||$("#"+s.options.inputId).hasClass("pjf_readonly_input")||$("#"+s.options.inputId).hasClass("pjf_disabled_input"))){if(0<$("#"+s.options.divId).length&&!this.options.addDivFlag)return $("#"+this.options.divId).css("display","block"),void s.fixPosition();var t=$("#"+this.options.inputId).offset();s.options.selectIndex=-1,
0<$("#"+this.options.divId).length?$("#"+this.options.divId).empty():$('<div id="'+this.options.containerId+'" style="position:absolute;top:0px;left:0px;z-index:9999;"><div class="autocomplete-w1"><div class="autocomplete1"  id="'+this.options.divId+'" style="display:none;"></div></div></div>').appendTo("body"),this.options.dropDivWidth?"auto"!=this.options.dropDivWidth&&$("#"+this.options.divId).css("width",s.options.dropDivWidth+"px"):this.options.width?$("#"+s.options.divId).css("width",s.options.width-3+"px"):$("#"+this.options.divId).css("width","188px"),$("#"+this.options.containerId).mouseout(function(){if(s.options.required&&s.options.isCheck){mCheck=$("#"+s.options.inputId);var t=$("#"+s.options.id).val();null==t||""==t||t==undefined?mCheck.checkTip({show:function(){return!1},Message:s.options.missingMessage}):(mCheck.checkTip({show:function(){return!0}}),$("#"+s.options.id).parent().find(".errorbox_ipt_help").remove())}});var e=""
;if(!0===s.options.filter)for(var i=s.options.showDatas,n=0;n<i.length;n++)null!=i[n].index&&-1==i[n].desc.indexOf(":")?e+="<div  value='"+i[n].name+"'>"+i[n].index+":"+i[n].desc+"</div>":e+="<div  value='"+i[n].name+"'>"+i[n].desc+"</div>";else $("#"+s.options.id).find("option").each(function(){e+="<div  value='"+$(this).attr("value")+"'>"+$(this).text()+"</div>"});$("#"+s.options.divId).append(e),$("#"+s.options.divId).off(),$("#"+s.options.divId).bind("mouseover",function(t){s.options.isCheck=!1,$(t.target).addClass("selected")}).bind("mouseout",function(t){$(t.target).removeClass("selected")}).bind("click",function(t){var e=$("#"+s.options.id).val(),i=$("#"+s.options.id).find("option:selected").text();$("#"+s.options.id).find("option:selected").each(function(){$(this).removeAttr("selected")});var n=$(t.target).attr("value");if(n!=undefined){var o=$(t.target).text();if($("#"+s.options.id).find("option").each(function(){
$(this).attr("value")==n&&$(this).text()==o&&$(this).attr("selected","selected")}),$("#"+s.options.inputId).val(o),s.options.onSelect&&$.isFunction(s.options.onSelect)&&s.options.onSelect(),(e!=n||i!=o)&&s.options.onChange&&$.isFunction(s.options.onChange)&&s.options.onChange(),s.options.required){mCheck=$("#"+s.options.inputId);var a=$("#"+s.options.id).val();null==a||""==a||a==undefined?mCheck.checkTip({show:function(){return!1},Message:s.options.missingMessage}):($("#"+s.options.id).siblings("input").removeAttr("error"),mCheck.checkTip({show:function(){return!0}}),$("#"+s.options.id).parent().find(".errorbox_ipt_help").remove())}$("#"+s.options.divId).css("display","none"),window.clearInterval(s.intervalId)}}).bind("mouseleave",function(t){if(s.options.isCheck=!0,s.hideDiv(),window.clearInterval(s.intervalId),$("#"+s.options.inputId).css("border-color","#c5c5c5"),$("#"+s.options.spanId).css("border-color","#c5c5c5"),$("#"+s.options.inputId).trigger("blur"),
"undefined"!=typeof s.options.historyKey&&""!=s.options.historyKey){var e=$("#"+s.options.id).val();null!=e&&""!=e&&PJF.communication.client.isInP2()&&PJF.communication.client.pjfCache("set",s.options.historyKey,e)}}),$("#"+this.options.divId).css("display","block"),350<(l=$("#"+s.options.divId).height())&&$("#"+s.options.divId).css("max-height","350px"),s.options.maxHeight&&$("#"+s.options.divId).css("max-height",s.options.maxHeight+"px"),l=$("#"+s.options.divId).height(),"6.0"==$.browser.version&&(l=l>s.options.maxHeight?s.options.maxHeight-2:l);var o=t.top+l,a=$(document).height(),r=$(document.body).scrollTop(),c=$(document.body).scrollLeft();a<o?t.top-$("#"+s.options.id).innerHeight()-l<0&&0==r?$("#"+s.options.containerId).css("left",t.left+"px"):$.browser.safari?($("#"+s.options.containerId).css("top",t.top-2-l+"px"),$("#"+s.options.containerId).css("left",t.left+"px")):($("#"+s.options.containerId).css("top",t.top+r-2-l+"px"),
$("#"+s.options.containerId).css("left",t.left+c+"px")):$.browser.msie&&"10.0"!=$.browser.version?($("#"+s.options.containerId).css("top",t.top+r+$("#"+s.options.inputId).innerHeight()+2+"px"),$("#"+s.options.containerId).css("left",t.left+c+"px")):($("#"+s.options.containerId).css("top",t.top+$("#"+s.options.inputId).innerHeight()+2+"px"),$("#"+s.options.containerId).css("left",t.left+"px"));var l=$("#"+s.options.divId).height(),d=$("#"+s.options.divId).css("max-height");d&&l>d.substring(0,d.indexOf("px"))&&$("#"+s.options.divId).css("height",d),s.fixPosition(),s.options.addDivFlag=!1,s.options.filter&&s.moveDown()}},fixPosition:function(){var r=this;"block"==$("#"+this.options.divId).css("display")&&(window.clearInterval(r.intervalId),r.intervalId=window.setInterval(function(){var t=$("#"+r.options.inputId).offset();350<(a=$("#"+r.options.divId).height())&&$("#"+r.options.divId).css("max-height","350px"),
r.options.maxHeight&&$("#"+r.options.divId).css("max-height",r.options.maxHeight+"px"),a=$("#"+r.options.divId).height(),"6.0"==$.browser.version&&(a=a>r.options.maxHeight?r.options.maxHeight-2:a);var e=t.top+a,i=$(document).height(),n=$(document.body).scrollTop(),o=$(document.body).scrollLeft();i<e?t.top-$("#"+r.options.id).innerHeight()-a<0&&0==n?$("#"+r.options.containerId).css("left",t.left+"px"):$.browser.safari?($("#"+r.options.containerId).css("top",t.top-2-a+"px"),$("#"+r.options.containerId).css("left",t.left+"px")):($("#"+r.options.containerId).css("top",t.top+n-2-a+"px"),$("#"+r.options.containerId).css("left",t.left+o+"px")):$.browser.msie&&"10.0"!=$.browser.version?($("#"+r.options.containerId).css("top",t.top+n+$("#"+r.options.inputId).innerHeight()+2+"px"),$("#"+r.options.containerId).css("left",t.left+o+"px")):($("#"+r.options.containerId).css("top",t.top+$("#"+r.options.inputId).innerHeight()+2+"px"),$("#"+r.options.containerId).css("left",t.left+"px"))
;var a=$("#"+r.options.divId).height(),s=$("#"+r.options.divId).css("max-height");s&&a>s.substring(0,s.indexOf("px"))&&$("#"+r.options.divId).css("height",s)},100))},multiple:function(){var e=this,t=new Array;$("#"+this.options.id).find("option").each(function(){$(this).attr("selected")&&""!=$(this).attr("value")&&$(this).attr("value")!=undefined&&t.push($(this).text())}),0<t.length?$("#"+this.options.inputId).val(t.toString()):1==e.options.nullOption&&$("#"+this.options.inputId).val($("#"+e.options.id).find("option").eq(0).text()),$("#"+this.options.spanId).bind("click",function(){PJF.constants.KEYBOARD_ENABLE&&e.addDiv(),$("#"+e.options.inputId).trigger("focus")}),$("#"+this.options.inputId).bind("click",function(){PJF.constants.KEYBOARD_ENABLE&&e.addDiv(),$("#"+e.options.inputId).trigger("focus")}),window.opera?$("#"+this.options.inputId).keypress(function(t){e.keyPress(t)}):$("#"+this.options.inputId).keydown(function(t){e.keyPress(t)}),
$("#"+this.options.inputId).bind("focus",function(){$(this).parent().addClass("focus-border-select"),PJF.constants.KEYBOARD_ENABLE||e.addDiv()})},hideDiv:function(){var t=this;t.options.isClick&&$("#"+t.options.divId).css("display","none"),t.options.hideDivId=setTimeout(function(){t.options.isCheck&&$("#"+t.options.divId).css("display","none")},1e3)},addDiv:function(){var s=this;if("block"!=$("#"+s.options.divId).css("display")){var t=$("#"+s.options.id);if(t&&"addDivFlag"==t.attr("addDivFlag")&&(s.options.addDivFlag=!0,t.removeAttr("addDivFlag")),!$("#"+s.options.inputId).hasClass("pjf_disabled_input")){$("#"+s.options.inputId).css("border-color","74b5E8"),$("#"+s.options.spanId).css("border-color","#74b5E8");var e=$("#"+this.options.id).parent().offset();if(!$("#"+s.options.inputId).attr("disabled")){if(0<$("#"+s.options.divId).length&&!this.options.addDivFlag)return $("#"+this.options.divId).css("display","block"),void s.fixPosition();s.options.selectIndex=-1,
$("#"+this.options.containerId).remove(),$('<div id="'+this.options.containerId+'" style="position:absolute;top:0px;left:0px;z-index:9999;"><div class="autocomplete-w1"><div class="autocomplete1" id="'+this.options.divId+'" style="display:none"></div></div></div>').appendTo("body"),this.options.dropDivWidth?"auto"!=this.options.dropDivWidth&&$("#"+this.options.divId).css("width",s.options.dropDivWidth+"px"):this.options.width?$("#"+s.options.divId).css("width",s.options.width-3+"px"):$("#"+this.options.divId).css("width","188px"),$("#"+this.options.containerId).mouseover(function(){s.options.isCheck=!1});var i="";$("#"+this.options.id+" option").each(function(){i+="<div class='pjf_select_div' value='"+$(this).attr("value")+"'><input type='checkbox'  value='"+$(this).attr("value")+"'","selected"==$(this).attr("selected")&&(i+="checked='checked' "),i+="/>"+$(this).text()+"</div>"}),$("#"+s.options.divId).append(i),$("#"+s.options.divId).off(),
$("#"+s.options.divId).bind("click",function(t){var e;s.options.isCheck=!1,"checkbox"==t.target.type?e=$(t.target):1==(e=$(t.target).find("input")).length&&(e.attr("checked")?e.removeAttr("checked"):e.attr("checked","checked"));var i=e.attr("value");""!=i?$("#"+s.options.id+" option").each(function(){""==$(this).attr("value")&&$(this).removeAttr("selected"),i==$(this).attr("value")&&($(this).attr("selected")?$(this).removeAttr("selected"):$(this).attr("selected",!0))}):e.parent().text()==resource.SELECT_ALL_SELECT&&("checked"==e.attr("checked")?s.selectAll():s.unSelectAll()),e.attr("checked")?$.isFunction(s.options.mulClick)&&s.options.mulClick(i):$.isFunction(s.options.cancelClick)&&s.options.cancelClick(i);var n=[];if($("#"+s.options.id).find("option:selected").each(function(){""!=$(this).val()&&$(this).val()!=undefined&&n.push($(this).text())}),0<n.length||!s.options.nullOption)$("#"+s.options.inputId).val(n.toString());else if(1==s.options.nullOption){
var o=s.el.find("option").eq(0).text();$("#"+s.options.inputId).val(o)}if(s.options.onChange&&s.options.onChange(),s.options.required){mCheck=$("#"+s.options.inputId);var a=$("#"+s.options.id).val();null==a||""==a||a==undefined?mCheck.checkTip({show:function(){return!1},Message:s.options.missingMessage}):($("#"+s.options.id).siblings("input").removeAttr("error"),mCheck.checkTip({show:function(){return!0}}),$("#"+s.options.id).parent().find(".errorbox_ipt_help").remove())}}).bind("mouseover",function(t){$("#"+s.options.inputId).css("border-color","#74b5E8"),s.options.isCheck=!1,$(t.target).addClass("selected")}).bind("mouseout",function(t){s.options.isCheck=!1,$(t.target).removeClass("selected")}).bind("mouseleave",function(t){if($("#"+s.options.inputId).css("border-color","#c5c5c5"),$("#"+s.options.spanId).css("border-color","#c5c5c5"),$(this).css("display","none"),window.clearInterval(s.intervalId),"undefined"!=typeof s.options.historyKey&&""!=s.options.historyKey){
var e=$("#"+s.options.id).val();null!=e&&""!=e&&PJF.communication.client.isInP2()&&PJF.communication.client.pjfCache("set",s.options.historyKey,e)}}),$("#"+this.options.divId).css("display","block"),350<(c=$("#"+this.options.divId).height())&&$("#"+this.options.divId).css("max-height","350px"),s.options.maxHeight&&$("#"+this.options.divId).css("max-height",s.options.maxHeight+"px"),c=$("#"+this.options.divId).height(),"6.0"==$.browser.version&&(c=c>s.options.maxHeight?s.options.maxHeight-2:c),"8.0"==$.browser.version&&(c-=17);var n=e.top+c,o=$(document).height(),a=$(document.body).scrollTop(),r=$(document.body).scrollLeft();o<n?e.top-$("#"+this.options.id).innerHeight()-c<0?$("#"+this.options.containerId).css("left",e.left+"px"):$.browser.safari?($("#"+this.options.containerId).css("top",e.top-2-c+"px"),$("#"+this.options.containerId).css("left",e.left+"px")):($("#"+this.options.containerId).css("top",e.top+a-2-c+"px"),
$("#"+this.options.containerId).css("left",e.left+r+"px")):$.browser.msie&&"10.0"!=$.browser.version?($("#"+this.options.containerId).css("top",e.top+a+$("#"+this.options.inputId).innerHeight()+2+"px"),$("#"+this.options.containerId).css("left",e.left+r+"px")):($("#"+this.options.containerId).css("top",e.top+$("#"+this.options.inputId).innerHeight()+2+"px"),$("#"+this.options.containerId).css("left",e.left+"px"));var c=$("#"+this.options.divId).height(),l=$("#"+this.options.divId).css("max-height");l&&c>l.substring(0,l.indexOf("px"))&&$("#"+s.options.divId).css("height",l),s.fixPosition(),s.options.addDivFlag=!1}}}},keyPressUp:function(t,e){var o,i=this;if(i.options.filter&&!i.options.multiple){if(-1==PJF.util.array.indexOf([13,107,9,38,40,27],t.keyCode)){var n=$("#"+i.options.inputId),a=!1,s=(o=[],$("#"+i.options.id).find("option").each(function(){var t=new Object,e=$(this).val(),i=$(this).text(),n=i.substring(0,i.indexOf(":"));t.name=e,t.desc=i,""!=n&&(t.index=n),o.push(t)}),
o),r=[],c=$.trim(n.val());if(i.previousValue!=c){if(""===c)r=s;else{for(var l=0;l<s.length;l++){if((v=$.trim(s[l].desc.toLowerCase()))==(_=$.trim(c.toLowerCase()))){var d=(r=s).splice(l,1)[0];!0===i.options.nullOption&&c!=resource.SELECT_NULLlOPTION_LABEL?r.splice(1,0,d):r.splice(0,0,d),a=!0,s=r;break}}if(!a){var u,h=[];if(!0===i.options.fenciFlag)if(PJF.communication.client.isInP2())if(0==(u=i.options.fuzzyFlag?(c="0"+c).split(""):PJF.communication.client.doCommonCommand("FenciCommandHandler",c))[0]&&1<u.length)for(var p=1;p<u.length;p++)h.push(u[p]);else h.push(c);else h.push(c);else for(var f=0;f<c.length;f++)h.push(c.charAt(f));for(var m=0;m<h.length;m++){var g=[];for(l=0;l<s.length;l++){var v=$.trim(s[l].desc.toLowerCase()),_=$.trim(h[m].toLowerCase()),b=PJF.util.getPinyinDict();if(!0===i.options.pinyinFlag){var y="";for(f=0;f<v.length;f++)"undefined"==typeof b[v[f]]?y+="":y+=b[v[f]].replace(/,/g,"");if(s[l].desc==resource.SELECT_NULLlOPTION_LABEL)continue
;var P=(v+y).indexOf(_,s[l].lastIndexValue?s[l].lastIndexValue+1:0);0<=P&&(!s[l].lastIndexValue||s[l].lastIndexValue<P)&&(s[l].lastIndexValue=P,g.push(s[l]))}else 0<=v.indexOf(_,0)&&g.push(s[l])}s=g}}}i.options.showDatas=s,i.previousValue=c,(i.options.addDivFlag=!0)===e&&i.addSingleDiv()}}}},keyPress:function(t){var o=this;if(!this.el.hasClass("pjf_readonly_input")&&!this.el.hasClass("pjf_disable_input")){if(!PJF.constants.KEYBOARD_ENABLE||o.options.multiple||$("#"+o.options.inputId).hasClass("pjf_readonly_input"))switch(t.keyCode){case 27:break;case 9:return void $("#"+this.options.divId).css("display","none");case 13:if(-1===this.options.selectIndex)return void PJF.ui.componentMgr.getNextComp(o).focus();o=this;var e=$("#"+this.options.id).find("option").eq(o.options.selectIndex),i=$("#"+this.options.divId).find("div").eq(o.options.selectIndex)
;"checked"==i.find("input:checkbox").attr("checked")?i.find("input:checkbox").removeAttr("checked"):i.find("input:checkbox").attr("checked","checked");var n=$("#"+o.options.id).val();o.options.multiple&&e.attr("selected")?e.removeAttr("selected"):e.attr("selected",!0),i.text()==resource.SELECT_ALL_SELECT&&("checked"==i.find("input:checkbox").attr("checked")?o.selectAll():o.unSelectAll());var a=new Array;$("#"+this.options.id).find("option:selected").each(function(){$(this).attr("selected")&&""!=$(this).attr("value")&&$(this).attr("value")!=undefined&&a.push($(this).text())}),$("#"+o.options.inputId).val(a.toString()),n!=e.val()&&o.options.onChange&&$.isFunction(o.options.onChange)&&o.options.onChange(),$("#"+this.options.divId).css("display","none"),PJF.ui.componentMgr.getNextComp(o).focus();break;case 38:
if("block"==$("#"+o.options.divId).css("display"))if(-1<o.options.selectIndex)this.moveUp();else PJF.ui.componentMgr.getPreviousComp(o).focus();else PJF.ui.componentMgr.getPreviousComp(o).focus();break;case 40:this.moveDown();break;default:return}else{switch(t.keyCode){case 13:if("block"==$("#"+o.options.divId).css("display"))if(-1<o.options.selectIndex)o.options.enterSelect=!0,window.clearInterval(o.setInterval),o.options.isNumFlag=!0,o.setInterval=window.setInterval(function(){parseInt(o.options.keyBoardArray.join(""));var t=$("#"+o.options.id),e=t.val();$("#"+o.options.id).find("option").each(function(t){var e=$(this).text();if(e==$("#"+o.options.divId).find("div").eq(o.options.selectIndex).text()){var i=$(this).attr("value");$("#"+o.options.id).val(i),$("#"+o.options.inputId).val(e)}}),o.options.keyBoardArray=[];var i=t.val();i?o.options.required&&($("#"+o.options.inputId).checkTip({show:function(){return!0}}),
$("#"+o.options.inputId).siblings("div.errorbox_ipt_help").remove()):o.options.required&&$("#"+o.options.inputId).checkTip({show:function(){return!1},Message:o.options.missingMessage}),$("#"+o.options.divId).css("display","none"),$("#"+o.options.inputId).focus(),o.options.onChange&&e!=i&&o.options.onChange(),o.options.enterSelect&&(PJF.ui.componentMgr.getNextComp(o).focus(),o.options.enterSelect=!1),window.clearInterval(o.setInterval)},300);else PJF.ui.componentMgr.getNextComp(o).focus();else PJF.ui.componentMgr.getNextComp(o).focus();break;case 107:"block"==$("#"+o.options.divId).css("display")&&0<$("#"+o.options.divId).find("div.selected").length?$("#"+o.options.divId).find("div").each(function(t){if($(this).hasClass("selected")){var e=$(this).attr("value"),i=$("#"+o.options.id).find("option").eq(t).text(),n=$("#"+o.options.id).val();$("#"+o.options.id).val(e),$("#"+o.options.inputId).val(i),$("#"+o.options.divId).css("display","none"),o.options.onChange&&n!=e&&o.options.onChange(),
e?(o.options.required&&$("#"+o.options.inputId).checkTip({show:function(){return!0}}),$("#"+o.options.inputId).removeClass("validatebox-tipcolor").siblings(".errorbox_ipt_help").remove(),$("#"+o.options.inputId).parent().removeClass("validatebox-tipcolor")):o.options.required&&$("#"+o.options.inputId).checkTip({show:function(){return!1},Message:o.options.missingMessage})}}):o.addSingleDiv();break;case 9:return void(!$("#"+o.options.id).val()&&o.options.required?($("#"+o.options.inputId).checkTip({show:function(){return!1},Message:o.options.missingMessage}),t.stopImmediatePropagation(),$("#"+o.options.inputId).focus()):($("#"+o.options.inputId).css("border-color","#C5C5C5").checkTip({show:function(){return!0}}),$("#"+o.options.inputId).siblings("div.errorbox_ipt_help").remove()));case 38:if("block"==$("#"+o.options.divId).css("display"))if(-1<o.options.selectIndex)this.moveUp();else PJF.ui.componentMgr.getPreviousComp(o).focus();else PJF.ui.componentMgr.getPreviousComp(o).focus();break
;case 40:if("block"==$("#"+o.options.divId).css("display"))this.moveDown();else PJF.ui.componentMgr.getNextComp(o).focus();break;default:return}}t.stopImmediatePropagation(),t.preventDefault()}},scrollPosition:function(t){var e=$("#"+this.options.divId);e.scrollLeft(1);var i=e.scrollLeft();e.scrollLeft(0);var n=e.height()-(0<i?17:0),o=parseInt(e.scrollTop()/27),a=parseInt(n/27);if(this.options.selectIndex+1<=o+1||this.options.selectIndex+1>o+a){var s=0;"up"==t&&(s=27*this.options.selectIndex),"down"==t&&(s=27-n%27+27*(this.options.selectIndex-a)),e.scrollTop(s)}},moveUp:function(){0!=this.options.selectIndex&&(this.options.selectIndex-=1),$("#"+this.options.divId).find("div").eq(this.options.selectIndex).addClass("selected"),$("#"+this.options.divId).find("div").eq(this.options.selectIndex+1).removeClass("selected"),this.scrollPosition("up")},moveDown:function(){var t=$("#"+this.options.divId).find("div").length
;this.options.selectIndex<t-1&&(this.options.selectIndex!=t-1&&(this.options.selectIndex+=1),$("#"+this.options.divId).find("div").eq(this.options.selectIndex).addClass("selected"),0<=this.options.selectIndex-1&&$("#"+this.options.divId).find("div").eq(this.options.selectIndex-1).removeClass("selected")),this.scrollPosition("down")},insert:function(){var t="<select id='"+this.options.id+"' class='pjf_select' name='"+this.options.name+"'";if(this.options.multiple&&(t+=" multiple='multiple'"),t+=">",1==this.options.nullOption&&(t+="<option value=''>"+this.options.nullOptionLabel+"</option>"),this.options.parentId=this.el.attr("id"),this.el.addClass("pjf_select_parent"),this.options.data){var e=this.options.data.length;this.options.multiple&&this.options.isSelectAll&&0<e&&(t+="<option value=''>"+resource.SELECT_ALL_SELECT+"</option>");for(var i=0;i<e;i++){var n=this.options.data[i]
;t=PJF.constants.KEYBOARD_ENABLE&&!this.options.multiple&&null!=n.index?t+"<option value='"+n[optionValue]+"'>"+n.index+":"+n[optionText]+"</option>":t+"<option value='"+n[optionValue]+"'>"+n[optionText]+"</option>"}}$(t+="</select>").appendTo(this.el)},adapter:function(){var me=this,time1=(new Date).getTime();if(this.options.id=this.el.attr("id"),this.el.attr("name")&&(this.options.name=this.el.attr("name")),!this.el.parent().hasClass("pjf_select_parent")){var wrapHtml="<span class='pjf_select_parent' id='"+this.options.parentId+"'></span>";this.el.wrap(wrapHtml)}if(this.options.formatter){var arr=this.getAllOptions(),data=this.options.formatter(arr);this.removeAll(),this.addOptions(data)}var first=$("#"+this.options.id+">option:first").text();if(first)try{first=eval("("+first+")"),$("#"+this.options.id+">option:first").text(first)}catch(e){console.log("获取p:select reqText多语言失败:"+e.message)}
this.options.nullOption&&""!=$("#"+this.options.id+">option:first").val()&&$("#"+this.options.id).prepend("<option selected='selected' value=''>"+resource.SELECT_NULLlOPTION_LABEL+"</option>"),PJF.constants.KEYBOARD_ENABLE&&!this.options.multiple&&this.options.tagIndex&&$("#"+this.options.id).find("option").each(function(t){var e=$(this).text(),i=$(this).val();i&&$(this).text(i+":"+e)}),this.options.width},change:function(){null!=this.options.onChange&&this.options.onChange()},remove:function(){$("#"+this.options.inputId).unbind(),$("#"+this.options.spanId).unbind(),$("#"+this.options.id).siblings().remove(),$("#"+this.options.id).remove(),$("#"+this.options.divId).remove(),this.options=null,this.params=null},focus:function(){$("#"+this.options.inputId).focus(),this.options.focusSelectAll&&($("#"+this.options.inputId)[0].selectionStart=0,$("#"+this.options.inputId)[0].selectionEnd=99999)},getSelectValue:function(t){var e=new Array;if(null==t||""==t)return $("#"+this.options.id).val()
;if(this.options.multiple)return $("#"+this.options.id).find("option:selected").each(function(){var t=$(this).text();e.push(t)}),e;if(PJF.constants.KEYBOARD_ENABLE){var i=$("#"+this.options.id).find("option:selected").text();return i.substring(i.indexOf(":")+1)}return $("#"+this.options.id).find("option:selected").text()},getValue:function(t){var e=new Array;return null==t||""==t?$("#"+this.options.id).val():this.options.multiple?($("#"+this.options.id).find("option:selected").each(function(){var t=$(this).text();e.push(t)}),e):$("#"+this.options.id).find("option:selected").text()},setSelectValue:function(t,e){this.setValue(t,e)},setValue:function(t,e){var i=!0;i=e==undefined||e;var n=this;n.options.required&&$("#"+n.options.inputId).addClass("validatebox-invalid invalid_box");var o=new Array;if($.isArray(t)){for(var a in $("#"+n.options.id).find("option:selected").each(function(){$(this).val||$(this).removeAttr("selected")}),
t)$("#"+n.options.id+" option[value='"+t[a]+"']").attr("selected",!0),"block"==$("#"+n.options.divId).css("display")&&$("#"+n.options.divId).find("input:checkbox[value='"+t[a]+"']").attr("checked","checked");n.options.onChange&&n.options.triggerChange&&i&&n.options.onChange()}else $("#"+n.options.id).val(t),n.options.onChange&&n.options.triggerChange&&i&&n.options.onChange();$("#"+this.options.id).find("option").each(function(t){if($(this).attr("selected")){var e=$(this).val(),i=$(this).text();n.options.multiple?""!=e&&e!=undefined&&null!=e&&o.push(i):o.push(i)}}),$("#"+n.options.inputId).val(o.toString()),""===t&&n.options.required&&$("#"+n.options.inputId).addClass("validatebox-invalid"),""!==t&&n.options.required&&($("#"+n.options.inputId).removeAttr("error"),$("#"+n.options.inputId).css("border-color","#C5C5C5"),$("#"+n.options.inputId).removeClass("validatebox-tipcolor").siblings(".errorbox_ipt_help").remove(),
$("#"+n.options.inputId).parent().removeClass("validatebox-tipcolor").css("border-color","#C5C5C5")),(this.options.addDivFlag=!0)!==n.options.filter||n.options.multiple||(n.options.showDatas=n.getShowDatas())},unSelect:function(t){var e=this;if($.isArray(t))for(var i in t)$("#"+e.options.id).find("option[value='"+t[i]+"']").removeAttr("selected"),$("#"+e.options.divId).find("input:checkbox[value="+t[i]+"]").removeAttr("checked");if(e.options.multiple){var n=new Array;$("#"+this.options.id).find("option:selected").each(function(){n.push($(this).text())}),$("#"+e.options.inputId).val(n.toString())}!$("#"+this.options.id).val()&&e.options.required&&$("#"+e.options.inputId).attr("error",e.options.missingMessage)},setNullValue:function(){$("#"+this.options.id).find("option:selected").removeAttr("selected");var t=$("#"+this.options.id).find("option[value='']");t.attr("selected","selected"),$("#"+this.options.inputId).val(t.text()),
this.options.required&&$("#"+this.options.inputId).attr("error",this.options.missingMessage)},selectAll:function(){var e=[],t=this;$("#"+this.options.id).find("option").each(function(){$(this).attr("selected")||""==$(this).attr("value")||$(this).attr("selected","selected");var t=$(this).text();t!=resource.SELECT_NULLlOPTION_LABEL&&e.push(t)}),$("#"+this.options.inputId).val(e.join(",")),this.options.divId&&$("#"+t.options.divId).find("input").each(function(){$(this).attr("checked","checked")}),0<$("#"+this.options.id).find("option").length&&t.options.required&&($("#"+t.options.inputId).removeAttr("error"),$("#"+t.options.inputId).css("border-color","#C5C5C5"),$("#"+t.options.inputId).removeClass("validatebox-tipcolor").siblings(".errorbox_ipt_help").remove(),$("#"+t.options.inputId).parent().removeClass("validatebox-tipcolor").css("border-color","#C5C5C5"))},unSelectAll:function(){$("#"+this.options.id).find("option:selected").each(function(){$(this).removeAttr("selected")}),
document.getElementById(this.options.id).value=null,this.options.divId&&$("#"+this.options.divId).find("input:checked").each(function(){$(this).removeAttr("checked")}),this.options.multiple&&(this.options.nullOption?$("#"+this.options.inputId).val($("#"+this.options.id).find("option[value='']").text()):$("#"+this.options.inputId).val("")),this.options.required&&$("#"+this.options.inputId).attr("error",this.options.missingMessage)},show:function(){$("#"+this.options.id).parent().css("display","")},hide:function(){$("#"+this.options.id).parent().css("display","none")},isDisplay:function(){return"none"!=$("#"+this.options.id).parent().css("display")},disabled:function(){$("#"+this.options.inputId).attr("disabled","disabled").unbind("click").unbind("focus");var t=$("#"+this.options.spanId);t.unbind("click").unbind("click"),this.options.multiple?t.removeClass("pjf_span").addClass("pjf_span_disable"):t.removeClass("pjf_single_span").addClass("pjf_span_disable"),
$("#"+this.options.inputId).addClass(" pjf_disabled_input"),$("#"+this.options.id).attr("disabled","disabled"),$("#"+this.options.id).addClass("pjf_disabled_input"),$("#"+this.options.inputId).removeClass(" validatebox-tipcolor error-border"),$("#"+this.options.id).siblings("div.errorbox_ipt_help").remove(),$("#"+this.options.id).removeClass(" validatebox-tipcolor error-border"),$("#"+this.options.id).parent().removeClass(" validatebox-tipcolor error-border"),this.options.addDivFlag=!0},disable:function(){$("#"+this.options.inputId).attr("disabled","disabled").unbind("click").unbind("focus");var t=$("#"+this.options.spanId);t.unbind("click").unbind("click"),this.options.multiple?t.removeClass("pjf_span").addClass("pjf_span_disable"):t.removeClass("pjf_single_span").addClass("pjf_span_disable"),$("#"+this.options.inputId).addClass(" pjf_disabled_input"),$("#"+this.options.id).attr("disabled","disabled"),$("#"+this.options.id).addClass("pjf_disabled_input"),
$("#"+this.options.inputId).removeClass(" validatebox-tipcolor error-border"),$("#"+this.options.id).siblings("div.errorbox_ipt_help").remove(),$("#"+this.options.id).removeClass(" validatebox-tipcolor error-border"),$("#"+this.options.id).parent().removeClass(" validatebox-tipcolor error-border"),this.options.addDivFlag=!0},enable:function(){var t=this,e=$("#"+this.options.spanId);this.options.multiple?e.removeClass("pjf_span_disable").addClass("pjf_span"):e.removeClass("pjf_span_disable").addClass("pjf_single_span"),e.bind("click",function(){PJF.constants.KEYBOARD_ENABLE&&!t.options.multiple&&t.addSingleDiv(),$("#"+t.options.inputId).trigger("focus")}),$("#"+this.options.inputId).removeClass(" pjf_disabled_input"),$("#"+this.options.inputId).bind("click",function(){PJF.constants.KEYBOARD_ENABLE&&!t.options.multiple&&t.addSingleDiv(),$("#"+t.options.inputId).trigger("focus")}),$("#"+this.options.inputId).bind("focus",function(){if(t.options.multiple)t.addDiv();else{
if(PJF.constants.KEYBOARD_ENABLE)return;t.addSingleDiv()}}),$("#"+this.options.inputId).removeAttr("disabled"),$("#"+this.options.id).removeAttr("disabled"),$("#"+this.options.id).removeClass("pjf_disabled_input"),this.options.addDivFlag=!0},isDisabled:function(){return!!$("#"+this.options.inputId).hasClass("pjf_disabled_input")},removeAll:function(){$("#"+this.options.id).removeClass("pjf_select").find("option").remove(),$("#"+this.options.id).addClass("pjf_select"),$("#"+this.options.inputId).val(""),!$("#"+this.options.id).val()&&this.options.required&&($("#"+this.options.inputId).attr("error",this.options.missingMessage),$("#"+this.options.inputId).addClass("validatebox-invalid")),(this.options.addDivFlag=!0)!==this.options.filter||this.options.multiple||(this.options.showDatas=this.getShowDatas())},addOptions:function(t,e){var i=this,n=($("#"+i.options.id).find("option").length,t.length),o=!0;this.options.isSelectAll&&$("#"+i.options.id).find("option").each(function(){
var t=$(this).val(),e=$(this).text();""!=t||e!=resource.SELECT_ALL_SELECT||(o=!1)}),this.options.multiple&&this.options.isSelectAll&&0<n&&!0===o&&document.getElementById(i.options.id).options.add(new Option(resource.SELECT_ALL_SELECT,""));for(var a=0;a<n;a++){var s=document.getElementById(i.options.id).options.length;0<=e&&e+a<s&&(s=e+a),PJF.constants.KEYBOARD_ENABLE&&!i.options.multiple&&null!=t[a].index?document.getElementById(i.options.id).options.add(new Option(t[a].index+":"+t[a].desc,t[a].name),s):document.getElementById(i.options.id).options.add(new Option(t[a].desc,t[a].name),s)}var r=new Array;$("#"+this.options.id).find("option:selected").each(function(){var t=$(this).val(),e=$(this).text();i.options.multiple?""!=t&&t!=undefined&&null!=t&&r.push(e):r.push(e)}),$("#"+i.options.inputId).val(r.toString()),$("#"+this.options.id).val()&&$("#"+i.options.inputId).removeAttr("error"),i.options.filter&&(i.options.showDatas=t),
(i.options.addDivFlag=!0)!==i.options.filter||i.options.multiple||(i.options.showDatas=i.getShowDatas())},removeOptions:function(e){for(var n=this,t=$("#"+this.options.id).find("option"),i=e.length,o=0;o<i;o++)t.each(function(){if($(this).attr("value")==e[o]){var t=$(this)[0].index;document.getElementById(n.options.id).options.remove(t)}});var a=[];$("#"+this.options.id).find("option").each(function(t){if($(this).attr("selected")){var e=$(this).val(),i=$(this).text();""!=e&&null!=e&&e!=undefined&&n.options.multiple,a.push(i)}}),0<a.length?$("#"+n.options.inputId).val(a.toString()):$("#"+n.options.inputId).val(""),$("#"+this.options.id).val()&&$("#"+this.options.inputId).removeAttr("error"),this.options.required&&$("#"+n.options.inputId).addClass("validatebox-invalid"),(n.options.addDivFlag=!0)!==n.options.filter||n.options.multiple||(n.options.showDatas=n.getShowDatas())},addDefaultOption:function(t){var e=!1;$("#"+this.options.id).find("option").each(function(){
$(this).attr("value")==t.name&&(alert(resource.SELECT_EXISTVALUE_MSG+t.name+resource.SELECT_ADD_resource.SELECT_ADD_MSGMSG),e=!0),$(this).html()==t.desc&&(alert(resource.SELECT_EXISTTEXT_MSG+t.desc+resource.SELECT_ADD_MSG),e=!0)}),e||$("#"+this.options.id).prepend('<option value="'+t.name+'">'+t.desc+"</option>"),$("#"+this.options.id).val()&&$("#"+this.options.id).removeAttr("error")},triggerChange:function(){$("#"+this.options.id).change()},isReadOnly:function(){return!!$("#"+this.options.inputId).hasClass("pjf_readonly_input")},setReadOnly:function(t){var c=this;this.options.addDivFlag=!0,t?($("#"+this.options.inputId).attr("readOnly","readOnly").unbind("focus"),$("#"+this.options.divId).unbind("click").unbind("click"),$("#"+this.options.spanId).unbind("click").unbind("click"),c.options.multiple&&$("#"+this.options.spanId).click(function(){var t=$("#"+c.options.inputId).offset();c.options.selectIndex=-1,
0<$("#"+c.options.divId).length?$("#"+c.options.divId).empty():$('<div id="'+c.options.containerId+'" style="position:absolute;z-index:9999;"><div class="autocomplete-w1"><div class="autocomplete1" style="min-height:0%" id="'+c.options.divId+'" style="display:none;;"></div></div></div>').appendTo("body"),c.options.width?$("#"+c.options.divId).css("width",c.options.width+"px"):$("#"+c.options.divId).css("width","188px"),$("#"+c.options.containerId).css("top",t.top+2+$("#"+c.options.id).innerHeight()+"px"),$("#"+c.options.containerId).css("left",t.left+"px");var e="";$("#"+c.options.id+" option").each(function(){e+="<div  value='"+$(this).attr("value")+"'><input type='checkbox' disabled='disabled' value='"+$(this).attr("value")+"' ","selected"==$(this).attr("selected")&&(e+="checked='checked' "),e+="/>"+$(this).text()+"</div>"}),$("#"+c.options.divId).append(e),$("#"+c.options.divId).css("display","block"),
350<(s=$("#"+c.options.divId).height())&&$("#"+c.options.divId).css("max-height","350px"),c.options.maxHeight&&$("#"+c.options.divId).css("max-height",c.options.maxHeight+"px"),s=$("#"+c.options.divId).height(),"6.0"==$.browser.version&&(s=s>c.options.maxHeight?c.options.maxHeight-2:s),"8.0"==$.browser.version&&(s-=17);var i=t.top+s,n=$(document).height(),o=$(document.body).scrollTop(),a=$(document.body).scrollLeft();n<i?t.top-$("#"+c.options.id).innerHeight()-s<0?$("#"+c.options.containerId).css("left",t.left+"px"):$.browser.safari?($("#"+c.options.containerId).css("top",t.top-2-s+"px"),$("#"+c.options.containerId).css("left",t.left+"px")):($("#"+c.options.containerId).css("top",t.top+o-2-s+"px"),$("#"+c.options.containerId).css("left",t.left+a+"px")):$.browser.msie&&"10.0"!=$.browser.version?($("#"+c.options.containerId).css("top",t.top+o+$("#"+c.options.inputId).innerHeight()+2+"px"),
$("#"+c.options.containerId).css("left",t.left+a+"px")):($("#"+c.options.containerId).css("top",t.top+$("#"+c.options.inputId).innerHeight()+2+"px"),$("#"+c.options.containerId).css("left",t.left+"px"));var s=$("#"+c.options.divId).height(),r=$("#"+c.options.divId).css("max-height");r&&s>r.substring(0,r.indexOf("px"))&&$("#"+c.options.divId).css("height",r),c.fixPosition(),$("#"+c.options.divId).unbind("click"),$("#"+c.options.divId).bind("mouseleave",function(t){if($(this).css("display","none"),window.clearInterval(c.intervalId),"undefined"!=typeof c.options.historyKey&&""!=c.options.historyKey){var e=$("#"+c.options.id).val();null!=e&&""!=e&&PJF.communication.client.isInP2()&&PJF.communication.client.pjfCache("set",c.options.historyKey,e)}})}),$("#"+this.options.inputId).addClass("pjf_readonly_input")):(!0===this.options.filter&&$("#"+this.options.inputId).removeAttr("readOnly"),$("#"+this.options.inputId).removeClass("pjf_readonly_input"),
$("#"+this.options.spanId).unbind("click").unbind("click"),$("#"+c.options.inputId).unbind("focus"),$("#"+c.options.divId).find("input:checkbox").each(function(){$(this).unbind("dbClick")}),$("#"+this.options.spanId).bind("click",function(){PJF.constants.KEYBOARD_ENABLE&&!c.options.multiple&&c.addSingleDiv(),$("#"+c.options.inputId).trigger("focus")}),$("#"+this.options.inputId).bind("click",function(){PJF.constants.KEYBOARD_ENABLE&&!c.options.multiple&&c.addSingleDiv(),$("#"+c.options.inputId).trigger("focus")}),$("#"+this.options.inputId).bind("focus",function(){if(c.options.isCheck=!0,$(this).parent().addClass("focus-border-select"),c.options.multiple)c.addDiv();else{if(PJF.constants.KEYBOARD_ENABLE)return;c.addSingleDiv()}}))},showTip:function(){$("#"+this.options.id).checkTip()},getAllOptions:function(){var e=[];return $("#"+this.options.id).find("option").each(function(){var t=new Object;t.name=$(this).val(),t.desc=$(this).text(),e.push(t)}),
PJF.constants.KEYBOARD_ENABLE&&1<this.options.data.length?this.options.data:e},focusable:function(){return!(0==$("#"+this.options.inputId).parent().find("input:visible").length||$("#"+this.options.inputId).hasClass("pjf_readonly_input")||$("#"+this.options.inputId).hasClass("pjf_disable_input")||$("#"+this.options.inputId).attr("disabled"))},setRequired:function(t){var e=this;t?(e.options.required=!0,$("#"+e.options.id).val()||$("#"+e.options.inputId).attr("error",e.options.missingMessage),$("#"+e.options.inputId).addClass("validatebox-invalid invalid_box")):($("#"+e.options.inputId).removeAttr("error"),e.options.required=!1,$("#"+e.options.inputId).removeClass("validatebox-invalid invalid_box"),$("#"+e.options.inputId).css("border-color","#C5C5C5"),$("#"+e.options.inputId).removeClass("validatebox-tipcolor").siblings(".errorbox_ipt_help").remove(),$("#"+e.options.inputId).parent().removeClass("validatebox-tipcolor").css("border-color","#C5C5C5"))}}}(jQuery),function(g){
var h="_left",p="_right";function f(t,e,i){var n=t.length,o="",a=i?e.rightDom:e.leftDom;if(i){for(var s=0;s<n;s++)if(!g(t[s]).is(":hidden"))if(e.isLeftToRight)o+="<li class='pjf_selectionBox_li'><a >"+g(t[s]).attr("label")+"</a><input "+a+" class='pjf_selectionBox_checkbox' value='"+g(t[s]).val()+"' label='"+g(t[s]).attr("label")+"' name='"+e.id+"'/></li>";else{var r=g(t[s]).val();if(0<g("#"+e.id+"_right").find("input[value='"+r+"']").length)continue;o+="<li class='pjf_selectionBox_li'><a>"+g(t[s]).attr("label")+"</a><input "+a+" class='pjf_selectionBox_checkbox' value='"+g(t[s]).val()+"' label='"+g(t[s]).attr("label")+"' name='"+e.id+"'/></li>"}g(o).appendTo(g("#"+e.id+"_right"))}else{for(s=0;s<n;s++)if(!g(t[s]).is(":hidden"))if(e.isLeftToRight)o+="<li class='pjf_selectionBox_li'><a>"+g(t[s]).attr("label")+"</a><input "+a+" class='pjf_selectionBox_checkbox' value='"+g(t[s]).val()+"' label='"+g(t[s]).attr("label")+"'/></li>";else{r=g(t[s]).val()
;if(0<g("#"+e.id+"_left").find("input[value='"+r+"']").length)continue;o+="<li class='pjf_selectionBox_li'><a>"+g(t[s]).attr("label")+"</a><input "+a+" class='pjf_selectionBox_checkbox' value='"+g(t[s]).val()+"' label='"+g(t[s]).attr("label")+"'/></li>"}g(o).appendTo(g("#"+e.id+"_left"))}e.getLRValue||null!=e.onchange&&e.onchange(i)}function m(t,e,i){if(1==t.length){var n=g("#"+e.dom+"_right li").find("input:checked").parent().prev(),o=g("#"+e.dom+"_right li").find("input:checked").parent().next();if(i){if(0<o.length){var a="<li class='pjf_selectionBox_li'><a>"+g(t[0]).attr("label")+"</a><input "+e.rightDom+" class='pjf_selectionBox_checkbox' value='"+g(t[0]).val()+"' label='"+g(t[0]).attr("label")+"' checked/></li>";g("#"+e.dom+"_right li").find("input:checked").parent().remove(),g(o).after(a)}}else if(0<n.length){
a="<li class='pjf_selectionBox_li'><a>"+g(t[0]).attr("label")+"</a><input "+e.rightDom+" class='pjf_selectionBox_checkbox' value='"+g(t[0]).val()+"' label='"+g(t[0]).attr("label")+"' checked/></li>";g("#"+e.dom+"_right li").find("input:checked").parent().remove(),g(n).before(a)}}}function v(t,e){g("#"+t+" li").each(function(){g(this).children("a").text().indexOf(e)<0?g(this).hide():g(this).show()})}function _(t,e,i,n,o,a,s,r,c){var l=o+"_search_text",d=o+"_search_a",u=o+"_selectAll",h=i-35,p=i-45;1!=r&&1!=c||(h-=25,p-=25);var f="height:"+p+"px;";1==a&&(f+=" overflow-x:auto;"),1==s&&(f+=" overflow-y:auto;");var m="<div class='pjf_selectionBox_customizehome_box_l pjf_selectionBox_index_box' style='"+("width:"+e+"px;height:"+i+"px;")+"'><div class='pjf_selectionBox_help_search pjf_selectionBox_help_search1'><a>"+n+"</a></div>";1!=r&&1!=c||(m+="<div class='pjf_selectionBox_help_search pjf_selectionBox_help_search1'>",
1==r&&(m+="<input class='pjf_selectionBox_search_text' id='"+l+"'/><a class='pjf_selectionBox_help_search_ok1' id='"+d+"'/>"),1==c&&(m+="<input type='checkbox' class='pjf_selectionBox_selectall pjf_selectionBox_checkbox' id='"+u+"'/>"),m+="</div>"),m+="<div class='pjf_selectionBox_customizehome_box_la pjf_selectionBox_box pjf_selectionBox_ml5 pjf_selectionBox_mr5' style='"+("width:"+(e-13)+"px;height:"+h+"px;")+"'><ul class='pjf_selectionBox_customizehome_nav' id='"+o+"' style='"+f+"'></ul></div></div>",t.append(m),g("#"+l).live("keyup",function(){v(o,g("#"+l).val());var t=g("#"+o).height(),e=g("#"+o).css("overflow-y");g("#"+o).css("overflow-y","hidden"),g("#"+o).css("overflow-y",e),g("#"+o).css("height",t+"px")}),g("#"+d).live("click",function(){v(o,g("#"+l).val())}),g("#"+u).live("click",function(){var t,e;t=o,e=g(this).is(":checked"),g("#"+t+" li").each(function(){g(this).is(":hidden")||(e?g(this).children("input").each(function(t){
g(this).attr("disabled")||g(this).parent().hasClass("notMove")||g(this).attr("checked","checked")}):g(this).children("input").removeAttr("checked"))})})}function b(t,e,i){var n="",o=t.data("selectionBox");for(var a in e){n+="<li class='pjf_selectionBox_li",e[a].notMove&&(n+=" notMove");var s="right"==i?o.rightDom:o.leftDom;n+="'><a >"+e[a].label+"</a><input "+s+" class='pjf_selectionBox_checkbox' label='"+e[a].label+"'","right"==i&&(n+="name='"+t.attr("id")+"'"),e[a].notMove&&(n+="disabled='disabled' "),n+=" value='"+e[a].id+"'/></li>"}return n}var e={init:function(d){(new Date).getTime(),Math.floor(1048576*Math.random()).toString(16);var u={dom:null,id:this.attr("id"),leftId:this.attr("id")+h,rightId:this.attr("id")+p,buttonId:this.attr("id")+"_button",leftLabelName:resource.SELECTIONBOX_LEFT_LABLENAME,rightLabelName:resource.SELECTIONBOX_RIGHT_LABLENAME,selectedPosition:"right",title:null,width:"400",height:"150",scrollx:!1,scrolly:!0,maxSelected:-1,leftSearch:!1,rightSearch:!1,
autoSort:!1,isLeftToRight:!1,upBlowMoveFlag:!1,onclick:null,leftMulti:!0,rightMulti:!0};return this.each(function(){var t=g(this),e=t.data("selectionBox");if(d){if(d.rightData)for(var i=0;i<d.rightData.length;i++)if(d.leftData)for(var n=d.leftData.length-1;0<=n;n--)d.leftData[n].label!=d.rightData[i].label&&d.leftData[n].id!=d.rightData[i].id||d.leftData.splice(n,1);g.extend(u,d);var o=PJF.util.generateUUid();u.leftDomName="pjf_selectionbox_leftradio_"+o,u.rightDomName="pjf_selectionbox_rightradio_"+o,u.leftDom=u.leftMulti?"type='checkbox'":"type='radio' name='"+u.leftDomName+"'",u.rightDom=u.rightMulti?"type='checkbox'":"type='radio' name='"+u.rightDomName+"'",u.leftSelectAll=!1!==u.leftMulti&&u.leftSelectAll,u.rightSelectAll=!1!==u.rightMulti&&u.rightSelectAll}e||t.data("selectionBox",u),function(t,e){
var i=t.attr("id")+(new Date).getTime()+"_"+Math.floor(1048576*Math.random()).toString(16),n=(e.width-105)/2,o=(e.height-90)/2,a="<div class='pjf_selectionBox_box pjf_selectionBox_standardModule pjf_selectionBox_selectionBox' style='width:"+e.width+"px'>";null!=e.title&&(a=a+"<div class='pjf_selectionBox_standardModule_tit'><h1>"+e.title+"</h1></div>"),a=a+"<div id='"+i+"' class='pjf_selectionBox_box_content' style='height:"+e.height+"px'></div>",a+="</div>",t.append(a);var s=g("#"+i);a=_(s,n,e.height,e.leftLabelName,e.leftId,e.scrollx,e.scrolly,e.leftSearch,e.leftSelectAll),
a="<div class='pjf_selectionBox_customizehome_box_c' style='padding-top:"+o+"px;'><div class='pjf_selectionBox_submit' id='"+e.buttonId+"'><span class='pjf_selectionBox_submit_btn'><input type='button' id='LtoR' value='"+resource.SELECTIONBOX_ADD+">>' style='width:57px'/></span><span class='pjf_selectionBox_submit_btn'><input type='button' id='RtoL' value='"+resource.SELECTIONBOX_DEL+"<<' style='width:57px'/></span>",e.upBlowMoveFlag&&(a+="<span class='pjf_selectionBox_submit_btn'><input type='button' id='BtoU' value='"+resource.SELECTIONBOX_UP+"︽' style='width:57px'/></span><span class='pjf_selectionBox_submit_btn'><input type='button' id='UtoB' value='"+resource.SELECTIONBOX_DOWN+"︾' style='width:57px'/></span>"),a+="</div></div>",g("#"+i).append(a),a=_(s,n,e.height,e.rightLabelName,e.rightId,e.scrollx,e.scrolly,e.rightSearch,e.rightSelectAll)}(t,u)
;var a=[g("#"+u.dom+h),g("#"+u.dom+p)],s="right"==u.selectedPosition?a[0]:a[1],r="right"==u.selectedPosition?a[1]:a[0],c=b(t,u.leftData,"left"),l=b(t,u.rightData,"right");g(c).appendTo(s),g(l).appendTo(r),g("#"+u.leftId+" li").live("dblclick",function(){if(!u.noDblClick){var t=g(this).find("input");if(g(this).find("input").eq(0).attr("disabled"))return;if(g(this).hasClass("notMove"))return;f(t,u,!0),u.isLeftToRight&&g(this).find("input").parent().remove()}}),g("#"+u.leftId+" li").find("a").live("click",function(){if(!g(this).siblings("input").attr("disabled")&&!g(this).parent().hasClass("notMove")){var t=g(this).siblings("input:checked").length;0<t?g(this).siblings("input").removeAttr("checked"):g(this).siblings("input").attr("checked","checked");var e=g(this).siblings("input");u.onLeftClick&&u.onLeftClick(0==t,{id:e.val(),label:e.attr("label")})}}),t.on("click","#"+u.leftId+" li input",function(t){
u.leftMulti||(g(this).attr("isChecked")?g(this).removeAttr("checked").removeAttr("isChecked"):(g(this).parent().siblings().find("input").each(function(){g(this).removeAttr("isChecked")}),g(this).attr("isChecked",!0)));u.onLeftClick&&u.onLeftClick(g(this).is(":checked"),{id:g(this).val(),label:g(this).attr("label")})}),g("#"+u.rightId+" li").live("dblclick",function(){if(!u.noDblClick){if(g(this).find("input").eq(0).attr("disabled"))return;if(g(this).hasClass("notMove"))return;f(g(this).find("input"),u,!1),g(this).remove()}}),g("#"+u.rightId+" li").find("a").live("click",function(){if(!g(this).siblings("input").attr("disabled")&&!g(this).parent().hasClass("notMove")){var t=g(this).siblings("input:checked").length;0<t?g(this).siblings("input").removeAttr("checked"):g(this).siblings("input").attr("checked","checked");var e=g(this).siblings("input");u.onRightClick&&u.onRightClick(0==t,{id:e.val(),label:e.attr("label")})}}),t.on("click","#"+u.rightId+" li input",function(t){
u.rightMulti||(g(this).attr("isChecked")?g(this).removeAttr("checked").removeAttr("isChecked"):(g(this).parent().siblings().find("input").each(function(){g(this).removeAttr("isChecked")}),g(this).attr("isChecked",!0)));u.onRightClick&&u.onRightClick(g(this).is(":checked"),{id:g(this).val(),label:g(this).attr("label")})}),g("#"+u.buttonId+" input").live("click",function(){if("LtoR"==g(this).attr("id")){var e=[];(t=u.moveVisible?g("#"+u.dom+"_left li:visible").find("input:checked"):g("#"+u.dom+"_left li").find("input:checked")).each(function(t){g(this).parent().hasClass("notMove")?g(this).removeAttr("checked"):e.push(g(this))}),f(e,u,!0),u.isLeftToRight&&t.parent().remove(),u.getLRValue&&null!=u.onchange&&u.onchange(!0)}else if("RtoL"==g(this).attr("id")){var t;e=[];(t=u.moveVisible?g("#"+u.dom+"_right li:visible").find("input:checked"):g("#"+u.dom+"_right li").find("input:checked")).each(function(t){g(this).parent().hasClass("notMove")?g(this).removeAttr("checked"):e.push(g(this))}),
f(e,u,!1),t.parent().remove(),u.getLRValue&&null!=u.onchange&&u.onchange(!1)}if(u.upBlowMoveFlag)if("BtoU"==g(this).attr("id")){e=[];g("#"+u.dom+"_right li").find("input:checked").each(function(t){g(this).parent().hasClass("notMove")?g(this).removeAttr("checked"):e.push(g(this))}),m(e,u,!1)}else if("UtoB"==g(this).attr("id")){e=[];g("#"+u.dom+"_right li").find("input:checked").each(function(t){g(this).parent().hasClass("notMove")?g(this).removeAttr("checked"):e.push(g(this))}),m(e,u,!0)}}),s.trigger("change")})},getValue:function(t){var e={field:"label"};g.extend(e,t);var i=this.attr("id"),n=[g("#"+i+h),g("#"+i+p)],o=null;o=null!=t&&"left"==t.dataArea?n[0]:n[1];var a=[];return"id"==e.field?o.find("input").each(function(){a.push(g(this).val())}):o.find("input").each(function(){a.push(g(this).attr("label"))}),a},getObject:function(t){var e=this.attr("id"),i=[g("#"+e+h),g("#"+e+p)],n=[];return(null!=t&&"left"==t?i[0]:i[1]).find("input").each(function(){var t={id:g(this).val(),
label:g(this).attr("label")};n.push(t)}),n},refresh:function(t,e){var i=null;"left"==t?i=h:"right"==t&&(i=p);var n=g("#"+this.attr("id")+i);n.children().remove(),n.append(b(this,e,t));var o=n.css("overflow-y"),a=n.css("overflow-x");a&&n.css("overflow-x",a),o&&n.css("overflow-y",o);var s=n.height();s&&n.css("maxHeight",s)},setMovable:function(e,t,i){var n=null;"left"==t?n=h:"right"==t&&(n=p);var o=g("#"+this.attr("id")+n);i?o.find("input").each(function(t){for(var t in e)e[t]==g(this).attr("value")&&g(this).removeAttr("disabled").parent().removeClass("notMove")}):o.find("input").each(function(t){for(var t in e)e[t]==g(this).attr("value")&&g(this).attr("disabled","disabled").parent().addClass("notMove")})},destroy:function(){return this.each(function(){var t=g(this),e=t.data("selectionBox");g("#"+t.attr("id")+p).find("li").remove(),e&&t.removeData("selectionBox"),t.children().remove()})}};g.fn.selectionBox=function(t){
return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?this:e.init.apply(this,arguments)}}(jQuery),function(y){function a(t,e){this.el=y(t),this.options={column:2},y.extend(this.options,e),this.initialize(),this.el.data("table",this)}y.fn.table=function(t,e,i,n){var o;return"string"!=typeof t?o=new a(this.get(0),t):(o=this.data("table"),"append"==t?o.append(e,i):"loadData"==t?o.loadData(e,i,n):"setData"==t?o.setData(e):void 0)},a.prototype={initialize:function(){y("#"+this.options.dom).find("table").remove();var t=this.options.column,e=this.options.jsonData,i=[],n=[],o=[],a=0,s="",r=[],c=(this.options.contentWidth,this.options.defaultLineHeight);if(e){s='<div class="pjf_table_div"><table class="pjf_table">';for(var l="",d=0,u=0,h=0;h<e.length;h++){if(e[h].data&&e[h].data.label&&y.trim(e[h].data.label)&&e[h].data.label.indexOf(":")<0&&e[h].data.label.indexOf("：")<0&&(e[h].data.label+="："),
e[h].title||"undefined"==typeof e[h].data.label||"undefined"!=typeof e[h].area&&1==e[h].area)e[h].title||"undefined"==typeof e[h].data.label||1!=e[h].area?e[h].title&&(l+=d%t==0?'<tr><td class = "pjf_td_title" colspan= "2" id ='+e[h].key+">"+e[h].title+"</td>":'<td class = "pjf_td_title" colspan= "2" id ='+e[h].key+">"+e[h].title+"</td>",e[h+1].title||(l+="</tr>"),h!=e.length-1&&d++):(e[h].moreData?l=this.jsonDataCollExpDivCreate(this,h,d,t,l):l+='<tr><td class="pjf_td_label">'+e[h].data.label+'</td><td colspan="+'+(2*t-1)+'+" class="pjf_td_content" id ='+e[h].key+">"+e[h].data.value+"</td></tr>",d=0,u=t);else if(e[h].data.label!=undefined&&e[h].data.value==undefined&&(e[h].data.value=""),d%t==0){if(e[h].moreData?l=this.jsonDataCollExpDivCreate(this,h,d,t,l):l+='<tr><td class="pjf_td_label" style="height:'+c+'">'+e[h].data.label+'</td><td class="pjf_td_content" id ='+e[h].key+">"+e[h].data.value+"</td>",d++,
++u!=t&&(e[h+1]==undefined||1==e[h+1].area))for(var p=t-u,f=0;f<p;f++)if(l+='<td class="pjf_td_label"></td><td class="pjf_td_content"></td>',++u==t){l+="</tr>";break}}else if(e[h].moreData?l=this.jsonDataCollExpDivCreate(this,h,d,t,l):l+='<td class="pjf_td_label">'+e[h].data.label+'</td><td class="pjf_td_content" id ='+e[h].key+">"+e[h].data.value+"</td>",d++,++u!=t&&(e[h+1]==undefined||1==e[h+1].area))for(p=t-u,f=0;f<p;f++)if(l+='<td class="pjf_td_label"></td><td class="pjf_td_content"></td>',++u==t){l+="</tr>";break}u==t&&(u=0)}s=s+l+"</table></div>"}else{i=this.options.label,n=this.options.data,r=this.options.moreData,o=this.options.title;this.options.dom;if(o&&o.length!=t)return alert("错误提示：请确定你的标题数！"),!1;a=i.length%t==0?i.length/t:i.length/t+1;var m=parseInt(a,10);s='<div class="pjf_table_div"><table class="pjf_table">';var g="",v="";if(o){for(f=0;f<o.length;f++)"undefined"!=typeof o[f]&&(v+='<td class="pjf_td_title" colspan= "2">'+o[f]+"</td>");g+="<tr>"+v+"</tr>"}
for(h=0;h<a;h++){for(var _="",b=h*t;b<h*t+t;b++)if("undefined"!=typeof i[b])r&&""!=r[b]?_=this.collExpDivCreate(this,b,_):(i[b]&&y.trim(i[b])&&i[b].indexOf(":")<0&&i[b].indexOf("：")<0&&(i[b]+="："),_+='<td class="pjf_td_label" style="height:'+c+'">'+i[b]+'</td><td class="pjf_td_content">'+n[b]+"</td>");else{if(b%t==0)break;_+='<td class="pjf_td_label"></td><td class="pjf_td_content"></td>'}h<m&&(g+="<tr>"+_+"</tr>")}s=s+g+"</table></div>"}y(s).appendTo(this.el)},remove:function(){y("#"+this.options.parentId).remove()},append:function(t,e){this.options.column;if(this.options.label)this.options.label=this.options.label.concat(t),this.options.data=this.options.data.concat(e);else if(this.options.jsonData)for(var i=0;i<t.length;i++)this.options.jsonData.push({key:"",data:{label:t[i],value:e[i]}});this.initialize()},loadData:function(t,e,i){var n=this.options.column;if(i&&i.length!=n)return alert(resource.TABLE_INIT_TITLENUMERR),!1;if(this.options.label)this.options.label=t,
this.options.data=e,this.options.title=i;else if(this.options.jsonData){this.options.jsonData=[];for(var o=0;o<t.length;o++)this.options.jsonData.push({key:"",data:{label:t[o],value:e[o]}})}this.initialize()},setData:function(t){for(var e=0;e<t.length;e++){var i=!1;if(this.options.jsonData){for(var n=0;n<this.options.jsonData.length;n++)t[e].key==this.options.jsonData[n].key&&(t[e].data&&t[e].data.label&&(this.options.jsonData[n].data.label=t[e].data.label),t[e].data&&t[e].data.value&&(this.options.jsonData[n].data.value=t[e].data.value),t[e].title&&(this.options.jsonData[n].title=t[e].title),i=!0);if(0==i)if(t[e]&&!t[e].title&&t[e].data.label)this.options.jsonData.push(t[e]);else if(!t[e].title&&!t[e].data.label)return alert(resource.TABLE_SETDATA_ADDLABELISNULL+t[e].key+resource.TABLE_SETDATA_ADDLABELISNULL1),!1}else t[e].data&&this.options.label&&(this.options.label.push(t[e].data.label),this.options.data.push(t[e].data.value))}this.initialize()},
jsonDataCollExpDivCreate:function(t,e,i,n,o){var a,s=t.options.jsonData,r=t.options.contentWidth,c=t.options.labelWidth,l=t.options.dom,d=l+"CollExpBtn"+e,u=l+"CollExpCont"+e,h="";return s[e].moreData&&(h=s[e].moreData.value),1==s[e].area?(a=""!=s[e].data.value?'<div style="position:relative;width:'+((n-1)*(c+r)+r-35)+'px;padding-right:5px">'+s[e].data.value+"<div id="+d+' style="position:absolute;right:-15px;bottom:0;width:15px;height:15px;"><a class = "pjf_table_moreDataContent_expand"></a></div></div><div id='+u+' style="width:'+((n-1)*(c+r)+r-35)+'px;display:none;padding-right:5px">'+h+"</div>":'<div style="position:relative;width:'+((n-1)*(c+r)+r-35)+'px;height:15px;padding-right:5px">'+s[e].data.value+"<div id="+d+' style="position:absolute;right:-15px;bottom:0;width:15px;height:15px;"><a class = "pjf_table_moreDataContent_expand"></a></div></div><div id='+u+' style="width:'+((n-1)*(c+r)+r-35)+'px;display:none;padding-right:5px">'+h+"</div>",
o+='<tr><td class="pjf_td_label">'+s[e].data.label+'</td><td colspan="+'+(2*n-1)+'+" class="pjf_td_content" id ='+s[e].key+">"+a+"</td></tr>"):(a=""!=s[e].data.value?'<div style="position:relative;width:'+(r-35)+'px;padding-right:5px">'+s[e].data.value+"<div id="+d+' style="position:absolute;right:-15px;bottom:0;width:15px;height:15px;"><a class = "pjf_table_moreDataContent_expand"></a></div></div><div id='+u+' style="width:'+(r-35)+'px;display:none;padding-right:5px">'+h+"</div>":'<div style="position:relative;width:'+(r-35)+'px;height:15px;padding-right:5px">'+s[e].data.value+"<div id="+d+' style="position:absolute;right:-15px;bottom:0;width:15px;height:15px;"><a class = "pjf_table_moreDataContent_expand"></a></div></div><div id='+u+' style="width:'+(r-35)+'px;display:none;padding-right:5px">'+h+"</div>",
o+=i%n==0?'<tr><td class="pjf_td_label">'+s[e].data.label+'</td><td class="pjf_td_content" id ='+s[e].key+">"+a+"</td>":'<td class="pjf_td_label">'+s[e].data.label+'</td><td class="pjf_td_content" id ='+s[e].key+">"+a+"</td>"),t.el.data(d,u),t.bindClick(t,d),o},collExpDivCreate:function(t,e,i){var n,o=t.options.dom,a=t.options.contentWidth,s=t.options.label,r=t.options.data,c=t.options.moreData,l=o+"CollExpBtn"+e,d=o+"CollExpCont"+e
;return n=""!=r[e]?'<div style="position:relative;width:'+(a-35)+'px;padding-right:5px">'+r[e]+"<div id="+l+' style="position:absolute;right:-15px;bottom:0;width:15px;height:15px;"><a class = "pjf_table_moreDataContent_expand"></a></div></div><div id='+d+' style="width:'+(a-35)+'px;display:none;padding-right:5px">'+c[e]+"</div>":'<div style="position:relative;width:'+(a-35)+'px;height:15px;padding-right:5px">'+r[e]+"<div id="+l+' style="position:absolute;right:-15px;bottom:0;width:15px;height:15px;"><a class = "pjf_table_moreDataContent_expand"></a></div></div><div id='+d+' style="width:'+(a-35)+'px;display:none;padding-right:5px">'+c[e]+"</div>",i+='<td class="pjf_td_label">'+s[e]+'</td><td class="pjf_td_content">'+n+"</td>",t.el.data(l,d),t.bindClick(t,l),i},bindClick:function(e,i){y("#"+i).die().live("click",function(){var t=e.el.data(i);y("#"+i).find("a").hasClass("pjf_table_moreDataContent_expand")?(y("#"+t).slideDown("slow"),
y("#"+i).find("a").removeClass("pjf_table_moreDataContent_expand"),y("#"+i).find("a").addClass("pjf_table_moreDataContent_collapse")):y("#"+i).find("a").hasClass("pjf_table_moreDataContent_collapse")&&(y("#"+t).slideUp("slow"),y("#"+i).find("a").removeClass("pjf_table_moreDataContent_collapse"),y("#"+i).find("a").addClass("pjf_table_moreDataContent_expand"))})}}}(jQuery),function($){function _18d(t){t.each(function(){$(this).remove(),$.browser.msie&&(this.outerHTML="")})}function _18e(t,e){var i=$.data(t,"pjfPanel").options,n=$.data(t,"pjfPanel").pjfPanel,o=n.children("div.pjfPanel-header"),a=n.children("div.pjfPanel-body");if(e&&(e.width?i.width=e.width:i.width="auto",e.height&&(i.height=e.height),null!=e.left&&(i.left=e.left),null!=e.top&&(i.top=e.top)),1==i.fit){var s=n.parent();s.addClass("pjfPanel-noscroll"),"BODY"==s[0].tagName&&$("html").addClass("pjfPanel-fit"),i.width=s.width(),i.height="auto"}n.css({left:i.left,top:i.top}),
isNaN(i.width)?$.browser.msie&&$.browser.version<"7.0"?(n.width("100%"),o.add(a).width("100%"),o.width("auto"),a.css("overflow","auto")):(n.width("auto"),o.add(a).width("auto")):(n.width(i.width),o.width(i.width),a.width(i.width)),$.browser.msie&&$.browser.version<"7.0"?(o.add(a).width("100%"),o.width("auto")):o.add(a).width("auto"),isNaN(i.height)?a.height("auto"):(n._outerHeight(i.height),a._outerHeight(n.height()-o._outerHeight())),n.css("height",""),i.onResize.apply(t,[i.width,i.height]),n.find(">div.pjfPanel-body>div").triggerHandler("_resize")}function _194(t,e){var i=$.data(t,"pjfPanel").options,n=$.data(t,"pjfPanel").pjfPanel;e&&(null!=e.left&&(i.left=e.left),null!=e.top&&(i.top=e.top)),n.css({left:i.left,top:i.top}),i.onMove.apply(t,[i.left,i.top])}function _198(t,e){$(t).addClass("pjfPanel-body");var i=$('<div class="pjfPanel"></div>').insertBefore(t);return i[0].appendChild(t),"auto"==e.height&&$.browser.msie&&$.browser.version<"8.0"?$(t).css({"overflow-x":"auto",
"overflow-y":"hidden","padding-bottom":"20px"}):$(t).css({"overflow-x":"auto","overflow-y":"auto","padding-bottom":"0px"}),i.bind("_resize",function(){return 1==$.data(t,"pjfPanel").options.fit&&_18e(t),!1}),i}function _19b(_19c){var opts=$.data(_19c,"pjfPanel").options,_19d=$.data(_19c,"pjfPanel").pjfPanel;if(opts.tools&&"string"==typeof opts.tools&&_19d.find(">div.pjfPanel-header>div.pjfPanel-tool .pjfPanel-tool-a").appendTo(opts.tools),_18d(_19d.children("div.pjfPanel-header")),opts.title&&!opts.noheader){var _19e=$('<div class="pjfPanel-header"><div class="pjfPanel-title">'+opts.title+"</div></div>").prependTo(_19d);if(opts.iconCls){_19e.find(".pjfPanel-title").addClass("pjfPanel-with-icon")
;var icon=$('<div class="pjfPanel-icon"></div>').addClass(opts.iconCls).appendTo(_19e),tipHtml="<div class='free_tip_panel' id="+opts.id+"_tipId><div class='free_tip_content'><span class='free_tip_up'>"+opts.tipMessage+"</span><span class='free_tip_arrow'></span></div><span class='free_tip_with_icon'></span></div>";$(tipHtml).insertBefore($("div.pjfPanel-header"))}var tool=$('<div class="pjfPanel-tool"></div>').appendTo(_19e);if(tool.bind("click",function(t){t.stopPropagation()}),opts.tools)if("string"==typeof opts.tools)$(opts.tools).children().each(function(){$(this).addClass($(this).attr("iconCls")).addClass("pjfPanel-tool-a").appendTo(tool)});else for(var i=0;i<opts.tools.length;i++){var t=$('<a href="javascript:void(0)"></a>').addClass(opts.tools[i].iconCls).appendTo(tool);opts.tools[i].handler&&t.bind("click",eval(opts.tools[i].handler))}opts.collapsible&&($('<a class="pjfPanel-tool-collapse" href="javascript:void(0)"></a>').appendTo(tool).bind("click",function(){
return 1==opts.collapsed?(opts.isRefresh=!1,_1b8(_19c,!0)):_1ad(_19c,!0),!1}),_19d.children("div.pjfPanel-header").find("div.pjfPanel-title").bind("click",function(){return 1==opts.collapsed?_1b8(_19c,!0):_1ad(_19c,!0),!1})),opts.minimizable&&$('<a class="pjfPanel-tool-min" href="javascript:void(0)"></a>').appendTo(tool).bind("click",function(){return _1be(_19c),!1}),opts.maximizable&&$('<a class="pjfPanel-tool-max" href="javascript:void(0)"></a>').appendTo(tool).bind("click",function(){return 1==opts.maximized?_1c1(_19c):_1ac(_19c),!1}),opts.closable&&$('<a class="pjfPanel-tool-close" href="javascript:void(0)"></a>').appendTo(tool).bind("click",function(){return _19f(_19c),!1}),_19d.children("div.pjfPanel-body").removeClass("pjfPanel-body-noheader")}else _19d.children("div.pjfPanel-body").addClass("pjfPanel-body-noheader")}function _1a0(e){var i=$.data(e,"pjfPanel"),n=$.data(e,"pjfPanel").options;if(i.options.href&&(i.options.isRefresh||!i.isLoaded||!i.options.cache)){i.isLoaded=!1,
_1a3(e);var o=i.pjfPanel.find(">div.pjfPanel-body");i.options.loadingMessage&&o.html($('<div class="pjfPanel-loading"></div>').html(i.options.loadingMessage)),$.ajax({url:i.options.href,cache:!1,success:function(t){o.html(i.options.extractor.call(e,t)),$.parser&&$.parser.parse(o),i.options.onLoad&&i.options.onLoad.apply(e,arguments),i.isLoaded=!0,"auto"==n.height&&$.browser.msie&&$.browser.version<"8.0"?o.css({"overflow-x":"auto","overflow-y":"hidden"}):o.css({"overflow-x":"auto","overflow-y":"auto"})}})}}function _1a3(t){var e=$(t);e.find(".combo-f").each(function(){$(this).combo("destroy")}),e.find(".m-btn").each(function(){$(this).menubutton("destroy")}),e.find(".s-btn").each(function(){$(this).splitbutton("destroy")})}function _1a6(t){$(t).find("div.pjfPanel:visible,div.accordion:visible,div.tabs-container:visible,div.layout:visible").each(function(){$(this).triggerHandler("_resize",[!0])})}function _1a8(t,e){var i=$.data(t,"pjfPanel").options,n=$.data(t,"pjfPanel").pjfPanel
;1!=e&&0==i.onBeforeOpen.call(t)||(n.show(),i.closed=!1,i.minimized=!1,i.onOpen.call(t),1==i.maximized&&(i.maximized=!1,_1ac(t)),1==i.collapsed&&(i.collapsed=!1,_1ad(t)),i.collapsed||(_1a0(t),_1a6(t)))}function _19f(t,e){var i=$.data(t,"pjfPanel").options,n=$.data(t,"pjfPanel").pjfPanel;1!=e&&0==i.onBeforeClose.call(t)||(n.hide(),i.closed=!0,i.onClose.call(t))}function _1b1(t,e){var i=$.data(t,"pjfPanel").options,n=$.data(t,"pjfPanel").pjfPanel;1!=e&&0==i.onBeforeDestroy.call(t)||(_1a3(t),_18d(n),i.onDestroy.call(t))}function _1ad(t,e){var i=$.data(t,"pjfPanel").options,n=$.data(t,"pjfPanel").pjfPanel,o=n.children("div.pjfPanel-body"),a=n.children("div.pjfPanel-header").find("a.pjfPanel-tool-collapse");1!=i.collapsed&&(o.stop(!0,!0),0!=i.onBeforeCollapse.call(t)&&(a.addClass("pjfPanel-tool-expand"),1==e?o.slideUp("normal",function(){i.collapsed=!0,i.onCollapse.call(t)}):(o.hide(),i.collapsed=!0,i.onCollapse.call(t))))}function _1b8(t,e){
var i=$.data(t,"pjfPanel").options,n=$.data(t,"pjfPanel").pjfPanel,o=n.children("div.pjfPanel-body"),a=n.children("div.pjfPanel-header").find("a.pjfPanel-tool-collapse");0!=i.collapsed&&(o.stop(!0,!0),0!=i.onBeforeExpand.call(t)&&(a.removeClass("pjfPanel-tool-expand"),1==e?o.slideDown("normal",function(){i.collapsed=!1,i.onExpand.call(t),_1a0(t),_1a6(t)}):(o.show(),i.collapsed=!1,i.onExpand.call(t),_1a0(t),_1a6(t)),"auto"==i.height&&$.browser.msie&&$.browser.version<"8.0"&&o.css({"overflow-x":"auto","overflow-y":"hidden"})))}function _1ac(t){var e=$.data(t,"pjfPanel").options,i=$.data(t,"pjfPanel").pjfPanel.children("div.pjfPanel-header").find("a.pjfPanel-tool-max");1!=e.maximized&&(i.addClass("pjfPanel-tool-restore"),$.data(t,"pjfPanel").original||($.data(t,"pjfPanel").original={width:e.width,height:e.height,left:e.left,top:e.top,fit:e.fit}),e.left=0,e.top=0,e.fit=!0,_18e(t),e.minimized=!1,e.maximized=!0,e.onMaximize.call(t))}function _1be(t){var e=$.data(t,"pjfPanel").options
;$.data(t,"pjfPanel").pjfPanel.hide(),e.minimized=!0,e.maximized=!1,e.onMinimize.call(t)}function _1c1(t){var e=$.data(t,"pjfPanel").options,i=$.data(t,"pjfPanel").pjfPanel,n=i.children("div.pjfPanel-header").find("a.pjfPanel-tool-max");if(0!=e.maximized){i.show(),n.removeClass("pjfPanel-tool-restore");var o=$.data(t,"pjfPanel").original;e.width=o.width,e.height=o.height,e.left=o.left,e.top=o.top,e.fit=o.fit,_18e(t),e.minimized=!1,e.maximized=!1,$.data(t,"pjfPanel").original=null,e.onRestore.call(t)}}function _1c5(t){var e=$.data(t,"pjfPanel").options,i=$.data(t,"pjfPanel").pjfPanel,n=$(t).pjfPanel("header"),o=$(t).pjfPanel("body");i.css(e.style),i.addClass(e.cls),e.border?(n.removeClass("pjfPanel-header-noborder"),o.removeClass("pjfPanel-body-noborder")):(n.addClass("pjfPanel-header-noborder"),o.addClass("pjfPanel-body-noborder")),n.addClass(e.headerCls),o.addClass(e.bodyCls),e.id?$(t).attr("id",e.id):$(t).attr("id","")}function _1c9(t,e){$.data(t,"pjfPanel").options.title=e,
$(t).pjfPanel("header").find("div.pjfPanel-title").html(e)}var TO=!1,_1cc=!0;$(window).unbind(".pjfPanel").bind("resize.pjfPanel",function(){_1cc&&(!1!==TO&&clearTimeout(TO),TO=setTimeout(function(){_1cc=!1;var t=$("body.layout");t.length?t.layout("resize"):$("body").children("div.pjfPanel,div.accordion,div.tabs-container,div.layout").triggerHandler("_resize"),TO=!(_1cc=!0)},200))}),$.fn.pjfPanel=function(i,t){return"string"==typeof i?$.fn.pjfPanel.methods[i](this,t):(i=i||{},this.each(function(){var t,e=$.data(this,"pjfPanel");e?t=$.extend(e.options,i):(t=$.extend({},$.fn.pjfPanel.defaults,$.fn.pjfPanel.parseOptions(this),i),$(this).attr("title",""),e=$.data(this,"pjfPanel",{options:t,pjfPanel:_198(this,t),isLoaded:!1})),t.content&&($(this).html(t.content),$.parser&&$.parser.parse(this)),_19b(this),_1c5(this),1==t.doSize&&(e.pjfPanel.css("display","block"),_18e(this)),1==t.closed||1==t.minimized?e.pjfPanel.hide():_1a8(this)}))},$.fn.pjfPanel.methods={options:function(t){
return $.data(t[0],"pjfPanel").options},pjfPanel:function(t){return $.data(t[0],"pjfPanel").pjfPanel},header:function(t){return $.data(t[0],"pjfPanel").pjfPanel.find(">div.pjfPanel-header")},body:function(t){return $.data(t[0],"pjfPanel").pjfPanel.find(">div.pjfPanel-body")},setTitle:function(t,e){return t.each(function(){_1c9(this,e)})},open:function(t,e){return t.each(function(){_1a8(this,e)})},close:function(t,e){return t.each(function(){_19f(this,e)})},destroy:function(t,e){return t.each(function(){_1b1(this,e)})},refresh:function(t,e){return t.each(function(){$.data(this,"pjfPanel").isLoaded=!1,e&&($.data(this,"pjfPanel").options.href=e),_1a0(this)})},resize:function(t,e){return t.each(function(){_18e(this,e)})},move:function(t,e){return t.each(function(){_194(this,e)})},maximize:function(t){return t.each(function(){_1ac(this)})},minimize:function(t){return t.each(function(){_1be(this)})},restore:function(t){return t.each(function(){_1c1(this)})},collapse:function(t,e){
return t.each(function(){_1ad(this,e)})},expand:function(t,e){return t.each(function(){_1b8(this,e)})}},$.fn.pjfPanel.parseOptions=function(t){var e=$(t);return $.extend({},$.parser.parseOptions(t,["id","width","height","left","top","title","iconCls","cls","headerCls","bodyCls","tools","href",{cache:"boolean",fit:"boolean",border:"boolean",noheader:"boolean"},{collapsible:"boolean",minimizable:"boolean",maximizable:"boolean"},{closable:"boolean",collapsed:"boolean",minimized:"boolean",maximized:"boolean",closed:"boolean"}]),{loadingMessage:e.attr("loadingMessage")!=undefined?e.attr("loadingMessage"):undefined})},$.fn.pjfPanel.defaults={id:null,title:null,iconCls:null,width:"auto",height:"auto",left:null,top:null,cls:null,headerCls:null,bodyCls:null,style:{},href:null,cache:!0,fit:!1,border:!0,doSize:!0,noheader:!1,content:null,collapsible:!1,minimizable:!1,maximizable:!1,closable:!1,collapsed:!1,minimized:!1,maximized:!1,closed:!1,tools:null,href:null,loadingMessage:"Loading...",
extractor:function(t){var e=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(t);return e?e[1]:t},onLoad:function(){},onBeforeOpen:function(){},onOpen:function(){},onBeforeClose:function(){},onClose:function(){},onBeforeDestroy:function(){},onDestroy:function(){},onResize:function(t,e){},onMove:function(t,e){},onMaximize:function(){},onRestore:function(){},onMinimize:function(){},onBeforeCollapse:function(){},onBeforeExpand:function(){},onCollapse:function(){},onExpand:function(){}}}(jQuery),function(o){function n(t,e){var i=o.data(t,"linkbutton");if(e){i.options.disabled=!0;var n=o(t).attr("href");n&&(i.href=n,o(t).attr("href","javascript:void(0)")),t.onclick&&(i.onclick=t.onclick,t.onclick=null),o(t).addClass("")}else i.options.disabled=!1,i.href&&o(t).attr("href",i.href),i.onclick&&(t.onclick=i.onclick),o(t).removeClass("")}o.fn.pjfLinkButton=function(e,t){return"string"==typeof e?o.fn.pjfLinkButton.methods[e](this,t):(e=e||{},this.each(function(){var t=o.data(this,"linkbutton")
;t?o.extend(t.options,e):(o.data(this,"linkbutton",{options:o.extend({},o.fn.pjfLinkButton.defaults,o.fn.pjfLinkButton.parseOptions(this),e)}),o(this).removeAttr("disabled")),function(t){var e=o.data(t,"linkbutton").options;if(o(t).empty(),o(t).addClass("l-btn"),e.id?o(t).attr("id",e.id):o(t).attr("id",""),e.plain?o(t).addClass("l-btn-plain"):o(t).removeClass("l-btn-plain"),e.text){if(o(t).html(e.text).wrapInner('<span class="l-btn-left"><span class="l-btn-text"></span></span>'),e.iconCls){var i=PJF.constants.ICONCLS_MAP[e.iconCls]||"icon-default";"icon-default"!=i?o(t).find(".l-btn-left").prepend('<span class="appendImage '+i+'"></span>'):o(t).find(".l-btn-text").addClass(e.iconCls)}}else o(t).html("&nbsp;").wrapInner('<span class="l-btn-left"><span class="l-btn-text"><span class="l-btn-empty"></span></span></span>'),e.iconCls&&o(t).find(".l-btn-empty").addClass(e.iconCls);o(t).unbind(".linkbutton").bind("focus.linkbutton",function(){
e.disabled||o(this).find("span.l-btn-text").addClass("l-btn-focus")}).bind("blur.linkbutton",function(){o(this).find("span.l-btn-text").removeClass("l-btn-focus")}),n(t,e.disabled)}(this)}))},o.fn.pjfLinkButton.methods={options:function(t){return o.data(t[0],"linkbutton").options},enable:function(t){return t.each(function(){n(this,!1)})},disable:function(t){return t.each(function(){n(this,!0)})}},o.fn.pjfLinkButton.parseOptions=function(t){var e=o(t);return o.extend({},o.parser.parseOptions(t,["id","iconCls",{plain:"boolean"}]),{disabled:!!e.attr("disabled")||undefined,text:o.trim(e.html()),iconCls:e.attr("icon")||e.attr("iconCls")})},o.fn.pjfLinkButton.defaults={id:null,disabled:!1,plain:!1,text:"",iconCls:null}}(jQuery),function(d){d.fn.extend({checkTip:function(t){var e={Message:resource.TEXTFIELD_CHECK_MSG1,show:null,flag:"validate",close:!0},r=d.extend(e,t),i=this,c=r.Message,l=i.tips;function n(t,e,i){var n
;l&&!l.is(":hidden")||(l=e?d('<div class="warnbox_ipt_help"><div class="warnbox_ipt_helpbox"><div class="warnbox_arrow"> </div><p class="errorbox_tip-content"></p></div><div class="warnbox_ipt_bottombox"></div>').insertAfter(t):i?d('<div class="helpbox_ipt_help"><div class="helpbox_ipt_helpbox"><div class="helpbox_arrow"> </div><p class="errorbox_tip-content"></p></div><div class="helpbox_ipt_bottombox"></div>').insertAfter(t):d('<div class="errorbox_ipt_help"><div class="errorbox_ipt_helpbox"><div class="errorbox_arrow"> </div><p class="errorbox_tip-content"></p></div><div class="errorbox_ipt_bottombox"></div>').insertAfter(t),t.tips=l),i||!1===r.close?l.find(".errorbox_tip-content").html(c):l.find(".errorbox_tip-content").html(c+"&nbsp;&nbsp;<span id='warnHide' class='tip-close' href='javascript:;'>&times;</span>"),t.attr("error",c),d(".errorbox_ipt_help").bgiframe();var o=-9;t.parent().css({position:"relative"});var a=t.offset().left-t.parent().offset().left
;t.parent("span").prev().is("input[id^=date1]")&&(a=t.offset().left-t.parent().offset().left),t.parent().is("span")&&(o=-8),28<t.height()&&(o=-8),n=t.parent().is("span:not('.pjf_select_parent')")?d.browser.safari&&t.parent("span").hasClass("warp_input")?Math.floor(t.width()-30):Math.floor(t.width()-10):Math.floor(t.width()-30);var s=t.parent().height()+o+13;n<=0&&(n=0),t.is("li")&&(l.appendTo(t),l.find("div.errorbox_arrow").addClass("tree_errorbox_arrow").removeClass("errorbox_arrow"),l.find("p").css("margin","1px 0 0 3px"),l.find("div.errorbox_ipt_helpbox").css({"margin-top":"1px"}),t.css("position","relative"),a=5,n=t.find("a").width()+31,s=t.height()-18),l&&(t.parent().position().top<l.height()?(l.css({display:"block",left:a+n,top:t.is("li")?-5:t.height()+7}),l.find(".errorbox_arrow").css({backgroundPosition:"-41px 0",top:"-4px"}),l.find(".warnbox_arrow ").css({backgroundPosition:"-50px 0",top:"-4px"}),l.find(".helpbox_arrow").css({backgroundPosition:"-57px 0",top:"-4px"})):l.css({
display:"block",left:a+n,bottom:s}))}function o(t){l&&l.remove(),t.tips=null}r.show()?("help"==r.flag?i.removeClass("validatebox-tipcolor warnbox-tipcolor error-border warn-border"):i.removeClass("validatebox-invalid validatebox-tipcolor warnbox-tipcolor error-border warn-border"),o(i),(i.parent().is("span")||i.is("span.validatebox-checkbox"))&&(i.closest("span").removeClass("validatebox-tipcolor warnbox-tipcolor error-border warn-border"),i.filter(".validatebox-checkbox").css("border","0px solid #FE0000"),i.siblings("span.point_box").removeClass("validatebox-spanicon"),i.siblings("span.point_box").removeClass("warnbox-spanicon")),i.removeAttr("error")):"validate"==r.flag?(n(i),i.addClass("validatebox-invalid validatebox-tipcolor error-border"),i.is("li")&&i.removeClass("error-border"),(i.parent().is("span")||i.is("span.validatebox-checkbox"))&&(i.closest("span").addClass("validatebox-tipcolor error-border"),i.filter(".validatebox-checkbox").css("border","1px solid #FE0000"),
i.siblings("span.point_box").addClass("validatebox-spanicon"))):"warn"==r.flag?(n(i,!0,!1),i.addClass("validatebox-warn warnbox-tipcolor"),i.parent().is("span")&&(i.closest("span").addClass("warnbox-tipcolor warn-border"),i.siblings("span.point_box").addClass("warnbox-spanicon"))):"help"==r.flag&&n(i,!1,!0),i.next().find("#warnHide").click(function(){o(i),i.nextAll("div.warnbox_ipt_help,div.errorbox_ipt_help").remove(),i.removeClass("warnbox-tipcolor").closest("span").removeClass("warnbox-tipcolor warn-border"),i.siblings("span.point_box").removeClass("warnbox-spanicon")}),PJF.hotKeyManager.removeHotKeyListener(192,null,!0),PJF.hotKeyManager.addHotKeyListener(192,function(){d("div.warnbox_ipt_help,div.errorbox_ipt_help").remove()},!0)}})}(jQuery),function(f){f.fn.extend({validform:function(h){var p;return this.each(function(){var t=f.extend({message:"",invalidROFlag:!0,needErrMsg:!1},h),e=f(this),i="";if(null==t.invalidROFlag&&(t.invalidROFlag=!0),e.children()){
var n=".validatebox-invalid:visible";if(t.partDoms){for(var o="",a=0;a<t.partDoms.length;a++)"PJF.ui.cardAndBankBookReader"==f("#"+t.partDoms[a]).attr("componenttype")?o+="#"+t.partDoms[a]+">>"+n:o+="#"+t.partDoms[a]+">"+n+",#"+t.partDoms[a]+n+",#"+t.partDoms[a]+"~"+n,a<t.partDoms.length-1&&(o+=",");n=o}jss=e.find(n);for(var s=0;s<jss.length;s++)if(!jss.eq(s).hasClass("pjf_disabled_input")&&"disabled"!=jss.eq(s).attr("disabled")&&!jss.eq(s).find("input:disabled").closest("span").is("span.validatebox-checkbox")){if(jss.eq(s).hasClass("pjf_select_input")){var r=jss.eq(s).siblings("select").eq(0).val();r||jss.eq(s).trigger("blur"),f.isArray(r)&&!r.toString()&&jss.eq(s).trigger("blur")}else jss.eq(s).attr("autocomplete")&&!jss.eq(s).hasClass("combo-text")?jss.eq(s).trigger("focus",!0):jss.eq(s).trigger("focus"),jss.eq(s).trigger("blur")
;null!=jss.eq(s).attr("error")&&(!t.invalidROFlag&&(jss.eq(s).hasClass("pjf_readonly_input")&&"readonly"==jss.eq(s).attr("readonly")||jss.eq(s).find("input.pjf_readonly_input").closest("span").is("span.validatebox-checkbox"))||(i+="<li>",jss.eq(s).parent().is("span")||jss.eq(s).parent().is("div")?i+="<span class='black'>"+jss.eq(s).parentsUntil("li").siblings("label").text()+"</span>"+jss.eq(s).attr("error")+"</li>":jss.eq(s).is("span")?(jss.eq(s).addClass("validatebox-tipcolor").css("borderColor","red"),jss.eq(s).trigger("mouseover"),i+="<span class='black'>"+jss.eq(s).siblings("label").text()+"</span>"+jss.eq(s).attr("error")+"</li>",jss.eq(s).trigger("mouseout")):i+="<span class='black'>"+jss.eq(s).prev("label").text()+"</span>"+jss.eq(s).attr("error")+"</li>"))}e.attr("alt",i)}setTimeout(function(){f(".errorbox_ipt_help").remove()},100)
;var c="<div class='pjf_quanju' id='"+e.attr("id")+"_qj'><p>"+resource.GLOBALCHECK_MSG1+"</p><ul class='pjf_global_ul'></ul><div class='pjf_globale_div'>"+t.message+"</div></div>";if(""!=i||""!=t.message){f("#"+e.attr("id")+"_qj");var l=f("#"+e.attr("id")+"_qj").length;0==l&&e.before(c),f("#"+e.attr("id")+"_qj").find(".pjf_global_ul").html(e.attr("alt")).next("div.pjf_globale_div").html(t.message),f("#"+e.attr("id")+"_qj").width(f("#"+e.attr("id")+"_qj").next().find(".pjf_ul_title_box").width()-10),p=!1}else 0!=l&&f("#"+e.attr("id")+"_qj").remove(),p=!0;if(t.needErrMsg){for(var d=i,u=/(<li><span.*?>)(.*?)(<\/span>)(.*?)(<\/li>)/;u.test(d);)d=d.replace(u,"$2$4。");p=[p,d]}}),p}})}(jQuery),PJF.apply=function(t,e){if(t&&e&&"object"==typeof e)for(var i in e)t[i]=e[i];return t},PJF.override=function(t,e){if(e){var i=t.prototype;PJF.apply(i,e),i.toString=e.toString}},PJF.extend=function(){var s=function(t){for(var e in t)this[e]=t[e]},r=Object.prototype.constructor;return function(e,t,i){
"object"==typeof t&&(i=t,t=e,e=i.constructor!=r?i.constructor:function(){t.apply(this,arguments)});var n,o=function(){},a=t.prototype;return o.prototype=a,(((n=e.prototype=new o).constructor=e).superclass=a).constructor==r&&(a.constructor=t),e.override=function(t){PJF.override(e,t)},n.superclass=n.supr=function(){return a},n.override=s,PJF.override(e,i),e.extend=function(t){return PJF.extend(e,t)},e}}(),PJF.namespace=function(){for(var t,e,i,n,o,a=arguments.length,s=0;s<a;++s)for(arguments[s],i=arguments[s].split("."),(o=window[i[0]])===undefined&&(o=window[i[0]]={}),t=(n=i.slice(1)).length,e=0;e<t;++e)o=o[n[e]]=o[n[e]]||{};return o},function(t){"use strict";function u(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function r(t,e,i,n,o,a){return u((s=u(u(e,t),u(n,a)))<<(r=o)|s>>>32-r,i);var s,r}function h(t,e,i,n,o,a,s){return r(e&i|~e&n,t,e,o,a,s)}function p(t,e,i,n,o,a,s){return r(e&n|i&~n,t,e,o,a,s)}function f(t,e,i,n,o,a,s){return r(e^i^n,t,e,o,a,s)}
function m(t,e,i,n,o,a,s){return r(i^(e|~n),t,e,o,a,s)}function c(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var i,n,o,a,s,r=1732584193,c=-271733879,l=-1732584194,d=271733878
;for(i=0;i<t.length;i+=16)c=m(c=m(c=m(c=m(c=f(c=f(c=f(c=f(c=p(c=p(c=p(c=p(c=h(c=h(c=h(c=h(o=c,l=h(a=l,d=h(s=d,r=h(n=r,c,l,d,t[i],7,-680876936),c,l,t[i+1],12,-389564586),r,c,t[i+2],17,606105819),d,r,t[i+3],22,-1044525330),l=h(l,d=h(d,r=h(r,c,l,d,t[i+4],7,-176418897),c,l,t[i+5],12,1200080426),r,c,t[i+6],17,-1473231341),d,r,t[i+7],22,-45705983),l=h(l,d=h(d,r=h(r,c,l,d,t[i+8],7,1770035416),c,l,t[i+9],12,-1958414417),r,c,t[i+10],17,-42063),d,r,t[i+11],22,-1990404162),l=h(l,d=h(d,r=h(r,c,l,d,t[i+12],7,1804603682),c,l,t[i+13],12,-40341101),r,c,t[i+14],17,-1502002290),d,r,t[i+15],22,1236535329),l=p(l,d=p(d,r=p(r,c,l,d,t[i+1],5,-165796510),c,l,t[i+6],9,-1069501632),r,c,t[i+11],14,643717713),d,r,t[i],20,-373897302),l=p(l,d=p(d,r=p(r,c,l,d,t[i+5],5,-701558691),c,l,t[i+10],9,38016083),r,c,t[i+15],14,-660478335),d,r,t[i+4],20,-405537848),l=p(l,d=p(d,r=p(r,c,l,d,t[i+9],5,568446438),c,l,t[i+14],9,-1019803690),r,c,t[i+3],14,-187363961),d,r,t[i+8],20,1163531501),l=p(l,d=p(d,r=p(r,c,l,d,t[i+13],5,-1444681467),c,l,t[i+2],9,-51403784),r,c,t[i+7],14,1735328473),d,r,t[i+12],20,-1926607734),l=f(l,d=f(d,r=f(r,c,l,d,t[i+5],4,-378558),c,l,t[i+8],11,-2022574463),r,c,t[i+11],16,1839030562),d,r,t[i+14],23,-35309556),l=f(l,d=f(d,r=f(r,c,l,d,t[i+1],4,-1530992060),c,l,t[i+4],11,1272893353),r,c,t[i+7],16,-155497632),d,r,t[i+10],23,-1094730640),l=f(l,d=f(d,r=f(r,c,l,d,t[i+13],4,681279174),c,l,t[i],11,-358537222),r,c,t[i+3],16,-722521979),d,r,t[i+6],23,76029189),l=f(l,d=f(d,r=f(r,c,l,d,t[i+9],4,-640364487),c,l,t[i+12],11,-421815835),r,c,t[i+15],16,530742520),d,r,t[i+2],23,-995338651),l=m(l,d=m(d,r=m(r,c,l,d,t[i],6,-198630844),c,l,t[i+7],10,1126891415),r,c,t[i+14],15,-1416354905),d,r,t[i+5],21,-57434055),l=m(l,d=m(d,r=m(r,c,l,d,t[i+12],6,1700485571),c,l,t[i+3],10,-1894986606),r,c,t[i+10],15,-1051523),d,r,t[i+1],21,-2054922799),l=m(l,d=m(d,r=m(r,c,l,d,t[i+8],6,1873313359),c,l,t[i+15],10,-30611744),r,c,t[i+6],15,-1560198380),d,r,t[i+13],21,1309151649),l=m(l,d=m(d,r=m(r,c,l,d,t[i+4],6,-145523070),c,l,t[i+11],10,-1120210379),r,c,t[i+2],15,718787259),d,r,t[i+9],21,-343485551),
r=u(r,n),c=u(c,o),l=u(l,a),d=u(d,s);return[r,c,l,d]}function l(t){var e,i="";for(e=0;e<32*t.length;e+=8)i+=String.fromCharCode(t[e>>5]>>>e%32&255);return i}function d(t){var e,i=[];for(i[(t.length>>2)-1]=undefined,e=0;e<i.length;e+=1)i[e]=0;for(e=0;e<8*t.length;e+=8)i[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return i}function n(t){var e,i,n="0123456789abcdef",o="";for(i=0;i<t.length;i+=1)e=t.charCodeAt(i),o+=n.charAt(e>>>4&15)+n.charAt(15&e);return o}function i(t){return unescape(encodeURIComponent(t))}function o(t){return l(c(d(e=i(t)),8*e.length));var e}function a(t,e){return function(t,e){var i,n,o=d(t),a=[],s=[];for(a[15]=s[15]=undefined,16<o.length&&(o=c(o,8*t.length)),i=0;i<16;i+=1)a[i]=909522486^o[i],s[i]=1549556828^o[i];return n=c(a.concat(d(e)),512+8*e.length),l(c(s.concat(n),640))}(i(t),i(e))}function e(t,e,i){return e?i?a(e,t):n(a(e,t)):i?o(t):n(o(t))}"object"==typeof module&&module.exports?module.exports=e:t.md5=e}(this),"object"!=typeof JSON&&(JSON={}),function(){
function k(t){return t<10?"0"+t:t}function p(){return this.valueOf()}function q(e){return r.lastIndex=0,r.test(e)?'"'+e.replace(r,function(e){var i=t[e];return"string"==typeof i?i:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function m(t,n){var o,a,s,r,c,d=e,u=n[t];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(t)),"function"==typeof i&&(u=i.call(n,t,u)),typeof u){case"string":return q(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(e+=l,c=[],"[object Array]"===Object.prototype.toString.apply(u)){for(r=u.length,o=0;o<r;o+=1)c[o]=m(o,u)||"null";return s=0===c.length?"[]":e?"[\n"+e+c.join(",\n"+e)+"\n"+d+"]":"["+c.join(",")+"]",e=d,s}if(i&&"object"==typeof i)for(r=i.length,o=0;o<r;o+=1)"string"==typeof i[o]&&((s=m(a=i[o],u))&&c.push(q(a)+(e?": ":":")+s));else for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(s=m(a,u))&&c.push(q(a)+(e?": ":":")+s)
;return s=0===c.length?"{}":e?"{\n"+e+c.join(",\n"+e)+"\n"+d+"}":"{"+c.join(",")+"}",e=d,s}}var u=/^[\],:{}\s]*$/,v=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,w=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,x=/(?:^|:|,)(?:\s*\[)+/g,r=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,l,t,i;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+k(this.getUTCMonth()+1)+"-"+k(this.getUTCDate())+"T"+k(this.getUTCHours())+":"+k(this.getUTCMinutes())+":"+k(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=p,Number.prototype.toJSON=p,String.prototype.toJSON=p),"function"!=typeof JSON.stringify&&(t={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},
JSON.stringify=function(t,n,o){var a;if(l=e="","number"==typeof o)for(a=0;a<o;a+=1)l+=" ";else"string"==typeof o&&(l=o);if((i=n)&&"function"!=typeof n&&("object"!=typeof n||"number"!=typeof n.length))throw Error("JSON.stringify");return m("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(a,e){function c(t,i){var n,o,a=t[i];if(a&&"object"==typeof a)for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(void 0!==(o=c(a,n))?a[n]=o:delete a[n]);return e.call(t,i,a)}var d,a=String(a);if(s.lastIndex=0,s.test(a)&&(a=a.replace(s,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),u.test(a.replace(v,"@").replace(w,"]").replace(x,"")))return d=eval("("+a+")"),"function"==typeof e?c({"":d},""):d;throw new SyntaxError("JSON.parse")})}(),PJF.namespace("PJF.util"),PJF.util={extend:jQuery.extend,json2str:function(t,e,i){var n=!1;if(e&&(n=e),!t)return"";if(i)t=$.extend(!0,{},t);var o=[],a=function(t,e){
return"object"==typeof t&&null!=t?PJF.util.json2str(t,e):/^(string|number)$/.test(typeof t)?"'"+t+"'":t};if(t.constructor===Array){for(var s in t)n||"string"!=typeof t[s]||(t[s]=t[s].replace(new RegExp("\\\\","gm"),"\\\\"),t[s]=t[s].replace(new RegExp("'","gm"),"\\'"),t[s]=t[s].replace(new RegExp('"',"gm"),'\\"'),t[s]=t[s].replace(new RegExp("\n","gm"),"\\n"),t[s]=t[s].replace(new RegExp("\r","gm"),"\\r")),o.push(a(t[s],n));return"["+o.join(",")+"]"}for(var s in t)n||"string"!=typeof t[s]||(t[s]=t[s].replace(new RegExp("\\\\","gm"),"\\\\"),t[s]=t[s].replace(new RegExp("'","gm"),"\\'"),t[s]=t[s].replace(new RegExp('"',"gm"),'\\"'),t[s]=t[s].replace(new RegExp("\n","gm"),"\\n"),t[s]=t[s].replace(new RegExp("\r","gm"),"\\r")),o.push("'"+s+"':"+a(t[s],n));return"{"+o.join(",")+"}"},json2str2:function(t){if(window.JSON&&window.JSON.stringify)return JSON.stringify(t);if(!t)return"";var e=[],i=function(t){
return"object"==typeof t&&null!=t?PJF.communication.ra.handler_json2str(t):/^(string|number)$/.test(typeof t)?'"'+t+'"':t};if((t=$.extend(!0,{},t)).constructor===Array){for(var n in t)"string"==typeof t[n]&&(t[n]=t[n].replace(new RegExp("\\\\","gm"),"\\\\"),t[n]=t[n].replace(new RegExp("'","gm"),"\\'"),t[n]=t[n].replace(new RegExp('"',"gm"),'\\"'),t[n]=t[n].replace(new RegExp("\n","gm"),"\\n"),t[n]=t[n].replace(new RegExp("\r","gm"),"\\r")),e.push(i(t[n]));return"["+e.join(",")+"]"}for(var n in t)"string"==typeof t[n]&&(t[n]=t[n].replace(new RegExp("\\\\","gm"),"\\\\"),t[n]=t[n].replace(new RegExp("'","gm"),"\\'"),t[n]=t[n].replace(new RegExp('"',"gm"),'\\"'),t[n]=t[n].replace(new RegExp("\n","gm"),"\\n"),t[n]=t[n].replace(new RegExp("\r","gm"),"\\r")),e.push('"'+n+'":'+i(t[n]));return"{"+e.join(",")+"}"},jsontostr:JSON.stringify,parseJson:JSON.parse,getType:function(t){var e;return("object"==(e=typeof t)?null==t?"null":Object.prototype.toString.call(t).slice(8,-1):e).toLowerCase()},
batchSetText:function(a,t){t||(t=document.body),$("[pjf-text]",t).each(function(t,e){var i=$(e),n=i.attr("pjf-text");if(n){var o=PJF.util.getValue(a,n);o?i.text(o):console.warn("no text value found for pjf-text "+n)}})},getValue:function(t,e){if(!t||"string"!=typeof e)return null;for(var i,n=e.split("."),o=t,a=0;i=n[a];a++){if(!o)return null;o=o[i]}return o},setValue:function(t,e,i){if(!t||"string"!=typeof e)return!1;var n=e.lastIndexOf(".");if(-1===n)return t[e]=i,!0;var o=e.substr(0,n),a=e.substr(n+1),s=this.getValue(t,o),r=typeof s;return!(!s||"object"!==r&&"function"!==r)&&(s[a]=i,!0)},trim:function(t){return $.trim(t)},hashCode:function(t){for(var e=0,i=t.length,n=0;n<i;n++)e=(e<<5)-e+t.charCodeAt(n),e&=e;return e},apply:function(t,e){return PJF.apply(t,e)},isExist:function(t){if("string"==typeof t){var e=arguments[1]||window,i=t.split("."),n=i[0];i.shift();var o=i.join(".");return null!==e[n]&&e[n]!==undefined&&(!o||arguments.callee(o,e[n]))}return null!==t&&t!==undefined},
convertCounty:function(t){function e(){new PJF.ui.messageBox({style:"alert",title:resource.convertCounty_messageBox_title,content:resource.convertCounty_messageBox_content})}if($.isArray(t)){for(var i=[],n=t.length,o=0;o<n;o++){if((a=t[o]+"").length<6)return void e();"0000"!=a.substring(2,6)?"00"!=a.substring(4,6)?i.push({province:a.substring(0,2)+"0000",city:a.substring(0,4)+"00",county:a}):i.push({province:a.substring(0,2)+"0000",city:a.substring(0,4)+"00",county:""}):i.push({province:a.substring(0,2)+"0000",city:"",county:""})}return i}var a;return(a=t+"").length<6?void e():"0000"==a.substring(2,6)?{province:a.substring(0,2)+"0000",city:"",county:""}:"00"==a.substring(4,6)?{province:a.substring(0,2)+"0000",city:a.substring(0,4)+"00",county:""}:{province:a.substring(0,2)+"0000",city:a.substring(0,4)+"00",county:t}},formatDate:function(t,e){e||(e="yyyyMMdd");var i={"y+":t.getFullYear(),"M+":t.getMonth()+1,"d+":t.getDate(),"H+":t.getHours(),"h+":t.getHours(),"m+":t.getMinutes(),
"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),"S+":t.getMilliseconds()};for(var n in i){var o,a=new RegExp("("+n+")");for(i[n]+="";o=a.exec(e);){for(var s="",r=0,c=o[0].length-i[n].length;r<c;r++)s+="0";e=e.replace(o[0],s+i[n].substr(0,o[0].length))}}return e},generateUUid:function(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0,o=0;o<36;o++)8==o||13==o||18==o||23==o?i[o]="-":14==o?i[o]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[o]=e[19==o?3&t|8:t]);return i.join("").replace(/-/g,"")},number2Money:function(t,e){if(0==t&&""!=$.trim(t))return e?e+"整":"零元整";if(!/^-?([1-9]\d*|0)(\.\d+)?$/.test(t)||!t)return"";var i="",n=!1;"-"==(t=""+t)[0]&&(t=t.substr(1),n=!0);var o=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],a=["","拾","佰","仟","万","亿","元",""],s=["角","分"],r=t.split(".");r[1]&&(r[1].match(/^0{2}/)||r[1].match(/^0$/)?r.pop():r[1].match(/^[1-9]0/)&&(r[1]=r[1][0]));var c=0
;if(0<r[0])for(var l=r[0].length-1;0<=l;l--){switch(c){case 0:i=a[7]+i;break;case 4:new RegExp("0{4}\\d{"+(r[0].length-l-1)+"}$").test(r[0])||(i=a[4]+i);break;case 8:i=a[5]+i,a[7]=a[5],c=0}c%4!=0&&"0"==r[0].charAt(l)&&""!=r[0].charAt(l+1)&&"0"!=r[0].charAt(l+1)&&(i=o[0]+i),0!=r[0].charAt(l)&&(i=o[r[0].charAt(l)]+a[c%4]+i),c++}if(1<r.length){0<r[0]&&(i+=a[6]);for(l=0;l<r[1].length&&l<=1;l++)"0"==r[1].charAt(l)?0<r[0]&&(i+=o[0]):i+=o[r[1].charAt(l)]+s[l]}else i+=e?e+"整":"元整";return n&&(i="负"+i),i},number2Money2:function(t){if("number"==typeof t)t=t.toString();else{if("string"!=typeof t)return 0;t=this.trim(t)}if(!t)return 0;var e,i,n=t.indexOf("."),o=/(\d+)(\d{3})/;if(0<=n){for(e=t.substring(0,n)||"0",i=t.substring(n+1,t.length);o.test(e);)e=e.replace(o,"$1,$2");t=e+"."+i}else for(;o.test(t);)t=t.replace(o,"$1,$2");return t},activeKeyScope:function(t){if(t){var e=PJF.ui.componentMgr.getFirstComp(t);if(e&&(console.log("激活第一个组件，组件类型为:"+e.getClassName()),e.focus))return void e.focus()}},
getClientVersion:function(){if(!PJF.constants.clientVersion){var t=PJF.constants.clientVersion="";if(PJF.communication.client.isInP2())try{var e=PJF.communication.client.getClientEnv("localVersion");t=(t=0==e[0]?e[1]:t)||""}catch(i){}PJF.constants.clientVersion=t}return PJF.constants.clientVersion},getClientSubVersion:function(){if(!PJF.constants.clientSubVersion){var t=PJF.constants.clientSubVersion="";if(PJF.communication.client.isInP2())try{var e=PJF.communication.client.getClientEnv("localAddon");t=(t=0==e[0]?e[1]:t)||""}catch(i){}PJF.constants.clientSubVersion=t}return PJF.constants.clientSubVersion},compareVersion:function(t,e){if("string"!=typeof(t=t||"")&&(t+=""),t===(e=e||""))return 0;for(var i,n,o=t.split("."),a=e.split("."),s=0,r=o.length;s<r;s++){if((i=parseInt(o[s]))<(n=parseInt(a[s])))return-1;if(n<i)return 1}return a.length>o.length?-1:1},compareClientVersion:function(t,e){
var i=PJF.util.getClientVersion(),n=PJF.util.getClientSubVersion()+"",o=PJF.util.clientVersionTransform(i,n);i=o.version,n=parseInt(o.addon,10)||0;for(var a=t.split("."),s=i.split("."),r=Math.min(s.length,a.length),c=0;c<r;c++){a[c]=a[c].match(/[0-9]+/),a[c]=a[c]?a[c][0]:0,s[c]=s[c].match(/[0-9]+/),s[c]=s[c]?s[c][0]:0;var l=parseInt(a[c],10),d=parseInt(s[c],10);if(d<l)return!1;if(l<d)return!0}if(e&&a.length==s.length){if(n<e)return!1;if(e<n)return!0}return a.length<=s.length},isCrossDomain:function(t){var e,i,n=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/;try{i=location.href}catch(a){(i=document.createElement("a")).href="",i=i.href}e=n.exec(i.toLowerCase())||[],t=(t||"").replace(/#.*$/,"").replace(/^\/\//,e[1]+"//");var o=n.exec(t.toLowerCase());return!(!o||o[1]===e[1]&&o[2]===e[2]&&(o[3]||("http:"===o[1]?80:443))==(e[3]||("http:"===e[1]?80:443)))},_keyboard_height_:0,_top_scroll_ele_:null,_get_scroll_ele_:function(){if(!this._top_scroll_ele_){
var t=document.documentElement,e=t.style.overflowY,i=t.scrollTop;t.style.overflowY="auto",t.scrollTop=10,this._top_scroll_ele_=0===t.scrollTop?document.body:t,t.scrollTop=i,t.style.overflowY=e}return this._top_scroll_ele_},_calc_eleKeyboardUp_:function(t,e){e=e||$(window).height();var i=t.getBoundingClientRect().bottom-.4*e;return 0<i?i:0},_adaptElekeyboard_:function(t,e){var i=$(window).height(),n=this._calc_eleKeyboardUp_(t,i);(e&&(document.body.style.marginBottom=.6*i+"px"),0<n)&&(document.documentElement.style.overflowY="auto",this._get_scroll_ele_().scrollTop+=n)},adaptKeyBoard:function(i,n){var o=this;PJF.event.addSubscriber(PJF.PadClientEvents.shell.keyboardShow,PJF.util.debounce(function(t){function e(){document.activeElement&&o._adaptElekeyboard_(document.activeElement,!0)}t=t||i,o._keyboard_height_=t,n?setTimeout(e,n):e()},150)),PJF.event.addSubscriber(PJF.PadClientEvents.shell.keyboardHide,PJF.util.debounce(function(t){o._keyboard_height_=0,o._get_scroll_ele_().scrollTop=0,
document.body.style.marginBottom="0",document.documentElement.style.overflowY=""},150))},adaptEle4Keyboard:function(t){0!==this._keyboard_height_&&("string"==typeof t&&(t=document.getElementById(t)),t&&this._adaptElekeyboard_(t,!1))},getStyle:function(t){for(var e in document.styleSheets){var i=document.styleSheets[e].cssRules;for(var n in i)if(i[n].selectorText==t)return i[n]}return null},loadJavaScript:function(t){if(document.head){var e=document.createElement("script");e.type="text/javascript",e.src=t,document.head.appendChild(e)}},numStrip:function(t){var e=parseFloat(t);if(isNaN(e))return t;var i=e.toPrecision(15);return parseFloat(i)},numSplit:function(t,e,i,n){if(!t)return t;!isNaN(n)&&0<=n&&(t=parseFloat(t).toFixed(n)),e=e||",",i=i||3;var o="";"-"==(t+="").charAt(0)&&(t=t.substr(1),o="-");var a=t.indexOf("."),s=[];-1==a&&(a=t.length),s.push(t.substr(a));for(var r=a;i<r;)r-=i,s.unshift(e+t.substr(r,i));return s.unshift(t.substring(0,r)),o+(t=s.join(""))},
getBase64Sign:function(t){var e=$.extend({str:"测试",color:"#999",fontSize:24,padding:10},t),i=document.createElement("canvas");i.height=500;var n=i.getContext("2d");n.font=e.fontSize+"px 微软雅黑";for(var o,a=e.str.split("\n"),s=a.length*e.fontSize,r=0,c=0;c<a.length;c++)r<(o=n.measureText(a[c]).width)&&(r=o);var l=(s+r+4*e.padding)/1.4;i.width=l,i.height=l,n.translate(i.width/2,i.height/2),n.rotate(-Math.PI/4),n.font=e.fontSize+"px 微软雅黑",n.fillStyle=e.color,n.textAlign="center";var d=a.length%2,u=(a.length-d)/2,h=1===d?0:.5*e.fontSize;for(c=0;c<a.length;c++)n.fillText(a[c],0,h+(c-u)*e.fontSize);return i.toDataURL("image/png")},clearSign:function(){$(document.body).children(".pjf-sys-sign").remove()},setSignStyle:function(t,e){this.clearSign();var i=$(document.body),n="background-image:url("+t+");background-repeat:repeat;position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000000;pointer-events:none;";n+="opacity:"+(e=e||.2)+";",
$("<div/>").attr("class","pjf-sys-sign").attr("pointer-events","none").attr("style",n).appendTo(i)},sign:function(t){this.setSignStyle(this.getBase64Sign(t),t.opacity)},numClean:function(t){return("-"===(t=(t||"")+"").charAt(0)?"-":"")+t.replace(/[^0-9\.]/g,"")},debounce:function(i,n,o){if(!$.isFunction(i))return null;var a,s,r=-1,t=Array.prototype.slice;return function(){s=t.apply(arguments),a=Date.now(),r<0&&(r=function e(t){return setTimeout(function(){var t=Date.now();if(t-a<n)return e(n-(t-a));r=-1,i.apply(o,s)},t)}(n))}},md5:window.md5,queryOpp:function(t,e){if(e&&(window.jumpObj=e),t){window._businsOpp={queryData:t};var i=document.getElementsByTagName("HEAD").item(0),n=document.createElement("script");n.type="text/javascript",n.src="/bosWeb/page/business/queryOpp.js",i.appendChild(n)}},htmlDecode:function(t){return t?t.replace(/&gt;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/<br>/g,"\n"):""},
htmlEncode:function(t){return t?t.replace(/&/g,"&gt;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;").replace(/\n/g,"<br>"):""},qrCode:function(t,e){var i=$("<div style='display:none' ></div>").appendTo(document.body);i.qrcode($.extend({text:t},e));i[0].firstChild.toDataURL("image/png");var n=i[0].firstChild;return i.remove(),PJF.util.generateBmpBase64(n)},barCode:function(t,e){jq=$("<canvas style='display:none'></canvas>").appendTo(document.body),jq.JsBarcode(t,e);var i=jq[0];return jq.remove(),PJF.util.generateBmpBase64(i)},generateBmpBase64:function(t,e){e=e||1;for(var i=t.getContext("2d").getImageData(0,0,t.width,t.height).data,n=[],o=t.height-1;0<=o;o--){for(var a=[],s=0;s<t.width;s++){var r=o*t.width*4+4*s;if(e<=8){var c=Math.floor(255/(Math.pow(2,e)-1)),l=Math.floor((i[r]+i[r+1]+i[r+2])/c/3);a.push(l)}else if(16==e){var d=Math.ceil(i[r]/255*31),u=Math.ceil(i[r+1]/255*31),h=Math.ceil(i[r+2]/255*31)
;a.push(((7&u)<<5)+h),a.push(0+(d<<2)+(u>>3))}else{var p=(32==e?i[r+3]:255)/255;a.push(i[r+2]*p+255*(1-p)),a.push(i[r+1]*p+255*(1-p)),a.push(i[r]*p+255*(1-p)),32==e&&a.push(i[r+3])}}if(e<=8){for(var f=[],m=Math.floor(8/e),g=0,v=a.length;g<v;g+=m){for(var _=0,b=0;b<m;b+=1)_+=a[g+b]<<m-b-1;f.push(_)}a=f}for(var y=4*Math.floor((e*t.width+31)/32);y>a.length;)a.push(0);n=n.concat(a)}return function(t,e,i,n){var o,a;function s(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}if(o=e<=8?54+4*Math.pow(2,e):54,a="BM",a+=s(o+Math.ceil(i*n*e/8)),a+=s(0),a+=s(o),a+=s(40),a+=s(i),a+=s(n),a+=String.fromCharCode(1,0),a+=String.fromCharCode(e,0),a+=s(0),a+=s(t.length),a+=s(0),a+=s(0),a+=s(0),a+=s(0),e<=8){a+=s(0);for(var r=Math.floor(255/(Math.pow(2,e)-1)),c=r;c<256;c+=r)a+=s(c+256*c+65536*c)}for(var c=0,l=t.length;c<l;c++)a+=String.fromCharCode(t[c]);return"data:image/bmp;base64,"+btoa(a)}(n,e,t.width,t.height)},getClientUUid:function(){
if("pc"==PJF.constants.termType&&PJF.communication.client.isInP2()){if(0==(t=PJF.communication.client.getUniqueNo())[0])return t[1]}else if("stm"!=PJF.constants.termType&&"pad"!=PJF.constants.termType||!PJF.communication.isInClient()){if("mobile"==PJF.constants.termType&&PJF.client&&PJF.client.isInClient()){if((t=PJF.client.getUUID()).success)return t.result}}else{var t;if((t=PJF.communication.GetUniqueNo()).success)return t.result}},addAtchBtchNoToUrl:function(t){if(!t)return t;if(-1===t.indexOf("getLocalFile.action?")||-1!==t.indexOf("ATCH_BTCH_NO"))return t;var e=PJF.util.getClientUUid();return e?t.replace("getLocalFile.action?","getLocalFile.action?ATCH_BTCH_NO="+e+"&"):t},addAtchBtchNoToJsonData:function(t){if("object"===PJF.util.getType(t)){var e=PJF.util.getClientUUid();if(e)if(t.jsonData){if("object"===PJF.util.getType(t.jsonData))t.jsonData.ATCH_BTCH_NO=e;else if("string"===PJF.util.getType(t.jsonData))try{var i=JSON.parse(t.jsonData);i.ATCH_BTCH_NO=e,
t.jsonData=JSON.stringify(i)}catch(n){console.log("addAtchBtchNoToJsonData error:"+n.message)}}else t.jsonData=JSON.stringify({ATCH_BTCH_NO:e})}return t},addAtchBtchNoToJsonDataEval:function(data){if("object"===PJF.util.getType(data)){var uuid=PJF.util.getClientUUid();if(uuid)if(data.jsonData){if("object"===PJF.util.getType(data.jsonData))data.jsonData.ATCH_BTCH_NO=uuid;else if("string"===PJF.util.getType(data.jsonData))try{var jsonData=eval("("+data.jsonData+")");jsonData.ATCH_BTCH_NO=uuid,data.jsonData=JSON.stringify(jsonData)}catch(e){console.log("addAtchBtchNoToJsonDataEval error:"+e.message)}}else data.jsonData=JSON.stringify({ATCH_BTCH_NO:uuid})}else if("string"===PJF.util.getType(data)){var uuid=PJF.util.getClientUUid();if(uuid){var num=data.indexOf("jsonData");data=-1!==num?data.replace("jsonData={",'jsonData={"ATCH_BTCH_NO":"'+uuid+'",'):data+'&jsonData={"ATCH_BTCH_NO":"'+uuid+'",'}}return data}};var mySeed=0;function onLylxRecordError(t){new PJF.ui.messageBox({style:"info",
closable:!1,title:"双录提示",content:"调用双录外设失败，交易将关闭，请联系管理员！错误信息："+t,fn:function(){PJF.communication.client.tabClose(!1)}})}function onLylxPlayVideoError(t){new PJF.ui.messageBox({style:"warning",title:"双录提示",content:"调用双录播放驱动失败！错误信息："+t})}function onLYLXRecordSucc(){PJF.lylx.constants.LYLX_RECORD_FLAG=!0}PJF.util.Collection=function(t,e){this.items=[],this.map={},this.keys=[],this.length=0,this.id=mySeed++,this.allowFunctions=!0===t,e&&(this.getKey=e)},PJF.util.array={indexOf:function(t,e,i){var n=t.length;for(i=i||0,i+=i<0?n:0;i<n;++i)if(t[i]===e)return i;return-1},locateOf:function(t,e){for(var i=t.length,n=0;n<i;++n)if(t[n]<=e)return n;return i}},PJF.util.string={replaceall:function(t,e,i){return t.replace(new RegExp(e,"gm"),i)},startWith:function(t,e){return new RegExp("^"+e).test(t)},endWith:function(t,e){return new RegExp(e+"$").test(t)}},PJF.apply(PJF.util.Collection.prototype,{allowFunctions:!1,add:function(t,e){if(1==arguments.length&&(e=t,t=this.getKey(e)),null!=t){
if(void 0!==this.map[t])return this.replace(t,e);this.map[t]=e}return this.length++,this.items.push(e),this.keys.push(t),e},getKey:function(t){return t.id},replace:function(t,e){1==arguments.length&&(e=t,t=this.getKey(e));var i=this.map[t];if(null==t||void 0===i)return this.add(t,e);var n=this.indexOfKey(t);return this.items[n]=e,this.map[t]=e},addAll:function(t){if(1<arguments.length||"array"==PJF.util.getType(t))for(var e=1<arguments.length?arguments:t,i=0,n=e.length;i<n;i++)this.add(e[i]);else for(var o in t)(this.allowFunctions||"function"!=typeof t[o])&&this.add(o,t[o])},each:function(t,e){for(var i=[].concat(this.items),n=0,o=i.length;n<o&&!1!==t.call(e||i[n],i[n],n,o);n++);},eachKey:function(t,e){for(var i=0,n=this.keys.length;i<n&&!1!==t.call(e||window,this.keys[i],this.items[i],i,n);i++);},find:function(t,e){for(var i=0,n=this.items.length;i<n;i++)if(t.call(e||window,this.items[i],this.keys[i]))return this.items[i];return null},insert:function(t,e,i){
return 2==arguments.length&&(i=e,e=this.getKey(i)),this.containsKey(e)&&(this.suspendEvents(),this.removeKey(e),this.resumeEvents()),t>=this.length?this.add(e,i):(this.length++,this.items.splice(t,0,i),null!=e&&(this.map[e]=i),this.keys.splice(t,0,e),i)},remove:function(t){return this.removeAt(this.indexOf(t))},removeAt:function(t){if(t<this.length&&0<=t){this.length--;var e=this.items[t];this.items.splice(t,1);var i=this.keys[t];return void 0!==i&&delete this.map[i],this.keys.splice(t,1),e}return!1},removeKey:function(t){return this.removeAt(this.indexOfKey(t))},getCount:function(){return this.length},indexOf:function(t){return PJF.util.array.indexOf(this.items,t)},indexOfKey:function(t){return PJF.util.array.indexOf(this.keys,t)},item:function(t){var e=this.map[t],i=e!==undefined?e:"number"==typeof t?this.items[t]:undefined;return"function"!=typeof i||this.allowFunctions?i:null},itemAt:function(t){return this.items[t]},key:function(t){return this.map[t]},contains:function(t){
return-1!=this.indexOf(t)},containsKey:function(t){return"undefined"!=typeof this.map[t]},clear:function(){this.length=0,this.items=[],this.keys=[],this.map={}},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},_sort:function(n,t,o){var e,i,a="DESC"==String(t).toUpperCase()?-1:1,s=[],r=this.keys,c=this.items;for(o=o||function(t,e){return t-e},e=0,i=c.length;e<i;e++)s[s.length]={key:r[e],value:c[e],index:e};for(s.sort(function(t,e){var i=o(t[n],e[n])*a;return 0===i&&(i=t.index<e.index?-1:1),i}),e=0,i=s.length;e<i;e++)c[e]=s[e].value,r[e]=s[e].key},sort:function(t,e){this._sort("value",t,e)},reorder:function(t){var e,i=this.items,n=0,o=i.length,a=[],s=[];for(e in t)a[t[e]]=i[e];for(n=0;n<o;n++)t[n]==undefined&&s.push(i[n]);for(n=0;n<o;n++)a[n]==undefined&&(a[n]=s.shift());this.clear(),this.addAll(a),this.resumeEvents()},keySort:function(t,e){this._sort("key",t,e||function(t,e){var i=String(t).toUpperCase(),n=String(e).toUpperCase()
;return n<i?1:i<n?-1:0})},getRange:function(t,e){var i=this.items;if(i.length<1)return[];var n,o=[];if((t=t||0)<=(e=Math.min(void 0===e?this.length-1:e,this.length-1)))for(n=t;n<=e;n++)o[o.length]=i[n];else for(n=t;e<=n;n--)o[o.length]=i[n];return o},filter:function(e,i,t,n){return Ext.isEmpty(i,!1)?this.clone():(i=this.createValueMatcher(i,t,n),this.filterBy(function(t){return t&&i.test(t[e])}))},filterBy:function(t,e){var i=new Ext.util.MixedCollection;i.getKey=this.getKey;for(var n=this.keys,o=this.items,a=0,s=o.length;a<s;a++)t.call(e||this,o[a],n[a])&&i.add(n[a],o[a]);return i},findIndex:function(e,i,t,n,o){return Ext.isEmpty(i,!1)?-1:(i=this.createValueMatcher(i,n,o),this.findIndexBy(function(t){return t&&i.test(t[e])},null,t))},findIndexBy:function(t,e,i){for(var n=this.keys,o=this.items,a=i||0,s=o.length;a<s;a++)if(t.call(e||this,o[a],n[a]))return a;return-1},createValueMatcher:function(t,e,i,n){if(!t.exec){var o=Ext.escapeRe;t=String(t),!0===e?t=o(t):(t="^"+o(t),
!0===n&&(t+="$")),t=new RegExp(t,i?"":"i")}return t},clone:function(){for(var t=new Ext.util.MixedCollection,e=this.keys,i=this.items,n=0,o=i.length;n<o;n++)t.add(e[n],i[n]);return t.getKey=this.getKey,t}}),PJF.namespace("PJF.fsm"),function(t){var e={};t.create=function(r){if((r=$.extend({},r)).id)if(e[r.id]&&console.log("状态机ID重复:"+r.id),r.initial){if(r.actions&&!(r.actions.length<=0))return e[r.id]=function(){for(var t=r.actions,e=(r.callbacks,[]),i={},n=r.initial,o={},a=0;a<t.length;a++){var s=t[a];-1==PJF.util.array.indexOf(e,s.from)&&e.push(s.from),-1==PJF.util.array.indexOf(e,s.to)&&e.push(s.to),o[s.name]={from:s.from,to:s.to},function(t){i[t.name]=function(){n==t.from?(n=t.to,console.log("状态机转化"+t.name+", 从"+t.from+"转化为"+t.to)):console.log("状态机转化"+t.name+"错误, 不能从"+n+"转化为"+t.to)}}(s)}return i.is=function(t){return n===t},i.current=function(){return n},i.can=function(t){return o[t]&&o[t].from==n},i.cannot=function(t){return!this.can(t)},i.isDone=function(){return n===r.done},i}()
;alert("状态机必须至少有一个状态转化")}else alert("状态机必须有初始状态");else alert("状态机id未定义")},t.get=function(t){return e[t]},t.isDone=function(t){return 0==t.length||!this.get(t[0])||this.get(t[0]).isDone()&&this.isDone(t.slice(1))},t.fmIds={STM_CAMERA:"pjfStmCamera",STM_SIGNATURE:"pjfStmSignature",STM_ICCARD:"pjfStmIccard",STM_IDCARD:"pjfStmIdcard",STM_PAD_TEMPLATEINFO:"pjfStmPadTemInfo",STM_PRT:"pjfStmPrt"}}(PJF.fsm),function(t){var e,i,n,o,a={"啊":"a","阿":"a","锕":"a","埃":"ai","挨":"ai","哎":"ai","唉":"ai","哀":"ai","皑":"ai","癌":"ai","蔼":"ai","矮":"ai","艾":"ai","碍":"ai","爱":"ai","隘":"ai","诶":"ai","捱":"ai","嗳":"ai","嗌":"ai","嫒":"ai","瑷":"ai","暧":"ai","砹":"ai","锿":"ai","霭":"ai","鞍":"an","氨":"an","安":"an","俺":"an","按":"an","暗":"an","岸":"an","胺":"an","案":"an","谙":"an","埯":"an","揞":"an","犴":"an","庵":"an","桉":"an","铵":"an","鹌":"an","顸":"an","黯":"an","肮":"ang","昂":"ang","盎":"ang","凹":"ao","敖":"ao","熬":"ao","翱":"ao","袄":"ao","傲":"ao","奥":"ao","懊":"ao","澳":"ao","坳":"ao","拗":"ao","嗷":"ao","噢":"ao","岙":"ao","廒":"ao",
"遨":"ao","媪":"ao","骜":"ao","聱":"ao","螯":"ao","鏊":"ao","鳌":"ao","鏖":"ao","芭":"ba","捌":"ba","扒":"ba","叭":"ba","吧":"ba","笆":"ba","八":"ba","疤":"ba","巴":"ba","拔":"ba","跋":"ba","靶":"ba","把":"ba","耙":"ba","坝":"ba","霸":"ba","罢":"ba","爸":"ba","茇":"ba","菝":"ba","萆":"ba","捭":"ba","岜":"ba","灞":"ba","杷":"ba","钯":"ba","粑":"ba","鲅":"ba","魃":"ba","白":"bai","柏":"bai","百":"bai","摆":"bai","佰":"bai","败":"bai","拜":"bai","稗":"bai","薜":"bai","掰":"bai","鞴":"bai","斑":"ban","班":"ban","搬":"ban","扳":"ban","般":"ban","颁":"ban","板":"ban","版":"ban","扮":"ban","拌":"ban","伴":"ban","瓣":"ban","半":"ban","办":"ban","绊":"ban","阪":"ban","坂":"ban","豳":"ban","钣":"ban","瘢":"ban","癍":"ban","舨":"ban","邦":"bang","帮":"bang","梆":"bang","榜":"bang","膀":"bang","绑":"bang","棒":"bang","磅":"bang","蚌":"bang","镑":"bang","傍":"bang","谤":"bang","蒡":"bang","螃":"bang","苞":"bao","胞":"bao","包":"bao","褒":"bao","雹":"bao","保":"bao","堡":"bao","饱":"bao","宝":"bao","抱":"bao","报":"bao","暴":"bao","豹":"bao","鲍":"bao","爆":"bao","勹":"bao","葆":"bao","宀":"bao",
"孢":"bao","煲":"bao","鸨":"bao","褓":"bao","趵":"bao","龅":"bao","剥":"bo","薄":"bo","玻":"bo","菠":"bo","播":"bo","拨":"bo","钵":"bo","波":"bo","博":"bo","勃":"bo","搏":"bo","铂":"bo","箔":"bo","伯":"bo","帛":"bo","舶":"bo","脖":"bo","膊":"bo","渤":"bo","泊":"bo","驳":"bo","亳":"bo","蕃":"bo","啵":"bo","饽":"bo","檗":"bo","擘":"bo","礴":"bo","钹":"bo","鹁":"bo","簸":"bo","跛":"bo","杯":"bei","碑":"bei","悲":"bei","卑":"bei","北":"bei","辈":"bei","背":"bei","贝":"bei","钡":"bei","倍":"bei","狈":"bei","备":"bei","惫":"bei","焙":"bei","被":"bei","孛":"bei","陂":"bei","邶":"bei","埤":"bei","蓓":"bei","呗":"bei","怫":"bei","悖":"bei","碚":"bei","鹎":"bei","褙":"bei","鐾":"bei","奔":"ben","苯":"ben","本":"ben","笨":"ben","畚":"ben","坌":"ben","锛":"ben","崩":"beng","绷":"beng","甭":"beng","泵":"beng","蹦":"beng","迸":"beng","唪":"beng","嘣":"beng","甏":"beng","逼":"bi","鼻":"bi","比":"bi","鄙":"bi","笔":"bi","彼":"bi","碧":"bi","蓖":"bi","蔽":"bi","毕":"bi","毙":"bi","毖":"bi","币":"bi","庇":"bi","痹":"bi","闭":"bi","敝":"bi","弊":"bi","必":"bi","辟":"bi","壁":"bi","臂":"bi","避":"bi",
"陛":"bi","匕":"bi","仳":"bi","俾":"bi","芘":"bi","荜":"bi","荸":"bi","吡":"bi","哔":"bi","狴":"bi","庳":"bi","愎":"bi","滗":"bi","濞":"bi","弼":"bi","妣":"bi","婢":"bi","嬖":"bi","璧":"bi","贲":"bi","畀":"bi","铋":"bi","秕":"bi","裨":"bi","筚":"bi","箅":"bi","篦":"bi","舭":"bi","襞":"bi","跸":"bi","髀":"bi","鞭":"bian","边":"bian","编":"bian","贬":"bian","扁":"bian","便":"bian","变":"bian","卞":"bian","辨":"bian","辩":"bian","辫":"bian","遍":"bian","匾":"bian","弁":"bian","苄":"bian","忭":"bian","汴":"bian","缏":"bian","煸":"bian","砭":"bian","碥":"bian","稹":"bian","窆":"bian","蝙":"bian","笾":"bian","鳊":"bian","标":"biao","彪":"biao","膘":"biao","表":"biao","婊":"biao","骠":"biao","飑":"biao","飙":"biao","飚":"biao","灬":"biao","镖":"biao","镳":"biao","瘭":"biao","裱":"biao","鳔":"biao","鳖":"bie","憋":"bie","别":"bie","瘪":"bie","蹩":"bie","鳘":"bie","彬":"bin","斌":"bin","濒":"bin","滨":"bin","宾":"bin","摈":"bin","傧":"bin","浜":"bin","缤":"bin","玢":"bin","殡":"bin","膑":"bin","镔":"bin","髌":"bin","鬓":"bin","兵":"bing","冰":"bing","柄":"bing","丙":"bing","秉":"bing",
"饼":"bing","炳":"bing","病":"bing","并":"bing","禀":"bing","邴":"bing","摒":"bing","绠":"bing","枋":"bing","槟":"bing","燹":"bing","捕":"bu","卜":"bu","哺":"bu","补":"bu","埠":"bu","不":"bu","布":"bu","步":"bu","簿":"bu","部":"bu","怖":"bu","拊":"bu","卟":"bu","逋":"bu","瓿":"bu","晡":"bu","钚":"bu","醭":"bu","擦":"ca","嚓":"ca","礤":"ca","猜":"cai","裁":"cai","材":"cai","才":"cai","财":"cai","睬":"cai","踩":"cai","采":"cai","彩":"cai","菜":"cai","蔡":"cai","餐":"can","参":"can","蚕":"can","残":"can","惭":"can","惨":"can","灿":"can","骖":"can","璨":"can","粲":"can","黪":"can","苍":"cang","舱":"cang","仓":"cang","沧":"cang","藏":"cang","伧":"cang","操":"cao","糙":"cao","槽":"cao","曹":"cao","草":"cao","艹":"cao","嘈":"cao","漕":"cao","螬":"cao","艚":"cao","厕":"ce","策":"ce","侧":"ce","册":"ce","测":"ce","刂":"ce","帻":"ce","恻":"ce","层":"ceng","蹭":"ceng","噌":"ceng","插":"cha","叉":"cha","茬":"cha","茶":"cha","查":"cha","碴":"cha","搽":"cha","察":"cha","岔":"cha","差":"cha","诧":"cha","猹":"cha","馇":"cha","汊":"cha","姹":"cha","杈":"cha","楂":"cha","槎":"cha","檫":"cha",
"钗":"cha","锸":"cha","镲":"cha","衩":"cha","拆":"chai","柴":"chai","豺":"chai","侪":"chai","茈":"chai","瘥":"chai","虿":"chai","龇":"chai","搀":"chan","掺":"chan","蝉":"chan","馋":"chan","谗":"chan","缠":"chan","铲":"chan","产":"chan","阐":"chan","颤":"chan","冁":"chan","谄":"chan","谶":"chan","蒇":"chan","廛":"chan","忏":"chan","潺":"chan","澶":"chan","孱":"chan","羼":"chan","婵":"chan","嬗":"chan","骣":"chan","觇":"chan","禅":"chan","镡":"chan","裣":"chan","蟾":"chan","躔":"chan","昌":"chang","猖":"chang","场":"chang","尝":"chang","常":"chang","长":"chang","偿":"chang","肠":"chang","厂":"chang","敞":"chang","畅":"chang","唱":"chang","倡":"chang","伥":"chang","鬯":"chang","苌":"chang","菖":"chang","徜":"chang","怅":"chang","惝":"chang","阊":"chang","娼":"chang","嫦":"chang","昶":"chang","氅":"chang","鲳":"chang","超":"chao","抄":"chao","钞":"chao","朝":"chao","嘲":"chao","潮":"chao","巢":"chao","吵":"chao","炒":"chao","怊":"chao","绉":"chao","晁":"chao","耖":"chao","车":"che","扯":"che","撤":"che","掣":"che","彻":"che","澈":"che","坼":"che","屮":"che","砗":"che",
"郴":"chen","臣":"chen","辰":"chen","尘":"chen","晨":"chen","忱":"chen","沉":"chen","陈":"chen","趁":"chen","衬":"chen","称":"chen","谌":"chen","抻":"chen","嗔":"chen","宸":"chen","琛":"chen","榇":"chen","肜":"chen","胂":"chen","碜":"chen","龀":"chen","撑":"cheng","城":"cheng","橙":"cheng","成":"cheng","呈":"cheng","乘":"cheng","程":"cheng","惩":"cheng","澄":"cheng","诚":"cheng","承":"cheng","逞":"cheng","骋":"cheng","秤":"cheng","埕":"cheng","嵊":"cheng","徵":"cheng","浈":"cheng","枨":"cheng","柽":"cheng","樘":"cheng","晟":"cheng","塍":"cheng","瞠":"cheng","铖":"cheng","裎":"cheng","蛏":"cheng","酲":"cheng","吃":"chi","痴":"chi","持":"chi","匙":"chi","池":"chi","迟":"chi","弛":"chi","驰":"chi","耻":"chi","齿":"chi","侈":"chi","尺":"chi","赤":"chi","翅":"chi","斥":"chi","炽":"chi","傺":"chi","墀":"chi","芪":"chi","茌":"chi","搋":"chi","叱":"chi","哧":"chi","啻":"chi","嗤":"chi","彳":"chi","饬":"chi","沲":"chi","媸":"chi","敕":"chi","胝":"chi","眙":"chi","眵":"chi","鸱":"chi","瘛":"chi","褫":"chi","蚩":"chi","螭":"chi","笞":"chi","篪":"chi","豉":"chi","踅":"chi","踟":"chi",
"魑":"chi","充":"chong","冲":"chong","虫":"chong","崇":"chong","宠":"chong","茺":"chong","忡":"chong","憧":"chong","铳":"chong","艟":"chong","抽":"chou","酬":"chou","畴":"chou","踌":"chou","稠":"chou","愁":"chou","筹":"chou","仇":"chou","绸":"chou","瞅":"chou","丑":"chou","俦":"chou","圳":"zhen","帱":"chou","惆":"chou","溴":"chou","妯":"chou","瘳":"chou","雠":"chou","鲋":"chou","臭":"chu","初":"chu","出":"chu","橱":"chu","厨":"chu","躇":"chu","锄":"chu","雏":"chu","滁":"chu","除":"chu","楚":"chu","础":"chu","储":"chu","矗":"chu","搐":"chu","触":"chu","处":"chu","亍":"chu","刍":"chu","憷":"chu","绌":"chu","杵":"chu","楮":"chu","樗":"chu","蜍":"chu","蹰":"chu","黜":"chu","揣":"chuan","川":"chuan","穿":"chuan","椽":"chuan","传":"chuan","船":"chuan","喘":"chuan","串":"chuan","掾":"chuan","舛":"chuan","惴":"chuan","遄":"chuan","巛":"chuan","氚":"chuan","钏":"chuan","镩":"chuan","舡":"chuan","疮":"chuang","窗":"chuang","幢":"chuang","床":"chuang","闯":"chuang","创":"chuang","怆":"chuang","吹":"chui","炊":"chui","捶":"chui","锤":"chui","垂":"chui","陲":"chui","棰":"chui",
"槌":"chui","春":"chun","椿":"chun","醇":"chun","唇":"chun","淳":"chun","纯":"chun","蠢":"chun","促":"chun","莼":"chun","沌":"chun","肫":"chun","朐":"chun","鹑":"chun","蝽":"chun","戳":"chuo","绰":"chuo","蔟":"chuo","辶":"chuo","辍":"chuo","镞":"chuo","踔":"chuo","龊":"chuo","疵":"ci","茨":"ci","磁":"ci","雌":"ci","辞":"ci","慈":"ci","瓷":"ci","词":"ci","此":"ci","刺":"ci","赐":"ci","次":"ci","荠":"ci","呲":"ci","嵯":"ci","鹚":"ci","螅":"ci","糍":"ci","趑":"ci","聪":"cong","葱":"cong","囱":"cong","匆":"cong","从":"cong","丛":"cong","偬":"cong","苁":"cong","淙":"cong","骢":"cong","琮":"cong","璁":"cong","枞":"cong","凑":"cu","粗":"cu","醋":"cu","簇":"cu","猝":"cu","殂":"cu","蹙":"cu","蹿":"cuan","篡":"cuan","窜":"cuan","汆":"cuan","撺":"cuan","昕":"cuan","爨":"cuan","摧":"cui","崔":"cui","催":"cui","脆":"cui","瘁":"cui","粹":"cui","淬":"cui","翠":"cui","萃":"cui","悴":"cui","璀":"cui","榱":"cui","隹":"cui","村":"cun","存":"cun","寸":"cun","磋":"cun","忖":"cun","皴":"cun","撮":"cuo","搓":"cuo","措":"cuo","挫":"cuo","错":"cuo","厝":"cuo","脞":"cuo","锉":"cuo","矬":"cuo","痤":"cuo",
"鹾":"cuo","蹉":"cuo","躜":"cuo","搭":"da","达":"da","答":"da","瘩":"da","打":"da","大":"da","耷":"da","哒":"da","嗒":"da","怛":"da","妲":"da","疸":"da","褡":"da","笪":"da","靼":"da","鞑":"da","呆":"dai","歹":"dai","傣":"dai","戴":"dai","带":"dai","殆":"dai","代":"dai","贷":"dai","袋":"dai","待":"dai","逮":"dai","怠":"dai","埭":"dai","甙":"dai","呔":"dai","岱":"dai","迨":"dai","逯":"dai","骀":"dai","绐":"dai","玳":"dai","黛":"dai","耽":"dan","担":"dan","丹":"dan","单":"dan","郸":"dan","掸":"dan","胆":"dan","旦":"dan","氮":"dan","但":"dan","惮":"dan","淡":"dan","诞":"dan","弹":"dan","蛋":"dan","亻":"dan","儋":"dan","卩":"dan","萏":"dan","啖":"dan","澹":"dan","檐":"dan","殚":"dan","赕":"dan","眈":"dan","瘅":"dan","聃":"dan","箪":"dan","当":"dang","挡":"dang","党":"dang","荡":"dang","档":"dang","谠":"dang","凼":"dang","菪":"dang","宕":"dang","砀":"dang","铛":"dang","裆":"dang","刀":"dao","捣":"dao","蹈":"dao","倒":"dao","岛":"dao","祷":"dao","导":"dao","到":"dao","稻":"dao","悼":"dao","道":"dao","盗":"dao","叨":"dao","啁":"dao","忉":"dao","洮":"dao","氘":"dao","焘":"dao","忑":"dao",
"纛":"dao","德":"de","得":"de","的":"de","锝":"de","蹬":"deng","灯":"deng","登":"deng","等":"deng","瞪":"deng","凳":"deng","邓":"deng","噔":"deng","嶝":"deng","戥":"deng","磴":"deng","镫":"deng","簦":"deng","堤":"di","低":"di","滴":"di","迪":"di","敌":"di","笛":"di","狄":"di","涤":"di","翟":"di","嫡":"di","抵":"di","底":"di","地":"di","蒂":"di","第":"di","帝":"di","弟":"di","递":"di","缔":"di","氐":"di","籴":"di","诋":"di","谛":"di","邸":"di","坻":"di","莜":"di","荻":"di","嘀":"di","娣":"di","柢":"di","棣":"di","觌":"di","砥":"di","碲":"di","睇":"di","镝":"di","羝":"di","骶":"di","颠":"dian","掂":"dian","滇":"dian","碘":"dian","点":"dian","典":"dian","靛":"dian","垫":"dian","电":"dian","佃":"dian","甸":"dian","店":"dian","惦":"dian","奠":"dian","淀":"dian","殿":"dian","丶":"dian","阽":"dian","坫":"dian","埝":"dian","巅":"dian","玷":"dian","癜":"dian","癫":"dian","簟":"dian","踮":"dian","碉":"diao","叼":"diao","雕":"diao","凋":"diao","刁":"diao","掉":"diao","吊":"diao","钓":"diao","调":"diao","轺":"diao","铞":"diao","蜩":"diao","粜":"diao","貂":"diao","跌":"die","爹":"die",
"碟":"die","蝶":"die","迭":"die","谍":"die","叠":"die","佚":"die","垤":"die","堞":"die","揲":"die","喋":"die","渫":"die","轶":"die","牒":"die","瓞":"die","褶":"die","耋":"die","蹀":"die","鲽":"die","鳎":"die","丁":"ding","盯":"ding","叮":"ding","钉":"ding","顶":"ding","鼎":"ding","锭":"ding","定":"ding","订":"ding","丢":"ding","仃":"ding","啶":"ding","玎":"ding","腚":"ding","碇":"ding","町":"ding","铤":"ding","疔":"ding","耵":"ding","酊":"ding","东":"dong","冬":"dong","董":"dong","懂":"dong","动":"dong","栋":"dong","侗":"dong","恫":"dong","冻":"dong","洞":"dong","垌":"dong","咚":"dong","岽":"dong","峒":"dong","夂":"dong","氡":"dong","胨":"dong","胴":"dong","硐":"dong","鸫":"dong","兜":"dou","抖":"dou","斗":"dou","陡":"dou","豆":"dou","逗":"dou","痘":"dou","蔸":"dou","钭":"dou","窦":"dou","窬":"dou","蚪":"dou","篼":"dou","酡":"dou","都":"du","督":"du","毒":"du","犊":"du","独":"du","读":"du","堵":"du","睹":"du","赌":"du","杜":"du","镀":"du","肚":"du","度":"du","渡":"du","妒":"du","芏":"du","嘟":"du","渎":"du","椟":"du","橐":"du","牍":"du","蠹":"du","笃":"du","髑":"du","黩":"du",
"端":"duan","短":"duan","锻":"duan","段":"duan","断":"duan","缎":"duan","彖":"duan","椴":"duan","煅":"duan","簖":"duan","堆":"dui","兑":"dui","队":"dui","对":"dui","怼":"dui","憝":"dui","碓":"dui","墩":"dun","吨":"dun","蹲":"dun","敦":"dun","顿":"dun","囤":"dun","钝":"dun","盾":"dun","遁":"dun","炖":"dun","砘":"dun","礅":"dun","盹":"dun","镦":"dun","趸":"dun","掇":"duo","哆":"duo","多":"duo","夺":"duo","垛":"duo","躲":"duo","朵":"duo","跺":"duo","舵":"duo","剁":"duo","惰":"duo","堕":"duo","咄":"duo","哚":"duo","缍":"duo","柁":"duo","铎":"duo","裰":"duo","踱":"duo","蛾":"e","峨":"e","鹅":"e","俄":"e","额":"e","讹":"e","娥":"e","恶":"e","厄":"e","扼":"e","遏":"e","鄂":"e","饿":"e","噩":"e","谔":"e","垩":"e","垭":"e","苊":"e","莪":"e","萼":"e","呃":"e","愕":"e","屙":"e","婀":"e","轭":"e","曷":"e","腭":"e","硪":"e","锇":"e","锷":"e","鹗":"e","颚":"e","鳄":"e","恩":"en","蒽":"en","摁":"en","唔":"en","嗯":"en","而":"er","儿":"er","耳":"er","尔":"er","饵":"er","洱":"er","二":"er","贰":"er","迩":"er","珥":"er","铒":"er","鸸":"er","鲕":"er","发":"fa","罚":"fa","筏":"fa","伐":"fa","乏":"fa","阀":"fa",
"法":"fa","珐":"fa","垡":"fa","砝":"fa","藩":"fan","帆":"fan","番":"fan","翻":"fan","樊":"fan","矾":"fan","钒":"fan","繁":"fan","凡":"fan","烦":"fan","反":"fan","返":"fan","范":"fan","贩":"fan","犯":"fan","饭":"fan","泛":"fan","蘩":"fan","幡":"fan","犭":"fan","梵":"fan","攵":"fan","燔":"fan","畈":"fan","蹯":"fan","坊":"fang","芳":"fang","方":"fang","肪":"fang","房":"fang","防":"fang","妨":"fang","仿":"fang","访":"fang","纺":"fang","放":"fang","匚":"fang","邡":"fang","彷":"fang","钫":"fang","舫":"fang","鲂":"fang","菲":"fei","非":"fei","啡":"fei","飞":"fei","肥":"fei","匪":"fei","诽":"fei","吠":"fei","肺":"fei","废":"fei","沸":"fei","费":"fei","芾":"fei","狒":"fei","悱":"fei","淝":"fei","妃":"fei","绋":"fei","绯":"fei","榧":"fei","腓":"fei","斐":"fei","扉":"fei","祓":"fei","砩":"fei","镄":"fei","痱":"fei","蜚":"fei","篚":"fei","翡":"fei","霏":"fei","鲱":"fei","芬":"fen","酚":"fen","吩":"fen","氛":"fen","分":"fen","纷":"fen","坟":"fen","焚":"fen","汾":"fen","粉":"fen","奋":"fen","份":"fen","忿":"fen","愤":"fen","粪":"fen","偾":"fen","瀵":"fen","棼":"fen","愍":"fen","鲼":"fen",
"鼢":"fen","丰":"feng","封":"feng","枫":"feng","蜂":"feng","峰":"feng","锋":"feng","风":"feng","疯":"feng","烽":"feng","逢":"feng","冯":"feng","缝":"feng","讽":"feng","奉":"feng","凤":"feng","俸":"feng","酆":"feng","葑":"feng","沣":"feng","砜":"feng","佛":"fu","否":"fu","夫":"fu","敷":"fu","肤":"fu","孵":"fu","扶":"fu","拂":"fu","辐":"fu","幅":"fu","氟":"fu","符":"fu","伏":"fu","俘":"fu","服":"fu","浮":"fu","涪":"fu","福":"fu","袱":"fu","弗":"fu","甫":"fu","抚":"fu","辅":"fu","俯":"fu","釜":"fu","斧":"fu","脯":"fu","腑":"fu","府":"fu","腐":"fu","赴":"fu","副":"fu","覆":"fu","赋":"fu","复":"fu","傅":"fu","付":"fu","阜":"fu","父":"fu","腹":"fu","负":"fu","富":"fu","讣":"fu","附":"fu","妇":"fu","缚":"fu","咐":"fu","匐":"fu","凫":"fu","郛":"fu","芙":"fu","苻":"fu","茯":"fu","莩":"fu","菔":"fu","呋":"fu","幞":"fu","滏":"fu","艴":"fu","孚":"fu","驸":"fu","绂":"fu","桴":"fu","赙":"fu","黻":"fu","黼":"fu","罘":"fu","稃":"fu","馥":"fu","虍":"fu","蚨":"fu","蜉":"fu","蝠":"fu","蝮":"fu","麸":"fu","趺":"fu","跗":"fu","鳆":"fu","噶":"ga","嘎":"ga","蛤":"ga","尬":"ga","呷":"ga","尕":"ga","尜":"ga",
"旮":"ga","钆":"ga","该":"gai","改":"gai","概":"gai","钙":"gai","盖":"gai","溉":"gai","丐":"gai","陔":"gai","垓":"gai","戤":"gai","赅":"gai","胲":"gai","干":"gan","甘":"gan","杆":"gan","柑":"gan","竿":"gan","肝":"gan","赶":"gan","感":"gan","秆":"gan","敢":"gan","赣":"gan","坩":"gan","苷":"gan","尴":"gan","擀":"gan","泔":"gan","淦":"gan","澉":"gan","绀":"gan","橄":"gan","旰":"gan","矸":"gan","疳":"gan","酐":"gan","冈":"gang","刚":"gang","钢":"gang","缸":"gang","肛":"gang","纲":"gang","岗":"gang","港":"gang","戆":"gang","罡":"gang","颃":"gang","筻":"gang","杠":"gong","工":"gong","攻":"gong","功":"gong","恭":"gong","龚":"gong","供":"gong","躬":"gong","公":"gong","宫":"gong","弓":"gong","巩":"gong","汞":"gong","拱":"gong","贡":"gong","共":"gong","蕻":"gong","廾":"gong","咣":"gong","珙":"gong","肱":"gong","蚣":"gong","蛩":"gong","觥":"gong","篙":"gao","皋":"gao","高":"gao","膏":"gao","羔":"gao","糕":"gao","搞":"gao","镐":"gao","稿":"gao","告":"gao","睾":"gao","诰":"gao","郜":"gao","蒿":"gao","藁":"gao","缟":"gao","槔":"gao","槁":"gao","杲":"gao","锆":"gao","哥":"ge","歌":"ge",
"搁":"ge","戈":"ge","鸽":"ge","胳":"ge","疙":"ge","割":"ge","革":"ge","葛":"ge","格":"ge","阁":"ge","隔":"ge","铬":"ge","个":"ge","各":"ge","鬲":"ge","仡":"ge","哿":"ge","塥":"ge","嗝":"ge","纥":"ge","搿":"ge","膈":"ge","硌":"ge","铪":"ge","镉":"ge","袼":"ge","颌":"ge","虼":"ge","舸":"ge","骼":"ge","髂":"ge","给":"gei","根":"gen","跟":"gen","亘":"gen","茛":"gen","哏":"gen","艮":"gen","耕":"geng","更":"geng","庚":"geng","羹":"geng","埂":"geng","耿":"geng","梗":"geng","哽":"geng","赓":"geng","鲠":"geng","钩":"gou","勾":"gou","沟":"gou","苟":"gou","狗":"gou","垢":"gou","构":"gou","购":"gou","够":"gou","佝":"gou","诟":"gou","岣":"gou","遘":"gou","媾":"gou","缑":"gou","觏":"gou","彀":"gou","鸲":"gou","笱":"gou","篝":"gou","鞲":"gou","辜":"gu","菇":"gu","咕":"gu","箍":"gu","估":"gu","沽":"gu","孤":"gu","姑":"gu","鼓":"gu","古":"gu","蛊":"gu","骨":"gu","谷":"gu","股":"gu","故":"gu","顾":"gu","固":"gu","雇":"gu","嘏":"gu","诂":"gu","菰":"gu","哌":"gu","崮":"gu","汩":"gu","梏":"gu","轱":"gu","牯":"gu","牿":"gu","胍":"gu","臌":"gu","毂":"gu","瞽":"gu","罟":"gu","钴":"gu","锢":"gu","瓠":"gu",
"鸪":"gu","鹄":"gu","痼":"gu","蛄":"gu","酤":"gu","觚":"gu","鲴":"gu","骰":"gu","鹘":"gu","刮":"gua","瓜":"gua","剐":"gua","寡":"gua","挂":"gua","褂":"gua","卦":"gua","诖":"gua","呱":"gua","栝":"gua","鸹":"gua","乖":"guai","拐":"guai","怪":"guai","哙":"guai","棺":"guan","关":"guan","官":"guan","冠":"guan","观":"guan","管":"guan","馆":"guan","罐":"guan","惯":"guan","灌":"guan","贯":"guan","倌":"guan","莞":"guan","掼":"guan","涫":"guan","盥":"guan","鹳":"guan","鳏":"guan","光":"guang","广":"guang","逛":"guang","犷":"guang","桄":"guang","胱":"guang","疒":"guang","瑰":"gui","规":"gui","圭":"gui","硅":"gui","归":"gui","龟":"gui","闺":"gui","轨":"gui","鬼":"gui","诡":"gui","癸":"gui","桂":"gui","柜":"gui","跪":"gui","贵":"gui","刽":"gui","匦":"gui","刿":"gui","庋":"gui","宄":"gui","妫":"gui","桧":"gui","炅":"gui","晷":"gui","皈":"gui","簋":"gui","鲑":"gui","鳜":"gui","辊":"gun","滚":"gun","棍":"gun","丨":"gun","衮":"gun","绲":"gun","磙":"gun","鲧":"gun","锅":"guo","郭":"guo","国":"guo","果":"guo","裹":"guo","过":"guo","馘":"guo","蠃":"guo","埚":"guo","掴":"guo","呙":"guo","囗":"guo",
"帼":"guo","崞":"guo","猓":"guo","椁":"guo","虢":"guo","锞":"guo","聒":"guo","蜮":"guo","蜾":"guo","蝈":"guo","哈":"ha","骸":"hai","孩":"hai","海":"hai","氦":"hai","亥":"hai","害":"hai","骇":"hai","咴":"hai","嗨":"hai","颏":"hai","醢":"hai","酣":"han","憨":"han","邯":"han","韩":"han","含":"han","涵":"han","寒":"han","函":"han","喊":"han","罕":"han","翰":"han","撼":"han","捍":"han","旱":"han","憾":"han","悍":"han","焊":"han","汗":"han","汉":"han","邗":"han","菡":"han","撖":"han","阚":"han","瀚":"han","晗":"han","焓":"han","颔":"han","蚶":"han","鼾":"han","夯":"hen","痕":"hen","很":"hen","狠":"hen","恨":"hen","杭":"hang","航":"hang","沆":"hang","绗":"hang","珩":"hang","桁":"hang","壕":"hao","嚎":"hao","豪":"hao","毫":"hao","郝":"hao","好":"hao","耗":"hao","号":"hao","浩":"hao","薅":"hao","嗥":"hao","嚆":"hao","濠":"hao","灏":"hao","昊":"hao","皓":"hao","颢":"hao","蚝":"hao","呵":"he","喝":"he","荷":"he","菏":"he","核":"he","禾":"he","和":"he","何":"he","合":"he","盒":"he","貉":"he","阂":"he","河":"he","涸":"he","赫":"he","褐":"he","鹤":"he","贺":"he","诃":"he","劾":"he","壑":"he",
"藿":"he","嗑":"he","嗬":"he","阖":"he","盍":"he","蚵":"he","翮":"he","嘿":"hei","黑":"hei","哼":"heng","亨":"heng","横":"heng","衡":"heng","恒":"heng","訇":"heng","蘅":"heng","轰":"hong","哄":"hong","烘":"hong","虹":"hong","鸿":"hong","洪":"hong","宏":"hong","弘":"hong","红":"hong","黉":"hong","讧":"hong","荭":"hong","薨":"hong","闳":"hong","泓":"hong","喉":"hou","侯":"hou","猴":"hou","吼":"hou","厚":"hou","候":"hou","后":"hou","堠":"hou","後":"hou","逅":"hou","瘊":"hou","篌":"hou","糇":"hou","鲎":"hou","骺":"hou","呼":"hu","乎":"hu","忽":"hu","瑚":"hu","壶":"hu","葫":"hu","胡":"hu","蝴":"hu","狐":"hu","糊":"hu","湖":"hu","弧":"hu","虎":"hu","唬":"hu","护":"hu","互":"hu","沪":"hu","户":"hu","冱":"hu","唿":"hu","囫":"hu","岵":"hu","猢":"hu","怙":"hu","惚":"hu","浒":"hu","滹":"hu","琥":"hu","槲":"hu","轷":"hu","觳":"hu","烀":"hu","煳":"hu","戽":"hu","扈":"hu","祜":"hu","鹕":"hu","鹱":"hu","笏":"hu","醐":"hu","斛":"hu","花":"hua","哗":"hua","华":"hua","猾":"hua","滑":"hua","画":"hua","划":"hua","化":"hua","话":"hua","劐":"hua","浍":"hua","骅":"hua","桦":"hua","铧":"hua","稞":"hua",
"槐":"huai","徊":"huai","怀":"huai","淮":"huai","坏":"huai","还":"huai","踝":"huai","欢":"huan","环":"huan","桓":"huan","缓":"huan","换":"huan","患":"huan","唤":"huan","痪":"huan","豢":"huan","焕":"huan","涣":"huan","宦":"huan","幻":"huan","郇":"huan","奂":"huan","垸":"huan","擐":"huan","圜":"huan","洹":"huan","浣":"huan","漶":"huan","寰":"huan","逭":"huan","缳":"huan","锾":"huan","鲩":"huan","鬟":"huan","荒":"huang","慌":"huang","黄":"huang","磺":"huang","蝗":"huang","簧":"huang","皇":"huang","凰":"huang","惶":"huang","煌":"huang","晃":"huang","幌":"huang","恍":"huang","谎":"huang","隍":"huang","徨":"huang","湟":"huang","潢":"huang","遑":"huang","璜":"huang","肓":"huang","癀":"huang","蟥":"huang","篁":"huang","鳇":"huang","灰":"hui","挥":"hui","辉":"hui","徽":"hui","恢":"hui","蛔":"hui","回":"hui","毁":"hui","悔":"hui","慧":"hui","卉":"hui","惠":"hui","晦":"hui","贿":"hui","秽":"hui","会":"hui","烩":"hui","汇":"hui","讳":"hui","诲":"hui","绘":"hui","诙":"hui","茴":"hui","荟":"hui","蕙":"hui","哕":"hui","喙":"hui","隳":"hui","洄":"hui","彗":"hui","缋":"hui","珲":"hui",
"晖":"hui","恚":"hui","虺":"hui","蟪":"hui","麾":"hui","荤":"hun","昏":"hun","婚":"hun","魂":"hun","浑":"hun","混":"hun","诨":"hun","馄":"hun","阍":"hun","溷":"hun","缗":"hun","豁":"huo","活":"huo","伙":"huo","火":"huo","获":"huo","或":"huo","惑":"huo","霍":"huo","货":"huo","祸":"huo","攉":"huo","嚯":"huo","夥":"huo","钬":"huo","锪":"huo","镬":"huo","耠":"huo","蠖":"huo","击":"ji","圾":"ji","基":"ji","机":"ji","畸":"ji","稽":"ji","积":"ji","箕":"ji","肌":"ji","饥":"ji","迹":"ji","激":"ji","讥":"ji","鸡":"ji","姬":"ji","绩":"ji","缉":"ji","吉":"ji","极":"ji","棘":"ji","辑":"ji","籍":"ji","集":"ji","及":"ji","急":"ji","疾":"ji","汲":"ji","即":"ji","嫉":"ji","级":"ji","挤":"ji","几":"ji","脊":"ji","己":"ji","蓟":"ji","技":"ji","冀":"ji","季":"ji","伎":"ji","祭":"ji","剂":"ji","悸":"ji","济":"ji","寄":"ji","寂":"ji","计":"ji","记":"ji","既":"ji","忌":"ji","际":"ji","妓":"ji","继":"ji","纪":"ji","居":"ji","丌":"ji","乩":"ji","剞":"ji","佶":"ji","佴":"ji","脔":"ji","墼":"ji","芨":"ji","芰":"ji","萁":"ji","蒺":"ji","蕺":"ji","掎":"ji","叽":"ji","咭":"ji","哜":"ji","唧":"ji","岌":"ji","嵴":"ji",
"洎":"ji","彐":"ji","屐":"ji","骥":"ji","畿":"ji","玑":"ji","楫":"ji","殛":"ji","戟":"ji","戢":"ji","赍":"ji","觊":"ji","犄":"ji","齑":"ji","矶":"ji","羁":"ji","嵇":"ji","稷":"ji","瘠":"ji","瘵":"ji","虮":"ji","笈":"ji","笄":"ji","暨":"ji","跻":"ji","跽":"ji","霁":"ji","鲚":"ji","鲫":"ji","髻":"ji","麂":"ji","嘉":"jia","枷":"jia","夹":"jia","佳":"jia","家":"jia","加":"jia","荚":"jia","颊":"jia","贾":"jia","甲":"jia","钾":"jia","假":"jia","稼":"jia","价":"jia","架":"jia","驾":"jia","嫁":"jia","伽":"jia","郏":"jia","拮":"jia","岬":"jia","浃":"jia","迦":"jia","珈":"jia","戛":"jia","胛":"jia","恝":"jia","铗":"jia","镓":"jia","痂":"jia","蛱":"jia","笳":"jia","袈":"jia","跏":"jia","歼":"jian","监":"jian","坚":"jian","尖":"jian","笺":"jian","间":"jian","煎":"jian","兼":"jian","肩":"jian","艰":"jian","奸":"jian","缄":"jian","茧":"jian","检":"jian","柬":"jian","碱":"jian","硷":"jian","拣":"jian","捡":"jian","简":"jian","俭":"jian","剪":"jian","减":"jian","荐":"jian","槛":"jian","鉴":"jian","践":"jian","贱":"jian","见":"jian","键":"jian","箭":"jian","件":"jian","健":"jian","舰":"jian",
"剑":"jian","饯":"jian","渐":"jian","溅":"jian","涧":"jian","建":"jian","僭":"jian","谏":"jian","谫":"jian","菅":"jian","蒹":"jian","搛":"jian","囝":"jian","湔":"jian","蹇":"jian","謇":"jian","缣":"jian","枧":"jian","柙":"jian","楗":"jian","戋":"jian","戬":"jian","牮":"jian","犍":"jian","毽":"jian","腱":"jian","睑":"jian","锏":"jian","鹣":"jian","裥":"jian","笕":"jian","箴":"jian","翦":"jian","趼":"jian","踺":"jian","鲣":"jian","鞯":"jian","僵":"jiang","姜":"jiang","将":"jiang","浆":"jiang","江":"jiang","疆":"jiang","蒋":"jiang","桨":"jiang","奖":"jiang","讲":"jiang","匠":"jiang","酱":"jiang","降":"jiang","茳":"jiang","洚":"jiang","绛":"jiang","缰":"jiang","犟":"jiang","礓":"jiang","耩":"jiang","糨":"jiang","豇":"jiang","蕉":"jiao","椒":"jiao","礁":"jiao","焦":"jiao","胶":"jiao","交":"jiao","郊":"jiao","浇":"jiao","骄":"jiao","娇":"jiao","嚼":"jiao","搅":"jiao","铰":"jiao","矫":"jiao","侥":"jiao","脚":"jiao","狡":"jiao","角":"jiao","饺":"jiao","缴":"jiao","绞":"jiao","剿":"jiao","教":"jiao","酵":"jiao","轿":"jiao","较":"jiao","叫":"jiao","佼":"jiao","僬":"jiao",
"茭":"jiao","挢":"jiao","噍":"jiao","峤":"jiao","徼":"jiao","姣":"jiao","纟":"jiao","敫":"jiao","皎":"jiao","鹪":"jiao","蛟":"jiao","醮":"jiao","跤":"jiao","鲛":"jiao","窖":"jie","揭":"jie","接":"jie","皆":"jie","秸":"jie","街":"jie","阶":"jie","截":"jie","劫":"jie","节":"jie","桔":"jie","杰":"jie","捷":"jie","睫":"jie","竭":"jie","洁":"jie","结":"jie","解":"jie","姐":"jie","戒":"jie","藉":"jie","芥":"jie","界":"jie","借":"jie","介":"jie","疥":"jie","诫":"jie","届":"jie","偈":"jie","讦":"jie","诘":"jie","喈":"jie","嗟":"jie","獬":"jie","婕":"jie","孑":"jie","桀":"jie","獒":"jie","碣":"jie","锴":"jie","疖":"jie","袷":"jie","颉":"jie","蚧":"jie","羯":"jie","鲒":"jie","骱":"jie","髫":"jie","巾":"jin","筋":"jin","斤":"jin","金":"jin","今":"jin","津":"jin","襟":"jin","紧":"jin","锦":"jin","仅":"jin","谨":"jin","进":"jin","靳":"jin","晋":"jin","禁":"jin","近":"jin","烬":"jin","浸":"jin","尽":"jin","卺":"jin","荩":"jin","堇":"jin","噤":"jin","馑":"jin","廑":"jin","妗":"jin","缙":"jin","瑾":"jin","槿":"jin","赆":"jin","觐":"jin","钅":"jin","锓":"jin","衿":"jin","矜":"jin","劲":"jing",
"荆":"jing","兢":"jing","茎":"jing","睛":"jing","晶":"jing","鲸":"jing","京":"jing","惊":"jing","精":"jing","粳":"jing","经":"jing","井":"jing","警":"jing","景":"jing","颈":"jing","静":"jing","境":"jing","敬":"jing","镜":"jing","径":"jing","痉":"jing","靖":"jing","竟":"jing","竞":"jing","净":"jing","刭":"jing","儆":"jing","阱":"jing","菁":"jing","獍":"jing","憬":"jing","泾":"jing","迳":"jing","弪":"jing","婧":"jing","肼":"jing","胫":"jing","腈":"jing","旌":"jing","炯":"jiong","窘":"jiong","冂":"jiong","迥":"jiong","扃":"jiong","揪":"jiu","究":"jiu","纠":"jiu","玖":"jiu","韭":"jiu","久":"jiu","灸":"jiu","九":"jiu","酒":"jiu","厩":"jiu","救":"jiu","旧":"jiu","臼":"jiu","舅":"jiu","咎":"jiu","就":"jiu","疚":"jiu","僦":"jiu","啾":"jiu","阄":"jiu","柩":"jiu","桕":"jiu","鹫":"jiu","赳":"jiu","鬏":"jiu","鞠":"ju","拘":"ju","狙":"ju","疽":"ju","驹":"ju","菊":"ju","局":"ju","咀":"ju","矩":"ju","举":"ju","沮":"ju","聚":"ju","拒":"ju","据":"ju","巨":"ju","具":"ju","距":"ju","踞":"ju","锯":"ju","俱":"ju","句":"ju","惧":"ju","炬":"ju","剧":"ju","倨":"ju","讵":"ju","苣":"ju","苴":"ju","莒":"ju",
"掬":"ju","遽":"ju","屦":"ju","琚":"ju","枸":"ju","椐":"ju","榘":"ju","榉":"ju","橘":"ju","犋":"ju","飓":"ju","钜":"ju","锔":"ju","窭":"ju","裾":"ju","趄":"ju","醵":"ju","踽":"ju","龃":"ju","雎":"ju","鞫":"ju","捐":"juan","鹃":"juan","娟":"juan","倦":"juan","眷":"juan","卷":"juan","绢":"juan","鄄":"juan","狷":"juan","涓":"juan","桊":"juan","蠲":"juan","锩":"juan","镌":"juan","隽":"juan","撅":"jue","攫":"jue","抉":"jue","掘":"jue","倔":"jue","爵":"jue","觉":"jue","决":"jue","诀":"jue","绝":"jue","厥":"jue","劂":"jue","谲":"jue","矍":"jue","蕨":"jue","噘":"jue","崛":"jue","獗":"jue","孓":"jue","珏":"jue","桷":"jue","橛":"jue","爝":"jue","镢":"jue","蹶":"jue","觖":"jue","均":"jun","菌":"jun","钧":"jun","军":"jun","君":"jun","峻":"jun","俊":"jun","竣":"jun","浚":"jun","郡":"jun","骏":"jun","捃":"jun","狻":"jun","皲":"jun","筠":"jun","麇":"jun","喀":"ka","咖":"ka","卡":"ka","佧":"ka","咔":"ka","胩":"ka","咯":"ke","坷":"ke","苛":"ke","柯":"ke","棵":"ke","磕":"ke","颗":"ke","科":"ke","壳":"ke","咳":"ke","可":"ke","渴":"ke","克":"ke","刻":"ke","客":"ke","课":"ke","岢":"ke","恪":"ke","溘":"ke",
"骒":"ke","缂":"ke","珂":"ke","轲":"ke","氪":"ke","瞌":"ke","钶":"ke","疴":"ke","窠":"ke","蝌":"ke","髁":"ke","开":"kai","揩":"kai","楷":"kai","凯":"kai","慨":"kai","剀":"kai","垲":"kai","蒈":"kai","忾":"kai","恺":"kai","铠":"kai","锎":"kai","刊":"kan","堪":"kan","勘":"kan","坎":"kan","砍":"kan","看":"kan","侃":"kan","凵":"kan","莰":"kan","莶":"kan","戡":"kan","龛":"kan","瞰":"kan","康":"kang","慷":"kang","糠":"kang","扛":"kang","抗":"kang","亢":"kang","炕":"kang","坑":"kang","伉":"kang","闶":"kang","钪":"kang","考":"kao","拷":"kao","烤":"kao","靠":"kao","尻":"kao","栲":"kao","犒":"kao","铐":"kao","肯":"ken","啃":"ken","垦":"ken","恳":"ken","垠":"ken","裉":"ken","颀":"ken","吭":"keng","忐":"keng","铿":"keng","空":"kong","恐":"kong","孔":"kong","控":"kong","倥":"kong","崆":"kong","箜":"kong","抠":"kou","口":"kou","扣":"kou","寇":"kou","芤":"kou","蔻":"kou","叩":"kou","眍":"kou","筘":"kou","枯":"ku","哭":"ku","窟":"ku","苦":"ku","酷":"ku","库":"ku","裤":"ku","刳":"ku","堀":"ku","喾":"ku","绔":"ku","骷":"ku","夸":"kua","垮":"kua","挎":"kua","跨":"kua","胯":"kua","侉":"kua","块":"kuai",
"筷":"kuai","侩":"kuai","快":"kuai","蒯":"kuai","郐":"kuai","蒉":"kuai","狯":"kuai","脍":"kuai","宽":"kuan","款":"kuan","髋":"kuan","匡":"kuang","筐":"kuang","狂":"kuang","框":"kuang","矿":"kuang","眶":"kuang","旷":"kuang","况":"kuang","诓":"kuang","诳":"kuang","邝":"kuang","圹":"kuang","夼":"kuang","哐":"kuang","纩":"kuang","贶":"kuang","亏":"kui","盔":"kui","岿":"kui","窥":"kui","葵":"kui","奎":"kui","魁":"kui","傀":"kui","馈":"kui","愧":"kui","溃":"kui","馗":"kui","匮":"kui","夔":"kui","隗":"kui","揆":"kui","喹":"kui","喟":"kui","悝":"kui","愦":"kui","阕":"kui","逵":"kui","暌":"kui","睽":"kui","聩":"kui","蝰":"kui","篑":"kui","臾":"kui","跬":"kui","坤":"kun","昆":"kun","捆":"kun","困":"kun","悃":"kun","阃":"kun","琨":"kun","锟":"kun","醌":"kun","鲲":"kun","髡":"kun","括":"kuo","扩":"kuo","廓":"kuo","阔":"kuo","蛞":"kuo","垃":"la","拉":"la","喇":"la","蜡":"la","腊":"la","辣":"la","啦":"la","剌":"la","摺":"la","邋":"la","旯":"la","砬":"la","瘌":"la","莱":"lai","来":"lai","赖":"lai","崃":"lai","徕":"lai","涞":"lai","濑":"lai","赉":"lai","睐":"lai","铼":"lai","癞":"lai","籁":"lai",
"蓝":"lan","婪":"lan","栏":"lan","拦":"lan","篮":"lan","阑":"lan","兰":"lan","澜":"lan","谰":"lan","揽":"lan","览":"lan","懒":"lan","缆":"lan","烂":"lan","滥":"lan","啉":"lan","岚":"lan","懔":"lan","漤":"lan","榄":"lan","斓":"lan","罱":"lan","镧":"lan","褴":"lan","琅":"lang","榔":"lang","狼":"lang","廊":"lang","郎":"lang","朗":"lang","浪":"lang","莨":"lang","蒗":"lang","啷":"lang","阆":"lang","锒":"lang","稂":"lang","螂":"lang","捞":"lao","劳":"lao","牢":"lao","老":"lao","佬":"lao","姥":"lao","酪":"lao","烙":"lao","涝":"lao","唠":"lao","崂":"lao","栳":"lao","铑":"lao","铹":"lao","痨":"lao","醪":"lao","勒":"le","乐":"le","肋":"le","仂":"le","叻":"le","嘞":"le","泐":"le","鳓":"le","雷":"lei","镭":"lei","蕾":"lei","磊":"lei","累":"lei","儡":"lei","垒":"lei","擂":"lei","类":"lei","泪":"lei","羸":"lei","诔":"lei","荽":"lei","咧":"lei","漯":"lei","嫘":"lei","缧":"lei","檑":"lei","耒":"lei","酹":"lei","棱":"ling","冷":"ling","拎":"ling","玲":"ling","菱":"ling","零":"ling","龄":"ling","铃":"ling","伶":"ling","羚":"ling","凌":"ling","灵":"ling","陵":"ling","岭":"ling","领":"ling",
"另":"ling","令":"ling","酃":"ling","塄":"ling","苓":"ling","呤":"ling","囹":"ling","泠":"ling","绫":"ling","柃":"ling","棂":"ling","瓴":"ling","聆":"ling","蛉":"ling","翎":"ling","鲮":"ling","楞":"leng","愣":"leng","厘":"li","梨":"li","犁":"li","黎":"li","篱":"li","狸":"li","离":"li","漓":"li","理":"li","李":"li","里":"li","鲤":"li","礼":"li","莉":"li","荔":"li","吏":"li","栗":"li","丽":"li","厉":"li","励":"li","砾":"li","历":"li","利":"li","傈":"li","例":"li","俐":"li","痢":"li","立":"li","粒":"li","沥":"li","隶":"li","力":"li","璃":"li","哩":"li","俪":"li","俚":"li","郦":"li","坜":"li","苈":"li","莅":"li","蓠":"li","藜":"li","捩":"li","呖":"li","唳":"li","喱":"li","猁":"li","溧":"li","澧":"li","逦":"li","娌":"li","嫠":"li","骊":"li","缡":"li","珞":"li","枥":"li","栎":"li","轹":"li","戾":"li","砺":"li","詈":"li","罹":"li","锂":"li","鹂":"li","疠":"li","疬":"li","蛎":"li","蜊":"li","蠡":"li","笠":"li","篥":"li","粝":"li","醴":"li","跞":"li","雳":"li","鲡":"li","鳢":"li","黧":"li","俩":"lian","联":"lian","莲":"lian","连":"lian","镰":"lian","廉":"lian","怜":"lian","涟":"lian","帘":"lian",
"敛":"lian","脸":"lian","链":"lian","恋":"lian","炼":"lian","练":"lian","挛":"lian","蔹":"lian","奁":"lian","潋":"lian","濂":"lian","娈":"lian","琏":"lian","楝":"lian","殓":"lian","臁":"lian","膦":"lian","裢":"lian","蠊":"lian","鲢":"lian","粮":"liang","凉":"liang","梁":"liang","粱":"liang","良":"liang","两":"liang","辆":"liang","量":"liang","晾":"liang","亮":"liang","谅":"liang","墚":"liang","椋":"liang","踉":"liang","靓":"liang","魉":"liang","撩":"liao","聊":"liao","僚":"liao","疗":"liao","燎":"liao","寥":"liao","辽":"liao","潦":"liao","了":"liao","撂":"liao","镣":"liao","廖":"liao","料":"liao","蓼":"liao","尥":"liao","嘹":"liao","獠":"liao","寮":"liao","缭":"liao","钌":"liao","鹩":"liao","耢":"liao","列":"lie","裂":"lie","烈":"lie","劣":"lie","猎":"lie","冽":"lie","埒":"lie","洌":"lie","趔":"lie","躐":"lie","鬣":"lie","琳":"lin","林":"lin","磷":"lin","霖":"lin","临":"lin","邻":"lin","鳞":"lin","淋":"lin","凛":"lin","赁":"lin","吝":"lin","蔺":"lin","嶙":"lin","廪":"lin","遴":"lin","檩":"lin","辚":"lin","瞵":"lin","粼":"lin","躏":"lin","麟":"lin","溜":"liu","琉":"liu",
"榴":"liu","硫":"liu","馏":"liu","留":"liu","刘":"liu","瘤":"liu","流":"liu","柳":"liu","六":"liu","抡":"liu","偻":"liu","蒌":"liu","泖":"liu","浏":"liu","遛":"liu","骝":"liu","绺":"liu","旒":"liu","熘":"liu","锍":"liu","镏":"liu","鹨":"liu","鎏":"liu","龙":"long","聋":"long","咙":"long","笼":"long","窿":"long","隆":"long","垄":"long","拢":"long","陇":"long","弄":"long","垅":"long","茏":"long","泷":"long","珑":"long","栊":"long","胧":"long","砻":"long","癃":"long","楼":"lou","娄":"lou","搂":"lou","篓":"lou","漏":"lou","陋":"lou","喽":"lou","嵝":"lou","镂":"lou","瘘":"lou","耧":"lou","蝼":"lou","髅":"lou","芦":"lu","卢":"lu","颅":"lu","庐":"lu","炉":"lu","掳":"lu","卤":"lu","虏":"lu","鲁":"lu","麓":"lu","碌":"lu","露":"lu","路":"lu","赂":"lu","鹿":"lu","潞":"lu","禄":"lu","录":"lu","陆":"lu","戮":"lu","垆":"lu","摅":"lu","撸":"lu","噜":"lu","泸":"lu","渌":"lu","漉":"lu","璐":"lu","栌":"lu","橹":"lu","轳":"lu","辂":"lu","辘":"lu","氇":"lu","胪":"lu","镥":"lu","鸬":"lu","鹭":"lu","簏":"lu","舻":"lu","鲈":"lu","驴":"lv","吕":"lv","铝":"lv","侣":"lv","旅":"lv","履":"lv","屡":"lv","缕":"lv",
"虑":"lv","氯":"lv","律":"lv","率":"lv","滤":"lv","绿":"lv","捋":"lv","闾":"lv","榈":"lv","膂":"lv","稆":"lv","褛":"lv","峦":"luan","孪":"luan","滦":"luan","卵":"luan","乱":"luan","栾":"luan","鸾":"luan","銮":"luan","掠":"lue","略":"lue","锊":"lue","轮":"lun","伦":"lun","仑":"lun","沦":"lun","纶":"lun","论":"lun","囵":"lun","萝":"luo","螺":"luo","罗":"luo","逻":"luo","锣":"luo","箩":"luo","骡":"luo","裸":"luo","落":"luo","洛":"luo","骆":"luo","络":"luo","倮":"luo","荦":"luo","摞":"luo","猡":"luo","泺":"luo","椤":"luo","脶":"luo","镙":"luo","瘰":"luo","雒":"luo","妈":"ma","麻":"ma","玛":"ma","码":"ma","蚂":"ma","马":"ma","骂":"ma","嘛":"ma","吗":"ma","唛":"ma","犸":"ma","嬷":"ma","杩":"ma","麽":"ma","埋":"mai","买":"mai","麦":"mai","卖":"mai","迈":"mai","脉":"mai","劢":"mai","荬":"mai","咪":"mai","霾":"mai","瞒":"man","馒":"man","蛮":"man","满":"man","蔓":"man","曼":"man","慢":"man","漫":"man","谩":"man","墁":"man","幔":"man","缦":"man","熳":"man","镘":"man","颟":"man","螨":"man","鳗":"man","鞔":"man","芒":"mang","茫":"mang","盲":"mang","忙":"mang","莽":"mang","邙":"mang","漭":"mang",
"朦":"mang","硭":"mang","蟒":"mang","氓":"meng","萌":"meng","蒙":"meng","檬":"meng","盟":"meng","锰":"meng","猛":"meng","梦":"meng","孟":"meng","勐":"meng","甍":"meng","瞢":"meng","懵":"meng","礞":"meng","虻":"meng","蜢":"meng","蠓":"meng","艋":"meng","艨":"meng","黾":"meng","猫":"miao","苗":"miao","描":"miao","瞄":"miao","藐":"miao","秒":"miao","渺":"miao","庙":"miao","妙":"miao","喵":"miao","邈":"miao","缈":"miao","缪":"miao","杪":"miao","淼":"miao","眇":"miao","鹋":"miao","蜱":"miao","茅":"mao","锚":"mao","毛":"mao","矛":"mao","铆":"mao","卯":"mao","茂":"mao","冒":"mao","帽":"mao","貌":"mao","贸":"mao","侔":"mao","袤":"mao","勖":"mao","茆":"mao","峁":"mao","瑁":"mao","昴":"mao","牦":"mao","耄":"mao","旄":"mao","懋":"mao","瞀":"mao","蛑":"mao","蝥":"mao","蟊":"mao","髦":"mao","么":"me","玫":"mei","枚":"mei","梅":"mei","酶":"mei","霉":"mei","煤":"mei","没":"mei","眉":"mei","媒":"mei","镁":"mei","每":"mei","美":"mei","昧":"mei","寐":"mei","妹":"mei","媚":"mei","坶":"mei","莓":"mei","嵋":"mei","猸":"mei","浼":"mei","湄":"mei","楣":"mei","镅":"mei","鹛":"mei","袂":"mei","魅":"mei",
"门":"men","闷":"men","们":"men","扪":"men","玟":"men","焖":"men","懑":"men","钔":"men","眯":"mi","醚":"mi","靡":"mi","糜":"mi","迷":"mi","谜":"mi","弥":"mi","米":"mi","秘":"mi","觅":"mi","泌":"mi","蜜":"mi","密":"mi","幂":"mi","芈":"mi","冖":"mi","谧":"mi","蘼":"mi","嘧":"mi","猕":"mi","獯":"mi","汨":"mi","宓":"mi","弭":"mi","脒":"mi","敉":"mi","糸":"mi","縻":"mi","麋":"mi","棉":"mian","眠":"mian","绵":"mian","冕":"mian","免":"mian","勉":"mian","娩":"mian","缅":"mian","面":"mian","沔":"mian","湎":"mian","腼":"mian","眄":"mian","蔑":"mie","灭":"mie","咩":"mie","蠛":"mie","篾":"mie","民":"min","抿":"min","皿":"min","敏":"min","悯":"min","闽":"min","苠":"min","岷":"min","闵":"min","泯":"min","珉":"min","明":"ming","螟":"ming","鸣":"ming","铭":"ming","名":"ming","命":"ming","冥":"ming","茗":"ming","溟":"ming","暝":"ming","瞑":"ming","酩":"ming","谬":"miu","摸":"mo","摹":"mo","蘑":"mo","模":"mo","膜":"mo","磨":"mo","摩":"mo","魔":"mo","抹":"mo","末":"mo","莫":"mo","墨":"mo","默":"mo","沫":"mo","漠":"mo","寞":"mo","陌":"mo","谟":"mo","茉":"mo","蓦":"mo","馍":"mo","嫫":"mo","镆":"mo",
"秣":"mo","瘼":"mo","耱":"mo","蟆":"mo","貊":"mo","貘":"mo","谋":"mou","牟":"mou","某":"mou","厶":"mou","哞":"mou","婺":"mou","眸":"mou","鍪":"mou","拇":"mu","牡":"mu","亩":"mu","姆":"mu","母":"mu","墓":"mu","暮":"mu","幕":"mu","募":"mu","慕":"mu","木":"mu","目":"mu","睦":"mu","牧":"mu","穆":"mu","仫":"mu","苜":"mu","呒":"mu","沐":"mu","毪":"mu","钼":"mu","拿":"na","哪":"na","呐":"na","钠":"na","那":"na","娜":"na","纳":"na","内":"na","捺":"na","肭":"na","镎":"na","衲":"na","箬":"na","氖":"nai","乃":"nai","奶":"nai","耐":"nai","奈":"nai","鼐":"nai","艿":"nai","萘":"nai","柰":"nai","南":"nan","男":"nan","难":"nan","囊":"nan","喃":"nan","囡":"nan","楠":"nan","腩":"nan","蝻":"nan","赧":"nan","挠":"nao","脑":"nao","恼":"nao","闹":"nao","孬":"nao","垴":"nao","猱":"nao","瑙":"nao","硇":"nao","铙":"nao","蛲":"nao","淖":"ne","呢":"ne","讷":"ne","馁":"nei","嫩":"nen","能":"nen","枘":"nen","恁":"nen","妮":"ni","霓":"ni","倪":"ni","泥":"ni","尼":"ni","拟":"ni","你":"ni","匿":"ni","腻":"ni","逆":"ni","溺":"ni","伲":"ni","坭":"ni","猊":"ni","怩":"ni","滠":"ni","昵":"ni","旎":"ni","祢":"ni","慝":"ni",
"睨":"ni","铌":"ni","鲵":"ni","蔫":"nian","拈":"nian","年":"nian","碾":"nian","撵":"nian","捻":"nian","念":"nian","廿":"nian","辇":"nian","黏":"nian","鲇":"nian","鲶":"nian","娘":"niang","酿":"niang","鸟":"niao","尿":"niao","茑":"niao","嬲":"niao","脲":"niao","袅":"niao","捏":"nie","聂":"nie","孽":"nie","啮":"nie","镊":"nie","镍":"nie","涅":"nie","乜":"nie","陧":"nie","蘖":"nie","嗫":"nie","肀":"nie","颞":"nie","臬":"nie","蹑":"nie","您":"nin","柠":"nin","狞":"ning","凝":"ning","宁":"ning","拧":"ning","泞":"ning","佞":"ning","蓥":"ning","咛":"ning","甯":"ning","聍":"ning","牛":"niu","扭":"niu","钮":"niu","纽":"niu","狃":"niu","忸":"niu","妞":"niu","蚴":"niu","脓":"nong","浓":"nong","农":"nong","侬":"nong","奴":"nu","努":"nu","怒":"nu","呶":"nu","帑":"nu","弩":"nu","胬":"nu","孥":"nu","驽":"nu","女":"nv","恧":"nv","钕":"nv","衄":"nv","暖":"nuan","虐":"nuenue","疟":"nue","谑":"nue","挪":"nuo","懦":"nuo","糯":"nuo","诺":"nuo","傩":"nuo","搦":"nuo","喏":"nuo","锘":"nuo","哦":"ou","欧":"ou","鸥":"ou","殴":"ou","藕":"ou","呕":"ou","偶":"ou","沤":"ou","怄":"ou","瓯":"ou","耦":"ou",
"啪":"pa","趴":"pa","爬":"pa","帕":"pa","怕":"pa","琶":"pa","葩":"pa","筢":"pa","拍":"pai","排":"pai","牌":"pai","徘":"pai","湃":"pai","派":"pai","俳":"pai","蒎":"pai","攀":"pan","潘":"pan","盘":"pan","磐":"pan","盼":"pan","畔":"pan","判":"pan","叛":"pan","爿":"pan","泮":"pan","袢":"pan","襻":"pan","蟠":"pan","蹒":"pan","乓":"pang","庞":"pang","旁":"pang","耪":"pang","胖":"pang","滂":"pang","逄":"pang","抛":"pao","咆":"pao","刨":"pao","炮":"pao","袍":"pao","跑":"pao","泡":"pao","匏":"pao","狍":"pao","庖":"pao","脬":"pao","疱":"pao","呸":"pei","胚":"pei","培":"pei","裴":"pei","赔":"pei","陪":"pei","配":"pei","佩":"pei","沛":"pei","掊":"pei","辔":"pei","帔":"pei","淠":"pei","旆":"pei","锫":"pei","醅":"pei","霈":"pei","喷":"pen","盆":"pen","湓":"pen","砰":"peng","抨":"peng","烹":"peng","澎":"peng","彭":"peng","蓬":"peng","棚":"peng","硼":"peng","篷":"peng","膨":"peng","朋":"peng","鹏":"peng","捧":"peng","碰":"peng","坯":"peng","堋":"peng","嘭":"peng","怦":"peng","蟛":"peng","砒":"pi","霹":"pi","批":"pi","披":"pi","劈":"pi","琵":"pi","毗":"pi","啤":"pi","脾":"pi","疲":"pi","皮":"pi",
"匹":"pi","痞":"pi","僻":"pi","屁":"pi","譬":"pi","丕":"pi","陴":"pi","邳":"pi","郫":"pi","圮":"pi","鼙":"pi","擗":"pi","噼":"pi","庀":"pi","媲":"pi","纰":"pi","枇":"pi","甓":"pi","睥":"pi","罴":"pi","铍":"pi","痦":"pi","癖":"pi","疋":"pi","蚍":"pi","貔":"pi","篇":"pian","偏":"pian","片":"pian","骗":"pian","谝":"pian","骈":"pian","犏":"pian","胼":"pian","褊":"pian","翩":"pian","蹁":"pian","飘":"piao","漂":"piao","瓢":"piao","票":"piao","剽":"piao","嘌":"piao","嫖":"piao","缥":"piao","殍":"piao","瞟":"piao","螵":"piao","撇":"pie","瞥":"pie","丿":"pie","苤":"pie","氕":"pie","拼":"pin","频":"pin","贫":"pin","品":"pin","聘":"pin","拚":"pin","姘":"pin","嫔":"pin","榀":"pin","牝":"pin","颦":"pin","乒":"ping","坪":"ping","苹":"ping","萍":"ping","平":"ping","凭":"ping","瓶":"ping","评":"ping","屏":"ping","俜":"ping","娉":"ping","枰":"ping","鲆":"ping","坡":"po","泼":"po","颇":"po","婆":"po","破":"po","魄":"po","迫":"po","粕":"po","叵":"po","鄱":"po","溥":"po","珀":"po","钋":"po","钷":"po","皤":"po","笸":"po","剖":"pou","裒":"pou","踣":"pou","扑":"pu","铺":"pu","仆":"pu","莆":"pu","葡":"pu",
"菩":"pu","蒲":"pu","埔":"pu","朴":"pu","圃":"pu","普":"pu","浦":"pu","谱":"pu","曝":"pu","瀑":"pu","匍":"pu","噗":"pu","濮":"pu","璞":"pu","氆":"pu","镤":"pu","镨":"pu","蹼":"pu","期":"qi","欺":"qi","栖":"qi","戚":"qi","妻":"qi","七":"qi","凄":"qi","漆":"qi","柒":"qi","沏":"qi","其":"qi","棋":"qi","奇":"qi","歧":"qi","畦":"qi","崎":"qi","脐":"qi","齐":"qi","旗":"qi","祈":"qi","祁":"qi","骑":"qi","起":"qi","岂":"qi","乞":"qi","企":"qi","启":"qi","契":"qi","砌":"qi","器":"qi","气":"qi","迄":"qi","弃":"qi","汽":"qi","泣":"qi","讫":"qi","亟":"qi","亓":"qi","圻":"qi","芑":"qi","萋":"qi","葺":"qi","嘁":"qi","屺":"qi","岐":"qi","汔":"qi","淇":"qi","骐":"qi","绮":"qi","琪":"qi","琦":"qi","杞":"qi","桤":"qi","槭":"qi","欹":"qi","祺":"qi","憩":"qi","碛":"qi","蛴":"qi","蜞":"qi","綦":"qi","綮":"qi","趿":"qi","蹊":"qi","鳍":"qi","麒":"qi","掐":"qia","恰":"qia","洽":"qia","葜":"qia","牵":"qian","扦":"qian","钎":"qian","铅":"qian","千":"qian","迁":"qian","签":"qian","仟":"qian","谦":"qian","乾":"qian","黔":"qian","钱":"qian","钳":"qian","前":"qian","潜":"qian","遣":"qian","浅":"qian","谴":"qian",
"堑":"qian","嵌":"qian","欠":"qian","歉":"qian","佥":"qian","阡":"qian","芊":"qian","芡":"qian","荨":"qian","掮":"qian","岍":"qian","悭":"qian","慊":"qian","骞":"qian","搴":"qian","褰":"qian","缱":"qian","椠":"qian","肷":"qian","愆":"qian","钤":"qian","虔":"qian","箝":"qian","枪":"qiang","呛":"qiang","腔":"qiang","羌":"qiang","墙":"qiang","蔷":"qiang","强":"qiang","抢":"qiang","嫱":"qiang","樯":"qiang","戗":"qiang","炝":"qiang","锖":"qiang","锵":"qiang","镪":"qiang","襁":"qiang","蜣":"qiang","羟":"qiang","跫":"qiang","跄":"qiang","橇":"qiao","锹":"qiao","敲":"qiao","悄":"qiao","桥":"qiao","瞧":"qiao","乔":"qiao","侨":"qiao","巧":"qiao","鞘":"qiao","撬":"qiao","翘":"qiao","峭":"qiao","俏":"qiao","窍":"qiao","劁":"qiao","诮":"qiao","谯":"qiao","荞":"qiao","愀":"qiao","憔":"qiao","缲":"qiao","樵":"qiao","毳":"qiao","硗":"qiao","跷":"qiao","鞒":"qiao","切":"qie","茄":"qie","且":"qie","怯":"qie","窃":"qie","郄":"qie","唼":"qie","惬":"qie","妾":"qie","挈":"qie","锲":"qie","箧":"qie","钦":"qin","侵":"qin","亲":"qin","秦":"qin","琴":"qin","勤":"qin","芹":"qin","擒":"qin","禽":"qin",
"寝":"qin","沁":"qin","芩":"qin","蓁":"qin","蕲":"qin","揿":"qin","吣":"qin","嗪":"qin","噙":"qin","溱":"qin","檎":"qin","螓":"qin","衾":"qin","青":"qing","轻":"qing","氢":"qing","倾":"qing","卿":"qing","清":"qing","擎":"qing","晴":"qing","氰":"qing","情":"qing","顷":"qing","请":"qing","庆":"qing","倩":"qing","苘":"qing","圊":"qing","檠":"qing","磬":"qing","蜻":"qing","罄":"qing","箐":"qing","謦":"qing","鲭":"qing","黥":"qing","琼":"qiong","穷":"qiong","邛":"qiong","茕":"qiong","穹":"qiong","筇":"qiong","銎":"qiong","秋":"qiu","丘":"qiu","邱":"qiu","球":"qiu","求":"qiu","囚":"qiu","酋":"qiu","泅":"qiu","俅":"qiu","氽":"qiu","巯":"qiu","艽":"qiu","犰":"qiu","湫":"qiu","逑":"qiu","遒":"qiu","楸":"qiu","赇":"qiu","鸠":"qiu","虬":"qiu","蚯":"qiu","蝤":"qiu","裘":"qiu","糗":"qiu","鳅":"qiu","鼽":"qiu","趋":"qu","区":"qu","蛆":"qu","曲":"qu","躯":"qu","屈":"qu","驱":"qu","渠":"qu","取":"qu","娶":"qu","龋":"qu","趣":"qu","去":"qu","诎":"qu","劬":"qu","蕖":"qu","蘧":"qu","岖":"qu","衢":"qu","阒":"qu","璩":"qu","觑":"qu","氍":"qu","祛":"qu","磲":"qu","癯":"qu","蛐":"qu","蠼":"qu","麴":"qu",
"瞿":"qu","黢":"qu","圈":"quan","颧":"quan","权":"quan","醛":"quan","泉":"quan","全":"quan","痊":"quan","拳":"quan","犬":"quan","券":"quan","劝":"quan","诠":"quan","荃":"quan","獾":"quan","悛":"quan","绻":"quan","辁":"quan","畎":"quan","铨":"quan","蜷":"quan","筌":"quan","鬈":"quan","缺":"que","炔":"que","瘸":"que","却":"que","鹊":"que","榷":"que","确":"que","雀":"que","阙":"que","悫":"que","裙":"qun","群":"qun","逡":"qun","然":"ran","燃":"ran","冉":"ran","染":"ran","苒":"ran","髯":"ran","瓤":"rang","壤":"rang","攘":"rang","嚷":"rang","让":"rang","禳":"rang","穰":"rang","饶":"rao","扰":"rao","绕":"rao","荛":"rao","娆":"rao","桡":"rao","惹":"ruo","若":"ruo","弱":"ruo","热":"re","偌":"re","壬":"ren","仁":"ren","人":"ren","忍":"ren","韧":"ren","任":"ren","认":"ren","刃":"ren","妊":"ren","纫":"ren","仞":"ren","荏":"ren","葚":"ren","饪":"ren","轫":"ren","稔":"ren","衽":"ren","扔":"reng","仍":"reng","日":"ri","戎":"rong","茸":"rong","蓉":"rong","荣":"rong","融":"rong","熔":"rong","溶":"rong","容":"rong","绒":"rong","冗":"rong","嵘":"rong","狨":"rong","缛":"rong","榕":"rong",
"蝾":"rong","揉":"rou","柔":"rou","肉":"rou","糅":"rou","蹂":"rou","鞣":"rou","茹":"ru","蠕":"ru","儒":"ru","孺":"ru","如":"ru","辱":"ru","乳":"ru","汝":"ru","入":"ru","褥":"ru","蓐":"ru","薷":"ru","嚅":"ru","洳":"ru","溽":"ru","濡":"ru","铷":"ru","襦":"ru","颥":"ru","软":"ruan","阮":"ruan","朊":"ruan","蕊":"rui","瑞":"rui","锐":"rui","芮":"rui","蕤":"rui","睿":"rui","蚋":"rui","闰":"run","润":"run","撒":"sa","洒":"sa","萨":"sa","卅":"sa","仨":"sa","挲":"sa","飒":"sa","腮":"sai","鳃":"sai","塞":"sai","赛":"sai","噻":"sai","三":"san","叁":"san","伞":"san","散":"san","彡":"san","馓":"san","氵":"san","毵":"san","糁":"san","霰":"san","桑":"sang","嗓":"sang","丧":"sang","搡":"sang","磉":"sang","颡":"sang","搔":"sao","骚":"sao","扫":"sao","嫂":"sao","埽":"sao","臊":"sao","瘙":"sao","鳋":"sao","瑟":"se","色":"se","涩":"se","啬":"se","铩":"se","铯":"se","穑":"se","森":"sen","僧":"seng","莎":"sha","砂":"sha","杀":"sha","刹":"sha","沙":"sha","纱":"sha","傻":"sha","啥":"sha","煞":"sha","脎":"sha","歃":"sha","痧":"sha","裟":"sha","霎":"sha","鲨":"sha","筛":"shai","晒":"shai","酾":"shai",
"珊":"shan","苫":"shan","杉":"shan","山":"shan","删":"shan","煽":"shan","衫":"shan","闪":"shan","陕":"shan","擅":"shan","赡":"shan","膳":"shan","善":"shan","汕":"shan","扇":"shan","缮":"shan","剡":"shan","讪":"shan","鄯":"shan","埏":"shan","芟":"shan","潸":"shan","姗":"shan","骟":"shan","膻":"shan","钐":"shan","疝":"shan","蟮":"shan","舢":"shan","跚":"shan","鳝":"shan","墒":"shang","伤":"shang","商":"shang","赏":"shang","晌":"shang","上":"shang","尚":"shang","裳":"shang","垧":"shang","绱":"shang","殇":"shang","熵":"shang","觞":"shang","梢":"shao","捎":"shao","稍":"shao","烧":"shao","芍":"shao","勺":"shao","韶":"shao","少":"shao","哨":"shao","邵":"shao","绍":"shao","劭":"shao","苕":"shao","潲":"shao","蛸":"shao","笤":"shao","筲":"shao","艄":"shao","奢":"she","赊":"she","蛇":"she","舌":"she","舍":"she","赦":"she","摄":"she","射":"she","慑":"she","涉":"she","社":"she","设":"she","厍":"she","佘":"she","猞":"she","畲":"she","麝":"she","砷":"shen","申":"shen","呻":"shen","伸":"shen","身":"shen","深":"shen","娠":"shen","绅":"shen","神":"shen","沈":"shen","审":"shen","婶":"shen",
"甚":"shen","肾":"shen","慎":"shen","渗":"shen","诜":"shen","谂":"shen","吲":"shen","哂":"shen","渖":"shen","椹":"shen","矧":"shen","蜃":"shen","声":"sheng","生":"sheng","甥":"sheng","牲":"sheng","升":"sheng","绳":"sheng","省":"sheng","盛":"sheng","剩":"sheng","胜":"sheng","圣":"sheng","丞":"sheng","渑":"sheng","媵":"sheng","眚":"sheng","笙":"sheng","师":"shi","失":"shi","狮":"shi","施":"shi","湿":"shi","诗":"shi","尸":"shi","虱":"shi","十":"shi","石":"shi","拾":"shi","时":"shi","什":"shi","食":"shi","蚀":"shi","实":"shi","识":"shi","史":"shi","矢":"shi","使":"shi","屎":"shi","驶":"shi","始":"shi","式":"shi","示":"shi","士":"shi","世":"shi","柿":"shi","事":"shi","拭":"shi","誓":"shi","逝":"shi","势":"shi","是":"shi","嗜":"shi","噬":"shi","适":"shi","仕":"shi","侍":"shi","释":"shi","饰":"shi","氏":"shi","市":"shi","恃":"shi","室":"shi","视":"shi","试":"shi","谥":"shi","埘":"shi","莳":"shi","蓍":"shi","弑":"shi","唑":"shi","饣":"shi","轼":"shi","耆":"shi","贳":"shi","炻":"shi","礻":"shi","铈":"shi","铊":"shi","螫":"shi","舐":"shi","筮":"shi","豕":"shi","鲥":"shi","鲺":"shi",
"收":"shou","手":"shou","首":"shou","守":"shou","寿":"shou","授":"shou","售":"shou","受":"shou","瘦":"shou","兽":"shou","扌":"shou","狩":"shou","绶":"shou","艏":"shou","蔬":"shu","枢":"shu","梳":"shu","殊":"shu","抒":"shu","输":"shu","叔":"shu","舒":"shu","淑":"shu","疏":"shu","书":"shu","赎":"shu","孰":"shu","熟":"shu","薯":"shu","暑":"shu","曙":"shu","署":"shu","蜀":"shu","黍":"shu","鼠":"shu","属":"shu","术":"shu","述":"shu","树":"shu","束":"shu","戍":"shu","竖":"shu","墅":"shu","庶":"shu","数":"shu","漱":"shu","恕":"shu","倏":"shu","塾":"shu","菽":"shu","忄":"shu","沭":"shu","涑":"shu","澍":"shu","姝":"shu","纾":"shu","毹":"shu","腧":"shu","殳":"shu","镯":"shu","秫":"shu","鹬":"shu","刷":"shua","耍":"shua","唰":"shua","涮":"shua","摔":"shuai","衰":"shuai","甩":"shuai","帅":"shuai","蟀":"shuai","栓":"shuan","拴":"shuan","闩":"shuan","霜":"shuang","双":"shuang","爽":"shuang","孀":"shuang","谁":"shui","水":"shui","睡":"shui","税":"shui","吮":"shun","瞬":"shun","顺":"shun","舜":"shun","恂":"shun","说":"shuo","硕":"shuo","朔":"shuo","烁":"shuo","蒴":"shuo","搠":"shuo",
"嗍":"shuo","濯":"shuo","妁":"shuo","槊":"shuo","铄":"shuo","斯":"si","撕":"si","嘶":"si","思":"si","私":"si","司":"si","丝":"si","死":"si","肆":"si","寺":"si","嗣":"si","四":"si","伺":"si","似":"si","饲":"si","巳":"si","厮":"si","俟":"si","兕":"si","菥":"si","咝":"si","汜":"si","泗":"si","澌":"si","姒":"si","驷":"si","缌":"si","祀":"si","祠":"si","锶":"si","鸶":"si","耜":"si","蛳":"si","笥":"si","松":"song","耸":"song","怂":"song","颂":"song","送":"song","宋":"song","讼":"song","诵":"song","凇":"song","菘":"song","崧":"song","嵩":"song","忪":"song","悚":"song","淞":"song","竦":"song","搜":"sou","艘":"sou","擞":"sou","嗽":"sou","叟":"sou","嗖":"sou","嗾":"sou","馊":"sou","溲":"sou","飕":"sou","瞍":"sou","锼":"sou","螋":"sou","苏":"su","酥":"su","俗":"su","素":"su","速":"su","粟":"su","僳":"su","塑":"su","溯":"su","宿":"su","诉":"su","肃":"su","夙":"su","谡":"su","蔌":"su","嗉":"su","愫":"su","簌":"su","觫":"su","稣":"su","酸":"suan","蒜":"suan","算":"suan","虽":"sui","隋":"sui","随":"sui","绥":"sui","髓":"sui","碎":"sui","岁":"sui","穗":"sui","遂":"sui","隧":"sui","祟":"sui","蓑":"sui",
"冫":"sui","谇":"sui","濉":"sui","邃":"sui","燧":"sui","眭":"sui","睢":"sui","孙":"sun","损":"sun","笋":"sun","荪":"sun","狲":"sun","飧":"sun","榫":"sun","跣":"sun","隼":"sun","梭":"suo","唆":"suo","缩":"suo","琐":"suo","索":"suo","锁":"suo","所":"suo","唢":"suo","嗦":"suo","娑":"suo","桫":"suo","睃":"suo","羧":"suo","塌":"ta","他":"ta","它":"ta","她":"ta","塔":"ta","獭":"ta","挞":"ta","蹋":"ta","踏":"ta","闼":"ta","溻":"ta","遢":"ta","榻":"ta","沓":"ta","胎":"tai","苔":"tai","抬":"tai","台":"tai","泰":"tai","酞":"tai","太":"tai","态":"tai","汰":"tai","邰":"tai","薹":"tai","肽":"tai","炱":"tai","钛":"tai","跆":"tai","鲐":"tai","坍":"tan","摊":"tan","贪":"tan","瘫":"tan","滩":"tan","坛":"tan","檀":"tan","痰":"tan","潭":"tan","谭":"tan","谈":"tan","坦":"tan","毯":"tan","袒":"tan","碳":"tan","探":"tan","叹":"tan","炭":"tan","郯":"tan","蕈":"tan","昙":"tan","钽":"tan","锬":"tan","覃":"tan","汤":"tang","塘":"tang","搪":"tang","堂":"tang","棠":"tang","膛":"tang","唐":"tang","糖":"tang","傥":"tang","饧":"tang","溏":"tang","瑭":"tang","铴":"tang","镗":"tang","耥":"tang","螗":"tang",
"螳":"tang","羰":"tang","醣":"tang","倘":"thang","躺":"thang","淌":"thang","趟":"theng","烫":"theng","掏":"tao","涛":"tao","滔":"tao","绦":"tao","萄":"tao","桃":"tao","逃":"tao","淘":"tao","陶":"tao","讨":"tao","套":"tao","挑":"tao","鼗":"tao","啕":"tao","韬":"tao","饕":"tao","特":"te","藤":"teng","腾":"teng","疼":"teng","誊":"teng","滕":"teng","梯":"ti","剔":"ti","踢":"ti","锑":"ti","提":"ti","题":"ti","蹄":"ti","啼":"ti","体":"ti","替":"ti","嚏":"ti","惕":"ti","涕":"ti","剃":"ti","屉":"ti","荑":"ti","悌":"ti","逖":"ti","绨":"ti","缇":"ti","鹈":"ti","裼":"ti","醍":"ti","天":"tian","添":"tian","填":"tian","田":"tian","甜":"tian","恬":"tian","舔":"tian","腆":"tian","掭":"tian","忝":"tian","阗":"tian","殄":"tian","畋":"tian","钿":"tian","蚺":"tian","条":"tiao","迢":"tiao","眺":"tiao","跳":"tiao","佻":"tiao","祧":"tiao","铫":"tiao","窕":"tiao","龆":"tiao","鲦":"tiao","贴":"tie","铁":"tie","帖":"tie","萜":"tie","餮":"tie","厅":"ting","听":"ting","烃":"ting","汀":"ting","廷":"ting","停":"ting","亭":"ting","庭":"ting","挺":"ting","艇":"ting","莛":"ting","葶":"ting","婷":"ting",
"梃":"ting","蜓":"ting","霆":"ting","通":"tong","桐":"tong","酮":"tong","瞳":"tong","同":"tong","铜":"tong","彤":"tong","童":"tong","桶":"tong","捅":"tong","筒":"tong","统":"tong","痛":"tong","佟":"tong","僮":"tong","仝":"tong","茼":"tong","嗵":"tong","恸":"tong","潼":"tong","砼":"tong","偷":"tou","投":"tou","头":"tou","透":"tou","亠":"tou","凸":"tu","秃":"tu","突":"tu","图":"tu","徒":"tu","途":"tu","涂":"tu","屠":"tu","土":"tu","吐":"tu","兔":"tu","堍":"tu","荼":"tu","菟":"tu","钍":"tu","酴":"tu","湍":"tuan","团":"tuan","疃":"tuan","推":"tui","颓":"tui","腿":"tui","蜕":"tui","褪":"tui","退":"tui","忒":"tui","煺":"tui","吞":"tun","屯":"tun","臀":"tun","饨":"tun","暾":"tun","豚":"tun","窀":"tun","拖":"tuo","托":"tuo","脱":"tuo","鸵":"tuo","陀":"tuo","驮":"tuo","驼":"tuo","椭":"tuo","妥":"tuo","拓":"tuo","唾":"tuo","乇":"tuo","佗":"tuo","坨":"tuo","庹":"tuo","沱":"tuo","柝":"tuo","砣":"tuo","箨":"tuo","舄":"tuo","跎":"tuo","鼍":"tuo","挖":"wa","哇":"wa","蛙":"wa","洼":"wa","娃":"wa","瓦":"wa","袜":"wa","佤":"wa","娲":"wa","腽":"wa","歪":"wai","外":"wai","豌":"wan","弯":"wan",
"湾":"wan","玩":"wan","顽":"wan","丸":"wan","烷":"wan","完":"wan","碗":"wan","挽":"wan","晚":"wan","皖":"wan","惋":"wan","宛":"wan","婉":"wan","万":"wan","腕":"wan","剜":"wan","芄":"wan","苋":"wan","菀":"wan","纨":"wan","绾":"wan","琬":"wan","脘":"wan","畹":"wan","蜿":"wan","箢":"wan","汪":"wang","王":"wang","亡":"wang","枉":"wang","网":"wang","往":"wang","旺":"wang","望":"wang","忘":"wang","妄":"wang","罔":"wang","尢":"wang","惘":"wang","辋":"wang","魍":"wang","威":"wei","巍":"wei","微":"wei","危":"wei","韦":"wei","违":"wei","桅":"wei","围":"wei","唯":"wei","惟":"wei","为":"wei","潍":"wei","维":"wei","苇":"wei","萎":"wei","委":"wei","伟":"wei","伪":"wei","尾":"wei","纬":"wei","未":"wei","蔚":"wei","味":"wei","畏":"wei","胃":"wei","喂":"wei","魏":"wei","位":"wei","渭":"wei","谓":"wei","尉":"wei","慰":"wei","卫":"wei","倭":"wei","偎":"wei","诿":"wei","隈":"wei","葳":"wei","薇":"wei","帏":"wei","帷":"wei","崴":"wei","嵬":"wei","猥":"wei","猬":"wei","闱":"wei","沩":"wei","洧":"wei","涠":"wei","逶":"wei","娓":"wei","玮":"wei","韪":"wei","軎":"wei","炜":"wei","煨":"wei","熨":"wei",
"痿":"wei","艉":"wei","鲔":"wei","瘟":"wen","温":"wen","蚊":"wen","文":"wen","闻":"wen","纹":"wen","吻":"wen","稳":"wen","紊":"wen","问":"wen","刎":"wen","愠":"wen","阌":"wen","汶":"wen","璺":"wen","韫":"wen","殁":"wen","雯":"wen","嗡":"weng","翁":"weng","瓮":"weng","蓊":"weng","蕹":"weng","挝":"wo","蜗":"wo","涡":"wo","窝":"wo","我":"wo","斡":"wo","卧":"wo","握":"wo","沃":"wo","莴":"wo","幄":"wo","渥":"wo","杌":"wo","肟":"wo","龌":"wo","巫":"wu","呜":"wu","钨":"wu","乌":"wu","污":"wu","诬":"wu","屋":"wu","无":"wu","芜":"wu","梧":"wu","吾":"wu","吴":"wu","毋":"wu","武":"wu","五":"wu","捂":"wu","午":"wu","舞":"wu","伍":"wu","侮":"wu","坞":"wu","戊":"wu","雾":"wu","晤":"wu","物":"wu","勿":"wu","务":"wu","悟":"wu","误":"wu","兀":"wu","仵":"wu","阢":"wu","邬":"wu","圬":"wu","芴":"wu","庑":"wu","怃":"wu","忤":"wu","浯":"wu","寤":"wu","迕":"wu","妩":"wu","骛":"wu","牾":"wu","焐":"wu","鹉":"wu","鹜":"wu","蜈":"wu","鋈":"wu","鼯":"wu","昔":"xi","熙":"xi","析":"xi","西":"xi","硒":"xi","矽":"xi","晰":"xi","嘻":"xi","吸":"xi","锡":"xi","牺":"xi","稀":"xi","息":"xi","希":"xi","悉":"xi","膝":"xi",
"夕":"xi","惜":"xi","熄":"xi","烯":"xi","溪":"xi","汐":"xi","犀":"xi","檄":"xi","袭":"xi","席":"xi","习":"xi","媳":"xi","喜":"xi","铣":"xi","洗":"xi","系":"xi","隙":"xi","戏":"xi","细":"xi","僖":"xi","兮":"xi","隰":"xi","郗":"xi","茜":"xi","葸":"xi","蓰":"xi","奚":"xi","唏":"xi","徙":"xi","饩":"xi","阋":"xi","浠":"xi","淅":"xi","屣":"xi","嬉":"xi","玺":"xi","樨":"xi","曦":"xi","觋":"xi","欷":"xi","熹":"xi","禊":"xi","禧":"xi","钸":"xi","皙":"xi","穸":"xi","蜥":"xi","蟋":"xi","舾":"xi","羲":"xi","粞":"xi","翕":"xi","醯":"xi","鼷":"xi","瞎":"xia","虾":"xia","匣":"xia","霞":"xia","辖":"xia","暇":"xia","峡":"xia","侠":"xia","狭":"xia","下":"xia","厦":"xia","夏":"xia","吓":"xia","掀":"xia","葭":"xia","嗄":"xia","狎":"xia","遐":"xia","瑕":"xia","硖":"xia","瘕":"xia","罅":"xia","黠":"xia","锨":"xian","先":"xian","仙":"xian","鲜":"xian","纤":"xian","咸":"xian","贤":"xian","衔":"xian","舷":"xian","闲":"xian","涎":"xian","弦":"xian","嫌":"xian","显":"xian","险":"xian","现":"xian","献":"xian","县":"xian","腺":"xian","馅":"xian","羡":"xian","宪":"xian","陷":"xian","限":"xian","线":"xian",
"冼":"xian","藓":"xian","岘":"xian","猃":"xian","暹":"xian","娴":"xian","氙":"xian","祆":"xian","鹇":"xian","痫":"xian","蚬":"xian","筅":"xian","籼":"xian","酰":"xian","跹":"xian","相":"xiang","厢":"xiang","镶":"xiang","香":"xiang","箱":"xiang","襄":"xiang","湘":"xiang","乡":"xiang","翔":"xiang","祥":"xiang","详":"xiang","想":"xiang","响":"xiang","享":"xiang","项":"xiang","巷":"xiang","橡":"xiang","像":"xiang","向":"xiang","象":"xiang","芗":"xiang","葙":"xiang","饷":"xiang","庠":"xiang","骧":"xiang","缃":"xiang","蟓":"xiang","鲞":"xiang","飨":"xiang","萧":"xiao","硝":"xiao","霄":"xiao","削":"xiao","哮":"xiao","嚣":"xiao","销":"xiao","消":"xiao","宵":"xiao","淆":"xiao","晓":"xiao","小":"xiao","孝":"xiao","校":"xiao","肖":"xiao","啸":"xiao","笑":"xiao","效":"xiao","哓":"xiao","咻":"xiao","崤":"xiao","潇":"xiao","逍":"xiao","骁":"xiao","绡":"xiao","枭":"xiao","枵":"xiao","筱":"xiao","箫":"xiao","魈":"xiao","楔":"xie","些":"xie","歇":"xie","蝎":"xie","鞋":"xie","协":"xie","挟":"xie","携":"xie","邪":"xie","斜":"xie","胁":"xie","谐":"xie","写":"xie","械":"xie","卸":"xie",
"蟹":"xie","懈":"xie","泄":"xie","泻":"xie","谢":"xie","屑":"xie","偕":"xie","亵":"xie","勰":"xie","燮":"xie","薤":"xie","撷":"xie","廨":"xie","瀣":"xie","邂":"xie","绁":"xie","缬":"xie","榭":"xie","榍":"xie","歙":"xie","躞":"xie","薪":"xin","芯":"xin","锌":"xin","欣":"xin","辛":"xin","新":"xin","忻":"xin","心":"xin","信":"xin","衅":"xin","囟":"xin","馨":"xin","莘":"xin","歆":"xin","铽":"xin","鑫":"xin","星":"xing","腥":"xing","猩":"xing","惺":"xing","兴":"xing","刑":"xing","型":"xing","形":"xing","邢":"xing","行":"xing","醒":"xing","幸":"xing","杏":"xing","性":"xing","姓":"xing","陉":"xing","荇":"xing","荥":"xing","擤":"xing","悻":"xing","硎":"xing","兄":"xiong","凶":"xiong","胸":"xiong","匈":"xiong","汹":"xiong","雄":"xiong","熊":"xiong","芎":"xiong","休":"xiu","修":"xiu","羞":"xiu","朽":"xiu","嗅":"xiu","锈":"xiu","秀":"xiu","袖":"xiu","绣":"xiu","莠":"xiu","岫":"xiu","馐":"xiu","庥":"xiu","鸺":"xiu","貅":"xiu","髹":"xiu","墟":"xu","戌":"xu","需":"xu","虚":"xu","嘘":"xu","须":"xu","徐":"xu","许":"xu","蓄":"xu","酗":"xu","叙":"xu","旭":"xu","序":"xu","畜":"xu","恤":"xu",
"絮":"xu","婿":"xu","绪":"xu","续":"xu","讴":"xu","诩":"xu","圩":"xu","蓿":"xu","怵":"xu","洫":"xu","溆":"xu","顼":"xu","栩":"xu","煦":"xu","砉":"xu","盱":"xu","胥":"xu","糈":"xu","醑":"xu","轩":"xuan","喧":"xuan","宣":"xuan","悬":"xuan","旋":"xuan","玄":"xuan","选":"xuan","癣":"xuan","眩":"xuan","绚":"xuan","儇":"xuan","谖":"xuan","萱":"xuan","揎":"xuan","馔":"xuan","泫":"xuan","洵":"xuan","渲":"xuan","漩":"xuan","璇":"xuan","楦":"xuan","暄":"xuan","炫":"xuan","煊":"xuan","碹":"xuan","铉":"xuan","镟":"xuan","痃":"xuan","靴":"xue","薛":"xue","学":"xue","穴":"xue","雪":"xue","血":"xue","噱":"xue","泶":"xue","鳕":"xue","勋":"xun","熏":"xun","循":"xun","旬":"xun","询":"xun","寻":"xun","驯":"xun","巡":"xun","殉":"xun","汛":"xun","训":"xun","讯":"xun","逊":"xun","迅":"xun","巽":"xun","埙":"xun","荀":"xun","薰":"xun","峋":"xun","徇":"xun","浔":"xun","曛":"xun","窨":"xun","醺":"xun","鲟":"xun","压":"ya","押":"ya","鸦":"ya","鸭":"ya","呀":"ya","丫":"ya","芽":"ya","牙":"ya","蚜":"ya","崖":"ya","衙":"ya","涯":"ya","雅":"ya","哑":"ya","亚":"ya","讶":"ya","伢":"ya","揠":"ya","吖":"ya","岈":"ya",
"迓":"ya","娅":"ya","琊":"ya","桠":"ya","氩":"ya","砑":"ya","睚":"ya","痖":"ya","焉":"yan","咽":"yan","阉":"yan","烟":"yan","淹":"yan","盐":"yan","严":"yan","研":"yan","蜒":"yan","岩":"yan","延":"yan","言":"yan","颜":"yan","阎":"yan","炎":"yan","沿":"yan","奄":"yan","掩":"yan","眼":"yan","衍":"yan","演":"yan","艳":"yan","堰":"yan","燕":"yan","厌":"yan","砚":"yan","雁":"yan","唁":"yan","彦":"yan","焰":"yan","宴":"yan","谚":"yan","验":"yan","厣":"yan","靥":"yan","赝":"yan","俨":"yan","偃":"yan","兖":"yan","讠":"yan","谳":"yan","郾":"yan","鄢":"yan","芫":"yan","菸":"yan","崦":"yan","恹":"yan","闫":"yan","阏":"yan","洇":"yan","湮":"yan","滟":"yan","妍":"yan","嫣":"yan","琰":"yan","晏":"yan","胭":"yan","腌":"yan","焱":"yan","罨":"yan","筵":"yan","酽":"yan","魇":"yan","餍":"yan","鼹":"yan","殃":"yang","央":"yang","鸯":"yang","秧":"yang","杨":"yang","扬":"yang","佯":"yang","疡":"yang","羊":"yang","洋":"yang","阳":"yang","氧":"yang","仰":"yang","痒":"yang","养":"yang","样":"yang","漾":"yang","徉":"yang","怏":"yang","泱":"yang","炀":"yang","烊":"yang","恙":"yang","蛘":"yang","鞅":"yang",
"邀":"yao","腰":"yao","妖":"yao","瑶":"yao","摇":"yao","尧":"yao","遥":"yao","窑":"yao","谣":"yao","姚":"yao","咬":"yao","舀":"yao","药":"yao","要":"yao","耀":"yao","夭":"yao","爻":"yao","吆":"yao","崾":"yao","徭":"yao","瀹":"yao","幺":"yao","珧":"yao","杳":"yao","曜":"yao","肴":"yao","鹞":"yao","窈":"yao","繇":"yao","鳐":"yao","椰":"ye","噎":"ye","耶":"ye","爷":"ye","野":"ye","冶":"ye","也":"ye","页":"ye","掖":"ye","业":"ye","叶":"ye","曳":"ye","腋":"ye","夜":"ye","液":"ye","谒":"ye","邺":"ye","揶":"ye","馀":"ye","晔":"ye","烨":"ye","铘":"ye","一":"yi","壹":"yi","医":"yi","揖":"yi","铱":"yi","依":"yi","伊":"yi","衣":"yi","颐":"yi","夷":"yi","遗":"yi","移":"yi","仪":"yi","胰":"yi","疑":"yi","沂":"yi","宜":"yi","姨":"yi","彝":"yi","椅":"yi","蚁":"yi","倚":"yi","已":"yi","乙":"yi","矣":"yi","以":"yi","艺":"yi","抑":"yi","易":"yi","邑":"yi","屹":"yi","亿":"yi","役":"yi","臆":"yi","逸":"yi","肄":"yi","疫":"yi","亦":"yi","裔":"yi","意":"yi","毅":"yi","忆":"yi","义":"yi","益":"yi","溢":"yi","诣":"yi","议":"yi","谊":"yi","译":"yi","异":"yi","翼":"yi","翌":"yi","绎":"yi","刈":"yi","劓":"yi",
"佾":"yi","诒":"yi","圪":"yi","圯":"yi","埸":"yi","懿":"yi","苡":"yi","薏":"yi","弈":"yi","奕":"yi","挹":"yi","弋":"yi","呓":"yi","咦":"yi","咿":"yi","噫":"yi","峄":"yi","嶷":"yi","猗":"yi","饴":"yi","怿":"yi","怡":"yi","悒":"yi","漪":"yi","迤":"yi","驿":"yi","缢":"yi","殪":"yi","贻":"yi","旖":"yi","熠":"yi","钇":"yi","镒":"yi","镱":"yi","痍":"yi","瘗":"yi","癔":"yi","翊":"yi","衤":"yi","蜴":"yi","舣":"yi","羿":"yi","翳":"yi","酏":"yi","黟":"yi","茵":"yin","荫":"yin","因":"yin","殷":"yin","音":"yin","阴":"yin","姻":"yin","吟":"yin","银":"yin","淫":"yin","寅":"yin","饮":"yin","尹":"yin","引":"yin","隐":"yin","印":"yin","胤":"yin","鄞":"yin","堙":"yin","茚":"yin","喑":"yin","狺":"yin","夤":"yin","氤":"yin","铟":"yin","瘾":"yin","蚓":"yin","霪":"yin","龈":"yin","英":"ying","樱":"ying","婴":"ying","鹰":"ying","应":"ying","缨":"ying","莹":"ying","萤":"ying","营":"ying","荧":"ying","蝇":"ying","迎":"ying","赢":"ying","盈":"ying","影":"ying","颖":"ying","硬":"ying","映":"ying","嬴":"ying","郢":"ying","茔":"ying","莺":"ying","萦":"ying","撄":"ying","嘤":"ying","膺":"ying","滢":"ying",
"潆":"ying","瀛":"ying","瑛":"ying","璎":"ying","楹":"ying","鹦":"ying","瘿":"ying","颍":"ying","罂":"ying","哟":"yo","唷":"yo","拥":"yong","佣":"yong","臃":"yong","痈":"yong","庸":"yong","雍":"yong","踊":"yong","蛹":"yong","咏":"yong","泳":"yong","涌":"yong","永":"yong","恿":"yong","勇":"yong","用":"yong","俑":"yong","壅":"yong","墉":"yong","慵":"yong","邕":"yong","镛":"yong","甬":"yong","鳙":"yong","饔":"yong","幽":"you","优":"you","悠":"you","忧":"you","尤":"you","由":"you","邮":"you","铀":"you","犹":"you","油":"you","游":"you","酉":"you","有":"you","友":"you","右":"you","佑":"you","釉":"you","诱":"you","又":"you","幼":"you","卣":"you","攸":"you","侑":"you","莸":"you","呦":"you","囿":"you","宥":"you","柚":"you","猷":"you","牖":"you","铕":"you","疣":"you","蝣":"you","鱿":"you","黝":"you","鼬":"you","迂":"yu","淤":"yu","于":"yu","盂":"yu","榆":"yu","虞":"yu","愚":"yu","舆":"yu","余":"yu","俞":"yu","逾":"yu","鱼":"yu","愉":"yu","渝":"yu","渔":"yu","隅":"yu","予":"yu","娱":"yu","雨":"yu","与":"yu","屿":"yu","禹":"yu","宇":"yu","语":"yu","羽":"yu","玉":"yu","域":"yu","芋":"yu",
"郁":"yu","吁":"yu","遇":"yu","喻":"yu","峪":"yu","御":"yu","愈":"yu","欲":"yu","狱":"yu","育":"yu","誉":"yu","浴":"yu","寓":"yu","裕":"yu","预":"yu","豫":"yu","驭":"yu","禺":"yu","毓":"yu","伛":"yu","俣":"yu","谀":"yu","谕":"yu","萸":"yu","蓣":"yu","揄":"yu","喁":"yu","圄":"yu","圉":"yu","嵛":"yu","狳":"yu","饫":"yu","庾":"yu","阈":"yu","妪":"yu","妤":"yu","纡":"yu","瑜":"yu","昱":"yu","觎":"yu","腴":"yu","欤":"yu","於":"yu","煜":"yu","燠":"yu","聿":"yu","钰":"yu","鹆":"yu","瘐":"yu","瘀":"yu","窳":"yu","蝓":"yu","竽":"yu","舁":"yu","雩":"yu","龉":"yu","鸳":"yuan","渊":"yuan","冤":"yuan","元":"yuan","垣":"yuan","袁":"yuan","原":"yuan","援":"yuan","辕":"yuan","园":"yuan","员":"yuan","圆":"yuan","猿":"yuan","源":"yuan","缘":"yuan","远":"yuan","苑":"yuan","愿":"yuan","怨":"yuan","院":"yuan","塬":"yuan","沅":"yuan","媛":"yuan","瑗":"yuan","橼":"yuan","爰":"yuan","眢":"yuan","鸢":"yuan","螈":"yuan","鼋":"yuan","曰":"yue","约":"yue","越":"yue","跃":"yue","钥":"yue","岳":"yue","粤":"yue","月":"yue","悦":"yue","阅":"yue","龠":"yue","樾":"yue","刖":"yue","钺":"yue","耘":"yun","云":"yun",
"郧":"yun","匀":"yun","陨":"yun","允":"yun","运":"yun","蕴":"yun","酝":"yun","晕":"yun","韵":"yun","孕":"yun","郓":"yun","芸":"yun","狁":"yun","恽":"yun","纭":"yun","殒":"yun","昀":"yun","氲":"yun","匝":"za","砸":"za","杂":"za","拶":"za","咂":"za","栽":"zai","哉":"zai","灾":"zai","宰":"zai","载":"zai","再":"zai","在":"zai","咱":"zai","崽":"zai","甾":"zai","攒":"zan","暂":"zan","赞":"zan","瓒":"zan","昝":"zan","簪":"zan","糌":"zan","趱":"zan","錾":"zan","赃":"zang","脏":"zang","葬":"zang","奘":"zang","戕":"zang","臧":"zang","遭":"zao","糟":"zao","凿":"zao","藻":"zao","枣":"zao","早":"zao","澡":"zao","蚤":"zao","躁":"zao","噪":"zao","造":"zao","皂":"zao","灶":"zao","燥":"zao","唣":"zao","缫":"zao","责":"ze","择":"ze","则":"ze","泽":"ze","仄":"ze","赜":"ze","啧":"ze","迮":"ze","昃":"ze","笮":"ze","箦":"ze","舴":"ze","贼":"zei","怎":"zen","谮":"zen","增":"zeng","憎":"zeng","曾":"zeng","赠":"zeng","缯":"zeng","甑":"zeng","罾":"zeng","锃":"zeng","扎":"zha","喳":"zha","渣":"zha","札":"zha","轧":"zha","铡":"zha","闸":"zha","眨":"zha","栅":"zha","榨":"zha","咋":"zha","乍":"zha","炸":"zha",
"诈":"zha","揸":"zha","吒":"zha","咤":"zha","哳":"zha","怍":"zha","砟":"zha","痄":"zha","蚱":"zha","齄":"zha","摘":"zhai","斋":"zhai","宅":"zhai","窄":"zhai","债":"zhai","寨":"zhai","砦":"zhai","瞻":"zhan","毡":"zhan","詹":"zhan","粘":"zhan","沾":"zhan","盏":"zhan","斩":"zhan","辗":"zhan","崭":"zhan","展":"zhan","蘸":"zhan","栈":"zhan","占":"zhan","战":"zhan","站":"zhan","湛":"zhan","绽":"zhan","谵":"zhan","搌":"zhan","旃":"zhan","樟":"zhang","章":"zhang","彰":"zhang","漳":"zhang","张":"zhang","掌":"zhang","涨":"zhang","杖":"zhang","丈":"zhang","帐":"zhang","账":"zhang","仗":"zhang","胀":"zhang","瘴":"zhang","障":"zhang","仉":"zhang","鄣":"zhang","幛":"zhang","嶂":"zhang","獐":"zhang","嫜":"zhang","璋":"zhang","蟑":"zhang","招":"zhao","昭":"zhao","找":"zhao","沼":"zhao","赵":"zhao","照":"zhao","罩":"zhao","兆":"zhao","肇":"zhao","召":"zhao","爪":"zhao","诏":"zhao","棹":"zhao","钊":"zhao","笊":"zhao","遮":"zhe","折":"zhe","哲":"zhe","蛰":"zhe","辙":"zhe","者":"zhe","锗":"zhe","蔗":"zhe","这":"zhe","浙":"zhe","谪":"zhe","陬":"zhe","柘":"zhe","辄":"zhe","磔":"zhe","鹧":"zhe",
"褚":"zhe","蜇":"zhe","赭":"zhe","珍":"zhen","斟":"zhen","真":"zhen","甄":"zhen","砧":"zhen","臻":"zhen","贞":"zhen","针":"zhen","侦":"zhen","枕":"zhen","疹":"zhen","诊":"zhen","震":"zhen","振":"zhen","镇":"zhen","阵":"zhen","缜":"zhen","桢":"zhen","榛":"zhen","轸":"zhen","赈":"zhen","胗":"zhen","朕":"zhen","祯":"zhen","畛":"zhen","鸩":"zhen","蒸":"zheng","挣":"zheng","睁":"zheng","征":"zheng","狰":"zheng","争":"zheng","怔":"zheng","整":"zheng","拯":"zheng","正":"zheng","政":"zheng","帧":"zheng","症":"zheng","郑":"zheng","证":"zheng","诤":"zheng","峥":"zheng","钲":"zheng","铮":"zheng","筝":"zheng","芝":"zhi","枝":"zhi","支":"zhi","吱":"zhi","蜘":"zhi","知":"zhi","肢":"zhi","脂":"zhi","汁":"zhi","之":"zhi","织":"zhi","职":"zhi","直":"zhi","植":"zhi","殖":"zhi","执":"zhi","值":"zhi","侄":"zhi","址":"zhi","指":"zhi","止":"zhi","趾":"zhi","只":"zhi","旨":"zhi","纸":"zhi","志":"zhi","挚":"zhi","掷":"zhi","至":"zhi","致":"zhi","置":"zhi","帜":"zhi","峙":"zhi","制":"zhi","智":"zhi","秩":"zhi","稚":"zhi","质":"zhi","炙":"zhi","痔":"zhi","滞":"zhi","治":"zhi","窒":"zhi","卮":"zhi",
"陟":"zhi","郅":"zhi","埴":"zhi","芷":"zhi","摭":"zhi","帙":"zhi","忮":"zhi","彘":"zhi","咫":"zhi","骘":"zhi","栉":"zhi","枳":"zhi","栀":"zhi","桎":"zhi","轵":"zhi","轾":"zhi","攴":"zhi","贽":"zhi","膣":"zhi","祉":"zhi","祗":"zhi","黹":"zhi","雉":"zhi","鸷":"zhi","痣":"zhi","蛭":"zhi","絷":"zhi","酯":"zhi","跖":"zhi","踬":"zhi","踯":"zhi","豸":"zhi","觯":"zhi","中":"zhong","盅":"zhong","忠":"zhong","钟":"zhong","衷":"zhong","终":"zhong","种":"zhong","肿":"zhong","重":"zhong","仲":"zhong","众":"zhong","冢":"zhong","锺":"zhong","螽":"zhong","舂":"zhong","舯":"zhong","踵":"zhong","舟":"zhou","周":"zhou","州":"zhou","洲":"zhou","诌":"zhou","粥":"zhou","轴":"zhou","肘":"zhou","帚":"zhou","咒":"zhou","皱":"zhou","宙":"zhou","昼":"zhou","骤":"zhou","啄":"zhou","着":"zhou","倜":"zhou","诹":"zhou","荮":"zhou","鬻":"zhou","纣":"zhou","胄":"zhou","碡":"zhou","籀":"zhou","舳":"zhou","酎":"zhou","鲷":"zhou","珠":"zhu","株":"zhu","蛛":"zhu","朱":"zhu","猪":"zhu","诸":"zhu","诛":"zhu","逐":"zhu","竹":"zhu","烛":"zhu","煮":"zhu","拄":"zhu","瞩":"zhu","嘱":"zhu","主":"zhu","著":"zhu",
"柱":"zhu","助":"zhu","蛀":"zhu","贮":"zhu","铸":"zhu","筑":"zhu","住":"zhu","注":"zhu","祝":"zhu","驻":"zhu","伫":"zhu","侏":"zhu","邾":"zhu","苎":"zhu","茱":"zhu","洙":"zhu","渚":"zhu","潴":"zhu","驺":"zhu","杼":"zhu","槠":"zhu","橥":"zhu","炷":"zhu","铢":"zhu","疰":"zhu","瘃":"zhu","蚰":"zhu","竺":"zhu","箸":"zhu","翥":"zhu","躅":"zhu","麈":"zhu","抓":"zhua","拽":"zhuai","专":"zhuan","砖":"zhuan","转":"zhuan","撰":"zhuan","赚":"zhuan","篆":"zhuan","抟":"zhuan","啭":"zhuan","颛":"zhuan","桩":"zhuang","庄":"zhuang","装":"zhuang","妆":"zhuang","撞":"zhuang","壮":"zhuang","状":"zhuang","丬":"zhuang","椎":"zhui","锥":"zhui","追":"zhui","赘":"zhui","坠":"zhui","缀":"zhui","萑":"zhui","骓":"zhui","缒":"zhui","谆":"zhun","准":"zhun","捉":"zhuo","拙":"zhuo","卓":"zhuo","桌":"zhuo","琢":"zhuo","茁":"zhuo","酌":"zhuo","灼":"zhuo","浊":"zhuo","倬":"zhuo","诼":"zhuo","廴":"zhuo","蕞":"zhuo","擢":"zhuo","啜":"zhuo","浞":"zhuo","涿":"zhuo","杓":"zhuo","焯":"zhuo","禚":"zhuo","斫":"zhuo","兹":"zi","咨":"zi","资":"zi","姿":"zi","滋":"zi","淄":"zi","孜":"zi","紫":"zi","仔":"zi","籽":"zi",
"滓":"zi","子":"zi","自":"zi","渍":"zi","字":"zi","谘":"zi","嵫":"zi","姊":"zi","孳":"zi","缁":"zi","梓":"zi","辎":"zi","赀":"zi","恣":"zi","眦":"zi","锱":"zi","秭":"zi","耔":"zi","笫":"zi","粢":"zi","觜":"zi","訾":"zi","鲻":"zi","髭":"zi","鬃":"zong","棕":"zong","踪":"zong","宗":"zong","综":"zong","总":"zong","纵":"zong","腙":"zong","粽":"zong","邹":"zou","走":"zou","奏":"zou","揍":"zou","鄹":"zou","鲰":"zou","租":"zu","足":"zu","卒":"zu","族":"zu","祖":"zu","诅":"zu","阻":"zu","组":"zu","俎":"zu","菹":"zu","啐":"zu","徂":"zu","驵":"zu","蹴":"zu","钻":"zuan","纂":"zuan","攥":"zuan","缵":"zuan","嘴":"zui","醉":"zui","最":"zui","罪":"zui","尊":"zun","遵":"zun","撙":"zun","樽":"zun","鳟":"zun","昨":"zuo","左":"zuo","佐":"zuo","柞":"zuo","做":"zuo","作":"zuo","坐":"zuo","座":"zuo","阝":"zuo","阼":"zuo","胙":"zuo","祚":"zuo","酢":"zuo","薮":"cou","楱":"cou","辏":"cou","腠":"cou","攮":"nang","哝":"nang","囔":"nang","馕":"nang","曩":"nang","喔":"o","嗲":"dia","嘬":"chuai","膪":"chuai","踹":"chuai","岑":"cen","涔":"cen","铥":"diu","耨":"nou","缶":"fou","髟":"bia"}
;t.printBankBook=function(t){new PJF.ui.messageBox({buttonText:["确定"],buttonIconCls:["icon-confirm"],closable:!1,style:"info",title:t.title,content:t.content,ok:function(){PJF.communication.client.printVoucher(t.printData),t.callback&&t.callback()}})},t.getPinyinDict=function(){return a},t.addUrlAppParams=function(t){return t=PJF.html.addUrlParam(t,"menuId",PJF.html.getUrlParam("menuId"),!1),PJF.constants.D2D||(t=PJF.html.addUrlParam(t,"batchNo",PJF.html.getUrlParam("batchNo"),!1)),"true"==PJF.html.getUrlParam("_PJF_IN_EUP")&&(t=PJF.html.addUrlParam(t,"_PJF_IN_EUP","true",!1)),t},t.getDomain=function(t){var e=PJF.util.getValue(PJF,"otherInfo.scp")||"1";return"DF001"==PJF.util.getValue(PJF,"orgInfo.instSvrlLgPsnID")&&(e="zd"),PJF.constants.DOMAIN_MAP[e][t]},t.getLoginToken=function(){if(!e&&PJF.communication.client.isInP2()){var t=PJF.communication.client.getClientEnv("outputLoginBean.transSerNo");"0"==t[0]&&t[1]&&(e=t[1])}return e},t.isOverSea=function(){
return!i&&PJF.communication.client.isInP2()&&(i="true"===PJF.communication.client.getClientEnv("oversea")[1]||"1.2.7.5"===PJF.util.getClientVersion()),i},t.isZD=function(){return void 0===n&&(n=!(!PJF.communication.client.isInP2()||0!=(PJF.util.getClientSubVersion()+"").indexOf("zd"))),n},t.isYGQD=function(){return void 0===o&&(o=!PJF.constants.D2D&&!PJF.util.isZD()),o};var r,c,l=function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e},d={zd:t.isZD},u={zdAddonMap:{zd:"1"},zdClientMap:{"1.0.0":"1.3"}};t.clientVersionTransform=function(t,e){if(void 0===r&&void 0===c){for(var i in c={version:t||"1.0.0",addon:e||"0"},d)if(d[i]()){r=i;break}if(r){var n=u[r+"ClientMap"],o=u[r+"AddonMap"];if(n)if(n[t])c.version=n[t];else{var a=l(n);c.version=n[a.pop()]}if(o)if(o[e])c.addon=o[e];else{var s=l(o);c.addon=o[s.pop()]}}else r=!1}return c}}(PJF.util),PJF.namespace("PJF.validator"),PJF.validator.base={isNum:{key:"number",fn:function(t){
return!!t&&null==t.match(/\D/)}},isDigit:{key:"digit",fn:function(t){return null!=t.match(/^-?\d+(\.\d+)?$/g)}},isInt:{key:"int",fn:function(t){return null!=t.match(/^[-+]?\d*$/)}},pInt:{key:"pInt",fn:function(t){return!!t.match(/^\+?[1-9][0-9]*$/)}},notNegaInt:{key:"notNegaInt",fn:function(t){return!!t.match(/^(0|[1-9]\d*)$/)}},pNum:{key:"pNum",fn:function(t){return!!(t.match(/^[\+]?[0-9]*\d(\.\d+)?$/)&&0<parseFloat(t))}},greaterZero:{key:"gZero",fn:function(t){return!!t.match(/^[\+]?[0-9]*\d(\.\d+)?$/)}},isChinese:{key:"chinese",fn:function(t){return-1!=escape(t).indexOf("%u")}},isEmail:{key:"email",fn:function(t){return null!=t.match(/^[\w-_]+(\.[\w-_]+)*@[\w-_]+((\.[\w-_]+)+)$/)}},isMobile:{key:"mobile",fn:function(t){return null!=t.match(/^1\d{2}-?\d{5}(\d{3}|\*{3})$/)}},isTel:{key:"tel",fn:function(t){return null!=t.match(/^(([0\+]\d{2,3}-)?(0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/)}},isIDCard:{key:"IDCard",fn:function(t){
if(15==t.length)var e=new Number("19"+t.slice(6,8)),i=new Number(t.slice(8,10))-1,n=new Number(t.slice(10,12));else if(18==t.length)e=new Number(t.slice(6,10)),i=new Number(t.slice(10,12))-1,n=new Number(t.slice(12,14));var o=new Date(e,i,n),a=new Date;return(null!=t.match(/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$/)||null!=t.match(/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[X])$/))&&(!(e<1900||a<o)&&(o.getFullYear()==e&&o.getMonth()==i&&o.getDate()==n))}},is18IDCard:{key:"18IDCard",fn:function(t){var e=new Number(t.slice(6,10)),i=new Number(t.slice(10,12))-1,n=new Number(t.slice(12,14)),o=new Date(e,i,n),a=new Date;return null!=t.match(/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[X])$/)&&(!(e<1900||a<o)&&(o.getFullYear()==e&&o.getMonth()==i&&o.getDate()==n))}},isName:{key:"user",fn:function(t){
return!(t.match(/(\\|:|\/|\*|\?|\"|>|<|\|)/)||t.match(/^[\s]|[\u4E00-\u9FA5]\s/)||t.match(/[a-z]/)||t.match(/([\uFF00-\uFF07] | [\uFF0A-\uFFEF] | [\u3000-\u3009] | [\u300C-\u303F])/))}},isCnNumEn:{key:"isCnNumEn",fn:function(t){return!!t.match(/^[\u4e00-\u9fff\u3400-\u4DB5\uF900-\uFA2D\uFA30-\uFA6A\uFA70-\uFAD9\uFF00-\uFFEF\u2E80-\u2EFF\u3000-\u303F\u31C0-\u31EF\ue815-\ue864\ue000-\uefffA-Za-z0-9]*$/)}},iciUserName:{key:"iciUserName",fn:function(t){var e="一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--",i=new RegExp("^(["+e+"A-Za-z])+((·| |-)(["+e+"A-Za-z])+)*$");if(!t.match(i))return!1;if(t.match("([一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--])( )+([一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--])"))return!1;if(t.match("([一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--]( )+[A-Za-z])|([A-Za-z]( )+[一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--])"))return!1;return!t.match(/[A-Za-z]+( ){2,}[A-Za-z]+/)&&(-1==t.indexOf("·")||!t.match(/([A-Za-z]| )/))}},isSpecChar:{key:"specChar",fn:function(t){
return!t.match(/(^[\s]|\\|:|\/|\*|\?|\"|>|<|\|)/)&&!t.match(/(\uFF3C|\uFF0F|\uFF1A|\uFF0A|\uFF1F|\uFF02|\uFF1C|\uFF1E|\uFF5C)/)}},length:{key:"length",fn:function(t,e){if(e){if(1==e.length)return t.length==e[0];if(2==e.length)return t.length<=e[1]&&t.length>=e[0]}return!0}},isNumberOrLetter:{key:"isNumberOrLetter",fn:function(t){return!!t.match(/^[A-Za-z0-9]+$/)}},isChnChar:{key:"isChnChar",fn:function(t){return!!t.match(/[\u4E00-\u9FA5]/)}},decLength:{key:"decLength",fn:function(t,e){if(e){var i="^-?([0-9])+(\\.[0-9]{1,"+e[1]+"})?$",n=t.split(".");return!(!t.match(i)||n[0].length>e[0])}}},byteLength:{key:"byteLength",fn:function(t,e){var i,n;if(e){if((n=t.match(/[^\x00-\xff]/g))||(n=""),i=t.length-n.length+3*n.length,1==e.length)return i==e[0];if(2==e.length)return i<=e[1]&&i>=e[0]}return!0}},isStrNumPwd:{key:"isStrNumPwd",fn:function(t,e){var i=[];i.push(function(t){return t.match(/^[0-9]{6}$/g)});i.push(function(t){return!t.match(/^([0-9]{1})\1{5}$/g)});i.push(function(t){
for(var e=!0,i=0;i<t.length-1;i++)if(t.charCodeAt(i)-t.charCodeAt(i+1)!=1){e=!1;break}var n=!0;for(i=0;i<t.length-1;i++)if(t.charCodeAt(i+1)-t.charCodeAt(i)!=1){n=!1;break}return!e&&!n});i.push(function(t){return!t.match(/^([0-9]{1})\1{1}([0-9]{1})\2{1}([0-9]{1})\3{1}$/g)&&!t.match(/^([0-9]{1})\1{2}([0-9]{1})\2{2}$/g)});i.push(function(t,e){if(!e)return!0;for(var i,n=e.split(";"),o=0;o<n.length;o++){if((i=n[o]).match(/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$/)&&"0"==i[10]&&"0"==i[12]&&t.substring(0,4)==i.substring(6,10)&&t[4]==i[11]&&t[5]==i[13])return!1;if(-1!=i.indexOf(t))return!1}return!0});for(var n=0;n<i.length;n++){if(!i[n].call(this,t,e))return!1}return!0}},loanAccount:{key:"loanAccount",fn:function(t,e){if(e)return!!t.match("\\d{2}\\s\\d{3}\\s\\d{3}\\s\\d{4}-\\d{14}")}},zipCode:{key:"zipCode",fn:function(t){return!!t.match(/^[0-9]\d{5}$/)}},numFixedFormat:{key:"numFixedFormat",fn:function(t,e){
if(!e||2!=e.length)return alert("numFixedFormat 参数格式错误 ,格式为[int,int]"),!1;var i=e[0]||1,n=e[1];if(/^-0$/.test(t))return!1;var o="^[-]?(([1-9]\\d{0,"+(i-1)+"})|([0]))",a="";return a=0<n?"(\\.\\d{1,"+n+"})?$":"$",console.log(o+a),new RegExp(o+a).test(t)}},isPhoneNumber:{key:"isPhoneNumber",fn:function(t){return null!=t.match(/^1\d{2}-?\d{5}(\d{3}|\*{3})$/)}},identityType:{key:"identityType",fn:function(t,e){if(!e)return!1;var i;switch(e=1==e.length?e[0]:e){case PJF.constants.IDENTITY_GANG_AO:i=/^(H|M)\d{8}$/;break;case PJF.constants.IDENTITY_TAI_WAN:i=/^\d{8}$/}return!!t.match(i)}}},PJF.validator.rules=function(){if(PJF.validator.base){var t=PJF.validator.base,e={};for(var i in t)e[t[i].key]=t[i].fn;return e}},PJF.validator.validate=function(t,e,i){i=(i=i||"").split(",");for(var n=PJF.validator.rules(),o=0;o<i.length;o++)if(n[i[o]]&&!n[i[o]](t,e))return i[o]},PJF.validator.expand=function(t){if(PJF.apply(PJF.validator.base,t),$.fn.validatebox){
var e=PJF.validator.rules(),i={},n=function(i){return{fn:function(t,e){return!PJF.validator.validate(t,e,i)}}};for(var o in e)i[o]={validator:n(o).fn,message:o+"!"};$.extend($.fn.validatebox.defaults.rules,i)}},PJF.namespace("PJF.i18n"),PJF.i18n={load:function(t,e){!0!==e?JSLoader.loadResource(t):$.ajax({url:t+"_"+CLIENT_LANGUAGE+".js",async:!1,success:function(t){try{(window.execScript||function(t){window.eval.call(window,t)})(t)}catch(e){console.log("解析资源文件出错,"+e.message)}},error:function(t,e,i){console.log("同步加载资源文件出错,"+e+i)}})},addUrli18n:function(t){return PJF.util.isExist("PJF.orgInfo.instSvrlLgPsnID")&&(t=PJF.html.addUrlParam(t,"instSvrlLgPsnID",PJF.orgInfo.instSvrlLgPsnID,!1)),t=PJF.html.addUrlParam(t,"REQ_LANG",CLIENT_LANGUAGE,!1)}},PJF.namespace("PJF.html"),PJF.html={getAreaData:function(t,e,i){t||alert("PJF.html.getAreaData"+resource.GETAREADATA_ISFORMIDNULL_INFO1+"formId"+resource.GETAREADATA_ISFORMIDNULL_INFO2),domId="#"+t
;for(var n,o=[],a=[],s=$(domId).find("input[datatype='money'],input[datatype='card'],input[datatype='dccMoney'],input[datatype='phoneNumber'],input[datatype='customDataType']"),r=0;r<s.length;r++){var c=s.eq(r).val();o.push(c),c=c.replace(new RegExp(",","gm"),""),"card"==s.eq(r).attr("datatype")&&PJF.orgInfo&&"CN000"!=PJF.orgInfo.instSvrlLgPsnID&&/^[a-zA-z]/.test(c)||(c=c.replace(new RegExp(" ","gm"),"")),"phoneNumber"==s.eq(r).attr("datatype")&&(c=c.replace(new RegExp("-","gm"),"")),"customDataType"==s.eq(r).attr("datatype")&&(c=c.replace(new RegExp("-","gm"),"")),a.push(c),s.eq(r).val(a[r])}if(n=!0===e?$("li:visible input,li:visible select,textarea:visible",domId).serializeArray():$(domId).serializeArray(),$.browser.safari){var l=$("form",$(domId));l.each(function(t){n=n.concat($(l[t]).serializeArray())})}for(r=0;r<s.length;r++)s.eq(r).val(o[r]);if(n){var d={};for(var u in n)if(d[n[u].name])if(d[n[u].name]instanceof Array)d[n[u].name].push(PJF.util.trim(n[u].value));else{
var h=d[n[u].name];d[n[u].name]=[],d[n[u].name].push(h),d[n[u].name].push(PJF.util.trim(n[u].value))}else{n[u].value||(n[u].value="");var p=PJF.util.trim(n[u].value);p=(p=p.replace(new RegExp("\r","gm"),"\\r")).replace(new RegExp("\n","gm"),"\\n"),d[n[u].name]=p}return i&&$(domId).find('input[type="checkbox"][name]:visible').not(":disabled:checked").each(function(){var t=$(this).attr("name");d[t]===undefined&&(d[t]="")}),d}},setAreaData:function(i,t,e,n,o,a){var s;if(i)for(var r in null==n&&(n=!0),i)if(i[r]||!0===o){var c=r;if(e&&(c=e+"_"+r),s=t&&!0===a?$("#"+t).find("#"+c)[0]:PJF.html.getDom(c)){var l=$(s).attr("datatype");if("text"==s.type||"textarea"==s.type||"hidden"==s.type){if("textarea"==s.type&&(i[r]=PJF.util.string.replaceall(i[r],"\\\\r","\r"),i[r]=PJF.util.string.replaceall(i[r],"\\\\n","\n")),s.value=i[r],n&&""!=s.value&&$(s).attr("autocomplete")==undefined&&"datebox-f combo-f"!=s.className&&"datebox-f combo-f pjf_disabled_input"!=s.className){
if((1==s.disabled||"none"==s.display)&&"dccMoney"!=l&&"money"!=l&&"card"!=l)continue;try{$(s).trigger("focus"),$(s).trigger("blur"),$(s).siblings("div.errorbox_ipt_help").remove()}catch(A){}}if($(s).attr("autocomplete")){var d=$(s).attr("id"),u=$(s).siblings("input:hidden").val(),h=PJF.ui.componentMgr.get(d);h?(h.setValue(i[r]),h.getValue()?$(s).removeAttr("error"):($(s).siblings("input:hidden").val(u),$(s).val(i[r]))):$(s).val(i[r])}if(null==s.className.match(new RegExp("(\\s|^)datebox-f combo-f(\\s|$)"))&&null==s.className.match(new RegExp("(\\s|^)combo-f datetimebox-f(\\s|$)"))||$(s).next().find("input").each(function(){var t=i[r],e=PJF.ui.componentMgr.get($(s).attr("componentid"));if(e?e.setValue(t,!1):this.value=i[r],n){if("disabled"==$(s).next().find("input:first").attr("disabled"))return;$(s).next().find("input:first").trigger("focus"),$(s).next().find("input:first").trigger("blur")}}),null!=s.className.match(new RegExp("(\\s|^)timespinner(\\s|$)"))){var p=i[r]
;if(4!=p.length&&6!=p.length||0<p.indexOf(":"))b=i[r].replace(new RegExp(":","gm"),""),$(s).parent().next("input").val(b);else{var f=p.substr(0,2),m=p.substr(2,2);if(_=p.substr(4,2))var g=f+":"+m+":"+_;else g=f+":"+m;b=i[r],$(s).parent().find("input").val(g),$(s).parent().next("input").val(b)}$(s).parent().find("input").trigger("blur")}if($(s).prev().children("input").hasClass("spinner-text")&&$(s).prev().children("input").hasClass("timespinner")){var v=i[r];if(!(4!=v.length&&6!=v.length||0<v.indexOf(":"))){var _;f=v.substr(0,2),m=v.substr(2,2);if(_=v.substr(4,2))g=f+":"+m+":"+_;else g=f+":"+m;v=g}var b=i[r].replace(":","").replace(":","").replace(":","");$(s).prev().find("input").val(v),$(s).val(b),$(s).prev().find("input").trigger("focus"),$(s).prev().find("input").trigger("blur")}PJF.util.string.startWith(s.className,"combo-text")&&$(s).next().next().each(function(){if(this.value=i[r],n){if("disabled"==$(s).attr("disabled"))return;$(s).trigger("focus"),$(s).trigger("blur")}})
}else if("select-one"==s.type){for(var y=0;y<s.options.length;y++)if(s.options[y].value==i[r]){s.options[y].selected=!0,$(s).siblings("input").val($(s.options[y]).text()),i[r]&&$(s).siblings("input").removeAttr("error").removeClass("validatebox-tipcolor error-border").siblings("div.errorbox_ipt_help").remove();break}}else if("select-multiple"==s.type){if(i[r]instanceof Array){for(var P=[],C=0;C<i[r].length;C++)for(var I=0;I<s.options.length;I++)if(s.options[I].value==i[r][C]){s.options[I].selected=!0,P.push($(s.options[I]).text());break}0<P.length&&($(s).siblings("input").val(P.toString()),$(s).siblings("input").removeAttr("error").removeClass("validatebox-tipcolor error-border").siblings("div.errorbox_ipt_help").remove())}$(s).attr("addDivFlag","addDivFlag")}else if("radio"==s.type||"checkbox"==s.type){var F=s.name;$("#"+t+" input[name="+F+"]").each(function(){this.value==i[r]&&(this.checked=!0)})}else if(s.type==undefined){var x=$("#"+c).find("select");if(x.length){x.each(function(){
this.value=i[r],$(this).val(i[r]);var t=$(this).find("option:selected").text();$(this).siblings("input").val(t),this.value&&$(this).siblings("input").removeAttr("error").removeClass("validatebox-tipcolor error-border").siblings("div.errorbox_ipt_help").remove(),$(this).attr("addDivFlag","addDivFlag")});continue}var w=$("#"+c).find('input[type="text"]');if(w.length){w.each(function(){this.value=i[r]});continue}var D=$("#"+c).find('input[type="radio"]');if(D.length){D.each(function(){this.value==i[r]&&(this.checked=!0)}),0<$("#"+c).find("input:checked").length&&$("#"+c).removeAttr("error").removeClass("validatebox-tipcolor").css("border","none").siblings("div.errorbox_ipt_help").remove();continue}var T=$("#"+c).find('input[type="checkbox"]');if(T.length){T.each(function(){if(this.checked=!1,i[c]&&i[c]instanceof Array)for(var t in i[r])this.value==i[r][t]&&(this.checked=!0);else this.value==i[r]&&(this.checked=!0)
;this.checked&&$("#"+c).removeAttr("error").removeClass("validatebox-tipcolor").css("border","none").siblings("div.errorbox_ipt_help").remove()});continue}$("#"+c).empty(),$("#"+c).html(i[r])}}}},displayArea:function(t,e){if(e){$("#"+t).show().find("*").each(function(){this.css&&"datebox-f combo-f"!=this.css&&this.show()}),$("#"+t).prev("div.pjf_quanju").show();var i=$("div.datagrid-view",$("#"+t));i.length&&$("div[componenttype='PJF.ui.grid']",i).each(function(){var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);e&&e.resize()})}else $("#"+t).hide(),$("#"+t).prev("div.pjf_quanju").hide();if(PJF.constants.KEYBOARD_ENABLE){var n=this.getComponents(t);for(var o in n)n[o].setAreaKeyBoardFlag({isDisplay:e})}},validateForm:function(t,e,i,n,o,a){if(t){var s,r,c=$("#"+t),l=PJF.constants.FORM_PANEL;$("#formPanel_"+t)[0]||l&&n&&(c.wrap('<div id="formPanel_'+t+'"></div>'),(s=c.parent().prev().find("h2").text())&&c.parent().prev().find("h2").parent().hide()),r=new PJF.ui.panel({
dom:"formPanel_"+t,title:s});var d=c.validform({message:e,invalidROFlag:i,partDoms:o,needErrMsg:a});return d&&r&&r.collapse(),d}return!0},validateFormDiff:function(t,e,i){var n=!0;if(t){var o="",a=$("#"+t),s=PJF.html.getAreaData(t,!0),r={};for(var c in s)for(var l in i)if(c==l){var d,u;if(s[c]instanceof Array&&i[l]instanceof Array)d=s[c].sort().join()!=i[l].sort().join();else{d=s[c].replace(/(\\r\\n)|(\\r)|(\\n)/g,"**_**")!=i[l].replace(/(\\r\\n)|(\\r)|(\\n)/g,"**_**")}if(d){if(a.children())if(0<(u=a.find("[name='"+c+"']")).length){var h,p,f=u.eq(0).parents("li:first").find("label:first");"PJF.ui.dateinput"==(p=(h=u.eq(0).parents("li:first").find("[componentid]").eq(0)).attr("componenttype"))?h=h.siblings("span"):"PJF.ui.dateSpan"==p?h=u.eq(0).parents("span:first"):"PJF.ui.timespinnerSpan"==p?h=u.eq(0).prev("span"):"PJF.ui.buttonInput"==p?h=h.find("[componenttype='PJF.ui.textfield']").eq(0):"PJF.ui.select"==p&&(h.find("span").eq(0).attr("style","border-color: red;"),
(h=h.find("input").eq(0)).attr("style","position: relative; border-color: red;"));var m=f.text();"undefined"==typeof r[m]&&(o+="<li>",o+="<span class='black'>"+f.text()+"</span>输入内容不匹配</li>",r[m]="1"),h.tips&&h.tips.remove(),h.tips=null}}else if(a.children())if(0<(u=a.find("[name='"+c+"']")).length)"PJF.ui.checkbox"==(p=(h=u.eq(0).parents("li:first").find("[componentid]").eq(0)).attr("componenttype"))&&(h.removeClass("validatebox-invalid validatebox-tipcolor error-border"),h.attr("style",""));break}a.attr("alt",o),e=e||"填写内容错误";var g="<div class='pjf_quanju' id='"+a.attr("id")+"_qj'><p>"+resource.GLOBALCHECK_MSG1+"</p><ul class='pjf_global_ul'></ul><div class='pjf_globale_div'>"+e+"</div></div>";if(""!=o){$("#"+a.attr("id")+"_qj");var v=$("#"+a.attr("id")+"_qj").length;0==v&&a.before(g),$("#"+a.attr("id")+"_qj").find(".pjf_global_ul").html(a.attr("alt")).next("div.pjf_globale_div").html(e),$("#"+a.attr("id")+"_qj").width($("#"+a.attr("id")+"_qj").next().width()-100),n=!1
}else 0!=v&&$("#"+a.attr("id")+"_qj").remove(),n=!0}return n},submitForm:function(t){if(t){var e=$("#"+t);e.form("validate")&&e.submit()}},getComponents:function(t){var i=[],n=[],e=$("#"+t);return $("[componentid]",e).each(function(){var t=$(this).attr("autocompleteId")||$(this).attr("componentid");i.push(t);var e=PJF.ui.componentMgr.get(t);e&&n.push(e)}),n},goToPerformanceForDisable:function(t,e){var i,n=$("#"+t);e?($("[componentid]",n).each(function(){(i=PJF.ui.componentMgr.get($(this).attr("componentid"))).disable instanceof Function&&i.disable()}),$("input,textarea",n).each(function(){var t=$(this);$(this).removeClass("validatebox-tipcolor error-border warnbox-tipcolor warn-border"),t.parent().is("span")&&(t.parent().removeClass("validatebox-tipcolor error-border warnbox-tipcolor warn-border"),t.siblings("span.point_box").removeClass("validatebox-spanicon warnbox-spanicon")),$(this).next(".warnbox_ipt_help").remove(),$(this).next(".errorbox_ipt_help").remove()
})):$("[componentid]",n).each(function(){(i=PJF.ui.componentMgr.get($(this).attr("componentid"))).enable instanceof Function&&i.enable(),$("input,textarea",n).each(function(){var t=$(this).parent();(t.is("span.validatebox-textBox")||t.is("span.combo"))&&$(this).parent().removeClass("pjf_disabled_input").end().css("border-width","0")})})},goToOriginalDisable:function(t,e){var i=$("#"+t);if(e?($("select",i).each(function(){$(this).attr("disabled","disabled")}),i.find(".pjf_single_span").each(function(){var t=$(this).attr("id");$("#"+t).die("click")}),i.find(".pjf_orgText").each(function(){var t=$(this).attr("componentId");PJF.ui.componentMgr.get(t).disable()}),$("input,textarea",i).each(function(){this.disabled="disabled";var t=$(this);t.addClass("pjf_disabled_input");var e=t.parent();(e.is("span.validatebox-textBox")||e.is("span.combo"))&&t.parent().addClass("pjf_disabled_input").end().css("border-width","0"),
$(this).removeClass("validatebox-tipcolor error-border warnbox-tipcolor warn-border"),t.parent().is("span")&&(t.parent().removeClass("validatebox-tipcolor error-border warnbox-tipcolor warn-border"),t.siblings("span.point_box").removeClass("validatebox-spanicon warnbox-spanicon")),$(this).next(".warnbox_ipt_help").remove(),$(this).next(".errorbox_ipt_help").remove()}),i.find(".combo-arrow").unbind("click").unbind("mouseenter").unbind("mouseleave"),i.find(".spinner-arrow-up").unbind("click").unbind("mouseenter").unbind("mouseleave"),i.find(".spinner-arrow-down").unbind("click").unbind("mouseenter").unbind("mouseleave"),i.find(".validatebox-checkbox").removeClass("validatebox-tipcolor").css("border","none"),i.find(".validatebox-checkbox").attr("disabled","disabled")):($("select",i).each(function(){$(this).removeAttr("disabled","disabled")}),i.find(".pjf_orgText").each(function(){var t=$(this).attr("componentId");PJF.ui.componentMgr.get(t).enable()}),
i.find(".pjf_single_span").each(function(){var t=$(this).attr("id");$("#"+t).siblings("input").removeAttr("disabled").removeClass("pjf_disabled_input"),$("#"+t).live("click",function(){PJF.constants.KEYBOARD_ENABLE?$(this).siblings("input").trigger("click"):$(this).siblings("input").trigger("focus")})}),$("input,textarea",i).each(function(){this.disabled="",$(this).removeClass("pjf_disabled_input");var t=$(this).parent();(t.is("span.validatebox-textBox")||t.is("span.combo"))&&$(this).parent().removeClass("pjf_disabled_input").end().css("border-width","0")}),i.find(".datebox-f").each(function(){$("#"+this.id).datebox("enable")}),i.find(".datetimebox-f").each(function(){$("#"+this.id).datetimebox("enable")}),i.find(".spinner-text").each(function(){$("#"+this.id).timespinner("enable")}),i.find(".validatebox-checkbox").removeAttr("disabled")),PJF.constants.KEYBOARD_ENABLE){var n=this.getComponents(t);for(var o in n)n[o].setAreaKeyBoardFlag({isDisable:e})}},disableArea:function(t,e){
var i=!0;2==arguments.length&&(i=e),this.goToOriginalDisable(t,i)},goToPerformanceForReadOnly:function(t,e){var i,n=$("#"+t);e?$("[componentid]",n).each(function(){(i=PJF.ui.componentMgr.get($(this).attr("componentid"))).setReadOnly&&i.setReadOnly(!0)}):$("[componentid]",n).each(function(){(i=PJF.ui.componentMgr.get($(this).attr("componentid"))).setReadOnly&&i.setReadOnly(!1)})},goToOriginalForReadOnly:function(t,e){var i=$("#"+t);if(e?(i.find(".pjf_select_input").each(function(){var t=$(this).siblings("select").attr("componentId");t||(t=$(this).parent().attr("componentId")),PJF.ui.componentMgr.get(t).setReadOnly(!0)}),i.find(".pjf_orgText").each(function(){var t=$(this).attr("componentId");PJF.ui.componentMgr.get(t).setReadOnly(!0)}),$("input,textarea",i).each(function(){this.readOnly="true";var t=$(this).parent();$(this).addClass("pjf_readonly_input"),(t.is("span.validatebox-textBox")||t.is("span.combo"))&&$(this).parent().addClass("pjf_readonly_input").end().css("border-width","0"),
i.find(".combo-arrow").unbind("click").unbind("mouseenter").unbind("mouseleave"),i.find(".spinner-arrow-up").unbind("click").unbind("mouseenter").unbind("mouseleave"),i.find(".spinner-arrow-down").unbind("click").unbind("mouseenter").unbind("mouseleave"),i.find(".datebox-f").next().children("input").unbind("keydown.combo")}),$('input[type="checkbox"],input[type="radio"]',i).each(function(){this.onclick=function(){return!1},$(this).closest("span").addClass("pjf_readonly_input")})):(i.find(".pjf_select_input").each(function(){var t=$(this).siblings("select").attr("componentId");t||(t=$(this).parent().attr("componentId")),PJF.ui.componentMgr.get(t).setReadOnly(!1)}),i.find(".pjf_orgText").each(function(){var t=$(this).attr("componentId");PJF.ui.componentMgr.get(t).setReadOnly(!1)}),$("input,textarea",i).each(function(){null==this.className.match(new RegExp("(\\s|^)pjf_select(\\s|$)"))&&(this.readOnly=""),"readonly"==$(this).attr("readFlag")&&(this.readOnly="true");var t=$(this).parent()
;$(this).removeClass("pjf_readonly_input"),(t.is("span.validatebox-textBox")||t.is("span.combo"))&&$(this).parent().removeClass("pjf_readonly_input").end().css("border-width","0"),i.find(".datebox-f").each(function(){$("#"+this.id).datebox("enable")}),i.find(".datetimebox-f").each(function(){$("#"+this.id).datetimebox("enable")}),i.find(".spinner-text").each(function(){$("#"+this.id).timespinner("enable")})}),$('input[type="checkbox"],input[type="radio"]',i).each(function(){this.onclick=function(){return!0},$(this).closest("span").removeClass("pjf_readonly_input")})),PJF.constants.KEYBOARD_ENABLE){var n=this.getComponents(t);for(var o in n)n[o].setAreaKeyBoardFlag({isReadonly:e})}},readOnlyArea:function(t,e){var i=!0;2==arguments.length&&(i=e),this.goToOriginalForReadOnly(t,i)},clearForm:function(t){if(t){var e=$("#"+t);$("input,select,textarea",e).each(function(){var t=this.type,e=this.tagName.toLowerCase()
;if("disabled"!=$(this).attr("disabled"))if("text"==t||"hidden"==t||"password"==t||"textarea"==e)this.value="","dccMoney"==$(this).attr("datatype")&&$(this).attr("componentid")&&($(this).attr("componentid"),PJF.ui.componentMgr.get($(this).attr("componentid")).dccVal="");else if("file"==t){var i=$(this);i.after(i.clone().val("")),i.remove()}else"checkbox"==t||"radio"==t?this.checked=!1:"select"==e&&(this.selectedIndex=-1)}),e.find("li").find("input:not('.pjfcheckbox-input'),select,textarea,span").removeClass("validatebox-tipcolor validatebox-invalid warnbox-tipcolor error-border warn-border focus-border-select-error"),e.find("li").find("span.point_box").removeClass("validatebox-spanicon warnbox-spanicon"),e.find("li").find("input,select,textarea,span").filter(".invalid_box").addClass("validatebox-invalid"),e.find("li span.validatebox-checkbox").css("border-width","0px"),e.find("li").find(".errorbox_ipt_help,.warnbox_ipt_help").remove(),$(".pjf_quanju").remove(),
e.find("select").each(function(){if("disabled"!=$(this).attr("disabled")){for(var t=0;t<this.options.length;t++)this.options[t].removeAttribute("selected");this.options[0]&&(this.options[0].selected=!0),$(this).siblings("input.pjf_select").val($(this).find("option:selected").text()),$(this).attr("addDivFlag","addDivFlag")}})}},getDom:function(t){return $("#"+t)[0]},getOpener:function(){return window.top.opener?self!=top&&window.top.document.getElementById("proxyFrame")?window.top.window.opener.document.getElementById("proxyFrame")?window.top.window.opener.frames[0]:window.top.window.opener:window.opener:null},bodyReady:function(){var e,d;return function(c,l){e||(!(e=!0)===PJF.constants.IS_ENABLE_RIGHT_CLICK&&(document.onmousedown=function(t){if(2==(t=t||event).button){var e=t.srcElement||t.target;"text"==e.type||"textarea"==e.type?document.oncontextmenu=new Function("return true;"):document.oncontextmenu=new Function("return false;")}},document.oncontextmenu=function(){return!1}),
$.browser.safari&&(window.onresize=function(){var t=document.body.scrollTop;window.scrollTo(0,t-2),window.scrollTo(0,t+2),window.scrollTo(0,t),window.scrollTo(0,t-2),window.scrollTo(0,t+2),window.scrollTo(0,t)}),PJF.constants.KEYBOARD_ENABLE&&PJF.communication.client.customKeyboard());var t=function(){if(!d){d=!0;var t=$('script[type="text/delayPJFScript"]');if(0<t.length)for(var e=0,i=t.length;e<i;e++){var n=t[e].innerText;try{$.globalEval(n)}catch(r){console.log("lazy load error :"+r.message)}}$.messager.defaults={ok:resource.MESSAGER_DEFAULTS_OK,cancel:resource.MESSAGER_DEFAULTS_CANCEL},PJF.validator.expand({});try{PJF.html.populatePJFInfo()}catch(r){console.log("PJF.html.populatePJFInfo出错:"+r.message)}PJF.constants.WATER_MARK&&PJF.util.isExist("PJF.userInfo.userName")&&PJF.util.isExist("PJF.userInfo.userCode")&&$.browser.safari&&PJF.util.sign({padding:30,str:PJF.userInfo.userName+"\n"+PJF.userInfo.userCode}),PJF.html.showFuncEvaluation(),PJF.html.showKHTSJ(),
PJF.communication.client.customKeyboard()}var o=(new Date).getTime(),a=PJF.html.getUrlParam("menuId")||"";function s(){console.info("开始执行bodyReady"),c(),console.info(a+"应用bodyReady 函数执行花费时间 : "+((new Date).getTime()-o)),console.info("PJF bodyReady 执行完毕!"),l&&PJF.util.activeKeyScope(l)}"true"==PJF.html.getUrlParam("_PJF_delay_bodyready")?setTimeout(s,0):"true"!=PJF.html.getUrlParam("_PJF_IN_EUP")||!window.opener&&top===window||PJF.communication.client.isInP2()?s():PJF.eup.init(s)};PJF.constants.IS_BSLOGIN_MODEL&&top!=self?$(document).ready(t):$(window).load(t)}}(),empty:function(t){$("#"+t).empty()},remove:function(t){$("#"+t).remove()},content:function(t,e){$("#"+t).html(e)},append:function(t,e){$("#"+t).append(e)},template:function(t,e){return $.templates(t).render(e)},getTemplate:function(t){var e=document.getElementById(t),i=$.data(e,"templateObj");if(!i){var n=e.innerHTML||e.text;n&&(n=n.replace(/&gt;/g,">").replace(/&lt;/g,"<")),i=$.templates(n),$.data(e,"templateObj",i)}return i
},render:function(t,e,i){if(t){"string"==typeof t&&(t=PJF.html.getTemplate(t));var n=t.render(e);return i&&$("#"+i).html(n),n}},renderDomTemplate:function(t,e){return PJF.html.render(t,e,t)},addTag:function(t,e){var i={};i[t]=e,$.views.tags(i)},addConverter:function(t,e){var i={};i[t]=e,$.views.converters(i)},addHelper:function(t,e){var i={};i[t]=e,$.views.helpers(i)},addClass:function(t,e){$("#"+t).addClass(e)},removeClass:function(t,e){$("#"+t).removeClass(e)},getClassDoms:function(t){var e=[];return $("."+t).each(function(){e.push(this)}),e},bindEvent:function(t,e,i){$(t).bind(e,i)},unbindEvent:function(t,e){$(t).unbind(e)},openWin:function(t,e,i){var n,o;(t=PJF.i18n.addUrli18n(t),t=PJF.util.addUrlAppParams(t),t=PJF.util.addAtchBtchNoToUrl(t),PJF.communication.client.isInP2())&&(top.frames[0]&&!$.browser.safari&&(t=(""===(n=function(t){var e=top.frames[0].document.createElement("a");return e.href=t,e.href})("")?function(t){var e=top.frames[0].document.createElement("div")
;return e.innerHTML='<a href="'+t.replace(/"/g,"%22")+'"/>',e.firstChild.href}:n)(t)));if(PJF.communication.client.isInP2())try{o=i?PJF.communication.client.openInnerWindow(t,i):PJF.communication.client.openInnerWindow(t)}catch(a){alert(resource.OPENINNERWINDOW_FAILURE+":"+a),o=window.open(t)}else o=i?window.open(t,i):window.open(t);return!PJF.communication.client.isInP2()||o&&"0"!==o[0]||PJF.communication.client.setTabTitle(e),o},resetLay:function(){$(".pjf_ul_two , .pjf_content , .div_ulbox , .pjf_content_three").addClass("clearfix")},trigger:function(t,e){$("#"+t).trigger(e)},getAreaChecked:function(t){var e=[];return $("#"+t).find("input:checked").each(function(){e.push(this)}),e},addFormParam:function(t,e){for(var i in"string"==typeof t&&(t=$("#"+t)),e){var n=t.find("input[name='"+i+"']");0==n.length&&t.append(n=$("<input name='"+i+"' type = 'hidden'></input>")),n.val(e[i]||"")}},upload:function(formId,callBack,needUserInfo){var setting={};"object"==typeof formId&&(setting=formId,
formId=setting.formId,callBack=setting.callBack,needUserInfo=setting.needUserInfo);var formJq=$("#"+formId),action=formJq.attr("action"),inputJq=formJq.find("input[name='jsonData']");0==inputJq.length&&(action&&-1!==action.indexOf("ecpJson")||needUserInfo&&PJF.communication.client.isInP2())&&(inputJq=$('<input type="hidden" name="jsonData">'),$("#"+formId).append(inputJq));var jsonData=inputJq.val(),loading;if("string"==typeof jsonData)try{jsonData=eval("("+jsonData+")")}catch(e){jsonData={}}if(needUserInfo&&PJF.communication.client.isInP2()){var info={};PJF.communication.addParam(info),PJF.apply(jsonData,info),formJq.find("input[name='jsonData']").val(PJF.util.json2str(jsonData))}if(0<inputJq.length){var token=PJF.util.getLoginToken(),jsonData=formJq.find("input[name='jsonData']").val(),uNo;if(PJF.communication.client.isInP2()){var uuid=PJF.communication.client.getUniqueNo();"array"==PJF.util.getType(uuid)&&0==uuid[0]&&(uNo=uuid[1])}try{jsonData=jsonData?eval("("+jsonData+")"):{},
token&&(jsonData._login_tk=token),uNo&&(jsonData.ATCH_BTCH_NO=uNo),formJq.find("input[name='jsonData']").val(JSON.stringify(jsonData))}catch(e){console.info("html upload添加login token失败:"+e.message)}}if(PJF.communication.client.isInP2()&&PJF.util.getValue(window,"PJF.userInfo.userCode")){var jsonData=formJq.find("input[name='jsonData']").val();jsonData&&(PJF.html.addFormParam(formJq,{_terminal_type:PJF.constants.termType,OPER_CODE:PJF.util.getValue(window,"PJF.userInfo.userCode")}),PJF.html.addFormParam(formJq,{macData:PJF.communication.client.macContent(jsonData)[1]}))}if(setting.loading){var loadingConf=$.extend({maskBody:!0,text:resource.UPLOAD_MESSAGEBOX_UPLOADING},setting.loading);loading=new PJF.ui.loading(loadingConf)}if($.browser.safari){var form=PJF.html.getDom(formId),formData=new FormData(document.forms.namedItem(formId)),xhr=new XMLHttpRequest;xhr.timeout=3e4,xhr.open("POST",form.action,!0),xhr.onload=function(oEvent){if(destroyLoading(),
4==xhr.readyState&&200==xhr.status)try{var errFlag=0,response=eval("("+this.responseText+")"),errFlag=1;callBack(response)}catch(exception){console.log("上传文件返回处理错误:"+exception.message),0==errFlag?PJF.html.showMsgBox("warning",resource.UPLOAD_MESSAGEBOX_TITLE,resource.UPLOAD_MESSAGEBOX_DATEERR_CONTENT):console.log("上传callback出错")}else PJF.html.showMsgBox("warning",resource.UPLOAD_MESSAGEBOX_TITLE,resource.UPLOAD_MESSAGEBOX_UPLOADERR_CONTENT)},xhr.upload.onprogress=function(){},xhr.onloadend=function(){destroyLoading()},xhr.onerror=function(){destroyLoading(),PJF.html.showMsgBox("warning",resource.UPLOAD_MESSAGEBOX_TITLE,resource.UPLOAD_MESSAGEBOX_UPLOADERR_CONTENT)},xhr.ontimeout=function(){destroyLoading(),PJF.html.showMsgBox("warning",resource.UPLOAD_MESSAGEBOX_TITLE,resource.UPLOAD_MESSAGEBOX_UPLOAD_TIMEOUT)},xhr.send(formData)}else{var pjfFrame=$('<iframe width="0" height="0" id="pjf_upload_frame" name="pjf_upload_frame"/>');pjfFrame.appendTo("body"),
$("#pjf_upload_frame").load(function(){destroyLoading();try{var errFlag=0,response=window.frames.pjf_upload_frame.document.body.innerText;errFlag=1,response=eval("("+response+")"),errFlag=2,callBack(response)}catch(exception){console.log("上传文件返回处理错误:"+exception.message),0==errFlag?PJF.html.showMsgBox("warning",resource.UPLOAD_MESSAGEBOX_TITLE,resource.UPLOAD_MESSAGEBOX_UPLOADERR_CONTENT):1==errFlag?PJF.html.showMsgBox("warning",resource.UPLOAD_MESSAGEBOX_TITLE,resource.UPLOAD_MESSAGEBOX_DATEERR_CONTENT):console.log("上传callback出错")}finally{pjfFrame.remove()}}),PJF.html.getDom(formId).target="pjf_upload_frame",PJF.html.getDom(formId).submit()}function destroyLoading(){loading&&loading.destroy(),loading=null}},download:function(t){t=PJF.util.addAtchBtchNoToUrl(t);var e=!0;if(-1!=t.indexOf("getLocalFile.action")){e=!1;var i=t.replace("getLocalFile.action?","ecpJson.action?_fw_service_id=localFileExists&");PJF.communication.ajax({url:i,async:!1,success:function(t){
t.fileExists?e=!0:PJF.html.showMsgBox("warning",resource.UPLOAD_MESSAGEBOX_TITLE,resource.DOWNLOAD_MESSAGEBOX_DOWNERR_CONTENT)}})}e&&PJF.communication.client.openNativeWindow(PJF.html.toAbsURL(t))},redirect:function(t,e){t=PJF.util.addAtchBtchNoToUrl(t);var i=!0;if(-1!=t.indexOf("getLocalFile.action")){i=!1;var n=t.replace("getLocalFile.action?","ecpJson.action?_fw_service_id=localFileExists&");PJF.communication.ajax({url:n,async:!1,success:function(t){t.fileExists?i=!0:PJF.html.showMsgBox("warning",resource.UPLOAD_MESSAGEBOX_TITLE,resource.DOWNLOAD_MESSAGEBOX_DOWNERR_CONTENT)}})}i&&($.browser.safari&&-1!=t.indexOf("getLocalFile.action")?PJF.communication.client.openNativeWindow(PJF.html.toAbsURL(t)):(location.href=t,window.event.returnValue=!1,e&&PJF.communication.client.isInP2()&&PJF.communication.client.setTabTitle(e)))},getUrlParam:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null},
addUrlParam:function(t,e,n,i){var o=new RegExp("(\\?|&)("+e+"=)([^&]*)(&|$)??","g");if(void 0===n||null==n)return t;if(t.match(o)){if(!1===i)return t;t=t.replace(o,function(t,e,i){return e+i+n})}else t.match(/(.*)\?(.*)/)?t+="&":t+="?",t+=e+"="+n;return t},getCurrentWindow:function(){return top==window?window:top},getViewUrl:function(t){if(t){var e,i,n=PJF.communication.client.encodeUrl(t);if(0==n[0]){e=n[1];var o=PJF.constants.VIEW_PROXY_URL+e,a=PJF.communication.client.encodeUrl(o);return 0==a[0]?(i=a[1],PJF.constants.VIEW_DOC_URL+i):t}return t}return t},closeWin:function(){if(PJF.communication.client.isInP2())try{var t=PJF.communication.client.closeWin();t&&"1"===t[0]&&top.OLD_WINDOW_CLOSE()}catch(e){top.OLD_WINDOW_CLOSE()}else top.close()},loadCss:function(t){$("head").append("<link>"),css=$("head").children(":last"),css.attr({rel:"stylesheet",type:"text/css",href:CONTEXT_PATH+"css/"+t})},documentReady:function(t){t()},populatePJFInfo:function(){
if(PJF.communication.client.isInP2())try{var t=sendNSCommand("getUserInfo");t&&"0"==t[0]&&(t=JSON.parse(t[1]),PJF.userInfo=t.userInfo,PJF.orgInfo=t.orgInfo,PJF.roleInfo=t.roleInfo,PJF.otherInfo=t.otherInfo)}catch(e){alert(resource.SENDNSCOMMAND_CATCH)}else top!=self&&top.PJF&&top.PJF.constants&&top.PJF.constants.IS_BSLOGIN_MODEL?(PJF.userInfo=function(){if(top.PJF_USERINFO)return top.PJF_USERINFO;alert(resource.GETUSERINFO_FAILURE)}(),PJF.orgInfo=function(){if(top.PJF_ORGINFO)return top.PJF_ORGINFO;alert(resource.GETORGINFO_FAILURE)}(),PJF.roleInfo=function(){if(top.PJF_POSITIONINFO)return top.PJF_POSITIONINFO;alert(resource.GETROLEINFO_FAILURE)}(),PJF.otherInfo=function(){if(top.PJF_OTHERINFO)return top.PJF_OTHERINFO;alert(resource.GETOTHERINFO_FAILURE)}()):top==self&&PJF.html.getOpener()&&PJF.html.getOpener().top.PJF&&PJF.html.getOpener().top.PJF.constants.IS_BSLOGIN_MODEL?(PJF.userInfo=function(){if(PJF.html.getOpener().top.PJF_USERINFO)return PJF.html.getOpener().top.PJF_USERINFO
;alert(resource.GETUSERINFO_FAILURE)}(),PJF.orgInfo=function(){if(PJF.html.getOpener().top.PJF_ORGINFO)return PJF.html.getOpener().top.PJF_ORGINFO;alert(resource.GETORGINFO_FAILURE)}(),PJF.roleInfo=function(){if(PJF.html.getOpener().top.PJF_POSITIONINFO)return PJF.html.getOpener().top.PJF_POSITIONINFO;alert(resource.GETROLEINFO_FAILURE)}(),PJF.otherInfo=function(){if(PJF.html.getOpener().top.PJF_OTHERINFO)return PJF.html.getOpener().top.PJF_OTHERINFO;alert(resource.GETOTHERINFO_FAILURE)}()):PJF.constants.IS_DEBUG&&PJF.debug.createClientInfo()},borderFix:function(t){var e=(t=(t=t)?$(t):$("body")).find(".pjf_ul_two");t.find("pjf_ul_title_box");e.each(function(){var t=$(this),n=t.find("li:visible").removeClass("pjf_simpleLine").removeClass("pjf_rowLast").removeClass("pjf_LastLi").css("width","auto"),o=t.width(),a=!1;n.each(function(t){var e=$(this),i=e.width();o/2<i?(e.addClass("pjf_simpleLine").css("width","100%"),a&&e.prev("li").addClass("pjf_simpleLine").css("width","100%"),
a=!1):a?(e.addClass("pjf_rowLast"),a=!1):a=!0,t==n.length-1&&e.addClass("pjf_LastLi")})})},showMsgBox:function(t,e,i){PJF.ui.messageBox?new PJF.ui.messageBox({style:t,title:e,content:i}):new PJF.ui.padMessageBox({icon:t,title:e,message:i}).show()}},PJF.html.toAbsURL=function(){var t=function(t){var e=document.createElement("a");return e.href=t,e.href};return""===t("")?function(t){var e=document.createElement("div");return e.innerHTML='<a href="'+t.replace(/"/g,"%22")+'"/>',e.firstChild.href}:t}(),PJF.apply(PJF.html,{openScanPage:function(t,e){try{console.log("vouscan 打开凭证扫描界面,srcFlag="+t+",data="+PJF.util.json2str(e))}catch(d){}var i=t||"T",n="",o="",a=e.TRANS_TYPE||"",s=e.SPEC_INFO||"",r=e.vchrCnt||"";if("T"==i?n=PJF.otherInfo.seqId:(n=e.SCAN_SEQ_ID,o=e.OPER_CODE||""),n){var c="";e.SCAN_TIPS&&(c=encodeURI(encodeURI(e.SCAN_TIPS))),"A"==i&&e.TRACE_ID&&(c=encodeURI(encodeURI(e.TRACE_ID.substring(e.TRACE_ID.length-7,e.TRACE_ID.length))))
;var l=PJF.constants.VOUSCAN_PAGE_URL+"?srcFlag="+i+"&scanSeqId="+n+"&operCode="+o+"&specInfo="+s+"&vchrCnt="+r+"&scanTips="+c+"&transType="+a;PJF.constants.VOUSCAN_HOST_E2E&&(l=PJF.constants.VOUSCAN_HOST_E2E+l),"T"==i||"N"==i?PJF.html.openWin(l,"流水凭证扫描"):PJF.html.openWin(l,"流水凭证补扫")}else PJF.ui.messageBox({style:"warning",content:"请正确传入参数！"})},vouScanPageDeal:function(t){if(t){var e,i,n,o,a;if(!t.TRACE_ID)return void console.log("vouscan全局跟踪号为空！");if(e=t.TRACE_ID,t.SCAN_SEQ_ID&&undefined!=t.OPR_FL&&null!=t.OPR_FL&&""!=t.OPR_FL&&"1"!=t.OPR_FL){if(n=t.SCAN_SEQ_ID,a=t.FR_SCAN_TYPE,!n||!a){new PJF.ui.messageBox({style:"warning",title:"提示",content:"扫描ID或者扫描模式为空，确定流程继续！"});var s=PJF.html.getScanID(e);n||(n=s.SCAN_SEQ_ID),a||(a=s.SCAN_TYPE_09)}}else if(o=(i=PJF.html.getScanID(e)).CHK_STFF_ID,a=i.SCAN_TYPE_09,t.OPR_FL&&"0"==t.OPR_FL){if(!i.SCAN_SEQ_ID)return void new PJF.ui.errorMessageBox({style:"warning",title:"警告",desc:"获取扫描流水号失败",traceId:i._COMMON&&i._COMMON.SYS_EVT_TRACE_ID||""})
;t.SCAN_SEQ_ID=i.SCAN_SEQ_ID,n=t.SCAN_SEQ_ID}else{if(!i)return;if(i.SCAN_SEQ_ID)t.SCAN_SEQ_ID=i.SCAN_SEQ_ID,n=t.SCAN_SEQ_ID;else if(!t.SCAN_SEQ_ID)return;i.TRANS_CODE&&(t.TRD_SCR_ECD=i.TRANS_CODE),i.OPR_NO&&(t.OPER_CODE=i.OPR_NO),i.MENU_ID&&(t.MENU_ID=i.MENU_ID)}var r=PJF.orgInfo.instLevel1BranchId,c=t.TRD_SCR_ECD,l=t.MENU_ID,d=PJF.html.getScanType(r,c,l,n,t.OPER_CODE?t.OPER_CODE:PJF.userInfo.userId);if(t.OPR_FL&&"0"==t.OPR_FL)if(console.log("result.SCAN_TYPE="+d.SCAN_TYPE+",scanType_09="+a),"FR"==a)if(!d||"0"!=d.RT_CODE&&"1"!=d.RT_CODE)d&&"E"==d.RT_CODE&&new PJF.ui.errorMessageBox({style:"warning",title:"警告",desc:"扫描参数查询失败，["+d.BK_DESC+"]",traceId:d._COMMON&&d._COMMON.SYS_EVT_TRACE_ID||""});else{(u=PJF.html.getTransType(n))&&u.database_result&&(t.TRANS_TYPE=u.database_result.TRANS_TYPE),PJF.html.prepareForOpenScan(t,d.VOUCHER_LST,"0")}else{if("NL"==a)return;new PJF.ui.messageBox({style:"confirm",title:"提示",buttonText:["是","否"],buttonIconCls:["icon-confirm","icon-cancel"],
content:"请确认是否有附件资料需要交后台扫描！",ok:function(){var t={SCAN_SEQ_ID:n};PJF.html.printScanNo(e,t)},cancel:function(){}})}else{try{if(o&&8==o.length)return void new PJF.ui.messageBox({style:"info",title:"提示",content:"复核提交场景，请将凭证资料交由录入人员处理!"})}catch(h){console.log("fh_error:"+e)}var u;if((u=PJF.html.getTransType(n))&&u.database_result){if("RA"==PJF.util.trim(u.database_result.TRANS_TYPE))return;t.TRANS_TYPE=u.database_result.TRANS_TYPE}"FR"==a&&d&&"0"==d.RT_CODE&&PJF.html.prepareForOpenScan(t,d.VOUCHER_LST,"0")}}else console.log("vouscan data is null")},updateBGScanInfo:function(t){var e=!0,i={SCAN_SEQ_ID:t,VCHR_CNT:"999",FR_SCAN_TYPE:"BG",processFlag:"1"};return PJF.communication.cpsJsonReq({url:"/bosWeb/ecpJson.action",fwServiceId:"updateScanInfo",fwTranId:"updateScanInfo",jsonData:PJF.util.json2str(i),async:!1,noRoleTransaction:!0,success:function(t){},failure:function(t){e=!1,new PJF.ui.messageBox({style:"warning",title:"错误提示",content:"后台扫描流水更新失败，请在凭证扫描列表界面中重新打印该笔流水的后台扫描封皮"})}}),e},
prepareForOpenScan:function(t,e,i){var n=t.TRACE_ID;n=n.substring(n.length-7,n.length);var o,a="N";t.TXN_TYPE&&"G"==t.TXN_TYPE?(a="G",o=t.TRACE_ID+"_!_"+t.TXN_DATE):t.TXN_TYPE&&"A"==t.TXN_TYPE?(a="A",o=t.SPEC_INFO):t.VCHR_CNT&&0<parseInt(t.VCHR_CNT)&&(a="Y");var s="";if("0"==i){s="请扫描";var r=PJF.html.getScanTips(t);s+=r&&e?r+","+e+",及其他客户提交的凭证和相关业务资料":r&&!e?r+",及客户提交的凭证、其他相关业务资料":!r&&e?e+",及其他客户提交的凭证和相关业务资料":"客户提交的凭证、其他相关业务资料",s+=","}s+="当笔流水号后7位：["+n+"]";var c={SCAN_SEQ_ID:t.SCAN_SEQ_ID,OPER_CODE:t.OPER_CODE?t.OPER_CODE:PJF.userInfo.userCode,vchrCnt:t.VCHR_CNT?1:0,SPEC_INFO:o,SCAN_TIPS:s,TRANS_TYPE:t.TRANS_TYPE,TRACE_ID:n};PJF.html.openScanPage(a,c)},printScanNo:function(t,e){if(!e||!e.SCAN_SEQ_ID||PJF.html.updateBGScanInfo(e.SCAN_SEQ_ID)){var i={COS_Scan_Seq_NO:t,maxIdx:t.length
},n=t.substring(0,t.length-7),o=i.COS_Scan_Seq_NO.substring(t.length-7,t.length),a="&^178|20|"+o.charAt(0)+"&^181|20|"+o.charAt(1)+"&^184|20|"+o.charAt(2)+"&^187|20|"+o.charAt(3)+"&^190|20|"+o.charAt(4)+"&^193|20|"+o.charAt(5)+"&^196|20|"+o.charAt(6),s="^141|20|"+n+a+"&^90|45|后台凭证扫描&^185|90|9 9 8 4";if(e&&e.TRANS_DATE){var r=e.TRANS_DATE,c=PJF.communication.getServerTime();if(c||(c=PJF.util.formatDate(new Date)),r!=c)s="^141|20|"+n+a+"&^20|90|"+(r.substr(0,4)+"年"+r.substr(4,2)+"月"+r.substr(6,2)+"日")+"&^90|45|后台凭证扫描&^185|90|9 9 8 4"}e&&e.ATT_VCHR_CNT&&(s=s+"&^20|70|附件张数："+e.ATT_VCHR_CNT+" 张");var l=PJF.communication.client.printDoc(s);console.log("vouscan flag:"+l[0]),0!=l[0]?new PJF.ui.messageBox({style:"confirm",title:"提示",buttonText:["重试","取消"],content:"打印机连接不正确，请检查打印机参数配置是否正确，确认后请重试",ok:function(){PJF.html.printScanNo(t,e)},cancel:function(){}}):new PJF.ui.messageBox({style:"success",title:"提示",buttonText:["关闭"],closable:!1,content:"请插入A-1通用机打凭证，打印后台扫描流水号！",ok:function(){try{
PJF.ui.componentMgr.get("scan_attach_div_id")&&PJF.ui.componentMgr.get("scan_attach_div_id").close()}catch(t){}}})}},printTraceId09:function(t,e){new PJF.ui.messageBox({style:"confirm",title:"提示",buttonText:["是","否"],buttonIconCls:["icon-confirm","icon-cancel"],content:"请确认是否有附件资料需要交后台扫描！",ok:function(){PJF.html.printScanNo(t,e)},cancel:function(){}})},getScanType:function(INSID,TRD_SCR_ECD,MENU_ID,scan_seq_id,OPER_CODE){var result={},para={INSID:INSID,TRD_SCR_ECD:TRD_SCR_ECD,MENU_ID:MENU_ID,SCAN_SEQ_ID:scan_seq_id,ORG_CD:PJF.orgInfo.orgCode,OPR_NO:OPER_CODE};if(PJF.constants.VOUSCAN_HOST_E2E){var dealPara=PJF.communication.addParam(para),crossUrl=PJF.constants.VOUSCAN_HOST_E2E+"/bosWeb/ecpJson2Bean.action",ajaxData={_fw_service_id:"scanParamAcquire",jsonData:dealPara,jsonClass:"java.util.Map"};PJF.communication.crossDomainReq({url:crossUrl,data:PJF.util.json2str(ajaxData),success:function(data){var jsonObj={};try{jsonObj=eval("("+data+")")}catch(e){}
"0"==jsonObj.RT_CODE||"1"==jsonObj.RT_CODE?result=jsonObj:result.RT_CODE="E"},failure:function(t){result.RT_CODE="E"}})}else PJF.communication.ajax({url:"ecpJson2Bean.action",async:!1,safe:!0,noRoleTransaction:!0,data:{_fw_service_id:"scanParamAcquire",jsonData:PJF.util.json2str(para),jsonClass:"java.util.Map"},success:function(t){"0"==t.RT_CODE||"1"==t.RT_CODE||(t.RT_CODE="E"),result=t},failure:function(t){t.RT_CODE="E",result=t}});return result},getScanID:function(t){var e={},i={QUERY_TRACE_ID:t};return PJF.communication.cpsJsonReq({jsonData:PJF.util.json2str(i),fwServiceId:"P2SCAN001",fwTranId:"P2SCAN001",noRoleTransaction:!0,maskAll:!0,async:!1,success:function(t){e=t},failure:function(t){e=t}}),e},getTransType:function(scanSeqId){var data={},jsonData={SCAN_SEQ_ID:scanSeqId};if(PJF.constants.VOUSCAN_HOST_E2E){var dealPara=PJF.communication.addParam(jsonData),crossUrl=PJF.constants.VOUSCAN_HOST_E2E+"/bosWeb/ecpJson.action",ajaxData={jsonData:dealPara,transaction_id:"findObject",
_sql_id:"vouScan.scanLogDataQuery",_fw_service_id:"remoteDatabaseTransaction"};PJF.communication.crossDomainReq({url:crossUrl,data:PJF.util.json2str(ajaxData),success:function(responseData){try{var jsonObj=eval("("+responseData+")");data=jsonObj}catch(e){}},failure:function(t){}})}else PJF.communication.ajax({data:{jsonData:PJF.util.json2str(jsonData),transaction_id:"findObject",_sql_id:"vouScan.scanLogDataQuery",_fw_service_id:"remoteDatabaseTransaction"},url:"ecpJson.action",async:!1,safe:!0,noRoleTransaction:!0,maskAll:!0,success:function(t){data=t},failure:function(t){}});return data},getScanTips:function(t){var e=t.PRINT_VOUCHER,i="";if(e)for(var n in e)"02"==e[n].printType||"05"==e[n].printType||e[n].vhcrLvlTpcd||e[n].insertVoucherName&&(i+=e[n].insertVoucherName+"、");return i&&(i=i.substring(0,i.length-1)),i},specTransCodeDeal:function(t){if(t&&9==t.length){if("A0301F016"==t||"A0301F030"==t)return!0;if("A0351"==t.substr(0,5)||"A0401"==t.substr(0,5))return!0}return!1},
scanUpdateRmrk12FR:function(i){try{var t={};if(i&&i.CART_ID)t.CART_ID=i.CART_ID;else{if(!i||!i.TRACE_ID)return void console.log("scanUpdateRmrk12FR方法传入数据不正确");t.TRACE_ID=i.TRACE_ID}if(!i||!i.OPR_NO)return void console.log("scanUpdateRmrk12FR方法未传入柜员号");t.OPR_NO=i.OPR_NO,t.SCAN_TYPE="FR",PJF.communication.ajax({data:{jsonData:PJF.util.json2str(t),transaction_id:"update",_sql_id:"journal.updateRmrk1ByTraceId",_fw_service_id:"remoteDatabaseTransaction"},url:"ecpJson.action",async:!1,safe:!0,noRoleTransaction:!0,maskAll:!0,success:function(t){try{console.log((i.TRACE_ID,i.TRACE_ID))}catch(e){}},failure:function(t){try{console.log("更新rmrk1失败:"+PJF.util.json2str(t))}catch(e){}}})}catch(e){}},vouScanJX1119:function(o){if(o&&o.TRACE_ID&&o.SCAN_SEQ_ID){$("#scan_attach_div")&&$("#scan_attach_div").length<1&&$("body").append("<div id='scan_attach_div'></div>");var a=new PJF.ui.window({dom:"scan_attach_div",title:"附件清点",id:"scan_attach_div_id",width:500,height:200,
url:"/bosWeb/page/cost/vouScan/comm/attachInputWin.jsp",onLoad:function(){var n=new PJF.ui.textfield({dom:"ATT_VCHR_CNT",required:!0,validType:["length[0,5]","number"],invalidMessage:["长度为五的数字","长度为五的数字"]}),t={SCAN_SEQ_ID:o.SCAN_SEQ_ID};PJF.communication.ajax({data:{jsonData:PJF.util.json2str(t),transaction_id:"findObject",_sql_id:"journal.getAttVchrCnt",_fw_service_id:"remoteDatabaseTransaction"},url:"ecpJson.action",async:!1,safe:!0,noRoleTransaction:!0,maskAll:!0,success:function(t){try{o.ATT_VCHR_CNT=t.database_result.ATT_VCHR_CNT}catch(e){}},failure:function(t){}}),o.ATT_VCHR_CNT?n.setValue(o.ATT_VCHR_CNT):n.setValue("0"),new PJF.ui.linkButton({dom:"btnConfirm_scan",name:"确定",onclick:function(){if(!PJF.html.validateForm("InputArea"))return!1;var t={SCAN_SEQ_ID:o.SCAN_SEQ_ID,ATT_VCHR_CNT:n.getValue(),VCHR_CNT:"999",FR_SCAN_TYPE:"BG",processFlag:"1"};if(PJF.communication.cpsJsonReq({url:"/bosWeb/ecpJson.action",fwServiceId:"updateScanInfo",fwTranId:"updateScanInfo",
jsonData:PJF.util.json2str(t),noRoleTransaction:!0,async:!1,success:function(t){o.PPR_VCHR_CNT&&0<parseInt(o.PPR_VCHR_CNT)&&new PJF.ui.messageBox({style:"info",title:"提示",content:"附件张数清点成功！",fn:function(){a.close();try{"object"==typeof queryResultGrid&&queryResultGrid.refresh()}catch(t){}}})},failure:function(t){new PJF.ui.messageBox({style:"warning",title:"错误提示",content:"后台扫描流水更新失败，请在凭证扫描列表界面中重新进行附件清点"})}}),o.PPR_VCHR_CNT&&0<parseInt(o.PPR_VCHR_CNT));else{if(0<parseInt(n.getValue())){var e={ATT_VCHR_CNT:n.getValue()};PJF.html.printScanNo(o.TRACE_ID,e)}else new PJF.ui.messageBox({style:"info",title:"提示",content:"附件张数清点成功！",fn:function(){a.close()}});try{"object"==typeof queryResultGrid&&queryResultGrid.refresh()}catch(i){}}}}),new PJF.ui.linkButton({dom:"btnCancel_scan",name:"取消",onclick:function(){a.close()}})}})}else new PJF.ui.messageBox({style:"warning",title:"提示",content:"传入参数缺失，请联系系统管理员!"})},getScanBtnInfo:function(o){if(o&&o.TRACE_ID){var a={flag:0},s=null,t={
QUERY_TRACE_ID:o.TRACE_ID},e={transaction_id:"P2ECP9993",_fw_service_id:"P2ECP9993",jsonData:PJF.util.json2str(t)};return PJF.communication.ajax({url:"ecpJson.action",data:e,async:!1,safe:!0,noRoleTransaction:!0,success:function(t){if(!t||!t.BK_RESULT)return a;if(!(s=t.BK_RESULT).strDt||s.strDt.substring(0,10).replace(/-/g,"")!=PJF.communication.getServerTime())return console.log("非当日或者流水数据查询不存在，直接返回"),a;if("FR"==s.frScanType||"RA"==PJF.util.trim(s.transType)||o.transType&&"CA"==o.transType){if(s.vchrCnt&&"0"!=s.vchrCnt&&0!==s.vchrCnt&&(!o.transType||"CA"!=o.transType))return a;a.flag=1,a.btnType="FR",a.btnName="凭证扫描"}else{if("CB"==PJF.util.trim(s.transType)||"CS"==PJF.util.trim(s.transType)||"NL"==s.frScanType)return a;if("360000000"==PJF.orgInfo.instLevel1BranchId)PJF.constants.VOUSCAN_HOST_E2E||(a.flag=1,a.btnType="QD",a.btnName="附件清点");else if("BG"==s.frScanType||"BA"==s.frScanType||"NO"==s.frScanType){if(s.pprVchrCnt&&0<parseInt(s.pprVchrCnt))return a.flag=2,a.btnType="BG",
a.btnName="后台扫描",a.btnFunc=function(){},a;a.flag=1,a.btnType="XD",a.btnName="流水号选打"}}},failure:function(t){return new PJF.ui.messageBox({style:"warning",title:"提示",content:"根据交易流水判定扫描模式请求失败！"}),a}}),a.btnFunc=function(){if("FR"==a.btnType)if("RA"==PJF.util.trim(s.transType)||o.transType&&"CA"==o.transType){var t={SCAN_SEQ_ID:s.scanSeqID,OPER_CODE:PJF.userInfo.userCode,SPEC_INFO:s.specInfo||"",vchrCnt:s.vchrCnt?"1":"0",TRACE_ID:o.TRACE_ID};PJF.html.openScanPage("A",t)}else{var e=PJF.html.getScanType(PJF.orgInfo.orgCode,s.sysTxCode,s.menuId,s.scanSeqID,PJF.userInfo.userCode),i={TRACE_ID:o.TRACE_ID,SCAN_SEQ_ID:s.scanSeqID,PRINT_VOUCHER:o.PRINT_VOUCHER,TRANS_TYPE:s.transType};PJF.html.prepareForOpenScan(i,e.VOUCHER_LST,"0")}else if("QD"==a.btnType){var n={TRACE_ID:o.TRACE_ID,SCAN_SEQ_ID:s.scanSeqID,ATT_VCHR_CNT:s.attVchrCnt,PPR_VCHR_CNT:s.pprVchrCnt};PJF.html.vouScanJX1119(n)}else"XD"==a.btnType&&new PJF.ui.messageBox({style:"confirm",title:"提示",buttonText:["是","否"],
buttonIconCls:["icon-confirm","icon-cancel"],content:"请确认是否有附件资料需要交后台扫描！",ok:function(){var t={SCAN_SEQ_ID:s.scanSeqID};PJF.html.printScanNo(o.TRACE_ID,t)},cancel:function(){}})},a}console.log("getScanBtnInfo方法参数不正确")}}),PJF.namespace("PJF.lylx.constants"),PJF.lylx.constants.LYLX_SUFFIX=".flv",PJF.lylx.constants.LYLX_HS_WIN="/bosWeb/page/common/lylx/LylxHSWin.jsp",PJF.lylx.constants.LYLX_TIPS_WIN="/bosWeb/page/common/lylx/LylxChooseWin.html",PJF.lylx.constants.LYLX_BANDING_WIN="/bosWeb/page/common/lylx/LylxBandingWin.html",PJF.lylx.constants.LYLX_FILE_TMP_PATH="D:\\CCB\\ECP\\Temp\\lylx\\",PJF.lylx.constants.LYLX_RECORD_FLAG=!1,PJF.apply(PJF.html,{lylxEntrance:function(e){if(!PJF.constants.VOUSCAN_HOST_E2E){var i=!1,t={INSID:PJF.orgInfo.orgCode,PARENT_INSID:PJF.orgInfo.parentOrgCode,LVL1_INSID:PJF.orgInfo.instLevel1BranchId};if(PJF.communication.cpsJsonReq({url:"/bosWeb/ecpJson.action",fwServiceId:"CheckOrgSwParam",fwTranId:"CheckOrgSwParam",jsonData:PJF.util.json2str(t),async:!1,
noRoleTransaction:!0,success:function(t){"Y"==t.RLST_FLAG&&(i=!0),e&&e.SPEC_FALG&&"Y"!=t.SPEC_FLAG&&(i=!1)},failure:function(t){}}),!i)return void(e&&e.APP_FUNC&&e.APP_FUNC())}try{var n=PJF.communication.client.fileUtils("isExist",PJF.lylx.constants.LYLX_FILE_TMP_PATH),o=!1;"0"==n[0]&&"true"==n[1]&&(o=!0),o||PJF.communication.client.fileUtils("createDir",PJF.lylx.constants.LYLX_FILE_TMP_PATH)}catch(a){return void new PJF.ui.messageBox({style:"info",closable:!1,title:"双录提示",content:"双录影音文件存放目录检查异常，请联系分行技术人员！",fn:function(){PJF.communication.client.tabClose(!1)}})}if(e&&e.BEFORE_FLAG)return PJF.lylx.constants.LYLX_FILE_NM=PJF.html.lylxGenP9FileNm(),void PJF.html.lylxRecordFn();$("#lylx_tips_div")&&$("#lylx_tips_div").length<1&&$("body").append("<div id='lylx_tips_div'></div>"),PJF.lylx.TIPSWIN=new PJF.ui.window({dom:"lylx_tips_div",title:"双录提示",id:"lylx_tips_div",width:320,height:180,closable:!1,url:PJF.lylx.constants.LYLX_TIPS_WIN,cache:!1,onLoad:function(){new PJF.ui.linkButton({
dom:"recordBtn",name:"录制",onclick:function(){PJF.lylx.constants.LYLX_FILE_NM=PJF.html.lylxGenP9FileNm(),PJF.lylx.constants.LYLX_STAT="FQ",PJF.html.lylxRecordFn(),PJF.lylx.TIPSWIN.close(),PJF.html.lylxHSWinFn(e)}}),new PJF.ui.linkButton({dom:"bandingBtn",name:"绑定",onclick:function(){var t;e?(e.BAND_STAT="JYZ",t=PJF.html.lylxBandingFn(e)):t=PJF.html.lylxBandingFn({BAND_STAT:"JYZ"}),t&&PJF.lylx.TIPSWIN.close()}}),new PJF.ui.linkButton({dom:"cancelBtn",name:"取消",onclick:function(){new PJF.ui.messageBox({style:"confirm",title:"提示",buttonText:["确认","返回"],buttonIconCls:["icon-confirm","icon-cancel"],content:"取消请谨慎：确认取消后交易界面会自动关闭！",ok:function(){PJF.communication.client.tabClose(!1)},cancel:function(){}})}})}})},aclickKMFn:function(){try{var t=PJF.lylx.constants.hsSelObj.getValue();if(t){var e=PJF.communication.client.getIPByRouteId("klm")
;"DF001"===PJF.orgInfo.instSvrlLgPsnID?e+="klm/page/os/osknowledge/osKnowledgeDetail.jsp?kwId="+t:e+="klm/page/knowledge/showKnowledge/knowledgeDetail.jsp?kwId="+t}PJF.html.openWin(e,"双录话术-"+t)}catch(i){console.log("打开知识库话术界面失败")}},lylxHSWinFn:function(param){$("#lylx_hs_div")&&$("#lylx_hs_div").length<1&&$("body").append("<div id='lylx_hs_div'></div>"),PJF.lylx.HSWindow=new PJF.ui.window({dom:"lylx_hs_div",title:"双录话术",id:"lylx_hs_div",width:400,height:200,closable:!1,url:PJF.lylx.constants.LYLX_HS_WIN,cache:!1,onLoad:function(){try{PJF.html.displayArea("HSINFO",!1),PJF.lylx.constants.hsSelObj=new PJF.ui.select({dom:"hsSelect",onChange:function(){PJF.html.content("kmId_a",PJF.lylx.constants.hsSelObj.getValue())}}),$("#kmId_a").attr("onclick","PJF.html.aclickKMFn();");var inMenuId=undefined;if(param&&param.L_MENU_ID&&(inMenuId=param.L_MENU_ID),inMenuId||PJF.html.getUrlParam("menuId")){var para={LVL1_INSID:PJF.orgInfo.instLevel1BranchId,MENU_ID:PJF.html.getUrlParam("menuId")}
;inMenuId&&(para.MENU_ID=inMenuId);var dealPara=PJF.communication.addParam(para),crossUrl=PJF.communication.client.getIPByRouteId("DSE")+"bosWeb/ecpJson2Bean.action",ajaxData={_fw_service_id:"LylxGetHSInfo",jsonData:dealPara,jsonClass:"java.util.Map"};PJF.communication.crossDomainReq({url:crossUrl,data:PJF.util.json2str(ajaxData),success:function(data){var jsonObj={};try{jsonObj=eval("("+data+")")}catch(e){}if(jsonObj.LIST&&0<jsonObj.LIST.length){PJF.html.displayArea("HSINFO",!0),PJF.html.displayArea("defaultHS",!1);for(var selectData=[],i=0;i<jsonObj.LIST.length;i++){var ons={};ons.name=jsonObj.LIST[i].KM_ID,ons.desc=jsonObj.LIST[i].HS_NM,selectData.push(ons)}PJF.lylx.constants.hsSelObj.addOptions(selectData),PJF.lylx.constants.hsSelObj.setValue([selectData[0]])}},failure:function(t){console.log("跨域请求获取双录话术信息失败")}})}else console.log("双录话术框未获取到菜单ID")}catch(e){console.log("话术弹框获取分行不同话术操作失败")}new PJF.ui.linkButton({dom:"hsConfirmBtn",name:"完成",iconCls:"icon-ok",onclick:function(){try{
var t=PJF.communication.client.fileUtils("isExist",PJF.lylx.constants.LYLX_FILE_TMP_PATH+PJF.lylx.constants.LYLX_FILE_NM),i=!1;if("0"==t[0]&&"true"==t[1]&&(i=!0),!i)return void new PJF.ui.messageBox({style:"info",closable:!1,title:"双录提示",content:"录音录像未正常点击开始进行录制！",fn:function(){}})}catch(e){}PJF.lylx.constants.LYLX_STAT="HO",PJF.lylx.HSWindow.close(),param&&param.APP_FUNC&&param.APP_FUNC()}}),new PJF.ui.linkButton({dom:"hsRecordBtn",name:"重录",iconCls:"icon-undo",onclick:function(){try{var t=PJF.communication.client.fileUtils("isExist",PJF.lylx.constants.LYLX_FILE_TMP_PATH+PJF.lylx.constants.LYLX_FILE_NM),i=!1;"0"==t[0]&&"true"==t[1]&&(i=!0)}catch(e){}PJF.lylx.constants.LYLX_RECORD_FLAG&&"FQ"==PJF.lylx.constants.LYLX_STAT?i?new PJF.ui.messageBox({style:"confirm",title:"提示",buttonText:["确认","返回"],buttonIconCls:["icon-confirm","icon-cancel"],content:"当前已成功录制，请确认是否重新录制！",ok:function(){PJF.lylx.HSWindow.close(),PJF.lylx.constants.LYLX_STAT="",PJF.lylx.constants.LYLX_RECORD_FLAG=!1,
PJF.html.lylxEntrance(param)},cancel:function(){}}):(PJF.lylx.HSWindow.close(),PJF.lylx.constants.LYLX_STAT="",PJF.lylx.constants.LYLX_RECORD_FLAG=!1,PJF.html.lylxEntrance(param)):new PJF.ui.messageBox({style:"warning",closable:!1,title:"双录提示",content:"前序录制未完成，不允许重录！",fn:function(){}})}}),new PJF.ui.linkButton({dom:"hsPlayBtn",name:"回放",onclick:function(){PJF.lylx.constants.LYLX_RECORD_FLAG&&"FQ"==PJF.lylx.constants.LYLX_STAT&&PJF.lylx.constants.LYLX_RECORD_FLAG?PJF.html.lylxPlayVideo(PJF.lylx.constants.LYLX_FILE_TMP_PATH+PJF.lylx.constants.LYLX_FILE_NM):new PJF.ui.messageBox({style:"warning",closable:!1,title:"双录提示",content:"前序录制未正常完成，无法回放！",fn:function(){}})}})}})},lylxRecordFn:function(){try{var fullPath=PJF.lylx.constants.LYLX_FILE_TMP_PATH+PJF.lylx.constants.LYLX_FILE_NM,inData={devKindId:"dev_camera",interfaceId:"AVPreview"},bizArgs={devTypeId:"dev_camera_by",iFunc:"1",iWinPosX:"300",iWinPosY:"300",iWidth:"400",iHeight:"300",iFps:"10",iKbps:"200",iResolution:"640*480",
strWaterMark:""};bizArgs.strFilePath=fullPath,bizArgs.maxTranTime="20",bizArgs.warningTime="19";try{PJF.communication.client.getDevConfig("dev_dblcamera")&&"2"==eval("("+PJF.communication.client.getDevConfig("dev_dblcamera")+")").type&&(inData.devKindId="dev_dblcamera",inData.interfaceId="DAVPreview",bizArgs.strResolution="640*240",bizArgs.iCameraType="1",bizArgs.iWidth="600",bizArgs.iHeight="225",delete bizArgs.devTypeId,delete bizArgs.iResolution)}catch(e){console.log("双录双摄像头判定失败！")}inData.bizArgs=bizArgs,PJF.communication.client.doubleCamera("recordDouble",PJF.util.json2str(inData),"onLylxRecordError","onLYLXRecordSucc"),console.log("发起双录录制面板，录制文件路径："+fullPath)}catch(e){new PJF.ui.messageBox({style:"info",closable:!1,title:"双录提示",content:"调用双录外设失败，交易将关闭，请联系管理员！错误信息："+e.message,fn:function(){PJF.communication.client.tabClose(!1)}})}},lylxBandingFn:function(n){var o=!1;if(n&&"TLS"==n.BAND_STAT&&n.LYLX_TRACE_ID){if(n.SELECT_DATA.LYLX_TRACE_ID=n.LYLX_TRACE_ID,
delete n.SELECT_DATA.LYLX_FLAG,n.SELECT_DATA.LYLX_TM_LEN&&delete n.SELECT_DATA.LYLX_TM_LEN,delete n.SELECT_DATA.NET_IP_PORT,delete n.SELECT_DATA.SEND_FAIL_DESC,n.SELECT_DATA.LVL1_INSID=PJF.orgInfo.instLevel1BranchId?PJF.orgInfo.instLevel1BranchId:"",n.SELECT_DATA.OPR_NO_TRANS=PJF.userInfo.userCode,n.SELECT_DATA.OPR_NM_TRANS=PJF.userInfo.userName,PJF.constants.VOUSCAN_HOST_E2E){var t=n.SELECT_DATA,e=PJF.communication.addParam(t),i=PJF.constants.VOUSCAN_HOST_E2E+"/bosWeb/ecpJson2Bean.action",a={_fw_service_id:"SaveLylxLogService",jsonData:e,jsonClass:"java.util.Map"};PJF.communication.crossDomainReq({url:i,data:PJF.util.json2str(a),success:function(t){PJF.lylx.constants.LYLX_STAT="LS",new PJF.ui.messageBox({style:"info",title:"提示",closable:!1,content:"双录文件绑定成功！",fn:function(){n.WIN_FUNC&&n.WIN_FUNC(),PJF.lylx.LYLXBANDWIN&&PJF.lylx.LYLXBANDWIN.close(),o=!0}})},failure:function(t){new PJF.ui.messageBox({style:"warning",title:"提示",content:"双录文件绑定失败！"}),
console.log("双录文件"+PJF.lylx.constants.LYLX_FILE_NM+"绑定失败:"+t)}})}else PJF.communication.cpsJsonReq({url:"/bosWeb/ecpJson.action",fwServiceId:"SaveLylxLogService",fwTranId:"SaveLylxLogService",jsonData:PJF.util.json2str(n.SELECT_DATA),async:!1,noRoleTransaction:!0,success:function(t){PJF.lylx.constants.LYLX_STAT="LS",new PJF.ui.messageBox({style:"info",title:"提示",closable:!1,content:"双录文件绑定成功！",fn:function(){n.WIN_FUNC&&n.WIN_FUNC(),PJF.lylx.LYLXBANDWIN&&PJF.lylx.LYLXBANDWIN.close(),o=!0}})},failure:function(t){new PJF.ui.messageBox({style:"warning",title:"提示",content:"双录文件绑定失败！"}),console.log("双录文件"+PJF.lylx.constants.LYLX_FILE_NM+"绑定失败:"+PJF.util.json2str2(t))}});return o}return $("#lylx_banding_div")&&$("#lylx_banding_div").length<1&&$("body").append("<div id='lylx_banding_div'></div>"),PJF.lylx.LYLXBANDWIN=new PJF.ui.window({dom:"lylx_banding_div",title:"录音录像",id:"lylx_banding_div",width:610,height:400,closable:!1,url:PJF.lylx.constants.LYLX_BANDING_WIN,cache:!1,onLoad:function(){
lylxBandGrid=new PJF.ui.grid({dom:"lylxBandGrid",width:580,height:290,rowsPath:"RLST_LIST",singleSelect:!0,columns:[[{title:"",checkbox:!0,align:"center"},{title:"客户姓名",field:"CLIENT_NM",align:"center"},{title:"客户身份证号",field:"CLIENT_ID_NO",align:"center"},{title:"录制人",field:"OPR_NM",align:"center"},{title:"录制时长",field:"LYLX_TM_LEN",align:"center"},{title:"录制日期",field:"LYLX_DATE",align:"center"},{title:"录制时间",field:"LYLX_TIME",align:"center",formatter:function(t,e,i){return t?t.substring(0,2)+":"+t.substring(2,4)+":"+t.substring(4,6):t}},{title:"录像回放",field:"LYLX_FILE_NM",align:"center",formatter:function(t,e,i){return"<div id='btnLylx_"+i+"'></div><script type='text/javascript'>new PJF.ui.linkButton({dom:'btnLylx_"+i+"',style:'assistant',name:'回放',onclick:function(){PJF.html.lylxBandPlay(PJF.lylx.constants.LYLX_FILE_TMP_PATH+'"+t+"','"+t+"','"+e.LYLX_DATE+"');}});<\/script>"}}]]});var t={BAND_FLAG:"NBD",BAND_STAT:"JYZ"};t.INSID=PJF.orgInfo.orgCode,t.DLBX_SGD=n.DLBX_SGD;var e={
_fw_service_id:"LylxLogPageQuery",transaction_id:"LylxLogPageQuery",adapterId:"ecpJson",jsonData:PJF.util.json2str(t)},i={url:PJF.constants.DEFAULT_ACTION,totalPath:"totalCount",pageSize:"10",PageNumberParamName:"currentPageIndex",pageSizeParamName:"pageSize",queryParams:e};PJF.constants.VOUSCAN_HOST_E2E&&(i.url=PJF.constants.VOUSCAN_HOST_E2E+"/bosWeb/ecpJson2Bean.action",i.crossDomain=!0),lylxBandGrid.setRequestOptions(i,!1),lylxBandGrid.resize(),new PJF.ui.linkButton({dom:"lylxBandBtn",name:"确定",onclick:function(){var t=lylxBandGrid.getSelected();t?n&&"JYZ"==n.BAND_STAT?(PJF.lylx.constants.LYLX_FILE_NM=t.LYLX_FILE_NM,PJF.lylx.constants.LYLX_STAT="FQ",new PJF.ui.messageBox({style:"info",title:"提示",closable:!1,content:"双录文件已绑定，交易成功后生效！",fn:function(){PJF.lylx.LYLXBANDWIN.close(),o=!0,PJF.lylx.TIPSWIN.close(),n&&n.APP_FUNC&&n.APP_FUNC()}})):new PJF.ui.messageBox({style:"warning",title:"提示",content:"双录文件绑定操作参数异常，请重试或者联系系统管理员！"}):new PJF.ui.messageBox({style:"info",title:"提示",
content:"请选中一条待绑定数据"})}}),new PJF.ui.linkButton({dom:"lylxCancelBtn",name:"取消",onclick:function(){PJF.lylx.LYLXBANDWIN.close()}})}}),o},lylxBandPlay:function(t,e,i){try{var n=PJF.communication.client.fileUtils("isExist",t);if("0"==n[0])if("true"==n[1]);else{var o=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","yypsgzh.b.dat","downloadLylx","1",e,i);if(!o||2!=o.length||"0,00"!=o[1].split("|")[0])return void new PJF.ui.messageBox({style:"warning",title:"双录提示",content:"下载播放文件失败，请重试或者联系统管理员："+o[1].split("|")[1]})}}catch(a){}PJF.html.lylxPlayVideo(t)},lylxPlayVideo:function(t){try{var e={devKindId:"dev_camera",interfaceId:"playVideo"},i={devTypeId:"dev_camera_by",iWinPosX:"300",iWinPosY:"300",iWidth:"400",iHeight:"300"};i.strFilePath=t,e.bizArgs=i,PJF.communication.client.doubleCamera("play",PJF.util.json2str(e),"onLylxPlayVideoError")}catch(n){new PJF.ui.messageBox({style:"warning",title:"双录提示",content:"播放异常，错误信息："+n.message})}},lylxGenP9FileNm:function(){
var t="lylx_"+PJF.html.lylxGetSysDate()+PJF.orgInfo.orgCode+PJF.userInfo.userCode,e=(new Date).getTime()+"";return(t+=e.substr(e.length-9,6))+PJF.lylx.constants.LYLX_SUFFIX},lylxGetSysDate:function(){var t=PJF.communication.getServerTime();return t&&8==t.length?t:t=PJF.util.formatDate(new Date)},lylxTransConnect:function(t){if(console.log("lylxTransConnect_传入参数："+PJF.util.json2str(t)),PJF.lylx.constants.LYLX_STAT)if(t)if(PJF.lylx.constants.LYLX_FILE_NM)if(t.LYLX_TRACE_ID)if(t.OPR_NO_TRANS=PJF.userInfo.userCode,t.OPR_NM_TRANS=PJF.userInfo.userName,t.INSID=PJF.orgInfo.orgCode,t.INSID_NAME=PJF.orgInfo.orgCName,t.LVL1_INSID=PJF.orgInfo.instLevel1BranchId?PJF.orgInfo.instLevel1BranchId:"",t.LYLX_FILE_NM&&5<t.LYLX_FILE_NM.trim().length||(t.LYLX_FILE_NM=PJF.lylx.constants.LYLX_FILE_NM),PJF.constants.VOUSCAN_HOST_E2E){var e=PJF.communication.addParam(t),i=PJF.constants.VOUSCAN_HOST_E2E+"/bosWeb/ecpJson2Bean.action",n={_fw_service_id:"SaveLylxLogService",jsonData:e,jsonClass:"java.util.Map"}
;PJF.communication.crossDomainReq({url:i,data:PJF.util.json2str(n),success:function(t){console.log("双录文件"+PJF.lylx.constants.LYLX_FILE_NM+"流水关联成功!"),PJF.lylx.constants.LYLX_STAT="LS"},failure:function(t){new PJF.ui.messageBox({style:"warning",title:"双录提示",content:"流水关联失败，请联系系统管理员！"}),console.log("双录文件"+PJF.lylx.constants.LYLX_FILE_NM+"关联失败:"+t)}})}else PJF.communication.cpsJsonReq({url:"/bosWeb/ecpJson.action",fwServiceId:"SaveLylxLogService",fwTranId:"SaveLylxLogService",jsonData:PJF.util.json2str(t),async:!1,noRoleTransaction:!0,success:function(t){console.log("双录文件"+PJF.lylx.constants.LYLX_FILE_NM+"流水关联成功!"),PJF.lylx.constants.LYLX_STAT="LS"},failure:function(t){new PJF.ui.messageBox({style:"warning",title:"双录提示",content:"流水关联失败，请联系系统管理员！"}),console.log("双录文件"+PJF.lylx.constants.LYLX_FILE_NM+"关联失败:"+PJF.util.json2str2(t))}});else new PJF.ui.messageBox({style:"warning",title:"双录提示",content:"请求参数中没有双录流水号，无法进行流水关联！"});else new PJF.ui.messageBox({style:"warning",title:"双录提示",
content:"双录未发起，操作非法！"});else new PJF.ui.messageBox({style:"warning",title:"双录提示",content:"请求参数不能为空，无法进行流水关联！"});else console.log("lylxTransConnect_前序动作没完成，不进行关联")}}),PJF.namespace("PJF.communication"),PJF.communication.validateAjaxReqParams=function(t,e){return!0},PJF.communication.prepareAjaxReqParams=function(conf,params){var myData={};conf.data&&(myData="string"==PJF.util.getType(conf.data)?eval("("+conf.data+")"):conf.data,myData.REQ_LANG=myData.REQ_LANG||CLIENT_LANGUAGE),conf.safe&&("string"==PJF.util.getType(myData.jsonData)?myData.jsonData=eval("("+myData.jsonData+")"):myData.jsonData=myData.jsonData||{},PJF.communication.addParam(myData.jsonData),(conf.noRoleTransaction||"noRoleSimpleTransaction"==myData._fw_service_id)&&(myData.jsonData.RL_IDS=[]),myData.jsonData=PJF.util.json2str2(myData.jsonData)),"noRoleSimpleTransaction"==myData._fw_service_id&&(myData._fw_service_id="simpleTransaction"),conf.data=myData,conf.async=!1!==conf.async},
PJF.communication.beforeAjaxReq=function(t,e,i){return!0},PJF.communication.afterAjaxReq=function(t,e,i){return!0},PJF.communication.sendAjaxReq=function(n,t,e){$.ajax({url:n.url,dataType:n.dataType||PJF.constants.AJAX_DATA_TYPE,data:t,async:n.async,traditional:n.traditional,type:n.type||PJF.constants.AJAX_METHOD,headers:n.headers||{},timeout:n.timeOut||PJF.constants.AJAX_TIMEOUT,success:function(t,e,i){n.success(t,e,i)},error:function(t,e,i){console.log(JSON.stringify(t.statusCode())),n.failure?n.failure(t,e,i):"timeout"==e?PJF.configuration.ajaxTimeOut():"parsererror"==e?PJF.configuration.ajaxParseError():PJF.configuration.ajaxFailure()},complete:function(){n.complete&&n.complete(),PJF.communication.afterAjaxReq(n,t,e)}})},PJF.communication.ajax=function(t){var e={};if(!1!==PJF.communication.validateAjaxReqParams(t,e)){var i=PJF.communication.prepareAjaxReqParams(t,e)||t.data;if(!1!==PJF.communication.beforeAjaxReq(t,i,e))return PJF.communication.sendAjaxReq(t,i,e)}},
PJF.communication.validateCPSJsonReqParams=function(t,e){if(!t.fwServiceId||!t.fwTranId||!t.success)return alert("PJF.communication.cpsJsonReq参数不正确!当前参数为:fwServiceId="+t.fwServiceId+",fwTranId="+t.fwTranId+",success="+t.success),!1;PJF.constants.lastTransId=t.fwTranId},PJF.communication.prepareCPSJsonReqParams=function(t,e){return t.pjfReSend?delete t.pjfReSend:PJF.communication.cleanResource(),PJF.communication.ra&&(t.jsonData=PJF.communication.ra.copyRefuseInfo(t.jsonData)),e.copyOfConf=PJF.apply({},t),PJF.communication.setEcpJsonParam(t.fwServiceId,t.fwTranId,t.jsonData,!0,t.encrypt,t.sqlId,t.fmtPrintId,t)},PJF.communication.beforeCPSJsonReq=function(e,i,n){function o(){e.mask?n.ajaxMask=new PJF.ui.loading({dom:e.mask,text:e.loadingText}):e.maskAll&&(n.ajaxMask=new PJF.ui.loading({maskBody:!0,text:e.loadingText}))}var t=e.elecSignParam||{}
;return!t.ootcSign||PJF.communication.elecSign.getTelclrFlag()||PJF.communication.elecSign.canElecSign()?t.fmtPrintId&&PJF.communication.elecSign&&!t.noNeedProtocolSign?(n.copyOfConf.elecSignParam.noNeedProtocolSign=!0,PJF.communication.elecSign.protocolSign({fmtPrintId:t.fmtPrintId,jsonData:e.jsonData,agentName:t.agentName,customerName:t.customerName,onetime:t.onetime,callback:function(t){0==t.status&&(n.copyOfConf.elecSignParam.notConfirm=e.elecSignParam.notConfirm=t.notConfirm||t.notAttnProtocol,n.copyOfConf.elecSignParam.elecSignUploadData=e.elecSignParam.elecSignUploadData=t.uploadProtocolList,o(),PJF.communication.sendCPSJsonReq(e,i,n))}}),!1):(o(),!0):(new PJF.ui.messageBox({style:"warning",title:"警告",content:"系统无法执行交易，请开通互动确认或电子签名开关"}),!1)},PJF.communication.sendCPSJsonReq=function(conf,data,params){var beginTime=(new Date).getTime();return $.ajax({url:conf.url||PJF.constants.DEFAULT_ACTION,dataType:conf.dataType||PJF.constants.AJAX_DATA_TYPE,data:data,
traditional:conf.traditional,async:!1!==conf.async,type:PJF.constants.AJAX_METHOD,timeout:conf.timeOut||PJF.constants.AJAX_TIMEOUT,success:function(data){if(params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=undefined),data)if("string"==typeof data&&(data=eval("("+data+")")),data.BK_STATUS&&data.BK_STATUS==PJF.constants.BK_CODE_SUCCESS){if(data._COMMON&&data._COMMON.P2S_EVT_TRACE_ID&&(PJF.loadResource.PJF_LOAD_RESOURCES_CONF.sysEvtTraceId=data._COMMON.P2S_EVT_TRACE_ID),data.BK_CODE&&(0==data.BK_CODE.indexOf("IOK")||"0"==data.BK_CODE.indexOf("WOK")||"999999999999"==data.BK_CODE)&&PJF.constants.TIP_WARNING&&(PJF.constants.floatDiv?PJF.constants.floatDiv.setMessage(data.BK_DESC):PJF.constants.floatDiv=new PJF.ui.floatDiv({msg:data.BK_DESC})),conf.raTellSuccRst&&conf.raTellSuccRst(data),conf.elecSignParam)return void PJF.communication.afterCpsSucc(conf,data,params);conf.success(data,conf.authUserInfo)
}else data._curr_val_key||data._val_page?(PJF.communication.handleAuthResource(data,params.copyOfConf),PJF.loadResource.PJF_LOAD_RESOURCES_CALLBACK=function(t,e){PJF.communication.cpsJsonReqResend(t,e)}):data._similar_trans_status?PJF.communication.handleSimilarTrans(data,params.copyOfConf):conf.failure(data);else alert("提示：无返回数据！")},error:function(t,e,i){console.log(JSON.stringify(t.statusCode())),params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=undefined),"timeout"==e?PJF.configuration.ajaxTimeOut(conf.failure):"parsererror"==e?PJF.configuration.ajaxParseError(conf.failure):PJF.configuration.ajaxFailure(conf.failure)},complete:function(t,e){params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=undefined),conf.complete&&conf.complete(t,e),console.log("cps ajax共耗时"+((new Date).getTime()-beginTime)+"ms,参数为:"+conf.fwTranId+","+conf.fwServiceId+(conf.sqlId?","+conf.sqlId:"")),PJF.communication.afterCPSJsonReq(conf,data,params)}})},
PJF.communication.afterCpsSucc=function(a,s,t){var r;function c(){if(s.PRINT_VOUCHER_STRING_MAP&&s.needSignFlag){var t=[];for(var e in s.PRINT_VOUCHER_STRING_MAP)s.PRINT_VOUCHER_STRING_MAP[e].paperPrintFlag=!0,s.PRINT_VOUCHER_STRING_MAP[e].confirmNoSign=!0,t.push(e);0<t.length&&PJF.communication.elecSign.uploadSign({CONFIRM_NO_SIGN_DATA:{sysEvtTraceId:r,voucherIDS:t.join(",")}})}a.success(s,a.authUserInfo)}function e(){if(s.PRINT_VOUCHER_STRING_MAP&&s.needSignFlag)if(a.elecSignParam.ootcSignUploadData){a.elecSignParam.ootcSignUploadData.sysEvtTraceId=r;var t=[],e=[];for(var i in s.PRINT_VOUCHER_STRING_MAP)s.PRINT_VOUCHER_STRING_MAP[i].elecSignFlag&&t.push(i),s.PRINT_VOUCHER_STRING_MAP[i].paperPrintFlag&&e.push(i);if(0<t.length||0<e.length){var n;a.elecSignParam.ootcSignUploadData.voucherIDS=t.join(","),0<e.length&&(n={sysEvtTraceId:r,voucherIDS:e.join(",")});var o=a.elecSignParam.ootcSignUploadData.signPicData;PJF.communication.elecSign.uploadSign({
SIGN_DATA:a.elecSignParam.ootcSignUploadData,CONFIRM_NO_SIGN_DATA:n,PRINT_VOUCHER_STRING_MAP:s.PRINT_VOUCHER_STRING_MAP,callback:function(t){if(0==t.status){for(var e in s.PRINT_VOUCHER_STRING_MAP)s.PRINT_VOUCHER_STRING_MAP[e].elecSignFlag&&(s.PRINT_VOUCHER_STRING_MAP[e].elecSignPicBase64=o);a.success(s,a.authUserInfo)}else c()}})}else a.success(s,a.authUserInfo)}else!1===a.elecSignParam.ootcSignUploadData?c():PJF.communication.elecSign.oneTimeSign($.extend({},a.elecSignParam,{data:s,callback:function(){a.success(s,a.authUserInfo)}}));else a.success(s,a.authUserInfo)}s._COMMON&&(r=s._COMMON.P2S_EVT_TRACE_ID||s._COMMON.SYS_EVT_TRACE_ID),PJF.communication.elecSign.canElecSign()?a.elecSignParam.elecSignUploadData?(a.elecSignParam.elecSignUploadData.sysEvtTraceId=r,PJF.communication.elecSign.uploadSign({SIGN_DATA:a.elecSignParam.elecSignUploadData,callback:function(t){2==t.status?c():0==t.status?e():1==t.status&&e()}
})):a.elecSignParam.notConfirm?(a.elecSignParam.notConfirm.sysEvtTraceId=r,PJF.communication.elecSign.uploadSign({CONFIRM_NO_SIGN_DATA:a.elecSignParam.notConfirm,callback:function(t){c()}})):e():c()},PJF.communication.afterCPSJsonReq=function(t,e,i){},PJF.communication.cpsJsonReq=function(t){var e={};if(!1!==PJF.communication.validateCPSJsonReqParams(t,e)){var i=PJF.communication.prepareCPSJsonReqParams(t,e);if(!1!==PJF.communication.beforeCPSJsonReq(t,i,e))return PJF.communication.sendCPSJsonReq(t,i,e)}},PJF.communication.handleSimilarTrans=function(data,copyOfConf){"SUCC"==data._similar_trans_status?new PJF.ui.messageBox({buttonText:["继续交易","取消"],closable:!1,style:"confirm",title:"疑似重复交易",content:data._flow_guide,cancel:function(){PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:"ST"})},ok:function(){if(copyOfConf.atchBtchNo&&PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(copyOfConf.atchBtchNo=uNo[1])}
var tempJsonData=copyOfConf.jsonData;tempJsonData?"string"==typeof tempJsonData&&(tempJsonData=eval("("+tempJsonData+")")):tempJsonData={},"string"!=typeof data._curr_val_no||isNaN(data._curr_val_no)||(data._curr_val_no=parseInt(data._curr_val_no,10)),"number"==typeof data._curr_val_no&&(tempJsonData._curr_val_no=data._curr_val_no+1),copyOfConf.jsonData=PJF.util.json2str(tempJsonData),PJF.communication.cpsJsonReq(copyOfConf)}}):"NOSU"==data._similar_trans_status&&new PJF.ui.messageBox({style:"warning",title:"交易可能重复",content:data._flow_guide,fn:function(){PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:"ST"})}})},PJF.communication.handleAuthResource=function(data,copyOfConf,cancelCallback){PJF.auth._lastAuthData=data,copyOfConf.originalSuccess&&(copyOfConf.success=copyOfConf.originalSuccess,delete copyOfConf.originalSuccess),copyOfConf.originalFailure&&(copyOfConf.failure=copyOfConf.originalFailure,delete copyOfConf.originalFailure),PJF.loadResource.PJF_LOAD_RESOURCES_CONF={},
PJF.apply(PJF.loadResource.PJF_LOAD_RESOURCES_CONF,copyOfConf);var isAjax=!copyOfConf.fwServiceId;if(!isAjax&&copyOfConf.atchBtchNo&&PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(PJF.loadResource.PJF_LOAD_RESOURCES_CONF.atchBtchNo=uNo[1])}var tempJsonData=isAjax?copyOfConf.data.jsonData:copyOfConf.jsonData;tempJsonData?"string"==typeof tempJsonData&&(tempJsonData=eval("("+tempJsonData+")")):tempJsonData={};var ootcData=tempJsonData.ootcData;"IT"==data._curr_val_key&&(tempJsonData._inte_trl_auth=1),"HW"==data._curr_val_key&&(tempJsonData.AUTH_AUDIT_TAG=1),"CP"==data._curr_val_key&&(tempJsonData._customer_pwd_input=1),"number"==typeof data._auth_step_no&&(tempJsonData._auth_step_no=data._auth_step_no+1),"number"==typeof data._curr_val_no&&(tempJsonData._curr_val_no=data._curr_val_no);var valData=data._val_data||{};if("string"==typeof valData&&(valData=eval("("+valData+")")),
"dynamic"==data.AuthCategory&&valData.CCBS_AUTH_CODE&&(tempJsonData.CCBS_AUTH_CODE=valData.CCBS_AUTH_CODE,PJF.communication.client.isInP2()&&(tempJsonData.autherPwd=PJF.communication.client.encrypt0x88(16)[1])),tempJsonData._auth_info=$.extend(!0,{},tempJsonData._auth_info,{AHN_INFOS:[]}),valData.dynAuths){var dynArray=[];for(var i in valData.dynAuths)dynArray.push({AHN_CD:valData.dynAuths[i].authCode});tempJsonData._auth_info.AHN_INFOS=tempJsonData._auth_info.AHN_INFOS.concat(dynArray)}if(tempJsonData=PJF.util.json2str(tempJsonData),isAjax?PJF.loadResource.PJF_LOAD_RESOURCES_CONF.data.jsonData=copyOfConf.data.jsonData=tempJsonData:PJF.loadResource.PJF_LOAD_RESOURCES_CONF.jsonData=copyOfConf.jsonData=tempJsonData,PJF.loadResource._val_msg=data._val_msg,PJF.loadResource.PJF_LOAD_RESOURCES_CONF.fwTranId=isAjax?copyOfConf.data.transaction_id:copyOfConf.fwTranId,PJF.loadResource.AUTH_SERVER_RTDATA=data,PJF.loadResource.AUTH_VAL_DATA=valData,
valData._red_columns)for(var i in valData._red_columns){var domId=$.trim(valData._red_columns[i]);if(domId)if(PJF.ui.componentMgr.get(domId))PJF.ui.componentMgr.get(domId).addHighlight();else for(var selector=["#"+domId+":input:visible","#"+domId+" > input:visible","#"+domId+" + > input:visible","#"+domId+" +:input:visible",'[name="'+domId+'"]:visible'],i=0;i<selector.length;i++){var result=$(selector[i]);if(0<result.length){result.addClass("validatebox-tipcolor error-border");break}}}if("2"==PJF.loadResource.CHANGE_SA)PJF.communication.handleSAIT(data,cancelCallback);else if("IT"==data._curr_val_key||"SA"==data._curr_val_key||!data._curr_val_key&&data._val_page){if("IT"==data._curr_val_key&&ootcData&&(PJF.communication.ootcTemplate(ootcData),""==PJF.communication.client.OOTC_CONTENT))return;PJF.communication.client.OOTC_CONTENT=$.trim(PJF.communication.client.OOTC_CONTENT),
"1"==data.Test_Run&&"SA"==data._curr_val_key?"CA"==PJF.loadResource.Test_Run_Flag?PJF.loadResource.CA_TWICE&&PJF.communication.handleTwiceCA(data):"SA"==PJF.loadResource.Test_Run_Flag?PJF.communication.handleSAIT(data,cancelCallback):new PJF.ui.messageBox({style:"confirm",closable:!1,title:"授权提示",content:"该交易处于远程集中授权试运行期，确定将进行远程集中授权，取消将进行本地授权",ok:function(){PJF.loadResource.PJF_LOAD_RESOURCES_CONF.authResourceType="CA",PJF.loadResource.Test_Run_Flag="CA",PJF.communication.handleCA(data)},cancel:function(){PJF.loadResource.Test_Run_Flag="SA",PJF.communication.handleSAIT(data,cancelCallback)}}):PJF.communication.handleSAIT(data,cancelCallback)}else if("CA"==data._curr_val_key)PJF.loadResource.PJF_LOAD_RESOURCES_CONF.authResourceType="CA",PJF.loadResource.CA_TWICE?PJF.communication.handleTwiceCA(data):PJF.communication.handleCA(data);else if("KA"==data._curr_val_key);else if("RW"==data._curr_val_key)new PJF.ui.messageBox({style:"info",title:resource.AUTH_REVIEW_TITLE,
content:data._val_msg,fn:function(){copyOfConf.interceptParams&&copyOfConf.interceptParams.rwCallBack&&copyOfConf.interceptParams.rwCallBack(data)}});else if("HW"==data._curr_val_key){var loading=new PJF.ui.loading({maskBody:!0,text:resource.AJAX_HW_REAUTH});PJF.communication.client.beforeCloseTab=function(){return!1},PJF.communication.client.registerEvent("SQFH_msg_003",function(hwData){PJF.communication.client.beforeCloseTab=function(){return!0},console.log("收到复核消息:"+hwData),hwData=eval("("+hwData+")"),hwData.msgData._event_id==data._event_id&&(loading.destroy(),"1"==hwData.msgData._val_ret?PJF.communication.cpsJsonReqResend():(new PJF.ui.messageBox({style:"info",title:"",content:hwData.msgData._val_data}),PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:"HW"})))})}else if("AP"==data._curr_val_key)PJF.communication.handleSAIT(data);else if("CP"==data._curr_val_key)PJF.communication.handleSAIT(data);else if("MA"==data._curr_val_key)new PJF.ui.messageBox({style:"warning",
title:"交易未上送加密数据",content:"请重新启动员工渠道后重试"});else if("VC"==data._curr_val_key)new PJF.ui.messageBox({style:"warning",title:"错误",content:"验证码过期或输入错误"});else if("IDEN"==data._curr_val_key){if(PJF.html.getDom(PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)==undefined){var winDiv=document.createElement("div");document.body.appendChild(winDiv),winDiv.setAttribute("id",PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)}new PJF.ui.window({dom:PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID,id:PJF.loadResource.PJF_LOAD_RESOURCES_ID,title:"身份证联网核查",width:850,height:450,showTip:!0,closable:!1,url:CONTEXT_PATH+data._val_page,onClose:function(){PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:data._curr_val_key})}})}else new PJF.ui.messageBox({style:"warning",title:"后端返回不正确标志",content:data._curr_val_key})},PJF.communication.handleTwiceCA=function(t){PJF.auth.startAuth()?(PJF.communication.ra.initLoading(),
PJF.communication.ra.tellAuthMoreRA(PJF.loadResource.PJF_LOAD_RESOURCES_CA_BACKDATA,t)):new PJF.ui.messageBox({title:"禁止进行授权交易",style:"warning",content:"当前存在处于授权等待中的交易，前先完成前序交易！"})},PJF.communication.handleSAIT=function(data,cancelCallback){var conf=PJF.loadResource.PJF_LOAD_RESOURCES_CONF,_closable=!0;if(PJF.html.getDom(PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)==undefined){var winDiv=document.createElement("div");document.body.appendChild(winDiv),winDiv.setAttribute("id",PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)}("IT"==data._curr_val_key||"CA"==data._curr_val_key)&&conf.interceptParams&&conf.interceptParams.beforeHandleSA&&conf.interceptParams.beforeHandleSA(data),"AP"==data._curr_val_key&&conf.interceptParams&&conf.interceptParams.beforeHandleAP&&conf.interceptParams.beforeHandleAP(data);var url=data._val_page;if("CA"==data._curr_val_key){var valData=data._val_data||{};"string"==typeof valData&&(valData=eval("("+valData+")")),url=valData._TO_SAME_URL||url}
var title=resource.AUTH_WINDOW_TITLE[0];"IT"==data._curr_val_key?(title=resource.AUTH_WINDOW_TITLE[1],conf.elecSignParam&&conf.elecSignParam.ootcSign&&PJF.communication.elecSign.canElecSign()&&PJF.communication.elecSign.getElecSignCapability()&&(url=PJF.constants.OOTC_SIGN_URL,_closable=!1)):"CP"==data._curr_val_key?title=resource.AUTH_WINDOW_TITLE[2]:"AP"==data._curr_val_key&&(title=resource.AUTH_WINDOW_TITLE[3]),"SA"!=data._curr_val_key||PJF.auth.startAuth()?new PJF.ui.window({dom:PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID,id:PJF.loadResource.PJF_LOAD_RESOURCES_ID,title:title,left:0,position:"fixed",fixPosition:!0,top:(window.innerHeight||document.documentElement.height)-300,width:420,height:300,showTip:!0,closable:_closable,url:CONTEXT_PATH+url,cache:!1,onClose:function(){PJF.auth.endAuth(),PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:data._curr_val_key}),cancelCallback&&cancelCallback()}}):new PJF.ui.messageBox({title:"禁止进行授权交易",style:"warning",
content:"当前存在处于授权等待中的交易，前先完成前序交易！"})},PJF.communication.handleCA=function(t){PJF.auth.startAuth()?(PJF.communication.ra.initLoading(),PJF.communication.client.openAuthPage(t._val_data,"YGQD"),PJF.communication.ra.registerHandler(t)):new PJF.ui.messageBox({title:"禁止进行授权交易",style:"warning",content:"当前存在处于授权等待中的交易，前先完成前序交易！"})},PJF.communication.cpsJsonReqResend=function(authUserInfo,authType){PJF.auth.endAuth(),"1"==PJF.loadResource.CHANGE_SA&&(PJF.loadResource.CHANGE_SA="2");var cpsAuthWin=PJF.ui.componentMgr.get(PJF.loadResource.PJF_LOAD_RESOURCES_ID);cpsAuthWin&&(cpsAuthWin.destroy(),cpsAuthWin=null);var re={};PJF.apply(re,PJF.loadResource.PJF_LOAD_RESOURCES_CONF);var tempJsonData=re.fwServiceId?re.jsonData:re.data.jsonData;if(tempJsonData?"string"==typeof tempJsonData&&(tempJsonData=eval("("+tempJsonData+")")):tempJsonData={},re.interceptParams&&re.interceptParams.beforeSaResend){var tmpData=re.interceptParams.beforeSaResend(tempJsonData,authUserInfo,PJF.loadResource.AUTH_VAL_DATA)
;tempJsonData=tmpData||tempJsonData}if(tempJsonData._auth_info&&tempJsonData._auth_info.AHN_INFOS)for(var i in tempJsonData._auth_info.AHN_INFOS)tempJsonData._auth_info.AHN_INFOS[i].AHN_STFF_ID=authUserInfo.CCB_EmpID,tempJsonData._auth_info.AHN_INFOS[i].AUTH_TYPE=0;if(PJF.loadResource.operIdKey&&authUserInfo&&authUserInfo.CCB_EmpID&&(authUserInfo[PJF.loadResource.operIdKey]=authUserInfo.CCB_EmpID),re.pjfReSend=!0,re.authUserInfo=authUserInfo,re.fwServiceId)authUserInfo&&(PJF.apply(tempJsonData,authUserInfo),re.jsonData=PJF.util.json2str(tempJsonData)),PJF.communication.cpsJsonReq(re);else if(re.data&&re.data.isFromCrossDomain){if(delete re.data.isFromCrossDomain,authUserInfo){if(PJF.apply(tempJsonData,authUserInfo),PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(tempJsonData.ATCH_BTCH_NO=uNo[1])}re.data.jsonData=tempJsonData}re.data=PJF.util.json2str(re.data),PJF.communication.crossDomainReq(re)}else{
if(authUserInfo&&(PJF.apply(tempJsonData,authUserInfo),re.data.jsonData=PJF.util.json2str(tempJsonData)),PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(tempJsonData.ATCH_BTCH_NO=uNo[1]),re.data.jsonData=PJF.util.json2str(tempJsonData)}PJF.communication.ajax(re)}},PJF.communication.cleanResource=function(){PJF.loadResource.Already_Run=null,PJF.loadResource.Test_Run_Flag=null,PJF.loadResource.CA_TWICE=null,PJF.loadResource.CHANGE_SA=null},PJF.communication.setEcpJsonParam=function(serviceId,tranId,data,needAdapterId,encryptDatas,sqlId,fmtPrintId,conf){var myData={},enData={};fmtPrintId=fmtPrintId||tranId,conf=conf||{},myData=PJF.communication.addParam(myData,serviceId),("noRoleSimpleTransaction"==serviceId||conf.noRoleTransaction)&&(myData.RL_IDS=[]);var menuId=conf.menuId||PJF.html.getUrlParam("menuId"),resultData;if(menuId&&(myData._menu_id=menuId),encryptDatas){var dataObj;dataObj=""==data?{}:eval("("+data+")")
;for(var a=0;a<encryptDatas.length;a++){var key=encryptDatas[a];if(dataObj[key]){var result=PJF.communication.client.encryptParam(dataObj[key]);0==result[0]&&(enData[key]=result[1])}}}if("string"==PJF.util.getType(data)&&""!=data&&(data=eval("("+data+")")),myData.ATCH_BTCH_NO&&data&&(data.ATCH_BTCH_NO=myData.ATCH_BTCH_NO),myData=PJF.apply(myData,data),conf.atchBtchNo&&(myData.ATCH_BTCH_NO=conf.atchBtchNo),PJF.communication.client.isInP2()){try{var telclrFlag=PJF.communication.client.getClientEnv("telclrFlag");telclrFlag&&"true"==telclrFlag[1]&&(myData._inte_trl_enable=1)}catch(ex){}conf.elecSignParam&&conf.elecSignParam.ootcSign&&"pc"==PJF.constants.termType&&PJF.communication.elecSign.canElecSign()&&(myData._inte_trl_enable=1);var tabName=PJF.communication.client.getClientEnv("cuurentMenu.menuName");"0"==tabName[0]&&(myData.TAB_NAME=tabName[1])}if(myData=PJF.apply(myData,enData),!PJF.constants.D2D){var QUOTA_BATCHNO=PJF.html.getUrlParam("batchNo")
;QUOTA_BATCHNO&&(myData.QUOTA_BATCHNO=QUOTA_BATCHNO)}if("noRoleSimpleTransaction"==serviceId&&(serviceId="simpleTransaction"),resultData=needAdapterId?{adapterId:"ecpJson",_fw_service_id:serviceId,jsonData:PJF.util.json2str2(myData),transaction_id:tranId}:{_fw_service_id:serviceId,jsonData:PJF.util.json2str2(myData),transaction_id:tranId},sqlId&&(resultData._sql_id=sqlId),fmtPrintId&&(resultData.fmtPrintId=fmtPrintId),conf&&(conf.docType&&(resultData.docType=conf.docType),conf.transFlag&&(resultData.transFlag=conf.transFlag),conf.serverFilePath&&(resultData.serverFilePath=conf.serverFilePath),conf.remotePath&&(resultData.remotePath=conf.remotePath),conf.otherParams))for(var i in conf.otherParams)resultData[i]=conf.otherParams[i];return"undefined"!=typeof CLIENT_LANGUAGE&&(resultData.REQ_LANG=CLIENT_LANGUAGE),resultData},PJF.communication.addParam=function(t,e){if(t){if(t.REQ_LANG=CLIENT_LANGUAGE,PJF.userInfo&&(t.OPER_CODE=PJF.userInfo.userCode,t.OPER_NAME=PJF.userInfo.userName,
t.CCBS_ID=PJF.userInfo.ccbsId),PJF.otherInfo&&(t.TOKEN=PJF.otherInfo.token,t.TERMINAL_MAC=PJF.otherInfo.macAddress,t.TERMINAL_IP=PJF.otherInfo.clientIP,PJF.otherInfo.chaType||(PJF.otherInfo.chaType="0101"),t.TXN_ITT_CHNL_CGY_CODE||(t.TXN_ITT_CHNL_CGY_CODE=PJF.otherInfo.chaType),PJF.otherInfo.logicTerminalNo&&(t.LOGIC_TERMINAL_NO=PJF.otherInfo.logicTerminalNo),PJF.otherInfo.chaTypeId&&(t.TXN_ITT_CHNL_ID=PJF.otherInfo.chaTypeId),PJF.otherInfo.seqId&&(t.SCAN_SEQ_ID=PJF.otherInfo.seqId),"pc"==PJF.constants.termType&&(PJF.otherInfo.customerAcctNo&&(t._customer_account_no=PJF.otherInfo.customerAcctNo),PJF.otherInfo.customerIdenNo&&(t._customer_identity_no=PJF.otherInfo.customerIdenNo),PJF.otherInfo.customerIdenNm&&(t._customer_identity_name=PJF.otherInfo.customerIdenNm)),"undefined"!=typeof PJF.otherInfo.scp&&(t.CLUSTER_ID=PJF.otherInfo.scp)),PJF.orgInfo&&(t.ORG_SHORT_CNAME=PJF.orgInfo.orgShortCName,PJF.orgInfo.orgShortEName&&(t.ORG_SHORT_ENAME=PJF.orgInfo.orgShortEName),
t.ORG_PHYSIC_CLASS=PJF.orgInfo.orgClass,PJF.orgInfo.instLevel1BranchId&&(t.INST_LEVEL1_BRANCH_ID=PJF.orgInfo.instLevel1BranchId),PJF.orgInfo.instSvrlLgPsnID&&(t.BSN_MT_ENT_IDR=PJF.orgInfo.instSvrlLgPsnID),PJF.orgInfo.instSvrlLgPsnNm&&(t.REQ_TENANCY_NAME=PJF.orgInfo.instSvrlLgPsnNm),PJF.orgInfo.lclCcyCd&&(t.LOC_CCY=PJF.orgInfo.lclCcyCd),PJF.orgInfo.ctyRgonCd&&(t.COUN_CD=PJF.orgInfo.ctyRgonCd),PJF.orgInfo.tmzonCd&&(t.CLIENT_TIMEZONE=PJF.orgInfo.tmzonCd)),PJF.roleInfo){if(t.OPER_ROLE=PJF.roleInfo.positionId,PJF.roleInfo.noRepeatRoleAuthInfoList&&PJF.roleInfo.noRepeatRoleAuthInfoList.constructor!==Array){var i=[],n=[];for(var o in PJF.roleInfo.noRepeatRoleAuthInfoList)PJF.util.array.indexOf(n,PJF.roleInfo.noRepeatRoleAuthInfoList[o].pstRlId)<0&&(n.push(PJF.roleInfo.noRepeatRoleAuthInfoList[o].pstRlId),i.push(PJF.roleInfo.noRepeatRoleAuthInfoList[o]));PJF.roleInfo.noRepeatRoleAuthInfoList=i}for(var a in t.RL_IDS=[],PJF.roleInfo.noRepeatRoleAuthInfoList)t.RL_IDS.push({
pstRlId:PJF.roleInfo.noRepeatRoleAuthInfoList[a].pstRlId});"databaseTransaction"==e&&(t.RL_IDS=[]),t.BRANCH_ID||(t.BRANCH_ID=PJF.roleInfo.orgCode)}if(PJF.communication.client&&PJF.communication.client.isInP2()){var s=PJF.communication.client.getUniqueNo();"array"==PJF.util.getType(s)&&0==s[0]&&(t.ATCH_BTCH_NO=s[1]);var r=PJF.communication.client.getClientEnv("outputLoginBean.orgAncestorInfo.instLevel1BranchId");0==r[0]&&r[1]&&(t.LVL1_BRANCH_ID=r[1]);var c=PJF.communication.client.getClientEnv("outputLoginBean.orgAncestorInfo.instHeadOfficeId");0==c[0]&&(t.HEAD_BRANCH_ID=c[1])}return t._terminal_type=PJF.constants.termType,PJF.communication.elecSign&&PJF.communication.client&&PJF.communication.client.isInP2()&&PJF.communication.elecSign.addElecParam(t),t}},PJF.communication.getStandardCode=function(o){var t=o.REQ_LANG||CLIENT_LANGUAGE;if(o.lgPsn){var e=o.lgPsn.split(","),i=PJF.orgInfo&&PJF.orgInfo.instSvrlLgPsnID;if(i)for(var n=0,a=e.length;n<a;n++)if(e[n]==i){t+="_"+i;break}}
if(o.categoryId){var s,r=!PJF.constants.D2D&&"pc"==PJF.constants.termType&&PJF.communication.client.isInP2();if(r){s=[o.categoryId,o.appId||"00000",o.clcd||"00000",t].join("");var c=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","getStdCode",s)[1];if("0"==c[0]&&c.substr(2)){var l=JSON.parse(c.substr(2));return void(!1===o.async?o.success(l,"success",{}):setTimeout(function(){o.success(l,"success",{})},0))}}var d={};d.categoryId=o.categoryId,o.appId&&(d.appId=o.appId),o.clcd&&(d.clcd=o.clcd),o.sorted&&(d.sorted=o.sorted);var u={};u.REQ_LANG=t,u._fw_service_id="fetchStanderdCodeModelListByParams",u.jsonClass="com.ccb.model.StandardDataCategory",u.jsonData=PJF.util.json2str(d),PJF.communication.ajax({data:u,async:o.async,url:"ecpJson2Bean.action",success:function(t,e,i){if(r)try{PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","setStdCode",s,JSON.stringify(t))}catch(n){
console.log("pc cliet set std cache error:"+n.message)}o.success(t,e,i)}})}else alert("PJF.communication.getStandardCode需要的参数信息不正确!当前参数为:categoryId:"+o.categoryId+",appId:"+o.appId+",clcd:"+o.clcd)},PJF.communication.getOrgDesc=function(t){t&&t.codes&&$.isArray(t.codes)&&0!==t.codes.length&&t.codes[0]?new PJF.communication.ajax({url:"/bosWeb/ecpJson.action",data:{_fw_service_id:"orgTextService",nodeArr:t.codes,REQ_LANG:CLIENT_LANGUAGE},async:t.async,success:t.success,failure:t.failure}):alert("PJF.communication.getOrgDesc没有传入机构号信息!")},PJF.communication.printData=function(t){var e=t.teminalId,i=t.fileName,n=PJF.util.generateUUid(),o=t.url+"/print/PrintService?IN_teminalId="+e+"&IN_fileName="+i+"&uuid="+n;console.log("PJF.communication.printData统一打印服务URL为:"+o);var a=document.createElement("script");a.type="text/javascript",a.src=o,a.onerror=function(){t.failure&&t.failure()},PJF.communication.printData.callback=t.callback,document.body.appendChild(a)},
PJF.communication.crossDomainReq=function(conf){if("string"==typeof conf.data){var dataTmp=eval("("+conf.data+")"),token=PJF.util.getLoginToken();if(token&&dataTmp.jsonData)if("string"==typeof dataTmp.jsonData)try{dataTmp.jsonData=eval("("+dataTmp.jsonData+")"),dataTmp.jsonData._login_tk=token}catch(e){console.info("crossdomain req 添加login token出错:"+e.message)}else dataTmp.jsonData._login_tk=token;PJF.util.getValue(window,"PJF.userInfo.userCode")&&(dataTmp.jsonData&&("object"==typeof dataTmp.jsonData&&(dataTmp.jsonData=PJF.util.jsontostr(dataTmp.jsonData)),dataTmp.macData=PJF.communication.client.macContent(dataTmp.jsonData)[1]),dataTmp.OPER_CODE=PJF.util.getValue(window,"PJF.userInfo.userCode"),dataTmp._terminal_type=PJF.constants.termType),conf.data=PJF.util.jsontostr(dataTmp)}var copyOfConf=$.extend(!0,{},conf);"string"==typeof copyOfConf.data&&(copyOfConf.data=eval("("+copyOfConf.data+")")),copyOfConf.data.isFromCrossDomain=!0;var success=function(data){
if("string"!=typeof data||-1==data.indexOf("_curr_val_key")&&-1==data.indexOf("_val_page"))if(conf.elecSignParam){var datatmp=data||{};"string"==typeof datatmp&&(datatmp=eval("("+datatmp+")")),datatmp.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?PJF.communication.afterCpsSucc(copyOfConf,datatmp,{}):conf.success(data)}else conf.success(data);else data=data||{},"string"==typeof data&&(data=eval("("+data+")")),PJF.communication.handleAuthResource(data,copyOfConf)},url=conf.url;if(conf.data){var result=PJF.communication.client.sendHttp(url,conf.data);0==result[0]?success(result[1]):conf.failure(result[1])}else{var result=PJF.communication.client.sendHttp(url);0==result[0]?success(result[1]):conf.failure(result[1])}},PJF.communication.getStandardCodeDescByValue=function(o){if(o.categoryId&&o.value){var a,s=!PJF.constants.D2D&&"pc"==PJF.constants.termType&&PJF.communication.client.isInP2();if(s){a=[o.categoryId,o.appId||"00000",o.clcd||"00000",o.value].join("")
;var t=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","getStdCode",a)[1];if("0"==t[0]&&t.substr(2)){var e=JSON.parse(t.substr(2));return void o.success(e,"success",{})}}var i={};i.category=o.categoryId,o.appId&&(i.appId=o.appId),o.clcd&&(i.clcd=o.clcd),o.value&&(i.value=o.value);var n={_fw_service_id:"getDataItemNameByCategoryAndItem",jsonClass:"com.ccb.model.StandardDataCategory"};n.jsonData=PJF.util.json2str(i),PJF.communication.ajax({data:n,async:!1,url:"ecpJson.action",success:function(t,e,i){if(s&&t)try{PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","setStdCode",a,JSON.stringify(t))}catch(n){console.log("pc cliet set std value cache error:"+n.message)}o.success(t,e,i)}})}else alert("必须输入categoryId和value")},PJF.communication.printServiceReq=function(t){if(t.success){t.funId||(t.funId="genPrintString"),t.voucherId||(t.voucherId="all"),t.jsonData||(t.jsonData={});var e=!1;t.async&&(e=t.async);var i={
_fw_service_id:"FormatPrintService"};i.funId=t.funId,i.voucherId=t.voucherId,i.branchId=PJF.userInfo.orgCode,t.version&&(i.version=t.version),i.jsonData=PJF.util.json2str(t.jsonData),PJF.communication.ajax({data:i,async:e,url:"ecpJson.action",success:t.success})}else alert("PJF.communication.printServiceReq需要的参数信息不正确!")},PJF.communication.getVoucherPrintContent=function(t){if(t.success&&t.fmtPrintId&&t.jsonData){var e=!1;t.async&&(e=t.async),t.printType="undefined"==typeof t.printType?1:t.printType;var i={_fw_service_id:"voucherPrintServiceReq"};i.unitedVoucherId=t.fmtPrintId,i.jsonData=PJF.util.json2str(t.jsonData),i._print_type=t.printType,i._elec_seal_switch=PJF.communication.elecSign.canElecSign(),i._elec_seal=PJF.communication.elecSign.canElecSeal(),PJF.communication.ajax({data:i,async:e,url:"ecpJson.action",success:t.success})}else alert("PJF.communication.getVoucherPrintContent需要的参数信息不正确!")},PJF.communication.getServerTime=function(i,t){i=i||"yyyyMMdd";var n=null,e=""
;t?e=t:PJF.orgInfo&&PJF.orgInfo.instSvrlLgPsnID&&(e=PJF.orgInfo.instSvrlLgPsnID);var o=!PJF.constants.D2D&&"pc"==PJF.constants.termType&&PJF.communication.client.isInP2()&&e&&!t,a="yyyyMMdd"==i&&o,s="stm"==PJF.constants.termType&&!t,r="yyyyMMdd"==i&&s;if(a)try{if("0"==(n=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","getServerTime")[1])[0]&&n.substr(2))return n.substr(2)}catch(c){console.log("pc client get servertime cache error: "+c.message)}else if(r){if(n=PJF.cache.getServerTime())return n}return(o||s)&&(i+=",yyyyMMddHHmmss"),PJF.communication.ajax({url:"ecpJson.action",async:!1,data:{_fw_service_id:"getServerTime",timePattern:i,legalPerson:e},success:function(t){if(n=t,(o||s)&&n&&n.currentTime)try{var e=n.currentTime.substr(i.length-15).substr(1);n.currentTime=n.currentTime.substr(0,i.length-15),o?PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","setServerTime",e):s&&PJF.cache.setServerTime(e)}catch(c){
console.log("set servertime cache error: "+c.message)}},failure:function(t,e,i){console.log("获取系统时间失败,错误原因:"+e)}}),n?n.currentTime:n},PJF.communication.convertDateString=function(t){var e,i,n=arguments[1],o=arguments[2]||"yyyyMMdd HH:mm:ss",a=arguments[3]||o,s=arguments[4]||PJF.util.getValue(PJF,"orgInfo.instSvrlLgPsnID")||"CN000";switch(t){case 1:i="convertDateStringToLegalPerson",e=[a,s];break;case 2:i="convertDateStringToBaseTz",e=[s,a]}return PJF.communication.ajax({traditional:!0,url:"ecpJson.action",async:!1,data:{_fw_service_id:i,arg0:n,arg1:o,args:e},success:function(t){result=t},failure:function(t,e,i){console.log("获取系统时间失败,错误原因:"+e)}}),result?result.i18nTime:result},PJF.communication.convertDateStringToLegalPerson=function(t,e,i,n){return PJF.communication.convertDateString.apply(window,Array.prototype.concat.apply([1],arguments))},PJF.communication.convertDateStringToBaseTz=function(t,e,i,n){
return PJF.communication.convertDateString.apply(window,Array.prototype.concat.apply([2],arguments))},PJF.communication.file2Swf=function(t){t.convertModel="real",t.convertType="swf",PJF.communication.ajax({url:"/bosWeb/ecpJson.action",data:{_fw_service_id:"file2SwfNew",jsonData:PJF.util.json2str(t)},success:function(t){if("00"!=t.TX_STATUS)return new PJF.ui.messageBox({style:"warning",title:"提示",content:"打开pdf文件"+t.FILE_NAME+"失败,错误描述信息["+t.ERROR_MSG+"]!"}),null;PJF.html.openWin("/bosWeb/page/swfdemo/viewSwf.html?fileName="+t.FILE_NAME,"pdf文件浏览")},failure:function(t){return new PJF.ui.messageBox({style:"warning",title:"提示",content:"打开pdf文件发生异常, 请稍后再试!"}),null}})},PJF.communication.ootcTemplate=function(ootcData){PJF.communication.ajax({url:"/bosWeb/ecpJsonAsym.action",async:!1,data:{_fw_service_id:"transformData",jsonData:PJF.util.json2str(ootcData)},dataType:"html",success:function(data){var obj=data;if("string"==typeof data)try{obj=eval("("+data+")")}catch(e){
return void(PJF.communication.client.OOTC_CONTENT=data)}PJF.communication.client.OOTC_CONTENT="";var desc=obj.BK_DESC;obj.FLLW_GUIDE&&(desc+="~"+obj.FLLW_GUIDE);var transId="";data._COMMON&&data._COMMON.SYS_EVT_TRACE_ID&&(transId=data._COMMON.SYS_EVT_TRACE_ID),new PJF.ui.errorMessageBox({title:"提示",desc:desc,code:obj.BK_CODE,traceId:transId})},failure:function(t){new PJF.ui.messageBox({style:"warning",title:"提示",content:"获取互动终端显示内容失败"}),PJF.communication.client.OOTC_CONTENT=""}})},PJF.communication.hanyu2PinYin=function(t){t||(t={});var e="";return PJF.communication.ajax({url:"ecpJson.action",async:!1,data:{_fw_service_id:"hanyu2PinYin",jsonData:PJF.util.json2str(t)},success:function(t){t.replace(/·/g,""),e=t},failure:function(t){new PJF.ui.messageBox({title:"失败",content:"转换拼音失败"})}}),e},PJF.communication.getPostCode=function(t){t.categoryId="p20015",t.appId="p2015",t.clcd="p2015",PJF.communication.getStandardCodeDescByValue(t)},PJF.communication.getCityCodeByDesc=function(t){var e={}
;e.address=t.address;var i={_fw_service_id:"parseAddress"};i.jsonData=PJF.util.json2str(e),PJF.communication.ajax({data:i,async:!1,url:"ecpJson.action",success:t.success})},PJF.communication.PcsCrdAutoWtof=function(t,e,i,n,o){var a={Blng_InsNo:t,BnkTailBox_Blng_TrID:e,Mnplt_Tp_Ind:"0",Mnul_Ind:"0",SEGMENT_GRP:i};new PJF.communication.cpsJsonReq({fwServiceId:"simpleTransaction",fwTranId:"A0791T847",jsonData:PJF.util.json2str(a),maskAll:!0,success:function(t){n&&n(t);var e={};PJF.util.extend(!0,e,t),console.log("Call A0791T847 success,result type = [object], result value = ["+PJF.util.json2str(e)+"]")},failure:function(t){if(o)o(t);else if("string"==typeof t)console.log("Call A0791T847 fail,result type = [string], result value = ["+t+"]"),new PJF.ui.messageBox({title:"错误",content:t});else{var e={};PJF.util.extend(!0,e,t),console.log("Call A0791T847 fail,result type = [object], result value = ["+PJF.util.json2str(e)+"]"),new PJF.ui.errorMessageBox({title:"预制卡自动销记失败，请尝试手工销记",
desc:t&&t.BK_DESC,code:t&&t.BK_CODE,traceId:t&&t._COMMON&&t._COMMON.SYS_EVT_TRACE_ID})}}})},PJF.namespace("PJF.im"),PJF.im=function(a){if("pc"===PJF.constants.termType&&"1"===PJF.communication.client.doCommonCommand("cmdCfg","_SWC_IM_TP")[1])return PJF.im=PJF.ecp.im,new PJF.ecp.im(a);if(a.id&&a.type){this.url=a.url||PJF.constants.IM_URL,this.username=a.id.toLowerCase()+a.type,this.recMsgHandler=a.recMsgHandler,this.offMsgHandler=a.offMsgHandler,this.onlineStatusHandler=a.onlineStatusHandler,this.chatMsgHandler=a.chatMsgHandler,this.type=a.type,this.orgCode=a.orgCode,this.chatPresHandler=a.chatPresHandler,this.inviteHandler=a.inviteHandler,this.resources="strophe",this.receiptHandler=a.receiptHandler,this.ackHandler=a.ackHandler,this.retry=!(!1===a.retry),this.retryCount=0,this.MaxRetryCount=5,this.retryTimeSpan=[5,10,30,60,120],this.lastError="";var b=this;this.messageSendAckHandler=function(t){if("message"==t.nodeName){
var e=t.getElementsByTagName("body"),i=t.getElementsByTagName("pic");if(0==e.length&&0==i.length)return;if(b.ackHandler)try{var n=t.getAttribute("id"),o=t.getAttribute("to");b.ackHandler(n,Strophe.getNodeFromJid(o))}catch(a){}}},Strophe.log=function(t,e){3==t&&(b.lastError=e)};var s=function(t,e){var i={_fw_service_id:"remoteDatabaseTransaction",transaction_id:"update",_sql_id:"im.addErrorInfo",_db_no:"1"},n={im_id:b.username,error_reason:t,param_remark:e+"["+b.lastError+"]",create_time:PJF.util.formatDate(new Date,"yyyy-MM-dd HH:mm:ss")};i.jsonData=JSON.stringify(n),$.ajax({data:i,dataType:"json",url:"ecpJson.action",success:function(t){"00"==t.BK_STATUS?console.log("上报连接错误状态成功"):"01"==t.BK_STATUS&&console.log("上报连接错误状态异常:"+t)},error:function(t,e,i){console.log("上报连接错误状态异常"+i)}})},i=function(t){if(t==Strophe.Status.CONNECTING)console.log("即时通讯正在连接"),PJF.event.publish(PJF.constants.IM_CONNECTING_EVENT);else if(t==Strophe.Status.CONNFAIL)console.log("即时通讯连接失败"),s(t,"即时通讯连接失败:"+b.url),
b.retry&&b.retryCount<b.MaxRetryCount-1?(b.retryCount=b.retryCount+1,setTimeout(function(){b.connection.connect(b.username+"@"+b.domainName+"/"+b.resources,PJF.constants.DEF_IM_PASSWORD,i)},1e3*b.retryTimeSpan[b.retryCount])):PJF.event.publish(PJF.constants.IM_CONNECT_FAIL);else if(t==Strophe.Status.DISCONNECTING)console.log("即时通讯正在断开"),PJF.event.publish(PJF.constants.IM_DISCONNECTING_EVENT);else if(t==Strophe.Status.DISCONNECTED)console.log("即时通讯已断开"),PJF.event.publish(PJF.constants.IM_DISCONNECTED_EVENT);else if(t==Strophe.Status.AUTHFAIL){console.log("用户验证失败");var e="用户验证失败:[user->"+b.username+"@"+b.domainName+"/pwd->"+PJF.constants.DEF_IM_PASSWORD+"]";s(t,e),PJF.event.publish(PJF.constants.IM_CONNECT_AUTHFAIL)}else if(t==Strophe.Status.CONNTIMEOUT)console.log("连接超时"),s(t,"连接超时:"+b.url);else if(t==Strophe.Status.ERROR)s(t,"未知异常");else if(t==Strophe.Status.CONNECTED){console.log("即时通讯已连接"),b.retryCount=0,PJF.event.publish(PJF.constants.IM_CONNECTED_EVENT),
b.ackHandler&&(b.connection.streamManagement.enable(),b.connection.streamManagement.sendCountOnEveryIncomingStanza=!0,b.connection.streamManagement.requestResponseInterval=1);b.connection.addHandler(function(t){try{!function(t){var e=t.getAttribute("to"),i=t.getAttribute("from"),n=t.getAttribute("type"),o=t.getElementsByTagName("pic"),a=t.getElementsByTagName("body");if("error"!=n){var s=0,r=t.getElementsByTagName("delay");if(0<r.length){var c=r[0].getAttribute("duration");s=parseInt(c)}if(0<a.length){var l=a[0],d=Strophe.getText(l);if(console.log("即时通信：目标:"+e+",内容:"+d+",来自于:"+i+",消息类型:"+n),"groupchat"==n&&e!=b.orgCode+b.type)return;0<s&&b.offMsgHandler?b.offMsgHandler(d,i,e,n,o,s):b.recMsgHandler&&b.recMsgHandler(d,i,e,n,o)}else{for(var u=t.getElementsByTagName("x"),h=null,p=null,f=null,m=0;m<u.length;m++){var g=u[m].getAttribute("xmlns");if("jabber:x:conference"==g&&(h=u[m].getAttribute("jid")),g==Strophe.NS.MUC_USER){var v=u[m].getElementsByTagName("invite")[0]
;f=v.getAttribute("from"),p=Strophe.getText(v.firstElementChild)}}if(null!=h){inviteHandler&&b.inviteHandler(h,f,p);var _=Strophe.getNodeFromJid(b.connection.jid);b.connection.muc.join(h,_,function(t,e){try{console.info(Strophe.serialize(t));var i=t.getAttribute("from"),n=Strophe.getBareJidFromJid(i),o=Strophe.getResourceFromJid(i),a=Strophe.getText(t.getElementsByTagName("body")[0]),s=t.getElementsByTagName("pic");b.chatchatMsgHandler&&b.chatMsgHandler(n,o,a,s)}catch(r){console.error(r)}return!0},function(t,e){try{console.info(Strophe.serialize(t));var i=t.getAttribute("from"),n=Strophe.getBareJidFromJid(i),o=Strophe.getResourceFromJid(i),a="unavailable"!=t.getAttribute("type");b.chatPresHandler&&b.chatPresHandler(n,o,a)}catch(s){console.error(s)}return!0},function(t,e){return!0})}}}else console.info("服务器返回异常消息"+Strophe.serialize(t))}(t)}catch(e){console.error(e)}return!0},null,"message",null,null,null);b.connection.addHandler(function(t){try{var e=t.getAttribute("from")
;if(t.getAttribute("to")==e)return!0;var i=t.getAttribute("type");switch(i||(i="available"),i){case"available":b.onlineStatusHandler&&b.onlineStatusHandler(Strophe.getNodeFromJid(e),!0);break;case"unavailable":b.onlineStatusHandler&&b.onlineStatusHandler(Strophe.getNodeFromJid(e),!1)}}catch(n){console.error(n)}return!0},null,"presence",null,null,null),b.connection.send($pres().tree())}},r=function(t){$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users/"+b.username+"/groups/"+t,data:null,type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json")},success:function(t){console.log("即时通讯:当前用户组注册成功:"+a.orgCode+b.type),b.connection=new Strophe.Connection(b.url),b.receiptHandler&&(b.connection.receipts._resendCount=0,b.connection.receipts.addReceiptHandler(function(t){t=t.tree()
;var e=Strophe.getNodeFromJid(t.getAttribute("to")),i=t.getElementsByTagName("body");if(0<i.length)var n=Strophe.getText(i[0]);b.receiptHandler(e,n,!0)}),b.connection.receipts.addTimeoutHandler(function(t){t=t.tree();var e,i=Strophe.getNodeFromJid(t.getAttribute("to")),n=t.getElementsByTagName("body");0<n.length&&(e=Strophe.getText(n[0])),b.receiptHandler(i,e,!1)})),b.ackHandler&&(b.connection.streamManagement.returnWholeStanza=!0,b.connection.streamManagement._acknowledgedStanzaListeners=[],b.connection.streamManagement.addAcknowledgedStanzaListener(b.messageSendAckHandler)),b.connection.connect(b.username+"@"+b.domainName+"/"+b.resources,PJF.constants.DEF_IM_PASSWORD,i)},error:function(t,e,i){var n="即时通讯:当前用户组创建失败，失败原因:"+i;console.log(n),s(24,n),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}})};$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/system/properties/xmpp.domain",data:null,type:"GET",beforeSend:function(t){
t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json")},success:function(t){b.domainName=t["@value"],console.log("即时通讯:domainName:"+b.domainName);var o=a.id.toLowerCase()+a.type;$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users/"+o,data:null,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json")},success:function(t){$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users/"+o+"/groups",data:null,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json")},success:function(t){if(t&&t.groupname){console.log("即时通讯:当前用户:"+o+",所属组"+PJF.util.json2str2(t));var e=t.groupname
;"string"==PJF.util.getType(e)&&e!=b.orgCode+b.type||"array"==PJF.util.getType(e)&&PJF.util.array.indexOf(e,b.orgCode+b.type)<0?(console.log("即时通讯:当前用户:"+o+",所属组"+e+"不在"+b.orgCode+b.type+"中,需要创建新组"),r(b.orgCode+b.type)):(b.connection=new Strophe.Connection(a.url),b.receiptHandler&&(b.connection.receipts._resendCount=0,b.connection.receipts.addReceiptHandler(function(t){t=t.tree();var e=Strophe.getNodeFromJid(t.getAttribute("to")),i=t.getElementsByTagName("body");if(0<i.length)var n=Strophe.getText(i[0]);b.receiptHandler(e,n,!0)},null,null,null),b.connection.receipts.addTimeoutHandler(function(t){t=t.tree();var e,i=Strophe.getNodeFromJid(t.getAttribute("to")),n=t.getElementsByTagName("body");0<n.length&&(e=Strophe.getText(n[0])),b.receiptHandler(i,e,!1)})),b.ackHandler&&(b.connection.streamManagement.returnWholeStanza=!0,b.connection.streamManagement._acknowledgedStanzaListeners=[],b.connection.streamManagement.addAcknowledgedStanzaListener(b.messageSendAckHandler)),
b.connection.connect(o+"@"+b.domainName+"/"+b.resources,PJF.constants.DEF_IM_PASSWORD,i))}},error:function(t,e,i){var n="即时通讯:当前用户组获取失败，失败原因:"+i;console.log(n),s(25,n),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}})},error:function(t,e,i){if("Not Found"==i)console.log("即时通讯:当前用户没注册:"+a.id.toLowerCase()+a.type),$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users",data:'{"username":"'+o+'","password":"'+PJF.constants.DEF_IM_PASSWORD+'"}',type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json")},success:function(t){console.log("即时通讯:当前用户注册成功:"+o+",开始创建用户组:"+a.orgCode+b.type),r(a.orgCode+b.type)},error:function(t,e,i){var n="即时通讯:当前用户创建失败，失败原因:"+i;console.log(n),s(22,n),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}});else{var n="即时通讯:查找用户失败，失败原因:"+i;console.log(n),s(23,n),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}}})},
error:function(t,e,i){var n="即时通讯:获取domainName失败,失败原因:"+i;console.log(n),s(21,n),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}})}else alert("PJF.im初始化出错,请传入id,type属性")},PJF.im.prototype={sendMessageToAll:function(n){$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/messages/users",data:'{"body":"'+n.msg+'"}',type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json")},success:function(t){console.log("即时通讯:发送所有用户消息成功!"),n.success&&n.success()},error:function(t,e,i){console.log("即时通讯:发送所有用户消息失败!"),n.failure&&n.failure(t,e,i)}})},isUserExist:function(t,n){$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users/"+t,data:null,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json")},success:function(t){n(!0)},error:function(t,e,i){n(!1)}})},
sendMessageToMany:function(n){var t={};t.many=n.toIds,t.content=n.msg,$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/messages/many",data:JSON.stringify(t),type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json")},success:function(t){console.log("即时通讯:发送多人消息成功!"),n.success&&n.success()},error:function(t,e,i){console.log("即时通讯:发送多人消息失败!"),n.failure&&n.failure(t,e,i)}})},sendMessageToUser:function(t){var e,i=this.connection.getUniqueId();return e=t.pic?$msg({to:t.toId+"@ygqd-im",type:"chat",id:i}).c("body").t(t.msg).up().c("pic").attrs({xmlns:"http://ccb.com.cn/protocol/picture"}).t(t.pic):$msg({to:t.toId+"@ygqd-im",type:"chat",id:i}).c("body").t(t.msg),this.receiptHandler?this.connection.receipts.sendMessage(e):this.connection.send(e),i},addRoster:function(t){var e=$pres({to:t+"@ygqd-im",type:"subscribe"});this.connection.send(e)},
sendMessageToGroups:function(t){var e;e=t.pic?$msg({to:t.group+"@broadcast.ygqd-im",type:"chat"}).c("body").t(t.msg).up().c("pic").attrs({xmlns:"http://ccb.com.cn/protocol/picture"}).t(t.pic).tree():$msg({to:t.group+"@broadcast.ygqd-im",type:"chat"}).c("body").t(t.msg).tree(),this.connection.send(e)},logout:function(){this.connection.disconnect()},createGroup:function(t){},getUserStatus:function(n,i,o){null==i&&(i=function(t,e){console.info(t+" status is :"+e?"online":"offline")}),null==o&&(o=function(t){console.warn(t)}),$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/presence/status?type=xml&jid="+n+"@"+this.domainName,type:"GET",success:function(t){var e=t.firstChild.getAttribute("type");"error"!=e?i(n,"unavailable"!=e):o("user not exists!")},error:function(t,e,i){console.log("即时通讯:获取"+n+"失败"),failure&&o("http request error")}})},createRoom:function(t,e){var i=Strophe.getNodeFromJid(this.connection.jid),n=i+"-"+Strophe.getUniqueId()+"@conference.ygqd-im",c=this
;return this.connection.muc.join(n,i,function(t,e){try{console.info(Strophe.serialize(t));var i=t.getAttribute("from"),n=Strophe.getBareJidFromJid(i),o=Strophe.getResourceFromJid(i),a=Strophe.getText(t.getElementsByTagName("body")[0]),s=t.getElementsByTagName("pic");c.chatMsgHandler(n,o,a,s)}catch(r){console.error(r)}return!0},function(t,e){try{console.info(Strophe.serialize(t));var i=t.getAttribute("from"),n=Strophe.getBareJidFromJid(i),o=Strophe.getResourceFromJid(i),a="unavailable"!=t.getAttribute("type");c.chatPresHandler&&c.chatPresHandler(n,o,a)}catch(s){console.error(s)}return!0},function(t,e){return!0}),this.connection.muc.createInstantRoom(n,t,e),n},inviteUserToRoom:function(t,e,i){this.connection.muc.invite(t,e+"@ygqd-im",i)},sendRoomMsg:function(t,e){this.connection.muc.groupchat(t,e)},setInfo:function(o,a,r,t){var e=$iq({type:"get"}).c("vCard").attrs({xmlns:"vcard-temp"}),c=function(){t&&t()};this.connection.sendIQ(e,function(t){t.removeAttribute("to"),
t.removeAttribute("id"),t.setAttribute("type","set");var e=t.getElementsByTagName("vCard")[0],i=e.getElementsByTagName(o);0<i.length&&e.removeChild(i[0]);var n=Strophe.xmlElement(o);n.append(a),e.appendChild(n),this.connection.sendIQ(t,function(t){r&&r()},function(t){console.log("设置个人信息失败,"+Strophe.serialize(t)),c()},function(){console.log("设置个人信息超时"),c()})},function(t){console.log("设置个人信息失败,"+Strophe.serialize(s)),c()},function(){console.log("设置个人信息超时"),c()})},getInfo:function(t,n,o,e){t||(t=conn.jid),-1==t.indexOf("@")&&(t=t+"@"+this.domainName);var i=$iq({type:"get",to:Strophe.getBareJidFromJid(t)}).c("vCard").attrs({xmlns:"vcard-temp"});this.connection.sendIQ(i,function(t){var e=t.getElementsByTagName(n),i="";0<e.length&&(i=Strophe.getText(e[0])),o&&o(i)},function(t){console.log("获取个人信息失败,"+Strophe.serialize(s)),e&&e()},function(){console.log("获取个人信息超时"),e&&e()})}},PJF.namespace("PJF.ecp.im"),PJF.ecp.im=function(t){this.url=t.url||PJF.constants.IM_URL,
this.recMsgHandler=t.recMsgHandler,this.offMsgHandler=t.offMsgHandler,this.onlineStatusHandler=t.onlineStatusHandler,this.chatMsgHandler=t.chatMsgHandler,this.chatPresHandler=t.chatPresHandler,this.inviteHandler=t.inviteHandler,this.receiptHandler=t.receiptHandler,this._msgQueue={},t.ackHandler&&console.warn("smack3.4.1 no implementation xep-198 ,can't use streamManagement(ack) feature!!!");var u=this;console.log("################################register js call back event imclient_event!!!"),PJF.communication.client.registerEvent("imclient_event",function(t){console.log("imclient_event js callback function");var e=t.split("&"),i=e[0]
;if("conn"===i)1==e[1]?PJF.event.publish(PJF.constants.IM_CONNECTING_EVENT):2==e[1]?PJF.event.publish(PJF.constants.IM_CONNECTED_EVENT):3==e[1]?PJF.event.publish(PJF.constants.IM_CONNECT_FAIL):10==e[1]?PJF.event.publish(PJF.constants.IM_DISCONNECTED_EVENT):11==e[1]?PJF.event.publish(PJF.constants.IM_DISCONNECTED_EVENT):12==e[1]?PJF.event.publish(PJF.constants.IM_DISCONNECTED_EVENT):19==e[1]&&PJF.event.publish(PJF.constants.IM_DISCONNECTED_EVENT);else if("receipts"===i){console.log("################################receive client receipts event");var n=e[3];if(console.log("################################receive client receipts message id"),u.receiptHandler){var o=u._msgQueue[n];console.log("################################receive client receipts message conf:"),o&&(delete u._msgQueue[n],console.log("################################call app receipt handler "),u.receiptHandler(o.toId,o.msg,!0))}}else if("msg"===i){var a=e[1],s=e[2],r=e[3],c=e[4],l=parseInt(e[5])
;0<l&&u.offMsgHandler?u.offMsgHandler(r,s,u.username,a,c,l):u.recMsgHandler&&u.recMsgHandler(r,s,u.username,a,c)}else if("pre"===i)u.onlineStatusHandler&&u.onlineStatusHandler(e[1],"true"===e[2]);else if("room"===i){var d=e[1];"msg"===d?u.chatMsgHandler&&u.chatMsgHandler(e[2],e[3],e[4],null):"pre"===d?u.chatPresHandler&&u.chatPresHandler(e[2],e[3],"true"===e[4]):"join"===d&&u.inviteHandler&&u.inviteHandler(e[2],"","")}}),"true"===PJF.communication.client.imclient("getConnectStatus")[1]?(console.log("即时通讯已连接"),PJF.event.asyncPublish(PJF.constants.IM_CONNECTED_EVENT),u.username=PJF.communication.client.imclient("getid")[1]):(console.log("即时通讯连接失败"),PJF.event.asyncPublish(PJF.constants.IM_CONNECT_FAIL))},PJF.ecp.im.prototype={sendMessageToAll:function(t){"true"==PJF.communication.client.imclient("sendMessageToAll",t.msg)[1]?(console.log("即时通讯:发送所有用户消息成功!"),t.success&&t.success()):(console.log("即时通讯:发送所有用户消息失败!"),t.failure&&t.failure())},sendMessageToMany:function(t){
"true"==PJF.communication.client.imclient("sendMessageToMany",t.toIds,t.msg)[1]?(console.log("即时通讯:发送多人消息成功!"),t.success&&t.success()):(console.log("即时通讯:发送多人消息失败!"),t.failure&&t.failure())},sendMessageToUser:function(t){var e=PJF.communication.client.imclient("sendMessageToUser",t.toId,t.msg,t.pic)[1];if(this.receiptHandler){this._msgQueue[e]=t;var i=this;setTimeout(function(){var t=i._msgQueue[e];t&&(delete i._msgQueue[e],i.receiptHandler(t.toId,t.msg,!1))},9e3)}return e},addRoster:function(t){PJF.communication.client.imclient("addRoster",t)},sendMessageToGroups:function(t){PJF.communication.client.imclient("sendMessageToGroups",t.group,t.msg,t.pic)},logout:function(){PJF.communication.client.imclient("logout")},reLogin:function(){PJF.communication.client.imclient("reLogin")},getUserStatus:function(t,e,i){var n=PJF.communication.client.imclient("getUserStatus",t);e&&e(t,n[1])},createRoom:function(t,e){var i=PJF.communication.client.imclient("createRoom");return t&&t(),i[1]},
inviteUserToRoom:function(t,e,i){PJF.communication.client.imclient("inviteUserToRoom",t,e)},sendRoomMsg:function(t,e){PJF.communication.client.imclient("sendRoomMsg",t,e)}},PJF.namespace("PJF.communication"),PJF.communication.websocket=function(e){WebSocket&&(e.url?(this.ws=new WebSocket(e.url),this.ws.onopen=function(){console.log("建立websocket链接,url为:"+e.url),e.onOpen()},this.ws.onmessage=function(t){console.log("收到服务端信息:"+t),e.onMessage(t)}):console.error("websocket没有传入url"))},PJF.communication.websocket.prototype.sendMessage=function(t){console.log("发送服务端信息:"+t),this.ws.send(t)},PJF.namespace("PJF.communication.ra"),PJF.communication.ra={reauth_tmp_id:"REAUTH_TMP_DATA_VALUE",ra_loading:null,handler_json2str:function(t){if(!t)return"";var e=[],i=function(t){return"object"==typeof t&&null!=t?PJF.communication.ra.handler_json2str(t):/^(string|number)$/.test(typeof t)?'"'+t+'"':t};if(t.constructor===Array){
for(var n in t)"string"==typeof t[n]&&(t[n]=t[n].replace(new RegExp("\\\\","gm"),"\\\\"),t[n]=t[n].replace(new RegExp("'","gm"),"\\'"),t[n]=t[n].replace(new RegExp('"',"gm"),'\\"'),t[n]=t[n].replace(new RegExp("\n","gm"),"\\n"),t[n]=t[n].replace(new RegExp("\r","gm"),"\\r")),e.push(i(t[n]));return"["+e.join(",")+"]"}for(var n in t)"string"==typeof t[n]&&(t[n]=t[n].replace(new RegExp("\\\\","gm"),"\\\\"),t[n]=t[n].replace(new RegExp("'","gm"),"\\'"),t[n]=t[n].replace(new RegExp('"',"gm"),'\\"'),t[n]=t[n].replace(new RegExp("\n","gm"),"\\n"),t[n]=t[n].replace(new RegExp("\r","gm"),"\\r")),e.push('"'+n+'":'+i(t[n]));return"{"+e.join(",")+"}"},initLoading:function(){PJF.communication.ra.ra_loading=new PJF.ui.loading({maskBody:!0,text:"授权进行中..."})},destroyLoading:function(){PJF.communication.ra.ra_loading&&(PJF.communication.ra.ra_loading.destroy(),PJF.communication.ra.ra_loading=null)},copyRefuseInfo:function(cpsJsonData){try{
if(PJF.html.getDom(PJF.communication.ra.reauth_tmp_id)&&PJF.html.getDom(PJF.communication.ra.reauth_tmp_id).value){var copyJsonData={};cpsJsonData&&(copyJsonData=eval("("+cpsJsonData+")"));var tmp=eval("("+PJF.html.getDom(PJF.communication.ra.reauth_tmp_id).value+")");if(tmp&&"object"==typeof tmp){for(var t in tmp)copyJsonData[t]=tmp[t];cpsJsonData=PJF.util.json2str(copyJsonData)}}}catch(e){console.log("ra填充拒绝后再次提交要素失败！")}return cpsJsonData},registerHandler:function(p2sData){PJF.communication.raEvent=function(data){var conf=PJF.loadResource.PJF_LOAD_RESOURCES_CONF,isAjax=!conf.fwServiceId;if(!isAjax&&conf.atchBtchNo&&PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(PJF.loadResource.PJF_LOAD_RESOURCES_CONF.atchBtchNo=uNo[1])}var transJson=isAjax?conf.data.jsonData:conf.jsonData;transJson?"string"==typeof transJson&&(transJson=eval("("+transJson+")")):transJson={};var eventData=eval("("+data+")");if(PJF.communication.client.isInP2()){
var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(transJson.ATCH_BTCH_NO=uNo[1])}if(eventData.EXP_FLG&&!PJF.loadResource.Already_Run)return PJF.loadResource.Already_Run=!1,void PJF.communication.client.unRegisterEvent(eventData.EXP_EVNT);var autMsgHandleType=eventData.autMsgHandleType;if("ECP_AUT"==autMsgHandleType){var repeatEventFlag=!0;if(eventData.AUTH_FLAG||(repeatEventFlag=!1),"1"==eventData.AUTH_FLAG&&authFsm.can("authFTFT")&&(repeatEventFlag=!1,authFsm.authFTFT()),"2"==eventData.AUTH_FLAG&&authFsm.can("authFTST")&&(repeatEventFlag=!1,authFsm.authFTST()),repeatEventFlag)return;PJF.loadResource.Already_Run=!0;var autMsgAuthFlag=eventData.autMsgAuthFlag;if("1"==transJson._inte_trl_auth?transJson.FR_TRAN_TYPE="01":transJson.FR_TRAN_TYPE="00",transJson.AUTH_AUDIT_TAG="1",conf.interceptParams&&conf.interceptParams.beforeRaResend){var tmpData=conf.interceptParams.beforeRaResend(transJson,autMsgAuthFlag,eventData);transJson=tmpData||transJson}else{
if(transJson._auth_info&&transJson._auth_info.AHN_INFOS)if(0<transJson._auth_info.AHN_INFOS.length){for(var i in transJson._auth_info.AHN_INFOS)transJson._auth_info.AHN_INFOS[i].AHN_STFF_ID=eventData.APP_RES_TELLERID,transJson._auth_info.AHN_INFOS[i].AHN_STFF_NM=eventData.APP_RES_TELNAME,transJson._auth_info.AHN_INFOS[i].AHN_RAW_RSN=valData.AUTH_REASON,transJson._auth_info.AHN_INFOS[i].AUTH_TYPE=1;transJson._auth_info.TXN_STFF_ID||(transJson._auth_info.TXN_STFF_ID=PJF.userInfo.userCode),transJson._auth_info.TXN_STFF_NM||(transJson._auth_info.TXN_STFF_NM=PJF.userInfo.userName)}else transJson._auth_info.AHN_INFOS.push({AUTH_TYPE:1,AHN_STFF_ID:eventData.APP_RES_TELLERID,AHN_STFF_NM:eventData.APP_RES_TELNAME,AHN_RAW_RSN:valData.AUTH_REASON}),transJson._auth_info.TXN_STFF_ID||(transJson._auth_info.TXN_STFF_ID=PJF.userInfo.userCode),transJson._auth_info.TXN_STFF_NM||(transJson._auth_info.TXN_STFF_NM=PJF.userInfo.userName);transJson.CCB_EmpID=eventData.APP_RES_TELLERID,
transJson.CCB_EmpNm=eventData.APP_RES_TELNAME,transJson.CCBS_EmpID=eventData.APP_RES_TELLERNO}var ecpMsg=eventData.ECP_MSG;if("ZH"==eventData.APP_YGQZH_FLG&&ecpMsg){transJson._auth_info.AHN_INFOS={};for(var transactions=ecpMsg.split(";"),i=0,len1=transactions.length;i<len1;i++){var transactionId=transactions[i].split(":")[0]||"",ahnCds=(transactions[i].split(":")[1]||"").split("|");transJson._auth_info.AHN_INFOS[transactionId]=[];for(var j=0,len2=ahnCds.length;j<len2;j++)transJson._auth_info.AHN_INFOS[transactionId].push({AHN_CD:ahnCds[j],AHN_STFF_ID:eventData.APP_RES_TELLERID,AHN_STFF_NM:eventData.APP_RES_TELNAME,AUTH_TYPE:1,AHN_RAW_RSN:valData.AUTH_REASON})}if(eventData.APP_YGQZH_MSG)for(var notAuthTrans=eventData.APP_YGQZH_MSG.split(";"),k=0,len3=notAuthTrans.length;k<len3;k++)transJson._auth_info.AHN_INFOS[notAuthTrans[k]]=[];eventData.CART_ID=transJson.CART_ID}conf.authUserInfo={CCB_EmpID:eventData.APP_RES_TELLERID,CCB_EmpNm:eventData.APP_RES_TELNAME,
CCBS_EmpID:eventData.APP_RES_TELLERNO},transJson.auth_seq_no=eventData.AUTH_SEQ_NO,transJson=PJF.util.json2str2(transJson),isAjax?conf.data.jsonData=transJson:PJF.loadResource.PJF_LOAD_RESOURCES_CONF.jsonData=transJson,PJF.communication.ra.raResend(eventData)}else if("P2AUTH_SCANPAGE_HANDLER"==autMsgHandleType){var result=eventData.APP_RES_RSLT;PJF.communication.ra.destroyLoading(),clearInterval(PJF.communication.ra.cacheTimmer),PJF.loadResource.CA_TWICE=!1,PJF.loadResource.PJF_LOAD_RESOURCES_CA_BACKDATA="";var fail=!0;if("b"==result);else if("a"==result||"c"==result){if(PJF.loadResource.CHANGE_SA="1",fail=!1,PJF.html.getDom(PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)==undefined){var winDiv=document.createElement("div");document.body.appendChild(winDiv),winDiv.setAttribute("id",PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)}new PJF.ui.window({dom:PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID,id:PJF.loadResource.PJF_LOAD_RESOURCES_ID,title:"授权",width:420,height:280,
url:CONTEXT_PATH+eventData._TO_SAME_URL,cache:!1,onClose:function(){PJF.auth.endAuth()}}),PJF.communication.client.unRegisterEvent(ECP_AUT),PJF.communication.client.unRegisterEvent(P2AUTH_SCANPAGE)}else if("6"==result){if(PJF.html.getDom(PJF.communication.ra.reauth_tmp_id)==undefined){var winDiv=document.createElement("input");document.body.appendChild(winDiv),winDiv.setAttribute("id",PJF.communication.ra.reauth_tmp_id),winDiv.setAttribute("type","hidden")}var reauth_tmp={};reauth_tmp.AUTH_TLR_NO=eventData.APP_RES_TELLERNO,reauth_tmp.AUTH_TLR_ID=eventData.APP_RES_TELLERID,reauth_tmp.REFUSE_REASON=eventData.APP_RES_INFO1,reauth_tmp.AUTH_TLR_NAME=eventData.APP_RES_TELNAME,PJF.html.getDom(PJF.communication.ra.reauth_tmp_id).value=PJF.util.json2str(reauth_tmp)}else new PJF.ui.messageBox({style:"warning",title:"提示",content:"集中授权未知返回，请检查，result="+result});fail&&PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:"CA"})}};var valData=p2sData._val_data
;"string"==typeof valData&&(valData=eval("("+valData+")"));var authSeqNo=valData.AUTH_SEQ_NO.substring(valData.AUTH_SEQ_NO.length-6),authFsm=PJF.fsm.create({id:authSeqNo,initial:"notAuth",done:"",actions:[{name:"authFTFT",from:"notAuth",to:"authOnce"},{name:"authFTST",from:"authOnce",to:"authTwice"}]}),ECP_AUT="ECP_AUT_"+authSeqNo;PJF.communication.client.registerEvent(ECP_AUT,PJF.communication.raEvent);var P2AUTH_SCANPAGE="P2AUTH_SCANPAGE_"+authSeqNo;PJF.communication.client.registerEvent(P2AUTH_SCANPAGE,PJF.communication.raEvent),PJF.communication.ra.getAuthCacheMsg(valData.AUTH_SEQ_NO+"_JY","JY",PJF.communication.raEvent)},raResend:function(i){var n={},o=PJF.loadResource.PJF_LOAD_RESOURCES_CONF;PJF.loadResource.CA_TWICE=!0,PJF.loadResource.PJF_LOAD_RESOURCES_CA_BACKDATA=i,PJF.apply(n,PJF.loadResource.PJF_LOAD_RESOURCES_CONF),n.success=function(t,e){n.fwServiceId||(i.APP_HOST_SQNO=i.CART_ID||(t._COMMON&&t._COMMON.SYS_EVT_TRACE_ID?t._COMMON.SYS_EVT_TRACE_ID:""),i.APP_HOST_STAT="00",
PJF.communication.ra.tellAuthTransRst(i)),o.success&&o.success(t,e)},n.raTellSuccRst=function(t){i.APP_HOST_SQNO=i.CART_ID||(t._COMMON&&t._COMMON.SYS_EVT_TRACE_ID?t._COMMON.SYS_EVT_TRACE_ID:""),i.APP_HOST_STAT="00",PJF.communication.ra.tellAuthTransRst(i)},n.failure=function(t){o.interceptParams&&o.interceptParams.isRaReAuth&&o.interceptParams.isRaReAuth(t).IS_REAUTH?(i.REAUTH_REASON=t.REAUTH_REASON,PJF.communication.ra.tellAuthMoreRA(i,t)):(i.APP_HOST_SQNO=i.CART_ID||(t._COMMON&&t._COMMON.SYS_EVT_TRACE_ID?t._COMMON.SYS_EVT_TRACE_ID:""),i.APP_HOST_STAT="01",i.APP_HOST_DESC=t.BK_DESC,PJF.communication.ra.tellAuthTransRst(i),o.failure&&o.failure(t))},n.originalSuccess=o.success,n.originalFailure=o.failure,n.pjfReSend=!0,PJF.auth.endAuth(),n.fwServiceId?PJF.communication.cpsJsonReq(n):n.data&&n.data.isFromCrossDomain?(delete n.data.isFromCrossDomain,n.data=JSON.stringify(n.data),PJF.communication.crossDomainReq(n)):PJF.communication.ajax(n),PJF.constants.IS_RA_AUTH=!0},
tellAuthTransRst:function(e){var i={APP_MSG_TYPE:"R"};if(i.AUTH_SEQ_NO=e.AUTH_SEQ_NO,i.AUTH_SEQ_SUB_NO=e.AUTH_SEQ_SUB_NO,i.APP_HOST_SQNO=e.APP_HOST_SQNO,i.APP_HOST_STAT=e.APP_HOST_STAT,i.APP_REQ_SYS=e.APP_REQ_SYS,i.APP_HOST_DESC=e.APP_HOST_DESC,"TOP"!=e.APP_REQ_SYS||"PBCS"!=e.APP_REQ_SYS){var t={QUERY_TRACE_ID:e.APP_HOST_SQNO};PJF.communication.cpsJsonReq({jsonData:PJF.util.json2str(t),fwServiceId:"loadSeqIDByTraceId",fwTranId:"loadSeqIDByTraceId",async:!1,success:function(t){t.BK_RESULT?i.SCAN_SEQ_ID=t.BK_RESULT:console.info("SUCC-扫描ID获取失败："+e.AUTH_SEQ_NO)},failure:function(t){console.info("FAIL-扫描ID获取失败："+e.AUTH_SEQ_NO)}})}PJF.communication.client.sendEvent("P2AUTH_APPTRANS_"+e.AUTH_SEQ_NO.substring(e.AUTH_SEQ_NO.length-6),PJF.communication.ra.handler_json2str(i)),PJF.communication.ra.destroyLoading(),PJF.loadResource.CA_TWICE=!1,PJF.loadResource.PJF_LOAD_RESOURCES_CA_BACKDATA=""},tellAuthMoreRA:function(params,p2sdata){var valData=p2sdata._val_data
;"string"==typeof valData&&(valData=eval("("+valData+")"));var reply={APP_MSG_TYPE:"B",AUTH_FLAG:"2"};reply.AUTH_SEQ_SUB_NO=params.AUTH_SEQ_SUB_NO,reply.AUTH_SEQ_NO=params.AUTH_SEQ_NO,reply.AUTH_TLR_NO=params.APP_RES_TELLERNO,reply.AUTH_TLR_ID=params.APP_RES_TELLERID,reply.AUTH_TLR_NAME=params.APP_RES_TELNAME,reply.SND_AUTH_RSN=valData.REAUTH_REASON;for(var reg=/[\"\']/;reg.test(reply.SND_AUTH_RSN);)reply.SND_AUTH_RSN=reply.SND_AUTH_RSN.replace(reg,"");PJF.communication.client.sendEvent("P2AUTH_APPTRANS_"+params.AUTH_SEQ_NO.substring(params.AUTH_SEQ_NO.length-6),PJF.communication.ra.handler_json2str(reply)),PJF.communication.ra.getAuthCacheMsg(valData.AUTH_SEQ_NO+"_SE","SE",PJF.communication.raEvent)},getAuthCacheMsg:function(e,t,i){var n="RA"==t||"SE"==t?3:8,o=1;PJF.communication.ra.cacheTimmer=setInterval(function(){if(n<=o){var t={cacheKey:e};PJF.communication.ajax({data:{jsonData:PJF.util.json2str(t),_fw_service_id:"AuthCacheService"},url:"ecpJson.action",success:function(t){
"00"==t.STAT&&t.MSG&&(i(t.MSG),clearInterval(PJF.communication.ra.cacheTimmer))},failure:function(t){console.log("轮询失败，cachekey="+e)}})}o++},5e3)}},"undefined"==typeof PJF&&(PJF={},PJF.communication={},PJF.constants={},PJF.util={getClientVersion:function(){if(!PJF.constants.clientVersion){var t=PJF.constants.clientVersion="";if(PJF.communication.client.isInP2())try{var e=PJF.communication.client.getClientEnv("localVersion");t=(t=0==e[0]?e[1]:t)||""}catch(i){}PJF.constants.clientVersion=t}return PJF.constants.clientVersion},compareClientVersion:function(t){for(var e=PJF.util.getClientVersion(),i=t.split("."),n=e.split("."),o=Math.min(n.length,i.length),a=0;a<o;a++){i[a]=i[a].match(/[0-9]+/),i[a]=i[a]?i[a][0]:0,n[a]=n[a].match(/[0-9]+/),n[a]=n[a]?n[a][0]:0;var s=parseInt(i[a],10),r=parseInt(n[a],10);if(r<s)return!1;if(s<r)return!0}return i.length<=n.length}}),PJF.communication.device={GET_CARDINFO_COMMAND:"getCardInfo",GET_ACCOUNT_PASSWORD:"getAccountPassword",
GET_FINGER_INFO:"getFingerInfo",GET_BANK_BOOK_INFO:"getBankBookInfo",WRITE_FINGER_INFO:"writeFingerInfo",WRITE_BANK_BOOK:"writeBankBook",GET_USERINFO_COMMAND:"getUserInfo",PRINT_DOC:"printDoc",PRINT_SCREEN:"printScreen",GET_IDENTITY_CARD_INFO:"getIdentityCardInfo",GET_IC_CARD_INFO:"getIcCardInfo",GET_CONF_VALUE:"getConfValue",GET_FINGER_PORT:"getFingerPort",GET_FINGER_TYPE:"getFingerType",GET_PIC_PATH:"getPicPath",WRITE_PIC:"writePic",GET_CONF_FILE:"getConfFile",ENCODE:"encode",DECODE:"decode",GET_BP_PORT:"getBpPort",GET_FILE_BYTES:"getFileBytes",ENCRYPT_PARAM:"encryptParam",ENCRYPT_0X88:"encrypt0x88",CALENDER_CUR_DATE:"calendarCurDate",LOG_ERROR:"logError",SET_TAB_TITLE:"setTabTitle",GET_USERINFO:"getUserInfo",GEN_ARQC:"genARQC",GET_TX_DETAIL:"getTxDetail",SEND_ARQC:"sendARQC",TRANSC_DISP_CONFIRM:"transcDispConfirm",SINGLE_QUESTION:"singleQuestion",MULTI_QUESTION:"multiQuestion",GET_SCHEDULE:"getSchedule",OPEN_NATIVE_WINDOW:"openNativeWindow",OPEN_INNER_WINDOW:"openInnerWindow",
GETDEVCONF:"getDevConfig",MAC_CONTENT:"macContent",GET_UNIQUE_NO:"getUniqueNo",OPEN_AUTH_PAGE:"openAuthPage",INVOKE_OTHER_SIDE:"invokeOtherSide",AUTH_PACK_UPLOAD:"authPackUpload",TAB_CLOSE:"tabClose",OPEN_TODOINFO:"openTodoInfo",DO_COMMAND:"doCommonCommand",SEND_HTTP:"sendHttp",GET_MESSAGE_BYNO:"getMessageByKey",GET_CLIENTENV_PROPERTY:"getClientEnv",SET_APP_DATA:"setAppData",GET_APP_DATA:"getAppData",REMOVE_APP_DATA:"removeAppData",SOFT_PHONE:"softPhone",ZTE_PHONE:"ztePhone",CLICK_MOUSE:"clickMouse",REGISTER_EVENT:"registerEvent",UNREGISTER_EVENT:"unRegisterEvent",SEND_EVENT:"sendEvent",RIGHT_PANEL_METHOD:"rightPanelCommand",CHECK_FILE_SIZE:"checkFileSize",CONFIRM_TRANSC_DISP:"confirmTranscDisp",LOAD_DEV_CONFIG:"loadDevConfig",SAVE_DEV_CONFIG:"saveDevConfig",TEST_DEV_CONFIG:"testDevConfig",GET_COMPUTER_INFO:"getComputerInfo",OPEN_FRONT_CONFIG:"openFrontConfig",SET_SELECT:"setSelect",CALCULATE_DATA:"calculateData",PRINT_TEXT:"printUrlText",EXECUTE_JS:"executeJS",
WRITE_TRACK:"writeTrack",GET_TAB_NUM:"getTabNum",LOG_JS:"logJs",LINE_UP_CALL:"lineupCall",CLOSE_WIN:"closeWin",GET_IP_BY_ROUTEID:"getIPByRouteId",UPLOAD_HTTP_REQ:"uploadHttpReq",TAR_PACKAGE:"tarPackage",ENCODE_URL:"encodeUrl",CALL_DEVICE:"callDevice",GET_UC:"getUC",PRINT_DOWNLOAD_BATCHFILE:"printDownloadBatchFile",PJF_CACHE:"pjfCache",CALL_DEVICE_ASYNC:"callDeviceAsync",ENCRYPT_E2E:"encryptE2E",CR_2_TAB:"Cr2Tab",CAMERA_SHOOT:"cameraShoot",CAMERA_SHOOT_2:"cameraShoot2",CAMERA_SHOOT_3:"cameraShoot3",FILE_UTILS:"fileUtils",FILE_UTILS_2:"fileUtils2",GET_ID_FULL_PIC:"getIDFullPic",DECODE_F2M:"decodeF2M",ENCODE_S2M:"encodeS2M",ENCODE_QRM:"encodeQRM",DECODE_QRM:"decodeQRM",COVER_PLATFORM:"coverPlatform",DIALOGLOCK_PLATFORM:"dialogLockPlatform",ELEC_SIGN_VOUCHER_COMPSE:"elecSignVoucherCompse",CREATE_VOUCHER_BACK_GRD:"createVoucherBackGrd",DOUBLE_CAMERA:"doubleCamera",NISEC_SKSC:"nisecSksc",ScreenCut4IM:"ScreenCut4IM",GET_CHIP_INFO:"getChipInfo",DECODE_IDWLT:"decodeIDWlt",
GET_IDCHIP_INFO:"getIDChipInfo",imclient:"imclient",clipboardCmd:"clipboardCmd"},PJF.communication.event={},PJF.communication.pjfHandleEvent=function(t,e){return PJF.communication.event&&PJF.communication.event[e]?PJF.communication.event[e](t):PJF.communication.handleEvent(t)},PJF.communication.client=function(){var _afterHandler=function(cmd,result){if(result&&0==result[0]){var _handlers={getCardInfo:function(){PJF.otherInfo&&(PJF.otherInfo.customerAcctNo=result[1])},getIcCardInfo:function(){PJF.otherInfo&&(PJF.otherInfo.customerAcctNo=eval("("+result[1]+")").accountNo)},getBankBookInfo:function(){PJF.otherInfo&&(PJF.otherInfo.customerAcctNo=result[1])},getIdentityCardInfo:function(){"string"==typeof result[6]&&(result[6]=result[6].toUpperCase(),(15==result[6].length||result[6].match(/[a-z]{3}$/i))&&result.splice(0,result.length,"1","格式错误，请提供有效二代身份证件!")),PJF.otherInfo&&(PJF.otherInfo.customerIdenNm=result[1]),PJF.otherInfo&&(PJF.otherInfo.customerIdenNo=result[6])},genARQC:function(){
PJF.communication.client.setAppData("PJF_DATA","ARQC",PJF.util.jsontostr(result.slice(1)))}};try{_handlers[cmd]&&_handlers[cmd]()}catch(e){console.log("sendNSCommand afterHandler异常:"+e.message)}}},proxy=function(n){return function(){if(PJF.constants&&PJF.constants.IS_BSLOGIN_MODEL)return alert("您当前处于浏览器登录模式，无法调用外设，请在客户端中使用相应功能"),[0,"","","","","","","","","","","",""];for(var t=[n],e=0;e<arguments.length;e++)t=t.concat(arguments[e]);if(PJF.communication.beforeSendNSCommandRule[t[0]]&&"notSendToClient"==(t=PJF.communication.beforeSendNSCommandRule[t[0]](t))[0])return Array.prototype.slice.call(t,1);var i=sendNSCommand.apply(this,t);return _afterHandler(n,i),i}},result={p2AfterLoadCallBack:function(userInfo,orgInfo,roleInfo,otherInfo){try{if(userInfo=userInfo.replace(new RegExp("\n","gm"),"\\n"),orgInfo=orgInfo.replace(new RegExp("\n","gm"),"\\n"),roleInfo=roleInfo.replace(new RegExp("\n","gm"),"\\n"),PJF.userInfo=eval("("+userInfo+")"),PJF.orgInfo=eval("("+orgInfo+")"),
PJF.orgInfo.adivCd&&5<PJF.orgInfo.adivCd.length){PJF.orgInfo.levOne_code=PJF.orgInfo.adivCd.substring(0,2)+"0000";var tempCode=PJF.orgInfo.levOne_code;tempCode==""+PJF.constants.AREA_BEIJING||tempCode==""+PJF.constants.AREA_TIANJING||tempCode==""+PJF.constants.AREA_SHANGHAI||tempCode==""+PJF.constants.AREA_CHONGQING?PJF.orgInfo.levTwo_code=tempCode:PJF.orgInfo.levTwo_code=PJF.orgInfo.adivCd.substring(0,4)+"00"}var instMap={DF001:"中德银行",DEFAULT:"中国建设银行"};PJF.orgInfo&&PJF.orgInfo.instSvrlLgPsnID&&(PJF.orgInfo.bankName=instMap[PJF.orgInfo.instSvrlLgPsnID]||instMap.DEFAULT),PJF.roleInfo=eval("("+roleInfo+")"),otherInfo&&(otherInfo=otherInfo.replace(new RegExp("\n","gm"),"\\n"),PJF.otherInfo=eval("("+otherInfo+")"));var menuId=PJF.communication.client.getClientEnv("cuurentMenu.menuId");if(menuId&&"0"==menuId[0]&&!PJF.constants.D2D){var jsonData=PJF.util.json2str({MENU_ID:menuId[1]});PJF.communication.cpsJsonReq({jsonData:jsonData,fwServiceId:"databaseTransaction",fwTranId:"findList",
sqlId:"common.queryTradeDsecById",success:function(t){var e=t.database_result;if(e&&0<e.length&&(e[0].DSC||e[0].HELP_URL)){var i=e[0].DSC,n=e[0].HELP_URL;if(PJF.communication.client.isInP2()&&e[0].KID){var o=PJF.communication.client.getIPByRouteId("klm");i+="<br>如需了解更详细的信息，请&nbsp;&nbsp;&nbsp;<a target='_blank' href = '"+(o+="klm/page/knowledge/showKnowledge/knowledgeDetail.jsp?kwId="+e[0].KID)+"'>访问知识库</a>"}PJF.constants.floatDiv?PJF.constants.floatDiv.setMessage(i,n):PJF.constants.floatDiv=new PJF.ui.floatDiv({msg:i,helpUrl:n})}},failure:function(t){}})}}catch(exception){alert(exception)}if(console.log("开启键盘:"+PJF.constants.KEYBOARD_ENABLE),PJF.constants.KEYBOARD_ENABLE&&!PJF.constants.D2D){var keyTip=$('<img src="/bosWeb/css/images/keyboard.png" width="25px" height="25px" style="position:fixed;top:5px;right:20px"/>');keyTip.appendTo("body")}if("0"==PJF.html.getUrlParam("transCart")&&!PJF.constants.D2D){
var jiaoyiche=$('<a class="pjf_jiaoyiche_container"><div class="pjf_jiaoyiche_img"></div><p id="'+PJF.loadResource.PJF_JIAOYICHE_TEXT_ID+'">交易车(0)<p></a>');jiaoyiche.on("click",function(){PJF.html.openWin(PJF.loadResource.PJF_JIAOYICHE_URL)}),jiaoyiche.appendTo("body")}},getUserInfo:function(){if(PJF.userInfo)return PJF.userInfo;alert("无法得到用户信息，请检查js是否执行正确!")},customKeyboard:function(){document.onkeydown=function(t){if(8==event.keyCode&&("INPUT"!=event.srcElement.tagName.toUpperCase()&&"TEXTAREA"!=event.srcElement.tagName.toUpperCase()||("INPUT"==event.srcElement.tagName.toUpperCase()||"TEXTAREA"==event.srcElement.tagName.toUpperCase())&&event.srcElement.readOnly))return event.keyCode=0,void(event.returnValue=!1);"submit"!=event.srcElement.type&&"image"!=event.srcElement.type&&"textarea"!=event.srcElement.type&&13==event.keyCode&&(event.keyCode=50)}},isInP2:function(){return"undefined"!=typeof sendNSCommand}};for(var a in PJF.communication.device){var fnName=PJF.communication.device[a]
;result[fnName]=proxy(fnName)}return result}(),PJF.communication.beforeSendNSCommandRule={registerEvent:function(t){return 3==t.length&&(PJF.communication.event[t[1]]=t[2]),t},openNativeWindow:function(t){return"string"==typeof t[1]&&(t[1]=PJF.util.addAtchBtchNoToUrl(t[1])),t},printUrlText:function(t){return"string"==typeof t[1]&&(t[1]=PJF.util.addAtchBtchNoToUrl(t[1])),t}},PJF.communication.client.pjfAsyncCall=function(t,e,i){var n,o=PJF.util.generateUUid();i.splice(e,0,o);for(var a=0,s=i.length;a<s;a++)if("function"==typeof i[a]){n=i[a];break}i[a]="PJF.communication.client.pjfAsyncCallBack",PJF.event.onceSubscriber(o,n),window.eval(t).apply(window,i)},PJF.communication.client.pjfAsyncCallBack=function(t){var e=t[t.length-1],i=Array.prototype.slice.call(t,0,t.length-1);PJF.event.publish(e,i)},PJF.communication.client.checkVerifyCode=function(verifyCode,strTimeout){if(verifyCode&&null!=verifyCode&&""!=verifyCode){var inData={bizArgs:{}
},devConfigStr=PJF.communication.client.getDevConfig("dev_telclr"),devConfig=eval("("+devConfigStr+")");return"true"==devConfig.dev_pin?inData.devKindId="dev_telclr":inData.devKindId="dev_pin",inData.interfaceId="readPin",inData.funcId="checkVerifyCode",inData.verifyCode=verifyCode,inData.bizArgs.iTimes="1",strTimeout&&(inData.bizArgs.strTimeout=strTimeout),PJF.communication.client.callDevice(PJF.util.json2str(inData))}new PJF.ui.messageBox({style:"warning",title:"消息",content:"验证码不能为空"})},PJF.communication.client.serviceEvaluate=function(t,e,i,n){if(!(arguments.length<3)){var o={bizArgs:{},devKindId:"dev_telclr",interfaceId:"serviceEvaluate"};o.bizArgs.strOperData=t,o.bizArgs.strDispData=e,o.bizArgs.strItem=i,o.bizArgs.strVoiceNo="10",o.bizArgs.strDispTimeout="10",o.bizArgs.strTimeout=n;var a=PJF.communication.client.callDevice(PJF.util.json2str(o));return"0"==a[0]&&(a[1]=a[2]),a}new PJF.ui.messageBox({style:"warning",title:"消息",content:"传入参数不正确"})},
PJF.communication.client.inputNumber=function(t,e,i,n){var o={bizArgs:{},devKindId:"dev_telclr",interfaceId:"inputNumber"};t&&(o.bizArgs.iStyle=t),e&&(o.bizArgs.iLength=e),i&&(o.bizArgs.iControlType=i),n&&(o.bizArgs.strVoiceNo=n);var a=PJF.communication.client.callDevice(PJF.util.json2str(o));return"0"==a[0]&&(a[1]=a[2]),a},PJF.communication.client.readCISN=function(t){if("0"==t||"1"==t){var e={bizArgs:{},devKindId:"dev_mmq",interfaceId:"readCISN"};e.bizArgs.nStep=t;var i=PJF.communication.client.callDevice(PJF.util.json2str(e));return"0"==i[0]&&(i[1]=i[2]),i}new PJF.ui.messageBox({style:"warning",title:"消息",content:"步号只能为0或1"})},PJF.communication.client.generateKeyPair=function(t,e){if(!(arguments.length<2)){var i={bizArgs:{},devKindId:"dev_mmq",interfaceId:"generateKeyPair"};i.bizArgs.nStep=e,i.bizArgs.strAcc=t;var n=PJF.communication.client.callDevice(PJF.util.json2str(i));return"0"==n[0]&&(n[1]=n[2],n[2]=n[3]),n}new PJF.ui.messageBox({style:"warning",title:"消息",content:"传入参数不正确"})
},PJF.communication.client.downLoadAK=function(t,e,i,n){if(!(arguments.length<4)){var o={bizArgs:{},devKindId:"dev_mmq",interfaceId:"downLoadAK"};return o.bizArgs.nStep=n,o.bizArgs.strAcc=t,o.bizArgs.strACCKey=e,o.bizArgs.strAK=i,PJF.communication.client.callDevice(PJF.util.json2str(o))}new PJF.ui.messageBox({style:"warning",title:"消息",content:"传入参数不正确"})},PJF.communication.client.delAcc=function(t,e){if(!(arguments.length<2)){var i={bizArgs:{},devKindId:"dev_mmq",interfaceId:"delAcc"};return i.bizArgs.nStep=e,i.bizArgs.strAcc=t,PJF.communication.client.callDevice(PJF.util.json2str(i))}new PJF.ui.messageBox({style:"warning",title:"消息",content:"传入参数不正确"})},PJF.communication.client.addMachineSign=function(t,e,i,n){if(!(arguments.length<4)){var o={bizArgs:{},devKindId:"dev_mmq",interfaceId:"addMachineSign"};o.bizArgs.strAcc=t,o.bizArgs.strNewChipID=e,o.bizArgs.strNewVK=i,o.bizArgs.nStep=n;var a=PJF.communication.client.callDevice(PJF.util.json2str(o));return"0"==a[0]&&(a[1]=a[2]),a}
new PJF.ui.messageBox({style:"warning",title:"消息",content:"传入参数不正确"})},PJF.communication.client.unlockCI=function(t,e){if(!(arguments.length<2)){var i={bizArgs:{},devKindId:"dev_mmq",interfaceId:"unlockCI"};return i.bizArgs.nStep=e,i.bizArgs.strUnlockCode=t,PJF.communication.client.callDevice(PJF.util.json2str(i))}new PJF.ui.messageBox({style:"warning",title:"消息",content:"传入参数不正确"})},PJF.communication.client.issueCI=function(t,e){if(!(arguments.length<2)){var i={bizArgs:{},devKindId:"dev_mmq",interfaceId:"issueCI"};return i.bizArgs.nStep=e,i.bizArgs.strUnlockCode=t,PJF.communication.client.callDevice(PJF.util.json2str(i))}new PJF.ui.messageBox({style:"warning",title:"消息",content:"传入参数不正确"})},PJF.communication.client.getCheckCode=function(t,e){if(t&&null!=t&&""!=t){if(e&&null!=e&&""!=e){var i={bizArgs:{},devKindId:"dev_mmq",interfaceId:"getCheckCode"};return i.bizArgs.strContent=t,i.bizArgs.iLen=e,PJF.communication.client.callDevice(PJF.util.json2str(i))}new PJF.ui.messageBox({
style:"warning",title:"消息",content:"数据长度不能为空"})}else new PJF.ui.messageBox({style:"warning",title:"消息",content:"算校验码的数据不能为空"})},PJF.communication.client.getscanners=function(){var t={devKindId:"dev_scanner",interfaceId:"getAvailableDataSources",bizArgs:{}};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.deleteFile=function(t,e){var i={devKindId:"dev_scanner",interfaceId:"deleteFile"};return i.bizArgs={nFlag:t,strFileName:e},PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.rotate=function(t,e){var i={devKindId:"dev_scanner",interfaceId:"rotate"};return i.bizArgs={strFileName:t,dAngle:e},PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.zoom=function(t,e,i){var n={devKindId:"dev_scanner",interfaceId:"zoom"};return n.bizArgs={strFileName:t,nWidth:e,nHeight:i},PJF.communication.client.callDevice(PJF.util.json2str(n))},PJF.communication.client.copyFile=function(t,e){var i={
devKindId:"dev_scanner",interfaceId:"copyFile"};return i.bizArgs={strSrcFileName:t,strDstFileName:e},PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.renameFile=function(t,e){var i={devKindId:"dev_scanner",interfaceId:"renameFile"};return i.bizArgs={strSrcFileName:t,strDstFileName:e},PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.showUI=function(){var t={devKindId:"dev_scanner",interfaceId:"showUI"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.serviceEvaluateAsync=function(t,e,i,n,o,a){if(arguments.length<6)new PJF.ui.messageBox({style:"warning",title:"消息",content:"传入参数不正确"});else{var s={bizArgs:{},devKindId:"dev_telclr",interfaceId:"serviceEvaluate"};s.bizArgs.strOperData=t,s.bizArgs.strDispData=e,s.bizArgs.strItem=i,s.bizArgs.strVoiceNo="10",s.bizArgs.strDispTimeout="10",s.bizArgs.strTimeout=n,PJF.communication.client.callDeviceAsync(a,o,PJF.util.json2str(s))}},
PJF.communication.client.scan=function(t){var e={devKindId:"dev_scanner",interfaceId:"scanWithParams",bizArgs:{showUI:"false",params:{imagePath:"D:\\CCB\\ECP\\Temp",ICAP_IMAGEFILEFORMAT:"ICAP_IMAGEFILEFORMAT"}}};return PJF.communication.client.callDeviceAsync(t,"",PJF.util.json2str(e))},PJF.communication.client.getscanners=function(){var t={devKindId:"dev_scanner",interfaceId:"getAvailableDataSources",bizArgs:{}};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.deleteFile=function(t,e){var i={devKindId:"dev_scanner",interfaceId:"deleteFile"};return i.bizArgs={nFlag:t,strFileName:e},PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.rotate=function(t,e){var i={devKindId:"dev_scanner",interfaceId:"rotate"};return i.bizArgs={strFileName:t,dAngle:e},PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.zoom=function(t,e,i){var n={devKindId:"dev_scanner",interfaceId:"zoom"}
;return n.bizArgs={strFileName:t,nWidth:e,nHeight:i},PJF.communication.client.callDevice(PJF.util.json2str(n))},PJF.communication.client.copyFile=function(t,e){var i={devKindId:"dev_scanner",interfaceId:"copyFile"};return i.bizArgs={strSrcFileName:t,strDstFileName:e},PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.renameFile=function(t,e){var i={devKindId:"dev_scanner",interfaceId:"renameFile"};return i.bizArgs={strSrcFileName:t,strDstFileName:e},PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.showUI=function(){var t={devKindId:"dev_scanner",interfaceId:"showUI"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.getSecTrackData=function(){var inData={bizArgs:{}},devConfigStr=PJF.communication.client.getDevConfig("dev_iccard"),devConfig=eval("("+devConfigStr+")");"true"==devConfig.dev_rdcard?inData.devKindId="dev_iccard":inData.devKindId="dev_rdcard",
inData.interfaceId="getBookAcct";var aryRet=PJF.communication.client.callDevice(PJF.util.json2str(inData));return aryRet},PJF.communication.client.getICCardData=function(){var t={bizArgs:{},devKindId:"dev_iccard",interfaceId:"getICCardInfo"};t.bizArgs.iIcFlag="3",t.bizArgs.aryTagList="x41,x42,x43,x44,x45,x46,x47,x48,x49,x4a";var e="A000000333010101|A000000333010102|A000000333010103|A000000333010106";PJF.util.compareClientVersion("1.3")&&(e+="|A0000000031010|A000000241010102|A0000000041010"),PJF.util.compareClientVersion("1.3","1")&&(e+="|A0000000651010"),t.bizArgs.strAIDList=e;var i=PJF.communication.client.callDevice(PJF.util.json2str(t));if("0"==i[0]){var n={},o={},a=i[3],s=a.length;if(s<4)return new Array("DEV9999999","读IC卡信息返回值有错");var r=0;try{for(;r<s;){var c=a.substring(r+1,r+4),l=Number(c),d=a.substring(r+4,r+4+l);o[a.substring(r,r+1)]=d,r=r+4+l}}catch(u){return new Array("DEV9999999","读IC卡信息返回值有错")}if(!o.I){
if(-1==(r=a.lastIndexOf("I006")))return new Array("DEV9999999","读IC卡信息返回值有错");o.I=a.substring(r+4,r+10)}if(!o.J){if(-1==(r=a.lastIndexOf("J003")))return new Array("DEV9999999","读IC卡信息返回值有错");o.J=a.substring(r+4,r+7)}return n.ICCardType=i[2],n.accountNo=o.A,PJF.constants.SUPPORT_ARQC_MANAGER&&PJF.arqcManager.setLastICCardNo(n.accountNo),n.userName=o.B,n.cardType=o.C,n.cardNo=o.D,n.secDisInfo=o.E,n.firDisInfo=o.F,n.balance=o.G,n.balanceLimit=o.H,n.validTime=o.I,n.ICcardNo=o.J,new Array("0",n)}return i},PJF.communication.client.validateCode=function(code,strTimeout){var retn=[];if(!code||null==code||""==code)return retn[0]="1",retn[1]="验证码不能为空",retn;var devConfigStr=PJF.communication.client.getDevConfig("dev_telclr"),devConfig=eval("("+devConfigStr+")"),inData={bizArgs:{},devKindId:"dev_telclr"};"false"==devConfig.validate?(inData.interfaceId="readPin",inData.bizArgs.iTimes="1",inData.bizArgs.iLength="6"):(inData.interfaceId="inputNumber",inData.bizArgs.iStyle="0",
inData.bizArgs.iLength="6",inData.bizArgs.iControlType="1",inData.bizArgs.strVoiceNo="11"),strTimeout&&(inData.bizArgs.strTimeout=strTimeout);var aryRet=PJF.communication.client.callDevice(PJF.util.json2str(inData));return"0"==aryRet[0]?aryRet[2]==code?(retn[0]="0",retn[1]="true"):(retn[0]="1",retn[1]="验证码输入错误"):retn=aryRet,retn},PJF.communication.client.getCardRdWrtCap=function(){var devConfigStr=PJF.communication.client.getDevConfig("dev_iccard"),devConfig=eval("("+devConfigStr+")");if(!devConfig.devTypeId)return["0","2"];var inData={bizArgs:{},devKindId:"dev_iccard",interfaceId:"getCardRdWrtCap"},aryRet=PJF.communication.client.callDevice(PJF.util.json2str(inData));return aryRet},PJF.communication.client.printVoucher=function(t,e){var i={bizArgs:{},devKindId:"dev_voucherprt",interfaceId:"printVoucher"};return i.bizArgs.jsonStr=t,i.bizArgs.elecSignBASE64Data=e||"",PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.printTxt2DimCode=function(t,e,i){
var n={bizArgs:{},devKindId:"dev_dimprt",interfaceId:"printTxt2DimCode"};return n.bizArgs.strArryTxtInfo=t,n.bizArgs.nTxtInfoCnt=e,n.bizArgs.dimCodeInfo=i,PJF.communication.client.callDevice(PJF.util.json2str(n))},PJF.communication.client.printCheck=function(t){var e={bizArgs:{},devKindId:"dev_checkprt",interfaceId:"printCheck"};return e.bizArgs=t,PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.getCheckPrintContent=function(t){if(t.success&&t.fmtPrintId&&t.jsonData){var e=!1;t.async&&(e=t.async);var i={_fw_service_id:"checkPrintServiceReq"};i.unitedVoucherId=t.fmtPrintId,i.jsonData=PJF.util.json2str(t.jsonData),PJF.communication.ajax({data:i,async:e,url:"ecpJson.action",success:t.success})}else alert("PJF.communication.getCheckPrintContent需要的参数信息不正确!")},PJF.communication.client.compareFinger=function(t,e){var i={bizArgs:{},devKindId:"dev_fing",interfaceId:"compareFinger"};return i.bizArgs.strFeatCode=t,i.bizArgs.strTempCode=e,
PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.validateCode=function(code,strTimeout){var retn=[];if(!code||null==code||""==code)return retn[0]="1",retn[1]="验证码不能为空",retn;var inData={bizArgs:{},devKindId:"dev_telclr"},validate="false",devConfigStr=PJF.communication.client.getDevConfig("dev_telclr"),devConfig=eval("("+devConfigStr+")");devConfig.validate&&(validate=devConfig.validate),"false"==validate?(inData.interfaceId="readPin",inData.bizArgs.iTimes="1",inData.bizArgs.iLength="6"):(inData.interfaceId="inputNumber",inData.bizArgs.iStyle="0",inData.bizArgs.iLength="6",inData.bizArgs.iControlType="1",inData.bizArgs.strVoiceNo="11"),strTimeout&&(inData.bizArgs.strTimeout=strTimeout);var aryRet=PJF.communication.client.callDevice(PJF.util.json2str(inData));return"0"==aryRet[0]?aryRet[2]==code?(retn[0]="0",retn[1]="true"):(retn[0]="1",retn[1]="验证码输入错误"):retn=aryRet,retn},PJF.communication.client.startTIDRead=function(){var t={bizArgs:{},
devKindId:"dev_tid",interfaceId:"startTIDRead"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.readTIDInfo=function(t){var e={bizArgs:{},devKindId:"dev_tid",interfaceId:"readTIDInfo"};return e.bizArgs.iPreReadNum=t,PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.stopTIDRead=function(){var t={bizArgs:{},devKindId:"dev_tid",interfaceId:"stopTIDRead"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.getSignature=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_telclr",e.interfaceId="getSignature",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.printCheckAsync=function(t,e,i){var n={bizArgs:{},devKindId:"dev_checkprt",interfaceId:"printCheck"};n.bizArgs=t,PJF.communication.client.callDeviceAsync(e,i,PJF.util.json2str(n))},PJF.communication.client.getSignatureAsync=function(t,e,i){var n={};n.bizArgs=t,n.devKindId="dev_telclr",
n.interfaceId="getSignature",PJF.communication.client.callDeviceAsync(e,i||"",PJF.util.json2str(n))},PJF.communication.client.wrtSdbUnlockInfo=function(t){var e={bizArgs:{},devKindId:"dev_bgk",interfaceId:"wrtSdbUnlockInfo"};return e.bizArgs.openBoxInfo=t,PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getSdbPubKeyErrInfo=function(){var t={bizArgs:{},devKindId:"dev_bgk",interfaceId:"getSdbPubKeyErrInfo"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.getSdbPubKeyPinInfo=function(){var t={bizArgs:{},devKindId:"dev_bgk",interfaceId:"getSdbPubKeyPinInfo"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.getSdbICCardInfo=function(){var t={bizArgs:{},devKindId:"dev_bgi",interfaceId:"getSdbICCardInfo"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.initHYICCard=function(t,e){var i={};i.bizArgs=t,i.devKindId="dev_hic",
i.interfaceId="initHYICCard",PJF.communication.client.callHicDevice(i,e)},PJF.communication.client.closeHYICCard=function(t,e){var i={};i.bizArgs=t,i.devKindId="dev_hic",i.interfaceId="closeHYICCard",PJF.communication.client.callHicDevice(i,e)},PJF.communication.client.resetHYICCard=function(t,e){var i={};i.bizArgs=t,i.devKindId="dev_hic",i.interfaceId="resetHYICCard",PJF.communication.client.callHicDevice(i,e)},PJF.communication.client.readWriteHYICCard=function(t,e){var i={};i.bizArgs=t,i.devKindId="dev_hic",i.interfaceId="readWriteHYICCard",PJF.communication.client.callHicDevice(i,e)},PJF.communication.client.callHicDevice=function(jsonData,callBack){var inData=jsonData;PJF.communication.ajax({url:"/bosWeb/ecpJson2Bean.action",data:{_fw_service_id:"databaseTransaction",transaction_id:"findList",_sql_id:"hic.queryDevtypeByBusinessCode",jsonData:PJF.util.json2str({businessCode:inData.bizArgs.businessCode}),jsonClass:"java.util.Map"},success:function(responseData){
if("00"==responseData.BK_STATUS){var result=responseData.database_result;if(0==result.length)callBack(["1","通过收费项目编号找不到对应的驱动信息！！"]);else{var devtype_id,driver_resource="",dev_kind="0",hicConfig=eval("("+PJF.communication.client.getDevConfig("dev_hic")+")"),iccardConfig=eval("("+PJF.communication.client.getDevConfig("dev_iccard")+")");for(var i in result){if(dev_kind=result[i].DEV_KIND,devtype_id=result[i].DEVTYPE_ID,driver_resource=result[i].DRIVER_RESOURCE,"0"!=dev_kind)break;if(devtype_id==hicConfig.deviceType)break}if(inData.bizArgs.devTypeId=driver_resource,"0"==dev_kind){inData.bizArgs.strPort=iccardConfig.strPort;var bpConfig={};bpConfig.b2cPort=iccardConfig.b2cPort,bpConfig.bpBaudRate=iccardConfig.bpBaudRate,bpConfig.d2bPort=iccardConfig.d2bPort,bpConfig.isConBp=iccardConfig.isConBP,inData.bpConfig=bpConfig}else inData.bizArgs.strPort=hicConfig["strPort_"+dev_kind];callBack(PJF.communication.client.callDevice(PJF.util.json2str(inData)))}
}else callBack(["1",responseData.BK_STATUS+"-"+responseData.BK_DESC])},failure:function(t){callBack(["1",t.BK_CODE+"-"+t.BK_DESC])}})},PJF.communication.client.fileDispConfirm=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_telclr",e.interfaceId="fileDispConfirm",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.fileDispConfirmAsync=function(t,e,i){var n={};n.bizArgs=t,n.devKindId="dev_telclr",n.interfaceId="fileDispConfirm",PJF.communication.client.callDeviceAsync(i,e||"",PJF.util.jsontostr(n))},PJF.communication.client.dispConfirm=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_telclr",e.interfaceId="transcDispConfirm",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.dispConfirmAsync=function(t,e,i){var n={};n.bizArgs=t,n.devKindId="dev_telclr",n.interfaceId="transcDispConfirm",PJF.communication.client.callDeviceAsync(i,e||"",PJF.util.json2str(n))},
PJF.communication.client.operateQuestion=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_telclr",e.interfaceId="operateQuestion",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.setDispSubj=function(t){var e={bizArgs:{},devKindId:"dev_telclr",interfaceId:"setDispSubj"};return e.bizArgs.subjName=t,PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getResolution=function(){var t={devKindId:"dev_scanner",interfaceId:"getResolution"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.printVoucherAsync=function(t,e,i,n){var o={bizArgs:{},devKindId:"dev_voucherprt",interfaceId:"printVoucher"};o.bizArgs.jsonStr=t,o.bizArgs.elecSignBASE64Data=e||"",PJF.communication.client.callDeviceAsync(n,i,PJF.util.json2str(o))},PJF.communication.client.printPicByPath=function(t,e,i){var n={bizArgs:{},devKindId:"dev_voucherprt",interfaceId:"printPNGByPath"};n.bizArgs.imagePath=t,
PJF.communication.client.callDeviceAsync(e,i,PJF.util.json2str(n))},PJF.communication.client.getStatus=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="getStatus",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.reset=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="reset",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.addCard=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="addCard",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.addCardBatch=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="addCardBatch",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.addCardManual=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="addCardManual",
PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.stopAddCard=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="stopAddCard",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.queryCardInfo=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="queryCardInfo",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getCardByNo=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="getCardByNo",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getCardBatch=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="getCardBatch",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.fetchCardByPos=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="fetchCardByPos",
PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.deleteCardRecord=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="deleteCardRecord",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.makeFastInventory=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="makeFastInventory",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.makePreciseInventory=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="makePreciseInventory",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.queryInventoryResult=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="queryInventoryResult",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.cardHandover=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",
e.interfaceId="cardHandover",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.queryOperLog=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="queryOperLog",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.queryStaffsByCardNoRange=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="queryStaffsByCardNoRange",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.cardEndofDay=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="cardEndofDay",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.changeCardType=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="changeCardType",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.pauseInventory=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",
e.interfaceId="pauseInventory",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.continueInventory=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="continueInventory",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.stopInventory=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="stopInventory",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.queryCards=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="queryCards",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.stopFetchCard=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="stopFetchCard",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getCardByNoSequence=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",
e.interfaceId="getCardByNoSequence",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.queryOperRecord=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="queryOperRecord",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.restoreDev=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="restoreDev",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.connectDev=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="connectDev",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.disconnectDev=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="disconnectDev",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.putCardIn=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="putCardIn",
PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.putCardOut=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="putCardOut",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.writeMagnet2Card=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="writeMagnet2Card",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.powerOnIMC=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="powerOnIMC",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.powerOffIMC=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="powerOffIMC",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.execICCmd=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="execICCmd",PJF.communication.client.callDevice(PJF.util.json2str(e))},
PJF.communication.client.printCardFace=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="printCardFace",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.bulgeCardFace=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_imc",e.interfaceId="bulgeCardFace",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.printVoucherWithSealAsync=function(jsonData,initData,callBack){var elecSealInfo=PJF.util.parseJson(jsonData.elecSealInfo),aryRet=PJF.communication.client.createVoucherBackGrd(elecSealInfo.sealId,elecSealInfo.sealFileMd5,"",elecSealInfo.sealRemotePath);if("0"==aryRet[0]){elecSealInfo.sealLocalPath=aryRet[1],jsonData.elecSealInfo=PJF.util.jsontostr(elecSealInfo);var inData={};inData.bizArgs=jsonData,inData.devKindId="dev_voucherprt",inData.interfaceId="printVoucherWithSeal",PJF.communication.client.callDeviceAsync(callBack,initData,PJF.util.jsontostr(inData))}else{aryRet.push(initData)
;var fun=eval(callBack);new fun(aryRet)}},PJF.communication.client.getDNCtrlVersion=function(){var t={bizArgs:{},devKindId:"dev_idcard",interfaceId:"getDNCtrlVersion"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.getIDVerifyData=function(t,e){var i={bizArgs:{}};return i.bizArgs.strRandomData=t,i.bizArgs.iFuncType=e,i.devKindId="dev_idcard",i.interfaceId="getIDVerifyData",PJF.communication.client.callDevice(PJF.util.json2str(i))},PJF.communication.client.getLogByCardNo=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="getLogByCardNo",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getRetainedCardInfo=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="getRetainedCardInfo",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getICCardDataByArgs=function(t){t=t||{};var e={bizArgs:{},devKindId:"dev_iccard",
interfaceId:"getICCardInfo"};e.bizArgs.iIcFlag=t.iIcFlag||"3",e.bizArgs.aryTagList=t.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4a",e.bizArgs.strAIDList=t.strAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106";var i=PJF.communication.client.callDevice(PJF.util.json2str(e));if("0"==i[0]){var n={},o={},a=i[3],s=a.length;if(s<4)return new Array("DEV9999999","读IC卡信息返回值有错");var r=0;try{for(;r<s;){var c=a.substring(r+1,r+4),l=Number(c),d=a.substring(r+4,r+4+l);o[a.substring(r,r+1)]=d,r=r+4+l}}catch(u){return new Array("DEV9999999","读IC卡信息返回值有错")}if(!o.I){if(-1==(r=a.lastIndexOf("I006")))return new Array("DEV9999999","读IC卡信息返回值有错");o.I=a.substring(r+4,r+10)}if(!o.J){if(-1==(r=a.lastIndexOf("J003")))return new Array("DEV9999999","读IC卡信息返回值有错");o.J=a.substring(r+4,r+7)}return n.ICCardType=i[2],n.accountNo=o.A,PJF.constants.SUPPORT_ARQC_MANAGER&&PJF.arqcManager.setLastICCardNo(n.accountNo),n.userName=o.B,n.cardType=o.C,n.cardNo=o.D,n.secDisInfo=o.E,
n.firDisInfo=o.F,n.balance=o.G,n.balanceLimit=o.H,n.validTime=o.I,n.ICcardNo=o.J,new Array("0",n)}return i},PJF.communication.client.createVoucherImage2File=function(t,e,i,n){var o=PJF.communication.client.createVoucherBackGrd(t,e,"",n);if("0"==o[0]){var a=PJF.communication.client.getClientEnv("localConfigPath")[1]+"\\SignBackGrd\\"+PJF.util.generateUUid()+".jpg";a=a.replace("LocalConfig","Temp");var s={bizArgs:{}};return s.bizArgs.printContent=i,s.bizArgs.backgroundImagePath=o[1],s.bizArgs.outfilePath=a,s.devKindId="dev_voucherprt",s.interfaceId="createVoucherImage2File","0"==(o=PJF.communication.client.callDevice(PJF.util.jsontostr(s)))[0]&&(o[1]=a),o}return o},PJF.communication.client.compseImage2BASE64=function(t){if(t.elecSealInfo){var e=PJF.util.parseJson(t.elecSealInfo),i=PJF.communication.client.createVoucherBackGrd(e.sealId,e.sealFileMd5,"",e.sealRemotePath);return"0"==i[0]&&(e.sealLocalPath=i[1],t.elecSealInfo=PJF.util.jsontostr(e),(n={}).bizArgs=t,
n.devKindId="dev_voucherprt",n.interfaceId="compseImage2BASE64","0"==(i=PJF.communication.client.callDevice(PJF.util.jsontostr(n)))[0]&&(i[1]=i[2])),i}var n;return(n={}).bizArgs=t,n.devKindId="dev_voucherprt",n.interfaceId="compseImage2BASE64","0"==(i=PJF.communication.client.callDevice(PJF.util.jsontostr(n)))[0]&&(i[1]=i[2]),i},PJF.communication.client.createSealImage2BASE64=function(o,a){var t={sealID:o.sealId};PJF.communication.ajax({url:"bosWeb/ecpJson2Bean.action",data:{_fw_service_id:"getElecSealInfo",jsonData:PJF.util.json2str(t),jsonClass:"java.util.Map"},success:function(t){if(t&&t.BK_STATUS&&"00"!=t.BK_STATUS)new PJF.ui.errorMessageBox({desc:t.BK_DESC||deviceConfigLanguage.msg.fail,code:t.BK_CODE||"",traceId:t._COMMON&&t._COMMON.SYS_EVT_TRACE_ID||"",fn:arguments[1]||function(){}});else{o.sealFileMd5=t.sealMD5,o.sealRemotePath=t.sealPath;var e=PJF.communication.client.createVoucherBackGrd(o.sealId,o.sealFileMd5,"",o.sealRemotePath);if("0"==e[0]){o.sealLocalPath=e[1]
;var i=PJF.communication.client.getClientEnv("localConfigPath")[1];i=i.replace("LocalConfig","Temp");var n={bizArgs:{}};n.bizArgs.elecSealInfo=PJF.util.jsontostr(o),n.bizArgs.tempDir=i,n.devKindId="dev_voucherprt",n.interfaceId="createSealImage2BASE64",e=PJF.communication.client.callDevice(PJF.util.jsontostr(n)),a(e)}else a(e)}}})},PJF.communication.client.createVoucherBackGrdMain=function(t,e,i,n){return"00401a0153c16b990153c16b9abd0002"==t?t="00401a0153c16b990153c16b9abd0002-1":"8ba1a181563698c8015636996acf0091"==t&&(t="8ba1a181563698c8015636996acf0091-1"),PJF.communication.elecSign.getElecSealCapability()&&i?PJF.communication.client.createVoucherImage2File(t,e,i,n):PJF.communication.client.createVoucherBackGrd(t,e,i,n)},PJF.communication.client.elecSignVoucherCompseMain=function(t){
return PJF.communication.elecSign.getElecSealCapability()?PJF.communication.client.compseImage2BASE64(t):PJF.communication.client.elecSignVoucherCompse(t.backFile,t.singFile,t.signX,t.signY,t.width,t.height,t.signfileType)},PJF.communication.client.cancelOper=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_telclr",e.interfaceId="cancelOper",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.readElecLicInfo=function(){var t={bizArgs:{},devKindId:"dev_ebl",interfaceId:"readElecLicInfo"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.addBlankCardBatch=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="addBlankCardBatch",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.fetchBatchBlankCard=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="fetchBatchBlankCard",
PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.blankCardHandover=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="blankCardHandover",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.blankCardEndofDay=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="blankCardEndofDay",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.addBlankCard=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="addBlankCard",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.changeBlankCardType=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_cardstore",e.interfaceId="changeBlankCardType",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.ETC_getCardInfo=function(t,e){var i={};i.bizArgs=t,i.devKindId="dev_hic",i.interfaceId="ETC_getCardInfo",
PJF.communication.client.callHicDevice(i,e)},PJF.communication.client.getIDChipInfo=function(t,e){var i=sendNSCommand("getIDChipInfo",t,e);if("0"==i[0]){var n=i[1];if("0"==n.substring(0,1)&&-1!=n.indexOf("x")&&(cardInfoArry=n.split("|"),cardInfoArry[6]=cardInfoArry[6].replace("x","X"),n=cardInfoArry.join("|"),i[1]=n),"I"==n.substring(0,1)){var o=n.split("|");if(10==o.length){for(var a=o[2],s=["未知","男","女","未说明"],r=0;r<s.length;r++)a=a.replace(s[r],s[r]+"|");o[2]=a,n=o.join("|"),i[1]=n}}}return i},PJF.communication.client.signPVAsync=function(t,e,i){var n={};n.bizArgs=t,n.devKindId="dev_telclr",n.interfaceId="signPV",PJF.communication.client.callDeviceAsync(e,i,PJF.util.jsontostr(n))},PJF.communication.client.OpenRSUDevice=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_OBU",e.interfaceId="OpenRSUDevice",aryRet=PJF.communication.client.callDevice(PJF.util.jsontostr(e)),aryRet},PJF.communication.client.CloseRSUDevice=function(){var t={devKindId:"dev_OBU",
interfaceId:"CloseRSUDevice"};return aryRet=PJF.communication.client.callDevice(PJF.util.jsontostr(t)),aryRet},PJF.communication.client.ReadObuInfo=function(t){var e={};if(e.bizArgs=t,e.devKindId="dev_OBU",e.interfaceId="ReadObuInfo",aryRet=PJF.communication.client.callDevice(PJF.util.jsontostr(e)),"0"==aryRet[0]){var i=PJF.util.parseJson(aryRet[3]);switch(i.PlateColor){case"0000":i.PlateColor="0001";break;case"0002":i.PlateColor="0002";break;case"0003":i.PlateColor="0003";break;case"0001":i.PlateColor="0004";break;case"0006":i.PlateColor="0005";break;case"0004":i.PlateColor="0006";break;case"0005":i.PlateColor="0007"}aryRet[3]=PJF.util.jsontostr(i)}return aryRet},PJF.communication.client.WriteObuInfo=function(t){var e={};e.bizArgs=t;var i=PJF.util.parseJson(t.strVehicleInfo);switch(i.PlateColor){case"0001":i.PlateColor="0000";break;case"0002":i.PlateColor="0002";break;case"0003":i.PlateColor="0003";break;case"0004":i.PlateColor="0001";break;case"0005":i.PlateColor="0006";break
;case"0006":i.PlateColor="0004";break;case"0007":i.PlateColor="0005"}return e.bizArgs.strVehicleInfo=PJF.util.jsontostr(i),e.devKindId="dev_OBU",e.interfaceId="WriteObuInfo",aryRet=PJF.communication.client.callDevice(PJF.util.jsontostr(e)),aryRet},PJF.communication.client.registerFinger=function(t){if("0"==PJF.communication.client.getUsedFingerType())return PJF.communication.client.writeFingerInfo("1");null==t&&(t={});var e={devKindId:"dev_cfg",devKind:"CFG",funcName:"registerFinger",timeout:t.timeout,iOutDataLen:"102400",bizArgs:t},i=PJF.communication.client.callDeviceADP(e);return"0"==i[0]?["0",i[1].companyCode,i[1].temlate,i[1].image]:i},PJF.communication.client.readFinger=function(t){if("0"==PJF.communication.client.getUsedFingerType())return PJF.communication.client.getFingerInfo("1");null==t&&(t={});var e={devKindId:"dev_cfg",devKind:"CFG",funcName:"readFinger",timeout:t.timeout,iOutDataLen:"102400",bizArgs:t},i=PJF.communication.client.callDeviceADP(e)
;return"0"==i[0]?["0",i[1].companyCode,i[1].temlate]:i},PJF.communication.client.matchFingers=function(t){if("0"==PJF.communication.client.getUsedFingerType())return PJF.communication.client.compareFinger(t.finger1,t.finger2);var e={devKindId:"dev_cfg",devKind:"CFG",funcName:"matchFingers",timeout:t.timeout,iOutDataLen:"512",bizArgs:t},i=PJF.communication.client.callDeviceADP(e);return"0"==i[0]?["0","0",i[1].matchRate]:i},PJF.communication.client.compareIdcardFingerInfo=function(t){if(null==t||null==t.idcardFingerInfo)return["ECPWSCFG0003","身份证芯片中指纹信息未传入"];var e={devKindId:"dev_cfg",devKind:"CFG",funcName:"compareIdcardFingerInfo",timeout:t.timeout,iOutDataLen:"512",bizArgs:t},i=PJF.communication.client.callDeviceADP(e);return"0"==i[0]?["0",i[1].matchRate,i[1].finPos]:i},PJF.communication.client.callDeviceADP=function(jsonData){var devCfg=PJF.communication.client.getDevObject(jsonData.devKindId);if(null==devCfg)return["ECPWSDCM0006","未找到设备"+jsonData.devKindId+"对应的外设参数配置"];var inData={
bizArgs:{}};inData.devKindId=jsonData.devKindId,inData.interfaceId="doCommand",inData.bizArgs.devKind=jsonData.devKind,inData.bizArgs.synFlag="0",inData.bizArgs.iOutDataLen=jsonData.iOutDataLen;var data={commonArgs:{devKind:jsonData.devKind,devBrand:devCfg.devBrand,funcName:jsonData.funcName,sn:PJF.util.formatDate(new Date,"yyyyMMddhhmmssS"),timeout:jsonData.timeout||devCfg.timeout},connectArgs:{portType:devCfg.portType||"",portNo:devCfg.portNo||"",baud:devCfg.baud||"",isConBP:devCfg.isConBP||"",d2bPort:devCfg.d2bPort||"",ip:devCfg.ip||"",port:devCfg.port||"",pvid:devCfg.pvid||"",devName:devCfg.devName||""},bizArgs:jsonData.bizArgs||{}};inData.bizArgs.inData=PJF.util.jsontostr(data);var aryRet=PJF.communication.client.callDevice(PJF.util.jsontostr(inData));if("0"==aryRet[0]){var outData=eval("("+aryRet[2]+")")
;return outData&&outData.retComArgs?"ECPWS0000000"==outData.retComArgs.retCode?outData.retBizArgs?["0",outData.retBizArgs]:["ECPWSCOM0016","返回数据格式错误retBizArgs为空"]:[outData.retComArgs.retCode,outData.retComArgs.errDesc]:["ECPWSCOM0016","返回数据格式错误retComArgs为空"]}return aryRet},PJF.communication.client.getUsedFingerType=function(){var t="0",e=PJF.communication.client.getDevObject("dev_cfg");return null!=e&&"1"==e.fingType&&(t="1"),t},PJF.communication.client.getDevObject=function(dev_name){var aryRet=PJF.communication.client.getDevConfig(dev_name);return"0"==aryRet[0]?eval("("+aryRet[1]+")"):null},PJF.communication.client.getAllFSNFiles=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_dcj",e.interfaceId="getAllFSNFiles",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.clearAllFSNFiles=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_dcj",e.interfaceId="clearAllFSNFiles",PJF.communication.client.callDevice(PJF.util.json2str(e))},
PJF.communication.client.setTime=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_dcj",e.interfaceId="setTime",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getRMBCount=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_dcj",e.interfaceId="getRMBCount",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.getAllFSNFilesNew=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_dcj",e.interfaceId="getAllFSNFilesNew",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.clearAllFSNFilesNew=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_dcj",e.interfaceId="clearAllFSNFilesNew",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.setTimeNew=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_dcj",e.interfaceId="setTimeNew",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.clearRMBCount=function(t){
var e={};return e.bizArgs=t,e.devKindId="dev_dcj",e.interfaceId="clearRMBCount",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.camPreview=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_zzkfcam",e.interfaceId="camPreview",PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.takePic=function(){var t={bizArgs:{},devKindId:"dev_zzkfcam",interfaceId:"takePic"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.closePreview=function(){var t={bizArgs:{},devKindId:"dev_zzkfcam",interfaceId:"closePreview"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.getCamList=function(){var t={bizArgs:{},devKindId:"dev_zzkfcam",interfaceId:"getCamList"};return PJF.communication.client.callDevice(PJF.util.json2str(t))},PJF.communication.client.QRScanner=function(t){var e={};return e.bizArgs=t,e.devKindId="dev_zzkfcam",e.interfaceId="QRScanner",
PJF.communication.client.callDevice(PJF.util.json2str(e))},PJF.communication.client.SEL_openSafeDoor=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"openSafeDoor",timeout:t.timeout,iOutDataLen:"512",bizArgs:t};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_querySafeDoorStatus=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"querySafeDoorStatus",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_openPaperDoor=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"openPaperDoor",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_imageCapture=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"imageCapture",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},
PJF.communication.client.SEL_sealStart=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"sealStart",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_manualSeal=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"manualSeal",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_stampControl=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"stampControl",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_sealCheck=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"sealCheck",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_moveAuthorization=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"moveAuthorization",
timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_getMachineId=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"getMachineId",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_getPaperDoorStatus=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"getPaperDoorStatus",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.SEL_getSealInfo=function(t){var e={devKindId:"dev_sel",devKind:"SEL",funcName:"getSealInfo",timeout:t.timeout,iOutDataLen:"512",bizArgs:t||{}};return PJF.communication.client.callDeviceADP(e)},PJF.communication.client.executeHtml=function(t){return sendNSCommand("executeHtml",PJF.util.jsontostr(t))},PJF.communication.client.isSM4TLC=function(){var t=sendNSCommand("isSM4TLC");return"0"==t[0]&&"true"==t[1]},
PJF.communication.client.getSignatureNew=function(t){var e=t;return e.functionName="elecSign",e.agree="交易签名",e.cancelOption="3",sendNSCommand("getSignatureNew",PJF.util.jsontostr(e))},PJF.communication.client.getSignatureNewAsync=function(t,e,i){var n=t;n.functionName="elecSign",n.agree="交易签名",n.cancelOption="3",sendNSCommand("getSignatureNewAsync",e,i||"",PJF.util.jsontostr(n))},PJF.namespace("PJF.arqcManager"),$(function(){if(PJF.util.isOverSea()&&(PJF.constants.SUPPORT_ARQC_MANAGER=!1),PJF.constants.SUPPORT_ARQC_MANAGER&&PJF.communication.client.isInP2()){var key1="PJF_DATA",key2="ARQC_QUEUE",key3="ARQC_IC_CARD_NO",_genArqcFn=PJF.communication.client.genARQC,_getIcCardInfo=PJF.communication.client.getIcCardInfo,_getQueue=PJF.arqcManager.getArqcQueue=function(){var t=PJF.communication.client.getAppData(key1,key2);return"0"==t[0]&&t[1]?JSON.parse(t[1]):(t[1]&&console.log("获取arqc queue出错:"+t[1]),{})},_addArqc=PJF.arqcManager.addArqc=function(t){var e=_getQueue(),i=_getLastIc()
;i&&(e[i]=e[i]||[],e[i].push(t),_setQueue(e))},_setQueue=function(t){var e=PJF.communication.client.setAppData(key1,key2,JSON.stringify(t));"0"!=e[0]&&console.log("设置arqc queue出错:"+e[1])},_setLastIc=PJF.arqcManager.setLastICCardNo=function(t){var e=PJF.communication.client.setAppData(key1,key3,t);console.debug("last卡号:"+t),"0"!=e[0]&&console.log("设置上一次IC卡号出错:"+e[1])},_getLastIc=PJF.arqcManager.getLastICCardNo=function(){var t=PJF.communication.client.getAppData(key1,key3);if("0"==t[0]&&t[1])return t[1];console.log("获取上一次IC卡号出错:"+t[1])};PJF.arqcManager.cleanAll=function(){PJF.communication.client.removeAppData(key1,key2),PJF.communication.client.removeAppData(key1,key3)},PJF.arqcManager.useArqc=function(t,e){console.log("use arqc data :"+JSON.stringify(t));for(var i=_getQueue(),n={},o=0;o<t.length;o++){var a=i[t[o].cardNo];if(0!==t[o].num&&a){var s=t[o].num||a.length;n[t[o].cardNo]=a.slice(0,s),!1===e?i[t[o].cardNo]=a.slice(s):delete i[t[o].cardNo]}}
return console.log("used queue:"+JSON.stringify(n)),_setQueue(i),n},PJF.arqcManager.preFilterAjax=function(t,e,i){var n=_getQueue(),o=[];for(var a in n)if(-1!=t.indexOf(a)){var s=n[a],r={cardNo:a,num:0};o.push(r);for(var c=0;c<s.length;c++)-1!=t.indexOf(s[c])&&(t=t.replace(new RegExp(s[c],"g"),s[r.num++]))}return i.always(function(t,e,i){try{0==o.length||("timeout"==e?PJF.arqcManager.useArqc(o,!1):"success"!=e||t._curr_val_key||t._val_page||PJF.arqcManager.useArqc(o,!1))}catch(n){console.log("arqc manager jqxhr always error:"+n.message)}}),t},PJF.communication.client.genARQC=function(){if(!_getLastIc()){var t=PJF.communication.client.getIcCardInfo("default");if("0"!=t[0])return console.log("arqc之前的获取IC卡信息调用失败"),t}var e=_genArqcFn.apply(window,arguments);return"0"==e[0]&&(PJF.communication.client.setAppData("PJF_DATA","ARQC",PJF.util.jsontostr(e.slice(1))),_addArqc(e[2]),console.debug("arqc:"+e[2])),_setLastIc(null),e},PJF.communication.client.getIcCardInfo=function(){
var result=_getIcCardInfo.apply(window,arguments);if("0"==result[0]){var rst=eval("("+result[1]+")");PJF.otherInfo&&(PJF.otherInfo.customerAcctNo=rst.accountNo),_setLastIc(rst.accountNo)}return result}}}),$.ajaxPrefilter(function(t,e,i){if("pc"===PJF.constants.termType&&"true"===PJF.html.getUrlParam("_SIGN_CHECK")&&PJF.communication.client.isInP2()&&(t.data=function(t,e){var i=(t=t||"").split("&"),n=[];for(var o in e)n.push(o);for(var a=i.length;0<a--;)-1!=PJF.util.array.indexOf(n,i[a].split("=")[0])&&i.splice(a,1);for(var o in t=i.join("&"),e)e[o]=e[o]||"",t+=(""===t?"":"&")+o+"="+encodeURIComponent(e[o]);return t}(t.data,{_SIGN_CHECK:!0}),i.done(function(t){var e=PJF.util.getValue(PJF,"orgInfo.orgCode");if(t&&t._force_logout){var i=PJF.communication.client.doCommonCommand("topHandler",JSON.stringify({key:"getSystemState",orgCode:e}));if("0"==i[0]){var n=i[2].substr(0,19)+"0";PJF.communication.client.doCommonCommand("topHandler",JSON.stringify({key:"setSystemState",signStr:{
signedSysIds:n},orgCode:e}))}}})),PJF.constants.SUPPORT_ARQC_MANAGER&&PJF.communication.client.isInP2()){var n=function(t,e){for(var i=(t=t||"").split("&"),n=0,o=i.length;n<o;n++)if(i[n].split("=")[0]===e)return i[n].split("=")[1]}(t.data,"transaction_id");n=n&&n.substr(0,9);var o=-1!=PJF.util.array.indexOf(PJF.constants.ARQC_MANAGER_BLACKLIST,n);t.data&&-1==t.data.indexOf("_no_replace_arqc")&&!o&&PJF.arqcManager.preFilterAjax&&(t.data=PJF.arqcManager.preFilterAjax(t.data,e,i))}}),PJF.namespace("PJF.auth"),function(){var n="CACHE_PST_DESTROY_PREIDX_PJF_AUTH_STATUS",o=!1,a=function(){PJF.communication.client.doCommonCommand("CltCacheManager",n,JSON.stringify({isAuth:!0}))},e=["1"];PJF.communication.client.isInP2()&&(e=PJF.communication.client.doCommonCommand("getSysCtrlParm","MULTI_AUTH_WIN_CTRL")),e="0"==e[0]&&e[1]?e[1].split(","):null;var s=function(){var t=PJF.util.getValue(PJF,"orgInfo.orgCode");return!(!t||!e)&&-1!==PJF.util.array.indexOf(e,t)};PJF.auth.startAuth=function(){
if(!PJF.communication.client.isInP2())return!0;if(!PJF.constants.AUTH_ONLY_ONE)return!0;if(!s())return!0;var t=!1,e=PJF.communication.client.doCommonCommand("CltCacheManager",n);if("0"==e[0])if(e[1])try{(e=JSON.parse(e[1])).isAuth||(a(),t=!0)}catch(i){console.log("解析CACHE_PST_DESTROY_PREIDX_PJF_AUTH_STATUS报错:"+i.message)}else a(),t=!0;else console.log("获取当前授权状态出错:"+e[1]),a(),t=!0;return t&&(PJF.loadResource.beforeCloseTab=PJF.communication.client.beforeCloseTab,o=!0,PJF.communication.client.beforeCloseTab=function(){return PJF.auth.endAuth(),!0}),t},PJF.auth.endAuth=function(){PJF.communication.client.isInP2()&&PJF.constants.AUTH_ONLY_ONE&&s()&&(PJF.auth._lastAuthData&&"CA"!=PJF.auth._lastAuthData._curr_val_key&&"SA"!=PJF.auth._lastAuthData._curr_val_key||(o&&(PJF.communication.client.beforeCloseTab=PJF.loadResource.beforeCloseTab,o=!1),PJF.communication.client.doCommonCommand("CltCacheManager",n,JSON.stringify({isAuth:!1}))))}}(),PJF.namespace("PJF.eup"),function(t){var a=!1
;t.init=function(n){if(a)n&&n();else{for(var t=top;t.opener;)t=t.opener.top;t.postMessage(JSON.stringify({event:"getUserInfo",fromAppId:"ecip"}),"*");var o=function(t){window.removeEventListener("message",o,!1);var e=JSON.parse(t.data);if(e.data&&"eup"===e.fromAppId){var i=e.data;console.log("成功从统一平台获取到用户信息"),a=!0,PJF.userInfo=i.userInfo,PJF.orgInfo=i.orgInfo,PJF.roleInfo=i.roleinfo,PJF.otherInfo=i.otherInfo,n&&n()}};window.addEventListener("message",o,!1)}};var e;e=PJF.communication.client.getClientEnv,PJF.communication.client.getClientEnv=function(){return"language"===arguments[0]?[0,"zh-cn"]:e.apply(this,arguments)}}(PJF.eup),function(){function addParam(t,e){var i=(t=t||"").split("&"),n=[];for(var o in e)n.push(o);for(var a=i.length;0<a--;)-1!=PJF.util.array.indexOf(n,i[a].split("=")[0])&&i.splice(a,1);for(var o in t=i.join("&"),e)e[o]=e[o]||"",t+=(""===t?"":"&")+o+"="+encodeURIComponent(e[o]);return t}function getParam(t,e){
for(var i=(t=t||"").split("&"),n=0,o=i.length;n<o;n++)if(i[n].split("=")[0]===e)return i[n].split("=")[1]}function needMac(t,e){return!(!e.data||!e.data.jsonData||"string"!=typeof e.data.jsonData)||(!("pc"!=PJF.constants.termType||!t.data||"string"!=typeof getParam(t.data,"jsonData"))||void 0)}$.ajaxPrefilter(function(options,originalOptions,jqxhr){if("pc"==PJF.constants.termType&&!PJF.constants.D2D&&PJF.constants.LOGIN_TOKEN&&"string"==typeof PJF.util.getValue(originalOptions,"data.jsonData")){var loginToken=PJF.util.getLoginToken();if(loginToken){var jsonData=decodeURIComponent(getParam(options.data,"jsonData").replace(/\+/g," "));try{jsonData=eval("("+jsonData+")"),jsonData._login_tk=loginToken,options.data=addParam(options.data,{jsonData:JSON.stringify(jsonData)})}catch(e){console.info("注入login token时jsondata eval失败:"+e.message)}}}if(!PJF.constants.NO_AJAX_PREFILTER){
var _operCode="stm"==PJF.constants.termType?PJF.util.getValue(window,"PJF.otherInfo.devId"):PJF.util.getValue(window,"PJF.userInfo.userCode");if(_operCode&&needMac(options,originalOptions)){var encryptData;switch(PJF.constants.termType){case"pc":if(PJF.communication.client.isInP2()){var macRst;if("string"!=typeof originalOptions.data)console.debug("macData普通情况"),macRst=PJF.communication.client.macContent(decodeURIComponent(getParam(options.data,"jsonData").replace(/\+/g," ")));else{var jsonData=getParam(options.data,"jsonData").replace(/\+/g," ");try{decodeURIComponent(jsonData)!==jsonData?(console.debug("macData data为encode字符串情况"),macRst=PJF.communication.client.macContent(decodeURIComponent(jsonData))):(console.debug("macData data为未encode字符串情况"),macRst=PJF.communication.client.macContent(jsonData))}catch(e){console.debug("macData data为未encode字符串情况, 并且有%号的情况"),macRst=PJF.communication.client.macContent(jsonData)}}0==macRst[0]&&(encryptData=macRst[1])
}else encryptData="pc not in client";break;case"stm":if(PJF.util.compareClientVersion("1.17.1.0")){var macres=PJF.communication.SecAPI.generateMac(PJF.otherInfo.devId,PJF.otherInfo.token,PJF.otherInfo.secNode,originalOptions.data.jsonData);encryptData=macres.success?macres.result:macres.error}break;case"mobile":encryptData=PJF.client.encryptData(originalOptions.data.jsonData);break;case"pad":encryptData=PJF.util.encryptData(originalOptions.data.jsonData);break;default:encryptData="unknown device type : "+PJF.constants.termType,console.log("ajax mac加密失败, 未知的设备类型:"+PJF.constants.termType)}encryptData&&(options.data=addParam(options.data,{macData:encryptData,_terminal_type:PJF.constants.termType,OPER_CODE:_operCode}))}}})}(),PJF.namespace("PJF.communication.elecSign"),function(exports){
var win,img,content,winSign,signImg,windowBtnConfirm,windowBtnCancel,signBtnConfirm,signBtnOldSign,signBtnResign,imgPreviewer,winId=PJF.util.generateUUid(),panelId=PJF.util.generateUUid(),imgId=PJF.util.generateUUid(),contentId=PJF.util.generateUUid(),btnId=PJF.util.generateUUid(),winImgViewerId=PJF.util.generateUUid(),winLoadingId=PJF.util.generateUUid(),cancelSignId=PJF.util.generateUUid(),signWinId=PJF.util.generateUUid(),signImgId=PJF.util.generateUUid(),signBtnConfirmId=PJF.util.generateUUid(),signBtnOldSignId=PJF.util.generateUUid(),signBtnResignId=PJF.util.generateUUid(),compareSignWin,compareSignWinId="pjf_compare_sign_win_"+PJF.util.generateUUid(),compareIframeId="pjf_compare_sign_iframe_"+PJF.util.generateUUid(),compareSignWinMaxHeight=600,compareSignWinMaxWidth=700,compareIframeDom,uploadNasPath="elecSignPic/",sameVoucherSeparator="_child",elecTimeout=60,beforeCloseTabCallBack;try{if(PJF.communication.client.isInP2()){
var devConfig=PJF.communication.client.getDevConfig("dev_telclr");"0"==devConfig[0]&&(elecTimeout=eval("("+devConfig[1]+")").strElecTimeout||elecTimeout)}}catch(e){console.log("获取电子签名超时时间出错:"+e.message)}function _openOldElecSign(t){var e=new PJF.ui.loading({maskBody:!0,text:"正在查询签名"}),i=PJF.constants.OVERSEA_SIGN_KEY,n=JSON.stringify({key:i,directory:[t.overseaAccType,t.accountNo,t.operCode,t.machineName,t.machineIp,Date.now()].join("/")});console.info("海外建亚打开旧签名参数为:"+n),PJF.communication.ajax({url:"ecpJson",data:{_fw_service_id:"queryEncryptService",jsonData:n},success:function(t){if("string"==typeof t){var e="https://"+PJF.constants.OVERSEA_SIGN_URL+"/HKTellerService/SVSService.svc/teller/"+t;if(PJF.communication.client.isInP2()){var i=sendNSCommand.toString().match(/callJava\(([^,]*),\'([^']*)/);e+="?callJavaIndex="+i[1]+"&callJavaToken="+i[2]}_openOldElecSignWin(e),console.info("海外建亚打开旧签名url为:"+e)}else new PJF.ui.errorMessageBox({title:"查询签名失败",data:t})},failure:function(t,e,i){
new PJF.ui.errorMessageBox({title:"查询签名失败",desc:e})},complete:function(){e.destroy()}})}function _openOldElecSignWin(t){if(compareSignWin)compareSignWin.open();else{$(document.body).append("<div id = '"+compareSignWinId+"'></div>");var e='<iframe id = "'+compareIframeId+'" frameborder="0" style="height:100%;width:100%;"></iframe>';compareSignWin=new PJF.ui.window({title:"对比签名",dom:compareSignWinId,left:500,width:compareSignWinMaxWidth,height:compareSignWinMaxHeight,closeCacheData:!0,modal:!1,content:e,onClose:function(){winSign&&winSign.com.window("hcenter")}}),(compareIframeDom=compareSignWin.com[0].querySelector("#"+compareIframeId)).onload=function(){var t=this.contentWindow.document.body.scrollHeight,e=this.contentWindow.document.body.scrollWidth;compareSignWin.com.window("resize",{height:Math.min(compareSignWinMaxHeight,t),width:Math.min(compareSignWinMaxWidth,e)})}}_moveWin(winSign,20),_moveWin(compareSignWin,500),compareIframeDom.src=t}function _moveWin(t,e){
t.com.window("resize",{left:e})}for(var _appKeyArr=["fmtPrintId","onetime","customerName","elecSignUploadData","notConfirm","overseaAccType","accountNo","operCode","machineName","machineIp","machineTime"],_appKeyMap={},i=0,_attnCapability;i<_appKeyArr.length;i++)_appKeyMap[_appKeyArr[i]]=!0;function _populateAppData(t){var e={machineIp:PJF.util.getValue(PJF,"otherInfo.clientIP"),machineTime:(new Date).getTime(),machineName:"CCBA_WKS1",operCode:PJF.util.getValue(PJF,"userInfo.userCode")};for(var i in t)_appKeyMap[i]&&(e[i]=t[i]);return e}function lockScreen(){beforeCloseTabCallBack=PJF.communication.client.beforeCloseTab,PJF.communication.client.beforeCloseTab=function(){return new PJF.ui.messageBox({style:"warning",closable:!1,buttonText:["确定"],title:"禁止关闭",content:"签名操作未完成不能关闭页面",fn:function(){}}),!1}}function unLockScreen(){PJF.communication.client.beforeCloseTab=beforeCloseTabCallBack}function getType(t){
return t.PRINT_PROTOCOL_STRING_MAP&&t.PRINT_VOUCHER_STRING_MAP?3:t.PRINT_PROTOCOL_STRING_MAP?2:t.PRINT_VOUCHER_STRING_MAP?1:void 0}function getUUID(){if(PJF.communication.client.isInP2()){var t=PJF.communication.client.getUniqueNo();if(0==t[0])return t[1]}return PJF.util.generateUUid()}function createWinSign(t,e,i,n){if(winSign)winSign.com.find("#custNmDiv").text("客户姓名:"+t),winSign.com.find("#agentNmDiv").text("代理人姓名:"+e);else{$(document.body).append("<div id = '"+signWinId+"'></div>");var o=t?"<div id = 'custNmDiv' style='color:red;font-size:16px;margin:5px';font-weight='bolder'>客户姓名:"+t+"</div>":"",a=e?"<div id = 'agentNmDiv' style='color:red;font-size:16px;margin:5px';font-weight='bolder'>代理人姓名:"+e+"</div>":"";winSign=new PJF.ui.window({dom:signWinId,title:"审核签名",width:450,height:350,closable:!1,fixMask:!0,closeCacheData:!0,
content:o+a+"<img style='width:400px;height:200px;display:block;margin:10px auto;' id = '"+signImgId+"'></img><div style='text-align:center;'><span id='"+signBtnConfirmId+"'></span><span id='"+signBtnResignId+"'></span><span id='"+signBtnOldSignId+"'></span></div>"}),signBtnConfirm=new PJF.ui.linkButton({dom:signBtnConfirmId,name:"保存签名"}),signBtnResign=new PJF.ui.linkButton({dom:signBtnResignId,name:"重新签名"}),PJF.util.isOverSea()&&-1!=PJF.util.array.indexOf(["DA001","DA003"],PJF.util.getValue(PJF,"orgInfo.instSvrlLgPsnID"))&&(signBtnOldSign=new PJF.ui.linkButton({dom:signBtnOldSignId,name:"对比签名"}))}winSign.open(),!n&&signBtnOldSign?signBtnOldSign.hide():n&&signBtnOldSign&&signBtnOldSign.show(),$("#"+signImgId).attr("src","data:image/png;base64,"+i)}function setVouchersPrint(t,e,i){for(var n in t){var o=t[n];"06"!=o.printType&&(o.paperPrintFlag=!0)}if(i){var a=0,s=[]
;for(var n in e)(!0===e[n].countPrintFlag||e[n].countPrintFlag===undefined&&"01"==e[n].printType&&!e[n].vchrLvlTpcd)&&(s.push(n.substr(0,32)),a++);PJF.communication.cpsJsonReq({noRoleTransaction:!0,jsonData:PJF.util.jsontostr({pprVchrCnt:a,pprVchrList:s.join(","),sysEvtTraceId:i}),fwServiceId:"remoteDatabaseTransaction",fwTranId:"update",sqlId:"printplatform.updatePprVchrCntByMap",success:function(t){},failure:function(t){}})}}exports.cartSign=function(n){var t={cartId:n.cartId,_elec_sign:exports.canElecSign(),_elec_seal_switch:exports.canElecSeal(),_elec_voucher:!1,_combin_slip:n._combin_slip,_elec_sign_capability:exports.getElecSignCapability(),_elec_seal_capability:exports.getElecSealCapability()},o=new PJF.ui.loading({maskBody:!0});PJF.communication.ajax({url:"ecpJson.action",data:{_fw_service_id:"tradeCartTrans",jsonData:JSON.stringify(t)},success:function(t){o.destroy(),t&&t.PRINT_VOUCHER_STRING_MAP&&PJF.communication.elecSign.canElecSign()?exports.oneTimeSign({
sysEvtTraceId:n.cartId,customerName:n.customerName,agentName:n.agentName,data:t,callback:function(){n.callback&&n.callback(t)}}):n.callback&&n.callback(t)},failure:function(t,e,i){o.destroy(),n.callback&&n.callback()}})},exports.protocolSign=function(e){PJF.communication.elecSign.getProtocolMap({fmtPrintId:e.fmtPrintId,jsonData:e.jsonData,callback:function(t){if(t){if(!PJF.communication.elecSign.canElecSign())return void new PJF.ui.messageBox({style:"confirm",closable:!1,buttonText:["客户已签纸质协议","取消交易"],title:"电子签名功能关闭",content:"请使用纸质协议",ok:function(){e.callback&&e.callback({status:0})},cancel:function(){e.callback&&e.callback({status:1,reason:"客户拒绝纸质协议，交易取消"})}});PJF.communication.elecSign.oneTimeSign({agentName:e.agentName,customerName:e.customerName,onetime:e.onetime,data:{PRINT_PROTOCOL_STRING_MAP:t},callback:function(t){t.cancel?new PJF.ui.messageBox({style:"warning",closable:!1,buttonText:["取消交易"],title:"客户取消",content:"客户取消柜外清确认",fn:function(){e.callback&&e.callback({status:1,
reason:"客户取消柜外清确认"})}}):t.notAttnProtocol?new PJF.ui.messageBox({style:"confirm",closable:!1,buttonText:["客户已抄录纸质协议","取消交易"],title:"以下协议抄录或确认失败，请使用纸质协议",content:t.notAttnProtocol.protocolNames,ok:function(){e.callback&&e.callback({status:0,notAttnProtocol:t.notAttnProtocol})},cancel:function(){e.callback&&e.callback({status:1,reason:"客户拒绝抄录纸质协议，交易取消"})}}):t.cancelAttn?new PJF.ui.messageBox({style:"warning",closable:!1,buttonText:["取消交易"],title:"协议抄录失败",content:t.msg,fn:function(){e.callback&&e.callback({status:1,reason:t.msg})}}):t.notConfirm?new PJF.ui.messageBox({style:"confirm",closable:!1,buttonText:["客户已签纸质协议","取消交易"],title:"以下协议签名或确认失败，请使用纸质协议",content:t.notConfirm.protocolNames,ok:function(){e.callback&&e.callback({status:0,notConfirm:t.notConfirm})},cancel:function(){e.callback&&e.callback({status:1,reason:"客户拒绝纸质协议，交易取消"})}}):t.uploadProtocolList?e.callback&&e.callback({status:0,uploadProtocolList:t.uploadProtocolList}):e.callback&&e.callback({status:0})}})
}else e.callback&&e.callback({status:0})}})},exports.oneTimeSign=function(l){var t=_populateAppData(l);if(PJF.communication.elecSign.canElecSign()){var d,u,h=getType(l.data),e={};if("array"==PJF.util.getType(l.data.PRINT_VOUCHER_STRING_MAP))for(var i=0;i<l.data.PRINT_VOUCHER_STRING_MAP.length;i++){var n=l.data.PRINT_VOUCHER_STRING_MAP[i],o={};for(var a in n){o[a+sameVoucherSeparator+PJF.util.generateUUid()]=n[a]}$.extend(e,o)}var s=l.hasSigned,p=[];"PRINT_VOUCHER_STRING_MAP",["电子凭证签名","合成签名凭证失败","凭证预览失败"],"PRINT_PROTOCOL_STRING_MAP",d="protocolFileId",u="protocolFileMd5",["电子协议签名","合成签名协议失败","协议预览失败"],voucherFilePath="voucherFilePath";var f,r="<div id = '"+contentId+"' style='text-align:center;margin:10px;color:red;'></div>",c=!"voucherFileMd5",m=!"voucherFileId",g=[],v=[],_=[],b=[];if($.isEmptyObject(e))var y=$.extend({},l.data.PRINT_PROTOCOL_STRING_MAP,l.data.PRINT_VOUCHER_STRING_MAP);else y=$.extend({},l.data.PRINT_PROTOCOL_STRING_MAP,e);var P={},C={}
;for(var a in y)(y[a].elecSignFlag||2==h)&&(y[a].protocolName&&(y[a].elecSignFlag&&(m=!0,b.push(a)),y[a].protocolAttn?(c=!0,g.push(y[a].protocolAttn)):g.push({protocolAttnMode:"0",protocolAttnInfo:""})),P[a]=y[a],y[a].elecSignFlag&&(C[a]=y[a]),v.push(a)),2==h&&_.push(y[a].protocolName),y[a].pjfVoucherId=a,y[a].voucherName&&(y[a].voucherContent=y[a].printContent);if($.isEmptyObject(P))l.callback&&l.callback();else{var I;f={protocolNames:_.join(","),voucherIDS:b.join(",")},r+='<div id = "'+winImgViewerId+'" style="margin:0 auto;width:700px;height:500px;"></div>',r+="<div style='text-align:center;'><span id='"+btnId+"'></span><span id='"+cancelSignId+"'></span></div>",l.data._COMMON&&(I=l.data._COMMON.P2S_EVT_TRACE_ID||l.data._COMMON.SYS_EVT_TRACE_ID),I=l.sysEvtTraceId||I,lockScreen(),win||($(document.body).append("<div id = '"+winId+"'></div>"),win=new PJF.ui.window({dom:winId,title:"电子签名",width:$(window).width()-50,height:600,closable:!1,content:r}),content=$("#"+contentId),
$("#"+winImgViewerId).css("width",$(window).width()-100),imgPreviewer=new PJF.ui.imgPreviewer({dom:winImgViewerId,isGlass:!1,isClassify:!1,listOnly:!0,thumbHeight:50,thumbWidth:50,btn:[{name:"放大",onclick:function(){imgPreviewer.zoom(!0,[1.3,.7])}},{name:"缩小",onclick:function(){imgPreviewer.zoom(!1,[1.3,.7])}}],data:[],colSet:!1,imgAutoSize:!0,dragable:!1}),(windowBtnConfirm=new PJF.ui.linkButton({dom:btnId,name:"确定",onclick:function(t){unLockScreen(),win&&(win&&win.destroy(),$("#"+winId).remove(),win=null),winSign&&(winSign&&winSign.destroy(),$("#"+signWinId).remove(),winSign=null),l.callback&&l.callback.apply(l,p)},iconCls:"icon-confirm"})).disable(),exports.supportCancelOper()&&!c&&(windowBtnCancel=new PJF.ui.linkButton({dom:cancelSignId,name:"取消签名",onclick:function(){var t=PJF.communication.client.cancelOper({strTimeout:"20"});"0"==t[0]||new PJF.ui.messageBox({style:"warning",closable:!1,title:"取消签名失败",content:"原因:"+t[1],fn:function(){}})},iconCls:"icon-cancel"})));var F,x=[],w=[]
;for(var a in P){var D=P[a],T=Date.now();if(D.protocolName)var A=PJF.communication.client.createVoucherBackGrdMain(D[d],D[u],D.printContent||"",D[voucherFilePath]);else if(D.voucherName)A=PJF.communication.client.createVoucherBackGrdMain(D.voucherFileId,D.voucherFileMd5,D.printContent||"",D[voucherFilePath]);if(console.log("生成底板花费时间:"+(Date.now()-T)/1e3),"0"!=A[0])new PJF.ui.messageBox({style:"warning",title:"预览失败",content:"原因:"+A[1],fn:function(){}});else{x.push(A[1]),D.backGrdPath=A[1];var E=PJF.communication.client.doCommonCommand("getPicture","get",A[1]);"0"==E[0]?w.push({url:"data:image/png;base64,"+E[1],voucerId:D.pjfVoucherId,type:"elecSign",typeDESC:D.pjfVoucherId}):w.push({url:"file:///"+A[1],voucerId:D.pjfVoucherId,type:"elecSign",typeDESC:D.pjfVoucherId})}}if(0<w.length&&imgPreviewer.addImg(w),x.length!=v.length)return 2==h&&p.push({notConfirm:f}),setVouchersPrint(C,y,I),windowBtnConfirm.enable(),void(windowBtnCancel&&windowBtnCancel.disable())
;if(content.text("请等待客户签名或确认信息"),2==h&&(m&&l.onetime||!m))if(c){exports.getProtocolAttnCapability()||p.push({notAttnProtocol:f});var J=new PJF.ui.loading({maskBody:!0,text:"请等待客户抄录协议..."});(function(){var t={strTypeId:"1",strVoiceNo:"17",strTimeout:x.length*elecTimeout+"",strProtocolBackGrd:x.join("|"),strCriticalContent:[],strConfirmMode:[]};for(var e in P){var i=P[e].protocolAttn||{protocolAttnMode:"0",protocolAttnInfo:""};t.strCriticalContent.push(i.protocolAttnInfo),t.strConfirmMode.push(i.protocolAttnMode)}t.strCriticalContent=t.strCriticalContent.join("|"),t.strConfirmMode=t.strConfirmMode.join("|");var c=$.Deferred();return PJF.communication.client.pjfAsyncCall("PJF.communication.client.signPVAsync",2,[t,function(t){if("0"==t[0])if("0"==t[2])c.reject({status:"1",msg:"展示抄录协议,调用柜外清客户取消"});else{for(var e in P){var i=Date.now(),n=P[e],o=n.protocolAttn;if(o){var a=PJF.communication.client.createVoucherBackGrdMain(n[d],n[u],o.protocolAttnContent,n[voucherFilePath])
;if(console.log("生成抄录合成图片花费时间:"+(Date.now()-i)/1e3),"0"==a[0]){var s=imgPreviewer.getImgByAttr("typeDESC",n.pjfVoucherId)[0],r=PJF.communication.client.doCommonCommand("getPicture","get",a[1]);"0"==r[0]?imgPreviewer.setAttr(s,{url:"data:image/png;base64,"+r[1]}):imgPreviewer.setAttr(s,{url:"file:///"+a[1]})}else new PJF.ui.messageBox({style:"warning",title:"合成抄录协议图片失败",content:"原因:"+a[1],fn:function(){}})}}c.resolve({status:"0"})}else c.reject({status:"2",msg:"展示抄录协议,外设调用失败, 原因:"+t[1]})}]),c.promise()})().always(function(){J.destroy(),windowBtnConfirm.enable(),content.text("")}).then(function(t){p.push({})},function(t){content.text(t.msg),"2"==t.status?p.push({notAttnProtocol:f}):p.push({cancelAttn:!0,msg:t.msg})})}else F=function(t){windowBtnConfirm.enable(),windowBtnCancel&&windowBtnCancel.disable(),content.text(""),0==t.status?p.push({}):1==t.status?p.push({cancel:!0}):2==t.status&&p.push({notConfirm:f})},exports.protocolConfirm({backGrdPath:x.join("|"),callback:function(t){
0==t.status?F({status:0}):2==t.status?F({status:2,msg:t.confirmErrMsg}):1==t.status&&F({status:1})}});else{exports.sign($.extend({},t,{hasSigned:s,loadingParam:!1,backGrdPath:x.join("|"),map:C,totalMap:y,type:h,sysEvtTraceId:I,callback:function(t){if(windowBtnConfirm.enable(),windowBtnCancel&&windowBtnCancel.disable(),content.text(""),0==t.status)for(var e in C){var i=C[e],n=Date.now(),o=PJF.communication.client.elecSignVoucherCompseMain({backFile:i.backGrdPath,singFile:t.signPicData,signX:parseInt(i.elecSignInfo.X,10),signY:parseInt(i.elecSignInfo.Y,10),width:parseInt(i.elecSignInfo.width,10),height:parseInt(i.elecSignInfo.height,10),signfileType:"2",elecSealInfo:i.elecSealInfo,sealXCood:i.SealXCood,sealYCood:i.SealYCood});if(console.log("合成签名花费时间:"+(Date.now()-n)/1e3),"0"==o[0]){var a=imgPreviewer.getImgByAttr("typeDESC",i.pjfVoucherId)[0];imgPreviewer.setAttr(a,{url:"data:image/png;base64,"+o[1]}),l.saveComposite&&(i.compositeBase64=o[1])}else new PJF.ui.messageBox({style:"warning",
title:"合成签名失败",content:"原因:"+o[1],fn:function(){}})}if(0==t.status&&2==h&&($.extend(f,t),p.push({uploadProtocolList:f})),0!=t.status)if(2==h)p.push({notConfirm:f});else{for(var s=[],r=0;r<b.length;r++){var c=y[b[r]];s.push(c.protocolName)}0<s.length&&new PJF.ui.messageBox({style:"warning",title:"以下协议签名失败，请使用纸质协议",content:s.join(","),closable:!1,buttonText:["继续"],fn:function(){}})}}}))}}}else l.callback&&l.callback()},exports.sign=function(c){_populateAppData(c);function l(t){var e=[];for(var i in d)d[i].elecSignFlag&&d[i].paperPrintFlag&&"02"!=d[i].printType&&"05"!=d[i].printType&&e.push(i);if(0<e.length&&2!=t.status&&!c.needAuth){for(var n=0;n<e.length;n++)d[e[n]].confirmNoSign=!0;exports.uploadSign({PRINT_VOUCHER_STRING_MAP:c.totalMap||c.map,CONFIRM_NO_SIGN_DATA:{sysEvtTraceId:c.sysEvtTraceId,voucherIDS:e.join(",")}})}c.callback&&c.callback(t)}var t,e,i,n=c.backGrdPath,o=c.hasSigned,d=c.map,a=c.type||1,s={strTypeId:"1",strBackGrd:n,strVoiceNo:1==a||3==a?15:16,
strTimeout:n.split("|").length*elecTimeout};!1!==c.loadingParam&&(c.loadingParam=c.loadingParam||{text:"请等待客户签名...",maskBody:!0},e=new PJF.ui.loading(c.loadingParam)),o===undefined?i=["重新签名","取消签名"]:!0===o&&(i=["重新签名","取消签名"]);var u=[];for(var r in d)d[r].elecSignFlag&&u.push(r);PJF.communication.client.pjfAsyncCall("PJF.communication.client.getSignatureAsync",2,[s,function(r){"0"==r[0]?""==r[2]?new PJF.ui.messageBox({style:"confirm",buttonText:i,closable:!1,title:"电子签名为空",content:"请确认是否重签名",ok:function(){exports.sign(c)},cancel:function(){t={status:1,signErrMsg:"取消签名"},setVouchersPrint(d,c.totalMap||c.map,c.needAuth?null:c.sysEvtTraceId),l(t)}}):(createWinSign(c.customerName,c.agentName,r[3]),signBtnResign.bindClickHandler(function(){winSign.close(),exports.sign(c)}),signBtnConfirm.bindClickHandler(function(){if(c.needAuth&&PJF.util.isYGQD()){PJF.event.onceSubscriber(PJF.loadResource.PJF_AUTH_FAILURE,e);var t=!1;if($.ajax({url:"/bosWeb/page/common/auth/authCom.js",async:!1,
dataType:"script",success:function(){$('<div id="authWindDOM"></div>').appendTo(document.body),t=!0}}),!t)return PJF.event.removeSubscriber(PJF.loadResource.PJF_AUTH_FAILURE,e),void e();authDeal("authWindDOM",{App_ID:"ESIGN",Org_Code:"999999999",Trans_ID:"ELECSIGN-001"},function(t){PJF.event.removeSubscriber(PJF.loadResource.PJF_AUTH_FAILURE,e),i()})}else i();function e(){winSign.close(),setVouchersPrint(d,c.totalMap||c.map),l({status:2,signPicData:r[3],signOrigData:r[2],vender:r[4],signErrMsg:"授权失败"})}function i(){if(winSign.close(),c.sysEvtTraceId){for(var t in d)if(!d[t].cartTransFlag){!1;break}var e=PJF.userInfo.userCode+getUUID()+".PNG",i=PJF.userInfo.userCode+getUUID()+".txt",n="D:/CCB/ECP/Temp/SignBackGrd/"+e,o="D:/CCB/ECP/Temp/SignBackGrd/"+i,a=PJF.communication.client.fileUtils("createFile",o,r[2]),s=PJF.communication.client.doCommonCommand("getPicture","set",r[3],n);if(0!=s[0]||0!=a[0])return void l({status:1,signPicData:r[3],signOrigData:r[2],vender:r[4],signPicDataPath:n,
signOrigDataPath:o,signPicDataFileName:e,signOrigDataFileName:i,signErrMsg:0==s[0]?a[1]:s[1]});exports.uploadSign({PRINT_VOUCHER_STRING_MAP:c.totalMap||c.map,SIGN_DATA:{sysEvtTraceId:c.sysEvtTraceId,voucherIDS:u.join(","),signPicDataPath:n,signOrigDataPath:o,signPicDataFileName:e,signOrigDataFileName:i,vender:r[4]},callback:function(t){if(1==t.status||2==t.status)setVouchersPrint(d,c.totalMap||c.map,c.needAuth?null:c.sysEvtTraceId),l({status:1,signPicData:r[3],signOrigData:r[2],vender:r[4],signErrMsg:"取消签名"});else if(0==t.status){for(var e in d)d[e].elecSignFlag&&(d[e].elecSignPicBase64=r[3]);l({status:0,signPicData:r[3],signOrigData:r[2],vender:r[4]})}}})}else l({status:0,signPicData:r[3],signOrigData:r[2],vender:r[4]})}})):r[1]&&-1!=r[1].indexOf("ECPSWSTLC014")?(setVouchersPrint(d,c.totalMap||c.map,c.needAuth?null:c.sysEvtTraceId),l(t={status:1,signErrMsg:r[1]})):new PJF.ui.messageBox({style:"confirm",buttonText:i,closable:!1,title:"电子签名失败",content:"原因:"+r[1],ok:function(){
exports.sign(c)},cancel:function(){setVouchersPrint(d,c.totalMap||c.map,c.needAuth?null:c.sysEvtTraceId),l(t={status:1,signErrMsg:r[1]})}}),e&&e.destroy()}])},exports.ootcSign=function(e){var i,n=_populateAppData(e),t={strTypeId:"3",strBackGrd:e.strBackGrd,strVoiceNo:16,strTimeout:elecTimeout};!1!==e.loadingParam&&(e.loadingParam=e.loadingParam||{text:" ",maskBody:!0},i=new PJF.ui.loading(e.loadingParam)),PJF.communication.client.pjfAsyncCall("PJF.communication.client.getSignatureAsync",2,[t,function(t){"0"==t[0]?""==t[2]?(result={status:1,signErrMsg:"取消签名"},e.callback(result)):(createWinSign(e.customerName,e.agentName,t[3],!0),signBtnResign.bindClickHandler(function(){winSign.close(),compareSignWin&&compareSignWin.close(),exports.ootcSign(e)}),signBtnOldSign&&signBtnOldSign.bindClickHandler(function(){_openOldElecSign(n)}),signBtnConfirm.bindClickHandler(function(){winSign.close(),compareSignWin&&compareSignWin.close(),e.callback({status:0,signPicData:t[3],signOrigData:t[2],
vender:t[4]})})):(t[1]=t[1]||"",-1==t[1].indexOf("ECPSWSTLC014")&&new PJF.ui.messageBox({style:"confirm",buttonText:["重新签名","取消签名"],closable:!1,title:"电子签名失败",content:"原因:"+t[1],ok:function(){exports.ootcSign(e)},cancel:function(){result={status:1,signErrMsg:t[1]},e.callback(result)}})),i&&i.destroy()}])},exports.protocolConfirm=function(e){var t={type:"1",filePath:e.backGrdPath,strVoiceNo:"17"},i=new PJF.ui.loading({maskBody:!0,text:"请等待客户确认..."});PJF.communication.client.pjfAsyncCall("PJF.communication.client.fileDispConfirmAsync",1,[t,function(t){i.destroy(),0==t[0]?0==t[2]?e.callback({status:1}):1==t[2]?e.callback({status:0}):alert("协议柜外清确认未知数据:"+t):new PJF.ui.messageBox({style:"confirm",buttonText:["重新确认","取消确认"],closable:!1,title:"柜外清确认失败",content:"原因:"+t[1],ok:function(){exports.protocolConfirm(e)},cancel:function(){e.callback&&e.callback({status:2,confirmErrMsg:t[1]})}})}])},exports.uploadSign=function(e){var t=!1
;for(var i in e.PRINT_VOUCHER_STRING_MAP)e.PRINT_VOUCHER_STRING_MAP[i].cartTransFlag&&(t=!0);if(e.SIGN_DATA&&"array"!=PJF.util.getType(e.SIGN_DATA)){var n=e.SIGN_DATA.sysEvtTraceId;if("string"==typeof n)e.SIGN_DATA=[e.SIGN_DATA];else if("array"==PJF.util.getType(n)){var o={};for(var i in e.PRINT_VOUCHER_STRING_MAP){if(-1!=(c=PJF.util.array.indexOf(n,e.PRINT_VOUCHER_STRING_MAP[i].sysEvtTraceId))){var a=-1!=(l=i.indexOf(sameVoucherSeparator))?i.substr(0,l):i;o[n[c]]?o[n[c]].push(a):o[n[c]]=[a]}}var s=[];for(var i in o){(u=$.extend({},e.SIGN_DATA)).voucherIDS=o[i].join(","),u.sysEvtTraceId=i,s.push(u)}e.SIGN_DATA=s}}if(e.CONFIRM_NO_SIGN_DATA&&"array"!=PJF.util.getType(e.CONFIRM_NO_SIGN_DATA)){var r=e.CONFIRM_NO_SIGN_DATA.sysEvtTraceId;if("string"==typeof r)e.CONFIRM_NO_SIGN_DATA=[e.CONFIRM_NO_SIGN_DATA];else if("array"==PJF.util.getType(r)){o={};for(var i in e.PRINT_VOUCHER_STRING_MAP){var c;if(-1!=(c=PJF.util.array.indexOf(r,e.PRINT_VOUCHER_STRING_MAP[i].sysEvtTraceId))){var l
;a=-1!=(l=i.indexOf(sameVoucherSeparator))?i.substr(0,l):i;o[r[c]]?o[r[c]].push(a):o[r[c]]=[a]}}var d=[];for(var i in o){var u;(u={}).voucherIDS=o[i].join(","),u.sysEvtTraceId=i,d.push(u)}e.CONFIRM_NO_SIGN_DATA=d}}!t&&(e.PRINT_VOUCHER_STRING_MAP=undefined);var h,p,f={_fw_service_id:"uploadElecSignatureData",jsonData:JSON.stringify(exports.addElecParam({PRINT_VOUCHER_STRING_MAP:e.PRINT_VOUCHER_STRING_MAP,CONFIRM_NO_SIGN_DATA:e.CONFIRM_NO_SIGN_DATA,SIGN_DATA:e.SIGN_DATA}))},m=[["正在上传电子签名...",["重新上传","取消签名"],"上传电子签名失败"],["后端系统正在确认该笔交易放弃签名...",["重新确认","取消确认"],"向后台确认该笔交易放弃签名失败"]];h=e.SIGN_DATA?m[0]:m[1],e.callback&&(p=new PJF.ui.loading({maskBody:!0,text:h[0]}));var g=Date.now();if(e.SIGN_DATA){PJF.communication.addParam(f),f.RL_IDS=[];var v="";if(PJF.roleInfo&&PJF.roleInfo.orgCode&&(v=PJF.roleInfo.orgCode),f.savePath=uploadNasPath+v,exports.addElecParam(f),e.SIGN_DATA[0].signPicData&&e.SIGN_DATA[0].signOrigData){
var _=PJF.userInfo.userCode+getUUID()+".PNG",b=PJF.userInfo.userCode+getUUID()+".txt",y="D:/CCB/ECP/Temp/SignBackGrd/"+_,P="D:/CCB/ECP/Temp/SignBackGrd/"+b,C=PJF.communication.client.fileUtils("createFile",P,e.SIGN_DATA[0].signOrigData),I=PJF.communication.client.doCommonCommand("getPicture","set",e.SIGN_DATA[0].signPicData,y);if(0!=I[0]||0!=C[0])return p&&p.destroy(),void w("生成签名图片或轨迹文件失败。"+(0==I[0]?C[1]:I[1]));e.SIGN_DATA[0].signPicDataPath=y,e.SIGN_DATA[0].signPicDataFileName=_,e.SIGN_DATA[0].signOrigDataPath=P,e.SIGN_DATA[0].signOrigDataFileName=b,e.SIGN_DATA[0].signPicData=e.SIGN_DATA[0].signOrigData=undefined}f.signPicDataPath=e.SIGN_DATA[0].signPicDataPath,f.signOrigDataPath=e.SIGN_DATA[0].signOrigDataPath,f.jsonData=undefined,f.SIGN_DATA=e.SIGN_DATA,f.PRINT_VOUCHER_STRING_MAP=e.PRINT_VOUCHER_STRING_MAP;var F=(PJF.constants.D2D,
"/bosWeb/nas2/ecpJson.action"),x=PJF.communication.client.uploadHttpReq("http://"+location.host+F,["signPicDataPath","signOrigDataPath"].join(","),JSON.stringify(f),"30000");console.log("上传签名花费时间:"+(Date.now()-g)/1e3),p&&p.destroy(),0==x[0]?(x[1]=JSON.parse(x[1]),"00"==x[1].status?D():w(x[1].msg)):w(x[1])}else PJF.communication.ajax({url:"ecpJson.action",data:f,noRoleTransaction:!0,safe:!0,success:function(t){console.log("上传签名花费时间:"+(Date.now()-g)/1e3),"00"==t.status?D():w(t.msg)},failure:function(t,e,i){w(e)},complete:function(){p&&p.destroy()}});function w(t){e.callback&&new PJF.ui.messageBox({style:"confirm",buttonText:h[1],closable:!1,title:h[2],content:"原因:"+t,ok:function(){exports.uploadSign(e)},cancel:function(){e.SIGN_DATA?(e.CONFIRM_NO_SIGN_DATA=e.CONFIRM_NO_SIGN_DATA||[],e.CONFIRM_NO_SIGN_DATA=e.CONFIRM_NO_SIGN_DATA.concat(e.SIGN_DATA),e.SIGN_DATA=undefined,exports.uploadSign(e)):e.callback&&e.callback({status:1,uploadErrMsg:t})}})}function D(){var t
;e.callback&&(e.SIGN_DATA?t={status:0}:e.CONFIRM_NO_SIGN_DATA&&(t={status:2}),e.callback&&e.callback(t))}},exports.canElecSign=function(){if(PJF.communication.client.isInP2()&&PJF.constants.ELEC_SIGN_FLAG===undefined)try{var t=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","flag.b.dat")[1]||["1,内容获取失败"],i=t.charAt(0),n=t.substr(2);PJF.constants.ELEC_SIGN_FLAG="0"==i&&"true"==n}catch(e){PJF.constants.ELEC_SIGN_FLAG=!1,console.log("获取电子凭证标志出错:"+e.message)}return PJF.constants.ELEC_SIGN_FLAG},exports.canElecSeal=function(){if(PJF.communication.client.isInP2()&&PJF.constants.ELEC_SEAL_FLAG===undefined)try{var t=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltSwitch.b.dat","print")[1]||["1,内容获取失败"],i=t.charAt(0),n=t.substr(2);PJF.constants.ELEC_SEAL_FLAG="0"==i&&"true"==n}catch(e){PJF.constants.ELEC_SEAL_FLAG=!1,console.log("获取电子印章标志出错:"+e.message)}return PJF.constants.ELEC_SEAL_FLAG},exports.getProtocolMap=function(n){var t={
_fw_service_id:"voucherPrintServiceReq",unitedVoucherId:n.fmtPrintId,_print_type:"2",_elec_sign:!0,_elec_sign_capability:exports.getElecSignCapability(),_elec_seal_capability:exports.getElecSealCapability(),jsonData:n.jsonData},o=new PJF.ui.loading({maskBody:!0,text:"正在获取协议须知..."});PJF.communication.ajax({url:"ecpJson.action",data:t,safe:!0,success:function(t){o.destroy(),$.isEmptyObject(t)?n.callback&&n.callback():n.callback&&n.callback(t)},failure:function(t,e,i){o.destroy(),new PJF.ui.messageBox({style:"warning",closable:!1,title:"获取交易协议须知失败",content:["原因:",e," ",i,",请使用纸质协议"].join(""),fn:function(){n.callback&&n.callback()}})}})},exports.getElecSignCapability=function(){if(PJF.communication.client.isInP2()&&PJF.constants.ELEC_SIGN_CAPABILITY===undefined){PJF.constants.ELEC_SIGN_CAPABILITY=!1;try{("1.2.7"==PJF.util.getClientVersion()&&PJF.util.compareClientVersion("1.2.7","1")||PJF.util.compareClientVersion("1.3"))&&(PJF.constants.ELEC_SIGN_CAPABILITY=!0)}catch(e){
console.log("获取终端电子签名能力出错:"+e.message)}}return PJF.constants.ELEC_SIGN_CAPABILITY},exports.getElecSealCapability=function(){if(PJF.communication.client.isInP2()&&PJF.constants.ELEC_SEAL_CAPABILITY===undefined){PJF.constants.ELEC_SEAL_CAPABILITY=!1;try{("1.2.7"==PJF.util.getClientVersion()&&PJF.util.compareClientVersion("1.2.7","5")||PJF.util.compareClientVersion("1.3"))&&(PJF.constants.ELEC_SEAL_CAPABILITY=!0)}catch(e){console.log("获取终端电子印章能力出错:"+e.message)}}return PJF.constants.ELEC_SEAL_CAPABILITY},exports.getProtocolAttnCapability=function(){return void 0===_attnCapability&&(_attnCapability=!1,PJF.util.compareClientVersion("1.4")&&0<=PJF.util.compareVersion(exports.getTelclrVersion(),"2.4")&&(_attnCapability=!0)),_attnCapability},exports.getTelclrFlag=function(){var t=!1;try{var e=PJF.communication.client.getClientEnv("telclrFlag");e&&"true"==e[1]&&(t=!0)}catch(i){}return t},exports.getVoucherSeparator=function(){return sameVoucherSeparator+PJF.util.generateUUid()}
;var _telclrVersion="1.0";exports.getTelclrVersion=function(){if(PJF.communication.client.isInP2()&&"1.0"==_telclrVersion){var t={bizArgs:{},devKindId:"dev_telclr",interfaceId:"getStatus"},e=PJF.communication.client.callDevice(PJF.util.jsontostr(t));"0"==e[0]&&(_telclrVersion=e[6])}return _telclrVersion},exports.supportCancelOper=function(){if(PJF.communication.client.isInP2()&&PJF.constants.ELEC_CANCEL_CAPABILITY===undefined)if(PJF.constants.ELEC_CANCEL_CAPABILITY=!1,PJF.util.compareClientVersion("1.3")){var t={bizArgs:{},devKindId:"dev_telclr",interfaceId:"getStatus"},e=PJF.communication.client.callDevice(PJF.util.jsontostr(t));"0"==e[0]&&0<=PJF.util.compareVersion(e[6],"2.2")?PJF.constants.ELEC_CANCEL_CAPABILITY=!0:PJF.constants.ELEC_CANCEL_CAPABILITY=!1}else PJF.constants.ELEC_CANCEL_CAPABILITY=!1;return PJF.constants.ELEC_CANCEL_CAPABILITY},exports.addElecParam=function(t){return(t=t||{})._elec_sign=exports.canElecSign(),t._elec_seal_switch=exports.canElecSeal(),
t._elec_sign_capability=exports.getElecSignCapability(),t._elec_seal_capability=exports.getElecSealCapability(),t}}(PJF.communication.elecSign),function(){var s="FUNC_EVA_MAP",r=PJF.util.formatDate(new Date),c=PJF.html.getUrlParam("menuId"),l=function(){var t=PJF.communication.client.getAppData("PJF_DATA",s);return"0"==t[0]&&t[1]?JSON.parse(t[1]):(console.log("获取客户评价map出错:"+t[1]),{})},i=function(){var n,o,a=$('<div style = "position:fixed;width:53px;height:39px;right:0px;top:50px;background-image:url(/bosWeb/css/images/pjf-func-eva.png)"><div id = "pjf_eva_windowDom"></div></div>');$("body").append(a),a.on("click",function(){n=new PJF.ui.window({title:"系统评价",width:400,height:250,dom:"pjf_eva_windowDom",
content:'<style>.pjf-eva-title {font-size: 24px; margin-top: 10px; text-align: center;}.pjf-eva-container {position:relative;left:50%;-webkit-transform:translateX(-50%);margin:20px 0}.pjf-eva-bottom {margin-top: 20px; text-align: center;} </style><div class = "pjf-eva-title">请您对功能页面进行评价</div><div id = "pjf_eva_container"><div class = "pjf-eva-container" id = "pjf-eva-radio"></div></div><div class = "pjf-eva-bottom"><a id = "pjf_eva_submit"></a></div>'}),o=new PJF.ui.radio({dom:"pjf-eva-radio",id:"radiol1",name:"money",count:3,labels:["满意","界面繁琐","操作复杂","菜单难找","创建建议类工单"],values:["0","1","2","3","4"],required:!0,missingMessage:"请选择评价"}),new PJF.ui.linkButton({dom:"pjf_eva_submit",name:"提交",iconCls:"icon-submit",onclick:function(){PJF.html.validateForm("pjf_eva_container")&&PJF.communication.cpsJsonReq({noRoleTransaction:!0,fwServiceId:"recordBizEvaIndicator",fwTranId:"recordBizEvaIndicator",maskAll:!0,loadingText:"正在提交评价...",jsonData:JSON.stringify({insid:PJF.roleInfo.orgCode,
tmnlId:PJF.otherInfo.logicTerminalNo,oprId:PJF.userInfo.userCode,evaContent:[{indexTpcd:"00001",indexKey:PJF.html.getUrlParam("menuId"),indexVal:o.getValue(),wrkordrId:"",rmrk:""}]}),success:function(){var t,e=l();if(e[c]=r,t=e,PJF.communication.client.setAppData("PJF_DATA",s,JSON.stringify(t)),"4"==o.getValue()){var i=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","bugup.b.dat","00","00");i="0"==i[0]?"&p9fileid="+i[1]:"",PJF.html.openWin(PJF.communication.client.getIPByRouteId("srs")+"bosWeb/page/srs/workorder/create/CreateWorkOrderByUserComment.jsp?srcType=2&menuCd="+c+i)}else new PJF.ui.messageBox({content:"评价提交成功"});n.destroy(),a.remove()},failure:function(t){new PJF.ui.errorMessageBox({data:t})}})}})})};PJF.html.showFuncEvaluation=function(){if(PJF.communication.client.isInP2()){var t=PJF.util.getValue(window,"PJF.userInfo.userCode"),e="true"===PJF.communication.client.getClientEnv("oversea")[1]||"1.2.7.5"===PJF.util.getClientVersion()
;if(PJF.constants.FUNC_EVALUATION&&document.body&&t&&c&&!e&&-1==c.indexOf("ccb.cddev"))l()[c]!=r&&PJF.communication.ajax({url:"ecpJson.action",data:{_fw_service_id:"queryBizEvaIndicator",jsonData:JSON.stringify({oprId:t,indexTpcd:"00001",indexKey:c})},success:function(t){t.RESULT_DATA&&0==t.RESULT_DATA.length&&i()},failure:function(){}})}};PJF.html.showKHTSJ=function(){if(PJF.constants.FUNC_KHTSJ){var t,e=PJF.util.getValue(window,"PJF.roleInfo.positionId");-1!==PJF.util.array.indexOf(PJF.constants.FUNC_KHTSJ,e)&&c&&(t=$('<div style = "position:fixed;width:53px;height:39px;right:0px;top:100px;background-image:url(/bosWeb/css/images/pjf-khtsj.png)"></div>'),$("body").append(t),t.on("click",function(){PJF.html.openWin("http://"+location.host+"/bosWeb/page/ici/custInfoNew/queryEnterModule.jsp?invokeMenuId="+c,"客户透视镜")}))}}}(),PJF.namespace("PJF.event"),PJF.event=function(){var r={};return{publish:function(t){var e=r[t];if(e){var i=Array.prototype.slice.call(arguments,1);e=e.slice()
;for(var n=undefined,o=0,a=e.length;o<a;o++)try{e[o].__run_once&&PJF.event.removeSubscriber(t,e[o]),n=e[o].apply(window,i)}catch(s){console.log("publish callback error for event:"+t),console.log(s.stack)}return n}},asyncPublish:function(a){var s=arguments;setTimeout(function(){var t=r[a];if(t)for(var e=Array.prototype.slice.call(s,1),i=0,n=(t=t.slice()).length;i<n;i++)try{t[i].__run_once&&PJF.event.removeSubscriber(a,t[i]),t[i].apply(window,e)}catch(o){console.log("asyncPublish callback error for event:"+a),console.log(o.stack)}},0)},hasEvent:function(t){return t in r},onceSubscriber:function(t,e){"function"==typeof e&&(e.__run_once=!0,this.addSubscriber(t,e,null))},addSubscriber:function(t,e,i,n){t&&(r[t]&&!n?r[t].push(e):r[t]=[e])},removeSubscriber:function(t,e){if(t||e){var i=r[t];if(i){if(e){for(var n=0,o=i.length;n<o;n++)if(e===i[n]){i.splice(n,1);break}}else i=[];0===i.length&&delete r[t]}}else r={}},getCallBackList:function(t){return r[t]||[]}}}(),window.PJF=window.PJF||{},
PJF.observable=function(s){s=s||{};var r={},n=function(t,e){t.replace(/\S+/g,e)},t=function(t,e){Object.defineProperty(s,t,{value:e,enumerable:!1,writable:!1,configurable:!1})};return t("on",function(t,i){return"function"!=typeof i||n(t,function(t,e){(r[t]=r[t]||[]).push(i),i.typed=0<e}),s}),t("off",function(t,o){return"*"==t||null==t?r={}:n(t,function(t){if(o)for(var e,i=r[t],n=0;e=i&&i[n];++n)e==o&&i.splice(n--,1);else delete r[t]}),s}),t("one",function(o,a){return s.on(o,function t(){s.off(o,t);for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];a.apply(s,i)})}),t("trigger",function(t){for(var e=arguments.length-1,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i+1];return n(t,function(t){for(var e,i=(r[t]||[]).slice(0),n=0;e=i[n];++n){if(e.busy)return;e.busy=1;try{e.apply(s,e.typed?[t].concat(a):a)}catch(o){console.error(o)}i[n]!==e&&n--,e.busy=0}r.all&&"all"!=t&&s.trigger.apply(s,["all",t].concat(a))}),s}),t("triggerAsync",function(t){var e=arguments,i=this
;PJF.constants&&"mobile"==PJF.constants.termType?requestAnimationFrame(function(){i.trigger.apply(i,e)}):setTimeout(function(){i.trigger.apply(i,e)},0)}),t("hasEvent",function(t){return t in r}),s},PJF.namespace("PJF.hotKeyManager"),PJF.hotkeyMap={enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123},PJF.hotKeyManager=function(){var n=[],i=1;return{getPrefix:function(t,e){return t&&e?"PJF_CS_HOT_KEY_":t?"PJF_CTRL_HOT_KEY_":e?"PJF_SHIFT_HOT_KEY_":"PJF_HOT_KEY_"},addHotKeyListener:function(t,e,i,n,o,a){var s=PJF.hotkeyMap[t];s===undefined&&(s=t);var r=this.registerEnv(a);this.startHotKeyListener(r);var c=this.getPrefix(i,n);PJF.event.addSubscriber(c+r.seed+s,function(t){window.PJF_HAS_LOADING?console.log("当前有loading"):e(t)},o)},removeHotKeyListener:function(t,e,i,n,o){var a=this.getEnv(o);if(a)if(t){var s=PJF.hotkeyMap[t];s===undefined&&(s=t);var r=this.getPrefix(i,n);PJF.event.removeSubscriber(r+a.seed+s,e)}else PJF.event.removeSubscriber()},
registerEnv:function(t){t=t||window;var e=this.getEnv(t);return e||(e={win:t,seed:i++,listen:!1},n.push(e),e)},removeEnv:function(t){t=t||window;for(var e=0;e<n.length;e++){if(n[e].win==t){n.splice(e,1);break}}},getEnv:function(t){t=t||window;for(var e=0;e<n.length;e++){var i=n[e];if(i.win==t)return i}},startHotKeyListener:function(a){if(!a.listen){a.listen=!0;var s=this,t=a.win.document;t.addEventListener?t.addEventListener("keyup",e,!1):t.attachEvent("keyup",e)}function e(t){"undefined"!=typeof event&&(t=event);var e=t.keyCode,i=t.ctrlKey,n=t.shiftKey,o=s.getPrefix(i,n)+a.seed+e;PJF.event.publish(o,t,e,i,n)}},stopHotKeyListener:function(){document.removeEventListener?document.removeEventListener("keyup",keyupHander,!1):document.detachEvent("keyup",keyupHander),this.removeHotKeyListener()}}}(),PJF.namespace("PJF.ui"),PJF.ui.component=function(conf){if(this.validateParam(conf)){var visible=!0;if("undefined"!=typeof conf.accessControl&&(visible=eval(conf.accessControl)),
!visible)return void $("#"+conf.dom).hide();this.params=conf,this.id=conf.id,"string"==typeof conf?this.com=$("#"+conf):"string"==typeof conf.dom&&(this.com=$("#"+conf.dom)),this.id||(this.id=this.generateId()),this.com&&(this.com.attr("componentId",this.id),this.com.attr("componentType",this.getClassName()));var beforeInitTime=(new Date).getTime();this.init(conf),PJF.ui.componentMgr.reg(this)}},PJF.apply(PJF.ui.component.prototype,{init:function(){},getId:function(){return this.id},validateParam:function(){return!0},isDisabled:function(){return!1},isReadOnly:function(){return!1},isDisplay:function(){return!0},show:function(){this.com.show()},hide:function(){this.com.hide()},setKey:function(t){t.keyIndex&&t.keyScope?(this.params.keyIndex=t.keyIndex,this.params.keyScope=t.keyScope,PJF.ui.componentMgr.reg(this)):alert("请同时传入keyScope和keyIndex!")},destroy:function(){this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null},generateId:function(){
for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0,o=0;o<36;o++)8==o||13==o||18==o||23==o?i[o]="-":14==o?i[o]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[o]=e[19==o?3&t|8:t]);return i.join("").replace(/-/g,"")},focus:function(){this.com.focus()},getClassName:function(){return"PJF.ui.component"},focusable:function(){return!1},display:function(t){t?this.com.show():this.com.hide()},setAreaKeyBoardFlag:function(t){this.areaKeyBoardFlag=this.areaKeyBoardFlag||{isDisplay:!0,isDisable:!1,isReadonly:!1},PJF.apply(this.areaKeyBoardFlag,t)},isAreaKeyBoardValid:function(){return this.areaKeyBoardFlag=this.areaKeyBoardFlag||{isDisplay:!0,isDisable:!1,isReadonly:!1},this.areaKeyBoardFlag.isDisplay&&!this.areaKeyBoardFlag.isDisable&&!this.areaKeyBoardFlag.isReadonly}}),PJF.apply(PJF.ui.component.prototype,{hideCheckTip:function(){this.com.checkTip({show:function(){return!0}}),this.com.addClass("validatebox-invalid")},
addHighlight:function(){this.com.is("input:visible")&&this.com.addClass("validatebox-tipcolor error-border")}}),PJF.ui.componentMgr=function(){var s=new PJF.util.Collection,o=null,r=new PJF.util.Collection,c=new PJF.util.Collection,l=[],d=[],a=null,u=function(t,e){for(var i=t.length,n=0;n<i;++n)if(e<=t[n])return n;return i};return{get:function(t){return s.item(t)},reg:function(t){if(s.containsKey(t.getId())&&console.log(resource.REG_EXIST_ID_INFO+t.getId()+resource.REG_EXIST_ID_INFO1),s.add(t.getId(),t),t.params.keyScope&&t.params.keyIndex){var e=t.params.keyScope,i=t.params.keyIndex;if(console.log("当前com的keyScope为:"+e+",keyIndex为:"+i+",类型为:"+t.getClassName()),r.containsKey(e)){var n=c.item(e),o=r.item(e),a=u(n,i);console.log("key将要插入的数组位置为:"+a),n.splice(a,0,i),o.splice(a,0,t),n[a]==n[a+1]&&(n.splice(a+1,1),o.splice(a+1,1)),console.log("key当前的数组顺序为:"+n)}else r.add(e,[]),r.item(e).push(t),c.add(e,[]),c.item(e).push(i)}if(t.params.groupIndex){a=u(l,t.params.groupIndex)
;console.log("group将要插入的数组位置为:"+a),l.splice(a,0,t.params.groupIndex),d.splice(a,0,t)}},remove:function(t){var e=s.item(t);if(e&&e.params&&e.params.keyScope&&e.params.keyIndex&&c.containsKey(e.params.keyScope)){var i=c.item(e.params.keyScope),n=u(i,e.params.keyIndex);c.item(e.params.keyScope).splice(n,1),r.item(e.params.keyScope).splice(n,1)}e.params.groupIndex&&groupComs.containsKey(e.params.groupIndex)&&groupComs.removeKey(e.params.groupIndex),s.removeKey(t)},clear:function(){s.clear(),r.clear()},getFirstComp:function(t){if(t&&r.containsKey(t)){var e=r.item(t)[0];return e.isReadOnly()||e.isDisabled()||!e.isDisplay()?this.getNextComp(e):e}return null},getNextComp:function(t){var e=t.params.keyScope,i=t.params.keyIndex;if(e&&i&&r.containsKey(e)&&(console.log("当前keyScope为:"+e),0<r.item(e).length)){var n=PJF.util.array.indexOf(c.item(e),i);if(console.log("当前组件在容器内的位置为:"+n),-1<n&&n+1<r.item(e).length)return o=r.item(e)[n+1],
console.log("下一个组件的index:"+o.params.keyIndex+",类型为:"+o.getClassName()+",domid为:"+o.params.dom),!o.isReadOnly()&&!o.isDisabled()&&o.isDisplay()&&o.isAreaKeyBoardValid()?(a=null,o):(a=a||t,PJF.ui.componentMgr.getNextComp(o))}return t=a||t,a=null,t},getPreviousComp:function(t){var e=t.params.keyScope,i=t.params.keyIndex;if(e&&i&&r.containsKey(e)&&0<r.item(e).length){var n=PJF.util.array.indexOf(c.item(e),i);if(-1<n-1)return o=r.item(e)[n-1],console.log("上一个组件的index:"+o.params.keyIndex+",类型为:"+o.getClassName()+",domid为:"+o.params.dom),!o.isReadOnly()&&!o.isDisabled()&&o.isDisplay()&&o.isAreaKeyBoardValid()?(a=null,o):(a=a||t,PJF.ui.componentMgr.getPreviousComp(o))}return t=a||t,a=null,t},getCurrentCom:function(){return o},getNextGroupCom:function(t){var e=PJF.util.array.indexOf(l,t);if(e+1<l.length){var i=d[e+1];return console.log("下一个group的index:"+e+",类型为:"+i.getClassName()),i.isReadOnly()||i.isDisabled()||!i.isDisplay()?PJF.ui.componentMgr.getNextGroupCom(i):i}return null},
getPreviousGroupCom:function(t){var e=PJF.util.array.indexOf(l,t);if(0<e){var i=d[e-1];return console.log("上一个group的index:"+e+",类型为:"+i.getClassName()),i.isReadOnly()||i.isDisabled()||!i.isDisplay()?PJF.ui.componentMgr.getPreviousGroupCom(i):i}return null},removeKeyScope:function(t){r.containsKey(t)&&c.containsKey(t)?(r.removeKey(t),c.removeKey(t)):console.log("没有如下全键盘scope:"+t)}}}(),PJF.ui.autoComplete=PJF.extend(PJF.ui.component,{init:function(t){var e=null;return t&&(t.autocompleteid=this.id,e=this.com.autocomplete(t)),e},destroy:function(){this.com.autocomplete("destroy",this.com),PJF.ui.componentMgr.remove(this.id)},newDestroy:function(){this.com.autocomplete("newDestroy",this.com),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.id=null},getSelectValue:function(){return this.com.autocomplete("getSelectValue")},getValue:function(){return this.com.autocomplete("getSelectValue")},setDefaultValue:function(t,e){this.setValue(t,e)},
setHelpTip:function(t,e){return this.com.autocomplete("setHelpTip",t,e)},setValue:function(t,e){this.com.autocomplete("setDefaultValue",t,e)},addOptions:function(t){this.com.autocomplete("addOptions",t)},removeOptions:function(t){this.com.autocomplete("removeOptions",t)},removeAll:function(){this.com.autocomplete("removeAll")},setObject:function(t){this.com.autocomplete("setObject",t)},disable:function(){this.com.autocomplete("disable")},enable:function(){this.com.autocomplete("enable")},setReadOnly:function(t){this.com.autocomplete("setReadOnly",t)},getSelectText:function(){return this.com.autocomplete("getSelectText")},getText:function(){return this.com.autocomplete("getSelectText")},setRequired:function(t){return this.com.autocomplete("setRequired",t)},hide:function(){return this.com.autocomplete("hideDiv")},getClassName:function(){return"PJF.ui.autoComplete"},setParam:function(t){return this.com.autocomplete("setParam",t)},clearValue:function(){this.com.autocomplete("clearValue")},
clear:function(){this.com.autocomplete("clearValue")},onBlur:function(){this.com.autocomplete("onBlur")},onFocus:function(){this.com.autocomplete("onFocus")},focus:function(){this.com.autocomplete("focus")},isReadOnly:function(){return this.com.autocomplete("isReadOnly")},isDisplay:function(){return this.com.autocomplete("isDisplay")},isDisabled:function(){return this.com.autocomplete("isDisabled")}}),PJF.ui.imgViewer=PJF.extend(PJF.ui.component,{init:function(l){var t,e,d=this,i=l.data.length,n=this.com,o=l.bigWidth,a=l.bigHeight,u=l.glass,s=l.smallHeight,r=l.smallWidth,c=l.countLine,h="";u||(u=!1);for(var p=0;p<i;p++)e=l.data[p].numPage?l.data[p].numPage<10?"0"+l.data[p].numPage:l.data[p].numPage:"",t=!!l.data[p].disabled,
l.hideNum?h+='<div href="#" num='+e+'><img id="img'+p+'" style="width:'+r+"px;height:"+s+'px;" src="'+PJF.util.addAtchBtchNoToUrl(l.data[p].url)+'" chose='+l.data[p].chose+" disable="+t+' classifyname="null"/><a class="imgviewer_rotate"></a></div>':h+='<div href="#" num='+e+">"+e+'<img id="img'+p+'" style="width:'+r+"px;height:"+s+'px;" src="'+PJF.util.addAtchBtchNoToUrl(l.data[p].url)+'" chose='+l.data[p].chose+" disable="+t+' classifyname="null"/><a class="imgviewer_rotate"></a></div>';var f='<div class="pjf_small_img">'+h+'</div><div class="pjf_big_img"></div>';this.com.addClass("pjf_banner_img").append(f);r=$(".pjf_banner_img img").width();this.com.css("width",(r+28)*c),this.com.find(".pjf_big_img").css("width",o).css("height",a),this.com.find(".pjf_small_img div").find("img[chose=true]").each(function(){$(this).parent().append('<span class="pjf_icon"></span>')}),d.disable();var m=0;$(window).on("scroll",function(){m=$(this).scrollTop()});var g,v,_,b=!1,y=!0
;this.com.find(".pjf_small_img div").each(function(r){var c=$(this);$(this).bind("mouseover",function(){var t=c.children().attr("src");u=l.glass,y=!0;var e=$(this);g=!1;var i,n,o=$(this).offset().left,a=$(this).offset().top,s=$(this).data("rotate");u?(d.show(e,t,m,s),$(this).bind("mousemove",function(t){if(g=!0){i=t.clientX-o,n=t.clientY+m-a;t.clientY;d.glass(i,n,m),l.move&&d.movedY(e,m,r)}})):v=setTimeout(function(){d.show(e,t,m,s),g=!0},300),l.rotate&&$(this).find(".imgviewer_rotate").show()}).bind("mouseout",function(){y=!1,g||(clearTimeout(v),g=!1),g=!1,n.find(".pjf_big_img").bind("mouseover",function(){g=b=!0}).bind("mouseout",function(){d.hide($(this)),g=!(b=!1)}),setTimeout(function(){b||y||g||(n.find(".pjf_big_img").hide(),n.find(".pjf_big_img").find("img").remove(),n.find(".pjf_small_img div").css("borderColor","#F0f5f9"))},400),l.rotate&&$(this).find(".imgviewer_rotate").hide()})}),this.com.find(".pjf_small_img div").each(function(t){$(this).data("data",l.data[t])}),
this.com.find(".pjf_small_img div").each(function(){$(this).toggle(function(){_=$(this).find("img").attr("chose"),"true"!=(t=$(this).find("img").attr("disable"))&&("true"==_?($(this).find(".pjf_icon").remove(),$(this).find("img").attr("chose",!1)):($(this).append('<span class="pjf_icon"></span>'),$(this).find("img").attr("chose",!0)))},function(){_=$(this).find("img").attr("chose"),"true"!=(t=$(this).find("img").attr("disable"))&&("false"==_?($(this).append('<span class="pjf_icon"></span>'),$(this).find("img").attr("chose",!0)):($(this).find(".pjf_icon").remove(),$(this).find("img").attr("chose",!1)))})}),$(this.com).find(".imgviewer_rotate").each(function(){var e=$(this),i=0;e.parent().data("rotate",i),e.bind("click",function(){e.parent().data("rotate")<3?i++:i=0,e.parent().data("rotate",i);var t=90*e.parent().data("rotate");return e.siblings("img").css({"-webkit-transform":"rotate("+t+"deg)",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation="+i+")"}),!1})})},
getValue:function(){var t=new Array;return this.com.find("img[chose=true]").each(function(){"true"!=$(this).parent().find("img").attr("disable")&&t.push($(this).parent().data("data").value)}),t},getNumPage:function(){var t=new Array;return this.com.find("img[chose=true]").each(function(){t.push($(this).parent().text())}),t},show:function(t,e,i,n){var o=this.com.find(".pjf_big_img"),a=this.params.bigWidth,s=this.params.bigHeight,r=90*n;o.show(),this.com.find(".pjf_small_img div").css("borderColor","#F0f5f9"),"true"==t.find("img").attr("disable")?t.css("borderColor","#666666"):t.css("borderColor","#428fd1"),o.find("img").remove(),o.append("<img src='"+e+"'>"),o.find("img").css("width",a).css("height",s),o.find("img").css({"-webkit-transform":"rotate("+r+"deg)",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation="+n+")"});var c=this.com.width(),l=this.com.height();o.css("left",c-5*this.params.countLine+"px").css("margin-top",-l+i+"px")},glass:function(t,e,i){
var n=this.params.bigWidth,o=this.params.bigHeight,a=this.params.smallHeight,s=this.params.smallWidth,r=this.params.imageHeight,c=this.params.imageWidth,l=this.com.find(".pjf_big_img");l.css("overflow","hidden").children().css("width",c).css("height",r);var d=(c-n)/s,u=(r-o)/a;l.children().css("marginLeft",-d*t).css("marginTop",-u*e)},hide:function(t){t.hide(),t.find("img").remove(),this.com.find(".pjf_small_img div").css("borderColor","#F0f5f9")},movedY:function(t,e,i){var n=this.params.countLine,o=t.offset().top,a=this.com.find(".pjf_big_img"),s=this.com.height();a.css("marginTop",-s+o-10+"px"),this.params.data.length-n<i+1&&a.css("marginTop",-s+o-20-this.params.smallHeight+"px")},destroy:function(){this.com.empty()},newDestroy:function(){PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),$(window).off("scroll"),this.com=null,this.id=null},validateParam:function(t){var e=!0;return"number"!=typeof t.countLine&&(alert(resource.IMGVIEWER_CHECK_ERROR2),e=!1),
t.smallHeight&&t.smallWidth&&0!=t.smallWidth&&0!=t.smallHeight&&"number"==typeof t.smallWidth&&"number"==typeof t.smallHeight||(e=!1),t.dom||(alert(resource.IMGVIEWER_CHECK_ERROR1),e=!1),e},classIfy:function(){this.com.find("input[name='classname']").val();var t=new Array,e=this;return this.com.find("img[chose=true]").each(function(){$(this).parent().find("img").attr("classifyname","false"),t.push($(this).parent().data("data").value),$(this).attr("disable","true"),e.disable()}),t},disable:function(){this.com.find("img[disable=true]").each(function(t){$(this).parent().append('<span class="pjf_icon"></span>'),$(this).parent().find("span").addClass("pjf_icon_gray"),$(this).parent().find(".pjf_small_img div").addClass("pjf_small_img_gray")})},getDisable:function(){var e=new Array;return this.com.find("img[disable=true]").each(function(t){e.push($(this).parent().data("data").value)}),e},enable:function(){this.com.find("img[disable=true]").each(function(){$(this).attr("disable","false"),
$(this).attr("chose","false"),$(this).parent().find("span").remove()})},setAttr:function(t,e,i){var n=this.com.find('div[num="'+t+'"]');return n.data(e,i),n.find("img").attr("src",n.data("url")),this.com.find('div[num="'+t+'"]')}}),PJF.ui.dateinput=PJF.extend(PJF.ui.component,{init:function(conf){conf.focusSelectAll=PJF.constants.focusSelectAll||conf.focusSelectAll,this.copyComObj=this.com.clone(!1,!1).empty().insertAfter(this.com),this.copyComObj.attr("id",""),this.inputName=this.copyComObj.attr("name"),this.copyComObj.removeAttr("name"),this.copyComObj.css("display","none");var me=this;me.msg=null,me.minDate="",me.maxDate="",me.maxDate="",me.showflag=!0,me.disableflag=!1,me.readonlyflag=!1,me.notEql=conf.notEql,me.disableAttr=conf.disable,me.validMsg=conf.validMsg||conf.invalidMessage,me.nexDateDom=null,me.preDateDom=conf.preDateDom,me.validComMsg=conf.validComMsg,me.validAfterCurrentDateMsg=conf.validAfterCurrentDateMsg,me.validBeforeCurrentDateMsg=conf.validBeforeCurrentDateMsg,
me.isValidateWithStartDate=conf.isValidateWithStartDate,me.isValidateWithEndDate=conf.isValidateWithEndDate,me.required=conf.required,me.comboObj=null,me.oldDate="",me.timerFocus=null,me.validMiMaMsg=conf.validMiMaMsg,me.validType=conf.validType,me.ruleValidateMsg=conf.ruleValidateMsg,me.missingMessage=conf.missingMessage,me.validCurrentDateMsg=conf.validCurrentDateMsg,me.onlyMonth=conf.onlyMonth,me.showTime=conf.showTime,me.showSeconds=conf.showSeconds,me.dateSpan=conf.dateSpan;var isInputByHand=!1;me.seasonSwitch=conf.seasonSwitch,me.onlyMonth=conf.onlyMonth,!PJF.orgInfo||"DB010"!=PJF.orgInfo.instSvrlLgPsnID&&"DC006"!=PJF.orgInfo.instSvrlLgPsnID&&"DE001"!=PJF.orgInfo.instSvrlLgPsnID?PJF.orgInfo&&"DC013"==PJF.orgInfo.instSvrlLgPsnID?(me.format="MMddyyyy",me.switchFormat="yyyyMMdd"):(me.format="yyyyMMdd",me.switchFormat=me.format):(me.format="ddMMyyyy",me.switchFormat="yyyyMMdd"),me.showTime&&(0!=me.showSeconds?me.format="yyyyMMdd hh:mm:ss":me.format="yyyyMMdd hh:mm",
me.switchFormat=me.format),(me.seasonSwitch||me.onlyMonth)&&(me.format="yyyyMM",me.switchFormat=me.format),me.switchFormat=conf.switchFormat||me.switchFormat,me.format=conf.format||me.format,me.whiteList=conf.whiteList,me.defaultDate=conf.defaultDate||PJF.communication.getServerTime(),me.disabledMinDate=conf.disabledMinDate,me.disabledMaxDate=conf.disabledMaxDate,me.hideWeeks=conf.hideWeeks,1==me.seasonSwitch&&(me.onlyMonth=!0,me.noInput=!0),me.helpTip=conf.helpTip,me.helpMessage=conf.helpMessage,me.argDate=/^(\d{4})(0[1-9]|1[0-2])(0[1-9]|[1-2]\d{1}|3[0-1])$/,me.argMonth=/^(\d{4})(0[1-9]|1[0-2])$/,me.argDateTime=/^(\d{4})(0[1-9]|1[0-2])(0[1-9]|[1-2]\d{1}|3[0-1])\s(0\d{1}|1\d{1}|2[0-3]):[0-5]\d{1}:([0-5]\d{1})$/,me.argDateTimeNoSecond=/^(\d{4})(0[1-9]|1[0-2])(0[1-9]|[1-2]\d{1}|3[0-1])\s(0\d{1}|1\d{1}|2[0-3]):[0-5]\d{1}$/,me.argSeason=/^(\d{4})(0[1-4])$/,conf.minDate?me.minDate=conf.minDate:me.minDate=PJF.constants.minDate||"19000101",
conf.maxDate?me.maxDate=conf.maxDate:me.maxDate=PJF.constants.maxDate||"29991231";var comObj=this.com;this.com.combo({required:!0,dateFlag:!0}),this.com.removeClass("combo-f"),me.showTime?this.com.addClass("combo-f datetimebox-f"):this.com.addClass("datebox-f combo-f"),this.com.next().addClass("datebox");var comObj=this.com,jq=this.com.next();this.jq=jq;var inputJq=jq.children("input:first");if(me.inputJq=inputJq,this.com.val()&&(this.com.next().children("input:last").val(this.com.val()),this.com.next().children("input:first").val(this.com.val())),me.comboArrowClickNum=0,this.com.next().find(".combo-arrow").bind("mouseover",function(){initDatebox()}),conf.width){var cw=conf.width,iw=cw-20;jq.css("width",cw),inputJq.css("width",iw)}function initDatebox(){var t=comObj.next().width(),e=comObj.next().children("input:first").width(),i=inputJq.val();if(me.value=me.transferDate(i),me.hidNewVal=me.value.replace(":","").replace(":","").replace(" ",""),me.comboArrowClickNum++,
conf.showTime&&!me.calendarPanel?(comObj.datetimebox({showSeconds:conf.showSeconds,dateFlag:!0,dropMonthNYear:conf.dropMonthNYear,defaultDate:me.defaultDate,onSelect:function(t){var e,i,n,o,a,s=$(this).datetimebox("spinner").timespinner("getValue"),r=$(this).datetimebox("spinner").timespinner("options").separator,c="";e=t.substr(0,4),i=t.substr(4,2),n=t.substr(6,2)||1,o=s.split(r)[0],a=s.split(r)[1],0!=conf.showSeconds&&(c=s.split(r)[2]),c=c||0;var l=new Date(e,i-1,n,o,a,c),d=l.getFullYear()==e&&l.getMonth==i-1&&l.getDate()==n&&l.getHours()==o&&l.getMinutes()==a&&l.getSeconds==c,u=PJF.util.formatDate(l,me.format),h=t+" "+s;comObj.next().children("input:first").val(d?u:h),comObj.next().children("input:last").val(""+e+i+n+o+a+c),0!=validateCtrl(h)&&(me.oldDate!=h&&conf.change instanceof Function&&conf.change(me.oldDate,h),conf.afterOperation instanceof Function&&conf.afterOperation(me.oldDate,h)),$(this).combo("hidePanel"),me.clickCalendarFlag=!1}}),
me.calendarPanel=comObj.datebox("calendar")):conf.showTime||me.calendarPanel||(comObj.datebox({panelWidth:conf.dateWidth,dropMonthNYear:conf.dropMonthNYear,muti:conf.muti||!1,disabled:me.disableAttr,onlyMonth:me.onlyMonth,seasonSwitch:me.seasonSwitch,dateFlag:!0,defaultDate:me.defaultDate,disabledMinDate:me.disabledMinDate,disabledMaxDate:me.disabledMaxDate,hideWeeks:me.hideWeeks,formatter:function(t){var e,i="";if("string"==typeof t)e=t.substr(0,4),n=t.substr(4,2),i=t.substr(6,2);else{if(e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),n<10)var n="0"+(t.getMonth()+1);else n=t.getMonth()+1;if(1==$.trim(i).length)i="0"+t.getDate();else i=t.getDate()}return e+""+n+i},onSelect:function(t){console.log("onselect",me.getValue());var e=validateCtrl(t);if(me.clickCalendarFlag=!1,me.seasonSwitch){var i=t.substr(5,1);me.hidNewVal=t.substr(0,4)+"年"+resource.CALENDAR_DEFAULTS_SEASONS[i-1],comObj.next().children("input:first").val(me.hidNewVal),comObj.next().children("input:last").val(me.hidNewVal)
}else{conf.muti&&me.hidNewVal?me.hidNewVal+=","+t:me.hidNewVal=t;var n,o,a,s;o=t.substr(0,4),a=t.substr(4,2)-1,s=t.substr(6,2),n=PJF.util.formatDate(new Date(o,a,s||1),me.format),comObj.next().children("input:first").val(n),comObj.next().children("input:last").val(me.hidNewVal)}0!=e&&(me.oldDate!=t&&conf.change instanceof Function&&conf.change(me.oldDate,t),conf.afterOperation instanceof Function&&conf.afterOperation(me.oldDate,t))}}),me.calendarPanel=comObj.datebox("calendar")),me.clickCalendarFlag=!1,me.calendarPanel.bind("mousedown",function(){me.clickCalendarFlag=!0}),conf.onlyMonth){me.calendarPanel.find(".calendar-prevyear").remove(),me.calendarPanel.find(".calendar-prevmonth").remove(),me.calendarPanel.find(".calendar-nextyear").remove(),me.calendarPanel.find(".calendar-prevyear").remove();var n=me.calendarPanel.find(".calendar-menu");n.removeAttr("style"),me.calendarPanel.find("div.calendar-body").find(">table").remove(),
n.find(".calendar-menu-month-inner").css("height",n.height()-30),n.show()}comObj.next().width(t),comObj.next().children("input:first").width(e),me.comboArrowClickNum<2&&""!=me.value&&(comObj.next().children("input:first").val(i),comObj.next().children("input:last").val(me.hidNewVal)),"readonly"!=me.readOnly&&1!=me.readOnly||comObj.next("span").children("input:first").attr("readonly",!0),comObj.next("span").children("input:first").hasClass("pjf_readonly_input")&&me.setReadOnly(!0),comObj.next("span").children("input:first").hasClass("pjf_disabled_input")&&me.disable(!0)}function validateCtrl(date){if(me.time&&clearInterval(me.time),me.nexDateDom){var preDom=eval(me.nexDateDom);preDom.time&&clearInterval(preDom.time)}if(me.preDateDom){var nexDom=eval(me.preDateDom);nexDom.time&&clearInterval(nexDom.time)}var validateRequiredFlag=!1;if(me.clickCalendarFlag||(validateRequiredFlag=me.validateRequired()),me.required&&date){if(!me.validate())return inputJq.checkTip({show:function(){return!1},
Message:me.msg}),!1}else if(!me.required&&date){if(!me.validate())return inputJq.checkTip({show:function(){return!1},Message:me.msg}),!1}else me.required||""!=date||inputJq.checkTip({show:function(){return!0}});if(date){var maxMinValidateFlag=me.validateMaxMin(date),validateCurrentDate=!0;if((me.isValidateWithStartDate||me.isValidateWithEndDate)&&(validateCurrentDate=me.validCurrentDate(date)),1==maxMinValidateFlag&&1==validateCurrentDate){(!conf.validType&&!conf.preDateDom||conf.preDateDom&&!conf.preDateDom.inputJq.val())&&inputJq.checkTip({show:function(){return!0}});var flag=!0;if("disabled"==inputJq.attr("disabled"))return!0;if(null!=conf.validType&&(flag=me.ruleValidate()),!flag)return flag;me.compareDate()}}}me.validMsg?this.msg=me.validMsg:conf.onlyMonth&&!me.validMsg?this.msg=PJF.constants.DATEINPUT_VALIDATE_MONTH_DEFAULT_INFO:conf.showTime&&!me.validMsg?this.msg=PJF.constants.DATEINPUT_VALIDATE_DATETIME_DEFAULT_INFO:this.msg=PJF.constants.DATEINPUT_VALIDATE_INFO,
me.required&&this.com.next().children("input:first").addClass("validatebox-invalid invalid_box"),1!=conf.muti&&(conf.noInput||me.noInput)&&this.com.next("span").children("input:first").attr("readonly",!0),me.readOnly=this.com.next("span").children("input:first").attr("readonly"),(me.disableAttr||conf.disabled)&&me.disable(!0),PJF.constants.KEYBOARD_ENABLE?inputJq.unbind(".dateinput").bind("focus.dateinput",function(){me.clickCalendarFlag=!1;var t=inputJq.val();0!=me.validate()&&(me.oldDate=me.transferDate(t)),me.timerFocus||(me.timerFocus=setInterval(function(){validateCtrl(me.transferDate(inputJq.val()))},100)),conf.focusSelectAll&&(me.inputJq[0].selectionStart=0,me.inputJq[0].selectionEnd=99999)}).bind("mouseover.dateinput",function(){initDatebox()}).bind("keydown.dateinput",function(t){if(13==t.which&&inputJq.attr("error"))return!1}).bind("keyup.dateinput",function(){comObj.next().children("input:last").val(me.transferDate(inputJq.val())),isInputByHand=!0
}).bind("blur.dateinput",function(){me.timerFocus&&(clearInterval(me.timerFocus),me.timerFocus=null);var t=me.transferDate(inputJq.val(),!0);me.value=!1===t?inputJq.val():t,0!=(!1!==t&&validateCtrl(me.value))&&(me.oldDate!=me.value&&conf.change instanceof Function&&conf.change(me.oldDate,me.value),1==isInputByHand&&(conf.afterOperation instanceof Function&&conf.afterOperation(me.oldDate,me.value),isInputByHand=!1)),me.hidNewVal=me.value.replace(":","").replace(":","").replace(" ",""),inputJq.parent().find("input").eq(1).val(me.hidNewVal)}):inputJq.unbind(".dateinput").bind("focus.dateinput",function(){me.clickCalendarFlag=!1;var t=inputJq.val();0!=me.validate()&&(me.oldDate=me.transferDate(t))}).bind("mouseover.dateinput",function(){initDatebox()}).bind("keyup.dateinput",function(){me.timerFocus||(me.timerFocus=setInterval(function(){validateCtrl(me.transferDate(inputJq.val()))},600),isInputByHand=!0),comObj.next().children("input:last").val(me.transferDate(inputJq.val()))
}).bind("blur.dateinput",function(){if(me.timerFocus&&(clearInterval(me.timerFocus),me.timerFocus=null),me.value=inputJq.val(),me.value!=undefined&&""!=me.value)if(me.seasonSwitch)me.value=me.seasonDealing(me.value);else{var t=me.transferDate(me.value,!0);me.value=!1===t?me.value:t}0!=(!1===t?t:validateCtrl(me.value))&&(me.oldDate!=me.value&&conf.change instanceof Function&&conf.change(me.oldDate,me.value),1==isInputByHand&&(conf.afterOperation instanceof Function&&conf.afterOperation(me.oldDate,me.value),isInputByHand=!1)),me.hidNewVal=me.value.replace(":","").replace(":","").replace(" ",""),inputJq.parent().find("input").eq(1).val(me.hidNewVal)}),conf.blurEvent&&inputJq.bind("blur",conf.blurEvent),this.minDate>this.maxDate?alert(resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO+conf.dom+resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO1):(me.com.next("span").find(".combo-text").bind("keydown",function(t){PJF.constants.KEYBOARD_ENABLE?13==t.which||40==t.which?(PJF.ui.componentMgr.getNextComp(me),
PJF.ui.componentMgr.getNextComp(me).focus()):38==t.which&&(PJF.ui.componentMgr.getPreviousComp(me).focus(),t.stopImmediatePropagation(),t.preventDefault()):PJF.constants.KEYBOARD_NEW_ENABLE&&9==t.which&&(PJF.ui.componentMgr.getNextComp(me),PJF.ui.componentMgr.getNextComp(me).focus(),t.stopImmediatePropagation(),t.preventDefault())}),!0===me.helpTip&&(me.com.next("span").append('<span id="'+this.com.attr("componentid")+'"></span>'),me.tip=new PJF.ui.helpTip({dom:this.com.attr("componentid"),helpMessage:me.helpMessage})))},destroyCombo:function(){this.com.combo("destroy"),this.copyComObj.attr("id",this.params.dom),this.copyComObj.removeAttr("componentid")},validateRequired:function(){if(this.required&&""==this.inputJq.val())return this.inputJq.checkTip({show:function(){return!1},Message:this.missingMessage}),!1},validateMaxMin:function(t){var e=this.minDate,i=this.maxDate;return this.minMsg=PJF.constants.DATEINPUT_VALIDATE_MINDATE_INFO+e,
this.maxMsg=PJF.constants.DATEINPUT_VALIDATE_MAXDATE_INFO+i,this.validMiMaMsg&&"string"==typeof this.validMiMaMsg?(this.minMsg=this.validMiMaMsg,this.maxMsg=this.validMiMaMsg):this.validMiMaMsg instanceof Array&&2==this.validMiMaMsg.length&&(this.validMiMaMsg[0]&&(this.minMsg=this.validMiMaMsg[0]),this.validMiMaMsg[1]&&(this.maxMsg=this.validMiMaMsg[1])),!!this.whiteListValidate(t)||(t<e?(this.inputJq.checkTip({show:function(){return!1},Message:this.minMsg}),!1):!(i<t)||(this.inputJq.checkTip({show:function(){return!1},Message:this.maxMsg}),!1))},validateNextMaxMin:function(t,e){var i=e.minDate,n=e.maxDate,o=PJF.constants.DATEINPUT_VALIDATE_MINDATE_INFO+i,a=PJF.constants.DATEINPUT_VALIDATE_MAXDATE_INFO+n;return e.params.validMiMaMsg&&"string"==typeof e.params.validMiMaMsg?(o=e.params.validMiMaMsg,a=e.params.validMiMaMsg):e.params.validMiMaMsg instanceof Array&&2==e.params.validMiMaMsg.length&&(e.params.validMiMaMsg[0]&&(o=e.params.validMiMaMsg[0]),
e.params.validMiMaMsg[1]&&(a=e.params.validMiMaMsg[1])),t<i?(e.inputJq.checkTip({show:function(){return!1},Message:o}),!1):n<t?(e.inputJq.checkTip({show:function(){return!1},Message:a}),!1):((i<=t&&t<=n||i<=t&&!n||t<=n&&!i)&&e.inputJq.checkTip({show:function(){return!0}}),!0)},validCurrentDate:function(t){var e=this.isValidateWithStartDate,i=this.isValidateWithEndDate,n=PJF.constants.DATESAPN_VALIDATE_STARTDATE_INFO,o=PJF.constants.DATESAPN_VALIDATE_ENDDATE_INFO;if(this.validCurrentDateMsg instanceof Array&&2==this.validCurrentDateMsg.length?(this.validCurrentDateMsg[0]&&(this.validaBeforeCurrentDate=this.validCurrentDateMsg[0]),this.validCurrentDateMsg[1]&&(this.validAfterCurrentDateMsg=this.validCurrentDateMsg[1])):(this.validaBeforeCurrentDate=n,this.validAfterCurrentDateMsg=o),this.today==undefined&&(this.today=PJF.communication.getServerTime(),null==this.today&&(this.today=PJF.util.formatDate(new Date))),null!=t&&6==t.length)return!0;var a=t.substr(0,8)
;return this.nexDateDom?!e||(!(a>this.today)||(this.inputJq.checkTip({show:function(){return!1},Message:this.validaBeforeCurrentDate}),!1)):this.preDateDom?!i||(!(a<this.today)||(this.inputJq.checkTip({show:function(){return!1},Message:this.validAfterCurrentDateMsg}),!1)):void 0},compareDate:function(){var self=this,minDate=this.minDate,maxDate=this.maxDate,isValidateWithStartDate=this.isValidateWithStartDate,isValidateWithEndDate=this.isValidateWithEndDate,dateSpan=this.dateSpan;if(this.preDateDom){var preDom=eval(this.preDateDom);preDom.setNexDateDom(self);var pre=preDom.getValue();function validatePre(){if(self.inputJq.next().hasClass("errorbox_ipt_help")&&clearInterval(self.time),preDom.time&&(clearInterval(preDom.time),preDom.time=null),"disabled"==self.inputJq.attr("disabled"))return clearInterval(self.time),self.inputJq.checkTip({show:function(){return!0}}),!0;pre=preDom.getValue();var t=self.inputJq.val();if(self.format&&(t=self.transferDate(t)),
t=t.replace(":","").replace(":","").replace(" ",""),self.seasonSwitch){var e=self.seasonDealingForCompare(pre,t);pre=e[0],t=e[1]}if(pre&&t){if(t<pre||self.notEql&&pre==t){var i=PJF.constants.DATESPAN_VALIDATE_INTO_TWO;return self.validComMsg?i=self.validComMsg:self.seasonSwitch?i=PJF.constants.DATESPAN_VALIDATE_INTO_TWO_SEASON:!self.validComMsg&&self.onlyMonth&&(i=PJF.constants.DATESAPN_VALIDATE_MONTH_INFO),self.inputJq.checkTip({show:function(){return!1},Message:i}),!1}return self.inputJq.checkTip({show:function(){return!0},Message:self.msg}),!0}}validatePre(),this.time=setInterval(validatePre,100)}if(this.nexDateDom){var nexDom=eval(this.nexDateDom),next=nexDom.getValue();function validateNext(){if(nexDom.time&&(clearInterval(nexDom.time),nexDom.time=null),self.nexDateDom.inputJq.next().hasClass("errorbox_ipt_help")&&clearInterval(self.time),"disabled"==self.inputJq.attr("disabled"))return clearInterval(self.time),self.inputJq.checkTip({show:function(){return!0}}),!0
;next=nexDom.getValue();var t=self.inputJq.val();if(self.format&&(t=self.transferDate(t)),t=t.replace(":","").replace(":","").replace(" ",""),self.seasonSwitch){var e=self.seasonDealingForCompare(t,next);t=e[0],next=e[1]}if(t&&next){if(!self.validateNextSapn())return clearInterval(self.time),self.nexDateDom.inputJq.checkTip({show:function(){return!1},Message:self.msg}),!1;if(next<t||self.notEql&&t==next){self.validateMaxMin(t);var i=PJF.constants.DATESPAN_VALIDATE_INTO_TWO;return self.validComMsg?i=self.validComMsg:self.nexDateDom.validComMsg?i=self.nexDateDom.validComMsg:self.seasonSwitch?i=PJF.constants.DATESPAN_VALIDATE_INTO_TWO_SEASON:!self.validComMsg&&self.onlyMonth&&(i=PJF.constants.DATESAPN_VALIDATE_MONTH_INFO),self.nexDateDom.inputJq.checkTip({show:function(){return!1},Message:i}),!1}if(self.validateNextMaxMin(next,nexDom)){this.today==undefined&&(this.today=PJF.communication.getServerTime(),null==this.today&&(this.today=PJF.util.formatDate(new Date)))
;var n=PJF.constants.DATESAPN_VALIDATE_ENDDATE_INFO;return dateSpan&&6<next.length&&(self.isValidateWithStartDate&&self.isValidateWithEndDate||self.isValidateWithStartDate===undefined&&self.isValidateWithEndDate)&&next<this.today?(nexDom.inputJq.checkTip({show:function(){return!1},Message:n}),!1):!(dateSpan&&!self.nexDateDom.ruleValidate())&&((t<next||!self.notEql||t!=next)&&nexDom.inputJq.checkTip({show:function(){return!0}}),!0)}clearInterval(self.time)}}validateNext(),this.time=setInterval(validateNext,100)}},seasonDealing:function(t){for(var e=resource.CALENDAR_DEFAULTS_SEASONS.length,i=1;i<=e;i++)if(t.substr(5)==resource.CALENDAR_DEFAULTS_SEASONS[i-1])return t=t.substr(0,4)+"0"+i},seasonDealingForCompare:function(t,e){for(var i=[],n=resource.CALENDAR_DEFAULTS_SEASONS.length,o=1;o<=n;o++)t!=undefined&&t.substr(5)==resource.CALENDAR_DEFAULTS_SEASONS[o-1]&&(t=t.substr(0,4)+"0"+o,i[0]=t),e!=undefined&&e.substr(5)==resource.CALENDAR_DEFAULTS_SEASONS[o-1]&&(e=e.substr(0,4)+"0"+o,i[1]=e)
;return i},validateDay:function(t){var e,i;e=t.substr(0,4),i=t.substr(4,2);var n=new Date(e,i,0);return!(e+i+(n.getDate()<=9?"0"+n.getDate():n.getDate())<t)},isValidDate:function(t){var e=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]);return t[0]==e.getFullYear()&&t[1]-1==e.getMonth()&&t[2]==e.getDate()&&t[3]==e.getHours()&&t[4]==e.getMinutes()&&t[5]==e.getSeconds()},transferSingleDate:function(t,e,i){if(t){for(var n=t,o=i?this.switchFormat:this.format,a=o,s=-1,r=["yyyy","MM","dd","hh","mm","ss"],c=["1900","0","1","0","0","0"],l=0;l<r.length;l++){var d;if("yyyy"==r[l])d=0<=(s=o.indexOf(r[l]))?n.substr(s,4):c[l],c[l]=parseInt(d,10),a=a.replace(r[l],"(\\d{4})");else d=0<=(s=o.indexOf(r[l]))?n.substr(s,2):c[l],c[l]=parseInt(d,10),a=a.replace(r[l],"(\\d{2})")}var u=new Date(c[0],parseInt(c[1],10)-1,c[2],c[3],c[4],c[5]);if(a=a.replace("ss","(\\d{2})"),new RegExp("^"+a+"$").test(n)&&this.isValidDate(c))return PJF.util.formatDate(u,i?this.format:this.switchFormat);if(e)return!1}return t},
transferDate:function(t,e,i){var n="";if(""!=t&&null!=t){var o=t.split(",");for(var a in o){var s=this.transferSingleDate(o[a],e,i);if(!1===s)return this.inputJq.checkTip({show:function(){return!1},Message:this.msg}),s;n?n+=","+s:n=s}}return n},validate:function(){var t,e=!0;if(""!=(t=0<this.jq.find("input").length?this.jq.find("input").eq(0).val().split(","):this.inputJq.val())[0]){for(var i in t){var n=t[i],o=this.transferDate(n);if(!o){e=!1;break}if(n=o,!this.whiteListValidate(n)){if(this.onlyMonth){if(6<n.length&&(n=this.seasonDealing(n)),this.seasonSwitch){if(!this.argSeason.test(n)){e=!1;break}}else if(!this.argMonth.test(n)){e=!1;break}}else if(this.showTime){if(this.showSeconds!=undefined&&!1===this.showSeconds){if(!this.argDateTimeNoSecond.test(n)){e=!1;break}}else if(!this.argDateTime.test(n)){e=!1;break}}else if(!this.argDate.test(n)){e=!1;break}if(!this.seasonSwitch&&n&&8<=n.length){var a=n.substr(0,8);if(!this.validateDay(a)){e=!1;break}}}}return e}return e},
whiteListValidate:function(t){var e=!1;return this.whiteList&&-1!=this.whiteList.indexOf(t)&&(e=!0),e},ruleValidate:function(){var self=this,comObj=this.com,values;values=0<self.jq.find("input").length?self.jq.find("input").eq(0).val().split(","):this.inputJq.val();var validateFlag=!0;if(self.validType instanceof Array&&self.ruleValidateMsg instanceof Array){var errNum=0;if(""!=values[0]&&self.validType){for(var i in values){var value=values[i],transferValue=self.transferDate(value);for(var j in transferValue&&(value=transferValue),self.validType){var vT=/([a-zA-Z_0-9]+)(.*)/.exec(self.validType[j]),rule=PJF.validator.rules()[vT[1]],param=eval(vT[2]);if(!rule(value,param||comObj,self.validType[j])){validateFlag=!1,errNum=j;break}}if(!validateFlag)break}return $.trim(self.inputJq.parent().find(".errorbox_tip-content").text().replace("×",""))&&$.trim(self.inputJq.parent().find(".errorbox_tip-content").text().replace("×",""))==self.ruleValidateMsg?validateFlag&&self.inputJq.checkTip({
show:function(){return!0}}):self.inputJq.checkTip({show:function(){return validateFlag},Message:self.ruleValidateMsg[errNum],close:!1}),self.required&&""==self.inputJq.val()?(self.inputJq.checkTip({show:function(){return!1},Message:self.missingMessage,close:!1}),!1):validateFlag}}else{if("null"!=self.validType&&"string"==typeof self.validType){if(""!=values[0]&&self.validType){var vT=/([a-zA-Z_0-9]+)(.*)/.exec(self.validType),rule=PJF.validator.rules()[vT[1]];for(var i in values){var value=values[i],transferValue=self.transferDate(value);transferValue&&(value=transferValue);var param=eval(vT[2]);if(!rule(value,param||comObj,self.validType)){validateFlag=!1;break}}}return $.trim(self.inputJq.parent().find(".errorbox_tip-content").text().replace("×",""))&&$.trim(self.inputJq.parent().find(".errorbox_tip-content").text().replace("×",""))==self.ruleValidateMsg?validateFlag&&self.inputJq.checkTip({show:function(){return!0}}):self.inputJq.checkTip({show:function(){return validateFlag},
Message:self.ruleValidateMsg,close:!1}),self.required&&""==self.inputJq.val()?(self.inputJq.checkTip({show:function(){return!1},Message:self.missingMessage,close:!1}),!1):validateFlag}if(!self.validType||"null"==self.validType)return validateFlag}},validateNextSapn:function(){var t=this.nexDateDom.params,e=this.nexDateDom.inputJq.val().split(","),i=(resource.CALENDAR_DEFAULTS_SEASONS.length,[]);if(this.seasonSwitch){for(var n=0;n<e.length;n++){var o=e[n];o=this.seasonDealing(o),i[n]=o}for(var a=0;a<i.length;a++)e[a]=i[a]}var s=!0;if(""!=e[0]){for(var a in e){o=e[a];var r=this.nexDateDom.transferDate(o);if(!r){s=!1;break}if(o=r,t.onlyMonth){if(!this.argMonth.test(o)){s=!1;break}}else if(t.showTime){if(t.showSeconds!=undefined&&!1===t.showSeconds){if(!this.argDateTimeNoSecond.test(o)){s=!1;break}}else if(!this.argDateTime.test(o)){s=!1;break}}else if(this.seasonSwitch){if(!this.argSeason.test(o)){s=!1;break}}else if(!this.argDate.test(o)){s=!1;break}if(o&&8<=o.length){var c=o.substr(0,8)
;if(!this.validateDay(c)){s=!1;break}}}return s}},getValue:function(){return this.com.next().children("input:last").val()},setValue:function(t,e){if(t!=undefined){this.com.val(t);var i=this.com.next().children("input:first").val();if(this.seasonSwitch)this.oldDate=i,this.com.next().children("input:last").val(t),this.com.next().children("input:first").val(t);else if(this.oldDate=this.transferDate(i),""==t)this.com.next().children("input:last").val(""),this.com.next().children("input:first").val("");else if(this.params.showTime)if(-1!=t.indexOf(":"))this.com.next().children("input:first").val(this.transferDate(t,!1,!0)),this.com.next().children("input:last").val(t.replace(":","").replace(":","").replace(" ",""));else{this.com.next().children("input:last").val(t),this.com.children().val(t);var n,o,a,s,r,c="";n=t.substr(0,4),o=t.substr(4,2)-1,a=t.substr(6,2),s=t.substr(8,2),r=t.substr(10,2),0!=this.showSeconds&&(c=t.substr(12,2))
;var l=this.isValidDate([n,o+1,a,s,r,c])?PJF.util.formatDate(new Date(n,o,a||1,s,r,c||0),this.format):t;this.com.next().children("input:first").val(l)}else{var d=t.split(",");l="";for(var u in d){var h=this.transferDate(d[u],!1,!0);l?l+=","+h:l=h}this.com.next().children("input:last").val(t),this.com.next().children("input:first").val(l)}!1!==e&&this.com.next().children("input:first").trigger("blur")}},getComboObj:function(){return this.jq},destroy:function(){this.com.datebox("destroy"),this.copyComObj.attr("id",this.params.dom)},newDestroy:function(){this.com.datebox("destroy"),this.copyComObj.attr("id",this.params.dom),PJF.ui.componentMgr.remove(this.id)},disabled:function(){this.disableflag=!0,this.com.datebox("disable"),this.com.next().children("input:first").removeClass("pjf_readonly_input"),this.com.next("span").addClass("pjf_disabled_input").children("input").addClass("pjf_disabled_input"),this.com.next("span").children("span").children("span").addClass("combo-arrow-disable"),
this.com.next("span").removeClass("validatebox-tipcolor error-border").find("input").removeClass("validatebox-tipcolor error-border"),this.com.next("span").find("div.errorbox_ipt_help").remove()},disable:function(){this.disableflag=!0,this.disableAttr=!0,this.com.datebox("disable"),this.com.next().children("input:first").removeClass("pjf_readonly_input"),this.com.next("span").addClass("pjf_disabled_input").children("input").addClass("pjf_disabled_input"),this.com.next("span").children("span").children("span").addClass("combo-arrow-disable"),this.com.next("span").removeClass("validatebox-tipcolor error-border").find("input").removeClass("validatebox-tipcolor error-border"),this.com.next("span").find("div.errorbox_ipt_help").remove()},enable:function(){this.disableflag=!1,this.disableAttr=!1,this.com.datebox("enable"),this.com.next().children("input:first").removeAttr("readOnly"),this.com.next("span").removeClass("pjf_disabled_input").children("input").removeClass("pjf_disabled_input"),
this.com.next().children("input:first").removeClass("pjf_readonly_input"),this.com.next("span").children("span").children("span").addClass("combo-arrow"),this.com.next("span").children("span").children("span").removeClass("combo-arrow-disable")},manualValidate:function(){var t=this.com.datebox("getValue"),e=this.com.next("span").hasClass("validatebox-tipcolor");return""!=t||e?""!=t&&e?(this.com.next("span").removeClass("validatebox-tipcolor").children("input").removeClass("validatebox-tipcolor"),!1):void 0:(this.com.next("span").addClass("validatebox-tipcolor").children("input").addClass("validatebox-tipcolor"),this.com.next("span").children("input:text").click(),!1)},setMinDate:function(t){this.minDate=t},setMaxDate:function(t){this.maxDate=t},display:function(t){t?this.com.next().show():this.com.next().hide(),this.showflag=t},getIntervalId:function(){return this.time},setNexDateDom:function(t){this.nexDateDom=t},setPreDateDom:function(t){this.preDateDom=t},setReadOnly:function(t){
(this.readonlyflag=t)?(this.com.next().children("input:first").attr("readOnly",t),this.com.next().find(".combo-arrow").unbind("click").unbind("mouseenter").unbind("mouseleave"),this.com.next().children("input").unbind("keydown.combo"),this.com.next().children("input:first").addClass("pjf_readonly_input")):(this.com.next().children("input:first").removeAttr("readOnly"),this.com.datebox("enable"),this.com.next().children("input:first").removeClass("pjf_readonly_input"),this.com.next().children("input:first").removeClass("pjf_disabled_input"))},setValidMiMaMsg:function(t){this.validMiMaMsg=t},addHighlight:function(){this.com.next().children("input:first").addClass("validatebox-tipcolor error-border")}}),PJF.apply(PJF.ui.dateinput.prototype,{bindEvent:function(t,e){var i=this.com.dateinput("options");"blur"==t&&(i.blurEvent=e)},setRequired:function(t){this.required=t,
(this.params.required=t)?this.com.next().find("input:eq(0)").addClass("validatebox-invalid invalid_box"):this.com.next().find("input:eq(0)").removeClass("validatebox-invalid invalid_box")},getClassName:function(){return"PJF.ui.dateinput"},focus:function(){this.com.next().find("input:eq(0)").focus()},isDisplay:function(){return this.showflag},isDisabled:function(){return this.disableflag},isReadOnly:function(){return this.readonlyflag},setHelpTip:function(t,e){if(!1===e)this.tip&&this.tip.destroy(),this.tip=null;else if(this.tip)this.tip.setHelpMsg(t);else{var i="btn_tip_"+PJF.util.generateUUid();this.com.after('<span id="'+i+'"></span>'),this.tip=new PJF.ui.helpTip({dom:i,helpMessage:t||""})}}}),function(u,o){function h(t,e){if(u.isArray(e)){l(t,e);var i,n,o,a,s,r=u('<div class="pjf-fallList-frame"><ul></ul></div>'),c="";u.each(e,function(t,e){c+='<li class="pjf-fallList-li">'+e+"</li>"}),r.find("ul").html(c),t.find(".pjf-fallList-frame").remove(),t.append(r),i=t,
n=u.data(i[0],"fallList").options,i.find(".pjf-fallList-frame").css({position:"absolute",width:n.width,height:n.height,left:n.left,top:n.top}),a=(o=t).find(".pjf-fallList-frame").height(),s=o.find(".pjf-fallList-li").height(),o.find(".pjf-fallList-frame").on("scroll",function(){var n=this;u(this).data("timing")||(u(this).data("timing",!0),setTimeout(function(){var t=u.data(o[0],"fallList").options,e=o.find(".pjf-fallList-frame>ul").height(),i=n.scrollTop;i<=s&&t.onScrollTop(t.options[0]),e-a<=i&&t.onScrollEnd(t.options[t.options.length-1]),u(n).removeData("timing")},1e3))})}}function l(t,e){u.data(t[0],"fallList").options.options=e}function p(t){return t.nodeName.toUpperCase()}function n(l){var d=u.data(l,"fallList").options;l=u(l),d.focusDom.on("focus",function(t){t.stopPropagation();var e,i,n,o,a,s=l.find(d.valueDom);if(e="INPUT"==p(s[0])?s.val():s.text(),0<l.find(".pjf-fallList-frame").length)l.find(".pjf-fallList-frame").show();else{var r=d.options,c=d.createOption(e)
;u.isArray(c)&&(r=c),h(l,r),n=e,o=u(i=l).find(".pjf-fallList-li"),a=0,o.each(function(t){u(this).text()==n&&(a=u(this).position().top)}),u(i).find(".pjf-fallList-frame").scrollTop(a)}}),d.focusDom.on("blur",function(){l.find(".pjf-fallList-frame").hide()}),l.on("mousedown",".pjf-fallList-li",function(t){t.stopPropagation();var e=l.find(d.valueDom),i=p(e[0]),n=u(this).text();"INPUT"==i?e.val(n):e.text(n),u.isFunction(d.onSelect(n))&&d.onSelect.call(this,n),setTimeout(function(){d.focusDom.trigger("blur")},0)})}function a(t,e,i){var n=i?"prepend":"append";t.find(".pjf-fallList-frame>ul")[n](u.map(e,function(t){return'<li class="pjf-fallList-li">'+t+"</li>"}).join(""))}u.fn.fallList=function(i,t){return"string"==typeof i?u.fn.fallList.methods[i](this,t):(i=i||{},this.each(function(){var t,e=u.data(this,"fallList");e?t=u.extend(e.options,i):(t=u.extend({},u.fn.fallList.defaults,i),u.data(this,"fallList",{options:t})),function(t){var e=u.data(t,"fallList").options;if(t=u(t),
e.focusDom)e.focusDom=t.find(e.focusDom);else{var i=t.css("position"),n=t.attr("tabindex");"static"==i&&t.css({position:"relative"}),n!=o&&""!=n||t.attr("tabindex","-1"),t.css({outline:"none"}),e.focusDom=t}}(this),n(this)}))},u.fn.fallList.methods={options:function(t){return u.data(t[0],"fallList").options},appendOptions:function(t,n){return t.each(function(){var t,e,i;t=this,e=n,i=u.data(t,"fallList").options,u.isArray(e)&&(l(u(t),i.options.concat(e)),a(u(t),e,!1))})},prependOptions:function(t,e){return t.each(function(){!function(t,e){var i=u.data(t,"fallList").options;if(u.isArray(e)){l(u(t),e.concat(i.options)),a(u(t),e,!0);var n=u(t).find(".pjf-fallList-li").height(),o=e.length*n;u(t).find(".pjf-fallList-frame").scrollTop(o)}}(this,e)})},destroy:function(t){return t.each(function(){var t;u(t=this).off(),u(t).find(".pjf-fallList-li").off(),u(t).find(".pjf-fallList-frame").html("").remove()})}},u.fn.fallList.defaults={width:"inherit",height:116,top:20,left:7,valueDom:null,
focusDom:null,clickSwitch:!0,createOption:function(){},onSelect:function(t,e,i){},onScrollTop:function(t,e){},onScrollEnd:function(t,e){}}}(jQuery),PJF.namespace("PJF.ui.gridUtil"),PJF.ui.grid=PJF.extend(PJF.ui.component,{dom:null,conf:null,lastIndex:0,parseData:null,copyCom:null,pageStoredData:null,init:function(h){var p=this;this.selectedsData=new PJF.util.Collection,this.pageStoredData={total:0,rows:[]},this.columnEditorMap={},this.dom=h.dom,h.singleSelect=0!=h.singleSelect,this.conf=h,this.baseDomHTML=$("#"+this.dom)[0].outerHTML,this.attachFormatter(h),this.countWidth(h),this.createToolbar(h);try{this.ieVersion=parseInt($.browser.version)}catch(n){this.ieVersion=-1}h.isCCBS?h.reqType="P6":h.isCCBS=h.reqType!=undefined,"P6_2"==h.reqType&&(h.isCCBS=!1);var t=PJF_IS_WIDTH?PJF.constants.GRID_DEFAULT_WIDTH:PJF.constants.GRID_DEFAULT_WIDTH_1024,e=!1;e=!0===h.highPerformance||!1===h.highPerformance?h.highPerformance:PJF.constants.HIGH_PERFORMANCE;var i=!0
;"FESP"==h.reqType?!(i=!1)===h.isShowTotal&&this.printLog("reqType == 'FESP' SET isShowTotal to false !"):i=h.isShowTotal===undefined||h.isShowTotal,h.isShowPrevNextBtnOnly&&!0!==h.isShowPaginationNumber?h.isShowPaginationNumber=!1:h.isShowPaginationNumber=!1!==h.isShowPaginationNumber,this.com.datagrid({quickSave:h.quickSave,ieVersion:this.ieVersion,showBorder:h.showBorder,isCCBS:h.isCCBS,reqType:h.reqType,isFirstCCBSReq:h.isFirstCCBSReq==undefined||h.isFirstCCBSReq,ccbsReqFlag:{preReq:!1,nextReq:!1},ccbsPath:h.ccbsPath||"_COMMON.COMA",sendPath:h.sendPath||h.reqType+"_REQ_INFO",firstReqFlowStatus:h.firstReqFlowStatus,ccbssReqTypeFix:h.ccbssReqTypeFix,p6ReqTypeFix:h.p6ReqTypeFix,fixGridFrozenColumnsBug:"undefined"==typeof h.fixGridFrozenColumnsBug||h.fixGridFrozenColumnsBug,supportAutoCenter:h.supportAutoCenter,id:h.id,title:h.title,width:h.width||t,height:h.height||this.generateBetterHeight("height"),nowrap:h.nowrap,titleNowrap:h.titleNowrap,striped:!0,showGuid:h.showGuid,
collapsible:h.collapsible==undefined||h.collapsible,fitColumns:h.fitColumns==undefined||h.fitColumns,url:h.url,dataType:h.dataType,timeout:h.timeout||h.timeOut||PJF.constants.AJAX_TIMEOUT,sortName:h.sortName,sortOrder:h.sortOrder,idField:h.idField,remoteSort:h.remoteSort||!1,crossDomain:h.crossDomain,remoteSortNameKey:h.remoteSortNameKey||"sort",remoteSortOrderKey:h.remoteSortOrderKey||"order",checkOnSelect:h.checkOnSelect,isFixedHeight:h.isFixedHeight,isAutoSizeHeight:"auto"==h.height,isAutoSizeWidth:"auto"==(h.width||PJF.constants.GRID_DEFAULT_WIDTH),maxAutoSizeHeight:h.maxAutoSizeHeight||this.generateBetterHeight("maxAutoSizeHeight"),isForceAutoSize:h.isForceAutoSize,highPerformance:e,autoPagination:h.autoPagination,maskAll:h.maskAll,cellMouseOver:this.cellMouseOver(this),cellMouseOut:this.cellMouseOut(this),FLAG_DRAG_AFTER_EDIT:h.FLAG_DRAG_AFTER_EDIT==undefined||h.FLAG_DRAG_AFTER_EDIT,FLAG_DEFWIDTH_AFTER_EDIT:h.FLAG_DEFWIDTH_AFTER_EDIT==undefined||h.FLAG_DEFWIDTH_AFTER_EDIT,
singleSelect:0!=h.singleSelect,isShowSelectAllCheckBox:h.isShowSelectAllCheckBox,frozenColumns:h.frozenColumns,columns:h.columns,pagination:h.pagination==undefined||h.pagination,showNumberSize:h.showNumberSize,isShowPaginationNumber:h.isShowPaginationNumber,isShowTotal:i,isShowPaginationArea:h.isShowPaginationArea,isShowPrevNextBtnOnly:h.isShowPrevNextBtnOnly,isShowContextMenu:h.isShowContextMenu,onExpand:h.onExpand||function(){},onCollapse:h.onCollapse||function(){},onSortColumn:h.onSortColumn||function(){},onClickBodyEmptyArea:h.onClickBodyEmptyArea,onBeforeAcceptChanges:h.onBeforeAcceptChanges,onBeforeClickBodyEmptyArea:h.onBeforeClickBodyEmptyArea,reqParamsFilter:h.reqParamsFilter,firstHandler:h.firstHandler,prevHandler:h.prevHandler,nextHandler:h.nextHandler,endHandler:h.endHandler,enterHandler:h.enterHandler,pageChangeHandler:h.pageChangeHandler||function(t,e,i){p.conf[t+"BtnHandler"]&&p.conf[t+"BtnHandler"](e,i)},isLocalPagination:h.isLocalPagination,
beforeRefresh:h.beforeRefresh,totalPath:h.totalPath,rowsPath:h.rowsPath,pageNumberParamName:h.pageNumberParamName,pageSizeParamName:h.pageSizeParamName,beginIndexParamName:h.beginIndexParamName,pageSize:h.pageSize||10,pageList:h.pageList||[5,10,20,30],showFooter:h.showFooter,showPageList:h.showPageList,setPaginationStatus:h.setPaginationStatus,rownumbers:h.rownumbers==undefined||h.rownumbers,queryParams:h.queryParams==undefined?"":h.queryParams,toolbar:h.toolbar,rowStyler:h.rowStyler,selectedsData:this.selectedsData,noDataMsg:h.noDataMsg,initInfo:h.initMsg,loadMsg:h.loadMsg||resource.GRID_LOADMSG,onHeaderContextMenu:function(t,e){t.preventDefault();var i="tmenu_"+h.dom,n=$("#"+i);if(0==n.length){PJF.ui.gridUtil.createColumnMenu(h.dom,i),n=$("#"+i);var o=t.pageY,a=$(window).height()-t.pageY,s=n.height(),r=s;a<=o?o<s&&(r=o):a<s&&(r=a),r!=s&&n.css("height",r-10)}n.menu("show",{left:t.pageX,top:t.pageY})},onBeforeLoad:function(t){if(!p.hasChangeBtn){p.hasChangeBtn=!0
;for(var e=p.getGridDom().panel,i=$("div.datagrid-toolbar-entity",e).children("a").removeClass(),n=0;n<i.length;n++)if(i[n].firstChild){var o=PJF.constants.PJF_LINKBUTTON_STYLE;i[n].className=o["default"].defStatus.left+" "+o.assistant.defStatus.left+" linkBtn_margin",i[n].firstChild.className=o["default"].defStatus.middle+" "+o.assistant.defStatus.middle,$(i[n].firstChild).find("span:last")[0].className=o["default"].defStatus.right+" "+o.assistant.defStatus.right}}p.handleToolbarScroll(),p.changePanelHeader(),p.createSubmitButton(),h.onBeforeLoad&&h.onBeforeLoad(t)},loadFilter:h.loadFilter,dataErrorHandler:function(t,e){if(!e)return!0;if(e.BK_STATUS&&e.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS){p.removeMaskAllLoading();var i="";e._COMMON&&e._COMMON.SYS_EVT_TRACE_ID&&(i=e._COMMON.SYS_EVT_TRACE_ID);var n=e.BK_DESC;return e.FLLW_GUIDE&&(n+="~"+e.FLLW_GUIDE),new PJF.ui.errorMessageBox({title:resource.GRID_RESPONSE_REQUEST_FAIL,desc:n,code:e.BK_CODE,traceId:i,fn:function(){
t.onLoadFailure&&t.onLoadFailure(e)}}),!0}return!1},onClickRow:function(t){$("#"+h.dom).datagrid("acceptChanges")},onDblClickCell:function(t,e,i){$("#"+h.dom).datagrid("acceptChanges");var n=0,o=!1;-1!=(n=u(e,$("#"+h.dom).prev()))&&(o=!0);var a=p.getOptions().frozenColumns,s=a?a.length:0,r=p.getOptions().rownumbers;if(s)if(o)if(1==s)n+=a[0].length;else for(var c=a[0],l=c.length,d=0;d<l;d++){n+=c[d].colspan||1}else{n=u(e,p.getGridDom().dc.view1);r&&n--}function u(t,e){for(var i=$('tr[datagrid-row-index="0"]',e),n=0;n<i[0].children.length;n++){if($(i[0].children[n]).attr("field")==t)return n}return-1}r&&n++,$("#"+h.dom).datagrid("beginEdit",{rowIndex:t,colIndex:n}),p.getOptions().currentEditColumn=e},onBeforeEdit:function(t,e,i){if(h.onBeforeEdit)return h.onBeforeEdit(t,e,i)},onAfterEdit:function(t,e,i){h.onAfterEdit&&h.onAfterEdit(t,e,i),p.updatePageData(t,i);var n=0;for(var o in i)n++;p.getOptions().mergedRowIndexs&&1==p.getRowsCount()||0<n&&p.doAutoSizeColumn()},
onClickCell:function(t,e,i){},onLoadSuccess:function(t){p.removeMaskAllLoading(),h.onLoadSuccess&&h.onLoadSuccess(t)},onSelect:function(t,e){p.addSelectedsData(t,e),h.onSelect&&h.onSelect(t,e)},onSelectAll:function(t,e){for(var i in t)e&&e[i]||p.addSelectedsData(parseInt(i,10),t[i]);!p.conf.singleSelect&&h.onSelectAll&&h.onSelectAll(t,p.getOptions().isSelectAllByUser)},onSelectMassRows:function(t,e,i){for(var n in t)if(!e||!e[n]){var o=parseInt(n,10);0<=$.inArray(o,i)&&p.addSelectedsData(o,t[n])}},onUnSelectMassRows:function(t,e,i){for(var n in t)if(!e||!e[n]){var o=parseInt(n,10);0<=$.inArray(o,i)&&p.deleteSelectedsData(o,t[n])}},onUnselect:function(t,e){p.deleteSelectedsData(t,e),h.onUnselect&&h.onUnselect(t,e)},onUnselectAll:function(t){for(var e in t)p.deleteSelectedsData(parseInt(e,10),t[e]);!p.conf.singleSelect&&h.onUnselectAll&&h.onUnselectAll(t,p.getOptions().isUnSelectAllByUser)},onLoadError:function(t,e,i){p.removeMaskAllLoading(),new PJF.ui.errorMessageBox({
title:resource.GRID_RESPONSE_REQUEST_FAIL,desc:resource.GRID_RESPONSE_REQUEST_ERROR+e,fn:function(){h.onLoadError&&h.onLoadError()}})},onLoadFailure:function(){h.onLoadFailure&&h.onLoadFailure()}}),this.createInputtext(),this.extendGridEditor(),this.additionalOper(h),this.bindKeyBoardEvent(p)},bindKeyBoardEvent:function(t){PJF.constants.KEYBOARD_ENABLE&&this.com.parents("div.datagrid").unbind("keydown").bind("keydown",function(){PJF.ui.gridUtil.handleGridKeyboard(t)})},attachFormatter:function(t){if(t.columns)for(var e=0;e<t.columns.length;e++)for(var i in t.columns[e]){var n=t.columns[e][i];if(n&&n.editor&&n.editor.options&&n.editor.options.datatype){var o=n.editor.options.datatype;if(n.editor.options.formatAsType&&!n.formatter)switch(o){case"money":n.formatter=a}}}function a(t,e,i){var n,o,a=t.toString(),s=/(\d+)(\d{3})/,r=a.indexOf(".");if(0<=r){for(n=a.substring(0,r),o=a.substring(r+1,a.length);s.test(n);)n=n.replace(s,"$1,$2");a=n+"."+o}else for(;s.test(a);)a=a.replace(s,"$1,$2")
;return a}},countWidth:function(t){if(t.columns){for(var e=0,i=0;i<t.columns.length;i++)for(var n in t.columns[i]){var o=(a=t.columns[i][n]).title?14*a.title.length:56;a.width?a.userInitWidth=a.width:a.width=o,e+=o}this.conf.width&&this.conf.width;if(0<e)for(i=0;i<t.columns.length;i++)for(var n in t.columns[i]){(a=t.columns[i][n]).width&&(a.width="")}}if(t.frozenColumns){for(e=0,i=0;i<t.frozenColumns.length;i++)for(var n in t.frozenColumns[i]){o=(a=t.frozenColumns[i][n]).title?14*a.title.length:56;a.width?a.userInitWidth=a.width:a.width=o,e+=o}this.conf.width&&this.conf.width;if(0<e)for(i=0;i<t.frozenColumns.length;i++)for(var n in t.frozenColumns[i]){var a;(a=t.frozenColumns[i][n]).width&&(a.width="")}}},createToolbar:function(t){var e=this;if(t.toolbar)for(var i in t.toolbar)"add"!=t.toolbar[i].bt?"del"!=t.toolbar[i].bt?"edit"!=t.toolbar[i].bt?"save"!=t.toolbar[i].bt?"custom"!=t.toolbar[i].bt?"submitButton"!=t.toolbar[i].bt?"dispatcherButton"!=t.toolbar[i].bt||(t.toolbar[i]={
bt:t.toolbar[i].bt,dom:t.toolbar[i].dom,name:t.toolbar[i].name,src:t.toolbar[i].src,url:t.toolbar[i].url,fwServiceId:t.toolbar[i].fwServiceId,success:t.toolbar[i].success,align:t.toolbar[i].align}):t.toolbar[i]={bt:t.toolbar[i].bt,dom:t.toolbar[i].dom,name:t.toolbar[i].name,src:t.toolbar[i].src,target:t.toolbar[i].target,encrypt:t.toolbar[i].encrypt,url:t.toolbar[i].url,fwServiceId:t.toolbar[i].fwServiceId,success:t.toolbar[i].success,align:t.toolbar[i].align}:t.toolbar[i]={text:t.toolbar[i].text,iconCls:"assistant",handler:t.toolbar[i].onclick,key:t.toolbar[i].key?"addToolbarButton_"+t.toolbar[i].key:"",align:t.toolbar[i].align}:t.toolbar[i]={text:resource.GRID_TOOLBAR_KEEP,key:t.toolbar[i].key?"addToolbarButton_"+t.toolbar[i].key:"",iconCls:"assistant",handler:function(){$("#"+t.dom).datagrid("acceptChanges")},align:t.toolbar[i].align}:t.toolbar[i]={text:resource.GRID_TOOLBAR_EDIT,iconCls:"assistant",key:t.toolbar[i].key?"addToolbarButton_"+t.toolbar[i].key:"",handler:function(){
e.updateButtonMethod()},align:t.toolbar[i].align}:t.toolbar[i]={text:resource.GRID_TOOLBAR_DEL,iconCls:"assistant",key:t.toolbar[i].key?"addToolbarButton_"+t.toolbar[i].key:"",handler:function(){e.deleteButtonMethod()},align:t.toolbar[i].align}:t.toolbar[i]={text:resource.GRID_TOOLBAR_ADD,iconCls:"assistant",key:t.toolbar[i].key?"addToolbarButton_"+t.toolbar[i].key:"",handler:function(){e.addButtonMethod(t.addRowData)},align:t.toolbar[i].align}},handleToolbarScroll:function(t,e){if(!1,this.getGridDom().panel.is(":visible")){var i=this.conf,n=this.getToolbarContainerDiv(),o=n.width(),a=0;a="auto"==i.width?o-19:o;var s=0;$("a.pjf_linkBtn_left:visible",n).each(function(){var t=$(this).width();0<t&&(s+=t+5)});var r=$("div.datagrid-toolbar-entity",n),c=$("div.datagrid-toolbar-container",n);if(a<s){c.width(a-52),r.width(s+2),$("a.toolbar-left-icon",n).remove(),$("a.toolbar-right-icon",n).remove()
;var l=$('<a class="toolbar-left-icon left" href="javascript:;"></a>').prependTo(n).bind("click",function(){var e=c.scrollLeft();c.animate({scrollLeft:"-=200"},20,"swing",function(){var t=c.scrollLeft();e==t&&0==t?(l.css("visibility","hidden"),d.css("visibility","visible")):(d.css("visibility","visible"),l.css("visibility","visible"))})}),d=$('<a class="toolbar-right-icon right" href="javascript:;"></a>').appendTo(n).bind("click",function(){var e=c.scrollLeft();c.animate({scrollLeft:"+=200"},20,"swing",function(){var t=c.scrollLeft();e==t&&0<t?d.css("visibility","hidden"):d.css("visibility","visible"),l.css("visibility","visible")})});!1===t?(l.css("visibility","visible"),d.css("visibility","visible")):l.css("visibility","hidden")}else $("a.toolbar-left-icon",n).remove(),$("a.toolbar-right-icon",n).remove(),0==c.width()&&this.getOptions().fixToolbarContainer&&(this.getOptions().fixToolbarContainer=!1,c.width(o),r.css("width","auto")),c.width(o-4),r.width(o-4)}},getGridDom:function(){
return this.com.datagrid("getGridDom")},getClassName:function(){return"PJF.ui.grid"}}),PJF.apply(PJF.ui.grid.prototype,{modifyProperty:function(t){this.hasChangeBtn=!1,this.com.datagrid(t)},moveSelectedRow:function(t){if(0==this.conf.singleSelect&&1<this.getSelections().length)alert("Error: 不支持多选状态下上下移动！");else{var e=this.getSelected();if(e){var i=this.getRowsCount();if(i<=1)return;var n=this.getRowIndex(e),o=0;o=t?1<=n?n-1:i-1:i-1<=n?0:n+1;var a=this.getRows(),s=a[n];a[n]=a[o],a[o]=s;var r={},c=this.conf.rowsPath||"rows",l=this.conf.totalPath||"total";r[c]=a,r[l]=a.length,this.conf.showFooter&&(r.footer=this.getData().footer),this.getOptions().skipResetHead=!0,this.getOptions().justUD=!0,this.loadData(r),this.clearSelections(),this.selectRow(o),this.getOptions().justUD=!1}}},upSelectedRow:function(){this.moveSelectedRow(!0)},downSelectedRow:function(){this.moveSelectedRow(!1)},disableCheckedByRow:function(t,e){
var i=this.com.datagrid("getGridDom").dc,n=$(".datagrid-body .datagrid-btable tr",i.view2);n.length<=t&&alert("Error:trs.length="+n.length+" , rowIndex = "+t);var o=n[t],a=$("td:first input[type='checkbox']",o);1==a.length?e?a.attr("disabled","disabled"):a.removeAttr("disabled"):alert("Error:未找到对应节点,ckField.length="+a.length)},isCheckedByRow:function(t){var e=null;if(!t)return e;var i=this.getRowIndex(t),n=this.com.datagrid("getGridDom").dc,o=$(".datagrid-body .datagrid-btable tr",n.view2);if(o.length<=i)return alert("Error:trs.length="+o.length+" , rowIndex = "+i),e;var a=o[i],s=$("td:first input[type='checkbox']",a);return 1==s.length?e="checked"==s.attr("checked"):alert("Error:未找到对应节点,ckField.length="+s.length),e},isCheckedByIndex:function(t){var e=this.getRows()[t];return e?this.isCheckedByRow(e):(alert("Error: 索引不正确 , index = "+t+" and length = "+this.getRows().length),null)},onLoad:function(){},load:function(t){return this.getOptions().currentEditColumn=undefined,
this.resetCCBSMode(!0),this.clearSelections(),this.showMaskAllLoading(),this.com.datagrid("load",t)},reload:function(t){return this.getOptions().currentEditColumn=undefined,this.resetCCBSMode(!0),this.clearSelections(),this.showMaskAllLoading(),this.com.datagrid("reload",t)},resetCCBSMode:function(t,e,i){if(this.conf.isCCBS||"P6_2"==this.conf.reqType){var n=this.getOptions();n.isFirstCCBSReq=t==undefined||t,n.firstSTA_KEY=undefined,n.OPM_ITI_ID=undefined;var o=this.getPagerInfo();o&&(o.ccbsCurrentPageNumber=undefined),e!=undefined&&(n.ccbsReqFlag.preReq=e),i!=undefined&&(n.ccbsReqFlag.nextReq=i)}},pagerButtonsStyle:function(){$("#"+this.dom).prev()[0].parentElement},addButtonMethodStr:function(t){this.com.datagrid("endEdit",this.lastIndex),this.appendStrRow(t),this.lastIndex=this.com.datagrid("getRows").length-1,this.com.datagrid("selectRow",this.lastIndex),this.checkBackground()},addButtonMethod:function(t){this.com.datagrid("endEdit",this.lastIndex);var e={};for(var i in t)e[i]=t[i]
;this.appendRow(e),this.lastIndex=this.com.datagrid("getRows").length-1,this.com.datagrid("selectRow",this.lastIndex),this.checkBackground()},updateButtonMethod:function(){var t=this.getPageSelectedIndex();this.com.datagrid("endEdit",this.lastIndex),this.com.datagrid("beginEdit",{rowIndex:t}),this.lastIndex=t},deleteButtonMethod:function(){var t=this.com.datagrid("getSelected");if(t){var e=this.com.datagrid("getRowIndex",t);this.deleteRow(e)}this.checkBackground()},checkColumn:function(o,t){this.columnsName||(this.columnsName=function(){var t=o.columns,e=[];for(var i in t)for(var n in t[i])t[i][n].field&&!t[i][n].checkbox&&e.push(t[i][n].field);return e}());var e=this.columnsName,i=null,n=null;for(var a in e){i=e[a];try{n=t[i]}catch(s){n=""}t[i]=n==undefined?"":n}return t},appendStrRow:function(strrow){var row=eval("("+strrow+")");this.com.datagrid("appendRow",row),this.checkBackground(),this.addPageData(row),this.doAutoSizeColumn()},appendRow:function(t){
t&&t instanceof Object?this.appendRows([t]):alert("Error: appendRow方法的参数必须为JSON对象!")},appendRows:function(t){if(t&&t instanceof Array){for(var e in t){var i=this.checkColumn(this.getOptions(),t[e]);this.com.datagrid("appendRow",i),this.addPageData(i)}this.checkBackground(),this.doAutoSizeColumn()}else alert("Error: appendRows方法的参数必须为一个数组!")},saveAllEditData:function(){$("#"+this.conf.dom).datagrid("acceptChanges",{saveAll:!0});var t=this.getGridDom().dc;return 0==$("div.errorbox_ipt_help",t.view).length},createSubmitButton:function(){if(this.conf.toolbar)for(var t in this.conf.toolbar)if("dispatcherButton"!=this.conf.toolbar[t].bt)if("submitButton"!=this.conf.toolbar[t].bt);else new PJF.ui.submitButton({dom:this.conf.toolbar[t].dom,name:this.conf.toolbar[t].name,src:this.conf.toolbar[t].src,target:this.conf.toolbar[t].target,encrypt:this.conf.toolbar[t].encrypt,url:this.conf.toolbar[t].url,fwServiceId:this.conf.toolbar[t].fwServiceId,success:this.conf.toolbar[t].success
});else new PJF.ui.dispatcherButton({dom:this.conf.toolbar[t].dom,name:this.conf.toolbar[t].name,src:this.conf.toolbar[t].src,url:this.conf.toolbar[t].url,fwServiceId:this.conf.toolbar[t].fwServiceId,success:this.conf.toolbar[t].success})},createInputtext:function(){var t=$("#"+this.conf.dom);$("<tbody><tr><td><input id='int_grid_rows' type=text style='display:none' value='{\"total\":0,\"rows\":[]}'/></td></tr></tbody>").appendTo(t)},addPageData:function(t,e){var i=this.getPageData();if(i.total=parseInt(i.total,10),i.total=0<i.total?i.total+1:1,e>this.getRowsCount()-1&&(e=this.getRowsCount()-1),i.rows.length<e)for(var n=0;n<e;n++)i.rows[n]=i.rows[n]||{};if(e!==undefined)i.rows.splice(e,0,t);else{var o=i.rows.length;i.rows[o]=t}this.setPageData(i)},getPageData:function(){return this.pageStoredData},getStrPageData:function(){return PJF.util.json2str(this.pageStoredData,!0)},setPageData:function(t){var e=$("#"+this.dom);$('input[id="int_grid_rows"]',e)[0].value=PJF.util.json2str(t,!0),
this.pageStoredData=t},updatePageData:function(t,e){if(-1!=t){var i=this.getPageData();for(var n in e)for(var o in i.rows[t])n==o&&(i.rows[t][o]=e[n]);this.setPageData(i)}},getPageSelectedIndex:function(){var t=$("#"+this.dom).prev();return $("tr.datagrid-row-selected",t).attr("datagrid-row-index")},deletePageData:function(t){var e=this.getPageData();e.rows.splice(t,1),e.total=e.total-1,this.setPageData(e)},getIndexInPageDataByRow:function(t){if(!t)return alert("Error:不能传递一个空值给getIndexInPageDataByRow"),-1;var e=this.getPageData().rows;for(var i in e)if(t==e[i])return i;return-1},getIndexInPageDataByIndex:function(t){var e=this.getRows()[t];return e?this.getIndexInPageDataByRow(e):(alert("getIndexInPageDataByIndex Error:索引 "+t+"  不存在于grid中！"),-1)},checkBackground:function(){var t=this.getGridDom().dc,e=$("tr",t.body1),i=$("tr",t.body2);e.each(function(t){$(this).removeClass("datagrid-row-alt"),t%2&&$(this).addClass("datagrid-row-alt")}),i.each(function(t){
$(this).removeClass("datagrid-row-alt"),t%2&&$(this).addClass("datagrid-row-alt")})},insertRow:function(t,e){var i={index:t,row:e};this.com.datagrid("insertRow",i),this.checkBackground(),this.doAutoSizeColumn(),this.addPageData(e,t)},insertRows:function(t,e){var i={index:t,rows:e};if(0==this.getGridDom().data.rows.length)this.loadData(e);else{this.com.datagrid("insertRows",i),this.checkBackground(),this.doAutoSizeColumn();for(var n=0;n<e.length;n++)this.addPageData(e[n],t++)}},clearPageData:function(){this.pageStoredData&&(this.pageStoredData={total:0,rows:[]})},clearSelectedData:function(){this.selectedsData.clear()},generateMsg:function(t,e){return t?'<span class="pjf_grid_nodataMsg">'+t+"</span>":'<span class="pjf_grid_nodataMsg">'+(e.initInfo?e.initInfo:PJF.constants.GRID_INIT_INFO)+"</span>"},generateBetterHeight:function(t){if("height"==t){return 0+(this.conf.title?29:0)+30+30*this.conf.columns.length+(!1===this.conf.pagination?0:30)+27*(this.conf.pageSize||10)}
if("maxAutoSizeHeight"==t){return 287}},clearPaginationData:function(){this.getOptions().pagination&&(this.getPager().pagination("options").total="-1",this.getPager().pagination("options").pagegroup=1)},clearData:function(t){var e=this.getData();e.total=0,this.getOptions().totalRecForDesc=0,this.updateAdditionalInfo(""),this.hideAdditionalInfo(),e.rows=[],this.clearSelectedData(),this.clearPageData(),this.clearSelections(),this.clearPaginationData(),this.conf.isCCBS&&this.com.datagrid("doSetCCBSPagBtn",!1,!1),this.resetCCBSMode(!0);for(var i=$("#"+this.dom).prev(),n=$(".datagrid-body",i),o=$(".datagrid-body",i.prev()),a=n[0].parentElement.parentNode.parentNode,s=$('td[id="td_pager_pagebuttons"]',a),r=0;r<this.conf.columns[0].length;r++);var c="</TR></TBODY></TABLE><TABLE id=tab_listdiv_listContent class=div_tableList border=0 cellSpacing=0 cellPadding=0 width=100% height=80%><TBODY><TR><TD colSpan=99 align=middle> "+this.generateMsg(t,this.getOptions())+"</TD></TR></TBODY></TABLE>"
;if(n[0].innerHTML="<TABLE style='TABLE-LAYOUT: auto' width=100% class=datagrid-btable border=0 cellSpacing=0 cellPadding=0><TBODY><TR style='HEIGHT:1px' >"+c,$($("tbody",o)[0]).html(""),this.conf.showFooter){var l=this.com.datagrid("getGridDom"),d=$("table.datagrid-ftable",l.dc.view2);$("tbody",d).html(""),l.footer=[]}if(!1!==this.conf.pagination){s.length&&(s[0].innerHTML=""),this.setPagerInfo(1,1);var u=this.getPager();this.getOptions().isShowTotal&&$("#div_pagination_info",u).html(resource.GRID_LIST_TOTAL1+" 0 "+resource.GRID_LIST_UNIT)}this.getOptions().isSetToMinHeight=!0,this.com.datagrid("doFixGridHeight"),this.getOptions().skipResetHead?this.getOptions().skipResetHead=!1:this.com.datagrid("doResetTableHead")},doAutoSizeColumn:function(t){this.com.datagrid("doResetColumnWidth",t)},getRows:function(){return this.com.datagrid("getRows")},getRowsCount:function(){return this.com.datagrid("getRows").length},selectRow:function(t){
(this.getOptions().disabledIndex||{})[t]||this.com.datagrid("selectRow",t)},selectMassRows:function(t){"number"==typeof t&&(t=[].concat(t));for(var e=[],i=this.getOptions().disabledIndex||{},n=t.length,o=0;o<n;o++)i[t[o]]||e.push(t[o]);this.com.datagrid("selectMassRows",e)},unSelectMassRows:function(t){"number"==typeof t&&(t=[].concat(t));for(var e=[],i=this.getOptions().disabledIndex||{},n=t.length,o=0;o<n;o++)i[t[o]]||e.push(t[o]);this.com.datagrid("unSelectMassRows",e)},selectAllRow:function(){for(var t=this.getOptions().disabledIndex||{},e=this.com.datagrid("getRows").length,i=0;i<e;i++)t[i]||this.com.datagrid("selectRow",i)},setSingleSelectFlag:function(t){this.clearSelections();var e=this.getOptions();e.singleSelect=t,this.conf.singleSelect=t;var i=this.com.datagrid("getGridDom").dc,n=i.header1.add(i.header2).find("input[type=checkbox]");n._propAttr("checked",!1),e.singleSelect?n.css("display","none"):n.css("display","")},printLog:function(t){
"undefined"!=typeof console&&console.log("--------------"+t+"------------")},loadData:function(redata,flag){this.getOptions().currentEditColumn=undefined;var data={};if(redata)if(redata instanceof Array){var tmpObj={};tmpObj.rows=redata||[],tmpObj.total=tmpObj.rows.length,data=tmpObj}else{if(!(redata instanceof Object))return void alert("Eror: loadData 函数的参数 至少是数组或者对象!");this.parseData=redata;var total=0;if(redata.total===undefined){if(this.conf.totalPath)try{var totalPathStr="this.parseData."+this.conf.totalPath;total=eval("("+totalPathStr+")")}catch(e){total=0,this.printLog("Error: totalPathStr = "+totalPathStr+" 对应字段不存在！")}data.total=total||0}else data.total=redata.total;var rows=[];if(redata.rows===undefined){if(this.conf.rowsPath)try{var rowsPathStr="this.parseData."+this.conf.rowsPath;rows=eval("("+rowsPathStr+")")}catch(e){this.printLog("Error: rowsPathStr = "+rowsPathStr+" 对应字段不存在！"),rows=[]}data.rows=rows||[]}else data.rows=redata.rows;for(var k in redata)data[k]=redata[k]
}else data.total=0,data.rows=[];if(data.rows===undefined&&(data.rows=[]),data.total===undefined&&(data.total=0),"string"==typeof data.total)try{data.total=parseInt(data.total,10)}catch(e){data.total=0}this.getOptions().isLocalPagination&&(data.total=data.rows.length,data.orginalRows=data.rows,data.rows=data.rows.slice(0,this.getOptions().pageSize));var br=$("#"+this.dom).prev(),view1body=$(".datagrid-body",br.prev()),view=view1body[0].parentElement,parent2=view.parentNode,parent3=parent2.parentNode,td_pager_pagebuttons=$('td[id="td_pager_pagebuttons"]',parent3);if("none"==view1body[0].style.display&&(view1body[0].style.display=""),td_pager_pagebuttons[0]&&"none"==td_pager_pagebuttons[0].style.display&&(td_pager_pagebuttons[0].style.display=""),!1===this.getOptions().isShowPaginationNumber&&td_pager_pagebuttons&&td_pager_pagebuttons[0]&&(td_pager_pagebuttons[0].style.display="none"),data.rows&&0!=data.rows.length||(this.getOptions().skipResetHead=!0),this.clearData(),
this.com.datagrid("loadData",data),!flag){var newData={total:0,rows:[]};for(var x in newData.total=data.total,newData.rows=[],data.rows)newData.rows.push(data.rows[x]);this.setPageData(newData)}},updateRowStr:function(rowIndex,strRow){var row=eval("("+strRow+")"),param={index:rowIndex,row:row},pageData_rowIndex=this.getIndexInPageDataByIndex(rowIndex);this.com.datagrid("updateRow",param),this.updatePageData(pageData_rowIndex,row),this.checkBackground(),this.doAutoSizeColumn()},updateRow:function(t,e){var i={index:t,row:e},n=this.getIndexInPageDataByIndex(t);this.com.datagrid("updateRow",i),this.updatePageData(n,e),this.checkBackground(),this.doAutoSizeColumn()},updateRows:function(t,e){if(t instanceof Array&&e instanceof Array)if(t.length==e.length){var i=t.length;if(i){for(var n=0;n<i;n++){var o={index:t[n],row:e[n]},a=this.getIndexInPageDataByIndex(t[n]);this.com.datagrid("updateRow",o),this.updatePageData(a,e[n])}this.checkBackground(),this.doAutoSizeColumn()}
}else alert("Error: updateRows方法参数 rowIndexArray,rowsArray 数组长度必须相等！");else alert("Error: updateRows方法参数 rowIndexArray,rowsArray 必须为数组！")},updateRowByRow:function(t){this.updateRow(this.getRowIndex(t),t)},beginEdit:function(t){this.com.datagrid("beginEdit",t)},endEdit:function(t){this.com.datagrid("endEdit",t)},deleteRow:function(t){this.getPageData().rows;var e=this.getRows()[t],i=this.getIndexInPageDataByRow(e);this.deletePageData(i),this.com.datagrid("deleteRow",t),this.checkBackground()},getRowIndex:function(t){return this.com.datagrid("getRowIndex",t)},getSelectedIndex:function(){if(this.getOptions().singleSelect)return this.getRowIndex(this.getSelected());for(var t=[],e=this.getSelections(),i=0;i<e.length;i++)t.push(this.getRowIndex(e[i]));return t},getCurrentIndex:function(){var t=this.getSelected();return t?this.getRowIndex(t):-1},getSelected:function(){return this.com.datagrid("getSelected")},getSelections:function(){return this.com.datagrid("getSelections")},
getOptions:function(){return this.com.datagrid("options")},setOptions:function(t){for(var e in t)this.com.datagrid("options")[e]=t[e]},setRequestOptions:function(t,e){for(var i in this.getOptions().currentEditColumn=undefined,t)this.com.datagrid("options")[i]=t[i];this.showMaskAllLoading(),e?(this.resetCCBSMode(!0),this.com.datagrid("reload")):(this.resetCCBSMode(!0),this.clearPaginationData(),this.com.datagrid("load"),this.clearSelectedData(),this.clearPageData())},mergeCells:function(t,e,i,n){var o={index:t,field:e,rowspan:i,colspan:n,resizeMergedCell:!0};this.com.datagrid("mergeCells",o)},bindEventAction:function(t,e,i){if(t&&e){var n=this.com.datagrid("options");!{onClickRow:!0,onDblClickCell:!0,onSelectAll:!0,onUnselectAll:!0,onUnselect:!0,onSelect:!0,onBeforeLoad:!0,onLoadSuccess:!0}[t]||i?n[t]=e:this.conf[t]=e}},bindPaginationHandler:function(t,e){if("firstHandler"==t||"prevHandler"==t||"nextHandler"==t||"endHandler"==t||"enterHandler"==t||"onBeforeRefresh"==t){var i={};i[t]=e,
this.getPager().pagination(i)}else alert("Error: actionName("+t+") 名称不正确！")},resize:function(t){t||(t={}),"auto"!=this.conf.width||t.width||(t.width="auto"),this.com.datagrid("resize",t),this.getOptions().fixToolbarContainer=!0,this.handleToolbarScroll(!1),t.autoSetWidth&&this.com.datagrid("doResetColumnWidth")},resetColumnWidth:function(){this.com.datagrid("doResetColumnWidth")},unselectRow:function(t){this.com.datagrid("unselectRow",t)},unSelectRow:function(t){this.com.datagrid("unselectRow",t)},selectRecord:function(t){this.com.datagrid("selectRecord",t)},clearSelections:function(){this.com.datagrid("clearSelections")},destroy:function(){var t=this.conf;this.hasChangeBtn=!1;var e=$("#"+this.dom).parent().parent().parent();if(e.hasClass("datagrid")){var i=e.parent(":first");e.remove(),$(this.baseDomHTML).attr("style","display:block").appendTo(i),t.isShowContextMenu&&$("#tmenu_"+t.dom).remove()}},newDestroy:function(){var t=this.conf;this.hasChangeBtn=!1
;var e=$("#"+this.dom).parent().parent().parent();if(e.hasClass("datagrid")){var i=e.parent(":first");e.remove(),$(this.baseDomHTML).attr("style","display:block").appendTo(i),t.isShowContextMenu&&$("#tmenu_"+t.dom).remove(),PJF.ui.componentMgr.remove(this.id)}},validateParam:function(t){return t.dom?(this.dom=t.dom,!0):(new PJF.ui.messageBox({title:"",content:"提示：grid组件的dom不能为空！"}),!1)},getPagerInfo:function(){return this.com.datagrid("getPageInfo")},triggerPagination:function(t){var e=this.getPagerInfo().paginationBtns;e&&e[t]&&e[t].handler()},getData:function(){return this.com.datagrid("getData")},setCollapse:function(){this.com.datagrid("setCollapse")},setExpand:function(){this.com.datagrid("setExpand")},hideColumn:function(t){this.getOptions().showOrHide=!0,this.com.datagrid("hideColumn",t),this.getOptions().showOrHide=!1},showColumn:function(t){this.getOptions().showOrHide=!0,this.getOptions().isShowCol=1,this.com.datagrid("showColumn",t),this.getOptions().showOrHide=!1,
this.getOptions().isShowCol=0},cellMouseOver:function(e){return function(t){e.showGuid(t)}},cellMouseOut:function(e){return function(t){e.hideGuid(t)}},getTopLeft:function(t){if(!t)return!1;for(var e=t.offsetTop,i=t.offsetLeft;t=t.offsetParent;)e+=t.offsetTop,i+=t.offsetLeft;return{t:e,l:i}},closeGuid:function(t){var e=$("#"+this.dom).prev()[0].parentElement,i=$("#div_iGuid_main",e);i[0].style.display="none",i[0].name=""},resizeWidth:function(){for(var t=$("#"+this.dom).prev()[0].parentElement,e=$("div.datagrid-cell",t),i=0;i<e.length;i++){e[i].style.width="auto"}},formatData:function(data){if(data instanceof Array){var realdata={};return realdata[this.conf.totalPath||"total"]=data.length,realdata[this.conf.rowsPath||"rows"]=data,realdata}this.parseData=data;var realdata={total:0,rows:[]},totalpath=this.conf.totalPath,rowspath=this.conf.rowsPath,totalStr="this.parseData."+totalpath,rowsStr="this.parseData."+rowspath,total=null,rows=null;try{total=eval(totalStr)}catch(e){
"undefined"!=typeof console&&console.log(totalStr+"  对应字段不存在 ！"),total=0}try{rows=eval(rowsStr)}catch(e){"undefined"!=typeof console&&console.log(rowsStr+"  对应字段不存在！"),rows=[]}for(var k in realdata.total=total,realdata.rows=rows,data)realdata[k]=data[k];return realdata},refresh:function(t){if(t)this.com.datagrid("getSelectPage",t);else{var e=this.getPagerInfo();this.com.datagrid("getSelectPage",e.pageNumber)}this.clearSelections()},hide:function(){$.data($("#"+this.dom)[0],"datagrid").panel.panel("close")},show:function(){if($.data($("#"+this.dom)[0],"datagrid").panel.panel("open"),$("#"+this.dom).width()<10){var t=this.com.parent().width();this.conf.width&&"auto"!=this.conf.width&&(t=this.conf.width),$("#"+this.dom).width(t),this.com.datagrid("resize",{width:t})}this.handleToolbarScroll(!1)},display:function(t){t?this.show():this.hide()},addSelectedsData:function(t,e){var i,n=this.getPagerInfo();i=n?n.pageSize*(n.pageNumber-1)+(t+1):t+1,
1==this.conf.singleSelect&&this.selectedsData.clear(),this.selectedsData.add(i,e)},deleteSelectedsData:function(t,e){var i,n=this.getPagerInfo();i=n?n.pageSize*(n.pageNumber-1)+(t+1):t+1,this.selectedsData.containsKey(i)&&this.selectedsData.removeKey(i)},getSelectedsData:function(){return this.selectedsData},originalAppendRow:function(t){this.com.datagrid("appendRow",t),this.checkBackground()},originalUpdateRow:function(t,e){var i={index:t,row:e};this.com.datagrid("updateRow",i)},originalDeleteRow:function(t){this.com.datagrid("deleteRow",t),this.checkBackground()},resizeGrid:function(t,e,i,n){var o=$(document.body).height()-t,a=$(document.body).width()-e;o=o<i?i:o,a=a<n?n:a,this.com.datagrid("resize",{height:o,width:a})},reversalData:function(t,e){var i={},n=this.getData();return i[t]=n.total,i[e]=n.rows,i},getPanel:function(){return this.com.datagrid("getPanel")},changePanelHeader:function(){var t=$("#"+this.dom).prev()[0].parentElement.parentNode.parentNode,e=$("div.panel-header",t)
;if(e.length){e[0].style.width="auto",e[0].style.border="0px",e[0].style.background="transparent","9.0"==$.browser.version&&e.css("background-image","url('')");var i=$("div.panel-tool",e);i.length&&(i[0].className="panel-tool-right")}},getPager:function(){return this.com.datagrid("getPager")},getEditor:function(t){return this.com.datagrid("getEditor",t)},setObjectAttribute:function(t,e,i){$(t).attr(e,i)},initPager:function(){var t=this.getPager();$(t).pagination({buttons:null,total:0,pageNumber:1})},getConfigInfo:function(){return this.conf},getToolbarDiv:function(){var t=$("#"+this.dom).prev().parent().prev();return $("div.datagrid-toolbar-entity",t)},getToolbarContainerDiv:function(){return $("#"+this.dom).prev().parent().prev()},addToolbarButton:function(t){var e=this.getToolbarDiv();if(0<$("#addToolbarButton_"+t.key).length)new PJF.ui.messageBox({title:"提示：",content:"发现同名按钮，添加终止！"});else{var i="<a id=addToolbarButton_"+t.key+"></a>";$(i).appendTo(e),new PJF.ui.linkButton({
dom:"addToolbarButton_"+t.key,name:t.name,onclick:t.onclick,style:t.style,align:t.align||"left"}),this.handleToolbarScroll(!1,!0)}},disableToolbarButton:function(t,e,i){var n=this.getToolbarDiv(),o=$("#addToolbarButton_"+t,n);this._disableToolbarButton(o,e,i)},disableToolbarButtonByIndex:function(t,e,i){var n=this.getToolbarDiv(),o=$("a",n).eq(t);this._disableToolbarButton(o,e,i)},_disableToolbarButton:function(t,e,i){t&&0!=t.length?(i=i||"assistant",e?(t.pjfLinkButton({disabled:!0}),t[0].className="assistant"==i?" pjf_linkBtn_assistant_disable_left pjf_linkBtn_disable_left linkBtn_margin":" pjf_linkBtn_disable_left linkBtn_margin",t[0].firstChild.className="assistant"==i?" pjf_linkBtn_assistant_disable pjf_linkBtn_disable":" pjf_linkBtn_disable",$(t[0].firstChild).find("span:last")[0].className+="assistant"==i?" pjf_linkBtn_assistant_disable_right pjf_linkBtn_disable_right":" pjf_linkBtn_disable_right"):(t.pjfLinkButton({disabled:!1}),
t[0].className="assistant"==i?" pjf_linkBtn_left pjf_linkBtn_assistant_left linkBtn_margin":" pjf_linkBtn_left linkBtn_margin",t[0].firstChild.className="assistant"==i?" pjf_linkBtn pjf_linkBtn_assistant":" pjf_linkBtn ",$(t[0].firstChild).find("span:last")[0].className+="assistant"==i?" pjf_linkBtn_right pjf_linkBtn_assistant_right ":" pjf_linkBtn_right")):new PJF.ui.messageBox({title:"提示：",content:"不存在目标对象，操作终止！"})},setToolbarButtonVisible:function(t,e){var i=this.getToolbarDiv(),n=$("#addToolbarButton_"+t,i);e?(n.show(),n.focus()):n.hide(),this.handleToolbarScroll(!1)},setToolbarButtonVisibleByIndex:function(t,e){var i=this.getToolbarDiv(),n=$("a",i).eq(t);e?(n.show(),n.focus()):n.hide(),this.handleToolbarScroll(!1)},destroyToolbarButton:function(t){var e=this.getToolbarDiv();$("#addToolbarButton_"+t,e).remove(),this.handleToolbarScroll(!1)},destroyToolbarButtonByIndex:function(t){var e=this.getToolbarDiv();$("a",e).eq(t).remove(),this.handleToolbarScroll(!1)},
setPagerInfo:function(t,e){if((e=parseInt(e,10))<=t&&0<e){var i=$("#"+this.dom).prev()[0].parentElement.parentNode,n=($('div[id="div_pagination_info"]',i),$('input[id="txt_pagination_num"]',i)),o=$('span[id="span_pagination_pages"]',i),a=$('span[id="total_current"]',i);n.length&&(n[0].value=e),this.getPager().pagination("options").pageNumber=e,o.length&&(o[0].innerHTML=resource.GRID_LIST_JUMP_2+t+" "+resource.GRID_LIST_JUMP_3),a.length&&(a[0].innerHTML=resource.GRID_LIST_JUMP_4+" "+e+resource.GRID_LIST_JUMP_2_1+t+" "+resource.GRID_LIST_JUMP_3)}else new PJF.ui.messageBox({title:"输入错误",content:"提示：页码"+e+"超出最大范围值"+t+"，请重新输入！"})},updateTitle:function(t){if(this.conf.title){var e=this.com.datagrid("getGridDom").dc.view.parent().prev();$("div.panel-title",e).html(t)}},showAdditionalInfo:function(){this.getOptions().showAdditionalInfo=!0;var t=this.getGridDom().dc;t.additionalInfo&&t.additionalInfo.show(),this.com.datagrid("doFixGridHeight")},hideAdditionalInfo:function(){
this.getOptions().showAdditionalInfo=!1;var t=this.getGridDom().dc;t.additionalInfo&&t.additionalInfo.hide(),this.com.datagrid("doFixGridHeight")},updateAdditionalInfo:function(t){var e=this.getGridDom().dc;e.additionalInfo&&e.additionalInfo.html(t)},showLoading:function(){this.com.datagrid("loading")},showMaskAllLoading:function(t){console.log("----------------showMaskAllLoading-------------- "),(t||this.getOptions().maskAll)&&(console.log("---------------- Do showMaskAllLoading-------------- "),this.removeMaskAllLoading(),this.maskAllLoading=new PJF.ui.loading({maskBody:!0}))},removeLoading:function(){this.com.datagrid("loaded")},removeMaskAllLoading:function(){this.maskAllLoading&&(this.maskAllLoading.destroy(),this.maskAllLoading=null)},showToolbar:function(){this.getToolbarContainerDiv().show()},hideToolbar:function(){this.getToolbarContainerDiv().hide()},updateColumnsTitle:function(t){if("object"==PJF.util.getType(t)){
for(var e=this.getGridDom().dc,i=this.com.datagrid("getColumnFields"),n="",o=0;o<i.length;o++)if(n=t[i[o]]){this.com.datagrid("getColumnOption",i[o]).title=n;var a=e.view.find('div.datagrid-header td[field="'+i[o]+'"] div.datagrid-cell');$("span:first",a).html(n)}this.doAutoSizeColumn()}else alert("Error: 参数 fields_newTitles 必须为一个JSON对象！")},getColumn:function(t,e){e=e||0;for(var i=this.getOptions().columns[e],n=i.length,o=0;o<n;o++)if(i[o].field==t)return i[o];return null},getColumnEditorParam:function(t,e){var i=this.getColumn(t,e);return i?i.editor:(alert("Error: 未找到指定的列,field = "+t+" and index = "+e),null)},updateColumnEditorParam:function(t,e,i){var n=this.getColumn(e,i);return n?(n.editor=t,!0):(alert("Error: 未找到指定的列,field = "+e+" and index = "+i),!1)},removeColumnEditor:function(t,e){var i=this.getColumn(t,e);return i?!!i.editor&&(this.columnEditorMap[t]=i.editor,delete i.editor,!0):(alert("Error: 未找到指定的列,field = "+t+" and index = "+e),!1)},restoreColumnEditor:function(t,e){
var i=this.getColumn(t,e);return i?!!this.columnEditorMap[t]&&(i.editor=this.columnEditorMap[t],!0):(alert("Error: 未找到指定的列,field = "+t+" and index = "+e),!1)},getEditorContainer:function(t,e){if(void 0===t||void 0===e)return alert("getEditorContainer 参数不正确 ,rowIndex field 必填"),null;var i={index:t,field:e};return this.com.datagrid("getEditor",i)},getEditorTarget:function(t,e){var i=this.getEditorContainer(t,e);return i?i.target:null},getRowNumber:function(t){if(!(t=t||this.getSelected()))return-1;for(var e=this.getRows(),i=e.length,n=0;n<i;n++)if(e[n]==t)return n;return-1},additionalOper:function(t){if(!0===t.forPrint){var e=this.getGridDom().panel;t.isPrintTitle||e.prev().addClass("NoPrint"),t.isPrintToolbar||$("div.datagrid-toolbar",e).addClass("NoPrint"),t.isPrintPaginationBar||$("div.pagination",e).addClass("NoPrint")}},updateColumnValueByIndex:function(t,e,i,n){var o=[t],a={};a[e]=i,this.updateColumnsValueByIndex(o,[a],n)},updateColumnsValueByIndex:function(t,e,l){
if(!(t instanceof Array&&e instanceof Array))return alert("Error: updateColumsValueByIndex 方法参数均为数组！"),!1;if(t.length==e.length){var d=this,u=this.getRows(),i=u.length;for(var n in t)if(i<=t[n])return alert("Error: rowIndex( "+t[n]+" ) 不正确，当前索引最大值为： "+(i-1)),!1;for(var h={},o=t.length,a=0;a<o;a++){var s=t[a],r=e[a];c(s,r),p(s,r)}!1!==l&&this.doAutoSizeColumn()}else alert("Error: rowIndexs, fieldsAndNewValues 参数的长度必须相等！");function c(t,e){var i=u[t];PJF.apply(i,e);var n=d.getIndexInPageDataByIndex(t);d.updatePageData(n,i)}function p(t,e){var i=d.getGridDom().dc.body2,n=$("tr",i)[0].id.split("-").slice(0,4).join("-"),o=$("#"+n+"-"+t,i);for(var a in e){var s=h[a];if(s||(s=d.com.datagrid("getColumnOption",a),h[a]=s),!s)return alert("Error: 没有找到field为"+a+"列！"),!1;var r=e[a];if(s.formatter){var c=s.formatter(r,u[t],t,!0);c!==undefined&&(r=c)}$('td[field="'+a+'"]',o).children("div").each(function(t){$(this).hasClass("datagrid-editable")?l=!1:$(this).html(r)})}}},
updatePaginationBtnStatus:function(t,e){t=!!t,e=!!e,this.getPager().pagination("setPagBtnStatus",{preBtnStatus:t,nextBtnStatus:e})},getRowSelectedStatus:function(t){var e=-1;if("number"==PJF.util.getType(t)){var i=this.getRows().length;if(i<=e)return alert("Error: rowOrRowIndex("+t+") 超出最大索引("+(i-1)+")"),!1;e=t}else e=this.getRowIndex(t);if(-1==e)return alert("Error: 未在当前表格中找到rowOrRowIndex("+t+")指定的行！"),!1;var n=this.getGridDom().dc.body2,o=$("tr",n)[0].id.split("-").slice(0,4).join("-");return $("#"+o+"-"+e,n).hasClass("datagrid-row-selected")},showGuid:function(t){if(clearTimeout(this.hideGuidTimeout),this.hideGuid(null,!0),t){var e=(t=$(t)).attr("field");if(e){var i=this.com.datagrid("getColumnOption",e);if(i&&!1!==i.showDetailBox){var n=!!this.conf.onMouseOverCell;!1===i.isUsedShowInfo&&(n=!1);var o=t.attr("defWidth");if(n||o||6==this.ieVersion||i.fixByHandValue){var a=i.detailBoxWidth||this.conf.detailBoxWidth||200,s=$("div",t);if(!(1<s.length)){var r=s.css("text-align"),c=""
;if(n){var l=t.parent("tr").attr("id").split("-"),d=l[l.length-1],u=this.getRows()[d];c=this.conf.onMouseOverCell(d,e,u)}else c=s.html();if(n||!(c.length<=10)||i.title&&!(i.title&&c.length<=i.title.length)||i.fixByHandValue&&i.autoWidth&&i.fixByHandValue<i.autoWidth-8){var h=!0,p=!1,f=108,m=this,g=this.getGridDom().dc,v=g.view2,_=g.body2,b=parseInt(_.position().top),y=parseInt(t.position().top),P=t.parent("tr").height(),C=parseInt(t.position().left),I=_.height(),F=$("table:first",_).width(),x=_.width(),w=x<F;if(!(y<0&&Math.abs(y)>P/2))if(!(I-(w?17:0)-y<P/2)){var D=t.width(),T=0,A=0,E=(T=y+5+b)<(A=I-y-P+5);!function(){if(!1,E==p){if(!m.upDetailDiv){var t='<div class="detail_base" id="detail_base_down_'+m.conf.dom+'"><div class="detail_content detail_content_down"></div><div class="detail_top detail_top_down"></div></div>';m.upDetailDiv=$(t).appendTo(v),m.upDetailContent=$(".detail_content",m.upDetailDiv),m.upArrowDiv=$(".detail_top",m.upDetailDiv)}m.upDetailContent.html(c),
m.upDetailDiv.show(),m.upDetailContent.css("height",""),m.upDetailDiv.width(a);var e=T-5-2-20,i=m.upDetailContent.height();i<f&&(f=i),f<e&&(T=(e=f)+5+2+20,!0),m.upDetailContent.height(e)}else{if(!m.downDetailDiv){var n='<div class="detail_base" id="detail_base_'+m.conf.dom+'"><div class="detail_top"></div><div class="detail_content">'+c+"</div></div>";m.downDetailDiv=$(n).appendTo(v),m.downDetailContent=$(".detail_content",m.downDetailDiv),m.downArrowDiv=$(".detail_top",m.downDetailDiv)}m.downDetailContent.html(c),m.downDetailDiv.show(),m.downDetailContent.css("height",""),m.downDetailDiv.width(a);var e=A-5-2-20,i=m.downDetailContent.height();i<f&&(f=i),f<e&&(A=(e=f)+5+2+20,!0),m.downDetailContent.height(e)}}(),function(){var t={},e={};"left"==r?(t.left=C,t.left<0&&(t.left=0),t.left+a>x?i(t,e):e.left=5):"right"==r?(t.left=C,t.left<0?(t.left=0,e.left=D+C-5):t.left+a>x?i(t,e):e.left=a<D?a-9-5:D-9-5):(t.left=D<a?C-(a-D)/2:C+(D-a)/2,t.left<0?(t.left=0,e.left=(D+C)/2):e.left=(a-9)/2,
t.left+a>x&&i(t,e));t.top=E==h?b+y+P-5:b+y+5-T;E==h?(m.downDetailDiv.css("top",t.top),m.downDetailDiv.css("left",t.left),m.downArrowDiv.css("left",e.left)):(m.upDetailDiv.css("top",t.top),m.upDetailDiv.css("left",t.left),m.upArrowDiv.css("left",e.left));function i(t,e){t.left=x-a;var i=0;i=x<C+D?C-t.left+(x-C)/2-2:C-t.left+D/2,e.left=i}}(),E==h?(m.downDetailContent.unbind("mouseover").bind("mouseover",J),m.downDetailContent.unbind("mouseout").bind("mouseout",S),m.downDetailContent.unbind("click").bind("click",N)):(m.upDetailContent.unbind("mouseover").bind("mouseover",J),m.upDetailContent.unbind("mouseout").bind("mouseout",S),m.upDetailContent.unbind("click").bind("click",N))}}}}}}}function J(){m.hideGuidTimeout&&clearTimeout(m.hideGuidTimeout)}function S(){m.hideGuid(null,!0)}function N(){m.hideGuid()}},hideGuid:function(t,e){var i=this;if(t||!e){if(t){var n=t.attr("field");if(!n||"ck"==n)return void o()}this.hideGuidTimeout=setTimeout(o,100)}else o();function o(){
i.upDetailDiv&&i.upDetailDiv.hide(),i.downDetailDiv&&i.downDetailDiv.hide(),i.hideGuidTimeout=undefined}},insertEventAction:function(t,e,i){if({onClickRow:!0,onDblClickCell:!0,onClickCell:!0}[t]&&e){var n=this,o=n.getOptions()[t];this.bindEventAction(t,function(){!1===i?(o&&o(arguments),e.call(n,arguments)):(e.call(n,arguments),o&&o(arguments))},!0)}},gotoEnd:function(t){if(t&&t.createTextRange){var e=t.createTextRange();e.moveStart("character",t.value.length),e.collapse(!0),e.select()}},updateColumnTitle:function(t,e){if(t){var i={};i[t]=e,this.updateColumnsTitle(i)}},extendGridEditor:function(){var r=this;function c(t){if($.browser.safari&&t&&t.length)var e=t.parent("td"),i=setInterval(function(){if(e&&e.length){var t=$("#"+i,e);t.length?t.remove():$('<span id="'+i+'"></span>').appendTo(e)}else clearInterval(i)},500)}$.extend($.fn.datagrid.defaults.editors,{textfield:{onFocus:function(o,a){return function(){r.gotoEnd(o.com[0]),o.com.unbind("keydown"),o.com.bind("keydown",function(t){
if(13!=t.keyCode)return!0;var e=o.rowIndex,i=o.columnIndex,n={};return n.rowIndex=e,n.columnIndex=i,n.flag=!0,$(a).datagrid("acceptChanges",n),!0})}},onBlur:function(t){return function(){t.com.unbind("keydown")}},init:function(t,e,i){var n,o=r.generateId();n=$('<input type="text" id="'+o+'" />').appendTo(t);var a=$.extend({dom:o},e),s=new PJF.ui.textfield(a);return s.updateConf("onBlur",this.onBlur(s)),s.updateConf("onFocus",this.onFocus(s,i)),c(n),s},getValue:function(t){return t.getValue()},setValue:function(t,e,i,n){t.setValue(e),t.rowIndex=i,t.columnIndex=n},resize:function(t,e){}},select:{init:function(t,e){var i=r.generateId(),n=$('<span style="display:inline-block" id="'+i+'"></span>').appendTo(t),o=$.extend({dom:i},e);return c(n),new PJF.ui.select(o)},getValue:function(t){return $("div.autocomplete1").hide(),t.getSelectText()},setValue:function(t,i){var e=t.getAllOptions();$.each(e,function(t,e){e.desc===i&&(i=e.name)}),t.setSelectValue(i)},resize:function(t,e){}},dateinput:{
init:function(t,e){var i=r.generateId(),n=$('<input id="'+i+'" type="text" />').appendTo(t),o=$.extend({dom:i},e);return c(n),new PJF.ui.dateinput(o)},getValue:function(t){return t.getValue()},setValue:function(t,e){t.setValue(e)},resize:function(t,e){var i=t.com.next();1==$.boxModel?i.width(e-(input.outerWidth()-input.width())):i.width(e),i.children("input").width(i.width()-20)}},timespinner:{init:function(t,e){var i=r.generateId(),n=$('<input id="'+i+'" type="text" />').appendTo(t),o=$.extend({dom:i},e);return c(n),new PJF.ui.timespinner(o)},getValue:function(t){return t.getValue()},setValue:function(t,e){t.setValue(e)},resize:function(t,e){var i=t.com,n=i.parent();1==$.boxModel?n.width(e-(input.outerWidth()-input.width())-2):n.width(e),i.width(n.width()-20)}},autoComplete:{init:function(t,e){var i=r.generateId(),n=$('<input id="'+i+'" type="text" />').appendTo(t),o=$.extend({dom:i},e);return c(n),new PJF.ui.autoComplete(o)},getValue:function(t){return $("div.autocomplete1").hide(),
t.getSelectValue()},setValue:function(t,e){t.setDefaultValue(e)},resize:function(t,e){var i=t.com;1==$.boxModel?i.width(e-(input.outerWidth()-input.width())-2):i.width(e-2)}},numberSpinner:{init:function(t,e){var i=r.generateId(),n=$('<input id="'+i+'" type="text" />').appendTo(t),o=$.extend({dom:i},e);return c(n),new PJF.ui.numberSpinner(o)},getValue:function(t){return t.getValue()},setValue:function(t,e){t.setValue(e)},resize:function(t,e){var i=t.com,n=i.parent();1==$.boxModel?n.width(e-(input.outerWidth()-input.width())-2):n.width(e),i.width(n.width()-20)}}})},focusable:function(){return!0},focus:function(){var t;if((t=this.com.prev()).length&&t.hasClass("datagrid-view2")&&t.find("tr.datagrid-row:first").length)t.find("tr.datagrid-row:first").find("input[type=checkbox]:first").focus().trigger("mouseover");else{var e=this.com.parents("div.datagrid-view");e.attr("tabindex","-1"),e.focus()}}}),PJF.ui.gridUtil.createColumnMenu=function(e,t){
var i=$('<div id="'+t+'" style="width:100px;overflow:auto;"></div>').appendTo("body"),n=$("#"+e).datagrid("options").columns;if(2==n.length)return!1;for(var o=n[0],a=0,s=o.length;a<s;a++){var r=o[a];"ck"!=r.field&&$('<div iconCls="icon-ok" field=""/>').html(r.title||"checkbox").attr("field",r.field).appendTo(i)}return i.menu({onClick:function(t){if("icon-ok"==t.iconCls&&$("div.icon-ok",i).length<=1)return new PJF.ui.messageBox({title:"提示",content:"至少显示一列！"}),!1;"icon-ok"==t.iconCls?($("#"+e).datagrid("hideColumn",$(t.target).attr("field")),i.menu("setIcon",{target:t.target,iconCls:"icon-empty"})):($("#"+e).datagrid("showColumn",$(t.target).attr("field")),i.menu("setIcon",{target:t.target,iconCls:"icon-ok"}))}}),!0},PJF.ui.gridUtil.handleGridKeyboard=function(f){var t,e,i,n,o;switch(t=window.event||arguments.callee.caller.arguments[0],e=t.srcElement||t.target,i=t.which,t.shiftKey,console.log(e),i){case 13:n=f,(o=$(e).parents("tr.datagrid-row")).length&&o.trigger("mouseout"),
PJF.ui.componentMgr.getNextComp(n).focus();break;case 33:f.getPagerInfo().bb.prev.trigger("click");break;case 34:f.getPagerInfo().bb.next.trigger("click");break;case 107:!function(t,e){if("checkbox"==e.type){var i,n;return"header"==(i=$(e).attr("textContent"))?($(e).is(":checked")?$(e).removeAttr("checked"):$(e).attr("checked","checked"),$(e).triggerHandler("click")):"cell"==i&&((n=$(e).parent("div.datagrid-cell-check")).length&&n.trigger("click"))}}(0,e);break;case 38:case 40:!function(t,e,i,n){var o,a,s,r,c;if(o=i.type,c=$(i).attr("textContent"),"checkbox"===o&&c){if(r=1,38==e&&(r=-1),a=$(i).parents("tr.datagrid-row"),s=null,a.length){var l;if(r<0)if((l=a.prev())&&l.length)s=a,a=l;else u=(s=a).parents("div.datagrid-body"),d=u.prev(),a=$("tr.datagrid-header-row",d);else a=(s=a).next()}else{if(!(0<r))return PJF.ui.componentMgr.getPreviousComp(f).focus();var d,u;a=$(i).parents("tr.datagrid-header-row"),d=a.parents("div.datagrid-header"),u=d.next(),a=$("tr.datagrid-row:first",u)}var h,p
;if(a&&a.trigger("mouseover"),a&&a.length)s&&s.trigger("mouseout"),h=$("td:first",a),(p=$("input:checkbox",h))&&p.focus(),t.preventDefault();else s&&s.trigger("mouseout"),PJF.ui.componentMgr.getNextComp(f).focus();return}if($(i).hasClass("datagrid-view")){switch(e){case 38:PJF.ui.componentMgr.getPreviousComp(f).focus();break;case 40:PJF.ui.componentMgr.getNextComp(f).focus()}}}(t,i,e);break;default:return!1}return!0},PJF.ui.label=PJF.extend(PJF.ui.component,{init:function(t){var e,i;if(i=PJF_IS_WIDTH?PJF.constants.LABEL_LINE_FLAG:PJF.constants.LABEL_LINE_SMALL_FLAG,t.doms){var n=[],o=[];for(var a in t.doms){var s=$("#"+t.doms[a]);s.addClass("pjf_label"),s.width()<99&&(i=PJF.constants.LABEL_LINE_SMALL_FLAG),n.push(s),o.push(s.text())}this.com=n,e=o}else t.dom&&(this.com.addClass("pjf_label"),this.com.width()<99&&(i=PJF.constants.LABEL_LINE_SMALL_FLAG),e=this.com.text());t.doms&&t.values instanceof Array?(e=t.values,this.setLabel(e)):t.dom&&"string"==typeof t.value&&(e=t.value,
this.setLabel(e)),this.setLineHeight(e,i)},getStrLength:function(t){if(t){var e=t.replace(/[\u4e00-\u9fa5]/g,"");return 2*(t.length-e.length)+e.length}return 0},setLineHeight:function(t,e){var i=0;if(t instanceof Array&&this.com instanceof Array)for(var n in t)2*e+1<(i=this.getStrLength(t[n]))?(i==2*(e+1)+1||i==2*(e+1)+2?("*"!=this.com[n].find("span").text()&&"*"!=this.com[n].find("a").text()?t[n]=t[n].replace("*","<span>*</span>"):t[n]=this.com[n].html(),this.com[n].html("　　"+t[n])):i==2*(e+2)+1&&("*"!=this.com[n].find("span").text()&&"*"!=this.com[n].find("a").text()?t[n]=t[n].replace("*","<span>*</span>"):t[n]=this.com[n].html(),this.com[n].html("　"+t[n])),this.com[n].css("line-height","12px").find("span").css("line-height","12px")):this.com[n].css("line-height","").find("span").css("line-height","");else 2*e+1<(i=this.getStrLength(t))?(i==2*(e+1)+1||i==2*(e+1)+2?(t="*"!=this.com.find("span").text()&&"*"!=this.com.find("a").text()?t.replace("*","<span>*</span>"):this.com.html(),
this.com.html("　　"+t)):i==2*(e+2)+1&&(t="*"!=this.com.find("span").text()&&"*"!=this.com.find("a").text()?t.replace("*","<span>*</span>"):this.com.html(),this.com.html("　"+t)),this.com.css("line-height","12px").find("span").css("line-height","12px")):this.com.css("line-height","").find("span").css("line-height","")}}),PJF.apply(PJF.ui.label.prototype,{setKey:function(){},setStyle:function(t,e){if(this.com instanceof Array)for(var i in this.com)this.com[i].css(t,e);else this.com.css(t,e)},setLabel:function(t){var e=1==PJF_IS_WIDTH?PJF.constants.LABEL_LINE_FLAG:PJF.constants.LABEL_LINE_SMALL_FLAG;if(t instanceof Array&&this.com instanceof Array)for(var i in t)this.com[i].html(t[i]);else this.com.html(t);this.setLineHeight(t,e)},getValue:function(){if(this.com instanceof Array){var t=[];for(var e in this.com){var i={};i.id=this.com[e].attr("id"),i.value=this.com[e].html(),t.push(i)}return t}return this.com.html()},getClassName:function(){return"PJF.ui.label"},destroy:function(){
if(this.com instanceof Array)for(var t=0;t<this.com.length;t++)this.com[t].remove(),this.com[t]=null;else this.com.remove(),this.com=null;PJF.ui.componentMgr.remove(this.id)},show:function(){this.com.show(),this.showflag=!0},hide:function(){this.com.hide(),this.showflag=!1},display:function(t){t&&this.show()},isDisplay:function(){return this.showflag},isReadOnly:function(){return!0}}),PJF.ui.linkButton=PJF.extend(PJF.ui.component,{dom:null,hasClicked:!1,init:function(t){this.createButton(t)},focusable:function(){return!this.isDisabled()},focus:function(){this.com.trigger("mouseover"),this.com.focus()},focusCallBack:function(t){this.com.focus(),t.call()},onFocus:function(t){this.p.onFocusCallBack=t},createButton:function(t){var e={dom:t.dom,text:t.name,iconCls:t.iconCls||"icon-default",disabled:t.disable||t.disabled,handler:t.onclick,plain:!1,isRepeat:"undefined"==typeof t.isRepeat||t.isRepeat,style:t.style||"default",delayTime:t.delayTime||1e3,align:t.align,width:t.width,
textAlign:t.textAlign,miniBtn:t.miniBtn,reValiDateDom:t.reValiDateDom,appendClass:t.appendClass,keyCode:t.keyCode,ctrlFlag:t.ctrlFlag,shiftFlag:t.shiftFlag,onEnterClick:t.onEnterClick,onFocusCallBack:t.onFocus};this.p=e,this.changeStyle(t,e),0<this.com.length&&this.regClickHandler(this,e),e.disabled&&0<this.com.length&&this.disable(),"icon-default"!=e.iconCls&&this.addPNGFilter(),this.addKeyborardControl(this),this.helpTip=null,t.helpTip&&this.setHelpTip(t.helpMessage)},setHelpTip:function(t,e){if(!1===e)this.helpTip&&this.helpTip.destroy(),this.helpTip=null;else if(this.helpTip)this.helpTip.setHelpMsg(t);else{var i="btn_tip_"+PJF.util.generateUUid();this.com.after('<span id="'+i+'"></span>'),this.helpTip=new PJF.ui.helpTip({dom:i,helpMessage:t||""})}},regClickHandler:function(e,i){e.com.unbind("click");var t=function(t){console.log("当前按钮状态:"+e.isDisabled()+",是否有loading:"+window.PJF_HAS_LOADING),
e.isDisabled()||window.PJF_HAS_LOADING?console.log("当前按钮不可用或者有loading"):(i.isRepeat||e.disable(),i.handler&&(i.handler.call(e,t),i.isRepeat||setTimeout(function(){e.enable()},i.delayTime)),t.stopPropagation())};e.com.click(t),i.keyCode!==undefined&&PJF.hotKeyManager.addHotKeyListener(i.keyCode,t,i.ctrlFlag,i.shiftFlag)},bindClickHandler:function(t){this.p.handler=t},addLRControl:function(i){i.com.focus(function(){i.com.trigger("mouseover"),i.com.bind("keydown",function(t){switch(t.keyCode){case 37:return 0<(e=$(i.com).prev()).length&&e.focus(),!1;case 39:var e;return 0<(e=$(i.com).next()).length&&e.focus(),!1}})}),i.com.blur(function(){i.com.trigger("mouseout"),i.com.unbind("keydown")}),i.com.attr("tabindex","0")},addKeyborardControl:function(i){i.com.focus(function(){i.com.trigger("mouseover"),i.p.onFocusCallBack&&i.p.onFocusCallBack.call(i)}),i.com.blur(function(){var t;if((i.com.trigger("mouseout"),PJF.constants.KEYBOARD_ENABLE&&i.p.reValiDateDom)&&!(t=i.p.reValiDateDom,
void PJF.ui.componentMgr.get(t)))return}),i.com.attr("tabindex","0"),PJF.constants.KEYBOARD_ENABLE&&i.com.unbind("keydown").bind("keydown",function(t){if(107==t.which)return i.isDisabled()||window.PJF_HAS_LOADING?console.log("当前按钮不可用或者有loading"):(i.p.handler&&i.p.handler.call(i),t.preventDefault()),!0;if(13==t.which||40==t.which){if(i.onEnterClick)return void i.onEnterClick();try{PJF.ui.componentMgr.getNextComp(i).focus()}catch(e){console.error(e.message)}}else if(38==t.which)try{PJF.ui.componentMgr.getPreviousComp(i).focus()}catch(e){console.error(e.message)}}),PJF.constants.KEYBOARD_NEW_ENABLE&&i.com.unbind("keydown").bind("keydown",function(t){if(13==t.which)return i.isDisabled()||window.PJF_HAS_LOADING?console.log("当前按钮不可用或者有loading"):(i.p.handler&&i.p.handler.call(i),t.preventDefault()),!0;if(9==t.which){if(i.onEnterClick)return void i.onEnterClick();try{PJF.ui.componentMgr.getNextComp(i).focus()}catch(e){console.error(e.message)}t.stopImmediatePropagation(),t.preventDefault()}})
},addSpace:function(t){t.text&&2==t.text.length&&(t.text=t.text.slice(0,1)+" "+t.text.slice(1))},changeStyle:function(t,e){if(this.p||(this.p=e),this.addSpace(e),this.contactClassNames(e),0<this.com.length)this.com.pjfLinkButton(e);else{if(!t.renderTo)return void alert("提示：未获取到Id为"+t.dom+"的元素且renderTo为空！");if($("#"+t.renderTo).append("<span id='"+t.dom+"' ></span>"),this.com=$("#"+t.dom),this.com.length<1)return void alert("提示：追加Id为"+t.dom+"的元素失败！");this.com.pjfLinkButton(e)}var i=this.com;i[0].className=this._classNames.defStatus.left+" linkBtn_margin",i[0].firstChild.className=this._classNames.defStatus.middle,$(i[0].firstChild).find("span:last")[0].className+=" "+this._classNames.defStatus.right,t.align&&this.com.css("float",t.align),this.addHoverHandler(t),this.additionalOperation()},contactClassNames:function(t){if(this._defaultClassNames=PJF.constants.PJF_LINKBUTTON_STYLE["default"],this._baseClassNames=PJF.constants.PJF_LINKBUTTON_STYLE[t.style],this._classNames={},
this._baseClassNames&&"default"!=t.style)for(var e in this._defaultClassNames)for(var i in this._classNames[e]={},this._defaultClassNames[e])this._classNames[e][i]="",this._classNames[e][i]=this._baseClassNames[e][i]+" "+this._defaultClassNames[e][i];else this._classNames=this._defaultClassNames},addHoverHandler:function(t){var e=this,i=this.com;this.com.bind("mouseover",function(){i[0].className+=" "+e._classNames.hover.left,i[0].firstChild.className+=" "+e._classNames.hover.middle,$(i[0].firstChild).find("span:last")[0].className+=" "+e._classNames.hover.right}),this.com.bind("mouseout",function(){$(i[0]).removeClass(e._classNames.hover.left),$(i[0].firstChild).removeClass(e._classNames.hover.middle),$(i[0].firstChild).find("span:last").removeClass(e._classNames.hover.right)})},addPNGFilter:function(){var t="Microsoft Internet Explorer"==navigator.appName&&4==parseInt(navigator.appVersion)&&-1!=navigator.appVersion.indexOf("MSIE 6.0");if(jQuery.browser.msie&&t){
var e=this.com.find(".appendImage");if(e.length){var i=e.css("background-image");if("none"!=i){var n=i.split('url("')[1].split('")')[0];e.get(0).runtimeStyle&&(e.css("background-image","none"),e.get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+n+"',sizingMethod='scale')")}}}},getClassName:function(){return"PJF.ui.linkButton"},additionalOperation:function(){var t=this.p;if(t.width){var e=this.com,i=0;(i="icon-default"!=t.iconCls?t.width-20-16-5:t.width-20)<20&&(new PJF.ui.messageBox({style:"warning",closable:!1,title:"宽度过小",content:"错误：按钮宽度设置过小，按钮名称："+t.text}),i=40);var n=$($(e[0].firstChild).find("span:last")[0]),o=t.textAlign?t.textAlign:"left";"queue"==t.style&&!0===t.miniBtn&&(i=t.width-6,o=t.textAlign?t.textAlign:"center"),n.width(i),n.css("text-align",o)}t.appendClass&&this.com.removeClass(t.appendClass).addClass(t.appendClass)},triggerBtnHandler:function(){this.isDisabled()||this.p.handler&&this.p.handler.call(this)}}),
PJF.apply(PJF.ui.linkButton.prototype,{isReadyOnly:function(){return!1},isDisplay:function(){return!1!==this.visibleStatus},disable:function(){var t=this.com;this.com.pjfLinkButton({disabled:!0,text:this.p.text}),t[0].className=this._classNames.disable.left+" linkBtn_margin",t[0].firstChild.className=this._classNames.disable.middle,$(t[0].firstChild).find("span:last")[0].className+=" "+this._classNames.disable.right,this.addPNGFilter(),this.additionalOperation(),this.disableStatus=!0},enable:function(){var t=this.com;this.com.pjfLinkButton({disabled:!1,text:this.p.text}),t[0].className=this._classNames.defStatus.left+" linkBtn_margin",t[0].firstChild.className=this._classNames.defStatus.middle,$(t[0].firstChild).find("span:last")[0].className+=" "+this._classNames.defStatus.right,this.addPNGFilter(),this.additionalOperation(),this.disableStatus=!1},setPlain:function(t){},setVisible:function(t){t?(this.com.show(),this.visibleStatus=!0):(this.com.hide(),this.visibleStatus=!1)},
getValue:function(){return this.com.pjfLinkButton("options")},updateButtonText:function(t){var e=this.com.find("span.l-btn-text");e.length<1?alert("Error:未找到文本节点！"):(e.text(t),this.p.text=t)},getButtonText:function(){var t=this.com.find("span.l-btn-text");if(!(t.length<1))return t.text();alert("Error:未找到文本节点！")},isDisabled:function(){return this.com.pjfLinkButton("options").disabled},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com.off(),this.com=null},validateParam:function(t){return t.renderTo?document.getElementById(t.renderTo)?!!t.dom||(alert("提示：linkButton的dom属性不能为空！"),!1):(alert("提示：linkButton的renderTo属性 "+t.renderTo+" 指定的容器不存在！"),!1):t.dom?document.getElementById(t.dom)?(this.dom=t.dom,!0):(alert("提示：linkButton的dom属性 "+t.dom+" 指定的容器不存在！"),!1):(alert("提示：linkButton的dom属性不能为空！"),!1)}}),PJF.constants.PJF_LINKBUTTON_STYLE={"default":{defStatus:{left:"pjf_linkBtn_left",middle:"pjf_linkBtn",right:"pjf_linkBtn_right"},hover:{
left:"pjf_linkBtn_left_over",middle:"pjf_linkBtn_over",right:"pjf_linkBtn_right_over"},disable:{left:"pjf_linkBtn_disable_left",middle:"pjf_linkBtn_disable",right:"pjf_linkBtn_disable_right"}},assistant:{defStatus:{left:"pjf_linkBtn_assistant_left",middle:"pjf_linkBtn_assistant",right:"pjf_linkBtn_assistant_right"},hover:{left:"pjf_linkBtn_assistant_left_over",middle:"pjf_linkBtn_assistant_over",right:"pjf_linkBtn_assistant_right_over"},disable:{left:"pjf_linkBtn_assistant_disable_left",middle:"pjf_linkBtn_assistant_disable",right:"pjf_linkBtn_assistant_disable_right"}},loginBtn:{defStatus:{left:"pjf_linkBtn_loginBtn_left",middle:"pjf_linkBtn_loginBtn",right:"pjf_linkBtn_loginBtn_right"},hover:{left:"pjf_linkBtn_loginBtn_left_over",middle:"pjf_linkBtn_loginBtn_over",right:"pjf_linkBtn_loginBtn_right_over"},disable:{left:"pjf_linkBtn_loginBtn_disable_left",middle:"pjf_linkBtn_loginBtn_disable",right:"pjf_linkBtn_loginBtn_disable_right"}},queue:{defStatus:{left:"pjf_linkBtn_queue_left",
middle:"pjf_linkBtn_queue",right:"pjf_linkBtn_queue_right"},hover:{left:"pjf_linkBtn_queue_left_over",middle:"pjf_linkBtn_queue_over",right:"pjf_linkBtn_queue_right_over"},disable:{left:"pjf_linkBtn_queue_disable_left",middle:"pjf_linkBtn_queue_disable",right:"pjf_linkBtn_queue_disable_right"}}},PJF.constants.ICONCLS_MAP={"icon-add":"linkbtn_icon_add","icon-del":"linkbtn_icon_del","icon-save":"linkbtn_icon_save","icon-ivr":"linkbtn_icon_ivr","icon-modify":"linkbtn_icon_modify","icon-export":"linkbtn_icon_export","icon-import":"linkbtn_icon_import","icon-jump":"linkbtn_icon_jump","icon-next":"linkbtn_icon_next","icon-prev":"linkbtn_icon_prev","icon-quit":"linkbtn_icon_quit","icon-refresh":"linkbtn_icon_refresh","icon-submit":"linkbtn_icon_submit","icon-success":"linkbtn_icon_success","icon-back":"linkbtn_icon_back","icon-cancel":"linkbtn_icon_canel","icon-confirm":"linkbtn_icon_confirm","icon-err":"linkbtn_icon_error","icon-help":"linkbtn_icon_help","icon-print":"linkbtn_icon_print",
"icon-redo":"linkbtn_icon_redo","icon-undo":"linkbtn_icon_undo","icon-search":"linkbtn_icon_search","icon-pause":"linkbtn_icon_pause","icon-restart":"linkbtn_icon_restart","icon-validate":"linkbtn_icon_validate","icon-saveAs":"linkbtn_icon_saveAs","icon-reset":"linkbtn_icon_reset","icon-apply":"linkbtn_icon_apply","icon-verify":"linkbtn_icon_verify","icon-editable":"linkbtn_icon_editable","icon-uneditable":"linkbtn_icon_uneditable","icon-edit":"icon-edit","icon-remove":"icon-remove","icon-cut":"icon-cut","icon-ok":"icon-ok","icon-no":"icon-no","icon-reload":"icon-reload","icon-return":"icon-return"},PJF.ui.messageBox=PJF.extend(PJF.ui.component,{init:function(e){var t=e.buttonText,i=e.style||"info";if(e.useIframe=e.useIframe,t){if(!(t instanceof Array))return alert(resource.MESSAGEBOX_BUTTONTEXT_TYPE_NOARRAY),!1;if(1==t.length)$.messager.defaults={ok:e.buttonText[0],cancel:resource.MESSAGER_DEFAULTS_CANCEL};else if(2==t.length)$.messager.defaults={ok:t[0],cancel:t[1]
};else if(2<t.length||0==t.length)return alert(resource.MESSAGEBOX_BUTTONTEXT_LENGTH),!1}else $.messager.defaults={ok:resource.MESSAGER_DEFAULTS_OK,cancel:resource.MESSAGER_DEFAULTS_CANCEL};if("warning"==i?(this.box=$.messager.alert(e.title,e.content,"warning",e.fn),this.box&&0==e.closable&&this.box.parent().find(".panel-tool").remove()):"success"==i||"alert"==i?(this.box=$.messager.alert(e.title,e.content,"success",e.fn),this.box&&0==e.closable&&this.box.parent().find(".panel-tool").remove()):"info"==i?(this.box=$.messager.alert(e.title,e.content,"info",e.fn),this.box&&0==e.closable&&this.box.parent().find(".panel-tool").remove()):"confirm"==i&&(this.box=$.messager.confirm(e.title,e.content,e.icon,function(t){t?e.ok instanceof Function&&e.ok():e.cancel instanceof Function&&e.cancel()}),this.box&&0==e.closable&&this.box.parent().find(".panel-tool").remove()),
e.useIframe&&$.browser.msie&&0<top.$(".window-mask").length&&top.$(".window-mask").append("<iframe  width="+window.screen.width+" height="+window.screen.height+' style="display :inline;  position: absolute; z-index: -1; scrolling:no;filter:alpha(opacity=0);" frameborder="0"></iframe>'),"6.0"==$.browser.version&&$(".messager-window").each(function(){$(this).bgiframe()}),e.buttonText){for(var n=this.box,o=this.box.find(".messager-button"),a=this.box.find(".l-btn-text"),s=[],r="",c={okBtnIcos:"icon-confirm",cancelBtnIcos:"icon-cancel"},l=0;l<a.length;l++)s.push($(a[l]).text());this.box.find(".pjf_linkBtn_left").remove();for(var d="mesOkBtn"+(p=(new Date).getTime()),u="mesCanBtn"+p,h=0;h<s.length;h++)0==h?$("<a id="+d+"></a>").appendTo(o):$("<a id="+u+"></a>").appendTo(o);$("#mesOkBtn")&&s[0]&&(e.buttonIconCls&&e.buttonIconCls[0]?r=e.buttonIconCls[0]:s[0].toLowerCase()==resource.MESSAGER_DEFAULTS_OK.toLowerCase()&&(r=c.okBtnIcos),this.mesOkBtn=new PJF.ui.linkButton({dom:d,name:s[0],
iconCls:r,onclick:function(t){n.window("close"),e.ok instanceof Function&&e.ok(),e.fn instanceof Function&&e.fn()}})),$("#mesCanBtn")&&s[1]&&(r=e.buttonIconCls&&e.buttonIconCls[1]?e.buttonIconCls[1]:s[1].toLowerCase()==resource.MESSAGER_DEFAULTS_CANCEL.toLowerCase()?c.cancelBtnIcos:"",this.mesCanBtn=new PJF.ui.linkButton({dom:u,name:s[1],iconCls:r,onclick:function(){n.window("close"),e.cancel instanceof Function&&e.cancel()}}))}if(PJF.constants.KEYBOARD_ENABLE||PJF.constants.KEYBOARD_NEW_ENABLE){for(n=this.box,o=this.box.find(".messager-button"),a=this.box.find(".l-btn-text"),s=[],r="",c={okBtnIcos:"icon-confirm",cancelBtnIcos:"icon-cancel"},l=0;l<a.length;l++)s.push($(a[l]).text());this.box.find(".pjf_linkBtn_left").remove();var p;for(d="mesOkBtn"+(p=(new Date).getTime()),u="mesCanBtn"+p,h=0;h<s.length;h++)0==h?$("<a id="+d+"></a>").appendTo(o):$("<a id="+u+"></a>").appendTo(o);$("#mesOkBtn")&&s[0]&&(s[0].toLowerCase()==resource.MESSAGER_DEFAULTS_OK.toLowerCase()&&(r=c.okBtnIcos),
this.mesOkBtn=new PJF.ui.linkButton({dom:d,name:s[0],iconCls:r,onclick:function(t){n.window("close"),e.ok instanceof Function&&e.ok(),e.fn instanceof Function&&e.fn()}})),$("#mesCanBtn")&&s[1]&&(s[1].toLowerCase()==resource.MESSAGER_DEFAULTS_CANCEL.toLowerCase()&&(r=c.cancelBtnIcos),this.mesCanBtn=new PJF.ui.linkButton({dom:u,name:s[1],iconCls:r,onclick:function(){n.window("close"),e.cancel instanceof Function&&e.cancel()}}));var f=this;f.mesOkBtn&&setTimeout(function(){f.mesOkBtn.focusCallBack(function(){$("#"+d).bind("keydown",function(t){switch(t.keyCode){case 13:f.mesCanBtn&&f.mesCanBtn.focusCallBack(function(){$("#"+u).bind("keydown",function(t){switch(t.keyCode){case 13:f.mesOkBtn&&f.mesOkBtn.focus();break;case 78:n.window("close"),PJF.ui.componentMgr.getCurrentCom()&&PJF.ui.componentMgr.getCurrentCom().focus&&setTimeout(function(){PJF.ui.componentMgr.getCurrentCom().focus()},200),e.cancel instanceof Function&&e.cancel()}})});break;case 43:
PJF.constants.KEYBOARD_ENABLE&&(n.window("close"),PJF.ui.componentMgr.getCurrentCom()&&PJF.ui.componentMgr.getCurrentCom().focus()&&setTimeout(function(){PJF.ui.componentMgr.getCurrentCom().focus()},200),e.ok instanceof Function&&e.ok(),e.fn instanceof Function&&e.fn());break;case 78:f.mesCanBtn&&PJF.constants.KEYBOARD_ENABLE&&(n.window("close"),PJF.ui.componentMgr.getCurrentCom()&&PJF.ui.componentMgr.getCurrentCom().focus&&setTimeout(function(){PJF.ui.componentMgr.getCurrentCom().focus()},200),e.cancel instanceof Function&&e.cancel());break;case 89:PJF.constants.KEYBOARD_ENABLE&&(n.window("close"),PJF.ui.componentMgr.getCurrentCom()&&setTimeout(function(){PJF.ui.componentMgr.getPreviousComp(PJF.ui.componentMgr.getCurrentCom()).focus()},200),e.ok instanceof Function&&e.ok(),e.fn instanceof Function&&e.fn());break;case 27:n.window("close"),PJF.ui.componentMgr.getCurrentCom()&&setTimeout(function(){PJF.ui.componentMgr.getPreviousComp(PJF.ui.componentMgr.getCurrentCom()).focus()},200),
e.ok instanceof Function&&e.ok(),e.fn instanceof Function&&e.fn()}})})},100)}this.addPNGFilter("messager-icon"),this.addPNGFilter("appendImage"),this.box&&this.box.css("word-wrap","break-word")},addPNGFilter:function(t,e){var i="Microsoft Internet Explorer"==navigator.appName&&4==parseInt(navigator.appVersion)&&-1!=navigator.appVersion.indexOf("MSIE 6.0");if(jQuery.browser.msie&&i){var n;t?n=this.box.find("."+t):e&&(n=this.box.find("[class^="+e+"]"));for(var o=0;o<n.length;o++){var a=$(n[o]),s=a.css("background-image");if("none"!=s){var r=s.split('url("')[1].split('")')[0];a.get(0).runtimeStyle&&(a.css("background-image","none"),a.get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+r+"',sizingMethod='srop')")}}}},setContent:function(t){this.box.find("div.messager-icon").next().html(t)},close:function(){var t=this.box.parent();t.next().next().remove(),t.next().remove(),t.remove(),this.box=null,this.params=null,this.id=null},getClassName:function(){
return"PJF.ui.messageBox"}}),PJF.ui.navigation=PJF.extend(PJF.ui.component,{init:function(t){if(t)return this.com.navigation(t)},destroy:function(){if(this.com){for(var t=this.com.attr("id")+"_a",e=this.com.find("[id^="+t+"]"),i=0;i<e.length;i++){var n=$(e[i]).attr("id");$("#"+n).die("click")}this.com.children().remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null}}}),PJF.apply(PJF.ui.navigation.prototype,{setNavigation:function(t,e){return this.com.data("navigation").setNavigation(t,e)},setChildNavigation:function(t,e){return this.com.data("navigation").setChildNavigation(t,e)},setUndo:function(t){this.setNavigation(t,"undo")},setDone:function(t){this.setNavigation(t,"done")},setDoing:function(t){this.setNavigation(t,"doing")},setChildUndo:function(t){this.setChildNavigation(t,"childUndo")},setChildDone:function(t){this.setChildNavigation(t,"childDone")},setChildDoing:function(t){this.setChildNavigation(t,"childDoing")},getClassName:function(){
return"PJF.ui.navigation"}}),PJF.ui.panel=PJF.extend(PJF.ui.component,{openFlag:!1,init:function(i){this.content=$("#"+this.dom).html(),i&&i.queryParams&&PJF.communication.cpsJsonReq({jsonData:PJF.util.json2str(i.queryParams.jsonData),fwServiceId:i.queryParams.fwServiceId,fwTranId:i.queryParams.fwTranId,url:i.queryParams.url,async:!1,success:function(t){var e=t.tipMessage;i.formatter?i.tipMessage=i.formatter(e):i.tipMessage=e},failure:function(t){i.tipMessage=null}}),(i.tipMessage||i.queryParams)&&(i.iconCls="icon-tip-info");var t=i.onLoad;i.onLoad=function(){t&&t(),PJF.html.borderFix()},this.initPanel(i),i.tipMessage&&this.showTip(i)},showTip:function(t){var e=$("div.pjfPanel-header").find("div.pjfPanel-title"),i=($(e).offset().left,$(e).offset().top);if(1!=$(this).find(".free_tip_panel").length){var n=this.com.siblings("div.free_tip_panel");t&&t.tipWidth&&n.css("width",t.tipWidth);var o=n.width()-33
;this.com.siblings("div.free_tip_panel").children("div.free_tip_content").find("span.free_tip_up").width(o),i>n.height()+10?(n.css("top",-(n.height()+10)),n.find(".free_tip_arrow").addClass("free_tip_arrow_down")):(n.css("top","30px"),n.find(".free_tip_arrow").addClass("free_tip_arrow_up")),n.find("span.free_tip_with_icon").addClass("free_tip_close_icon").bind("click",function(){n.addClass("free_tip_panle_hide")}),this.bindClickEvent(n)}},bindClickEvent:function(e){$("div.pjfPanel-icon").bind("click",function(t){e.hasClass("free_tip_panle_hide")?e.addClass("free_tip_panle_show").removeClass("free_tip_panle_hide"):e.addClass("free_tip_panle_hide").removeClass("free_tip_panle_show")})},initPanel:function(t){t.url&&(t.url=PJF.i18n.addUrli18n(t.url)),this.com.pjfPanel({width:t.width||"auto",height:t.height||"auto",title:t.title,collapsible:t.collapsible===undefined||t.collapsible,collapsed:t.collapsed,href:t.url,cache:t.cache,closable:t.closable,content:t.content,onLoad:t.onLoad,
onCollapse:t.onCollapse,onExpand:function(){t.onExpand&&t.onExpand(),this.openFlag||(this.openFlag=!0,t.onOpen&&t.onOpen())},left:t.left,top:t.top,fit:t.fit,onClose:t.onClose,tipMessage:t.tipMessage,iconCls:t.iconCls,onBeforeClose:t.onBeforeClose}),!1===t.collapsible&&this.com.pjfPanel("header").css("cursor","default")},destroy:function(){this.com.removeAttr("class").removeAttr("title").removeAttr("style").children().remove(),this.com.empty(),$("#"+this.dom).html(this.content),this.com.clone().insertAfter(this.com.parent()),this.com.parent().remove(),this.content=null,this.com=null,this.params=null,this.id=null},newDestroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.destroy()},setTipMessage:function(t,e){
this.com.parent().children("div.free_tip_panel").find("span.free_tip_up").html(t),this.com.siblings("div.free_tip_panel").removeClass("free_tip_panle_hide"),t&&e&&this.com.parent().children("div.free_tip_panel").css("width",e),this.showTip()}}),PJF.apply(PJF.ui.panel.prototype,{setTitle:function(t){this.com.pjfPanel("setTitle",t)},expand:function(){this.com.pjfPanel("expand")},collapse:function(){this.com.pjfPanel("collapse")},validateParam:function(t){return t.dom?(this.dom=t.dom,!0):(alert(resource.PANEL_VALIDATEPARM_INFO),!1)},setUrl:function(t,e,i){t&&(t=PJF.i18n.addUrli18n(t)),0==i?this.com.pjfPanel({href:t,isRefresh:!1,onLoad:e}):this.com.pjfPanel({href:t,isRefresh:!0,onLoad:e})},reLoad:function(t){this.com.pjfPanel(t)},display:function(t){t?$("#"+this.dom).parent().show():$("#"+this.dom).parent().hide()},resize:function(t){this.com.pjfPanel("resize",t)},getClassName:function(){return"PJF.ui.panel"},isCollapsed:function(){
return 1<this.com.parent().find("div.pjfPanel-header .pjfPanel-tool a").attr("class").split(" ").length}}),PJF.ui.checkbox=PJF.extend(PJF.ui.component,{init:function(c){var l;if((l=this).handler=c.handler,l.onChange=c.onChange,c.missingMessage?l.missingMessage=c.missingMessage:l.missingMessage=resource.SELECT_MISSING_MSG,l.required=c.required,this.__readonly=!1,this.__disabled=!1,c&&c.url)PJF.communication.ajax({url:c.url,async:!1,type:c.type,success:function(t){var e,i=t.values,n=t.labels,o=t.name,a=t.count||3;if(e=l.generateDom(o,i,n,a,c.labelLen),l.com.append(e),c.selected)for(var s=0;s<c.selected.length;s++)l.com.find("input").eq(c.selected[s]-1).attr("checked","checked");if(c.defaultValue){var r=c.defaultValue.length;for(s=0;s<r;s++)l.com.find("input[value='"+c.defaultValue[s]+"']").attr("checked","checked")}(c.handler&&$("#"+c.dom).find("input").each(function(){$(this).live("click",function(){var t=$(this).val();c.handler(t)})}),
c.required)&&(0==$("#"+c.dom).find("input:checked").length&&$("#"+c.dom).attr("error",l.missingMessage),$("#"+c.dom).find("input").each(function(){$(this).live("click",function(){var t=!1;$("#"+c.dom).find("input").each(function(){$(this).attr("checked")&&(t=!0)}),t?l.com.checkTip({show:function(){return!0}}):l.com.checkTip({show:function(){return!1},Message:c.missingMessage})})}));c.onChange&&$("#"+c.dom).find("input").each(function(){$(this).live("click",function(){var t=$(this).val();c.onChange(t)})}),PJF.constants.KEYBOARD_ENABLE?$("#"+c.dom).find("input").each(function(t){$(this).unbind("checkfocus").bind("focus.checkfocus",function(){$(this).parent().css("height","22px").addClass("focus-border")}),$(this).unbind("checkblur").bind("blur.checkblur",function(){$(this).parent().removeClass("focus-border")}),$(this).live("click",function(){$(this).focus()});var i=t;$(this).keydown(function(t){switch(t.keyCode){case 43:case 107:
if($(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked"),c.required)$("#"+c.dom).find("input:checked").length?l.com.checkTip({show:function(){return!0}}):l.com.checkTip({show:function(){return!1},Message:c.missingMessage});break;case 13:if($(this).blur(),i<c.labels.length-1)$("#"+c.dom).find("input[type='checkbox']").eq(i+1).focus();else(e=PJF.ui.componentMgr.getNextComp(l)).focus!=undefined&&e.focus instanceof Function&&e.focus();break;case 38:var e;if($(this).blur(),0<i)$("#"+c.dom).find("input[type='checkbox']").eq(i-1).focus();else(e=PJF.ui.componentMgr.getPreviousComp(l)).focus!=undefined&&e.focus instanceof Function&&e.focus()}c.handler instanceof Function&&c.handler($(this).val()),t.stopImmediatePropagation(),t.preventDefault()})}):PJF.constants.KEYBOARD_NEW_ENABLE&&$("#"+c.dom).find("input").each(function(t){$(this).unbind("checkfocus").bind("focus.checkfocus",function(){$(this).parent().css("height","22px").addClass("focus-border")}),
$(this).unbind("checkblur").bind("blur.checkblur",function(){$(this).parent().removeClass("focus-border")}),$(this).live("click",function(){$(this).focus()});var i=t;$(this).keydown(function(t){switch(t.keyCode){case 9:if($(this).blur(),i<c.labels.length-1)$("#"+c.dom).find("input[type='checkbox']").eq(i+1).focus();else{var e=PJF.ui.componentMgr.getNextComp(l);e.focus!=undefined&&e.focus instanceof Function&&e.focus()}break;case 13:if($(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked"),c.required)$("#"+c.dom).find("input:checked").length?l.com.checkTip({show:function(){return!0}}):l.com.checkTip({show:function(){return!1},Message:c.missingMessage})}c.handler instanceof Function&&c.handler($(this).val()),t.stopImmediatePropagation(),t.preventDefault()})}),c.readonly&&l.setReadOnly(!0),l.com.addClass("validatebox-checkbox")}});else{if($("#"+c.dom).hasClass("validatebox-checkbox"))return;var t,e=c.count||3
;if(t=l.generateDom(c.name,c.values,c.labels,e,c.labelLen),l.com.append(t),c.alignable&&l.reRenderDom(l),c.selected)for(var i=0;i<c.selected.length;i++)this.com.find("input").eq(c.selected[i]-1).attr("checked","checked");if(c.defaultValue){var n=c.defaultValue.length;for(i=0;i<n;i++)this.com.find("input[value='"+c.defaultValue[i]+"']").attr("checked","checked")}if(c.handler&&$("#"+c.dom).find("input").each(function(){$(this).live("click",function(){var t=$(this).val();c.handler(t)})}),c.onChange&&$("#"+c.dom).find("input").each(function(){$(this).live("click",function(){var t=$(this).val();c.onChange(t)})}),PJF.constants.KEYBOARD_ENABLE?$("#"+c.dom).find("input").each(function(t){$(this).unbind("checkfocus").bind("focus.checkfocus",function(){$(this).parent().css("height","22px").addClass("focus-border")}),$(this).unbind("checkblur").bind("blur.checkblur",function(){$(this).parent().removeClass("focus-border")}),$(this).live("click",function(){$(this).focus()});var i=t
;$(this).keydown(function(t){switch(t.keyCode){case 43:case 107:if($(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked"),c.required)$("#"+c.dom).find("input:checked").length?l.com.checkTip({show:function(){return!0}}):l.com.checkTip({show:function(){return!1},Message:c.missingMessage});break;case 13:if($(this).blur(),i<c.labels.length-1)$("#"+c.dom).find("input[type='checkbox']").eq(i+1).focus();else(e=PJF.ui.componentMgr.getNextComp(l)).focus!=undefined&&e.focus instanceof Function&&e.focus();break;case 38:var e;if($(this).blur(),0<i)$("#"+c.dom).find("input[type='checkbox']").eq(i-1).focus();else(e=PJF.ui.componentMgr.getPreviousComp(l)).focus!=undefined&&e.focus instanceof Function&&e.focus()}c.handler instanceof Function&&c.handler($(this).val()),t.stopImmediatePropagation(),t.preventDefault()})}):PJF.constants.KEYBOARD_NEW_ENABLE&&$("#"+c.dom).find("input").each(function(t){$(this).unbind("checkfocus").bind("focus.checkfocus",function(){
$(this).parent().css("height","22px").addClass("focus-border")}),$(this).unbind("checkblur").bind("blur.checkblur",function(){$(this).parent().removeClass("focus-border")}),$(this).live("click",function(){$(this).focus()});var i=t;$(this).keydown(function(t){switch(t.keyCode){case 9:if($(this).blur(),i<c.labels.length-1)$("#"+c.dom).find("input[type='checkbox']").eq(i+1).focus();else{var e=PJF.ui.componentMgr.getNextComp(l);e.focus!=undefined&&e.focus instanceof Function&&e.focus()}break;case 13:if($(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked"),c.required)$("#"+c.dom).find("input:checked").length?l.com.checkTip({show:function(){return!0}}):l.com.checkTip({show:function(){return!1},Message:c.missingMessage})}c.handler instanceof Function&&c.handler($(this).val()),t.stopImmediatePropagation(),t.preventDefault()})}),c.required)0==$("#"+c.dom).find("input:checked").length&&$("#"+c.dom).attr("error",l.missingMessage),
$("#"+c.dom).find("input").each(function(){$(this).live("click",function(){var t=!1;$("#"+c.dom).find("input").each(function(){$(this).attr("checked")&&(t=!0)}),t?l.com.checkTip({show:function(){return!0}}):l.com.checkTip({show:function(){return!1},Message:c.missingMessage})})});c.readonly&&l.setReadOnly(!0),l.com.addClass("validatebox-checkbox")}c.required&&(0==(l=this).com.find("input:checked").length&&l.com.addClass("validatebox-invalid"),l.com.addClass("invalid_box"),this.com.live("blur",function(){var t=!1;$(this).find("input").each(function(){$(this).attr("checked")&&(t=!0)}),t?l.com.checkTip({show:function(){return!0}}):l.com.checkTip({show:function(){return!1},Message:c.missingMessage})}))},getStrLength:function(t){if(t){var e=t.replace(/[\u4e00-\u9fa5]/g,"");return 2*(t.length-e.length)+e.length}return 0},generateDom:function(t,e,i,n,o){for(var a="",s=0,r=(o=o||10,
0);r<e.length;r++)0==r?(a+='<div class="pjfcheckbox-first"><div class="pjfcheckbox-first"><input name="'+t+'" value="'+e[r]+'" type="checkbox" readOnly="" class="pjfcheckbox-input"/></div><div class="pjfcheckbox-first">'+i[r]+"</div></div>",s++):i[r].length>o?(a+='<br/><div class="pjfcheckbox-br"><div class="pjfcheckbox-first"><input name="'+t+'" value="'+e[r]+'" type="checkbox" readOnly="" class="pjfcheckbox-input"/></div><div class="pjfcheckbox-first">'+i[r]+"</div></div>",s=1):s==n?(a+='<br/><div class="pjfcheckbox-br"><div class="pjfcheckbox-first"><input name="'+t+'" value="'+e[r]+'" type="checkbox" readOnly="" class="pjfcheckbox-input"/></div><div class="pjfcheckbox-first">'+i[r]+"</div></div>",s=1):(a+='<div class="pjfcheckbox-normal"><div class="pjfcheckbox-first"><input name="'+t+'" value="'+e[r]+'" type="checkbox"  readOnly="" class="pjfcheckbox-input" /></div><div class="pjfcheckbox-first">'+i[r]+"</div></div>",s++);return a},reRenderDom:function(t){var e,i,n
;if(!((i=(n=t.com.children(".pjfcheckbox-first, .pjfcheckbox-br, .pjfcheckbox-normal ")).length)<0)){for(var o=0;o<i;o++){var a=$(n[o]).width();0==o?e=a:e<a&&(e=a)}n.width(e).css({marginLeft:"10px"})}}}),PJF.apply(PJF.ui.checkbox.prototype,{validateParam:function(t){return null!=t.url?!t.selected||!t.defaultValue||(alert(resource.CHECKBOX_CHECK_MSG1),!1):null==t.values?(alert(resource.CHECKBOX_CHECK_MSG2),!1):null==t.labels?(alert(resource.CHECKBOX_CHECK_MSG3),!1):null==t.name?(alert(resource.CHECKBOX_CHECK_MSG4),!1):!t.selected||!t.defaultValue||(alert(resource.CHECKBOX_CHECK_MSG1),!1)},getSelectedObj:function(t){var e=[];this.com&&this.com.find("input").each(function(){if($(this).attr("checked"))if("label"==t)e.push($(this).parent().next("div").text());else if("value"==t)e.push($(this).attr("value"));else{if("dom"==t)return(void 0).com.attr("id");new PJF.ui.messageBox({style:"alert",title:resource.CHECKBOX_ERROR_TITLE,content:resource.CHECKBOX_GETOBJECT_ERROR})}});return e},
getSelectedValue:function(){var t=[],e=0;return this.com.find("input").each(function(){$(this).attr("checked")&&(t[e]=$(this).attr("value"),e++)}),t},getValue:function(){var t=[],e=0;return this.com.find("input").each(function(){$(this).attr("checked")&&(t[e]=$(this).attr("value"),e++)}),t},getSelectedLabel:function(){var t=[],e=0;return this.com.find("input").each(function(){$(this).attr("checked")&&(t[e]=$(this).parent().next("div").text(),e++)}),t},getSelectedDom:function(){return this.com.attr("id")},setSelected:function(t){if(0<t.length)for(var e=0;e<t.length;e++)this.com.find("input").eq(t[e]-1).attr("checked","checked");this.required&&(this.com.removeAttr("error"),this.com.siblings("div.errorbox_ipt_help").remove(),this.com.removeClass("validatebox-tipcolor error-border").css("border","0px solid #c5C5C5"))},unSelected:function(t){if(0<t.length)for(var e=0;e<t.length;e++)this.com.find("input").eq(t[e]-1).removeAttr("checked")
;0==this.com.find("input:checked").length&&this.required&&this.com.attr("error",this.missingMessage)},unSelectValue:function(t){if(0<t.length)for(var e=0;e<t.length;e++)this.com.find("input[value='"+t[e]+"']").removeAttr("checked");0==this.com.find("input:checked").length&&this.required&&this.com.attr("error",this.missingMessage)},disable:function(){this.__disabled=!0,this.com.find("input").each(function(){$(this).attr("disabled","disabled")}),this.com.addClass("pjf_disabled_input")},enable:function(){this.__disabled=!1,this.com.find("input").each(function(){$(this).removeAttr("disabled")}),this.com.removeClass("pjf_disabled_input")},isReadOnly:function(){return this.__readonly},isDisabled:function(){return this.__disabled},isDisplay:function(){return!!this.com.is(":visible")},setDefaultValue:function(t){for(var e=t.length,i=0;i<e;i++)this.com.find("input[value='"+t[i]+"']").attr("checked","checked");0<this.com.find("input:checked").length&&this.required&&(this.com.removeAttr("error"),
this.com.siblings("div.errorbox_ipt_help").remove(),this.com.removeClass("validatebox-tipcolor error-border").css("border","0px solid #c5C5C5"))},setValue:function(t){for(var e=t.length,i=0;i<e;i++)this.com.find("input[value='"+t[i]+"']").attr("checked","checked");0<this.com.find("input:checked").length&&this.required&&(this.com.removeAttr("error"),this.com.siblings("div.errorbox_ipt_help").remove(),this.com.removeClass("validatebox-tipcolor error-border").css("border","0px solid #c5C5C5"))},modify:function(t,e,i){var n=this.com.find("input").eq(t-1);e&&n.attr("value",e),i&&n.parent().next("div").text(i)},setReadOnly:function(t){var e=this;(this.__readonly=t)?(this.com.addClass("pjf_readonly_input"),this.com.find("input").each(function(){$(this).attr("disabled","disabled"),$(this).attr("checked")&&e.com.append("<input type='hidden'  value='"+$(this).val()+"' name='"+$(this).attr("name")+"'/>"),$(this).unbind()}),this.com.die("blur")):(this.com.removeClass("pjf_readonly_input"),
this.com.find("input").each(function(){$(this).removeAttr("disabled"),e.handler&&$(this).off("click",e.handler).live("click",e.handler),e.onChange&&$(this).off("click",e.onChange).live("click",e.onChange)}),this.com.find("input[type='hidden']").remove(),this.required&&(0==e.com.find("input:checked").length&&e.com.addClass("validatebox-invalid invalid_box"),this.com.live("blur",function(){0==e.com.find("input:checked").length?e.com.checkTip({show:function(){return!1},Message:this.missingMessage}):e.com.checkTip({show:function(){return!0}})})))},setRequired:function(t,e){var i=this;t?(i.required=!0,0==i.com.find("input:checked").length&&this.com.attr("error",i.missingMessage),i.com.addClass("validatebox-invalid invalid_box"),this.com.live("blur",function(){var t=!1;$(this).find("input").each(function(){$(this).attr("checked")&&(t=!0)}),t?i.com.checkTip({show:function(){return!0}}):i.com.checkTip({show:function(){return!1},Message:e||"该选项必选"})}),i.com.find("input").each(function(){
$(this).live("click",function(){var t=!1;i.com.find("input").each(function(){$(this).attr("checked")&&(t=!0)}),t?i.com.checkTip({show:function(){return!0}}):i.com.checkTip({show:function(){return!1},Message:e||"该选项必选"})})})):(i.required=!1,this.com.removeAttr("error"),this.com.die("blur"),this.com.siblings("div.errorbox_ipt_help").remove(),this.com.removeClass("validatebox-tipcolor error-border").css("border","0px solid"),this.com.find("input").each(function(){$(this).die("click"),$(this).unbind("click")}),this.com.removeClass("validatebox-invalid"),i.handler&&i.com.find("input").each(function(){$(this).live("click",function(){var t=$(this).val();i.handler(t)})}))},getClassName:function(){return"PJF.ui.checkbox"},destroy:function(){this.com.children().remove(),this.com.removeClass("validatebox-checkbox validatebox-invalid invalid_box"),this.com.removeAttr("error"),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},newDestroy:function(){this.com.children().remove(),
this.com.removeClass("validatebox-checkbox validatebox-invalid invalid_box"),this.com.removeAttr("error"),this.com.die("blur"),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.id=null},setDisable:function(t,e){2!=arguments.length||e?this.com.find("input[value='"+t+"']").attr("disabled","disabled").addClass("pjf_disabled_input"):this.com.find("input[value='"+t+"']").removeAttr("disabled").removeClass("pjf_disabled_input")},setReadonlyByValue:function(t,e){var i=this;2!=arguments.length||e?this.com.find("input:checkbox").each(function(){$(this).val()==t&&($(this).attr("disabled","disabled").addClass("pjf_readonly_input"),i.com.append("<input type='hidden'  value='"+t+"' name='"+$(this).attr("name")+"'/>"))}):(this.com.find("input:hidden").each(function(){$(this).val()==t&&$(this).remove()}),this.com.find("input[value='"+t+"']").removeAttr("disabled").removeClass("pjf_readonly_input"))},focus:function(){
$(this.com).find("input[type='checkbox']").eq(0).focus()}}),PJF.ui.radio=PJF.extend(PJF.ui.component,{init:function(a){var s=this;this.required=a.required,a.missingMessage?s.missingMessage=a.missingMessage:s.missingMessage=resource.SELECT_MISSING_MSG,this.handler=a.handler,this.onChange=a.onChange,this.__readonly=!1,this.__disabled=!1;var r="";if(a&&a.url)PJF.communication.ajax({url:a.url,type:a.type,async:!1,success:function(t){var e=t.values,i=t.labels,n=t.name,o=t.count||3;(r=s.generateDom(n,e,i,o,a.labelLen),s.com.append(r),a.selected&&s.com.find("input").eq(a.selected-1).attr("checked","checked"),a.defaultValue&&s.com.find("input").each(function(){$(this).val()==a.defaultValue&&$(this).attr("checked","checked")}),a.handler&&s.com.find("input").each(function(){$(this).live("click",a.handler)}),a.onChange&&s.com.find("input").each(function(){$(this).live("click",a.onChange)}),$("#"+a.dom).find("input").each(function(t){$(this).on("click",function(){$(this).focus()})}),
PJF.constants.KEYBOARD_ENABLE&&$("#"+a.dom).find("input").each(function(t){$(this).unbind("checkfocus").bind("focus.checkfocus",function(){$(this).parent().height("22px").addClass("focus-border")}),$(this).unbind("checkblur").bind("blur.checkblur",function(){$(this).parent().removeClass("focus-border")});var n=t;$(this).keydown(function(t){switch(t.keyCode){case 107:case 43:if($(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked"),s.onChange&&s.onChange(),a.required)$("#"+a.dom).find("input:checked").length?s.com.checkTip({show:function(){return!0}}):s.com.checkTip({show:function(){return!1},Message:a.missingMessage});break;case 13:if($(this).blur(),n<s.com.find("input:visible").length-1)$("#"+a.dom).find("input[type='radio']:visible").eq(n+1).focus();else(i=PJF.ui.componentMgr.getNextComp(s)).focus!=undefined&&i.focus instanceof Function&&i.focus();break;case 38:if($(this).blur(),0<n){for(;0<=n;){var e=$("#"+a.dom).find("input[type='radio']").eq(n-1)
;if(!e.is(":hidden")){e.focus();break}n--}if(n<0)(i=PJF.ui.componentMgr.getPreviousComp(s)).focus!=undefined&&i.focus instanceof Function&&i.focus()}else{var i;(i=PJF.ui.componentMgr.getPreviousComp(s)).focus!=undefined&&i.focus instanceof Function&&i.focus()}}a.handler&&a.handler instanceof Function&&a.handler($(this).val()),t.stopImmediatePropagation(),t.preventDefault()})}),PJF.constants.KEYBOARD_NEW_ENABLE&&$("#"+a.dom).find("input").each(function(t){$(this).unbind("checkfocus").bind("focus.checkfocus",function(){$(this).parent().height("22px").addClass("focus-border")}),$(this).unbind("checkblur").bind("blur.checkblur",function(){$(this).parent().removeClass("focus-border")}),$(this).live("click",function(){$(this).focus()});var i=t;$(this).keydown(function(t){switch(t.keyCode){case 13:if($(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked"),s.onChange&&s.onChange(),a.required)$("#"+a.dom).find("input:checked").length?s.com.checkTip({
show:function(){return!0}}):s.com.checkTip({show:function(){return!1},Message:a.missingMessage});break;case 9:if($(this).blur(),i<s.com.find("input:visible").length-1)$("#"+a.dom).find("input[type='radio']:visible").eq(i+1).focus();else{var e=PJF.ui.componentMgr.getNextComp(s);e.focus!=undefined&&e.focus instanceof Function&&e.focus()}}a.handler&&a.handler instanceof Function&&a.handler($(this).val()),t.stopImmediatePropagation(),t.preventDefault()})}),a.readonly&&s.setReadOnly(!0),a.required)&&(this.required=!0,0==s.com.find("input:checked").length&&(s.com.addClass("validatebox-invalid invalid_box"),$("#"+a.dom).attr("error",a.missingMessage)),s.com.addClass("invalid_box"),s.com.live("blur",function(){0==s.com.find("input:checked").length?s.com.checkTip({show:function(){return!1},Message:a.missingMessage}):s.com.checkTip({show:function(){return!0}})}));s.com.addClass("validatebox-checkbox")}});else{if($("#"+a.dom).hasClass("validatebox-checkbox"))return;var t=a.count||3
;r=s.generateDom(a.name,a.values,a.labels,t,a.labelLen),s.com.append(r),s.com.addClass("validatebox-checkbox"),a.selected&&this.com.find("input").eq(a.selected-1).attr("checked","checked"),a.defaultValue&&s.com.find("input").each(function(){$(this).val()==a.defaultValue&&$(this).attr("checked","checked")}),a.handler&&this.com.find("input").each(function(){$(this).live("click",a.handler)}),a.onChange&&s.com.find("input").each(function(){$(this).live("click",a.onChange)}),a.readonly&&s.setReadOnly(!0),$("#"+a.dom).find("input").each(function(t){$(this).on("click",function(){$(this).focus()})}),PJF.constants.KEYBOARD_ENABLE&&$("#"+a.dom).find("input").each(function(t){$(this).unbind("checkfocus").bind("focus.checkfocus",function(){$(this).parent().height("22px").addClass("focus-border")}),$(this).unbind("checkblur").bind("blur.checkblur",function(){$(this).parent().removeClass("focus-border")});var n=t;$(this).keydown(function(t){switch(t.keyCode){case 107:case 43:
if($(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked"),s.onChange&&s.onChange(),a.required)$("#"+a.dom).find("input:checked").length?s.com.checkTip({show:function(){return!0}}):s.com.checkTip({show:function(){return!1},Message:a.missingMessage});break;case 13:if($(this).blur(),n<s.com.find("input:visible").length-1)$("#"+a.dom).find("input[type='radio']:visible").eq(n+1).focus();else(i=PJF.ui.componentMgr.getNextComp(s)).focus!=undefined&&i.focus instanceof Function&&i.focus();break;case 38:if($(this).blur(),0<n){for(;0<=n;){var e=$("#"+a.dom).find("input[type='radio']").eq(n-1);if(!e.is(":hidden")){e.focus();break}n--}if(n<0)(i=PJF.ui.componentMgr.getPreviousComp(s)).focus!=undefined&&i.focus instanceof Function&&i.focus()}else{var i;(i=PJF.ui.componentMgr.getPreviousComp(s)).focus!=undefined&&i.focus instanceof Function&&i.focus()}}a.handler&&a.handler instanceof Function&&a.handler($(this).val()),t.stopImmediatePropagation(),t.preventDefault()})
}),PJF.constants.KEYBOARD_NEW_ENABLE&&$("#"+a.dom).find("input").each(function(t){$(this).unbind("checkfocus").bind("focus.checkfocus",function(){$(this).parent().height("22px").addClass("focus-border")}),$(this).unbind("checkblur").bind("blur.checkblur",function(){$(this).parent().removeClass("focus-border")}),$(this).live("click",function(){$(this).focus()});var i=t;$(this).keydown(function(t){switch(t.keyCode){case 13:if($(this).attr("checked")?$(this).removeAttr("checked"):$(this).attr("checked","checked"),s.onChange&&s.onChange(),a.required)$("#"+a.dom).find("input:checked").length?s.com.checkTip({show:function(){return!0}}):s.com.checkTip({show:function(){return!1},Message:a.missingMessage});break;case 9:if($(this).blur(),i<s.com.find("input:visible").length-1)$("#"+a.dom).find("input[type='radio']:visible").eq(i+1).focus();else{var e=PJF.ui.componentMgr.getNextComp(s);e.focus!=undefined&&e.focus instanceof Function&&e.focus()}}
a.handler&&a.handler instanceof Function&&a.handler($(this).val()),t.stopImmediatePropagation(),t.preventDefault()})})}a.required&&(this.required=!0,0==s.com.find("input:checked").length&&($("#"+a.dom).attr("error",s.missingMessage),s.com.addClass("validatebox-invalid")),s.com.addClass("invalid_box"),this.com.live("blur",function(){s.com&&(0==s.com.find("input:checked").length?s.com.checkTip({show:function(){return!1},Message:a.missingMessage}):s.com.checkTip({show:function(){return!0}}))}))},generateDom:function(t,e,i,n,o){for(var a="",s=0,r=(o=o||10,0);r<e.length;r++)0==r?(a+='<div class="pjfcheckbox-first"><div class="pjfcheckbox-first"><input name="'+t+'" value="'+e[r]+'" type="radio" class="pjfcheckbox-input" /></div><div class="pjfcheckbox-first">'+i[r]+"</div></div>",
s++):i[r].length>o?(a+='<br><div class="pjfcheckbox-br"><div class="pjfcheckbox-first"><input name="'+t+'" value="'+e[r]+'" type="radio" class="pjfcheckbox-input"/></div><div class="pjfcheckbox-first">'+i[r]+"</div></div>",s=1):s==n?(a+='<br><div class="pjfcheckbox-br"><div class="pjfcheckbox-first"><input name="'+t+'" value="'+e[r]+'" type="radio" class="pjfcheckbox-input"/></div><div class="pjfcheckbox-first">'+i[r]+"</div></div>",s=1):(a+='<div class="pjfcheckbox-normal"><div class="pjfcheckbox-first"><input name="'+t+'" value="'+e[r]+'" type="radio" class="pjfcheckbox-input"/></div><div class="pjfcheckbox-first">'+i[r]+"</div></div>",s++);return a},setRequired:function(t){var e=this;(this.required=t)?(0==e.com.find("input:checked").length&&e.com.addClass("validatebox-invalid invalid_box").attr("error",e.missingMessage),e.com.addClass("invalid_box"),e.com.live("blur",function(){0==e.com.find("input:checked").length?e.com.checkTip({show:function(){return!1},Message:e.missingMessage
}):e.com.checkTip({show:function(){return!0}})})):(e.com.removeClass("validatebox-invalid invalid_box invalid_box validatebox-tipcolor error-border").removeAttr("error"),e.com.attr("style",""),e.com.die("blur"))},setReadOnly:function(t){var e=this;if(this.__readonly=t){this.com.addClass("pjf_readonly_input"),this.com.find("input").each(function(){$(this).attr("disabled","disabled"),$(this).unbind()}),this.com.die("blur");var i=this.com.find("input").eq(0).attr("name"),n=this.com.find("input:checked").val();n==undefined&&(n=""),this.com.append("<input type='hidden'  value='"+n+"' name='"+i+"'/>")}else{if(this.com.removeClass("pjf_readonly_input"),this.com.find("input").each(function(){$(this).removeAttr("disabled"),e.handler&&$(this).off("click",e.handler).live("click",e.handler),e.onChange&&$(this).off("click",e.onChange).live("click",e.onChange)}),this.com.find("input:hidden").remove(),
this.required)0==e.com.find("input:checked").length&&e.com.addClass("validatebox-invalid invalid_box"),this.com.live("blur",function(){0==e.com.find("input:checked").length?e.com.checkTip({show:function(){return!1},Message:this.missingMessage}):e.com.checkTip({show:function(){return!0}})})}}}),PJF.apply(PJF.ui.radio.prototype,{validateParam:function(t){return null!=t.url?!t.selected||!t.defaultValue||(alert(resource.CHECKBOX_CHECK_MSG1),!1):null==t.values?(alert(resource.CHECKBOX_CHECK_MSG2),!1):null==t.name?(alert(resource.CHECKBOX_CHECK_MSG4),!1):null==t.labels?(alert(resource.CHECKBOX_CHECK_MSG3),!1):!t.selected||!t.defaultValue||(alert(resource.CHECKBOX_CHECK_MSG1),!1)},getSelectedObj:function(t){var e;if(this.com){var i=this;this.com.find("input").each(function(){$(this).attr("checked")&&("label"==t?e=$(this).parent().next("div").text():"value"==t?e=$(this).attr("value"):"dom"==t?e=i.com.attr("id"):new PJF.ui.messageBox({style:"alert",title:resource.CHECKBOX_ERROR_TITLE,
content:resource.RADIO_GETOBJECT_ERROR}))})}return e},getSelectedValue:function(){var t;return this.com.find("input").each(function(){$(this).attr("checked")&&(t=$(this).attr("value"))}),t},getValue:function(){var t;return this.com.find("input").each(function(){$(this).attr("checked")&&(t=$(this).attr("value"))}),t},getSelectedLabel:function(){var t;return this.com.find("input").each(function(){$(this).attr("checked")&&(t=$(this).parent().next("div").text())}),t},getSelectedDom:function(){return this.com.attr("id")},setSelected:function(t){this.com.find("input").eq(t-1).attr("checked","checked");var e=this.com.find(".pjf_readonly_input");if(this.required&&this.com.removeAttr("error"),0<e.length){this.com.find("input:hidden").remove();var i=this.com.find("input").eq(t-1).attr("value"),n=this.com.find("input").eq(t-1).attr("name");this.com.append("<input type='hidden' name='"+n+"' value='"+i+"'/>")}this.required&&(this.com.removeAttr("error"),
this.com.siblings("div.errorbox_ipt_help").remove(),this.com.removeClass("validatebox-tipcolor error-border").css("border","0px solid #c5C5C5"))},setSelectedValue:function(t){if(this.com.find("input").each(function(){$(this).val()==t&&$(this).attr("checked","checked")}),this.required&&(this.com.removeAttr("error"),this.com.siblings("div.errorbox_ipt_help").remove(),this.com.removeClass("validatebox-tipcolor error-border").css("border","0px solid #c5C5C5")),this.com.hasClass("pjf_readonly_input")){this.com.find("input:hidden").remove();var e=this.com.find("input").eq(0).attr("name");this.com.append("<input type='hidden' name='"+e+"' value='"+t+"'/>")}},setValue:function(t){if(this.com.find("input").each(function(){$(this).val()==t&&$(this).attr("checked","checked")}),this.required&&(this.com.removeAttr("error"),this.com.siblings("div.errorbox_ipt_help").remove(),this.com.removeClass("validatebox-tipcolor error-border").css("border","0px solid #c5C5C5")),
this.com.hasClass("pjf_readonly_input")){this.com.find("input:hidden").remove();var e=this.com.find("input").eq(0).attr("name");this.com.append("<input type='hidden' name='"+e+"' value='"+t+"'/>")}},unSelected:function(){this.com.find("input").each(function(){$(this).attr("checked")&&$(this).removeAttr("checked")}),this.required&&this.com.attr("error",this.missingMessage)},hideRadio:function(t){for(var e in t)this.com.find("input[value="+t[e]+"]").parent().parent().hide()},showRadio:function(t){for(var e in t)this.com.find("input[value="+t[e]+"]").parent().parent().show()},modify:function(t,e,i){var n=null;t?n=this.com.find("input").eq(t-1):this.com.find("input").each(function(){$(this).attr("checked")&&(n=$(this))}),e&&n.attr("value",e),i&&n.parent().next("div").text(i)},setDefaultValue:function(t){var e=!1;this.com.find("input").each(function(){$(this).val()==t&&($(this).attr("checked","checked"),e=!0)}),e?this.required&&(this.com.removeAttr("error"),
this.com.siblings("div.errorbox_ipt_help").remove(),this.com.removeClass("validatebox-tipcolor error-border").css("border","0px solid #c5C5C5")):this.required&&this.com.attr("error",this.missingMessage)},disable:function(){this.__disabled=!0,this.com.find("input").each(function(){$(this).attr("disabled","disabled")}),this.com.addClass("pjf_disabled_input")},enable:function(){this.__disabled=!1,this.com.find("input").each(function(){$(this).hasClass("pjf_readonly_input")||$(this).removeAttr("disabled")}),this.com.removeClass("pjf_disabled_input")},isReadOnly:function(){return this.__readonly},isDisabled:function(){return this.__disabled},isDisplay:function(){return!!this.com.is(":visible")},getClassName:function(){return"PJF.ui.radio"},destroy:function(){this.com.die("blur"),this.com.children().remove(),this.com.removeClass("validatebox-checkbox validatebox-invalid invalid_box"),this.com.removeAttr("error"),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},
focus:function(){$(this.com).find("input[type='radio']:visible").eq(0).focus()}}),PJF.ui.select=PJF.extend(PJF.ui.component,{init:function(o){o.async=!1;var a=this;if(!o||!o.url)return o.data instanceof Array&&"undefined"!=typeof o.historyKey&&PJF.communication.client.isInP2()&&(o.data=a.resort(o.data,o.historyKey)),a.com.select(o);o.success=function(t){if(o.formatter)o.data=o.formatter(t);else{for(var e=[],i=0;i<t.length;i++){var n={};n.name=t[i].itemValue,n.desc=t[i].itemName,e[i]=n}o.data=e}return o.order&&("desc"==o.order?o.orderkey?o.data.sort(function(t,e){return e[o.orderkey].localeCompare(t[o.orderkey])}):o.data.sort(function(t,e){return e.desc.localeCompare(t.desc)}):o.orderkey?o.data.sort(function(t,e){return t[o.orderkey].localeCompare(e[o.orderkey])}):o.data.sort(function(t,e){return t.desc.localeCompare(e.desc)})),o.data instanceof Array&&"undefined"!=typeof o.historyKey&&PJF.communication.client.isInP2()&&(o.data=a.resort(o.data,o.historyKey)),a.com.select(o)},
o.data=o.param,PJF.communication.ajax(o)},resort:function(t,e){t=t;var i=PJF.communication.client.pjfCache("get",e),n=[],o=[];if(i)for(var a=0;a<i.length;a++)for(var s=0;s<t.length;s++)if(i[a]==t[s].name){n.push(s),o.push(t[s]);break}for(var r=o.length-1;0<=r;r--)t.unshift(o[r]);var c=o.length;n=n.sort(function(t,e){return t-e});for(var l=0;l<n.length;l++){n[l];t.splice(n[l]+c-l,1)}return t},getSelectValue:function(){return this.com.select("getSelectValue")},focus:function(){return this.com.select("focus")},getValue:function(){return this.com.select("getValue")},focusable:function(){return this.com.select("focusable")},getSelectText:function(){return this.com.select("getSelectValue","text")},setSelectValue:function(t,e){return this.com.select("setSelectValue",t,e)},setHelpTip:function(t,e){return this.com.select("setHelpTip",t,e)},triggerChange:function(){return this.com.select("triggerChange")},setValue:function(t,e){return this.com.select("setValue",t,e)},isDisabled:function(){
return this.com.select("isDisabled")},disabled:function(){this.com.select("disabled")},disable:function(){this.com.select("disable")},enable:function(){this.com.select("enable")},hide:function(){this.com.select("hide")},show:function(){this.com.select("show")},isNull:function(){var t=this.getSelectValue();return null==t||""==t},remove:function(){return this.com.select("remove")},addSingleDiv:function(){return this.com.select("addSingleDiv")},destroy:function(){this.com.select("remove"),this.com.removeClass("focus-border-select-error"),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},addOptions:function(t,e){this.com.select("addOptions",t,e)},removeAll:function(){this.com.select("removeAll")},removeOptions:function(t){this.com.select("removeOptions",t)},addDefaultOption:function(t){this.com.select("addDefaultOption",t)},isReadOnly:function(){return this.com.select("isReadOnly")},isDisplay:function(){return this.com.select("isDisplay")},setReadOnly:function(t){
this.com.select("setReadOnly",t)},getAllOptions:function(){return this.com.select("getAllOptions")},setRequired:function(t){this.com.select("setRequired",t)},unSelect:function(t){this.com.select("unSelect",t)},unSelectAll:function(){this.com.select("unSelectAll")},selectAll:function(){this.com.select("selectAll")},setNullValue:function(){this.com.select("setNullValue")},getClassName:function(){return"PJF.ui.select"},addHighlight:function(){this.com.is("select")?this.com.next("input:visible").addClass("validatebox-tipcolor error-border"):this.com.children("input:visible").addClass("validatebox-tipcolor error-border")}}),PJF.ui.tab=PJF.extend(PJF.ui.component,{init:function(t){this.content=$("#"+this.dom).html(),this.copyComObj=this.com.clone(!1,!1).empty().insertAfter(this.com),this.copyComObj.attr("id","");this.com.tabs({title:t.title,border:!1,width:"auto",height:"auto",closable:!0,onLoad:t.onLoad,onClose:t.onClose,onSelect:t.onSelect,selected:t.selected,
scrollIncrement:t.scrollIncrement,scrollDuration:t.scrollDuration})},destroy:function(){this.com.remove(),this.copyComObj.attr("id",this.dom),$("#"+this.dom).html(this.content),this.content=null,this.com=null,this.params=null,this.id=null},newDestroy:function(){PJF.ui.componentMgr.remove(this.id),this.destroy()}}),PJF.apply(PJF.ui.tab.prototype,{add:function(t){t.url&&(t.url=PJF.i18n.addUrli18n(t.url)),this.com.tabs("add",{id:t.id,title:t.title,content:t.content,href:t.url,onLoad:t.onLoad,closable:t.closable,onClose:t.onClose,selected:t.selected})},remove:function(t){this.com.tabs("close",t)},removeAll:function(t){var e=this.com.tabs("tabs");if(e)for(var i=e.length-1;0<=i;i--)this.com.tabs("close",e[i].panel("options").title)},isSelected:function(t){return!(!this.getSelected()||t!=this.getSelected().panel("options").title)},getSelected:function(){return this.com.tabs("getSelected")},disableTab:function(t){this.com.tabs("disableTab",t)},enableTab:function(t){this.com.tabs("enableTab",t)
},validateParam:function(t){return t.dom?(this.dom=t.dom,!0):(alert(resource.TAB_VALIDATEPARM_INFO),!1)},setContent:function(t,e){this.com.tabs("update",{tab:this.com.tabs("getTab",t),options:{content:e}})},setTitle:function(e,i){this.com.find("span.tabs-title").each(function(t){$(this).html()==e&&$(this).html(i)})},selectTab:function(t){this.com.tabs("select",t)},resize:function(t){this.com.tabs("resize",t)},setUrl:function(t,e){this.com.tabs("update",{tab:this.com.tabs("getTab",t),options:{href:e}})},getTab:function(t){return this.com.tabs("getTab",t)},getClassName:function(){return"PJF.ui.tab"},refreshUrl:function(t,e){this.com.tabs("getTab",t).panel("refresh",e)}}),PJF.ui.textfield=PJF.extend(PJF.ui.component,{isNe:!1,init:function(c){c.focusSelectAll="undefined"==typeof c.focusSelectAll?PJF.constants.focusSelectAll:c.focusSelectAll,this.conf=c;var t,l=this;(l.readonlyflag=!1,l.disableflag=!1,l.showflag=!0,l.onEnter=null,PJF.communication.client.customKeyboard(),
this.com.addClass("validatebox-text"),(c.fzFont||"iciUserName"==this.conf.validType||"array"==PJF.util.getType(this.conf.validType)&&-1!=PJF.util.array.indexOf(this.conf.validType,"iciUserName")||PJF.constants.NEED_FANGZHENG)&&this.com.addClass("pjf_textfiled_renkouxinxi"),l.conf=c,null==(c=l.conf).isFillPre&&("money"==c.datatype?c.isFillPre=!1:c.isFillPre=!0),c.inputType||(c.inputType="normal",this.com.css("width","188px")),"normal"==c.inputType||this.com.is("textarea")?(this.com.attr("style","border-width:1px"),this.com.css("width","188px")):this.com.is("textarea")||"help"!=c.inputType||(this.com.css("border-width","0"),this.com.wrap("<span class='validatebox-textBox'></span>").after("<span class='point_box'></span>")),this.com.css("width",c.width),!0===PJF.constants.TEXTFIELD_REQUIRE_TRIM&&(c.requireTrim=!0),(c.required||!c.required&&""!=this.com.val())&&(this.com.addClass("validatebox-invalid invalid_box"),
(c.required&&""==this.com.val()||c.required&&c.requireTrim&&""==$.trim(this.com.val()))&&this.com.attr("error",c.missingMessage||resource.TEXTFIELD_CHECK_MSG1),""==this.com.val()||l.validated()||this.com.attr("error",c.invalidMessage),""==this.com.val()||"money"!=c.datatype&&"number"!=c.datatype&&"dccMoney"!=c.datatype||(l.validated()&&!l.datatypeValid()?this.com.attr("error",c.numboxMessage):!l.validated()&&l.datatypeValid()?this.com.attr("error",c.invalidMessage):this.com.removeClass("validatebox-invalid"))),c.disabled?(l.disableflag=!0,this.com.parent().is("span")&&(this.com.parent().addClass("pjf_disabled_input"),this.com.css("borderWidth","0px")),this.com.addClass("pjf_disabled_input").attr("disabled","disabled")):(l.disableflag=!1,this.com.removeAttr("disabled").removeClass("pjf_disabled_input")),c.readonly||c.readOnly?(l.readonlyflag=!0,this.com.parent().is("span")&&(this.com.parent().addClass("pjf_readonly_input"),this.com.css("borderWidth","0px")),
this.com.attr("readonly","readonly").addClass("pjf_readonly_input")):(l.readonlyflag=!1,this.com.removeAttr("readonly").removeClass("pjf_readonly_input")),c.important&&this.com.css("border","2px solid blue"),c.historyKey&&(PJF.communication.client.isInP2()?c.historyKey?l.history={}:alert("开启输入框输入历史需要conf.historyKey参数!"):c.historyKey=!1),"help"==c.inputType&&"multi"==c.datatype&&c.maxfont)&&(t=PJF_IS_WIDTH?209:95,this.com.after("<div style='clear:both;'></div><div id='textarea_tip' style='margin-left:"+t+"px'>"+resource.TEXTFIELD_AREA_MSG1+"<strong class='blue'></strong>"+resource.TEXTFIELD_AREA_MSG2+"<strong class='red'></strong>"+resource.TEXTFIELD_AREA_MSG3+"</div>"),this.com.siblings("#textarea_tip").find("strong:eq(0)").text(this.com.val().length).next("strong").text(c.maxfont-this.com.val().length),this.com.val(c.missingMessage),this.com.val()==c.missingMessage?this.com.css("color","#ccc"):(this.com.css("color","#000"),
this.com.val().length>c.maxfont?this.com.attr("error",c.invalidMessage):this.com.removeAttr("error")));this.initValidateBox();var d=this.com,r=null;l.time=r;var u,h=null,p="";if(!1===c.contextMenu&&this.com.on("contextmenu paste copy cut",function(t){return!1}),this.com.bind("focus",function(){if($(this).addClass("focus-border"),$(this).parent().is("span")&&$(this).parent().addClass("focus-border"),"help"==c.inputType&&"multi"==c.datatype&&($(this).val()==c.missingMessage?$(this).val(""):$(this).css("color","#000")),r&&(clearInterval(r),r=null),c.historyKey&&PJF.communication.client.isInP2()){u=(u=PJF.communication.client.pjfCache("get",c.historyKey))?u.split(","):[];$(this);if(!l.history.showflag){var t,e,n=d.width(),o=d.height();for(l.history.box=$('<div class="pjf_textfield_historybox"></div>'),i=0;i<u.length;i++){var a=$('<div class="pjf_textfield_historyitem" title="'+u[i]+'">'+u[i]+"</div>");l.history.box.append(a),a.bind("click",function(){l.setValue(this.innerHTML)})}
t=d.offset().top+o,e=d.offset().left,l.history.box.css({top:t+2,left:e,width:n+1}),$("body").append(l.history.box),l.history.box.bind("mousedown",function(t){l.history.showflag=!0}).bind("click",function(){l.history.showflag&&(l.history.box.remove(),l.history.showflag=!1)})}}r=setInterval(function(){p=d.val(),"phoneNumber"==l.params.datatype&&""!=p&&-1!=p.indexOf(l.conf.phoneSeparator)&&(p=p.replace(new RegExp(l.conf.phoneSeparator,"gm"),""),l.com.val(p)),l.params.customDataType&&""!=p&&(p=p.replace(new RegExp(l.params.customDataType.separator,"gm"),"")),"money"==c.datatype&&(p=p.replace(new RegExp(",","gm"),""));p.length;if(t=c.validType?l.validTypeFn(p)[1]:c.invalidMessage,""!=p&&!c.requireTrim||c.requireTrim&&""!=$.trim(p)){if("money"==c.datatype||"number"==c.datatype||"dccMoney"==c.datatype?(d.checkTip({show:function(){return!0}}),d.checkTip({Message:l.validated()?c.numboxMessage||resource.TEXTFIELD_CHECK_ERROR:t,show:function(){return l.validated()&&l.datatypeValid()},
flag:"validate"})):d.checkTip({Message:t,show:function(){return l.validated()},flag:"validate"}),"money"==c.datatype&&l.datatypeValid()&&0!=l.getValue().length&&l.conf.showMoneyTip){var t=PJF.util.number2Money(l.getValue());d.checkTip({Message:t,show:function(){return!1},flag:"warn"})}l.textareaValid(d,p)}},200),c.onFocus&&c.onFocus()}).bind("blur",function(){function e(){if(c.historyKey&&PJF.communication.client.isInP2()){var t=l.getValue(),e=!0;for(a in u)t!=u[a]&&""!=t||(e=!1);e&&(5<u.unshift(t)&&u.pop(),PJF.communication.client.pjfCache("set",c.historyKey,u.join(",")))}}if(l.dccMoneyPointCount=0,c.historyKey&&(l.history.showflag||l.history.box&&l.history.box.remove()),!l.conf.skipValidate){if($(this).removeClass("focus-border"),$(this).parent().is("span")&&$(this).parent().removeClass("focus-border"),r&&(clearInterval(r),r=null),p=d.val(),"money"!=c.datatype&&"dccMoney"!=c.datatype||(p=p.replace(new RegExp(",","gm"),"")),"card"==c.datatype&&(p=p.replace(new RegExp(" ","gm"),"")),
l.fixValue($(this),p),h=""==p||""==$.trim(p)&&c.requireTrim?c.missingMessage:c.validType?l.validTypeFn(p)[1]:c.invalidMessage,"money"!=c.datatype&&"number"!=c.datatype&&"dccMoney"!=c.datatype||""==p?d.checkTip({Message:h,show:function(){var t=l.validated();return t&&e(),t},flag:"validate"}):(d.checkTip({Message:l.validated()?c.numboxMessage||resource.TEXTFIELD_CHECK_ERROR:h,show:function(){var t=l.validated()&&l.datatypeValid();return t&&e(),t},flag:"validate"}),l.fixValue(d,p)),l.textareaValid(d,p),c.onBlur&&c.onBlur(),"phoneNumber"==c.datatype&&l.validated()){var t=l.getValue().split("");if(t.length<11)return;t.splice(7,0,l.conf.phoneSeparator),t.splice(3,0,l.conf.phoneSeparator),l.com.val(t.join(""))}if(l.params.customDataType){var i=l.params.customDataType.length,n=l.getValue().split("");if(i&&(2==i.length&&(n.length>i[1]||n.length<i[0])||1==i.length&&n.length!=i[0]))return;var o=0;for(var s in l.params.customDataType.format){
if((o+=l.params.customDataType.format[s])>=n.length)break;n.splice(o,0,l.params.customDataType.separator),o++}l.com.val(n.join(""))}if("dccMoney"==c.datatype){if(p=Number(p).toFixed(2),isNaN(p))throw d.checkTip({Message:resource.TEXTFIELD_CHECK_ERROR,show:function(){return!1},flag:"validate"}),"dcc不是正确的数值";l.dccVal=0==p?"":p.replace(".",""),l.com.val(l.fixDccValue(p))}"dccMoney"==c.datatype&&c.onChange&&l.valChange&&(c.onChange(),l.valChange=!1)}}).bind("change",function(){if(c.onChange){var t=$(this);c.onChange(t)}}).bind("input",function(){c.onInput&&c.onInput()}).bind("keyup",function(){c.onKeyUp&&c.onKeyUp()}).next("span.point_box").hover(function(){r&&clearInterval(r),$(this).parent().hasClass("validatebox-tipcolor")||$(this).parent().hasClass("warnbox-tipcolor")||d.checkTip({Message:c.helpMessage||c.invalidMessage||resource.TEXTFIELD_HELP_MSG,show:function(){return!1},flag:"help"})},function(){
$(this).parent().hasClass("validatebox-tipcolor")||$(this).parent().hasClass("warnbox-tipcolor")||d.checkTip({Message:c.helpMessage||c.invalidMessage||resource.TEXTFIELD_HELP_MSG,show:function(){return!0},flag:"help"})}),"loanAccount"==c.datatype){var e=c.defaultVal?c.defaultVal:"80 001 999 0001-00000000000001";this.com.val(e)}if("loanAccount"==c.datatype&&(l.com[0].maxLength=30,l.com.bind("contextmenu",function(){return!1}),l.com.bind("keydown",function(t){if(!d.attr("readonly")){var e=l.com.val().substring(0,2),i=l.com.val().substring(3,6),n=l.com.val().substring(7,10),o=l.com.val().substring(11,15),a=l.com.val().substring(16),s=l.com[0].selectionStart,r=l.com[0].selectionEnd;if(s==undefined&&alert('PJF.ui.textfield:使用"贷款账户"类型输入框请用safari模式！'),8==t.which)return 16<s||16<=s&&r!=s?a="":s<17&&11<s||11<s&&s<17&&r!=s?(o="0000",s=11):s<12&&7<s||7<s&&s<12&&r!=s?(n="000",s=7):s<8&&3<s||3<s&&s<8&&r!=s?(i="000",s=3):s<4&&(e="00",s=0),l.com.val(e+" "+i+" "+n+" "+o+"-"+a),
l.com[0].selectionStart=s,l.com[0].selectionEnd=l.com[0].selectionStart,!1;if(13==t.which){if(16<s||16<=s&&r!=s)return a=l.com.val().substring(16),strLength=a.length,strZero="00000000000000".substring(strLength),a=strZero+a,l.com.val(e+" "+i+" "+n+" "+o+"-"+a),"function"==typeof c.loanAccEnterDown&&c.loanAccEnterDown(l,t),!1}else if(37==t.which)16<s||16<=s&&r!=s?l.com[0].selectionStart=16:s<=16&&11<s||11<s&&s<16&&r!=s?l.com[0].selectionStart=11:s<=11&&7<s||7<s&&s<11&&r!=s?l.com[0].selectionStart=7:s<=7&&3<s||3<s&&s<6&&r!=s?l.com[0].selectionStart=3:(s<=3||s<=3&&r!=s)&&(l.com[0].selectionStart=0);else if(39==t.which)16<=s||16<=s&&r!=s?l.com[0].selectionStart=30:s<16&&11<=s||11<s&&s<16&&r!=s?l.com[0].selectionStart=15:s<11&&7<=s||7<s&&s<11&&r!=s?l.com[0].selectionStart=10:s<6&&3<=s||3<s&&s<6&&r!=s?l.com[0].selectionStart=6:(s<=2||s<2&&r!=s)&&(l.com[0].selectionStart=2);else if(95<t.which&&t.which<106||47<t.which&&t.which<58)2!=s&&6!=s&&10!=s&&15!=s||(l.com[0].selectionStart+=1,s+=1),
l.com[0].selectionEnd=l.com[0].selectionStart,s<=1||3<=s&&s<=5||7<=s&&s<=9||11<=s&&s<=14?l.com[0].selectionEnd=l.com[0].selectionStart+1:16<=s&&s<=30&&14==a.length&&(a="",l.com.val(e+" "+i+" "+n+" "+o+"-"+a));else if(27==t.which)l.com.val(c.defaultVal?c.defaultVal:"80 001 999 0001-00000000000001");else{if(9==t.which)return!0;if(86==t.which&&t.ctrlKey)setTimeout(function(){l.fixLoanAccount(l.com.val())},0);else if(67!=t.which&&88!=t.which||!t.ctrlKey)return!1}}})),"dccMoney"==c.datatype){e=c.defaultVal?c.defaultVal:"0.00";function o(t){var e,i,n=/(\d+)(\d{3})/,o=t.indexOf(".");if(0<=o){for(e=t.substring(0,o),i=t.substring(o+1,t.length);n.test(e);)e=e.replace(n,"$1,$2");t=e+"."+i}else for(;n.test(t);)t=t.replace(n,"$1,$2");return t}l.dccMoneyPointCount=0,this.com.val(e),l.dccVal="",l.com.unbind("keydown").bind("keydown",function(t){if(!d.attr("readonly")){var e,i;if(8==t.which)return l.com.val("0.00"),l.dccVal="",void(l.valChange=!0);e=l.dccVal.split(""),
l.dccVal.length<3&&(e=("000".substring(l.dccVal.length)+l.dccVal).split("")),e.splice(e.length-2,0,"."),i=o(e.join("")),l.com.val(i)}}),l.com.unbind("keyup").bind("keyup",function(t){if(!d.attr("readonly")){var e,i,n="";t.preventDefault(),l.com[0].selectionStart=l.com.val().length,95<t.which&&t.which<106?n=t.which-96:47<t.which&&t.which<58?n=t.which-48:110!=t.which&&190!=t.which||(n="00",l.dccMoneyPointCount=2),""!==n&&(l.valChange=!0),l.dccVal+=n,"00"!==n&&(""===n||(2==l.dccMoneyPointCount?(l.dccVal=l.dccVal.replace(/(0{2})(\d$)/,"$20"),--l.dccMoneyPointCount):1==l.dccMoneyPointCount&&(l.dccVal=l.dccVal.replace(/(0)(\d$)/,"$2"),--l.dccMoneyPointCount))),(1==l.dccVal.length&&"0"==l.dccVal||2==l.dccVal.length&&"00"==l.dccVal)&&(l.dccVal=""),(e=("000".substring((l.dccVal.match(/[0-9]/g)||[]).length)+l.dccVal).split("")).splice(e.length-2,0,"."),i=o(e.join("")),
45!=t.which&&189!=t.which&&173!=t.which&&229!=t.which&&109!=t.which||!1===l.conf.allowNegative||(l.dccVal.indexOf("-")<0?(i="-"+i,l.dccVal="-"+l.dccVal):(i=i.replace("-",""),l.dccVal=l.dccVal.replace("-",""))),1==i.indexOf("-")?i="-0"+i.replace("-","0"):0==i.indexOf("-.")&&(i=i.replace("-","-0")),l.com.val(i)}})}"phoneNumber"==c.datatype&&(c.phoneSeparator="-"),l.com.bind("keydown",function(t){if(PJF.constants.KEYBOARD_ENABLE)if("multi"!=c.datatype){if(13==t.which||40==t.which){if(l.onEnter)return void l.onEnter();PJF.ui.componentMgr.getNextComp(l).focus()}else 38==t.which&&(PJF.ui.componentMgr.getPreviousComp(l).focus(),t.preventDefault());"dccMoney"==c.datatype&&9==t.which&&PJF.ui.componentMgr.getNextComp(l).focus()}else 40==t.which?PJF.ui.componentMgr.getNextComp(l).focus():38==t.which&&PJF.ui.componentMgr.getPreviousComp(l).focus();else PJF.constants.KEYBOARD_NEW_ENABLE&&("multi"!=c.datatype?(9==t.which&&(PJF.ui.componentMgr.getNextComp(l).focus(),t.preventDefault()),
"dccMoney"==c.datatype&&9==t.which&&(PJF.ui.componentMgr.getNextComp(l).focus(),t.preventDefault())):9==t.which&&(PJF.ui.componentMgr.getNextComp(l).focus(),t.preventDefault()))}),l.com.attr("datatype",l.conf.datatype)},validated:function(){var t=this.params,e=(this.com,this.com.val());"money"!=t.datatype&&"dccMoney"!=t.datatype||(e=e.replace(new RegExp(",","gm"),"")),this.params.customDataType&&""!=e&&(e=e.replace(new RegExp(this.params.customDataType.separator,"gm"),""));var i=""!=$.trim(e)&&t.requireTrim,n=""!=e&&!t.requireTrim;return t.required?t.validType&&(i||n)?this.validTypeFn(e)[0]:!!n||!!i:!(!t.required&&t.validType&&""!=e)||this.validTypeFn(e)[0]},validTypeFn:function(value){var flag=!0,conf=this.params,_this=this.com,v=value,msg="",arry=[];if("money"!=conf.datatype&&"dccMoney"!=conf.datatype||(v=v.replace(new RegExp(",","gm"),"")),"card"==conf.datatype&&(v=v.replace(new RegExp(" ","gm"),"")),
conf.customDataType&&""!=v&&(v=v.replace(new RegExp(conf.customDataType.separator,"gm"),"")),conf.validType){if(conf.validType instanceof Array){for(var a in conf.validType){var rn=conf.validType[a],_395=/([a-zA-Z0-9_]+)(.*)/.exec(rn),rule=PJF.validator.rules()[_395[1]];if(this._shouldValidate(_395[1])&&(v&&rule)){var param=eval(_395[2]);if(param||(param=_this),!rule(v,param,_395[1])){flag=!1,msg+=conf.invalidMessage[a];break}flag=!0,msg=""}}return arry.push(flag,msg),arry}var _395=/([a-zA-Z0-9_]+)(.*)/.exec(conf.validType),rule=PJF.validator.rules()[_395[1]],_bo=!0;if(this._shouldValidate(_395[1])&&rule&&v){var param=eval(_395[2]);param||(param=_this),_bo=rule(v,param,conf.validType)}return msg=conf.invalidMessage||resource.TEXTFIELD_CHECK_ERROR2,arry.push(_bo,msg),arry}},textareaValid:function(t,e){var i=e.length,n=this.params;n.maxfont&&(i>n.maxfont&&(t.checkTip({show:function(){return!1},Message:n.invalidMessage}),i=n.maxfont),
$(t).siblings("#textarea_tip").find("strong:eq(0)").text(i).next("strong").text(n.maxfont-i),t.css("color","#000"))},datatypeValid:function(){var t=this.params,e=this.com.val(),i=e.indexOf("."),n=e.substring(i+1,e.length);if(e=e.replace(new RegExp(",","gm"),""),"dccMoney"==t.datatype)return!0;if(!e.match(/^(\+?|-?)\d+(\.\d+)?$/g)||""==n)return!1;var o=!1;if("money"!=t.datatype||t.datatypeRule){if(-1!=e.indexOf("+"))return!1}else{if(!t.allowPositive&&-1!=e.indexOf("+"))return!1;if(!t.allowNegative&&-1!=e.indexOf("-"))return!1;o=!0}return"property"==t.datatypeRule&&e<0&&!o?"number"!=t.datatype:!(!t.datatypeRule&&e<0&&!o)&&(!t.precision||(i<0||n.length<=t.precision))},initValidateBox:function(){var t=this.params;switch(t.customDataType&&this.com.attr("datatype","customDataType"),this.params.datatype){case"single":265<parseFloat(t.width)&&this.com.closest("li").css({width:"auto","min-width":"auto"});break;case"money":this.com.attr("datatype","money");break;case"number":
this.com.attr("datatype","number");break;case"card":this.com.cardbox({groupSeparator:"   "}),this.com.attr("datatype","card");break;case"multi":this.com.css("height",t.height),this.com.css("overflow",t.overflow),265<parseFloat(t.width)&&this.com.closest("li").css({width:"auto","min-width":"auto"});break;default:265<parseFloat(t.width)&&this.com.closest("li").css({width:"auto","min-width":"auto"})}},fixValue:function(t,e){var i="",n=this.params;if((e||0==e)&&("number"==n.datatype||"money"==n.datatype)&&""!=e&&n.precision&&1==n.isFillPre){if("number"==typeof e)return i=Number(e).toFixed(n.precision),void t.val(i);if(isNaN(e))return;if(e.match(/\./))e.split(".")[1].length<=n.precision&&(i=Number(e).toFixed(n.precision),t.val(i));else i=Number(e).toFixed(n.precision),t.val(i);e=i}if(e&&"money"==n.datatype&&""!=e){"number"==typeof e&&(e=e.toString());var o,a,s=e.indexOf("."),r=/(\d+)(\d{3})/;if(0<=s){for(o=e.substring(0,s),a=e.substring(s+1,e.length);r.test(o);)o=o.replace(r,"$1,$2")
;e=o+"."+a,t.val(e)}else{for(;r.test(e);)e=e.replace(r,"$1,$2");t.val(e)}}},fixLoanAccount:function(t){if(t){if(-1==t.indexOf(" ")){var e=t.split("");e.splice(2,0," "),e.splice(6,0," "),e.splice(10,0," "),e.splice(15,0,"-"),t=e.join("")}this.com.val(t)}},fixDccValue:function(t){var e,i,n=/(\d+)(\d{3})/,o=t.indexOf(".");if(0<=o){for(e=t.substring(0,o),i=t.substring(o+1,t.length);n.test(e);)e=e.replace(n,"$1,$2");t=e+"."+i}else for(;n.test(t);)t=t.replace(n,"$1,$2");return t},fixCardValue:function(t){if("card"==this.params.datatype){if(PJF.orgInfo&&"CN000"!=PJF.orgInfo.instSvrlLgPsnID&&/^[a-zA-z]/.test(e))return;for(var e=$(t).val(),i=$(t).val(),n=/(\S{4})(\S+)/;n.test(i);)i=i.replace(n,"$1   $2");$(t).val(i)}},getValue:function(){var t=$.trim(this.com.val());return"money"!=this.params.datatype&&"dccMoney"!=this.params.datatype||(t=t.replace(new RegExp(",","gm"),"")),
"card"==this.params.datatype&&(PJF.orgInfo&&"CN000"!=PJF.orgInfo.instSvrlLgPsnID&&/^[a-zA-z]/.test(t)||(t=t.replace(new RegExp(" ","gm"),""))),t=t.replace(/([",'])/g,"$1"),PJF.constants.TEXTFIELD_GETVALUE_REPLACE&&(t=t.replace(new RegExp("\n","gm"),"\\n")),"phoneNumber"==this.params.datatype&&(t=t.replace(new RegExp(this.conf.phoneSeparator,"gm"),"")),this.params.customDataType&&this.params.customDataType.separator&&(t=t.replace(new RegExp(this.params.customDataType.separator,"gm"),"")),t},setValue:function(t,e){var i=this.com;if("string"==typeof t&&"multi"==this.params.datatype&&(t=(t=t.replace(new RegExp("\\\\n","gm"),"\n")).replace(new RegExp("\\\\r","gm"),"\r")),"dccMoney"==this.params.datatype){if(t=Number(t).toFixed(2),isNaN(t))throw"dcc不是正确的数值";this.dccVal=0==t?"":t.replace(".",""),t=this.fixDccValue(t)}this.com.val(t),this.fixValue(i,t),this.fixCardValue(i),"disabled"==this.com.attr("disabled")||this.com.is(":hidden")||(!1!==e?(this.com.triggerHandler("focus"),
this.com.triggerHandler("blur"),this.com.triggerHandler("change")):this.com.addClass("validatebox-invalid"))},setStyle:function(t,e){this.com.css(t,e)},setValidType:function(t,e,i){this.conf.validType=t,this.params.validType=t,e&&(this.conf.invalidMessage=e,this.params.invalidMessage=e),i||(this.com.blur(),this.com.focus())},getParams:function(){return this.params},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.off(),this.com.remove(),this.com=null},disabled:function(){this.com.parent().is("span")&&(this.com.parent().addClass("pjf_disabled_input"),this.com.css("borderWidth","0px")),this.com.addClass("pjf_disabled_input").attr("disabled","disabled").removeClass("validatebox-tipcolor error-border"),this.com.parent().is("span")&&(this.com.parent().removeClass("validatebox-tipcolor error-border"),this.com.siblings("span.point_box").removeClass("validatebox-spanicon warnbox-spanicon")),this.com.siblings(".errorbox_ipt_help").remove(),this.disableflag=!0},disable:function(){
this.disableflag=!0,this.com.parent().is("span")&&(this.com.parent().addClass("pjf_disabled_input"),this.com.css("borderWidth","0px")),this.com.addClass("pjf_disabled_input").attr("disabled","disabled").removeClass("validatebox-tipcolor error-border"),this.com.parent().is("span")&&(this.com.parent().removeClass("validatebox-tipcolor error-border"),this.com.siblings("span.point_box").removeClass("validatebox-spanicon warnbox-spanicon")),this.com.siblings(".errorbox_ipt_help").remove()},enable:function(){this.disableflag=!1,"money"!=this.params.datatype&&"number"!=this.params.datatype||this.com.siblings("input:hidden").removeAttr("disabled").removeClass("pjf_disabled_input"),this.com.removeAttr("disabled").removeClass("pjf_disabled_input")},setRequired:function(t){(this.params.required=t)?this.com.addClass("validatebox-invalid invalid_box"):""==this.com.val()&&this.com.checkTip({Message:"",show:function(){return!0},flag:"validate"})},setReadOnly:function(t){this.com.attr("readonly",t)
;(this.readonlyflag=t)?(this.com.parent().is("span")&&(this.com.parent().addClass("pjf_readonly_input"),this.com.css("borderWidth","0px")),this.com.addClass("pjf_readonly_input")):this.com.removeClass("pjf_readonly_input")},onInput:function(){this.com.trigger("input")},onChange:function(){this.com.trigger("change")},onBlur:function(){this.com.trigger("blur")},onFocus:function(){this.com.trigger("focus")},focus:function(){this.onFocus(),this.conf.focusSelectAll&&"multi"!=this.conf.datatype&&(this.com[0].selectionStart=0,this.com[0].selectionEnd=999)},updateConf:function(t,e){this.conf[t]=e},setMessage:function(t,e){this.conf[t]=e},setPrecision:function(t){void 0!==t&&(this.params.precision=t)},getClassName:function(){return"PJF.ui.textfield"},enterTab:function(t){},show:function(){this.com.show(),this.showflag=!0},hide:function(){this.com.hide(),this.showflag=!1},display:function(t){t?this.show():this.hide()},isDisplay:function(){return this.showflag},isDisabled:function(){
return this.disableflag},isReadOnly:function(){return this.readonlyflag},setCustomdatatype:function(t){t&&(this.params.customDataType=t)},setImportant:function(t){this.com.css("border",""),t&&this.com.css("border","2px solid blue")},setHelpTip:function(t,e){var i=this;i.conf.helpMessage=t;var n=i.conf,o=this.com;!0===e&&(this.com.find(".point_box").remove(),this.com.css("border-width","0"),this.com.wrap("<span class='validatebox-textBox'></span>").after("<span class='point_box'></span>"),this.com.next("span.point_box").hover(function(){o.attr("readonly")||(i.time&&clearInterval(i.time),$(this).parent().hasClass("validatebox-tipcolor")||$(this).parent().hasClass("warnbox-tipcolor")||o.checkTip({Message:n.helpMessage||n.invalidMessage||resource.TEXTFIELD_HELP_MSG,show:function(){return!1},flag:"help"}))},function(){o.attr("readonly")||($(this).parent().hasClass("validatebox-tipcolor")||$(this).parent().hasClass("warnbox-tipcolor")||o.checkTip({
Message:n.helpMessage||n.invalidMessage||resource.TEXTFIELD_HELP_MSG,show:function(){return!0},flag:"help"}))}))},_shouldValidate:function(t){if(this.com&&this.com[0]){return!(this.com[0].readOnly&&-1!=PJF.util.array.indexOf(["IDCard","18IDCard"],t))}}}),PJF.ui.window=PJF.extend(PJF.ui.component,{init:function(t){if(t){this.copyComObj=this.com.clone(!1,!1).empty().insertAfter(this.com),this.copyComObj.attr("id",""),t.full&&(t.width=document.body.scrollWidth-10,t.height=document.body.scrollHeight-10),1!=t.closeCacheData?this.initWindow(t):null==this.com.attr("class")?this.initWindow(t):-1==this.com.attr("class").indexOf("window-body")?this.initWindow(t):this.show();var e,i=this;if($("div.panel-header").find("a.pjf_win_panel-tool-collapse"),t.collapsible&&t.showTip){var n=$("div.panel-header").find("a.pjf_win_panel-tool-collapse"),o=t.dom+"_tip",a=$(n).offset().left,s=$(n).offset().top;if(1==$(this).find(".free_tip_window").length)return
;$("body").append("<div class='free_tip_window' id="+o+"><span class='free_tip_up'>最小化窗口</span><span class='free_tip_arrow'></span></div>"),$(this).css("cursor","pointer"),(e=$("#"+o)).css("left",a-10),e.css("top",s-e.height()-15),e.find(".free_tip_arrow").addClass("free_tip_arrow_down");var r=setInterval(function(){if(i.com!=undefined){var t=i.com.parent().find("a.pjf_win_panel-tool-collapse");if(t[0]===undefined)return void clearInterval(r);a=$(t).offset().left,s=$(t).offset().top,e.css("left",a-10),e.css("top",s-e.height()-15),e.find(".free_tip_arrow").addClass("free_tip_arrow_down")}},500)}this.com.parent().bgiframe(),$(".window-mask").bgiframe();var c=this;$(window).bind("scroll",function(t){c.com&&(c.com.parent().find("iframe.bgiframe").hide().show(),$(".window-mask").prev("iframe.bgiframe").hide().show())}),
t.useIframe&&$.browser.msie&&0<top.$(".window-mask").length&&top.$(".window-mask").append("<iframe  width="+window.screen.width+" height="+window.screen.height+' style="display :inline;  position: absolute; z-index: -1; scrolling:no;filter:alpha(opacity=0);" frameborder="0"></iframe>')}this.com.width()<1e3&&this.com.addClass("window-body-form"),this.addKeyborardControl(this),"fixed"==t.position&&this.fixedPosition()},fixedPosition:function(){this.com.parent().css("position","fixed"),this.com.parent().next().css("position","fixed")},addKeyborardControl:function(e){var i=this;(PJF.constants.KEYBOARD_ENABLE||PJF.constants.KEYBOARD_NEW_ENABLE)&&e.com.parent().parent().bind("keydown",function(t){27==t.keyCode&&(e.com.parent().parent().unbind("keydown"),i.close(),PJF.ui.componentMgr.getCurrentCom()&&PJF.ui.componentMgr.getCurrentCom().focus&&setTimeout(function(){PJF.ui.componentMgr.getCurrentCom().focus()},200))})},initWindow:function(e){var i=this;this.com.empty();var t=!0
;0==e.modal&&(t=!1);var n=!0;if(!1===e.closable&&(n=e.closable),e.useIframe=!!e.useIframe||e.useIframe,e.autoSize=e.autoSize||[.7,.7],"auto"==e.width&&(e.width=$(window).width()*e.autoSize[0]),"auto"==e.height&&(e.height=$(window).height()*e.autoSize[1]),e.url&&(e.url=PJF.i18n.addUrli18n(e.url)),this.com.window({left:e.left,top:e.top,width:e.width,height:e.height,href:e.url,content:e.content,title:e.title,modal:t,onLoad:e.onLoad,minimizable:!1,collapsible:1==e.collapsible||e.collapsible==undefined,position:e.position||"",maximizable:e.maximizabled,closable:n,winButtConrl:!0,closeable:!0,onMove:function(){try{"fixed"==e.position&&e.fixPosition&&(i.com.data("window").shadow.css("position","absolute"),e.fixPosition=!1)}catch(t){}},cache:e.cache,resizable:e.resizable,draggable:e.draggable,showTip:e.showTip,onBeforeClose:e.onBeforeClose,onClose:function(){e.showTip&&$("#"+e.dom+"_tip").remove(),e.onClose&&e.onClose(),1!=e.closeCacheData&&i.destroy()}}),e.fixMask){
var o=this.com.parent().next().next(".window-mask"),a=this.com.parent().next(".window-shadow");0<o.length&&0<a.length&&o.css({width:Math.max(o.width(),document.body.scrollWidth),height:Math.max(o.height(),document.body.scrollHeight)})}},destroy:function(){if(this.com){var t=this.com.parent();this.com.hasClass("window-body")&&(t.next().next().hasClass("window-mask")&&t.next().next().remove(),t.next().hasClass("window-shadow")&&t.next().remove(),$("#"+this.dom+"_tip")&&$("#"+this.dom+"_tip").remove(),t.remove(),this.copyComObj.attr("id",this.dom),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null)}},setTitle:function(t){"string"==typeof t&&this.com&&this.com.window("setTitle",t)},setCollapse:function(t){if(!0===t)this.com.window("collapse",!0);else if(!1===t)this.com.window("expand",!0);else if(t===undefined){this.com.window("options").collapsed?this.setCollapse(!1):this.setCollapse(!0)}}}),PJF.apply(PJF.ui.window.prototype,{close:function(){
this.com.window("close")},open:function(){this.com.window("open")},resize:function(t){this.com.window("resize",t)},validateParam:function(t){return t.dom?(this.dom=t.dom,!0):(alert(resource.WINDOW_VALIDATEPARM_INFO),!1)},show:function(){null!=this.com&&(this.com.parent().hasClass("panel window")&&this.com.parent().show(),this.com.parent().next().hasClass("window-shadow")&&this.com.parent().next().show(),this.com.parent().next().next().hasClass("window-mask")&&this.com.parent().next().next().show())},getClassName:function(){return"PJF.ui.window"}}),PJF.ui.tree=PJF.extend(PJF.ui.component,{init:function(conf){var treeType;this.conf=conf,treeType=conf.treeType?conf.treeType:1,conf.chkRange||(conf.chkRange="all");var dom=conf.dom,ul_dom=dom+"_ul";if(1==treeType){var rootNode;function addHoverDom(i,n){if(1==conf.add){var t=$("#"+n.tId+"_span");if(0<$("#addBtn_"+n.tId).length)return;if(!1===n.addFlag)return
;var e="<span class='button add' id='addBtn_"+n.tId+"' title='add node' onfocus='this.blur();'></span>";t.after(e);var o=$("#addBtn_"+n.tId);o&&o.bind("click",function(){var t=$.fn.zTree.getZTreeObj(i),e=n.children&&n.children.length?n.children[n.children.length-1].id+1:n.id+"1";return t.addNodes(n,{id:e,pId:n.id,text:"new node"}),!1})}"function"==typeof conf.addHoverDom&&conf.addHoverDom(i,n)}function removeHoverDom(t,e){1==conf.add&&$("#addBtn_"+e.tId).unbind().remove(),"function"==typeof conf.removeHoverDom&&conf.removeHoverDom(t,e)}function dataFilter(t,e,i){var n,o=function(t){if(t&&t.isParent&&!t.children)t.nocheck=!0;else if(t&&t.children&&0<t.children.length){t.nocheck=!0;for(var e=0;e<t.children.length;e++)o(t.children[e])}};if(n=conf.dataFilter?conf.dataFilter(t,e,i):i)for(var a=0;a<n.length;a++)o(n[a]);return n}var setting={check:{enable:conf.check,chkStyle:conf.chkStyle||"checkbox",radioType:conf.radioType||"level",chkboxType:conf.checkType},data:{simpleData:{enable:!0},
key:{text:conf.textKey||"text"}},view:{showIcon:conf.showIcon||!1,showLine:!1,dblClickExpand:!1,addHoverDom:addHoverDom,removeHoverDom:removeHoverDom},callback:{onClick:conf.click||conf.onClick||null,onExpand:conf.onExpand,onCollapse:conf.onCollapse,beforeRemove:conf.beforeDelete,onRemove:conf.onDelete,beforeRename:conf.beforeEdit,onRename:conf.onEdit,onNodeCreated:conf.onCreated,beforeDrop:conf.onDrop,beforeCollapse:conf.beforeCollapse,beforeAsync:function(){var t=!0;conf.beforeAsync&&(t=conf.beforeAsync.apply(this,arguments));var e=$.fn.zTree.getZTreeObj(ul_dom);return e.setting.async.otherParam=$.extend({},e.setting.async.otherParam,{REQ_LANG:CLIENT_LANGUAGE}),t},onAsyncSuccess:conf.onAsyncSuccess,onAsyncError:conf.onAsyncError,beforeExpand:conf.beforeExpand,beforeCheck:conf.beforeCheck,onCheck:conf.onCheck,beforeDbClick:conf.beforeDblClick,onDblClick:conf.onDblClick},edit:{enable:!1!==conf.editEnable,showRemoveBtn:conf.remove,showRenameBtn:null!=conf.edit?conf.edit:conf.editabled,
drag:{isCopy:conf.isCopy||!1,isMove:conf.isMove}},async:{enable:"undefined"!=typeof conf.url,url:conf.url,otherParam:conf.otherParam,autoParam:conf.autoParam||[],dataFilter:"leaf"==conf.chkRange?dataFilter:conf.dataFilter,autoParamToJsonData:conf.autoParamToJsonData}}}else if(2==treeType){var me=this,MoveTest={errorMsg:"",curTarget:null,curTmpTarget:null,noSel:function(){try{window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()}catch(t){}},dom2Tree:function(e,treeId,treeNode,value,moveType){var targetNode=treeNode,target=MoveTest.curTarget,tmpTarget=MoveTest.curTmpTarget;if(target){var zTree=$.fn.zTree.getZTreeObj(ul_dom),parentNode;if(null!=treeNode&&treeNode.isParent?parentNode=treeNode:null==treeNode||treeNode.isParent||(parentNode=treeNode.getParentNode()),tmpTarget&&tmpTarget.remove(),parentNode){if(conf.oDrop&&conf.oDrop(treeId,target,targetNode,moveType,!0)||conf.onDrop&&conf.onDrop(treeId,target,targetNode,moveType,!0)){if(treeNode.isParent){
var nodes=zTree.addNodes(parentNode,eval("("+target.attr("data")+")"));zTree.selectNode(nodes[0])}else{treeNode.isParent=!0;var nodes=zTree.addNodes(treeNode,eval("("+target.attr("data")+")"));zTree.selectNode(nodes[0])}target.remove()}else target.removeClass("domBtn_Disabled"),target.addClass("domBtn");zTree.refresh(),me.showLine(ul_dom),me.positionShow()}else target.removeClass("domBtn_Disabled"),target.addClass("domBtn");MoveTest.updateType(),MoveTest.curTarget=null,MoveTest.curTmpTarget=null}},updateType:function(){var t=$.fn.zTree.getZTreeObj(ul_dom),e=t.getNodes();t.updateNode(e)},bindDom:function(){$(".domBtnDiv").live("mousedown",MoveTest.bindMouseDown)},bindMouseDown:function(t){if(null!=(i=t.target)&&"domBtn"==i.className){var e=$(document),i=$(i),n=e.scrollTop(),o=e.scrollLeft();i.addClass("domBtn_Disabled"),i.removeClass("domBtn"),curDom=$("<span class='dom_tmp domBtn'>"+i.text()+"</span>"),curDom.appendTo("body"),curDom.css({top:t.clientY+n+3+"px",left:t.clientX+o+3+"px"
}),MoveTest.curTarget=i,MoveTest.curTmpTarget=curDom,e.bind("mousemove",MoveTest.bindMouseMove),e.bind("mouseup",MoveTest.bindMouseUp),e.bind("selectstart",MoveTest.docSelect)}t.preventDefault&&t.preventDefault()},bindMouseMove:function(t){MoveTest.noSel();var e=$(document),i=e.scrollTop(),n=e.scrollLeft(),o=MoveTest.curTmpTarget;return o&&o.css({top:t.clientY+i+3+"px",left:t.clientX+n+3+"px"}),!1},bindMouseUp:function(t){var e=$(document);e.unbind("mousemove",MoveTest.bindMouseMove),e.unbind("mouseup",MoveTest.bindMouseUp),e.unbind("selectstart",MoveTest.docSelect);var i=MoveTest.curTarget,n=MoveTest.curTmpTarget;n&&n.remove(),0==$(t.target).parents("#"+ul_dom).length&&(i&&(i.removeClass("domBtn_Disabled"),i.addClass("domBtn")),MoveTest.curTarget=null,MoveTest.curTmpTarget=null)},bindSelect:function(){return!1}};function beforeRemove(t,e){if(conf.deleteNode)return conf.deleteNode(t,e)}function removeTreeNode(t,e){return 0!=e.level&&conf.remove}function zTreeOnDrop(t,e,i,n,o,a){
var s=$.fn.zTree.getZTreeObj(ul_dom),r=$.fn.zTree.getZTreeObj(e);s.refresh(),r.refresh(),me.showLine(e),me.showLine(ul_dom),me.positionShow()}function beforeDrop(t,e,i,n,o){var a=$.fn.zTree.getZTreeObj(t);return $.fn.zTree.getZTreeObj(ul_dom).refresh(),a.refresh(),me.showLine(ul_dom),me.showLine(t),me.positionShow(),0==$("#"+t+">li").length?!(i=null):!(null==i||"inner"!=n&&!i.parentTId)&&(conf.oDrop?dropFunction=conf.oDrop&&conf.oDrop(t,e,i,n,!0):conf.onDrop&&(dropFunction=conf.onDrop&&conf.onDrop(t,e,i,n,!0)),dropFunction)}function zTreeOnRemove(t,e,i){$.fn.zTree.getZTreeObj(e).refresh(),me.showLine(e),me.positionShow()}function zTreeOnCollapse(t,e,i){$.fn.zTree.getZTreeObj(e).refresh(),me.showLine(e),me.positionShow(),conf.onCollapse&&conf.onCollapse(t,e,i)}function zTreeOnExpand(t,e,i){$.fn.zTree.getZTreeObj(e).refresh(),me.showLine(e),me.positionShow(),conf.OnExpand&&conf.OnExpand(t,e,i),conf.onExpand&&conf.onExpand(t,e,i)}function noOneNext(t,e,i){return 0!=i.level}var setting={
edit:{enable:!0,showRemoveBtn:removeTreeNode,showRenameBtn:!1,drag:{isCopy:!!conf.isCopy&&conf.isCopy,isMove:!!conf.isMove&&conf.isMove,next:noOneNext}},data:{keep:{parent:!1,leaf:!1},simpleData:{enable:!0}},callback:{beforeRemove:beforeRemove,beforeDrop:beforeDrop,onMouseUp:MoveTest.dom2Tree,onClick:conf.click||conf.onClick||null,onDrop:zTreeOnDrop,onRemove:zTreeOnRemove,onCollapse:zTreeOnCollapse,onExpand:zTreeOnExpand},view:{selectedMulti:!1,showIcon:!1,showLine:conf.showLine,swichTree:!1,dblClickExpand:!1}}}var zNodes=conf.data?conf.data:null;if("leaf"==conf.chkRange&&zNodes)for(var i=0;i<zNodes.length;i++)this.ergNodes(zNodes[i]);if($("<ul id='"+ul_dom+"' class='ztree'></ul>").appendTo(this.com),$.fn.zTree.init($("#"+ul_dom),setting,zNodes),1==treeType){var zTree=$.fn.zTree.getZTreeObj(ul_dom);if(conf.showRoot=null!=conf.showRoot&&conf.showRoot,1==conf.showRoot){var node=$("#"+ul_dom),rootNode=node.find("li.level0");conf.isMulti||rootNode.children(":not('ul')").hide()}}
2==treeType&&("horizontal"!=conf.showStyle&&null!=conf.showStyle||$("#"+ul_dom).addClass("horizontal_dargTree"),0==conf.showLine&&(this.com.removeClass("whauto"),$("#"+ul_dom).width("auto").addClass("node_ztree darg_ztree").removeClass("horizontal_dargTree")),"vertical"==conf.showStyle&&$("#"+ul_dom).addClass("darg_ztree move"),MoveTest.updateType(),MoveTest.bindDom(),this.showLine(ul_dom),this.positionShow()),this.resize()},showLine:function(t){var e,i,n=[],o=$("#"+t).find(".lineLeft"),a=$("#"+t).find(".lineRight"),s=0;o.closest("li").height();if($("#"+t).find("li>span.nodebottomLine").eq(0).css("height","0px"),0==this.params.showLine||null!=this.params.showStyle&&"horizontal"!=this.params.showStyle){if("vertical"==this.params.showStyle)for(r=0;r<o.length;r++)n.push(o.eq(r).closest("li").width()),o.eq(r).width(n[r]/2),a.eq(r).width(n[r]/2)}else for(var r=0;r<o.length;r++)e=o.eq(r).closest("li").find("a"),i=o.eq(r).closest("li").closest("ul"),s=40*e.length+10,
o.eq(r).closest("li").height(s),e.css("top",s/2-20),e.prev("span").css("top",s/2),e.next("span").css({top:s/2,left:e.width()+5}),i.css("top",(i.closest("li").height()-i.height())/2<0?0:(i.closest("li").height()-i.height())/2),o.eq(r).height(s/2),a.eq(r).height(s/2)},positionShow:function(){for(var t=$("a"),e=0;e<t.length;e++){switch(t.eq(e).attr("part")){case"categoryB":t.eq(e).addClass("categoryTwo");break;case"categoryC":t.eq(e).addClass("categoryThree");break;case"categoryD":t.eq(e).addClass("categoryFour");break;case"categoryE":t.eq(e).addClass("categoryFive")}}},ergNodes:function(t){if(t&&t.children&&0<t.children.length){t.nocheck=!0;for(var e=0;e<t.children.length;e++)this.ergNodes(t.children[e])}else t&&t.isParent&&!t.children&&(t.nocheck=!0)}}),PJF.apply(PJF.ui.tree.prototype,{checkAllNodes:function(){$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").checkAllNodes(!0)},unCheckAllNodes:function(){$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").checkAllNodes(!1)},
find:function(t){if(t)return $.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").getNodeByParam("id",t,null);alert(resource.TREE_MSG3)},getSelected:function(){return $.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").getSelectedNodes()[0]},getCheckedNodesOfNode:function(t){var e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");if(!t){var i=e.getCheckedNodes(!0);if(!i.length)return null;t=i[0]}var n=null;if("object"==typeof t)n=t;else if(!(n=e.getNodeByParam("id",t+"")))return alert(resource.TREE_MSG4+t),null;return e.getNodesByFilter(function(t){return t.checked},!1,n)},getParent:function(t){var e,i=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");return t?("object"!=typeof t&&(t=i.getNodeByParam("id",t,null)),e=t.getParentNode()):e=(t=i.getSelectedNodes())[0].getParentNode(),e},expand:function(t,e,i){var n=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),o=this.params;"object"!=typeof t&&(t=n.getNodeByParam("id",t,null)),i=i===undefined||!!i,n.expandNode(t,!0,i,!0,e),n.updateNode(t),
2==o.treeType&&(n.refresh(),this.showLine(this.com.attr("id")+"_ul"),this.positionShow())},select:function(t){var e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");"object"!=typeof t&&(t=e.getNodeByParam("id",t,null)),e.selectNode(t)},collapse:function(t){var e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),i=this.params;"object"!=typeof t&&(t=e.getNodeByParam("id",t,null)),e.expandNode(t,!1,!1,!1),2==i.treeType&&(e.refresh(),this.showLine(this.com.attr("id")+"_ul"),this.positionShow())},expandAll:function(){var t=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");t.expandAll(!0),t.refresh(),this.showLine(this.com.attr("id")+"_ul"),this.positionShow()},collapseAll:function(){var t=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");t.expandAll(!1),t.refresh(),this.showLine(this.com.attr("id")+"_ul"),this.positionShow()},setPanelHtml:function(t,e,i){
$("<h3>"+e+'</h3><div class=\'domBtnDiv\'></div><a id="chBtn" class="pjf_linkBtn_assistant_left pjf_linkBtn_left linkBtn_margin right" ><span class="pjf_linkBtn_assistant pjf_linkBtn"><span class="l-btn-text icon-default pjf_linkBtn_assistant_right pjf_linkBtn_right">查询</span></span></a>').appendTo($("#"+t)),$("#"+t).addClass("pjf_nodePanel border"),$("#"+t+" #chBtn").bind("click",i)},setPanelShow:function(t,e){e?$("#"+t).show():$("#"+t).hide()},addNodes:function(panelId,value){value=value.replace(new RegExp(" ","gm"),"&nbsp;"),$("#"+panelId).find("div:eq(0)").append("<span class='domBtn' data="+value+">"+eval("("+value+")").text+"</span>")},updateNodeValue:function(node,key,value){var nodeValue=eval("("+node.attr("data")+")"),keys;if(key instanceof Array&&value instanceof Array)for(var a in key)keys=key[a],nodeValue[keys]=value[a];else nodeValue[key]=value;node.attr("data",PJF.util.json2str(nodeValue))},delPanelNode:function(t,e){
e&&t?$("#"+t).find("div:eq(0)").find("span[data ='"+e+"']").remove():e||$("#"+t).find("div:eq(0)").find("span[select ='select']").remove()},destroyPanelNodes:function(t){t&&$("#"+t).find("div").empty()},setTitle:function(t,e){0==this.com.parent().find("#tree_title").length&&(this.com.before("<div id='tree_title'><strong style='font-size:14px'></strong></div>"),e&&0==this.com.parent().find("#tree_conf").length&&this.com.before("<div id='tree_conf'>描述：<span></span></div>")),this.com.parent().find("#tree_title>strong").text(t),this.com.parent().find("#tree_conf").find("span").text(e)},addTreeNode:function(node,value,isNew){var conf=this.params,treeObj=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");if(node&&("object"!=typeof node&&(node=treeObj.getNodeByParam("id",node,null)),node.isParent=!0,"leaf"==conf.chkRange&&(node.nocheck=!0)),value&&"string"==typeof value&&(value=eval("("+value+")")),value&&"leaf"==conf.chkRange)for(var i=0;i<value.length;i++)this.ergNodes(value[i])
;!0===isNew&&treeObj.removeChildNodes(node);var newNode=treeObj.addNodes(node,value);2==conf.treeType&&(treeObj.refresh(),this.showLine(this.com.attr("id")+"_ul"),this.positionShow(),treeObj.updateNode(node))},deleteNode:function(t,e){var i,n=this.params,o=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");null==e&&(e=!1),"object"!=typeof t&&(t=o.getNodeByParam("id",t,null)),e?(o.removeChildNodes(t),t.isParent=!1,"leaf"==n.chkRange&&(t.nocheck=!1)):(o.removeNode(t),i=t.getParentNode(),"leaf"!=n.chkRange||0!=i.children.length&&i.isParent||(i.nocheck=!1,o.updateNode(i))),o.updateNode(t),2==n.treeType&&(this.showLine(this.com.attr("id")+"_ul"),this.positionShow())},editNode:function(t,e,i){var n=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");"object"!=typeof t&&(t=n.getNodeByParam("id",t,null)),t[e]=i,n.updateNode(t)},getCheckedNode:function(t){var e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");return!0===t?e.getNodesByFilter(function(t){return!!t.checked}):e.getCheckedNodes(!0)},
hideChildNodes:function(t){var e=this.params,i=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");"object"!=typeof t&&(t=i.getNodeByParam("id",t,null)),null==t.children&&alert("本函数只针对父节点操作"),i.hideNodes(t.children),t.isParent=!1,i.updateNode(t),2==e.treeType&&(this.showLine(this.com.attr("id")+"_ul"),this.positionShow())},hideNode:function(t,e){var i=this.params,n=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),o=n.getNodeByParam("id",t,null);null==e&&(e=!0),e&&o&&!o.isHidden?n.hideNode(o):o&&o.isHidden&&n.showNode(o),n.updateNode(o),2==i.treeType&&(n.refresh(),this.showLine(this.com.attr("id")+"_ul"),this.positionShow())},getChildrenNodes:function(t){var e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),i=0;return"object"!=typeof t&&(t=e.getNodeByParam("id",t,null)),i=0==t.level?1:t.level+1,e.getNodesByFilter(function(t){return t.level>=i},!1,t)},getChildrenNode_one:function(t){var e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),i=0
;return"object"!=typeof t&&(t=e.getNodeByParam("id",t,null)),i=0==t.level?1:t.level+1,e.getNodesByFilter(function(t){return t.level==i},!1,t)},getChildrenNodeOne:function(t){var e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),i=0;return"object"!=typeof t&&(t=e.getNodeByParam("id",t,null)),i=0==t.level?1:t.level+1,e.getNodesByFilter(function(t){return t.level==i},!1,t)},resize:function(){var t=0,e=this.com.parent(),i=this;if(window.innerHeight?t=window.innerHeight:document.body&&document.body.clientHeight&&(t=document.body.clientHeight),document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth&&(t=document.documentElement.clientHeight),this.com.parent(".pjf_tree_box").prev().is("div.pjf_lm_search")?this.com.parent(".pjf_tree_box").css({height:t-70}):this.com.parent(".pjf_tree_box").css({height:t-40}),(e.hasClass("pjf_tree_box")||e.hasClass("pjf_tree_box2"))&&("6.0"==$.browser.version?this.com.parent(".pjf_tree_box2").css({height:"auto"
}):this.com.css({height:this.com.parent().height()-10,overflow:"auto",display:"block"})),t-70<=0){var n=setInterval(function(){i.resize()},20);setTimeout(function(){clearInterval(n)},500)}},getOneNodes:function(){return $.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").getNodesByFilter(function(t){return 0==t.level})},destroy:function(){$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").destroy()},getAllNodes:function(){return $.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").getNodes()},setNodeChecked:function(t){var e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),i=e.getSelectedNodes();e.setChkDisabled(i[0],!1),e.checkNode(i[0],t,!0,!0)},checkNode:function(t,e,i){i=i===undefined||i;var n=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),o=n.getNodeByParam("id",t,null);n.selectNode(o),n.setChkDisabled(o,!1),n.checkNode(o,e,!0,i)},getOneCheckedNodes:function(){
for(var t=[],e=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").getCheckedNodes(!0),i=0;i<e.length;i++)e[i].getParentNode()&&1==e[i].getParentNode().checked||t.push(e[i]);return t},moveNode:function(targetNode,treeNode,moveType){var conf=this.params,treeObj=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");treeNode[0].tId?treeObj.moveNode(targetNode,treeNode[0],"inner"):(treeObj.addNodes(targetNode,eval("("+treeNode.attr("data")+")")),treeNode.remove()),treeObj.updateNode(treeNode),2==conf.treeType&&(treeObj.refresh(),this.showLine(this.com.attr("id")+"_ul"),this.positionShow())},getClassName:function(){return"PJF.ui.tree"},setChkDisabled:function(t,e){$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").setChkDisabled(t,e)},getNodeByParam:function(t,e,i){return $.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul").getNodeByParam(t,e,i)},getNodesByParamFuzzy:function(t,e,i){var n=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul");return"object"!=typeof i&&(i=n.getNodeByParam("id",i,null)),
n.getNodesByParamFuzzy(t,e,i)},showNodesByParamFuzzy:function(t,e,i,n){if(n){var o=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul"),a=this.getNodesByParamFuzzy(t,e,i),s=o.transformToArray(o.getNodes());for(var r in s)s[r].isHidden=!0;function c(t,e,i){i&&(t.open=!0),t.isHidden&&(t.isHidden=!1),t.getParentNode()&&c(t.getParentNode(),e,!0)}for(r=0;r<a.length;r++)c(a[r],o);this.conf.data=this.getAllNodes(),this.destroy(),this.init(this.conf)}else{var l=(o=$.fn.zTree.getZTreeObj(this.com.attr("id")+"_ul")).getNodesByParam("isHidden",!0);if(o.showNodes(l),""==$.trim(e))return;var d=o.transformToArray(o.getNodes());o.hideNodes(d);a=this.getNodesByParamFuzzy(t,e,i);function u(t,e,i){i&&e.expandNode(t,!0,!1),t.isHidden&&e.showNode(t),t.getParentNode()&&u(t.getParentNode(),e,!0)}for(r=0;r<a.length;r++)u(a[r],o)}}}),PJF.ui.table=PJF.extend(PJF.ui.component,{init:function(t){var e=this,i=2;t.column&&(i=t.column),this.labelWidth=145,this.contentWidth=235,
this.copyComObj=this.com.clone().insertAfter(this.com),this.copyComObj.attr("id",""),t.defaultLineHeight="15px",t&&(t.labelWidth&&0<t.labelWidth&&(this.labelWidth=t.labelWidth),t.contentWidth&&0<t.contentWidth&&(this.contentWidth=t.contentWidth),t.labelWidth=this.labelWidth,t.contentWidth=this.contentWidth,this.com.table(t),this.com.find(".pjf_td_label").outerWidth(this.labelWidth),this.com.find(".pjf_td_content").each(function(){(0!=$(this).siblings(".pjf_td_content").length||$.browser.msie&&7<parseInt($.browser.version))&&$(this).outerWidth(e.contentWidth)}),this.tableWidth=i*(this.contentWidth+this.labelWidth),this.com.find("div.pjf_table_div").css({width:this.tableWidth+"px"}),this.com.find("table.pjf_table").css("width",this.tableWidth+"px"),this.com.find("tr:last>td").each(function(){$(this).css("border-bottom","1px solid #86BDEC")}))},destroy:function(){var t=this.com.selector.replace("#","");this.copyComObj.attr("id",t),$(this.com.selector).remove(),this.com=null,
this.params=null,this.id=null},newDestroy:function(){PJF.ui.componentMgr.remove(this.id),this.destroy()}}),PJF.apply(PJF.ui.table.prototype,{validateParam:function(t){return t.dom&&t.label&&t.data?t.label.length==t.data.length?(this.dom=t.dom,this.label=t.label,this.data=t.data,!0):(alert(resource.TABLE_LABEL_DATA_LENGTHNOSAME+resource.TABLE_LABEL_LENGTH+t.label.length+resource.TABLE_DATA_LENGTH+t.data.length),!1):!!t.jsonData||(alert(resource.TABLE_VALIDATEPARM_INFO),!1)},loadData:function(t,e,i){if(t.length!=e.length)return alert(resource.TABLE_LABEL_DATA_LENGTHNOSAME+resource.TABLE_LABEL_LENGTH+t.length+resource.TABLE_DATA_LENGTH+e.length),!1;this.com.table("loadData",t,e,i),this.com.find(".pjf_td_label").outerWidth(this.labelWidth),this.com.find(".pjf_td_content").outerWidth(this.contentWidth),this.com.find("div.pjf_table_div").css({width:this.tableWidth+"px"}),this.com.find("table.pjf_table").css("width",this.tableWidth+"px")},append:function(t,e){
if(t.length!=e.length)return alert(resource.TABLE_LABEL_DATA_LENGTHNOSAME+resource.TABLE_LABEL_LENGTH+t.length+resource.TABLE_DATA_LENGTH+e.length),!1;this.com.table("append",t,e),this.com.find(".pjf_td_label").outerWidth(this.labelWidth),this.com.find(".pjf_td_content").outerWidth(this.contentWidth),this.com.find("div.pjf_table_div").css({width:this.tableWidth+"px"}),this.com.find("table.pjf_table").css("width",this.tableWidth+"px")},setData:function(t){this.com.table("setData",t),this.com.find(".pjf_td_label").outerWidth(this.labelWidth),this.com.find(".pjf_td_content").outerWidth(this.contentWidth),this.com.find("div.pjf_table_div").css({width:this.tableWidth+"px"}),this.com.find("table.pjf_table").css("width",this.tableWidth+"px")},getClassName:function(){return"PJF.ui.table"}}),PJF.ui.numberSpinner=PJF.extend(PJF.ui.component,{init:function(conf){var me=this.com,self=this,precision=conf.precision||0;if(me.preNumDom=conf.preNumDom,me.nexNumDom=null,self.required=conf.required,
self.minValue=conf.min,self.maxValue=conf.max,self.minMsg=PJF.constants.NUMBERSPINNER_VALIDATE_MINNUM_INFO+Number(self.minValue).toFixed(precision),self.maxMsg=PJF.constants.NUMBERSPINNER_VALIDATE_MAXNUM_INFO+Number(self.maxValue).toFixed(precision),self.precision=precision,conf){function validateCtrl(){if(self.time&&clearInterval(self.time),me.nexNumDom){var preDom=eval(me.nexNumDom);preDom.time&&clearInterval(preDom.time)}if(me.preNumDom){var nexDom=eval(me.preNumDom);nexDom.time&&clearInterval(nexDom.time)}var reqValFlag=requiredValidate(me);if(!reqValFlag)return!1;reqValFlag&&(me.val().match(/\./)||null==me.min||null==me.max||null==me.preNumDom&&null==me.nexNumDom||me.checkTip({show:function(){return!0}}));var valiDeciNumFlag=validateDecimalNum(me);if(!valiDeciNumFlag)return!1;valiDeciNumFlag&&(null==me.min||null==me.max||null==me.preNumDom&&null==me.nexNumDom||me.checkTip({show:function(){return!0}}));var minMaxValiFlag=minMaxValidate();if(!minMaxValiFlag)return!1
;minMaxValiFlag&&(null!=me.preNumDom&&null!=me.nexNumDom||me.checkTip({show:function(){return!0}}));var comValiFlag=compareValidate(me)}function minMaxCtrl(){"number"==typeof self.maxValue&&me.val()>self.maxValue&&(me.val(self.maxValue.toFixed(precision)),me.parent().find("input:last").val(self.maxValue.toFixed(precision))),"number"==typeof self.minValue&&me.val()<self.minValue&&(me.val(self.minValue.toFixed(precision)),me.parent().find("input:last").val(self.minValue.toFixed(precision))),me.val(Number(me.val()).toFixed(precision)),me.next().val(Number(me.val()).toFixed(precision))}function minMaxValidate(){var t=parseFloat(me.val()),e=self.minValue,i=self.maxValue;return!(t&&(e||i)||0==t&&(e||i))||(conf.validMiMaMsg&&(self.minMsg=conf.validMiMaMsg,self.maxMsg=conf.validMiMaMsg),t<e?(me.checkTip({show:function(){return!1},Message:self.minMsg}),!1):!(i<t)||(me.checkTip({show:function(){return!1},Message:self.maxMsg}),!1))}function compareValidate(me){if(me.val()){if(me.preNumDom){
var preDom=eval(me.preNumDom),pre=preDom.getValue();self.time=setInterval(function(){me.next().hasClass("errorbox_ipt_help")&&clearInterval(self.time),preDom.time&&clearInterval(preDom.time),pre=preDom.getValue(),num=me.val();var t=parseFloat(num);if(pre&&num){if(parseFloat(pre)>parseFloat(num)){var e=PJF.constants.NUMBERSPINNER_VALIDATE_COMPARE_INTO;return conf.validComMsg&&(e=conf.validComMsg),me.checkTip({show:function(){return!1},Message:e}),!1}var i=self.minValue,n=self.maxValue;if(i||n){if(conf.validMiMaMsg&&(self.minMsg=conf.validMiMaMsg,self.maxMsg=conf.validMiMaMsg),t<i)return me.checkTip({show:function(){return!1},Message:self.minMsg}),!1;if(n<t)return me.checkTip({show:function(){return!1},Message:self.maxMsg}),!1;if((i<=t&&t<=n||i<=t&&!n||t<=n&&!i)&&parseFloat(pre)<=parseFloat(num))return me.checkTip({show:function(){return!0}}),!0}else if(parseFloat(pre)<=parseFloat(num))return me.checkTip({show:function(){return!0}}),!0}},100)}if(me.nexNumDom){
var nexDom=eval(me.nexNumDom),nex=nexDom.getValue();self.time=setInterval(function(){nexDom.com.next().hasClass("errorbox_ipt_help")&&clearInterval(self.time),nexDom.time&&clearInterval(nexDom.time),nex=nexDom.getValue(),num=me.val();var t=parseFloat(num);if(num||nex){if(parseFloat(num)>parseFloat(nex)){var e=PJF.constants.NUMBERSPINNER_VALIDATE_COMPARE_INTO;return conf.validComMsg&&(e=conf.validComMsg),nexDom.com.checkTip({show:function(){return!1},Message:e}),!1}if(nexDom.com.next().hasClass("errorbox_ipt_help")){var i=self.minValue,n=self.maxValue;if(i||n){if(conf.validMiMaMsg&&(self.minMsg=conf.validMiMaMsg,self.maxMsg=conf.validMiMaMsg),num<i)return me.checkTip({show:function(){return!1},Message:self.minMsg}),!1;if(num>n)return me.checkTip({show:function(){return!1},Message:self.maxMsg}),!1;if((i<=t&&t<=n||i<=t&&!n||t<=n&&!i)&&parseFloat(num)<=parseFloat(nex))return nexDom.com.checkTip({show:function(){return!0}}),!0
}else if(parseFloat(num)<=parseFloat(nex))return nexDom.com.checkTip({show:function(){return!0}}),!0}}},100)}}}function requiredValidate(t){return self.required&&""==t.val()?(t.checkTip({show:function(){return!1},Message:msg}),!1):(self.required||""!=t.val()||t.checkTip({show:function(){return!0}}),!0)}function validateDecimalNum(t){var e=t.val();if(""!=e&&e.match(/\./)){var i=e.split(".");if(i[1].length>precision||i[1].length<precision)return t.checkTip({show:function(){return!1},Message:msg}),!1;if(i[1].length==precision)return!0}else if(""!=e&&!e.match(/\./)){if(0==precision)return!0;if(0<precision)return t.checkTip({show:function(){return!1},Message:msg}),!1}}this.com.numberspinner({value:conf.value,precision:conf.precision,min:self.min,max:self.max,increment:conf.increment,editable:conf.editable,prefix:conf.prefix,width:conf.width||"auto",onSpinUp:function(){minMaxCtrl(),validateCtrl(),conf.change&&conf.change(me.val())},onSpinDown:function(){minMaxCtrl(),validateCtrl(),
conf.change&&conf.change(me.val())}}),conf.required&&this.com.addClass("validatebox-invalid invalid_box"),conf.invalidMessage?msg=conf.invalidMessage:msg=PJF.constants.NUMBERSPINNER_VALIDATE_DEFAULT_INFO,conf.disable&&(this.com.numberspinner("disable"),this.com.removeClass("pjf_readonly_input"),this.com.addClass("pjf_disabled_input")),me.bind("change",function(){conf.change&&(minMaxCtrl(),conf.change(me.val()))}),me.bind("blur.numSpinValidate",function(){validateCtrl()})}},destroy:function(){this.com.numberspinner("destroy",!0),PJF.ui.componentMgr.remove(this.id)}}),PJF.apply(PJF.ui.numberSpinner.prototype,{validateParam:function(t){return t.dom?(this.dom=t.dom,!0):(alert(resource.NUMBERSPINNER_VALIDATEPARM_INFO),!1)},getValue:function(){return this.com.numberspinner("getValue")},setValue:function(t){this.com.numberspinner("setValue",t),this.com.trigger("blur")},enable:function(){this.com.numberspinner("enable"),this.com.removeAttr("readOnly"),
this.com.removeClass("pjf_readonly_input"),this.com.removeClass("pjf_disabled_input")},disable:function(){this.com.numberspinner("disable"),this.com.removeClass("pjf_readonly_input"),this.com.addClass("pjf_disabled_input")},setRequired:function(t){(this.required=t)?this.com.addClass("validatebox-invalid invalid_box"):""==this.com.val()&&this.com.checkTip({Message:"",show:function(){return!0},flag:"validate"})},setReadOnly:function(t){t?(this.com.attr("readOnly",t),this.com.parent().find(".spinner-arrow-up").unbind("click").unbind("mouseenter").unbind("mouseleave"),this.com.parent().find(".spinner-arrow-down").unbind("click").unbind("mouseenter").unbind("mouseleave"),this.com.addClass("pjf_readonly_input")):(this.com.timespinner("enable"),this.com.removeAttr("readOnly"),this.com.removeClass("pjf_readonly_input"),this.com.removeClass("pjf_disabled_input"))},clear:function(){this.com.numberspinner("clear")},setPreNumDom:function(t){this.com.preNumDom=t},setNexNumDom:function(t){
this.com.nexNumDom=t},setMinValue:function(t){"number"==typeof t?(this.minValue=t,this.minMsg=PJF.constants.NUMBERSPINNER_VALIDATE_MINNUM_INFO+Number(t).toFixed(this.precision)):alert("设置最小值应为数字")},setMaxValue:function(t){"number"==typeof t?(this.maxValue=t,this.maxMsg=PJF.constants.NUMBERSPINNER_VALIDATE_MAXNUM_INFO+Number(t).toFixed(this.precision)):alert("设置最大值应为数字")},setOptions:function(t){var e=this.com.numberspinner("options");$.extend(e,t),t.min&&this.setMinValue(t.min),t.max&&this.setMaxValue(t.max)},getClassName:function(){return"PJF.ui.numberSpinner"}}),PJF.namespace("PJF.ui.gridUtil"),PJF.ui.simpleGrid=PJF.extend(PJF.ui.component,{dom:null,init:function(t){if(this.dom=t.dom,t.columns)for(var e=0;e<t.columns.length;e++)for(var i in t.columns[e]){var n=t.columns[e][i];n.width||(n.width=1)}this.com.datagrid({id:t.id,title:t.title,width:t.width||"auto",height:t.height||350,nowrap:!0,striped:!0,collapsible:t.collapsible==undefined||t.collapsible,
fitColumns:t.fitColumns==undefined||t.fitColumns,url:t.url,sortName:t.sortName,sortOrder:t.sortOrder,idField:t.idField,remoteSort:t.remoteSort||!1,singleSelect:t.singleSelect,columns:t.columns,pagination:t.pagination==undefined||t.pagination,firstHandler:t.firstHandler,prevHandler:t.prevHandler,nextHandler:t.nextHandler,endHandler:t.endHandler,enterHandler:t.enterHandler,pageSize:t.pageSize||10,pageList:t.pageList||[5,10,20,30],totalPath:t.totalPath,rowsPath:t.rowsPath,showPageList:t.showPageList||!1,rownumbers:t.rownumbers==undefined||t.rownumbers,onSelect:t.onSelect,noDataMsg:t.noDataMsg,queryParams:t.queryParams,onLoadSuccess:t.onLoadSuccess,onLoadError:t.onLoadError,dataErrorHandler:function(t,e){if(!e)return!0;if(e.BK_STATUS&&e.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS){var i="";e._COMMON&&e._COMMON.SYS_EVT_TRACE_ID&&(i=e._COMMON.SYS_EVT_TRACE_ID);var n=e.BK_DESC;return e.FLLW_GUIDE&&(n+="~"+e.FLLW_GUIDE),new PJF.ui.errorMessageBox({title:resource.GRID_RESPONSE_REQUEST_FAIL,desc:n,
code:e.BK_CODE,traceId:i,fn:function(){t.onLoadFailure&&t.onLoadFailure(e)}}),!0}return!1}})}}),PJF.apply(PJF.ui.simpleGrid.prototype,{onLoad:function(){},insertRow:function(t,e){var i={index:index,row:e};this.com.datagrid("insertRow",i),this.checkBackground()},clearData:function(t){for(var e=$("#"+this.dom).prev(),i=$(".datagrid-body",e),n=$(".datagrid-body",e.prev()),o=i[0].parentElement.parentNode.parentNode,a=$('td[id="td_pager_pagebuttons"]',o),s="",r="",c=0;c<this.conf.columns[0].length;c++){if(this.conf.columns[0][c].title){for(var l="---",d=0;d<this.conf.columns[0][c].title.length;d++)l+="---";r='<TD style="BORDER: medium none" ><font color=#F0F0F0>'+l+"</font></TD>"}else r='<TD style="BORDER: medium none" ><font color=#F0F0F0>-----</font></TD>';s+=r}
var u="</TR></TBODY></TABLE><TABLE id=tab_listdiv_listContent class=div_tableList border=0 cellSpacing=0 cellPadding=0 width=100% height=80%><TBODY><TR><TD colSpan=99 align=middle><font size=3>"+(t||"请输入查询条件")+"</font></TBODY></TABLE>";i[0].innerHTML="<TABLE style='TABLE-LAYOUT: auto' width=100% class=datagrid-btable border=0 cellSpacing=0 cellPadding=0><TBODY><TR style='HEIGHT:30px' >"+s+u,n[0].style.display="none",a[0].innerHTML="",this.setPagerInfo(1,1)},appendRow:function(t){this.com.datagrid("appendRow",t),this.checkBackground()},deleteRow:function(t){this.com.datagrid("deleteRow",t),this.checkBackground()},getRows:function(){return this.com.datagrid("getRows")},getRowsCount:function(){return this.com.datagrid("getRows").length},selectRow:function(t){this.com.datagrid("selectRow",t)},selectAllRow:function(){for(var t=this.com.datagrid("getRows").length,e=0;e<t;e++)this.com.datagrid("selectRow",e)},loadData:function(t){var e
;e=this.conf.totalPath&&this.conf.rowsPath?this.formatData(t):t;var i=$("#"+this.dom).prev(),n=$(".datagrid-body",i.prev()),o=n[0].parentElement.parentNode.parentNode,a=$('td[id="td_pager_pagebuttons"]',o);"none"==n[0].style.display&&(n[0].style.display=""),a[0]&&"none"==a[0].style.display&&(a[0].style.display=""),this.com.datagrid("loadData",e)},formatData:function(data){this.parseData=data;var realdata={total:0,rows:[]},totalpath=this.conf.totalPath,rowspath=this.conf.rowsPath,totalStr="this.parseData."+totalpath,rowsStr="this.parseData."+rowspath,total=eval(totalStr),rows=eval(rowsStr);return realdata.total=total,realdata.rows=rows,realdata},getRowIndex:function(t){return this.com.datagrid("getRowIndex",t)},getSelected:function(){return this.com.datagrid("getSelected")},getSelections:function(){return this.com.datagrid("getSelections")},bindEventAction:function(t,e){var i=this.com.datagrid("options");"onSelect"==t&&(i.onSelect=e),"onBeforeLoad"==t&&(i.onBeforeLoad=e),
"onLoadSuccess"==t&&(i.onLoadSuccess=e),"onLoadError"==t&&(i.onLoadError=e),"onClickRow"==t&&(i.onClickRow=e),"onDblClickRow"==t&&(i.onDblClickRow=e),"onClickCell"==t&&(i.onClickCell=e),"onDblClickCell"==t&&(i.onDblClickCell=e),"onSortColumn"==t&&(i.onSortColumn=e),"onResizeColumn"==t&&(i.onResizeColumn=e),"onUnselect"==t&&(i.onUnselect=e),"onSelectAll"==t&&(i.onSelectAll=e),"onUnselectAll"==t&&(i.onUnselectAll=e),"onCheck"==t&&(i.onCheck=e),"onUncheck"==t&&(i.onUncheck=e),"onCheckAll"==t&&(i.onCheckAll=e),"onUncheckAll"==t&&(i.onUncheckAll=e),"onBeforeEdit"==t&&(i.onBeforeEdit=e),"onAfterEdit"==t&&(i.onAfterEdit=e),"onCancelEdit"==t&&(i.onCancelEdit=e),"onHeaderContextMenu"==t&&(i.onHeaderContextMenu=e),"onRowContextMenu"==t&&(i.onRowContextMenu=e)},resize:function(t){return this.com.datagrid("resize",t)},selectRow:function(t){this.com.datagrid("selectRow",t)},unselectRow:function(t){this.com.datagrid("unselectRow",t)},selectRecord:function(t){this.com.datagrid("selectRecord",t)},
clearSelections:function(){this.com.datagrid("clearSelections")},destroy:function(){$("#"+this.dom).prev()[0].parentElement.parentNode.parentNode.innerHTML=""},validateParam:function(t){return t.dom&&t.columns?(this.dom=t.dom,!0):(alert("提示：grid组件的dom和columns不能为空！"),!1)},getData:function(){return this.com.datagrid("getData")},getPagerInfo:function(){return this.com.datagrid("getPageInfo")},setCollapse:function(){this.com.datagrid("setCollapse")},setExpand:function(){this.com.datagrid("setExpand")},validateParam:function(t){return t.dom&&t.columns?(this.dom=t.dom,!0):(alert("提示：simpleGrid组件的dom和columns不能为空！"),!1)},checkBackground:function(){var t=$("#"+this.dom).prev();$("tr",t).each(function(){$(this).hasClass("datagrid-row-alt")&&$(this).removeClass("datagrid-row-alt")}),$("tr[class=datagrid-row]",t).each(function(t){t%2==0&&$(this).addClass("datagrid-row-alt")})},hide:function(){$.data($("#"+this.dom)[0],"datagrid").panel.panel("close")},show:function(){
if($.data($("#"+this.dom)[0],"datagrid").panel.panel("open"),$("#"+this.dom).width()<10){var t=this.com.parent().width();this.conf.width&&"auto"!=this.conf.width&&(t=this.conf.width),$("#"+this.dom).width(t),this.com.datagrid("resize",{width:t})}},display:function(t){t?this.show():this.hide()},setPagerInfo:function(t,e){if((e=parseInt(e,10))<=t&&0<e){var i=$("#"+this.dom).prev()[0].parentElement.parentNode,n=($('div[id="div_pagination_info"]',i),$('input[id="txt_pagination_num"]',i)),o=$('span[id="span_pagination_pages"]',i);n[0].value=e,o[0].innerText="页   共 "+t+" 页"}else new PJF.ui.messageBox({title:"输入错误",content:"提示：页码"+e+"超出最大范围值"+t+"，请重新输入！"})}}),PJF.ui.timespinner=PJF.extend(PJF.ui.component,{init:function(conf){this.copyComObj=this.com.clone(!1,!1).empty().insertAfter(this.com),this.copyComObj.attr("id",""),this.copyComObj.css("display","none"),this.com.css("display","block");var me=this.com;me.removeAttr("name");var _me=this;if(_me.preTimeDom=conf.preTimeDom,
_me.nexTimeDom=null,_me.time=null,_me.required=conf.required,_me.notEql=conf.notEql,showSeconds=!0,0==conf.showSeconds&&(showSeconds=!1),conf){this.com.timespinner({value:conf.value,separator:conf.separator,showSeconds:showSeconds,width:conf.width||"auto",onSpinUp:function(){conf.change&&conf.change()},onSpinDown:function(){conf.change&&conf.change()}});var msg="";msg=conf.invalidMessage?conf.invalidMessage:PJF.constants.TIMESPINNER_VALIDATE_DEFAULT_INFO,_me.required&&this.com.addClass("validatebox-invalid invalid_box"),this.com.addClass("timespinner"),conf.disable&&(this.com.timespinner("disable"),this.com.removeClass("pjf_readonly_input"),this.com.addClass("pjf_disabled_input")),me.bind("change",function(){conf.change&&conf.change()}),conf.blurEvent&&me.bind("blur",conf.blurEvent),me.bind("blur.timeValidate",function(){_me.time&&clearInterval(_me.time),me.parent().next().val(me.val().replace(":","").replace(":",""));var t=validate(me);_me.required?t?(me.checkTip({show:function(){
return t},Message:msg}),compareTime()):me.checkTip({show:function(){return t},Message:msg}):!_me.required&&me.val()?t?(me.checkTip({show:function(){return t},Message:msg}),compareTime()):me.checkTip({show:function(){return t},Message:msg}):_me.required||me.val()||me.checkTip({show:function(){return!0},Message:msg})}),me.val()&&me.parent().next().val(me.val().replace(":","").replace(":",""))}function compareTime(){if(_me.preTimeDom){var preDom=eval(_me.preTimeDom),pre=preDom.getValue(),time=me.val().replace(":","").replace(":","");if(pre=preDom.getValue(),time=me.val().replace(":","").replace(":",""),pre&&time){if(time<pre||_me.notEql&&pre==time){var ms=PJF.constants.TIMESPINNERSPAN_VALIDATE_COMPARE_INTO;return _me.notEql&&(ms=PJF.constants.TIMESPINNERSPAN_VALIDATE_COMPARE_INTO_NOT_EQUAL),conf.invalidComMsg&&(ms=conf.invalidComMsg),me.checkTip({show:function(){return!1},Message:ms}),!1}return me.checkTip({show:function(){return!0}}),!0}}if(_me.nexTimeDom){
var nexDom=eval(_me.nexTimeDom),nex=nexDom.getValue(),time=me.val().replace(":","").replace(":","");if(nex=nexDom.getValue(),time=me.val().replace(":","").replace(":",""),time&&nex){if(nex<time||_me.notEql&&time==nex){var ms=PJF.constants.TIMESPINNERSPAN_VALIDATE_COMPARE_INTO;return _me.notEql&&(ms=PJF.constants.TIMESPINNERSPAN_VALIDATE_COMPARE_INTO_NOT_EQUAL),conf.invalidComMsg&&(ms=conf.invalidComMsg),nexDom.com.checkTip({show:function(){return!1},Message:ms}),!1}var flag=validate(nexDom.com);return nexDom.com.checkTip({show:function(){return flag},Message:msg}),flag}}}function validate(t){var e=t.val(),i=!1!==_me.params.showSeconds?"24:00:00":"24:00";return!(!_me.params.allow24||e!=i)||!((conf.showSeconds||null==conf.showSeconds)&&!/^(0\d{1}|1\d{1}|2[0-3]):[0-5]\d{1}:([0-5]\d{1})$/.test(e))&&!(!conf.showSeconds&&null!=conf.showSeconds&&!/^(0\d{1}|1\d{1}|2[0-3]):[0-5]\d{1}$/.test(e))}},destroy:function(){this.com.timespinner("destroy",!0),this.copyComObj.attr("id",this.params.dom),
this.copyComObj.removeAttr("value"),this.com=null,this.params=null,this.id=null},newDestroy:function(){PJF.ui.componentMgr.remove(this.id),this.destroy()},setNexTimeDom:function(t){this.nexTimeDom=t},setPreTimeDom:function(t){this.preTimeDom=t}}),PJF.apply(PJF.ui.timespinner.prototype,{validateParm:function(){return conf.dom?(this.dom=conf.dom,!0):(alert(resource.TIMESPINNER_VALIDATEPARM_INFO),!1)},enable:function(){this.com.timespinner("enable"),this.com.removeAttr("readOnly"),this.com.removeClass("pjf_readonly_input"),this.com.removeClass("pjf_disabled_input")},disable:function(){this.com.timespinner("disable"),this.com.removeClass("pjf_readonly_input"),this.com.addClass("pjf_disabled_input")},setReadOnly:function(t){t?(this.com.attr("readOnly",t),this.com.parent().find(".spinner-arrow-up").unbind("click").unbind("mouseenter").unbind("mouseleave"),this.com.parent().find(".spinner-arrow-down").unbind("click").unbind("mouseenter").unbind("mouseleave"),
this.com.addClass("pjf_readonly_input")):(this.com.timespinner("enable"),this.com.removeAttr("readOnly"),this.com.removeClass("pjf_readonly_input"),this.com.removeClass("pjf_disabled_input"))},getValue:function(){var t=this.com.timespinner("getValue");return 6<t.length?t.replace(":","").replace(":",""):t.replace(":","")},setValue:function(t){if(null!=t&&-1!=t.indexOf(":"))this.com.parent().next().val(t.replace(":","").replace(":","")),this.com.val(t);else if(null!=t&&6<=t.length){this.com.parent().next().val(t);var e=t.substr(0,2),i=t.substr(2,2),n=t.substr(4,2);this.com.val(e+":"+i+":"+n)}else""!=t&&null!=t||(this.com.parent().next().val(""),this.com.val(""))},setRequired:function(t){(this.required=t)?this.com.addClass("validatebox-invalid invalid_box"):this.com.removeClass("validatebox-invalid invalid_box")},getClassName:function(){return"PJF.ui.timespinner"}}),PJF.ui.yearCalendar=PJF.extend(PJF.ui.component,{init:function(t){
if(this.copyComObj=this.com.clone(!1,!1).empty().insertAfter(this.com),this.copyComObj.attr("id",""),t){for(var e="<div class = 'pjf_yearCalendar_line'>",i=1;i<13;i++)e=e+'<span class = "pjf_calendar-year" id ="sp'+i+'"></span>',4==i||8==i?e+='</div><div class = "pjf_yearCalendar_line">':12==i&&(e+="</div>");this.com.append(e);for(var n=1;n<13;n++)$("#sp"+n).calendar({width:t.width,height:t.height,weeks:t.weeks,months:t.months,year:t.year,month:n,current:t.current,onSelect:t.onclick,border:t.border,fit:t.fit,monthSwitch:!1,isYearCalendar:!0})}},destroy:function(){$("#"+this.dom).remove(),this.copyComObj.attr("id",this.dom),this.com=null,this.params=null,this.id=null}}),PJF.apply(PJF.ui.yearCalendar.prototype,{validateParam:function(t){return t.dom?(this.dom=t.dom,!0):(alert("提示：calendar组件的dom不能为空!"),!1)},options:function(t){return $("#sp"+t).calendar("options")},setValue:function(t){var e;if($("#"+this.dom).find(".calendar-selected").removeClass("calendar-selected"),t){
for(var i=0;i<t.length;i++)if(e=t[i]){var n,o,a;n=e.substr(0,4),o=e.substr(4,2),a=e.substr(6,2);var s=parseInt(o,10),r=new Date(n,s-1,a);$("#sp"+s).calendar("moveTo",r,!0)}}else alert("setValue函数中请传入数组型日期参数!")},setUnSelectedVal:function(t){var e;if(t){for(var i=0;i<t.length;i++)if(e=t[i]){var n,o,a;n=e.substr(0,4),o=e.substr(4,2),a=e.substr(6,2),e=n+","+parseInt(o,10)+","+parseInt(a,10),$("#"+this.dom).find('td[abbr="'+e+'"]').removeClass("calendar-selected")}}else alert("setUnSelectedVal函数中请传入数组型日期参数!")},getValue:function(){for(var t=[],e=$("#"+this.dom).find(".calendar-selected"),i=0;i<e.length;i++){var n="",o=e[i].abbr.split(",");o&&(n=o[0]+(parseInt(o[1])<=9?"0"+o[1]:o[1])+(parseInt(o[2])<=9?"0"+o[2]:o[2]),t.push(n))}return t},getClassName:function(){return"PJF.ui.yearCalendar"},disable:function(){this.com.find(".pjf_yearCalendar_line > .pjf_yearCalendar_disable").remove(),this.com.find(".pjf_yearCalendar_line").append("<div class='pjf_yearCalendar_disable'></div>")},
enable:function(){this.com.find(".pjf_yearCalendar_line > .pjf_yearCalendar_disable").remove()}}),PJF.namespace("PJF.ui.gridUtil"),PJF.ui.verticalGrid=PJF.extend(PJF.ui.component,{dom:null,conf:null,editTdinnerHTML:null,editTdinnerText:null,editRowData:null,init:function(l){var d=this;if(this.dom=l.dom,(this.conf=l).columns)for(var t=0;t<l.columns.length;t++)for(var e in l.columns[t]){var i=l.columns[t][e];i.width||(i.width=1)}this.createToolbar(l),this.com.datagrid({id:l.id,title:l.title,width:l.width||"auto",height:l.height||350,showBorder:l.showBorder,isAutoSizeHeight:"auto"==l.height,nowrap:l.nowrap,verColumnData:l.verColumnData,verColumn:!0,axleY:l.axleY,verColumnLevel:l.verColumnLevel,autoRowHeight:!0,striped:!0,collapsible:l.collapsible==undefined||l.collapsible,fitColumns:!0,url:l.url,idField:l.idField,remoteSort:!1,columns:l.columns,rownumbers:!1,totalPath:l.totalPath,rowsPath:l.rowsPath,onSelect:l.onSelect,queryParams:l.param,rowStyler:l.rowStyler,toolbar:l.toolbar,
onHeaderContextMenu:function(t,e){},dataErrorHandler:function(t,e){if(!e)return!0;if(e.BK_STATUS&&e.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS){var i="";e._COMMON&&e._COMMON.SYS_EVT_TRACE_ID&&(i=e._COMMON.SYS_EVT_TRACE_ID);var n=e.BK_DESC;return e.FLLW_GUIDE&&(n+="~"+e.FLLW_GUIDE),new PJF.ui.errorMessageBox({title:resource.GRID_RESPONSE_REQUEST_FAIL,desc:n,code:e.BK_CODE,traceId:i,fn:function(){t.onLoadFailure&&t.onLoadFailure(e)}}),!0}return!1},onBeforeLoad:function(){if(!d.hasChangeBtn){d.hasChangeBtn=!0;for(var t=d.com.datagrid("getGridDom").panel,e=$("div.datagrid-toolbar-entity",t).children("a").removeClass(),i=0;i<e.length;i++)if(e[i].firstChild){var n=PJF.constants.PJF_LINKBUTTON_STYLE;e[i].className=n["default"].defStatus.left+" "+n.assistant.defStatus.left+" linkBtn_margin",e[i].firstChild.className=n["default"].defStatus.middle+" "+n.assistant.defStatus.middle,$(e[i].firstChild).find("span:last")[0].className=n["default"].defStatus.right+" "+n.assistant.defStatus.right}}
d.changePanelHeader(),d.createInputtext(l)},onClickRow:function(t,e){1==l.verColumnLevel&&$("#"+l.dom).datagrid("acceptChanges")},onRowContextMenu:function(t,e,i){d.closeEditorText()},onDblClickCell:function(t,e,i){if(1==l.verColumnLevel)$("#"+l.dom).datagrid("acceptChanges"),l.onDblClickCell(t,e,i);else{if(0<d.getEditorText().length)return void alert("提示：发现未保存数据，请点右键保存再进行编辑！");d.editRowData=d.getRows()[t]}for(var n,o=$("#"+l.dom).prev(),a=0,s=$('tr[datagrid-row-index="'+t+'"]',o),r=0;r<s[0].children.length;r++){if($(s[0].children[r]).attr("field")==e){a=r;var c=$(s[0].children[r]);n=c,d.editTdinnerHTML=c[0].innerHTML,d.editTdinnerText=c[0].innerText;break}}0!=a&&(1==l.verColumnLevel?$("#"+l.dom).datagrid("beginEdit",{rowIndex:t,colIndex:a}):!1!==l.editorEnable&&d.openEditorText(n))},onAfterEdit:function(t,e,i){1==l.verColumnLevel&&($.isEmptyObject(i)||d.changeColumnvalue(t,e,i))},onLoadSuccess:l.onLoadSuccess,onLoadError:l.onLoadError})}}),PJF.apply(PJF.ui.verticalGrid.prototype,{
createToolbar:function(t){if(t.toolbar)for(var e in t.toolbar)"custom"==t.toolbar[e].bt&&(t.toolbar[e]={text:t.toolbar[e].text,iconCls:t.toolbar[e].iconCls||"assistant",handler:t.toolbar[e].onclick,key:t.toolbar[e].key?"addToolbarButton_"+t.toolbar[e].key:""})},getRows:function(){return this.com.datagrid("getRows")},getEditorText:function(){var t=$("#"+this.dom).prev();return $(".datagrid-editable-input",t)},closeEditorText:function(){var rowIndex,inputText=this.getEditorText(),div,td;if(0<inputText.length){var inputTextValue=inputText.attr("value");div=inputText.parent(),td=div.parent(),div[0].innerHTML=this.editTdinnerHTML,div[0].innerText=inputText.attr("value");var field=td.attr("field"),changeValue=inputText.attr("value");if(this.editTdinnerText!=changeValue){var str_changes="{'"+field+"':'"+changeValue+"'}",changes=eval("("+str_changes+")");this.changeColumnvalue(rowIndex,this.editRowData,changes)}}},openEditorText:function(t){var e=$("div.datagrid-cell",t)
;e.hasClass("datagrid-editable")||e.addClass("datagrid-editable");var i=e[0].innerText;e[0].innerHTML="",$('<input class="datagrid-editable-input"  type="text" value=\''+i+"' />").appendTo(e)},createInputtext:function(t){var e=$("#"+t.dom);$("<tbody><tr><td><input id='int_verticalGrid_rows' type=text style='display:none' value=''/></td></tr></tbody>").appendTo(e)},changeColumnvalue:function(rowIndex,rowData,changes){var table=$("#"+this.dom),int_verticalGrid_rows=$('input[id="int_verticalGrid_rows"]',table),str_rows=int_verticalGrid_rows[0].value,rows=eval(str_rows);for(var key in changes){var changesValue=changes[key],colIndex=parseInt(key,10),field=rowData.field;if(!field)return void alert("警告：没有数据匹配字段，数据将丢失！");rows[colIndex][field]=changesValue}int_verticalGrid_rows[0].value=PJF.util.json2str(rows)},getAllColumnsData:function(){var table=$("#"+this.dom),int_verticalGrid_rows=$('input[id="int_verticalGrid_rows"]',table),str_rows=int_verticalGrid_rows[0].value,rows=eval(str_rows)
;return rows},getColumnsBycolIndex:function(colIndex){var table=$("#"+this.dom),int_verticalGrid_rows=$('input[id="int_verticalGrid_rows"]',table),str_rows=int_verticalGrid_rows[0].value,rows=eval(str_rows);return rows[colIndex]},getSelectColumnData:function(){var t=$("#"+this.dom).prev()[0].parentElement,e=$("td.datagrid-tdCol-selected",t).attr("field");if(e)return this.getColumnsBycolIndex(e)},getRowsByRowIndex:function(t){return this.com.datagrid("getRows")[t]},getRowsCount:function(){return this.com.datagrid("getRows").length},loadData:function(t){var e;e=this.conf.totalPath&&this.conf.rowsPath?this.formatData(t):t,this.com.datagrid("loadData",e)},formatData:function(data){this.parseData=data;var realdata={total:0,rows:[]},totalpath=this.conf.totalPath,rowspath=this.conf.rowsPath,totalStr="this.parseData."+totalpath,rowsStr="this.parseData."+rowspath,total=eval(totalStr),rows=eval(rowsStr);return realdata.total=total,realdata.rows=rows,realdata},addColumnvalue:function(t,e,i){
var n={index:t,row:i};this.com.datagrid("updateRow",n),this.addColumnvalueHidden(t,e,i)},addColumnvalueHidden:function(rowIndex,colIndex,rowData){var table=$("#"+this.dom),int_verticalGrid_rows=$('input[id="int_verticalGrid_rows"]',table),str_rows=int_verticalGrid_rows[0].value,rows=eval(str_rows);if(!rows[colIndex]){rows[colIndex]={};for(var i=0;i<this.conf.verColumnData.length;i++){var field=this.conf.verColumnData[i].field;if(!field)break;rows[colIndex][field]=""}}rows[colIndex][rowData.field]=rowData[colIndex],int_verticalGrid_rows[0].value=PJF.util.json2str(rows)},deleteRow:function(t){this.com.datagrid("deleteRow",t),checkBackground()},getOptions:function(){return this.com.datagrid("options")},bindEventAction:function(t,e){var i=this.com.datagrid("options");"onSelect"==t&&(i.onSelect=e),"onBeforeLoad"==t&&(i.onBeforeLoad=e),"onLoadSuccess"==t&&(i.onLoadSuccess=e),"onLoadError"==t&&(i.onLoadError=e),"onClickRow"==t&&(i.onClickRow=e),"onDblClickRow"==t&&(i.onDblClickRow=e),
"onClickCell"==t&&(i.onClickCell=e),"onDblClickCell"==t&&(i.onDblClickCell=e),"onSortColumn"==t&&(i.onSortColumn=e),"onResizeColumn"==t&&(i.onResizeColumn=e),"onUnselect"==t&&(i.onUnselect=e),"onSelectAll"==t&&(i.onSelectAll=e),"onUnselectAll"==t&&(i.onUnselectAll=e),"onCheck"==t&&(i.onCheck=e),"onUncheck"==t&&(i.onUncheck=e),"onCheckAll"==t&&(i.onCheckAll=e),"onUncheckAll"==t&&(i.onUncheckAll=e),"onBeforeEdit"==t&&(i.onBeforeEdit=e),"onAfterEdit"==t&&(i.onAfterEdit=e),"onCancelEdit"==t&&(i.onCancelEdit=e),"onHeaderContextMenu"==t&&(i.onHeaderContextMenu=e),"onRowContextMenu"==t&&(i.onRowContextMenu=e)},resize:function(t){return this.com.datagrid("resize",t)},changePanelHeader:function(){var t=$("#"+this.dom).prev()[0].parentElement.parentNode.parentNode,e=$("div.panel-header",t);if(e.length){e[0].style.width="auto",e[0].style.border="0px",e[0].style.background="transparent","9.0"==$.browser.version&&e.css("background-image","url('')");var i=$("div.panel-tool",e)
;i.length&&(i[0].className="panel-tool-right")}},selectRecord:function(t){this.com.datagrid("selectRecord",t)},destroy:function(){$("#"+this.dom).prev()[0].parentElement.parentNode.parentNode.innerHTML=""},validateParam:function(t){return t.dom&&t.columns?(this.dom=t.dom,!0):(alert("提示：grid组件的dom和columns不能为空！"),!1)},setCollapse:function(){this.com.datagrid("setCollapse")},setExpand:function(){this.com.datagrid("setExpand")},hideColumn:function(t){$("#"+dom).datagrid("hideColumn",t)},showColumn:function(t){this.com.datagrid("showColumn",t)},hide:function(){$.data($("#"+this.dom)[0],"datagrid").panel.panel("close")},show:function(){if($.data($("#"+this.dom)[0],"datagrid").panel.panel("open"),$("#"+this.dom).width()<10){var t=this.com.parent().width();this.conf.width&&"auto"!=this.conf.width&&(t=this.conf.width),$("#"+this.dom).width(t),this.com.datagrid("resize",{width:t})}},display:function(t){t?this.show():this.hide()},getClassName:function(){return"PJF.ui.verticalGrid"}}),
PJF.ui.responseInfo=PJF.extend(PJF.ui.component,{init:function(t){t&&(this.content=t.content,this.responseFlag="success"==this.type,this.responseFlag?this.operDesc=t.operDesc||resource.RESPONSEINFO_SUCCESS_OPER_DESC:this.operDesc=t.operDesc||resource.RESPONSEINFO_FAIL_OPER_DESC,this.createBaseUI(t))},createBaseUI:function(t){var e=$('<div class="pjf_responseinfo"></div>'),i=$('<div class="pjf_responseinfo_main"></div>'),n=$('<div class="pjf_responseinfo_content"></div>'),o=null;o=this.responseFlag?$('<div class="pjf_responseinfo_content_left pjf_responseinfo_success"></div> '):$('<div class="pjf_responseinfo_content_left pjf_responseinfo_warning"></div> ');var a=$('<div class="pjf_responseinfo_content_right"></div> '),s='<div class="pjf_responseinfo_title">'+this.title+"</div>";this.content&&(s+='<div class="pjf_responseinfo_contentInfo">'+this.content+"</div>"),this.btnNames&&(s+='<div class="pjf_responseinfo_appenddesc">'+this.operDesc+"</div>"),$(s).appendTo(a),o.appendTo(n),
a.appendTo(n),n.appendTo(i);var r=$('<div class="pjf_responseinfo_btns"></div>'),c=this.generateId(),l=this.generateId(),d=$('<div class="pjf_responseinfo_default_btns"><a id="'+c+'" href="javascript:void(0)"></a><a id="'+l+'" href="javascript:void(0)"></a></div>');if(this.btnNames)for(var u=0;u<this.btnNames.length;u++)$('<a href="####" class="business_btn">'+this.btnNames[u]+"</a>").appendTo(r);$(r).appendTo(i),i.appendTo(e),$(d).appendTo(e),e.appendTo(this.com);var h=this,p=null,f=null;h.confirmHandler&&(p=new PJF.ui.linkButton({dom:c,name:t.confirmBtnName||resource.RESPONSEINFO_CONFIRM_BTN_NAME,iconCls:t.confirmBtnIconCls||"icon-confirm",onclick:function(t){h.confirmHandler(t)}}),t.focusBtnName&&"ok"==t.focusBtnName.toLowerCase()&&p.focus()),h.backHandler&&(f=new PJF.ui.linkButton({dom:l,name:t.backBtnName||resource.RESPONSEINFO_BACK_BTN_NAME,iconCls:t.backBtnIconCls||"icon-return",onclick:function(t){h.backHandler(t)}}),
t.focusBtnName&&"back"==t.focusBtnName.toLowerCase()&&f.focus()),this.btnNames&&this.com.find(".pjf_responseinfo_btns > a").each(function(e,t){$(this).click(function(t){h.handlers[e](t)})}),this.addPNGFilter("pjf_responseinfo_content_left")},addPNGFilter:function(t){var e="Microsoft Internet Explorer"==navigator.appName&&4==parseInt(navigator.appVersion)&&-1!=navigator.appVersion.indexOf("MSIE 6.0");if(jQuery.browser.msie&&e){var i=this.com.find("."+t);if(i.length){var n=i.css("background-image");if("none"!=n){var o=n.split('url("')[1].split('")')[0];i.get(0).runtimeStyle&&(i.css("background-image","none"),i.get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+o+"',sizingMethod='scale')")}}}},destroy:function(){this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null,this.content=null,this.btnNames=null,this.responseFlag=null},newDestroy:function(){this.com.find("[componentid]").each(function(){try{
var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),this.destroy()},getClassName:function(){return"PJF.ui.responseInfo"}}),PJF.apply(PJF.ui.responseInfo.prototype,{validateParam:function(t){if(!t.dom)return alert("提示：responseInfo组件的dom不能不为空!"),!1;if(this.dom=t.dom,!t.type||"success"!=t.type&&"warning"!=t.type)return alert("提示：responseInfo组件的type不能不为空!"),!1;if(this.type=t.type,!t.title)return alert("提示：responseInfo组件的title不能不为空!"),!1;if(this.title=t.title,t.btnNames&&0<t.btnNames.length){if(!t.handlers||t.handlers.length!=t.btnNames.length)return alert("提示：responseInfo组件的btnNames和handlers必须互相匹配!"),!1;this.btnNames=t.btnNames,this.handlers=t.handlers}return this.confirmHandler=t.confirmHandler,this.backHandler=t.backHandler,!0}}),PJF.ui.basicLine=PJF.extend(PJF.ui.component,{init:function(e){var i;this.dom=e.dom,
0==$("#"+this.dom+"__inner").size()&&$("<div id='"+this.dom+"__inner'></div>").appendTo($("#"+this.dom)),e.type||(e.type="line");var n={series:{stacking:e.stacking}};if(e.type&&(n[e.type]={cursor:"pointer",events:e.bindEvents}),e.url&&e){var o=this;PJF.communication.ajax({url:e.url,type:"get",success:function(t){e.xData=t.xData,e.yData=t.yData,i=new Highcharts.Chart({chart:{renderTo:e.dom+"__inner",type:e.type,margin:e.margin,width:e.width,height:e.height},title:{text:e.title,x:-20},colors:e.colors,subtitle:{text:e.subtitle,x:-20},xAxis:{tickInterval:e.xTickInterval?e.xTickInterval:null,title:{text:e.xTitle},categories:e.xData,labels:e.xlabels},yAxis:e.yAxis?e.yAxis:{tickInterval:e.yAxisTick?e.yAxisTick.tickInterval:null,min:e.yAxisTick?e.yAxisTick.min:null,max:e.yAxisTick?e.yAxisTick.max:null,title:{text:e.yTitle},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{formatter:e.formatter},plotOptions:n,legend:{layout:"vertical",align:"right",verticalAlign:"top",x:-10,y:100,
borderWidth:0},series:e.yData}),o.chart=i}})}else i=new Highcharts.Chart({chart:{renderTo:e.dom+"__inner",type:e.type,margin:e.margin,width:e.width,height:e.height},colors:e.colors,title:{text:e.title,x:-20},subtitle:{text:e.subtitle,x:-20},xAxis:{tickInterval:e.xTickInterval?e.xTickInterval:null,title:{text:e.xTitle},categories:e.xData,labels:e.xlabels},yAxis:e.yAxis?e.yAxis:{tickInterval:e.yAxisTick?e.yAxisTick.tickInterval:null,min:e.yAxisTick?e.yAxisTick.min:null,max:e.yAxisTick?e.yAxisTick.max:null,title:{text:e.yTitle},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{formatter:e.formatter},plotOptions:n,legend:{layout:"vertical",align:"right",verticalAlign:"top",x:-10,y:100,borderWidth:0},series:e.yData}),this.chart=i;var t=[];if(e.buttonConf&&e.buttonConf.list&&0<e.buttonConf.list.length){t.push("<div class='pjf-line-button-set'  >"),t.push("<div class='pjf-line-button-set-icon set-icon-show' ></div><ul>");for(var a=0;a<e.buttonConf.list.length;a++){
var s=e.buttonConf.list[a].isActive?"active":"";t.push("<li class='buttonListli "+s+"' index='"+a+"'>"+e.buttonConf.list[a].title+"</li>")}t.push("</ul></div>"),t.push("</div>"),$(t.join("")).appendTo(this.com),this.com.css("position","relative"),this.com.on("click",".pjf-line-button-set-icon",function(){"none"==$(this).next().css("display")?($(this).next().show(),$(this).addClass("set-icon-hide").removeClass("set-icon-show")):($(this).next().hide(),$(this).addClass("set-icon-show").removeClass("set-icon-hide"))}),this.com.on("click",".buttonListli",function(){var t=$(this).attr("index");$(this).siblings().removeClass("active"),$(this).addClass("active"),"function"==typeof e.buttonConf.list[t].click&&e.buttonConf.list[t].click()}),!0===e.buttonConf.show&&this.com.find(".pjf-line-button-set-icon").click()}},reloadChart:function(t){t.buttonConf=[],t.dom=this.dom,this.com.find(".highcharts-container").remove(),this.init(t)},test:function(t,e){this.chart.xAxis.setCategories(t),
this.chart.series[0].setData(e)}}),PJF.apply(PJF.ui.basicLine.prototype,{validateParam:function(t){return!!(t.url||t.xData||t.yData)||(alert(resource.GRAPHIC_CHECK_MSG),!1)},getClassName:function(){return"PJF.ui.basicLine"},destroy:function(){this.com.removeAttr("data-highcharts-chart"),this.com.children().remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},newDestroy:function(){this.com.removeAttr("data-highcharts-chart"),this.com.children().remove(),this.chart.destroy(),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.chart=null,this.com=null,this.id=null}}),PJF.ui.basicPie=PJF.extend(PJF.ui.component,{init:function(e){var i={};i.pie={cursor:"pointer",events:e.bindEvents,allowPointSelect:e.allowPointSelect,dataLabels:{enabled:"undefined"==typeof e.dataLabelsEnable||e.dataLabelsEnable,color:"black",connectorColor:"black",formatter:e.formatter}};var n=this;if(e&&e.url){PJF.communication.ajax({url:e.url,success:function(t){e.data=t.xData,
n.chart=new Highcharts.Chart({chart:{renderTo:e.dom,plotBackgroundColor:e.backgroundColor,plotBorderWidth:e.borderWidth,plotShadow:!1,width:e.width,height:e.height},colors:e.colors,title:{text:e.title},tooltip:{pointFormat:"{series.name}: <b>{point.percentage}%</b>",percentageDecimals:1},plotOptions:i,series:[{type:"pie",name:e.seriesName,data:e.data,showInLegend:e.showInLegend}],legend:{labelFormatter:function(){return this.name+" ("+this.y+"%)"}}})}})}else n.chart=new Highcharts.Chart($.extend(!0,{chart:{renderTo:e.dom,plotBackgroundColor:e.backgroundColor,plotBorderWidth:e.borderWidth,plotShadow:!1,width:e.width,height:e.height},colors:e.colors,title:{text:e.title},tooltip:{pointFormat:"{series.name}: <b>{point.percentage}%</b>",percentageDecimals:1},plotOptions:i,series:[{type:"pie",name:e.seriesName,data:e.data,showInLegend:e.showInLegend}],legend:{labelFormatter:function(){return this.name+" ("+this.y+"%)"}}},e.otherParams))},destroy:function(){
this.com.removeAttr("data-highcharts-chart"),this.com.children().remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},newDestroy:function(){this.com.removeAttr("data-highcharts-chart"),this.com.children().remove(),this.chart.destroy(),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.chart=null,this.com=null,this.id=null}}),PJF.apply(PJF.ui.basicPie.prototype,{validateParam:function(t){return!(!t.url&&!t.data)||(alert(resource.GRAPHIC_CHECK_MSG),!1)},getClassName:function(){return"PJF.ui.basicPie"}}),PJF.ui.spline=PJF.extend(PJF.ui.component,{init:function(e){var i,n=this;e&&e.url?PJF.communication.ajax({url:e.url,success:function(t){e.data=t.data,i=new Highcharts.Chart({chart:{renderTo:e.dom,type:"spline",inverted:!1,width:e.width,height:e.height,style:{margin:"0 auto"}},title:{text:e.title},subtitle:{text:e.subtitle},xAxis:{tickInterval:e.xTickInterval?e.xTickInterval:null,min:e.xAxisMin,reversed:!1,title:{enabled:!0,text:e.xTitle},
labels:e.xLabels?e.xLabels:{formatter:function(){return this.value}},type:e.xAxisType,plotLines:e.plotLinesX,maxPadding:.05,showLastLabel:!0},yAxis:{min:e.yAxisMin,title:{text:e.yTitle},labels:{formatter:function(){return this.value}},plotLines:e.plotLinesY,lineWidth:2},legend:{layout:e.layout,align:"right",verticalAlign:"top",x:-10,y:100,borderWidth:0},tooltip:e.tooltip?e.tooltip:{formatter:e.formatter},plotOptions:{spline:{marker:{enable:!0}}},series:e.series?e.series:[{name:e.seriesName,data:e.data}]}),n.chart=i}}):(i=new Highcharts.Chart($.extend(!0,{chart:{renderTo:e.dom,type:"spline",inverted:!1,width:e.width,height:e.height,style:{margin:"0 auto"}},title:{text:e.title},subtitle:{text:e.subtitle},xAxis:{tickInterval:e.xTickInterval?e.xTickInterval:null,min:e.xAxisMin,reversed:!1,title:{enabled:!0,text:e.xTitle},labels:e.xLabels?e.xLabels:{formatter:function(){return this.value}},type:e.xAxisType,plotLines:e.plotLinesX,maxPadding:.05,showLastLabel:!0},yAxis:{min:e.yAxisMin,title:{
text:e.yTitle},labels:{formatter:function(){return this.value}},plotLines:e.plotLinesY,lineWidth:.1},legend:{layout:e.layout,align:"right",verticalAlign:"top",x:-10,y:100,borderWidth:0},tooltip:e.tooltip?e.tooltip:{formatter:function(){return this.x+":"+this.y}},plotOptions:{spline:{marker:{enable:!1}}},series:e.series?e.series:[{name:e.seriesName,data:e.data}]},e.otherParams)),n.chart=i)}}),PJF.apply(PJF.ui.spline.prototype,{validateParam:function(t){return null!=t.url||null!=t.data||null!=t.series||(alert(resource.GRAPHIC_CHECK_MSG),!1)},getClassName:function(){return"PJF.ui.spline"},hideSeries:function(t){this.chart.series[t].hide()},showSeries:function(t){this.chart.series[t].show()},setData:function(t,e){this.chart.series[t].setData(e)},destory:function(){this.com.removeAttr("data-highcharts-chart"),this.com.children().remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},newDestroy:function(){this.com.removeAttr("data-highcharts-chart"),
this.com.children().remove(),this.chart.destroy(),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.chart=null,this.com=null,this.id=null}}),PJF.ui.basicBar=PJF.extend(PJF.ui.component,{init:function(e){var i={series:{stacking:e.stacking}};e.type&&(i[e.type]={cursor:"pointer",pointWidth:e.pointWidth,events:e.bindEvents});var n=this;if(e&&e.url){PJF.communication.ajax({url:e.url,type:"get",success:function(t){e.xData=t.xData,e.yData=t.yData,n.chart=new Highcharts.Chart({chart:{renderTo:e.dom,type:e.type,margin:e.margin,width:e.width,height:e.height},colors:e.colors,title:{text:e.title},subtitle:{text:e.subtitle},xAxis:{categories:e.xData,title:{text:e.xTitle},labels:e.xlabels},yAxis:{tickInterval:e.yAxisTick?e.yAxisTick.tickInterval:null,min:e.yAxisTick?e.yAxisTick.min:null,max:e.yAxisTick?e.yAxisTick.max:null,title:{text:e.yTitle,align:"high"},labels:{overflow:"justify",formatter:function(){return this.value}}},tooltip:{formatter:e.formatter},plotOptions:i,legend:{
layout:"vertical",align:"right",verticalAlign:"top",x:-10,y:100,borderWidth:0},credits:{enabled:!1},series:e.yData})}})}else n.chart=new Highcharts.Chart($.extend(!0,{chart:{renderTo:e.dom,type:e.type,margin:e.margin,width:e.width,height:e.height},colors:e.colors,title:{text:e.title},subtitle:{text:e.subtitle},xAxis:{categories:e.xData,title:{text:e.xTitle},labels:e.xlabels},yAxis:{tickInterval:e.yAxisTick?e.yAxisTick.tickInterval:null,min:e.yAxisTick?e.yAxisTick.min:null,max:e.yAxisTick?e.yAxisTick.max:null,title:{text:e.yTitle,align:"high"},labels:{formatter:function(){return this.value}}},tooltip:{formatter:e.formatter},plotOptions:i,legend:{layout:"vertical",align:"right",verticalAlign:"top",x:-10,y:100,borderWidth:0},credits:{enabled:!1},series:e.yData},e.otherParams))},destroy:function(){this.com.removeAttr("data-highcharts-chart"),this.com.children().remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},newDestroy:function(){
this.com.removeAttr("data-highcharts-chart"),this.com.children().remove(),this.chart.destroy(),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.chart=null,this.com=null,this.id=null},getClassName:function(){return"PJF.ui.basicBar"}}),PJF.apply(PJF.ui.basicBar.prototype,{validateParam:function(t){return!!(t.url||t.xData||t.yData)||(alert(resource.GRAPHIC_CHECK_MSG),!1)}}),PJF.ui.editor=PJF.extend(PJF.ui.component,{myEditor:null,init:function(t){var e=this;this.btnFnJson={},this.copyComObj=this.com.clone().insertAfter(this.com),this.copyComObj.attr("id",""),this.copyComObj.attr("name",""),this.copyComObj.css("display","none");var i=t.items;if(t.fontName&&KindEditor.lang({"fontname.fontName":t.fontName}),t.lineHeight&&KindEditor.lang({"lineheight.lineHeight":t.lineHeight}),t.cusBtn)for(var n=0;n<t.cusBtn.length;n++)if(t.cusBtn[n]){var o=t.cusBtn[n].btnNm,a=t.cusBtn[n].btnTip,s=(t.cusBtn[n].btnFn,{});s[o]=a,KindEditor.lang(s),i.push(o)}
if(t&&(this.myEditor=KindEditor.create("textarea[id="+t.dom+"]",{resizeType:t.resizeType,allowPreviewEmoticons:t.allowPreviewEmoticons,items:t.items,width:t.width,height:t.height,fontSizeTable:t.fontSizeTable,filePostName:t.uploadName,cusCssPath:t.cusCssPath,templatePath:t.templatePath,uploadJson:t.uploadAction,uploadImgParam:t.uploadImgParam,afterUpload:t.afterUpload,afterBlur:function(){this.sync()},afterChange:function(){t.afterChange&&t.afterChange(this.count(t.countType||"text"))}})),t.cusBtn)for(var r=0;r<t.cusBtn.length;r++)if(t.cusBtn[r]){e.btnFnJson[t.cusBtn[r].btnNm]=t.cusBtn[r].btnFn;var c="ke-icon-"+t.cusBtn[r].btnNm;this.com.prev().children(".ke-toolbar").find("."+c).parent().bind("click",function(){e.btnFnJson[$(this).attr("data-name")](e)})}}}),PJF.apply(PJF.ui.editor.prototype,{getText:function(){return this.myEditor.text()},getHtml:function(){return this.myEditor.html()},clearHtml:function(){this.myEditor.html("")},setText:function(t){this.myEditor.text(t)},
setHtml:function(t){this.myEditor.html(t)},insertHtml:function(t){this.myEditor.insertHtml(t)},appendHtml:function(t){this.myEditor.appendHtml(t)},getClassName:function(){return"PJF.ui.editor"},destroy:function(){var t=this.com.attr("id"),e=this.com.attr("name");this.copyComObj.attr("id",t),this.copyComObj.attr("name",e),this.copyComObj.removeAttr("style"),this.com.prev(".ke-container").remove(),this.com.remove(),this.params=null,this.com=null,this.id=null,this.myEditor=null},newDestroy:function(){var t=this.com.attr("id"),e=this.com.attr("name");this.copyComObj.attr("id",t),this.copyComObj.attr("name",e),this.myEditor.remove(),PJF.ui.componentMgr.remove(this.id),this.com.prev(".ke-container").remove(),this.com.remove(),this.params=null,this.com=null,this.id=null,this.myEditor=null},setImageUrl:function(t){$.ajax({url:t,type:"GET",complete:function(t){200==t.status||alert("请检查图片地址是否有效!")}}),this.myEditor.appendHtml('<p><img src="'+t+'" data-ke-src="'+t+'"/></p>')}}),
PJF.ui.subPanel=PJF.extend(PJF.ui.component,{init:function(i){this.content=$("#"+this.dom).html();var n=i.collapsed,t=i.width||"auto",e=i.height||"auto",o=i.title||resource.SUBPANEL_DEFAULT_TITLE,a=this.com.addClass("pjf_subPanel-body");$(a).css({width:t+"px",height:e+"px"});var s='<div class="pjf_subPanel" style ="width:'+t+'px;display: block;"></div>',r="";0!=n?($(a).css("display","none"),r="pjf_subPanel-header-tool-expand"):($(a).css("display","block"),r="pjf_subPanel-header-tool-collapse");var c='<div class="pjf_subPanel-header" style ="width:'+t+'px;"><div class="pjf_subPanel-header-title"></div><div class ="pjf_subPanel-header-tool"><a class ="'+r+'" href="javascript:void(0)"></a></div></div>';a=$(a).wrap(s);var l,d=$(c).insertBefore(a);(this.subPanel=d).find(".pjf_subPanel-header-title").html(o),l=0!=n?d.find(".pjf_subPanel-header-tool-expand"):d.find(".pjf_subPanel-header-tool-collapse"),$(d).click(function(t,e){0!=(n=e===undefined?n:e)?(i.onClick&&i.onClick(),
$(a).slideDown("slow"),l.removeClass("pjf_subPanel-header-tool-expand"),l.addClass("pjf_subPanel-header-tool-collapse"),n=!1):($(a).slideUp("slow"),l.removeClass("pjf_subPanel-header-tool-collapse"),l.addClass("pjf_subPanel-header-tool-expand"),n=!0)})},setCollapse:function(t){$(this.subPanel).trigger("click",t)},destroy:function(){this.com.removeAttr("class").removeAttr("title").removeAttr("style").children().remove(),this.com.empty(),$("#"+this.dom).html(this.content),this.com.clone().insertAfter(this.com.parent()),this.com.parent().remove(),this.content=null,this.com=null,this.params=null,this.id=null},newDestroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.destroy()}}),PJF.apply(PJF.ui.subPanel.prototype,{validateParam:function(t){return t.dom?(this.dom=t.dom,
!0):(alert(resource.SUBPANEL_VALIDATEPARM_INFO),!1)},getClassName:function(){return"PJF.ui.subPanel"}}),PJF.ui.tip=PJF.extend(PJF.ui.component,{init:function(t){var n=this;if(t.dom&&!t.free&&this.com.checkTip({show:t.show,flag:t.flag,left:t.left,top:t.top,width:t.width,height:t.height,Message:t.message}),n.conf=t,n.conf.free){var e=n.conf.dom;$("#"+e).bind("mouseover",function(){var t=n.conf.dom+"_tip",e=$(this).offset().left,i=$(this).offset().top;1!=$(this).find(".free_tip").length&&($("body").append("<div class='free_tip' id="+t+"><span class='free_tip_up'>"+n.conf.Message+"</span><span class='free_tip_arrow'></span></div>"),$(this).css("cursor","pointer"),n.tip=$("#"+t),n.conf.left?n.tip.css("left",e+n.conf.left):n.tip.css("left",e+5),n.conf.arrow="up"==n.conf.arrow?n.conf.arrow:"down",n.tip.find(".free_tip_arrow").addClass("free_tip_arrow_"+n.conf.arrow),n.conf.arrowleft&&n.tip.find(".free_tip_arrow").css("left",n.conf.arrowleft),n.conf.height&&n.tip.height(n.conf.height),
n.conf.width&&n.tip.css({width:n.conf.width,"max-width":n.conf.width}),n.conf.top?n.tip.css("top",i+n.conf.top):n.tip.css("top",i-n.tip.height()-10),n.conf.onShow&&n.conf.onShow())}).bind("mouseout",function(){$("#"+t.dom+"_tip").remove(),n.conf.onHide&&n.conf.onHide()})}}}),PJF.apply(PJF.ui.tip.prototype,{setValue:function(t,e){if("string"==typeof t&&(this.params.Message=t),e){var i=e.width?e.width:"",n=e.height?e.height:"",o=e.top?e.top:"",a=e.left?e.left:"";this.setSize(i,n),this.setPos(o,a)}},setPos:function(t,e){t&&(this.conf.top=t,this.tip&&this.tip.css("top",this.conf.top)),e&&(this.conf.left=e,this.tip&&this.tip.css("left",this.conf.left))},setSize:function(t,e){t&&(this.conf.width=t,this.tip&&this.tip.css("width",this.conf.width)),e&&(this.conf.height=e,this.tip&&this.tip.css("height",this.conf.height))},destroy:function(){for(a in this.com.unbind("mouseover"),this.com.css("cursor",""),PJF.ui.componentMgr.remove(this.id),this)this[a]=null},newDestroy:function(){
this.com&&this.com.remove(),this.destroy()}}),PJF.namespace("PJF.ui.gridUtil"),PJF.ui.treegrid=PJF.extend(PJF.ui.component,{init:function(i){this.conf=i,this.filterParams(i);var n=this,t=i.title;!1!==t&&(t=i.title||resource.TREEGRID_DEFAULT_TITLE),this.createToolbar(i),this.com.treegrid({fitColumns:i.fitColumns==undefined||i.fitColumns,id:i.id,title:t,iconCls:i.iconCls||"icon-save",width:i.width||700,height:i.height||350,nowrap:!1,rownumbers:i.rownumbers,pagination:!0===i.enablePagination&&!0===i.pagination,showPageList:!1,isCCBS:!1,animate:!0,collapsible:i.collapsible==undefined||i.collapsible,url:i.url,queryParams:i.queryParams,idField:i.idField,treeField:i.treeField,rowsPath:i.rowsPath||"rows",totalPath:i.totalPath||"total",pageSizeParamName:i.pageSizeParamName||"REC_IN_PAGE",pageNumberParamName:i.pageNumberParamName||"PAGE_JUMP",paginationParamsLevelName:i.paginationParamsLevelName||"_pagination",columns:i.columns,singleSelect:!0!==i.supportMulti||!1!==i.singleSelect,
enableHighPerformance:i.enableHighPerformance,pageChangeHandler:i.pageChangeHandler||function(t,e,i){n.conf[t+"BtnHandler"]&&n.conf[t+"BtnHandler"](e,i)},toolbar:i.toolbar||[],onContextMenu:function(t,e){if(i.onContextMenu)return i.onContextMenu(t,e)},onClickRow:i.onClickRow,onDblClickRow:i.onDblClickRow,onClickCell:i.onClickCell,onDblClickCell:i.onDblClickCell,onBeforeLoad:this._onBeforeLoad(this),onLoadSuccess:this._onLoadSuccess(this),onLoadError:this._onLoadError(this),onBeforeExpand:this._onBeforeExpand(this),onExpand:i.onExpand,loadFilter:i.loadFilter,onBeforeCollapse:i.onBeforeCollapse,onCollapse:i.onCollapse,onBeforeEdit:i.onBeforeEdit,onAfterEdit:i.onAfterEdit,onCancelEdit:i.onCancelEdit,onLoadFailure:i.onLoadFailure,dataErrorHandler:function(t,e){if(!e)return!0;if(e.BK_STATUS&&e.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS){var i="";e._COMMON&&e._COMMON.SYS_EVT_TRACE_ID&&(i=e._COMMON.SYS_EVT_TRACE_ID);var n=e.BK_DESC;return e.FLLW_GUIDE&&(n+="~"+e.FLLW_GUIDE),
new PJF.ui.errorMessageBox({title:resource.GRID_RESPONSE_REQUEST_FAIL,desc:n,code:e.BK_CODE,traceId:i,fn:function(){t.onLoadFailure&&t.onLoadFailure(e)}}),!0}return!1}});var e=$(this.com[0].parentNode.parentNode).prev();e.addClass("pjfPanel-header pjfTreegrid-header"),e.find(".panel-title").removeClass("panel-with-icon").next().removeClass("icon-save"),this.resetToolbarButtonStyle(i)},filterParams:function(t){if(t.toolbar)for(var e=0,i=t.toolbar.length;e<i;e++)t.toolbar[e].style=t.toolbar[e].style||"assistant",t.toolbar[e].handler||(t.toolbar[e].handler=t.toolbar[e].onclick)},isStriped:function(t,e){for(var i=0;i<e.length;i++)if(t==e[i]){i;break}return i%2!=0}}),PJF.apply(PJF.ui.treegrid.prototype,{getClassName:function(){return"PJF.ui.treegrid"},resetToolbarButtonStyle:function(t){this.treegridDom||(this.treegridDom=this.com.treegrid("getGridDom"));var e=this.treegridDom.panel;if(t.toolbar&&0!=t.toolbar.length){$("div.datagrid-toolbar",e).show()
;for(var i=$("div.datagrid-toolbar-entity",e).children("a").removeClass(),n=0;n<i.length;n++)if(i[n].firstChild){var o=PJF.constants.PJF_LINKBUTTON_STYLE;i[n].className=o["default"].defStatus.left+" "+o.assistant.defStatus.left+" linkBtn_margin",i[n].firstChild.className=o["default"].defStatus.middle+" "+o.assistant.defStatus.middle,$(i[n].firstChild).find("span:last")[0].className=o["default"].defStatus.right+" "+o.assistant.defStatus.right}}else $("div.datagrid-toolbar",e).hide()},createToolbar:function(t){if(t.toolbar)for(var e in t.toolbar){var i=t.toolbar[e].key;i&&0==i.indexOf("treegrid_toolbar_btn_")||$.extend(t.toolbar[e],{key:t.toolbar[e].key?"treegrid_toolbar_btn_"+t.toolbar[e].key:""})}},addToolbarButton:function(t){if(t&&(t instanceof Array||(t=[t]),0!=t.length)){var e=this.treegridDom.panel;$("div.datagrid-toolbar",e).show();for(var i=$("div.datagrid-toolbar-entity",e),n=[],o=0,a=t.length;o<a;o++){(s=t[o]).key==undefined&&(s.key=this.generateId()),
n.push('<a id ="treegrid_toolbar_btn_'+s.key+'" href="##" ></a>')}i.append(n.join(""));for(o=0,a=t.length;o<a;o++){var s=t[o];new PJF.ui.linkButton({dom:"treegrid_toolbar_btn_"+s.key,name:s.name,onclick:s.onclick,style:s.style||"assistant",align:s.align||"left"})}}},disableToolbarButton:function(t,e,i){var n=this.treegridDom.panel,o=$("div.datagrid-toolbar-entity",n),a=$("#treegrid_toolbar_btn_"+t,o);this._disableToolbarButton(a,e,i)},_disableToolbarButton:function(t,e,i){t&&0!=t.length?(i=i||"assistant",e?(t.pjfLinkButton({disabled:!0}),t[0].className="assistant"==i?" pjf_linkBtn_assistant_disable_left pjf_linkBtn_disable_left linkBtn_margin":" pjf_linkBtn_disable_left linkBtn_margin",t[0].firstChild.className="assistant"==i?" pjf_linkBtn_assistant_disable pjf_linkBtn_disable":" pjf_linkBtn_disable",$(t[0].firstChild).find("span:last")[0].className+="assistant"==i?" pjf_linkBtn_assistant_disable_right pjf_linkBtn_disable_right":" pjf_linkBtn_disable_right"):(t.pjfLinkButton({
disabled:!1}),t[0].className="assistant"==i?" pjf_linkBtn_left pjf_linkBtn_assistant_left linkBtn_margin":" pjf_linkBtn_left linkBtn_margin",t[0].firstChild.className="assistant"==i?" pjf_linkBtn pjf_linkBtn_assistant":" pjf_linkBtn ",$(t[0].firstChild).find("span:last")[0].className+="assistant"==i?" pjf_linkBtn_right pjf_linkBtn_assistant_right ":" pjf_linkBtn_right")):new PJF.ui.messageBox({title:"提示：",content:"不存在目标对象，操作终止！"})},setToolbarButtonVisible:function(t,e){var i=this.treegridDom.panel,n=$("div.datagrid-toolbar-entity",i),o=$("#treegrid_toolbar_btn_"+t,n);e?(o.show(),o.focus()):o.hide()},log:function(t,e){if(this.conf.showLog)if(e)console.log(t);else if("string"!=typeof t)for(var i in console.log("type ---\x3e "+typeof t),console.log(t),t)console.log(t[i]);else console.log("-----------"+t+"-------------")},_onBeforeLoad:function(i){return function(t,e){return i.log("_onBeforeLoad"),!i.conf.onBeforeLoad||i.conf.onBeforeLoad(t,e)}},_onLoadSuccess:function(i){
return function(t,e){i.log("_onLoadSuccess"),i.conf.onLoadSuccess&&i.conf.onLoadSuccess(t,e)}},_onLoadError:function(e){return function(t){e.log("_onLoadError"),e.conf.onLoadError?e.conf.onLoadError(t):PJF.configuration.ajaxFailure()}},_onBeforeExpand:function(e){return function(t){return e.log("_onBeforeExpand"),!e.conf.onBeforeExpand||e.conf.onBeforeExpand(t)}},updateRequestParam:function(t){this.log("updateRequestParam"),this.getOptions().queryParams=$.extend({},this.conf.queryParams,t)},getOptions:function(){return this.com.treegrid("options")},resizeTreeGrid:function(t){this.com.treegrid("resize",t)},bindEventAction:function(t,e){var i=this.com.treegrid("options");"onSelect"==t&&(i.onSelect=e),"onBeforeLoad"==t&&(i.onBeforeLoad=e),"onLoadSuccess"==t&&(i.onLoadSuccess=e),"onLoadError"==t&&(i.onLoadError=e),"onClickRow"==t&&(i.onClickRow=e),"onDblClickRow"==t&&(i.onDblClickRow=e),"onClickCell"==t&&(i.onClickCell=e),"onDblClickCell"==t&&(i.onDblClickCell=e),
"onSortColumn"==t&&(i.onSortColumn=e),"onResizeColumn"==t&&(i.onResizeColumn=e),"onUnselect"==t&&(i.onUnselect=e),"onSelectAll"==t&&(i.onSelectAll=e),"onUnselectAll"==t&&(i.onUnselectAll=e),"onCheck"==t&&(i.onCheck=e),"onUncheck"==t&&(i.onUncheck=e),"onCheckAll"==t&&(i.onCheckAll=e),"onUncheckAll"==t&&(i.onUncheckAll=e),"onBeforeEdit"==t&&(i.onBeforeEdit=e),"onAfterEdit"==t&&(i.onAfterEdit=e),"onCancelEdit"==t&&(i.onCancelEdit=e),"onHeaderContextMenu"==t&&(i.onHeaderContextMenu=e),"onRowContextMenu"==t&&(i.onRowContextMenu=e)},loadData:function(t){return this.com.treegrid("loadData",t)},reload:function(t){this.com.treegrid("reload",t)},getData:function(){if(!this.conf.isAsync)return this.com.treegrid("getData");var t=this.getRoots(),e=[];for(var i in t)e.push(t[i]),e.push(this.getChildren(t[i][this.conf.idField]));return e},getFooterRows:function(){return this.com.treegrid("getFooterRows")},getRoot:function(){return this.com.treegrid("getRoot")},getRoots:function(){
return this.com.treegrid("getRoots")},getParent:function(t){return this.com.treegrid("getParent",t)},getChildren:function(t){return this.com.treegrid("getChildren",t)},getSelected:function(){return this.com.treegrid("getSelected")},getSelections:function(){return this.com.treegrid("getSelections")},getLevel:function(t){return this.com.treegrid("getLevel",t)},find:function(t){return this.com.treegrid("find",t)},select:function(t){this.com.treegrid("select",t)},unselect:function(t){this.com.treegrid("unselect",t)},selectAll:function(){this.com.treegrid("selectAll")},unselectAll:function(){this.com.treegrid("unselectAll")},collapse:function(t){this.com.treegrid("collapse",t)},expand:function(t){this.com.treegrid("expand",t)},collapseAll:function(t){this.com.treegrid("collapseAll",t)},expandAll:function(t){this.com.treegrid("expandAll",t)},expandToLevel:function(t,e){this.com.treegrid("expandAll",t,e);var i=$.data(this.com[0],"treegrid_expand_next_level_nodes")||[];if(e){
if(t&&0==i.length)for(var n=this.find(t).children||[],o=this.getOptions().idField,a=0,s=n.length;a<s;a++)this.collapseAll(n[a][o]);for(a=0,s=i.length;a<s;a++)this.collapseAll(i[a])}},expandTo:function(t){this.com.treegrid("expandTo",t)},toggle:function(t){this.com.treegrid("toggle",t)},append:function(t){this.com.treegrid("append",t)},remove:function(t){this.com.treegrid("remove",t)},refresh:function(t){this.com.treegrid("refresh",t)},beginEdit:function(t){this.com.treegrid("beginEdit",t)},endEdit:function(t){this.com.treegrid("endEdit",t)},cancelEdit:function(t){this.com.treegrid("cancelEdit",t)},getEditors:function(t){this.com.treegrid("getEditors",t)},getEditor:function(t){this.com.treegrid("getEditor",t)},hideColumn:function(t){this.com.treegrid("hideColumn",t)},showColumn:function(t){this.com.treegrid("showColumn",t)},setRequestOptions:function(t,e){for(var i in t)this.com.treegrid("options")[i]=t[i];e?this.com.treegrid("reload"):this.com.treegrid("loadFirstPage")}}),
PJF.ui.treeSelect=PJF.extend(PJF.ui.component,{init:function(e){var a=this;a.readonlyflag=!1,a.disableflag=!1,a.showflag=!0,this.setting=$.extend({dom:null,id:this.generateId(),spanId:this.generateId(),hiddenId:this.generateId(),tree:null,url:undefined,name:e.name,deleteNodes:[],required:!1,missingMessage:resource.SELECT_MISSING_MSG,txtField:null,container:null,containerId:this.generateId(),multiple:!0,maxHeight:350,onExpand:null,isLayer:!0,sorted:e.sorted||!1,width:e.width||null,divId:this.generateId(),textKey:"itemName",fwServiceId:"fetchStanderdCodeModelListByParams",jsonData:{},jsonClass:"com.ccb.model.StandardDataCategory",onChange:null,checkNodes:[],inputNodes:[],onlyChild:!1,isOut:!0,setSelect:[],initHistory:!0,preSearchValue:"",halfCheckFlag:e.halfCheckFlag},e),
this.com.append("<input type='text'"+(e.search?"":"readonly='readonly'")+" class='pjf_select validatebox-text' id='"+this.setting.id+"'/><span class='pjf_span' id='"+a.setting.spanId+"'></span><input type='hidden' name='"+a.setting.name+"' id='"+a.setting.hiddenId+"'/>");var i=$("#"+this.setting.id);a.setting.required&&$("#"+a.setting.id).addClass("validatebox-invalid invalid_box"),$("#"+a.setting.id).live("blur",function(){var t=a.getValue();a.setting.required&&(""==t||null==t?i.checkTip({show:function(){return!1},Message:a.setting.missingMessage}):i.checkTip({show:function(){return!0}}))}),$("#"+this.setting.dom).addClass("pjf_select_parent"),a.setting.width||(a.setting.width=189),a.setting.maxHeight||(a.setting.maxHeight=350),$("#"+a.setting.id).css("width",a.setting.width-21+"px"),a.setting.container||console.log(a.setting.divId+"[[[[[[[[[[[[[[[[[[["),
a.setting.container=$("<div id='"+a.setting.divId+"' style='position:absolute;z-index:9999;display:none;background-color:#FFFFFF;width:"+a.setting.width+"px'><div class='autocomplete' style='min-height:0%;max-Height:"+a.setting.maxHeight+"px'><ul class='pjf_treeSelect'  id='"+a.setting.containerId+"'></ul></div></div>"),a.setting.container.appendTo("body"),a.setting.isCustom?a.createTree2():a.createTree(),$("#"+a.setting.id).live("blur",function(){setTimeout(function(){a.setting.isOut&&($("#"+a.setting.id).removeClass("focus-border-select"),$("#"+a.setting.divId).css("display","none"))},1e3)}),$("#"+a.setting.divId).live("mouseleave",function(){if("undefined"!=typeof a.setting.historyKey&&PJF.communication.client.isInP2()){var t=[],e=[],i=a.setting.tree.getCheckedNodes();for(var n in i){var o={};o.itemValue=i[n].itemValue,o.itemName=i[n].itemName,-1==PJF.util.array.indexOf(e,o.itemValue)&&(t.push(o),e.push(o.itemValue))}
PJF.communication.client.pjfCache("set",a.setting.historyKey,PJF.util.json2str(t).replace(/'/g,'"'))}$("#"+a.setting.divId).css("display","none")}),$("#"+a.setting.divId).live("mouseenter",function(){a.setting.isOut=!1}),$("#"+a.setting.spanId).live("click",function(){if(e.search?a.setting.isOut=!1:$("#"+a.setting.id).trigger("focus",[!0]),!$("#"+a.setting.spanId).siblings("input:visible").hasClass("pjf_readonly_input")){if(a.setting.maxHeight&&$("#"+a.setting.containerId).css("max-height",a.setting.maxHeight+"px"),e.search){var t=$("#"+a.setting.id).val();a.setting.preSearchValue!=t&&(a.setting.tree.showNodesByParamFuzzy(a.setting.textKey,t,null,a.setting.highPerformance),a.setting.preSearchValue=t)}a.displayTreeDiv(!0)}}),e.search&&$("#"+a.setting.id).bind("focus",function(t,e){}),PJF.constants.KEYBOARD_ENABLE&&(window.opera?$("#"+a.setting.id).keypress(function(t){a.keyPress(t)}):$("#"+a.setting.id).keydown(function(t){a.keyPress(t)}))},keyPress:function(t){
var e=this.setting.divId,i=this.setting.containerId,n=$("#"+i+"_ul").children("li"),o=($("#"+e).attr("style"),$("#"+this.setting.divId+" a"));switch(t.keyCode){case 13:PJF.ui.componentMgr.getNextComp(this).focus();break;case 38:if("none"==$("#"+e).css("display")){PJF.ui.componentMgr.getPreviousComp(this).focus();break}for(var a=0;a<o.length;a++){var s=$(o[a]).attr("id"),r=$($("#"+s).parent()).attr("id"),c=$($("#"+r+" span:first-child")).attr("id");$($("#"+s).parent()).attr("id");if($("#"+s).hasClass("curSelectedNode")&&0<a)for(var l=$(o[a-1]).attr("id"),d=$($("#"+l).parent()).attr("id"),u=($($("#"+d+" span:first-child")).attr("id"),$($("#"+l).parent()).attr("id")),h=0;h<n.length;h++){if((u=$($("#"+s).parent()).attr("id"))==$(n[h]).attr("id")&&0<h&&($(n[h]).hasClass("switch noline_close")||$(n[h]).hasClass("switch noline_docu"))){var p=$(n[h-1]).children("a");$(p[0]).addClass("curSelectedNode"),$("#"+s).removeClass("curSelectedNode"),$("#"+this.setting.id).focus();break}
$("#"+l).addClass("curSelectedNode"),$("#"+s).removeClass("curSelectedNode"),$("#"+this.setting.id).focus()}}break;case 229:case 107:if("none"==$("#"+e).css("display"))this.displayTreeDiv(!0,!0);else for(a=0;a<o.length;a++){s=$(o[a]).attr("id"),r=$($("#"+s).parent()).attr("id"),c=$($("#"+r+" span:first-child")).attr("id");var f=$($("#"+r+" span:nth-child(2)")).attr("id");if($("#"+s).hasClass("curSelectedNode")){$("#"+f).click(),$("#"+this.setting.id).focus(),t.preventDefault();break}}break;case 37:for(a=0;a<o.length;a++){s=$(o[a]).attr("id"),r=$($("#"+s).parent()).attr("id"),c=$($("#"+r+" span:first-child")).attr("id"),f=$($("#"+r+" span:nth-child(2)")).attr("id");$("#"+s).hasClass("curSelectedNode")&&$("#"+c).hasClass("switch noline_open")&&($("#"+c).click(),$("#"+this.setting.id).focus())}break;case 39:for(a=0;a<o.length;a++){s=$(o[a]).attr("id"),r=$($("#"+s).parent()).attr("id"),c=$($("#"+r+" span:first-child")).attr("id"),f=$($("#"+r+" span:nth-child(2)")).attr("id")
;$("#"+s).hasClass("curSelectedNode")&&$("#"+c).hasClass("switch noline_close")&&($("#"+c).click(),$("#"+this.setting.id).focus())}break;case 40:if("none"==$("#"+e).css("display")){PJF.ui.componentMgr.getNextComp(this).focus();break}for(a=0;a<o.length-1;a++){s=$(o[a]).attr("id"),r=$($("#"+s).parent()).attr("id"),c=$($("#"+r+" span:first-child")).attr("id");var m=$(o[a+1]).attr("id"),g=$($("#"+m).parent()).attr("id"),v=$($("#"+g+" span:first-child")).attr("id");$($("#"+v).parent()).attr("id");if($("#"+s).hasClass("curSelectedNode")){for(h=0;h<n.length;h++){u=$($("#"+s).parent()).attr("id"),p=$(n[h+1]).children("a");if(u==$(n[h]).attr("id")&&h<n.length-1&&($(n[h]).hasClass("switch noline_close")||$(n[h]).hasClass("switch noline_docu"))){$(p[0]).addClass("curSelectedNode"),$("#"+s).removeClass("curSelectedNode"),$("#"+this.setting.id).focus();break}$("#"+m).addClass("curSelectedNode"),$("#"+s).removeClass("curSelectedNode")}$("#"+this.setting.id).focus();break}}}},focus:function(){
$("#"+this.setting.id).trigger("focus"),$("#"+this.setting.id).addClass("focus-border-select")},displayTreeDiv:function(t,e){if(this.setting.tree){var i=$("#"+this.setting.divId).css("display"),n=$("#"+this.setting.id).attr("disabled");if(!0===t){if(!n&&("none"==i?$("#"+this.setting.divId).css("display","block"):$("#"+this.setting.divId).css("display","none"),e))for(var o=$("#"+this.setting.divId+" span"),a=0;a<o.length;a++)$(o[a]).hasClass("button chk radio_true_full")||($("#"+this.setting.containerId+"_ul_1_a ").addClass("curSelectedNode"),$("#"+this.setting.id).focus())}else if($("#"+this.setting.divId).css("display","block"),e)for(o=$("#"+this.setting.divId+" span"),a=0;a<o.length;a++)$(o[a]).hasClass("button chk radio_true_full")||($("#"+this.setting.containerId+"_ul_1_a ").click(),$("#"+this.setting.id).focus())}this.fixPostion();var s=$("#"+this.setting.divId).width(),r=$("#"+this.setting.containerId).height()
;s>this.setting.width&&($("#"+this.setting.containerId).css("width",this.setting.width+"px"),$("#"+this.setting.containerId).parent().css("width",this.setting.width+"px"),$("#"+this.setting.divId).css("width",this.setting.width+"px")),r>this.setting.maxHeight&&($("#"+this.setting.containerId).css("height",this.setting.maxHeight+"px"),$("#"+this.setting.containerId).parent().css("height",this.setting.maxHeight+"px"),$("#"+this.setting.divId).css("height",this.setting.maxHeight+"px")),this.fixPostion()},getSelectValue:function(){var t=[];return this.setting.multiple?($("#"+this.setting.dom).find("input:hidden").each(function(){""!=$(this).val()&&$(this).val()!=undefined&&t.push($(this).val())}),t):$("#"+this.setting.dom).find("input:hidden").val()},getValue:function(){var t=[];return this.setting.multiple?($("#"+this.setting.dom).find("input[type='hidden']").each(function(){""!=$(this).val()&&$(this).val()!=undefined&&t.push($(this).val())}),
t):$("#"+this.setting.dom).find("input[type='hidden']").val()},disabled:function(){$("#"+this.setting.id).attr("disabled","disabled").addClass("pjf_disabled_input"),$("#"+this.setting.dom).find("input:hidden").attr("disabled","disabled"),$("#"+this.setting.spanId).die("click")},disable:function(){this.disableflag=!0,$("#"+this.setting.divId).css("display","none"),$("#"+this.setting.id).attr("disabled","disabled").addClass("pjf_disabled_input"),$("#"+this.setting.dom).find("input:hidden").attr("disabled","disabled"),$("#"+this.setting.spanId).die("click")},enable:function(){this.disableflag=!1;var e=this;$("#"+this.setting.spanId).die("click"),$("#"+this.setting.id).removeAttr("disabled","disabled").removeClass("pjf_disabled_input"),$("#"+this.setting.dom).find("input:hidden").removeAttr("disabled","disabled"),$("#"+this.setting.spanId).live("click",function(){if($("#"+e.setting.divId).live("mouseleave",function(){$("#"+e.setting.divId).css("display","none")}),
e.setting.maxHeight&&$("#"+e.setting.containerId).css("max-height",e.setting.maxHeight+"px"),e.setting.search){var t=$("#"+e.setting.id).val();e.setting.preSearchValue!=t&&(e.setting.tree.showNodesByParamFuzzy(e.setting.textKey,t,null,e.setting.highPerformance),e.setting.preSearchValue=t)}e.setting.tree&&("none"==$("#"+e.setting.divId).css("display")?$("#"+e.setting.divId).css("display","block"):$("#"+e.setting.divId).css("display","none"));e.fixPostion()}),e.setting.search&&$("#"+e.setting.id).bind("focus",function(t,e){})},getClassName:function(){return"PJF.ui.treeSelect"},setValue:function(t){var e=this;if(e.setting.checkNodes=[],$("#"+e.setting.dom).find("input[type='hidden']").each(function(){$(this).val()||$(this).remove()}),e.setting.multiple){if(t instanceof Array){var i=[];for(var n in t){i.push(t[n].itemName),$("<input type='hidden' name='"+e.setting.name+"' value='"+t[n].itemValue+"'/>").insertAfter("#"+this.setting.id),
(o=e.setting.tree.getNodeByParam("itemValue",t[n].itemValue))?e.setting.tree.checkNode(o,!0,!0):e.setting.checkNodes.push(t[n])}$("#"+this.setting.id).val(i.toString())}}else if("object"==typeof t){var o=e.setting.tree.getNodeByParam("itemValue",t.itemValue);$("#"+this.setting.id).val(t.itemName),$("#"+e.setting.dom).find("input[type='hidden']").remove(),$("<input type='hidden' name='"+e.setting.name+"' value='"+t.itemValue+"'/>").insertAfter("#"+e.setting.id),o?e.setting.tree.checkNode(o,!0,!0):(e.setting.checkNodes=[],e.setting.checkNodes.push(t))}$("#"+e.setting.dom).find("div.errorbox_ipt_help").remove(),$("#"+e.setting.dom).removeClass("validatebox-tipcolor error-border"),$("#"+e.setting.id).removeClass("validatebox-tipcolor error-border")},setSelectValue:function(t){var e=this;if(e.setting.checkNodes=[],$("#"+e.setting.dom).find("input:hidden").each(function(){$(this).val()||$(this).remove()}),e.setting.multiple){var i=[];for(var n in t){i.push(t[n].itemName),
$("<input type='hidden' name='"+e.setting.name+"' value='"+t[n].itemValue+"'/>").insertAfter("#"+this.setting.id),(o=e.setting.tree.getNodeByParam("itemValue",t[n].itemValue))?e.setting.tree.checkNode(o,!0,!0):e.setting.checkNodes.push(t[n])}$("#"+this.setting.id).val(i.toString())}else{var o=e.setting.tree.getNodeByParam("itemValue",t.itemValue);$("#"+this.setting.id).val(t.itemName),$("<input type='hidden' name='"+e.setting.name+"' value='"+t.itemValue+"'/>").insertAfter("#"+e.setting.id),o?e.setting.tree.checkNode(o,!0,!0):(e.setting.checkNodes=[],e.setting.checkNodes.push(t))}$("#"+e.setting.dom).find("div.errorbox_ipt_help").remove(),$("#"+e.setting.dom).removeClass("validatebox-tipcolor error-border"),$("#"+e.setting.id).removeClass("validatebox-tipcolor error-border")},getParentNode:function(t){var e=this.setting.tree.getNodeByParam("itemValue",t);return this.setting.tree.getParent(e)},deleteNode:function(t){var e=this.setting.tree.getNodeByParam("itemValue",t)
;e?this.setting.tree.deleteNode(e):this.setting.deleteNodes.push(t)},addNodes:function(t,e){if(t){var i=this.setting.tree.getNodeByParam("itemValue",t);if(this.setting.tree.getChildrenNodes(i))for(var n in e)this.setting.tree.addTreeNode(i,PJF.util.json2str(e[n]));else for(var o in e)for(var a=this.setting.deleteNodes.length-1;0<=a;a--)this.setting.deleteNodes[a]==e[o].itemValue&&this.setting.delteNodes.splice(a,1)}else for(var n in e)this.setting.tree.addTreeNode(null,PJF.util.json2str(e[n]))},getSelectText:function(){return $("#"+this.setting.id).val()},fixPostion:function(){var t=$("#"+this.setting.id).offset();this.setting.container.css({top:t.top+$("#"+this.setting.id).innerHeight()+"px",left:t.left+1+"px"})},destoryTree:function(){$("#"+this.setting.divId).css("display","none")},destroyTree:function(){$("#"+this.setting.divId).css("display","none")},setRequired:function(t){var e=this,i=$("#"+e.setting.id);t?(e.setting.requried=!0,
$("#"+e.setting.id).addClass("validatebox-invalid invalid_box"),$("#"+e.setting.id).live("blur",function(){var t=$("#"+e.setting.id).val();""==t||null==t?i.checkTip({show:function(){return!1},Message:e.setting.missingMessage}):i.checkTip({show:function(){return!0}})})):(e.setting.requried=!1,$("#"+e.setting.id).removeClass("validatebox-invalid invalid_box"),$("#"+e.setting.id).die("blur"),this.com.find("input").removeClass("validatebox-tipcolor error-border"),this.com.removeClass("validatebox-tipcolor error-border").find("div.errorbox_ipt_help").remove())},setReadOnly:function(t){var i=this;(i.readonlyflag=t)?($("#"+this.setting.divId).css("display","none"),$("#"+this.setting.id).addClass("pjf_readonly_input"),$("#"+this.setting.id).attr("readonly","readonly"),$("#"+this.setting.spanId).die("click")):($("#"+i.setting.divId).css("display","none"),$("#"+this.setting.spanId).die("click"),$("#"+this.setting.id).removeClass("pjf_readonly_input"),
$("#"+this.setting.id).removeAttr("readonly","readonly"),$("#"+this.setting.spanId).live("click",function(){if(!$("#"+i.setting.spanId).siblings("input:visible").hasClass("pjf_readonly_input")){if($("#"+i.setting.divId).live("mouseleave",function(){}),i.setting.maxHeight&&$("#"+i.setting.containerId).css("max-height",i.setting.maxHeight+"px"),i.setting.search){var t=$("#"+i.setting.id).val();i.setting.preSearchValue!=t&&(i.setting.tree.showNodesByParamFuzzy(i.setting.textKey,t,null,i.setting.highPerformance),i.setting.preSearchValue=t)}if(i.setting.tree)"none"==$("#"+i.setting.divId).css("display")?$("#"+i.setting.divId).css("display","block"):$("#"+i.setting.divId).css("display","none");i.fixPostion()}}),i.setting.search&&$("#"+i.setting.id).bind("focus",function(t,e){$("#"+i.setting.divId).css("display","none")}))},clear:function(){var i=this;this.setting.multiple||$("#"+this.setting.dom).find("input:hidden").each(function(){
var t=$(this).val(),e=i.setting.tree.getNodeByParam("itemValue",t);e&&i.setting.tree.unCheckNode(e,!0)}),$("#"+this.setting.id).val(""),$("#"+this.setting.dom).find("input:hidden").each(function(){$(this).val("")}),this.setting.tree.unCheckAllNodes()},clearValue:function(){var i=this;this.setting.multiple||$("#"+this.setting.dom).find("input:hidden").each(function(){var t=$(this).val(),e=i.setting.tree.getNodeByParam("itemValue",t);e&&i.setting.tree.unCheckNode(e,!0)}),$("#"+this.setting.id).val(""),$("#"+this.setting.dom).find("input:hidden").each(function(){$(this).val("")}),this.setting.tree.unCheckAllNodes()},setParam:function(t,e,i,n){this.setting.url=t,this.setting.categoryId=e,this.setting.appId=i,this.setting.clcd=n,this.setting.tree=null,$("#"+this.setting.containerId).children().remove(),this.createTree()},destroy:function(){$("#"+this.setting.dom).children().remove(),this.setting.checkNodes=[],$("#"+this.setting.id).die("blur").die("focus"),
$("#"+this.setting.dom).removeClass("pjf_select_parent"),$("#"+this.setting.divId).remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},createTree2:function(){var l=this;l.setting.tree=new PJF.ui.tree({chkRange:l.setting.chkRange,chkStyle:l.setting.chkStyle,dom:l.setting.containerId,url:l.setting.url,check:"undefined"==typeof l.setting.check||l.setting.check,textKey:l.setting.textKey,radioType:l.setting.radioType,add:l.setting.add,edit:l.setting.edit,remove:l.setting.remove,checkType:l.setting.checkType,beforeAsync:l.setting.beforeAsync,dataFilter:l.setting.dataFilter,beforeCheck:l.setting.beforeCheck,onExpand:l.setting.onExpand,onCheck:function(t,e,i){if(!$("#"+l.setting.id).attr("disabled")){l.setting.multiple||(l.setting.checkNodes=[]);var n=l.setting.tree.getCheckedNode(),o=$("#"+l.setting.id).val();if($("#"+l.setting.id).val(""),l.setting.onlyChild)for(var a=n.length-1;0<=a;a--)n[a].isParent&&l.setting.tree.unCheckNode(n[a],!0,!1)
;l.com.find("input[type='hidden']").remove();var s=[],r=l.setting.tree.getCheckedNode(!!l.setting.search);if($.isArray(r)){for(var a in r=r.concat(l.setting.checkNodes)){if(!0===l.setting.halfCheckFlag){var c=$("#"+r[a].tId+$.fn.zTree.consts.id.CHECK);if(c.length)if(0<c[0].className.indexOf("_part"))continue}$("<input type='hidden' value='"+r[a].itemValue+"' name='"+l.setting.name+"' value='"+r[a].itemValue+"'/>").insertAfter("#"+l.setting.id),s.push(r[a][l.setting.textKey])}$("#"+l.setting.id).val(s.toString())}else $("<input type='hidden' value='"+n.itemValue+"' id='"+l.setting.hiddenId+"' name='"+l.setting.name+"' value='"+n.itemValue+"'/>").insertAfter("#"+l.setting.id);$("#"+l.setting.id).trigger("blur"),0==$("#"+l.setting.id).siblings("input:hidden").length&&$("<input type='hidden'  name='"+l.setting.name+"' value=''/>").insertAfter("#"+l.setting.id),l.setting.onChange&&o!=s&&l.setting.onChange(i)}}})},createTree:function(){var me=this
;me.setting.tree=new PJF.ui.standerdCodeTree({chkRange:me.setting.chkRange,dom:me.setting.containerId,url:me.setting.url,categoryId:me.setting.categoryId,appId:me.setting.appId,clcd:me.setting.clcd,textKey:me.setting.textKey,fwServiceId:me.setting.fwServiceId,jsonData:me.setting.jsonData,jsonClass:me.setting.jsonClass,mutiple:me.setting.multiple,sorted:me.setting.sorted,showLog:!1,checkType:me.setting.checkType,beforeCheck:function(t,e){return!me.setting.beforeCheck||me.setting.beforeCheck(t,e)},onExpand:function(t,e,i){var n=$("#"+me.setting.divId).width(),o=$("#"+me.setting.containerId).height();n>me.setting.width&&($("#"+me.setting.containerId).css("width",me.setting.width+"px"),$("#"+me.setting.containerId).parent().css("width",me.setting.width+"px"),$("#"+me.setting.divId).css("width",me.setting.width+"px")),o>=me.setting.maxHeight&&($("#"+me.setting.containerId).css("height",me.setting.maxHeight+"px"),$("#"+me.setting.containerId).parent().css("height",me.setting.maxHeight+"px"),
$("#"+me.setting.divId).css("height",me.setting.maxHeight+"px")),me.fixPostion(),me.setting.onExpand&&me.setting.onExpand(t,e,i)},onLoadAfter:function(t,e,i,n){if(!me.setting.isLayer)for(var o=me.setting.checkNodes.length-1;0<=o;o--){var a=me.setting.tree.getNodeByParam("itemValue",me.setting.checkNodes[o].itemValue);me.setting.checkNodes.splice(o,1),me.setting.tree.checkNode(a,!0,!0)}},inputNodes:me.setting.inputNodes,onCheck:function(t,e,i){if(!$("#"+me.setting.id).attr("disabled")){me.setting.multiple||(me.setting.checkNodes=[]);var n=me.setting.tree.getCheckedNode(),o=$("#"+me.setting.id).val();if($("#"+me.setting.id).val(""),me.setting.onlyChild)for(var a=n.length-1;0<=a;a--)n[a].isParent&&me.setting.tree.unCheckNode(n[a],!0,!1);me.com.find("input[type='hidden']").remove();var s=[],r=me.setting.tree.getCheckedNode(!!me.setting.search);if($.isArray(r)){for(var a in r=r.concat(me.setting.checkNodes)){if(!0===me.setting.halfCheckFlag){var c=$("#"+r[a].tId+$.fn.zTree.consts.id.CHECK)
;if(c.length)if(0<c[0].className.indexOf("_part"))continue}$("<input type='hidden' value='"+r[a].itemValue+"' name='"+me.setting.name+"' value='"+r[a].itemValue+"'/>").insertAfter("#"+me.setting.id),s.push(r[a].itemName)}$("#"+me.setting.id).val(s.toString())}else $("<input type='hidden' value='"+n.itemValue+"' id='"+me.setting.hiddenId+"' name='"+me.setting.name+"' value='"+n.itemValue+"'/>").insertAfter("#"+me.setting.id);$("#"+me.setting.id).trigger("blur"),0==$("#"+me.setting.id).siblings("input:hidden").length&&$("<input type='hidden'  name='"+me.setting.name+"' value=''/>").insertAfter("#"+me.setting.id),me.setting.onChange&&o!=s&&me.setting.onChange(i)}},dataFilter:function(treeId,parentNode,responseData){var tempdata=[];if(me.setting.onlyChild){for(var i in responseData){for(var j=me.setting.checkNodes.length-1;0<=j;j--)me.setting.checkNodes[j].itemValue==responseData[i].itemValue&&(responseData[i].checked=!0,me.setting.checkNodes.splice(j,1))
;me.setting.isLayer?PJF.communication.ajax({url:"ecpJson2Bean.action",async:!1,data:{_fw_service_id:"fetchStanderdCodeModelListByParams",jsonData:PJF.util.json2str({categoryId:responseData[i].categoryId,appId:me.setting.appId,clcd:responseData[i].itemValue}),jsonClass:"com.ccb.model.StandardDataCategory"},success:function(t){$.isArray(t)&&0<t.length?(responseData[i].isParent=!0,responseData[i].nocheck=!0):responseData[i].isParent=!1,tempdata.push(responseData[i])},failure:function(){}}):tempdata=responseData}var temp=[];if(PJF.communication.client.isInP2()&&"undefined"!=typeof me.setting.historyKey&&!0===me.setting.initHistory){var dataArray=PJF.communication.client.pjfCache("get",me.setting.historyKey)||"[]";for(var i in dataArray=eval("("+dataArray+")"),dataArray)temp.push(dataArray[i]);me.setting.initHistory=!1}for(var len=tempdata.length,i=0;i<len;i++){var flag=!1;for(var j in me.setting.deleteNodes)tempdata[i].itemValue==me.setting.deleteNodes[j]&&(flag=!0)
;flag||temp.push(tempdata[i])}return temp}var tempData1=[];if(PJF.communication.client.isInP2()&&"undefined"!=typeof me.setting.historyKey&&!0===me.setting.initHistory){var dataArray=PJF.communication.client.pjfCache("get",me.setting.historyKey)||"[]";for(var i in dataArray=eval("("+dataArray+")"),dataArray)tempData1.push(dataArray[i]);me.setting.initHistory=!1}for(var i in responseData){for(var j=me.setting.checkNodes.length-1;0<=j;j--)me.setting.checkNodes[j].itemValue==responseData[i].itemValue&&(responseData[i].checked=!0,me.setting.checkNodes.splice(j,1));var flag=!1;for(var j in me.setting.deleteNodes)responseData[i].itemValue==me.setting.deleteNodes[j]&&(flag=!0);flag||tempData1.push(responseData[i])}return tempData1},onClick:function(t,e,i,n){var o=$("#"+me.setting.id).val();if(i.checked){me.setting.tree.unCheckNode(i,!0,!0),i.checked=!1;var a=[],s=me.setting.tree.getCheckedNodes();if($("#"+me.setting.id).siblings("input:hidden").remove(),
$.isArray(s))for(var r in me.setting.checkNodes&&(s=s.concat(me.setting.checkNodes)),s)$("<input type='hidden' value='"+s[r].itemValue+"' name='"+me.setting.name+"' value='"+s[r].itemValue+"'/>").insertAfter("#"+me.setting.id),a.push(s[r].itemName);else $("<input type='hidden' value='"+result.itemValue+"' id='"+me.setting.hiddenId+"' name='"+me.setting.name+"' value='"+result.itemValue+"'/>").insertAfter("#"+me.setting.id),a.push(s[r].itemName);$("#"+me.setting.id).val(a.toString()),$("#"+me.setting.id).trigger("blur"),me.setting.onChange&&o!=a&&me.setting.onChange(i)}else me.setting.onlyChild&&i.isParent||(me.setting.tree.checkNode(i,!0,!0),i.checked=!0);0==$("#"+me.setting.id).siblings("input:hidden").length&&$("<input type='hidden'  name='"+me.setting.name+"' value=''/>").insertAfter("#"+me.setting.id),me.setting.onClick&&me.setting.onClick()},onLoadError:function(t,e,i){},onCollapse:function(){
$("#"+me.setting.containerId).children().eq(0).height()<320&&($("#"+me.setting.containerId).css("height","auto"),$("#"+me.setting.containerId).parent().css("height","auto"),$("#"+me.setting.divId).css("height","auto")),me.fixPostion()}})},getTree:function(){return this.setting.tree.getTree()},show:function(){this.com.show(),this.showflag=!0},hide:function(){this.com.hide(),this.showflag=!1},isDisplay:function(){return this.showflag},isDisabled:function(){return this.disableflag},isReadOnly:function(){return this.readonlyflag}}),PJF.apply(PJF.ui.treeSelect.prototype,{getClassName:function(){return"PJF.ui.treeSelect"}}),PJF.ui.loading=PJF.extend(PJF.ui.component,{init:function(t){t.text||(t.text="loading...")
;var e='<div class="window-mask2"></div><div class="loading" >'+t.text+"</div>",i='<div class="window-mask2"></div><div class="pjf-loading-circle"> <div class="pie_left"><div class="pjf-loading-left"></div></div> <div class="pie_right"><div class="pjf-loading-right"></div></div><div class="pjf-loadinging-mask "style="font-size:18px"><span>0</span>%</div> </div> <div class="pjf_loading_title"><label ></label></div>';if(t.time==undefined)if(t.dom){var n="<div name="+t.dom+' id=""></div>';this.com.addClass("mask_box"),$(e).appendTo(this.com),this.com.after($(n));var o=t.height||this.com.parent().height(),a=t.width||this.com.parent().width();this.com.height(o),this.com.width(a)}else if(t.maskBody){var s="<div id='mask_body' class='mask_box'></div><div name='mask_body' id=''></div>";if($(s).appendTo("body"),$(e).appendTo($("#mask_body")),this.com=$("#mask_body"),null==t.maskBody&&(t.maskBody=!1),1!=t.maskBody)return void alert(resource.LOADING_MSG1);$("#mask_body").css({top:"0",left:"0",
width:document.body.clientWidth,height:Math.max($(window).height(),document.body.clientHeight)}),"6.0"<$.browser.version&&this.com.find("div.loading").css({left:document.body.clientWidth/2-100,top:Math.max($(window).height(),document.body.clientHeight)/2-15})}else alert(resource.LOADING_MSG2);else{var r=t.title?t.title:"倒计时";if(t.dom){n="<div name="+t.dom+' id=""></div>';this.com.addClass("mask_box"),$(i).appendTo(this.com),this.com.after($(n)),this.com.height(this.com.parent().height()),this.com.width(this.com.parent().width()),this.com.find(".pjf_loading_title").children("label").html(r)}else{s="<div id='mask_body' class='mask_box'></div><div name='mask_body' id=''></div>";if($(s).appendTo("body"),$(i).appendTo($("#mask_body")),this.com=$("#mask_body"),null==t.maskBody&&(t.maskBody=!1),1!=t.maskBody)return void alert(resource.LOADING_MSG1);$("#mask_body").css({top:"0",left:"0",width:document.body.clientWidth,height:Math.max($(window).height(),document.body.clientHeight)}),
"6.0"<$.browser.version&&this.com.find("div.loading").css({left:document.body.clientWidth/2-100,top:Math.max($(window).height(),document.body.clientHeight)/2-15}),this.com.find(".pjf_loading_title").children("label").html(r)}this.com.find(".pjf_loading_title").children("label").css("fontSize","16px"),this.adjustCirclePosition(t),this.startCount(t)}window.PJF_HAS_LOADING=!0},adjustCirclePosition:function(t){var e,i,n,o=this.com.find(".pie_left").width(),a=this.com.find(".pjf-loading-circle").height(),s=this.com.find("div.pjf_loading_title").children("label").width();t.maskBody?(e=($(window).width()-o)/2,i=($(window).height()-a)/2,n=($(window).width()-s)/2):(e=(this.com.width()-o)/2,i=(this.com.height()-a)/2,n=(this.com.width()-s)/2),this.com.find("div.pjf-loading-circle").offset({left:e,top:i}),this.com.find("div.pjf_loading_title").offset({left:n,top:i+a+10})},startCount:function(a){if(a&&a.time){clearInterval(this.timer);var t=this;this.startTime=(new Date).getTime()
;this.timer=setInterval(function(){var o=(new Date).getTime()-t.startTime;o>=1e3*a.time&&(clearInterval(t.timer),t.com.find("span").html(100),t.com.find("div.circle_left").css("background","#00cccc"),a.afterLoading&&a.afterLoading(),t.destroy()),$(".pjf-loading-circle").each(function(t,e){var i=o/(1e3*a.time),n=3.6*$(this).find("span").text();n<=180?$(this).find(".pjf-loading-right").css("transform","rotate("+n+"deg)"):($(this).find(".pjf-loading-right").css("transform","rotate(180deg)"),$(this).find(".pjf-loading-left").css("transform","rotate("+(n-180)+"deg)")),$(this).find("span").html(Math.round(100*i))})},100)}}}),PJF.apply(PJF.ui.loading.prototype,{destroy:function(){window.PJF_HAS_LOADING=!1;var t=this.params,e=this.com.next();e.attr("id",e.attr("name")),t.maskBody&&e.remove(),this.com.remove(),this.com=null},getClassName:function(){return"PJF.ui.loading"}}),PJF.ui.timespinnerSpan=PJF.extend(PJF.ui.component,{init:function(t){
this.copyComObj=this.com.clone(!1,!1).empty().insertAfter(this.com),this.copyComObj.attr("id",""),(i=this.com).removeAttr("name");var e="<input id='time0_"+t.dom+"' type='text'/><span class='pjf_dateSpan_separate' style='float:left;margin-top:10px'></span><input id='time1_"+t.dom+"' type='text'/>",i=this.com;this.required=t.required,i.append(e);var n=t.inputNames,o="",a="";n&&(n[0]&&(o=n[0]),n[1]&&(a=n[1]));var s=t.inputIds,r="",c="";s&&(s[0]&&(r=s[0]),s[1]&&(c=s[1])),this.time0=new PJF.ui.timespinner({dom:"time0_"+t.dom,required:this.required,value:t.value,separator:t.separator,showSeconds:t.showSeconds,width:t.width||"auto",invalidMessage:t.invalidMessage,invalidComMsg:t.invalidComMsg,notEql:t.notEql}),this.time1=new PJF.ui.timespinner({dom:"time1_"+t.dom,required:this.required,value:t.value,separator:t.separator,showSeconds:t.showSeconds,width:t.width||"auto",invalidMessage:t.invalidMessage,preTimeDom:this.time0,invalidComMsg:t.invalidComMsg,notEql:t.notEql}),
this.time0.setNexTimeDom(this.time1),this.com.find("input[id^='time0']").parent().next().attr("name",o),this.com.find("input[id^='time1']").parent().next().attr("name",a),this.com.find("input[id^='time0']").parent().next().attr("id",r),this.com.find("input[id^='time1']").parent().next().attr("id",c)},destroy:function(){this.com.remove(),this.copyComObj.attr("id",this.params.dom),this.copyComObj.removeAttr("value"),this.com=null,this.params=null,this.id=null},newDestroy:function(){this.time0.destroy(),this.time1.destroy(),this.com.remove(),this.copyComObj.attr("id",this.params.dom),this.copyComObj.removeAttr("value"),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null}}),PJF.apply(PJF.ui.timespinnerSpan.prototype,{validateParm:function(){return conf.dom?(this.dom=conf.dom,!0):(alert(resource.TIMESPINNERSPAN_VALIDATEPARM_INFO),!1)},enable:function(){this.com.find("input[id^='time']").timespinner("enable"),
this.com.find("input[id^='time']").removeAttr("readOnly"),this.com.find("input[id^='time']").removeClass("pjf_readonly_input"),this.com.find("input[id^='time']").removeClass("pjf_disabled_input")},disable:function(){this.com.find("input[id^='time']").timespinner("disable"),this.com.find("input[id^='time']").removeClass("pjf_readonly_input"),this.com.find("input[id^='time']").addClass("pjf_disabled_input")},setReadOnly:function(t){t?(this.com.find("input[id^='time']").attr("readOnly",t),this.com.find("input[id^='time']").parent().find(".spinner-arrow-up").unbind("click").unbind("mouseenter").unbind("mouseleave"),this.com.find("input[id^='time']").parent().find(".spinner-arrow-down").unbind("click").unbind("mouseenter").unbind("mouseleave"),this.com.find("input[id^='time']").addClass("pjf_readonly_input")):(this.com.find("input[id^='time']").timespinner("enable"),this.com.find("input[id^='time']").removeAttr("readOnly"),
this.com.find("input[id^='time']").removeClass("pjf_readonly_input"),this.com.find("input[id^='time']").removeClass("pjf_disabled_input"))},getPreValue:function(){return this.com.find("input[id^='time0']").parent().next().val()},getNextValue:function(){return this.com.find("input[id^='time1']").parent().next().val()},setPreValue:function(t){if(-1!=t.indexOf(":"))this.com.find("input[id^='time0']").parent().next().val(t.replace(":","").replace(":","")),this.com.find("input[id^='time0']").val(t);else if(6<=t.length){this.com.find("input[id^='time0']").parent().next().val(t);var e=t.substr(0,2),i=t.substr(2,2),n=t.substr(4,2);this.com.find("input[id^='time0']").val(e+":"+i+":"+n)}},setNextValue:function(t){if(-1!=t.indexOf(":"))this.com.find("input[id^='time1']").parent().next().val(t.replace(":","").replace(":","")),this.com.find("input[id^='time1']").val(t);else if(6<=t.length){this.com.find("input[id^='time1']").parent().next().val(t);var e=t.substr(0,2),i=t.substr(2,2),n=t.substr(4,2)
;this.com.find("input[id^='time1']").val(e+":"+i+":"+n)}},setRequired:function(t){this.time0.setRequired(t),this.time1.setRequired(t)},getClassName:function(){return"PJF.ui.timespinnerSpan"}}),PJF.ui.scrollButton=PJF.extend(PJF.ui.component,{init:function(t){this.conf=t;var e=t.dom,i=t.count,n=t.imgWidth,o=t.imgHeight,a=t.data.length;if(e){for(var s=null,r=0;r<t.data.length;r++){var c=t.data[r].href,l=t.data[r].target,d=t.data[r].value;c||(c="#"),l||(l=""),s?s+=s='<li><a href="'+c+'" target="'+l+'"><img src="'+t.data[r].url+'" value="'+d+'"/></a></li>':s='<li><a href="'+c+'" target="'+l+'"><img src="'+t.data[r].url+'" value="'+d+'"/></a></li>'}var u,h='<span class="left" ></span><div class="main"><ul>'+s+'</ul></div><span class="right" ></span>';this.com.addClass("pjf_scrollButton").append(h),n&&o||(n=46,o=52),u=(n+5)*i+2*(this.com.find("span").width()+5),this.com.css("width",u).css("height",o),u=(n+5)*i,this.com.find(".main").css("width",u).css("height",o),
this.com.find("img").attr("width",n).attr("height",o);var p=t.data.length*(n+5);this.com.find("ul").css("width",p).css("height",o);var f=this.com.find("span").height();this.com.find(".left").css("margin-top",(o-f)/2),this.com.find(".right").css("margin-top",(o-f)/2),this.clickRight(n,a,i),this.clickLeft(n,a,i);var m=$(".pjf_scrollButton").offset().left;$(".pjf_scrollButton").find("ul").offset().left-m-19||this.com.find(".right").css("visibility","hidden"),this.getValue()}}}),PJF.apply(PJF.ui.scrollButton.prototype,{clickLeft:function(s,r,c){var l=!0;this.com.find(".left").bind("click",function(){if(!l)return!1;l=!1;var t=$(".pjf_scrollButton").offset().left,e=$(this).parent().find("ul"),i=$(".pjf_scrollButton").find("ul").offset().left-t;$(this).parent().find(".right").css("visibility","");var n=$(this).parent().find(".left"),o=i-s-24,a=(s+5)*(r-c);e.animate({marginLeft:o+"px"},"slow",function(){l=!0}),a<=-o&&n.css("visibility","hidden")})},clickRight:function(a,t,e){var s=!0
;this.com.find(".right").bind("click",function(){if(!s)return!1;s=!1;var t=$(".pjf_scrollButton").offset().left,e=$(this).parent().find("ul");$(this).parent().find(".left").css("visibility","");var i=$(".pjf_scrollButton").find("ul").offset().left-t,n=$(this).parent().find(".right"),o=i+a-14;e.animate({marginLeft:o+"px"},"slow",function(){s=!0}),0<=o&&n.css("visibility","hidden")})},getValue:function(){var e=this;this.com.find("a").each(function(){$(this).bind("click",function(){var t=$(this).find("img").attr("value");e.conf.onclick&&e.conf.onclick(t)})})},destroy:function(){this.com.remove()},validateParam:function(t){if(t.dom)return!0;alert(resource.SCROLLBUTTON_HELP_MSG)}}),PJF.ui.errorMessageBox=PJF.extend(PJF.ui.component,{init:function(e){var y=this;function t(t,e,i,n,o,a){a=a||{}
;var s=new Array,r="</div>",c=e?'<div class="error_message_box_code">'+resource.ERR_MSG_BOX_ERR_CODE+e+r:"",l=i?'<div class="error_message_box_traceid">'+resource.ERR_MSG_BOX_TRACE_ID+i+(a._BACKEND_NAME?resource.ERR_MSG_BOX_FROM+a._BACKEND_NAME+resource.ERR_MSG_BOX_COMPONENT:"")+r:"",d=n?'<div class="error_detail" id="'+y.subPanelId+'">'+n+r:"",u="",h="",p="";if(PJF.communication.client.isInP2()){var f=PJF.communication.client.getIPByRouteId("klm"),m=PJF.html.getUrlParam("menuId")?PJF.html.getUrlParam("menuId"):"XXXXXXXXX";u=f+"klm/page/jrnlerr/errSolutionDetail.jsp?errCode="+e+"&jrnlId="+PJF.constants.lastTransId+"&menuId="+m;var h='<div class="helpMsg" style="text-align:left; color:#999999; ">'+resource.ERR_MSG_BOX_SCREEN_SHOT[0]+'<a id="shoot_cut_id"><u>'+resource.ERR_MSG_BOX_SCREEN_SHOT[1]+"</u></a>”"+resource.ERR_MSG_BOX_SCREEN_SHOT[2]+r,g=(m=PJF.communication.client.getClientEnv("cuurentMenu.menuId"),
"true"===PJF.communication.client.getClientEnv("oversea")[1]||"1.2.7.5"===PJF.util.getClientVersion());"0"==m[0]&&!g&&!PJF.constants.D2D&&e&&PJF.constants.lastTransId&&m[1]==PJF.html.getUrlParam("menuId")&&(p='<div class = "error_message_smart_guy"><div>智能获取解决方案，可以点“<a id = "shoot_cut_id" target = "_blank"><u>截图反馈</u></a>”这里哦</div></div>')}var v=resource.ERR_MSG_BOX_KLM[0]?'<div class="helpMsg" style="text-align:left; color:#999999; margin-top:10px;">'+resource.ERR_MSG_BOX_KLM[0]+'<a target = "_blank" href="'+u+'"><u>'+resource.ERR_MSG_BOX_KLM[1]+"</u></a>”"+r:"",_="",b="交易处理失败，请检查输入项和操作流程是否正确。<br>";return t&&0==t.indexOf(b)?(_='<div class="error_message_box_code">'+t.substr(b.length)+r,t=t.substr(0,b.length)):o&&(_='<div class="error_message_box_code">'+o+r),_+=c,d='<div style="border:1px solid #C7CFDE;padding:10px;"class="error_detail" id="'+y.subPanelId+'">'+_+d+r,s.push('<div class="error_message_box_cntr">','<div class="error_message_box_desc">',t,r,l,p,v,h,d,r),s.join("")}
this.subPanelId="error_detail"+PJF.util.generateUUid();var i=e.style?e.style:"warning";if(e.title||(e.title="警告"),e.data&&(e.data._COMMON=e.data._COMMON||{}),"confirm"==e.style?(e.buttonText=e.buttonText||[],e.data?($.messager.defaults={ok:e.buttonText[0]||resource.MESSAGER_DEFAULTS_OK,cancel:e.buttonText[1]||resource.MESSAGER_DEFAULTS_CANCEL},this.box=$.messager.confirm(e.title,t(e.data.BK_DESC,e.data.BK_CODE,e.data._COMMON.SYS_EVT_TRACE_ID,undefined,e.data.BK_DESC_RAW,e.data),undefined,function(t){t?e.ok instanceof Function&&e.ok():e.cancel instanceof Function&&e.cancel()})):this.box=$.messager.confirm(e.title,t(e.desc,e.code,e.traceId,e.detail,e.descRaw),undefined,function(t){t?e.ok instanceof Function&&e.ok():e.cancel instanceof Function&&e.cancel()})):(PJF.constants.KEYBOARD_ENABLE,$.messager.defaults={ok:resource.MESSAGER_DEFAULTS_OK,cancel:resource.MESSAGER_DEFAULTS_CANCEL},
e.data?this.box=$.messager.alert(e.title,t(e.data.BK_DESC,e.data.BK_CODE,e.data._COMMON.SYS_EVT_TRACE_ID,undefined,e.data.BK_DESC_RAW,e.data),i,e.fn):this.box=$.messager.alert(e.title,t(e.desc,e.code,e.traceId,e.detail,e.descRaw),i,e.fn)),this.box&&!1===e.closable&&this.box.parent().find(".panel-tool").remove(),""!=this.box.find("#"+y.subPanelId).html())var n=new PJF.ui.subPanel({dom:y.subPanelId,title:'<span style="color:#004D99;"><u>'+resource.ERR_MSG_DETAIL+"</u></span>"});PJF.communication.client.isInP2()&&this.box.find("#shoot_cut_id").bind("click",function(){n.setCollapse(!0),setTimeout(function(){var t=e.data?e.data.BK_CODE:e.code;PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","bugup.b.dat",PJF.constants.lastTransId,t)},1e3)});var o=this.box.parent(".messager-window"),a=parseInt(o.css("left"))+-55;if(this.box.css("min-height",150),o.css({width:480,left:a}),o.next(".window-shadow").css({width:482,height:o.height()+6,left:a}),
$("body").bind("keydown.errorMessageBox",function(t){89!=t.which&&27!=t.which||(y.params.fn&&y.params.fn(),y.close(),PJF.ui.componentMgr.getCurrentCom()&&PJF.ui.componentMgr.getPreviousComp(PJF.ui.componentMgr.getCurrentCom())&&setTimeout(function(){PJF.ui.componentMgr.getPreviousComp(PJF.ui.componentMgr.getCurrentCom()).focus()},200),$("body").unbind("keydown.errorMessageBox"))}),"6.0"==$.browser.version&&$(".messager-window").each(function(){$(this).bgiframe()}),PJF.constants.KEYBOARD_ENABLE){this.box,this.box.find(".messager-button");for(var s=this.box.find(".l-btn-text"),r=[],c=0;c<s.length;c++)r.push($(s[c]).text())}this.addPNGFilter("messager-icon"),this.addPNGFilter("appendImage"),this.box&&this.box.css("word-wrap","break-word")},addPNGFilter:function(t,e){var i="Microsoft Internet Explorer"==navigator.appName&&4==parseInt(navigator.appVersion)&&-1!=navigator.appVersion.indexOf("MSIE 6.0");if(jQuery.browser.msie&&i){var n
;t?n=this.box.find("."+t):e&&(n=this.box.find("[class^="+e+"]"));for(var o=0;o<n.length;o++){var a=$(n[o]),s=a.css("background-image");if("none"!=s){var r=s.split('url("')[1].split('")')[0];a.get(0).runtimeStyle&&(a.css("background-image","none"),a.get(0).runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+r+"',sizingMethod='srop')")}}}},close:function(){var t=this.box.parent();t.next().next().remove(),t.next().remove(),t.remove(),this.box=null,this.params=null,this.id=null},getClassName:function(){return"PJF.ui.errorMessageBox"},setContent:function(t,e,i,n){t&&this.box.find(".error_message_box_desc").text(t),e&&this.box.find(".error_message_box_code").text(e),i&&this.box.find(".error_message_box_code").text(i),n&&this.box.find("#"+this.subPanelId).text(n)}}),PJF.ui.listSort=PJF.extend(PJF.ui.component,{init:function(t){var e=this,i={mulityselect:!1,remove:!1,height:e.com.height(),width:e.com.width()};if(!e.validateParam(t))return!1;e.conf=$.extend(i,t),
e.com.height=this.conf.height-12,e.com.width=this.conf.width-12,e.com.addClass("listSort-cntr").css({height:e.com.height,width:e.com.width}),e.com.append('<div class="listSort-ctrlBar"></div>').append('<div class="listSort-list"></div>'),e.com.find(".listSort-ctrlBar").append('<div class="listSort-ctrlBar-up" title="上移"><div></div></div><div class="listSort-ctrlBar-down" title="下移"><div></div></div><div class="listSort-ctrlBar-top" title="置顶"><div></div></div><div class="listSort-ctrlBar-bottom" title="置底"><div></div></div><div class="listSort-ctrlBar-delete" title="删除"><div></div></div>'),e.com.find(".listSort-list").height(e.com.height-40).width(e.com.width-2),e.setItem(e.conf.data),e.clickup(),e.clickdown(),e.clicktop(),e.clickbottom(),e.clickdelete()}}),PJF.apply(PJF.ui.listSort.prototype,{validateParam:function(t){return"object"==typeof t?"string"!=typeof t.dom?(alert("请指定正确的dom,PJF.ui.listSort"),!1):"object"==typeof t.data||(alert("data必须为object,PJF.ui.listSort"),
!1):(alert("传入参数不是对象,PJF.ui.listSort"),!1)},clickup:function(){var t=this;t.com.find(".listSort-ctrlBar-up").click(function(){var o=t.com.find(".listSort-listitem");o.each(function(t){var e,i=$(this),n=[];if(0<i.attr("class").search("listSort-selected")&&0==t)return!0;if(0<i.attr("class").search("listSort-selected")&&$(o[t-1]).attr("class").search("listSort-selected")<0){for(n.push(i),e=$(o[t-1]),j=t+1;j<o.length;j++)0<$(o[j]).attr("class").search("listSort-selected")&&n.push($(o[j]));e.before(n)}})})},clickdown:function(){var o=this;o.com.find(".listSort-ctrlBar-down").click(function(){var t=o.com.find(".listSort-listitem");for(i=t.length-1;0<=i;i--){var e,n=[];if(!(0<$(t[i]).attr("class").search("listSort-selected")&&i==t.length-1)&&(0<$(t[i]).attr("class").search("listSort-selected")&&$(t[i+1]).attr("class").search("listSort-selected")<0)){for(n.unshift($(t[i])),e=$(t[i+1]),j=i-1;0<=j;j--)0<$(t[j]).attr("class").search("listSort-selected")&&n.unshift($(t[j]));e.after(n)}}})},
clicktop:function(){var n=this;n.com.find(".listSort-ctrlBar-top").click(function(){var t=n.com.find(".listSort-listitem"),i=[];t.each(function(t){var e=$(this);0<e.attr("class").search("listSort-selected")&&(i.push(e),n.com.find(".listSort-list").prepend(i))})})},clickbottom:function(){var o=this;o.com.find(".listSort-ctrlBar-bottom").click(function(){var i=o.com.find(".listSort-listitem"),n=[];i.each(function(t){var e=$(this);if(0<e.attr("class").search("listSort-selected")&&t==i.length)return!0;0<e.attr("class").search("listSort-selected")&&(n.push(e),o.com.find(".listSort-list").append(n))})})},clickdelete:function(){var t=this;t.conf.remove?t.com.find(".listSort-ctrlBar-delete").click(function(){t.com.find(".listSort-listitem").each(function(t){var e=$(this);0<e.attr("class").search("listSort-selected")&&e.remove()})}):t.com.find(".listSort-ctrlBar-delete").hide()},deselect:function(){this.com.find(".listSort-selected").removeClass("listSort-selected")},getValue:function(e){var i
;return"number"==typeof e?i=$(this.com.find(".listSort-listitem")[e]).data("value"):this.com.find(".listSort-listitem").each(function(){var t=$(this);if(t.data("key")==e)return i=t.data("value"),!1}),i},getValues:function(){var e=[];return this.com.find(".listSort-listitem").each(function(){var t=$(this);e.push(t.data("value"))}),e},getKey:function(e){var i;return"number"==typeof e?i=$(this.com.find(".listSort-listitem")[e]).data("key"):this.com.find(".listSort-listitem").each(function(){var t=$(this);if(t.data("value")==e)return i=t.data("key"),!1}),i},getKeys:function(){var e=[];return this.com.find(".listSort-listitem").each(function(){var t=$(this);e.push(t.data("key"))}),e},getObject:function(e){var i={};return"number"==typeof e?(i.key=$(this.com.find(".listSort-listitem")[e]).data("key"),i.value=$(this.com.find(".listSort-listitem")[e]).data("value")):this.com.find(".listSort-listitem").each(function(){var t=$(this);if(t.data("value")==e)return i.key=t.data("key"),
i.value=t.data("value"),!1}),i},getObjects:function(){var i=[];return this.com.find(".listSort-listitem").each(function(){var t=$(this),e={};e.key=t.data("key"),e.value=t.data("value"),i.push(e)}),i},getSelected:function(){var t=this.com.find(".listSort-listitem"),n=[];return t.each(function(t){var e=$(this),i={};0<e.attr("class").search("listSort-selected")&&(i.value=e.data("value"),i.key=e.data("key"),n.push(i))}),1==n.length?n[0]:n},setItem:function(t){this.removeItem(),this.addItem(t)},addItem:function(t){var e=this;$(t).each(function(){var t=$('<div class="listSort-listitem">'+this.key+"</div>");t.data("value",this.value).data("key",this.key).click(function(){var t=$(this);0<t.attr("class").search("listSort-selected")?e.deselect():(0==e.conf.mulityselect&&e.deselect(),t.addClass("listSort-selected"))}),e.com.find(".listSort-list").append(t)})},removeItem:function(e){
e?"number"==typeof e?$(this.com.find(".listSort-listitem")[e]).remove():"string"==typeof e?this.com.find(".listSort-listitem").each(function(){var t=$(this);t.data("value")==e&&t.remove()}):alert("参数不正确！参数类型只能为string或者number！"):this.com.find(".listSort-listitem").remove()},destroy:function(){for(a in this.com.remove(),PJF.ui.componentMgr.remove(this.id),this)this[a]=null}}),PJF.ui.starRating=PJF.extend(PJF.ui.component,{init:function(t){var n=this;n.conf=$.extend({readOnly:!1,value:0,text:["请点击星星给业务员打分","很差","一般","满意","很满意","非常满意"]},t);$(PJF.html.getDom(n.conf.dom)).append('<div class="starRating_cntr"><a href="javascript:void(0)" class="starRating_stars"></a><a href="javascript:void(0)" class="starRating_stars"></a><a href="javascript:void(0)" class="starRating_stars"></a><a href="javascript:void(0)" class="starRating_stars"></a><a href="javascript:void(0)" class="starRating_stars"></a><span class="starRating_text"></span></div>'),
$(n.com.find(".starRating_cntr")).addClass("star_"+n.conf.value),$(n.com.find(".starRating_text")).text(n.conf.text[n.conf.value]),n.com.find("a").each(function(t){var e=$(this),i=t+1;e.click(function(){n.setValue(i)}),e.hover(function(){1!=n.conf.readOnly&&($(n.com.find(".starRating_cntr")).removeClass().addClass("starRating_cntr star_"+i),$(n.com.find(".starRating_text")).text(n.conf.text[i]))}).mouseout(function(){1!=n.conf.readOnly&&($(n.com.find(".starRating_cntr")).removeClass().addClass("starRating_cntr star_"+n.conf.value),$(n.com.find(".starRating_text")).text(n.conf.text[n.conf.value]))})})}}),PJF.apply(PJF.ui.starRating.prototype,{setValue:function(t){t<0&&5<t||1!=this.conf.readOnly&&($(this.com.find(".starRating_cntr")).removeClass().addClass("starRating_cntr star_"+t),$(this.com.find(".starRating_text")).text(this.conf.text[t]),this.conf.value=t,"function"==typeof this.conf.callback&&this.conf.callback(this))},setReadOnly:function(t){
"boolean"==typeof t&&(this.conf.readOnly=t)},getValue:function(){return this.conf.value},reset:function(){this.setReadOnly(!1),$(this.com.find(".starRating_cntr")).removeClass().addClass("starRating_cntr star_0"),$(this.com.find(".starRating_text")).text(this.conf.text[0]),this.conf.value=0},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null}}),PJF.ui.countDown=PJF.extend(PJF.ui.component,{init:function(t){this.defaultFormat=t.format||"hh:mm:ss",this.defaultTitle=t.title||"倒计时：",$('<div class="pjf_countDown_title"></div><div class="pjf_countDown_boarder"><div class="pjf_countDown_inner"></div></div>').appendTo(this.com),this.countDom=this.com.find(".pjf_countDown_inner"),this.titleDom=this.com.find(".pjf_countDown_title"),this.startCount(t)},dateFormat:function(t,e){var i=Math.floor(t/3600);t%=3600;var n,o,a,s=Math.floor(t/60),r=t%60;switch(n=parseInt(i)<10&&i.toString().length<2?"0"+i:i,o=parseInt(s)<10&&s.toString().length<2?"0"+s:s,
a=parseInt(r)<10&&r.toString().length<2?"0"+r:r,e){case"hh:mm:ss":return n+":"+o+":"+a;case"mm:ss":return o+":"+a}},startCount:function(e){if(e&&e.time){clearInterval(this.timer);var i=this;e.title=e.title||this.defaultTitle,this.titleDom.html(e.title+i.dateFormat(e.time,e.format||i.defaultFormat)),this.countDom.css("width","100%"),this.startTime=(new Date).getTime(),this.loadWidth=this.countDom.width();this.timer=setInterval(function(){var t=(new Date).getTime()-i.startTime;if(t>=1e3*e.time)return i.titleDom.html(e.title+i.dateFormat(0,e.format||i.defaultFormat)),i.countDom.css("width","0"),clearInterval(i.timer),void(e.afterCountDown&&e.afterCountDown());i.titleDom.html(e.title+i.dateFormat(Math.floor(e.time-t/1e3)+1,e.format||i.defaultFormat)),i.countDom.css("width",(1-t/e.time/1e3)*i.loadWidth)},100)}}}),PJF.apply(PJF.ui.countDown.prototype,{getClassName:function(){return"PJF.ui.countDown"},validateParam:function(t){return!(!t.dom||!t.time)},destroy:function(){
clearInterval(this.timer),this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null}}),PJF.ui.phoneNumber=PJF.extend(PJF.ui.component,{init:function(t){this.initProperties();var e=this.properties[t.type];e.label=t.label||e.label,t.inputIds=t.inputIds||e.inputIds,e.inputIds=t.inputIds,t.required=t.required||[],t.validType=t.validType||[],t.invalidMessage=t.invalidMessage||[],this.settings=e;for(var i="",n=0;n<t.inputIds.length;n++)i+='<input id ="'+t.inputIds[n]+'" type = "text"></input>',n<t.inputIds.length-1&&(i+="<span class='pjf_dateSpan_separate'></span>");this.com.html(i);var o=this.generateId(),a="",s=this.generateId();this.spanId=s;for(n=0;n<t.required.length;n++)a='<span id="'+s+'" style="display:none;">*</span>';t.label&&($('<label id="'+o+'">'+a+e.label+"</label>").prependTo(this.com),new PJF.ui.label({dom:o}));for(n=0;n<t.inputIds.length;n++)this.textFieldObjs[n]=new PJF.ui.textfield({dom:t.inputIds[n],width:e.width[n],
required:1==t.required[n],validType:t.validType[n]||null,invalidMessage:t.invalidMessage[n]||"",datatype:-1!=PJF.util.array.indexOf(e.formatIndex,n)?"phoneNumber":undefined}),this.textFieldObjs[n].setValue(e.tips[n],!1),this.textFieldObjs[n].com.css("color","#ccc"),1==t.required[n]&&$("#"+s).css("display","inline-block");this.initEvent(t.type)},initProperties:function(){this.properties={interTele:{inputIds:["TelCtcMod_Itnl_DstcNo","TelCtcMod_Dmst_DstcNo","TelCtcMod_No","TelCtcMod_Exn_No"],tips:["国家代码","地区代码","电话号码","分机号码"],width:[50,50,80,50],label:"国际固定电话：",formatIndex:[2]},interMobile:{inputIds:["TelCtcMod_Itnl_DstcNo","TelCtcMod_No"],tips:["国家代码","移动电话号码"],width:[50,150],label:"国际手机：",formatIndex:[1]},tele:{inputIds:["TelCtcMod_Dmst_DstcNo","TelCtcMod_No","TelCtcMod_Exn_No"],tips:["国内区号","电话号码","分机号码"],width:[50,80,50],label:"国内固定电话：",formatIndex:[1]},mobile:{inputIds:["TelCtcMod_No"],tips:["移动电话号码"],width:[188],label:"国内手机：",formatIndex:[0]}},this.textFieldObjs=[],this.settings={}
},initEvent:function(t){var e=this,i=this.settings;switch(t){case"interTele":this.textFieldObjs[0].com.bind("blur",function(){e.showTip(this,i.tips[0])}),this.textFieldObjs[1].com.bind("blur",function(){e.showTip(this,i.tips[1])}),this.textFieldObjs[2].com.bind("blur",function(){e.showTip(this,i.tips[2])}),this.textFieldObjs[3].com.bind("blur",function(){e.showTip(this,i.tips[3])});break;case"interMobile":this.textFieldObjs[0].com.bind("blur",function(){e.showTip(this,i.tips[0])}),this.textFieldObjs[1].com.bind("blur",function(){e.showTip(this,i.tips[1])});break;case"tele":this.textFieldObjs[0].com.bind("blur",function(){e.showTip(this,i.tips[0])}),this.textFieldObjs[1].com.bind("blur",function(){e.showTip(this,i.tips[1])}),this.textFieldObjs[2].com.bind("blur",function(){e.showTip(this,i.tips[2])});break;case"mobile":this.textFieldObjs[0].com.bind("blur",function(){e.showTip(this,i.tips[0])})}for(var n=0;n<this.textFieldObjs.length;n++)!function(t){
e.textFieldObjs[t].com.bind("focus",function(){$(this).val()==i.tips[t]&&$(this).val(""),$(this).css("color","#000")})}(n)},showTip:function(t,e){""==$(t).val()?($(t).val(e),$(t).css("color","#ccc")):$(t).css("color","#000")},getValue:function(){for(var t={},e=0;e<this.textFieldObjs.length;e++){var i=this.textFieldObjs[e].getValue(),n=this.settings.tips[e];t[this.settings.inputIds[e]]=i==n?"":i}return t},setValue:function(t){for(var e in t){var i=PJF.util.array.indexOf(this.settings.inputIds,e);0<=i&&(this.textFieldObjs[i].com.val(t[e]),this.textFieldObjs[i].com.triggerHandler("blur"))}},setRequired:function(t){var e=this.spanId;$("#"+e).css("display","none");for(var i=0;i<this.textFieldObjs.length;i++){if(this.textFieldObjs[i].setRequired(t[i]),t[i])$("#"+e).css("display","inline-block");else this.textFieldObjs[i].getValue()==this.settings.tips[i]&&this.textFieldObjs[i].hideCheckTip()}},setReadOnly:function(t){
for(var e=0;e<this.textFieldObjs.length;e++)this.textFieldObjs[e].setReadOnly(t)}}),PJF.apply(PJF.ui.phoneNumber.prototype,{getClassName:function(){return"PJF.ui.phoneNumber"},validateParam:function(t){return!(!t.dom||!t.type)},destroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.id=null}}),PJF.ui.force=PJF.extend(PJF.ui.component,{init:function(n){var o=this;require.config({paths:{echarts:"echarts-map","echarts/chart/force":"echarts-map"}}),require(["echarts","echarts/chart/force"],function(t){o.force=t.init(document.getElementById(n.dom)),o.force.setOption(n.option);var e=n.bindEvents;if(e instanceof Object)for(var i in e)o.force.on(i,e[i])})},getOption:function(){return this.force?this.force.getOption():null},setOption:function(t,e){
this.force&&this.force.setOption(t,e)},setSeries:function(t,e){this.force&&this.force.setSeries(t,e)},getSeries:function(){return this.force?this.force.getSeries():null},on:function(t,e){this.force&&this.force.on(t,e)},addData:function(t,e,i,n,o,a){this.force&&this.force.addData(t,e,i,n,o,a)},addMarkPoint:function(t,e){this.force&&this.force.seriesIdx(t,e)},delMarkPoint:function(t,e){this.force&&this.force.delMarkPoint(t,e)},delMarkLine:function(t,e){this.force&&this.force.delMarkLine(t,e)},un:function(t,e){this.force&&this.force.un(t,e)},setTheme:function(t){this.force&&this.force.setTheme(t)},connect:function(t){this.force&&this.force.connect(t)},disConnect:function(t){this.force&&this.force.disConnect(t)},showLoading:function(t){this.force&&this.force.showLoading(t)},hideLoading:function(){this.force&&this.force.hideLoading()},getZrender:function(){return this.force?this.force.getZrender():null},getDataURL:function(t){return this.force?this.force.getDataURL(t):null},
getImage:function(t){return this.force?this.force.getZrender(getZrender):null},resize:function(){this.force&&this.force.resize()},refresh:function(){this.force&&this.force.refresh()},restore:function(){this.force&&this.force.restore()},clear:function(){this.force&&this.force.clear()},dispose:function(){this.force&&this.force.dispose()}}),PJF.apply(PJF.ui.force.prototype,{}),PJF.ui.map=PJF.extend(PJF.ui.component,{init:function(n){var o=this;require.config({paths:{echarts:"echarts-map","echarts/chart/map":"echarts-map"}}),require(["echarts","echarts/chart/map"],function(t){o.map=t.init(document.getElementById(n.dom)),o.map.setOption(n.option);var e=n.bindEvents;if(e instanceof Object)for(var i in e)o.map.on(i,e[i])})},getOption:function(){return this.map?this.map.getOption():null},setOption:function(t,e){this.map&&this.map.setOption(t,e)},setSeries:function(t,e){this.map&&this.map.setSeries(t,e)},getSeries:function(){return this.map?this.map.getSeries():null},on:function(t,e){
this.map&&this.map.on(t,e)},addData:function(t,e,i,n,o,a){this.map&&this.map.addData(t,e,i,n,o,a)},addMarkPoint:function(t,e){this.map&&this.map.seriesIdx(t,e)},delMarkPoint:function(t,e){this.map&&this.map.delMarkPoint(t,e)},delMarkLine:function(t,e){this.map&&this.map.delMarkLine(t,e)},un:function(t,e){this.map&&this.map.un(t,e)},setTheme:function(t){this.map&&this.map.setTheme(t)},connect:function(t){this.map&&this.map.connect(t)},disConnect:function(t){this.map&&this.map.disConnect(t)},showLoading:function(t){this.map&&this.map.showLoading(t)},hideLoading:function(){this.map&&this.map.hideLoading()},getZrender:function(){return this.map?this.map.getZrender():null},getDataURL:function(t){return this.map?this.map.getDataURL(t):null},getImage:function(t){return this.map?this.map.getZrender(getZrender):null},resize:function(){this.map&&this.map.resize()},refresh:function(){this.map&&this.map.refresh()},restore:function(){this.map&&this.map.restore()},clear:function(){
this.map&&this.map.clear()},dispose:function(){this.map&&this.map.dispose()}}),PJF.apply(PJF.ui.map.prototype,{}),PJF.ui.gauge=PJF.extend(PJF.ui.component,{init:function(n){var o=this;require.config({paths:{echarts:"echarts-map","echarts/chart/gauge":"echarts-map"}}),require(["echarts","echarts/chart/gauge"],function(t){o.gauge=t.init(document.getElementById(n.dom)),o.gauge.setOption(n.option,!0);var e=n.bindEvents;if(e instanceof Object)for(var i in e)o.gauge.on(i,e[i])})},getOption:function(){return this.gauge?this.gauge.getOption():null},setOption:function(t,e){this.gauge&&this.gauge.setOption(t,e)},setSeries:function(t,e){this.gauge&&this.gauge.setSeries(t,e)},getSeries:function(){return this.gauge?this.gauge.getSeries():null},on:function(t,e){this.gauge&&this.gauge.on(t,e)},addData:function(t,e,i,n,o,a){this.gauge&&this.gauge.addData(t,e,i,n,o,a)},addMarkPoint:function(t,e){this.gauge&&this.gauge.seriesIdx(t,e)},delMarkPoint:function(t,e){this.gauge&&this.gauge.delMarkPoint(t,e)},
delMarkLine:function(t,e){this.gauge&&this.gauge.delMarkLine(t,e)},un:function(t,e){this.gauge&&this.gauge.un(t,e)},setTheme:function(t){this.gauge&&this.gauge.setTheme(t)},connect:function(t){this.gauge&&this.gauge.connect(t)},disConnect:function(t){this.gauge&&this.gauge.disConnect(t)},showLoading:function(t){this.gauge&&this.gauge.showLoading(t)},hideLoading:function(){this.gauge&&this.gauge.hideLoading()},getZrender:function(){return this.gauge?this.gauge.getZrender():null},getDataURL:function(t){return this.gauge?this.gauge.getDataURL(t):null},getImage:function(t){return this.gauge?this.gauge.getImage(t):null},resize:function(){this.gauge&&this.gauge.resize()},refresh:function(){this.gauge&&this.gauge.refresh()},restore:function(){this.gauge&&this.gauge.restore()},clear:function(){this.gauge&&this.gauge.clear()},dispose:function(){this.gauge&&this.gauge.dispose()}}),PJF.apply(PJF.ui.gauge.prototype,{}),PJF.ui.radar=PJF.extend(PJF.ui.component,{init:function(n){
document.getElementById(n.dom).style.width=n.chartWidth?n.chartWidth:"100%",document.getElementById(n.dom).style.height=n.chartHeight?n.chartHeight:"400px";var o=this;require.config({paths:{echarts:"echarts-map","echarts/chart/radar":"echarts-map"}}),require(["echarts","echarts/chart/radar"],function(t){o.radar=t.init(document.getElementById(n.dom)),o.radar.setOption(n.option,!0);var e=n.bindEvents;if(e instanceof Object)for(var i in e)o.radar.on(i,e[i])})},getOption:function(){return this.radar?this.radar.getOption():null},setOption:function(t,e){this.radar&&this.radar.setOption(t,e)},setSeries:function(t,e){this.radar&&this.radar.setSeries(t,e)},getSeries:function(){return this.radar?this.radar.getSeries():null},on:function(t,e){this.radar&&this.radar.on(t,e)},addData:function(t,e,i,n,o,a){this.radar&&this.radar.addData(t,e,i,n,o,a)},addMarkPoint:function(t,e){this.radar&&this.radar.seriesIdx(t,e)},delMarkPoint:function(t,e){this.radar&&this.radar.delMarkPoint(t,e)},
delMarkLine:function(t,e){this.radar&&this.radar.delMarkLine(t,e)},un:function(t,e){this.radar&&this.radar.un(t,e)},setTheme:function(t){this.radar&&this.radar.setTheme(t)},connect:function(t){this.radar&&this.radar.connect(t)},disConnect:function(t){this.radar&&this.radar.disConnect(t)},showLoading:function(t){this.radar&&this.radar.showLoading(t)},hideLoading:function(){this.radar&&this.radar.hideLoading()},getZrender:function(){return this.radar?this.radar.getZrender():null},getDataURL:function(t){return this.radar?this.radar.getDataURL(t):null},getImage:function(t){return this.radar?this.radar.getImage(t):null},resize:function(){this.radar&&this.radar.resize()},refresh:function(){this.radar&&this.radar.refresh()},restore:function(){this.radar&&this.radar.restore()},clear:function(){this.radar&&this.radar.clear()},dispose:function(){this.radar&&this.radar.dispose()}}),PJF.apply(PJF.ui.radar.prototype,{}),PJF.ui.scatter=PJF.extend(PJF.ui.component,{init:function(n){
document.getElementById(n.dom).style.width=n.chartWidth?n.chartWidth:"100%",document.getElementById(n.dom).style.height=n.chartHeight?n.chartHeight:"400px";var o=this;require.config({paths:{echarts:"echarts-map","echarts/chart/scatter":"echarts-map"}}),require(["echarts","echarts/chart/scatter"],function(t){o.scatter=t.init(document.getElementById(n.dom)),o.scatter.setOption(n.option,!0);var e=n.bindEvents;if(e instanceof Object)for(var i in e)o.scatter.on(i,e[i])})},getOption:function(){return this.scatter?this.scatter.getOption():null},setOption:function(t,e){this.scatter&&this.scatter.setOption(t,e)},setSeries:function(t,e){this.scatter&&this.scatter.setSeries(t,e)},getSeries:function(){return this.scatter?this.scatter.getSeries():null},on:function(t,e){this.scatter&&this.scatter.on(t,e)},addData:function(t,e,i,n,o,a){this.scatter&&this.scatter.addData(t,e,i,n,o,a)},addMarkPoint:function(t,e){this.scatter&&this.scatter.seriesIdx(t,e)},delMarkPoint:function(t,e){
this.scatter&&this.scatter.delMarkPoint(t,e)},delMarkLine:function(t,e){this.scatter&&this.scatter.delMarkLine(t,e)},un:function(t,e){this.scatter&&this.scatter.un(t,e)},setTheme:function(t){this.scatter&&this.scatter.setTheme(t)},connect:function(t){this.scatter&&this.scatter.connect(t)},disConnect:function(t){this.scatter&&this.scatter.disConnect(t)},showLoading:function(t){this.scatter&&this.scatter.showLoading(t)},hideLoading:function(){this.scatter&&this.scatter.hideLoading()},getZrender:function(){return this.scatter?this.scatter.getZrender():null},getDataURL:function(t){return this.scatter?this.scatter.getDataURL(t):null},getImage:function(t){return this.scatter?this.scatter.getImage(t):null},resize:function(){this.scatter&&this.scatter.resize()},refresh:function(){this.scatter&&this.scatter.refresh()},restore:function(){this.scatter&&this.scatter.restore()},clear:function(){this.scatter&&this.scatter.clear()},dispose:function(){this.scatter&&this.scatter.dispose()}}),
PJF.apply(PJF.ui.scatter.prototype,{}),PJF.ui.imgPreviewer=PJF.extend(PJF.ui.component,{init:function(t){var i=this;i.conf=$.extend({isGlass:!0,isClassify:!0,listOnly:!1,scaner:!1,col:3,thumbWidth:100,thumbHeight:100,mod:"default",colSet:!1,defBtnOpts:[!0,!0,!0,!0],dragable:!0,colSetCfg:[{desc:"一列展示",name:1},{desc:"两列展示",name:2},{desc:"三列展示",name:3}]},t),i.mod=i.conf.mod,i.btn=[],i.size={},i.started=!1,i.imglist=[],i.showlist=[];var e=i.conf.data;if(i.imglist=[],e){
for(a in i.com.append('<div class="pjf_imgPreviewer_cntr"><div class="pjf_imgPreviewer_topbar"><div class="pjf_imgPreviewer_modbtn"></div><div class="pjf_imgPreviewer_imgtit"></div></div><div class="pjf_imgPreviewer_left"><div class="pjf_imgPreviewer_btnup"></div><div class="pjf_imgPreviewer_scrollcntr"><ul class="pjf_imgPreviewer_imglist"></ul></div><div class="pjf_imgPreviewer_btndown"></div></div><div class="pjf_imgPreviewer_right"><div class="pjf_imgPreviewer_imgcont"><div class="pjf_imgPreviewer_bigimgcntr"><div class="pjf_imgPreviewer_bigimg_tip"></div><div class="pjf_imgPreviewer_glassbg"><div class="pjf_imgPreviewer_glass"><div class="pjf_imgPreviewer_glassimg"><img /></div></div></div></div><div class="pjf_imgPreviewer_footer"><div class="pjf_imgPreviewer_footbtn_cntr"><div class="pjf_imgPreviewer_footerbtn1"></div><div class="pjf_imgPreviewer_footerbtn2"></div><div class="pjf_imgPreviewer_footerbtn3"></div><div class="pjf_imgPreviewer_footerbtn4"></div></div></div></div></div></div>'),
i.com.find(".pjf_imgPreviewer_btnup").bind("click",function(t){return i.imgSwitch("up"),!1}),i.com.find(".pjf_imgPreviewer_footerbtn2").bind("click",function(t){return i.imgSwitch("up"),!1}),i.com.find(".pjf_imgPreviewer_btndown").bind("click",function(t){return i.imgSwitch("down"),!1}),i.com.find(".pjf_imgPreviewer_footerbtn3").bind("click",function(t){return i.imgSwitch("down"),!1}),i.com.find(".pjf_imgPreviewer_footerbtn1").bind("click",function(t){return i.imgRotate("atcw"),!1}),i.com.find(".pjf_imgPreviewer_footerbtn4").bind("click",function(t){return i.imgRotate("cw"),!1}),i.conf.dragable?i.com.find(".pjf_imgPreviewer_bigimgcntr").bind("mousedown",function(t){t.stopPropagation();var n=$(this);n.find(".pjf_imgPreviewer_glassbg").hide();var o={left:parseFloat(n.css("left")),top:parseFloat(n.css("top"))},a=t.originalEvent.pageX,s=t.originalEvent.pageY;n.bind("mousemove",function(t){t.stopPropagation(o);var e=t.originalEvent.pageX,i=t.originalEvent.pageY;n.css({left:o.left+(e-a),
top:o.top+(i-s)})}).bind("mouseleave mouseup",function(t){t.stopPropagation(),n.off("mousemove",void 0),"mouseup"==t.type&&$(this).trigger("mouseenter")})}):i.com.find(".pjf_imgPreviewer_bigimgcntr").css({cursor:"default"}),i.conf.defBtnOpts){var n=i.conf.defBtnOpts[a];if(a=parseInt(a),!n)switch(a){case 0:i.com.find(".pjf_imgPreviewer_footerbtn1").hide();break;case 1:i.com.find(".pjf_imgPreviewer_footerbtn2").hide();break;case 2:i.com.find(".pjf_imgPreviewer_footerbtn3").hide();break;case 3:i.com.find(".pjf_imgPreviewer_footerbtn4").hide()}}if(i.conf.listOnly)i.mod="default",i.com.find(".pjf_imgPreviewer_modbtn").hide();else{var o=i.com.find(".pjf_imgPreviewer_modbtn");"default"==i.mod?o.removeClass("pjf_imgPreviewer_modbtn_on"):o.addClass("pjf_imgPreviewer_modbtn_on"),o.bind("click",function(t){var e=$(this);return i.modSwitch(),"default"==i.mod?e.removeClass("pjf_imgPreviewer_modbtn_on"):e.addClass("pjf_imgPreviewer_modbtn_on"),!1})}
i.com.find(".pjf_imgPreviewer_scrollcntr").bind("mousewheel",function(t){t.preventDefault(),0<t.originalEvent.wheelDelta?i.imgSwitch("up"):i.imgSwitch("down")});var s=i.com.find(".pjf_imgPreviewer_topbar"),r=i.conf.dom+"_select";if(s.append('<div id="'+r+'" style="display:block;"></div>'),i.select=new PJF.ui.select({dom:r,onChange:function(){i.imgClassify(i.select.getValue())}}),i.conf.isClassify||i.select.com.hide(),i.conf.colSet){var c=i.conf.dom+"_colSet";s.append('<div id="'+c+'" style="display:block;"></div>');var l=i.conf.colSetCfg,d=i.conf.col;i.colSet=new PJF.ui.select({dom:c,defaultValue:d,width:98,data:l,onChange:function(){i.setCol(parseInt(i.colSet.getValue()))}})}for(a in i.conf.btn)i.addBtn(i.conf.btn[a]);if(0!=i.conf.data.length&&i.conf.data&&(i.started=!0,i.setValue(i.conf.data),i.reSize(),i.imgSwitch()),i.reSize(),1==i.conf.isGlass&&i.glassOn(),1==i.conf.scaner){var u=[{name:"左旋转",onclick:function(t){PJF.communication.client.rotate(t.getSelected().url,270)}},{
name:"右旋转",onclick:function(t){PJF.communication.client.rotate(t.getSelected().url,90)}}];for(a in u)i.addBtn(u[a])}}else alert("data属性不合法！")},imgSwitch:function(t){var c,l=this,e=l.showlist;if(0!=e.length){if("up"==t)for(i=0;i<e.length;i++)e[i].dom.removeClass("pjf_imgPreviewer_img_checked"),e[i].dom.height(l.size.thumbH).width(l.size.thumbW),e[i].ischecked&&(e[i].ischecked=!1,c=e[i-1],0==i&&(c=e[i]));else if("down"==t)for(i=0;i<e.length;i++)e[i].dom.removeClass("pjf_imgPreviewer_img_checked"),e[i].dom.height(l.size.thumbH).width(l.size.thumbW),e[i].ischecked&&(e[i].ischecked=!1,c=e[i+1],i==e.length-1&&(c=e[i]));else if("number"==typeof t){for(i=0;i<e.length;i++)e[i].dom.removeClass("pjf_imgPreviewer_img_checked"),e[i].ischecked=!1,e[i].dom.height(l.size.thumbH).width(l.size.thumbW);if(!(t<e.length&&0<=t))return;c=e[t]}else if("object"==typeof t){for(i=0;i<e.length;i++)e[i].dom.removeClass("pjf_imgPreviewer_img_checked"),e[i].ischecked=!1,
e[i].dom.height(l.size.thumbH).width(l.size.thumbW);c=t}else{for(i=0;i<e.length;i++)e[i].ischecked&&(c=e[i]),e[i].dom.removeClass("pjf_imgPreviewer_img_checked"),e[i].ischecked=!1;c||(c=e[0])}l.checkedimg=c,l.com.find(".pjf_imgPreviewer_bigimg_tip").html(c.imgTip||"");var n=c.dom.offset().top-l.com.find(".pjf_imgPreviewer_scrollcntr").offset().top,o=l.size.thumbH+10,a=(l.size.bigimgH-l.size.bigimgH%o)/o*o,s=l.com.find("ul"),r=parseInt(s.css("margin-top")),d=c.rt%2==1;c.ischecked=!0,c.dom.addClass("pjf_imgPreviewer_img_checked"),c.dom.height(l.size.thumbH-4).width(l.size.thumbW-4),n<0?s.css({"margin-top":r-n}):a-o<n&&s.css({"margin-top":r-n+(a-o)}),l.com.find(".pjf_imgPreviewer_bigimg").remove();var u=$('<img class="pjf_imgPreviewer_bigimg" src="'+c.url+'"/>');l.com.find(".pjf_imgPreviewer_bigimgcntr").append(u);u.bind("load",function(){!0;var t=$(this),e=l.com.find(".pjf_imgPreviewer_bigimgcntr");t.css({height:"auto",width:"auto"});var i,n,o=t.height(),a=t.width(),s=0,r=0
;d?l.size.bigimgW/l.size.bigimgH>=o/a?(i=l.size.bigimgH*(o/a),r=-(s=((n=l.size.bigimgH)-i)/2)+(l.size.bigimgW-i)/2):s=-(r=((i=l.size.bigimgW)-(n=l.size.bigimgW/(o/a)))/2)+(l.size.bigimgH-n)/2:l.size.bigimgW/l.size.bigimgH>=a/o?(i=l.size.bigimgH,n=l.size.bigimgH*a/o,s=0,r=(l.size.bigimgW-n)/2):(i=l.size.bigimgW/(a/o),n=l.size.bigimgW,s=(l.size.bigimgH-i)/2,r=0),e.css($.extend({height:i,width:n,left:r,top:s,"margin-left":0,"margin-top":0},l.conf.imgOffset)),t.css({height:"100%",width:"100%",pointerEvents:"none"}),l.conf.imgAutoSize&&(e.css({left:0,width:"100%",height:"90%",top:0,bottom:"35px",overflow:"auto"}),t.css({height:"auto",width:"100%"})),l.com.find(".pjf_imgPreviewer_bigimgcntr").css({transform:"rotate("+90*c.rt+"deg)"}),l.com.find(".pjf_imgPreviewer_glassimg").css({height:o,width:a,position:"relative"}),l.com.find(".pjf_imgPreviewer_glassimg img").attr("src",c.url).css("position","absolute"),l.refreshTitle(c.title),t.fadeIn(150),
l.com.find(".pjf_imgPreviewer_bigimg").unbind("load"),l.conf.onImageLoad&&l.conf.onImageLoad()})}},glassOn:function(){var e=this;function i(t){for(var e={top:0,left:0};t;)e.left+=t.offsetLeft,e.top+=t.offsetTop,t=t.offsetParent;return e}e.com.find(".pjf_imgPreviewer_bigimgcntr").bind("mouseenter",function(){if(0!=e.imglist.length){var n=$(this),o=n.width(),a=n.height(),t=n.find(".pjf_imgPreviewer_glassimg"),s=t.find("img"),r=n.find(".pjf_imgPreviewer_glassbg"),c=(t.width(),t.height()/a),l=e.checkedimg.rt,d=i(this).top,u=i(this).left,h=(o-a)/2;r.show(),n.bind("mousemove",function(t){var e,i;switch(l){case 0:e=t.pageX-u,i=t.pageY-d;break;case 1:e=t.pageY-(d-h),i=a-(t.pageX-(u+h));break;case 2:e=o-(t.pageX-u),i=a-(t.pageY-d);break;case 3:e=o-(t.pageY-(d-h)),i=t.pageX-(u+h)}if(e<0||i<0||o<e||a<i)return n.unbind("mousemove"),n.unbind("mouseleave"),void r.hide();r.css({left:e-110,top:i-110}),s.css({left:0-(c*e-100)+"px",top:0-(c*i-100)+"px"})}),n.bind("mouseleave",function(){r.hide()})}})},
imgClassify:function(t){var e=this;if(e.showlist=[],e.com.find("ul").css("margin-top","0"),t)for(i=0;i<e.imglist.length;i++)e.imglist[i].type==t&&e.showlist.push(e.imglist[i]);else e.showlist=e.imglist;e.showlist[0].ischecked=!0,e.thumbResize(),(t||""==t)&&e.imgSwitch()},thumbResize:function(){var s=this;for(s.com.find(".pjf_imgPreviewer_img").remove(),j=0;j<s.showlist.length;j++){s.showlist[j].dom.find(".pjf_imgPreviewer_imgfootbar").html(j+1+"/"+s.showlist.length),s.showlist[j].dom.attr("imgid",j),s.com.find(".pjf_imgPreviewer_imglist").append(s.showlist[j].dom),s.showlist[j].dom.find("img").remove();var t=$(s.showlist[j].image);s.showlist[j].dom.find(".pjf_imgPreviewer_img_wrapper").append(t);var r=!1;t.off("load").on("load",{rt:s.showlist[j].rt},function(t){r=!0,$this=$(this);var e=$this.height(),i=$this.width(),n=s.size.thumbH,o=s.size.thumbW,a=(t.data.rt,$this.parent().find(".pjf_imgPreviewer_img_tip")[0]);"default"==s.mod?n/o<=e/i?($this.css({margin:0,height:"auto",width:o}),
$this.css("margin-top",-($this.height()-n)/2)):($this.css({margin:0,height:n,width:"auto"}),$this.css("margin-left",-($this.width()-o)/2)):"thumbOnly"==s.mod&&(n/o<=e/i?($this.css({margin:0,height:n,width:"auto"}),$this.css("margin-left",(o-$this.width())/2)):($this.css({margin:0,height:"auto",width:o}),$this.css("margin-top",(n-$this.height())/2))),a&&(a.style.left=$this[0].offsetLeft+"px",a.style.top=$this[0].offsetTop+"px")}).each(function(){r||$(this).trigger("load")}),s.showlist[j].dom.bind("click",function(){var t=Number($(this).attr("imgid"));s.imgSwitch(t),s.conf.onClick&&s.conf.onClick()}),s.showlist[j].dom.bind("dblclick",function(){s.modSwitch()})}},imgRotate:function(t){var e,n,o=this.showlist;for(i=0;i<o.length;i++)o[i].ischecked&&(e=o[i]);e&&(n=e.rt,"atcw"==t?n=0==n?3:n-1:"cw"==t&&(n=3==n?0:n+1),e.rt=n,e.dom.find("img").css({transform:"rotate("+90*n+"deg)"}),this.imgSwitch())},modSwitch:function(){var t=this;"default"==t.mod?(t.mod="thumbOnly",
t.com.find(".pjf_imgPreviewer_imgtopbar").show(),t.com.find(".pjf_imgPreviewer_img_tip").show(),t.com.find(".pjf_imgPreviewer_imgtit").remove(),t.com.find(".pjf_imgPreviewer_modbtn").addClass("pjf_imgPreviewer_modbtn_on")):(t.mod="default",t.com.find(".pjf_imgPreviewer_imgtopbar").hide(),t.com.find(".pjf_imgPreviewer_img_tip").hide(),t.com.find(".pjf_imgPreviewer_topbar").append('<span class="pjf_imgPreviewer_imgtit"></span>'),t.com.find(".pjf_imgPreviewer_modbtn").removeClass("pjf_imgPreviewer_modbtn_on")),t.reSize()},refreshClass:function(){var t=this.imglist,e="",n="",o=[{name:"",desc:"全部"}],a=this.select;for(i=0;i<t.length;i++)e.search(t[i].type)<0&&(" "==t[i].type&&(t[i].typeDESC="未分类"),e+=t[i].type+"/",n+=t[i].typeDESC+"/");for((e=e.split("/")).pop(),(n=n.split("/")).pop(),j=0;j<e.length;j++){var s={};s.desc=n[j],s.name=e[j],o.push(s)}a.removeAll(),a.addOptions(o)},refreshTitle:function(t){"thumbOnly"==this.mod?(this.com.find(".pjf_imgPreviewer_imgtit").remove(),
this.com.find(".pjf_imgPreviewer_imgtopbar").show()):this.com.find(".pjf_imgPreviewer_imgtopbar").hide(),t?this.com.find(".pjf_imgPreviewer_imgtit").text(t).show():this.com.find(".pjf_imgPreviewer_imgtit").hide()}}),PJF.apply(PJF.ui.imgPreviewer.prototype,{setValue:function(t){this.started=!1,this.imglist=[],this.addImg(t)},setTitle:function(t,e,i){var n;if("number"==typeof t)n=this.showlist[t];else{if("object"!=typeof t)return void console.error("PJF.ui.imgPreviewer.setTitle() 参数错误！");n=t}var o=n.dom.find(".pjf_imgPreviewer_imgtopbar");n.title=e,i&&(n.color=i),0<o.length?(o.text(e),o.css("color",i)):(n.dom.append('<span class="pjf_imgPreviewer_imgtopbar">'+e+"</span>"),n.dom.find(".pjf_imgPreviewer_imgtopbar").css("color",i)),this.getSelected()==n&&this.refreshTitle(e)},setAttr:function(t,e){t=this.getImg(t);t=$.extend(t,e),this.imgClassify(),this.imgSwitch()},addImg:function(t){var e=this,n=e.imglist;for(i=0;i<t.length;i++){var o={}
;o.dom=$('<li class="pjf_imgPreviewer_img" imgid="'+i+'" type="'+t[i].type+'"><span class="pjf_imgPreviewer_imgfootbar">'+(i+1)+"/"+t.length+"</span></li>"),o.image=new Image,o.image.src=PJF.util.addAtchBtchNoToUrl(t[i].url),o.image.title=t[i].title?t[i].title:"";var a=$('<div class="pjf_imgPreviewer_img_wrapper"></div>').append($(o.image));t[i].imgTip&&(o.imgTip=t[i].imgTip,a.append('<div class="pjf_imgPreviewer_img_tip">'+t[i].imgTip+"</div>")),o.dom.prepend(a),o.url=t[i].url,o.type=t[i].type?t[i].type:" ",o.typeDESC=t[i].typeDESC,o.title=t[i].title?t[i].title:undefined,o.ishide=!1,o.ischecked=!1,o.rt=0,o.color=t[i].color?t[i].color:"#f00",n.push(o),o.title&&(o.dom.append('<span class="pjf_imgPreviewer_imgtopbar">'+t[i].title+"</span>"),o.dom.find(".pjf_imgPreviewer_imgtopbar").css("color",t[i].color)),e.com.find(".pjf_imgPreviewer_imglist").append(o.dom)}e.refreshClass(),e.imgClassify(),e.reSize(),e.started?e.imgSwitch(e.imglist.length-1):(e.imgSwitch(),e.started=!0)},
getSelected:function(){for(i=0;i<this.showlist.length;i++)if(1==this.showlist[i].ischecked)return this.showlist[i]},getImg:function(t){return"object"==typeof t?t:"number"!=typeof t||t>=this.showlist.length?void console.error("PJF.ui.imgPreviewer.getImg() 参数必须为数字且小于图片数！"):this.showlist[t]},getImgByAttr:function(t,e){var i=this.showlist,n=[];if(t){for(a in i)i[a][t]==e&&n.push(i[a]);return n}},removeImg:function(t){var e=this.showlist,n=this.imglist;if("number"==typeof t){if(t>=e.length)return void console.error("PJF.ui.imgPreviewer.removeImg()参数错误！");for(i=0;i<n.length;i++)n[i]==e[t]&&n.splice(i,1)}else if("object"==typeof t)for(i=0;i<n.length;i++)n[i]==t&&n.splice(i,1);0!=n.length?(this.refreshClass(),this.imgClassify(),this.imgSwitch()):(this.com.find("li").remove(),this.com.find(".pjf_imgPreviewer_bigimg").remove(),this.started=!1)},addBtn:function(t){var e,i=this,n=t.id?t.id:"pjf_imgPreviewer_topbarbtn_"+i.btn.length,o='<div id="'+n+'"></div>'
;i.com.find(".pjf_imgPreviewer_topbar").append(o),$.extend(t,{dom:n});var a=t.onclick;t.onclick=function(){a(i)},e=new PJF.ui.linkButton(t),i.btn.push(e)},removeBtn:function(t){var e=this.btn;if("number"==typeof t)e[t].destroy(),e.splice(t,1);else if("string"==typeof t)for(a in e)e[a].dom==t&&(e[a].destroy(),e.splice(a,1))},getBtn:function(t){var e=this.btn;if("number"==typeof t)return e[t];if("string"!=typeof t)return e;for(a in e)if(e[a].dom==t)return e[a]},setCol:function(t){t&&"number"==typeof t&&(this.conf.col=t,this.reSize(),this.imgSwitch())},rotate:function(t,e){var i;this.showlist;i=t.rt,i=e?3==i?0:i+1:0==i?3:i-1,t.rt=i,t.dom.find("img").css({transform:"rotate("+90*i+"deg)"}),this.imgSwitch()},reSize:function(){var t=this,e=t.mod,i=t.com.height(),n=t.com.width(),o=t.conf.thumbHeight,a=t.conf.thumbWidth,s=t.com.find(".pjf_imgPreviewer_left"),r=t.com.find(".pjf_imgPreviewer_right"),c=t.conf.col;if(s.height(i-69).width(a),r.height(i-66).width(n-a-44),t.size.bigimgH=i-70,
t.size.bigimgW=n-a-44,t.com.find(".pjf_imgPreviewer_scrollcntr").height(i-122),t.com.find(".pjf_imgPreviewer_img").height(o).width(a),t.com.find(".pjf_imgPreviewer_cntr").height(i-15).width(n),"default"==e)t.size.thumbW=o,t.size.thumbH=a,t.com.find(".pjf_imgPreviewer_imgcont").height(i-66).width(n-a-44),s.find("li").css({"margin-left":0});else if("thumbOnly"==e){var l=n-34;t.size.thumbW=(l-(10+10*c))/c,t.size.thumbH=(l-(10+10*c))/c,s.width(l),s.find("ul").css("margin-top",0),s.find("li").css({width:t.size.thumbW,height:t.size.thumbH,"margin-left":10}),r.css({width:0})}t.thumbResize(),t.imgSwitch()},zoom:function(t,e){var i=this.com.find(".pjf_imgPreviewer_bigimgcntr"),n=i.width(),o=i.height();e=e||[1.1,.9];switch(t){case!0:e=e[0];break;case!1:e=e[1]}i.stop().animate({height:o*e,width:n*e})},destroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){
console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.id=null}}),PJF.ui.imgCropper=PJF.extend(PJF.ui.component,{init:function(t){var e=this,i={width:700,height:445,imgId:e.generateId(),canvasId:e.generateId(),btn1:e.generateId(),inputId:e.generateId(),url:"",tailorWidth:50,tailorHeight:50,format:"image/png",otherButtons:null,isOnlyDrag:!1,previewCanvasId:e.generateId(),rotateAngle:90};e.conf=$.extend(i,t),e.rt=-1,e.initHtml();var n=e.com.find(".pjf_imgCropper_left").width(),o=e.com.find(".pjf_imgCropper_left").height()-30;e.imgCropper=e.com.find(".pjf_imgCropper_img").css({width:n,height:o}),e.com.find(".pjf_imgCropper_right").css({height:o+5}),e.importLocalBtn=new PJF.ui.linkButton({dom:e.conf.btn1,name:"本地导入",onclick:function(t){$("#"+e.conf.inputId).click()},style:"assistant"});var a=e.com.find(".pjf_imgCropper_topbar");if(e.conf.otherButtons)for(var s=0;s<e.conf.otherButtons.length;s++){var r=e.conf.otherButtons[s]
;r.dom=e.generateId(),a.append("&nbsp;&nbsp;<span id='"+r.dom+"'></span>");new PJF.ui.linkButton(r)}e.oShadow=e.com.find(".shadow"),e.oTailor=e.com.find(".kjResizer"),e.setImage(e.conf.url),e.canvas=document.getElementById(e.conf.canvasId),e.bindEvents(),e.initTailorSize();var c=document.getElementById(e.conf.previewCanvasId);c.height=50,c.width=50,$("#"+e.conf.imgId).load(function(){e.canvas.width=this.width,e.canvas.height=this.height,e.canvas.getContext("2d").drawImage(this,0,0),e.shadow(),e.setPreviewCanvas()}),$("#"+e.conf.inputId).change(function(){e.setImage("file:///"+this.value)})},initHtml:function(){
this.com.append('<div class="pjf_imgCropper_cntr" style="width:'+this.conf.width+"px;height:"+this.conf.height+'px"><div class="pjf_imgCropper_topbar"><span id="'+this.conf.btn1+'">本地导入</span><input type="file" id="'+this.conf.inputId+'" accept="image/*"></div><div class="pjf_imgCropper_content"><div class="pjf_imgCropper_left"><div class="pjf_imgCropper_img" id="test"><img src="'+this.conf.url+'" id="'+this.conf.imgId+'"><canvas id="'+this.conf.canvasId+'"></canvas><div class="kjResizer"><div class="mop"></div><div data-dir="TL" class="dir dir-tl"><b></b></div><div data-dir="TC" class="dir dir-tc"><b></b></div><div data-dir="TR" class="dir dir-tr"><b></b></div><div data-dir="ML" class="dir dir-ml"><b></b></div><div data-dir="MR" class="dir dir-mr"><b></b></div><div data-dir="BL" class="dir dir-bl"><b></b></div><div data-dir="BC" class="dir dir-bc"><b></b></div><div data-dir="BR" class="dir dir-br"><b></b></div></div><div class="shadow"></div><div class="shadow"></div><div class="shadow"></div><div class="shadow"></div></div><div class="pjf_imgCropper_footer"><div class="pjf_imgCropper_footbtn_cntr"><div class="pjf_imgCropper_footerLeftBtn"></div><div class="pjf_imgCropper_footerRightBtn"></div></div></div></div><div class="pjf_imgCropper_right"><div style="height:20px">预览：</div><canvas id="'+this.conf.previewCanvasId+'"></canvas></div></div></div>')
},bindEvents:function(){var l,d,u,h=this,p=!1,f=document.getElementById(h.conf.canvasId);h.oShadow.on("dblclick",function(t){var e=h.oTailor[0].getBoundingClientRect(),i=(h.oTailor[0].parentNode.getBoundingClientRect(),{left:parseInt(this.style.left||0,10)+t.offsetX-e.width/2,top:parseInt(this.style.top||0,10)+t.offsetY-e.height/2});i.left<0?i.left=0:i.left+e.width>h.canvas.width&&(i.left=h.canvas.width-e.width),i.top<0?i.top=0:i.top+e.height>h.canvas.height&&(i.top=h.canvas.height-e.height),h.setAssign(h.oTailor[0],"left",i.left+"px"),h.setAssign(h.oTailor[0],"top",i.top+"px"),h.shadow(),h.setPreviewCanvas()}),h.com.find(".kjResizer").on("mousedown",function(t){if(h.url){t.stopPropagation(),p=!0;var e=$(this);l={left:e.css("left"),top:e.css("top"),width:e.width(),height:e.height()},d={left:t.originalEvent.pageX,top:t.originalEvent.pageY},u=t.target.getAttribute("data-dir")||$(t.target).parent()[0].getAttribute("data-dir")}}),
h.com.find(".pjf_imgCropper_left").on("mousemove",function(t){if(h.url&&(t.stopPropagation(),p)){var e=t.originalEvent.pageX,i=t.originalEvent.pageY,n=e-d.left,o=i-d.top,a=parseInt(l.height),s=parseInt(l.top),r=parseInt(l.width),c=parseInt(l.left);if(h.conf.isOnlyDrag&&u)return;switch(u){case"TL":r=parseInt(l.width)-n,a=parseInt(l.height)-o,c=parseInt(l.left)+n,s=parseInt(l.top)+o;break;case"TR":r=parseInt(l.width)+n,a=parseInt(l.height)-o,s=parseInt(l.top)+o;break;case"BL":r=parseInt(l.width)-n,a=parseInt(l.height)+o,c=parseInt(l.left)+n;break;case"BR":r=parseInt(l.width)+n,a=parseInt(l.height)+o;break;case"TC":a=parseInt(l.height)-o,s=parseInt(l.top)+o;break;case"ML":r=parseInt(l.width)-n,c=parseInt(l.left)+n;break;case"BC":a=parseInt(l.height)+o;break;case"MR":r=parseInt(l.width)+n;break;default:s=parseInt(l.top)+o,c=parseInt(l.left)+n}c<0?c=0:c+r>f.width&&(c=f.width-r),s<0?s=0:s+a>f.height&&(s=f.height-a),r&&h.setAssign(h.oTailor[0],"width",r+"px"),
a&&h.setAssign(h.oTailor[0],"height",a+"px"),c&&h.setAssign(h.oTailor[0],"left",c+"px"),s&&h.setAssign(h.oTailor[0],"top",s+"px"),h.shadow()}}).on("mouseleave mouseup",function(t){h.url&&(t.stopPropagation(),p=!1,h.setPreviewCanvas())}),h.com.find(".pjf_imgCropper_footerRightBtn").on("click",function(){h.url&&(h.rotate(h.conf.rotateAngle),h.shadow(),h.setPreviewCanvas())}),h.com.find(".pjf_imgCropper_footerLeftBtn").on("click",function(){h.url&&(h.rotate(-h.conf.rotateAngle),h.shadow(),h.setPreviewCanvas())})},rotate:function(t){this.angle=this.angle?this.angle+t:t;var e=this.canvas,i=e.getContext("2d");i.clearRect(0,0,e.width,e.height),this.initTailorSize();var n=document.getElementById(this.conf.imgId).height,o=document.getElementById(this.conf.imgId).width,a=this.angle*Math.PI/180,s=Math.sqrt(Math.pow(n,2)+Math.pow(o,2)),r=n/s,c=o/s,l=(Math.abs(r*Math.cos(a))+Math.abs(c*Math.sin(a)))*s,d=(Math.abs(c*Math.cos(a))+Math.abs(r*Math.sin(a)))*s;e.width=d,e.height=l,i.save(),
i.translate(d/2,l/2),i.rotate(a),i.translate(-d/2,-l/2),i.drawImage(this.image,(d-o)/2,(l-n)/2),i.restore()},setPreviewCanvas:function(){var t=parseInt(this.oTailor.css("top")),e=parseInt(this.oTailor.css("left")),i=parseInt(this.oTailor.height()),n=parseInt(this.oTailor.width()),o=document.getElementById(this.conf.canvasId).getContext("2d").getImageData(e,t,n,i),a=document.getElementById(this.conf.previewCanvasId);a.width=n,a.height=i,a.getContext("2d").putImageData(o,0,0,0,0,n,i)},setAssign:function(t,e,i){switch(e){case"width":t.style.width=i;break;case"height":t.style.height=i;break;case"top":t.style.top=i;break;case"left":t.style.left=i}},shadow:function(){var t=this,e=parseInt(t.oTailor.css("top")),i=parseInt(t.oTailor.css("left")),n=parseInt(t.oTailor.height()),o=parseInt(t.oTailor.width()),a=document.getElementById(t.conf.canvasId),s=a.height,r=a.width;t.setAssign(t.oShadow[0],"width",i+"px"),t.setAssign(t.oShadow[0],"height",s+"px"),t.setAssign(t.oShadow[1],"width",o+"px"),
t.setAssign(t.oShadow[1],"height",e+"px"),t.setAssign(t.oShadow[1],"left",i+"px"),t.setAssign(t.oShadow[2],"width",r-o-i+"px"),t.setAssign(t.oShadow[2],"height",s+"px"),t.setAssign(t.oShadow[2],"left",i+o+"px"),t.setAssign(t.oShadow[3],"width",o+"px"),t.setAssign(t.oShadow[3],"height",s-n-e+"px"),t.setAssign(t.oShadow[3],"left",i+"px"),t.setAssign(t.oShadow[3],"top",n+e+"px")},initTailorSize:function(){var t=this;t.setAssign(t.oTailor[0],"width",t.conf.tailorWidth+"px"),t.setAssign(t.oTailor[0],"height",t.conf.tailorHeight+"px"),t.setAssign(t.oTailor[0],"left",0),t.setAssign(t.oTailor[0],"top",0)},setImage:function(t){var e=new Image;if(0==t.indexOf("file:///")&&PJF.communication.client.isInP2()){var i=t.replace("file:///",""),n=i.substr(i.lastIndexOf(".")+1),o=PJF.communication.client.doCommonCommand("getPicture","get",i);"0"==o[0]&&(t="data:image/"+n+";base64,"+o[1]),e.src=t}else e.src=t;this.image=e,this.rt=-1,this.url=t,$("#"+this.conf.imgId).attr("src",t)},getCropImage:function(){
var t="";this.url&&(t=document.getElementById(this.conf.previewCanvasId).toDataURL(this.conf.format));return t}}),PJF.ui.scrollBottomBar=PJF.extend(PJF.ui.component,{init:function(t){var n=this;this.mainDivId=PJF.util.generateUUid(),$(document.body).append('<div class="pjf_scrollBottomBar" id="'+this.mainDivId+'"><div class="leftDiv"><div class="leftPic"></div></div><div class="rightDiv"></div></div>'),this.com=$("#"+this.mainDivId),this.com.find(".leftDiv").prepend("<span class='left_arrow'></span>"),this.com.find(".leftDiv").append("<span class='right_arrow'></span>"),this.com.find(".leftDiv").append("<span class='separator'></span>");for(var e="<ul>",i=0;i<t.data.length;i++)t.data[i].name=t.data[i].name?t.data[i].name:"",e+='<li><img class="mainImg"></img><img class="delImg"></img><div>'+t.data[i].name+"</div></li>";this.imgData=t.data,e+="</ul>",this.com.find(".leftPic").append(e);var o=100*t.data.length;this.com.find("ul").css("width",o),
this.com.delegate("li","mouseenter",function(){$(this).find(".delImg").show()}),this.com.delegate("li","mouseleave",function(){$(this).find(".delImg").hide()}),this.com.delegate(".delImg","click",function(){$(this).parent().remove();for(var t=n.com.find("ul").width(),e=$(this).siblings("div").html(),i=0;i<n.imgData.length;i++)if(n.imgData[i].name==e){n.imgData.splice(i,1);break}t>n.com.find(".leftPic").width()&&n.com.find("ul").css("width",t-80)}),this.com.find(".left_arrow").bind("click",function(){var t=Number(n.com.find("ul").css("marginLeft").split("p")[0])-80+"px";n.com.find("ul").is(":animated")||n.com.find("ul").animate({marginLeft:t},"slow",function(){})}),this.com.find(".right_arrow").bind("click",function(){var t=Number(n.com.find("ul").css("marginLeft").split("p")[0])+80+"px";n.com.find("ul").is(":animated")||n.com.find("ul").animate({marginLeft:t},"slow",function(){})});for(i=0;i<t.button.length;i++){var a=PJF.util.generateUUid();t.button[i].dom=a,
this.com.find(".rightDiv").append('<a style="float:left;margin-top:7px;" id = "'+a+'"></a>'),new PJF.ui.linkButton(t.button[i])}},add:function(t){var e=this.com.find("ul").width();this.com.find("ul").css("width",e+100*t.length);for(var i=0;i<t.length;i++)t[i].name=t[i].name?t[i].name:"",this.com.find("ul").append('<li><img src="图标.png" class="mainImg"></img><img src="叉.png" class="delImg"></img><div>'+t[i].name+"</div></li>");this.imgData=this.imgData.concat(t)},getValue:function(){return this.imgData},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.id=null}}),PJF.ui.visio=PJF.extend(PJF.ui.component,{init:function(t){this.options={ratio:1,rotate:{},height:500,width:700,templHeight:50,templBgColor:"#FFFFFF",containerBgColor:"#FFFFFF",coustomContainer:!1,data:[],type:"edit"},$.extend(this.options,t);var e=this.options,i=this.createHtml();e.dom&&this.com.append(i),this.cssVisio(),"edit"==e.type&&(this.dragAndDrop(),
!0===e.objCustom&&this.objCustomClick()),"show"==e.type&&(this.setData(e.data),e.onClick instanceof Function&&this.bindClick())},createHtml:function(){return"<div class='visio_main'><div class='visio_draggable'></div><div class='visio_template visio_template_"+this.options.type+"'>"+this.initTemplate()+"</div><div class='visio_container'></div>"+this.initObjCustom()+"</div>"},objCustomClick:function(){var t=this;t.com.find(".visio_obj_custom").toggle(function(){$(this).css({right:"-5px",transition:"all 0.3s ease-in 0s"}),t.com.find(".visio_arrow_left").css({display:"none"}),t.com.find(".visio_arrow_right").css({display:"block"})},function(){$(this).css({right:"-165px",transition:"all 0.3s ease-in 0s"}),t.com.find(".visio_arrow_left").css({display:"block"}),t.com.find(".visio_arrow_right").css({display:"none"})}),t.com.find("input").bind("click",function(t){t.stopPropagation()})},setCustomValue:function(e){
var i=this,n=this.com.find(".visio_custom_width").eq(0),o=this.com.find(".visio_custom_height").eq(0),a=this.com.find(".visio_custom_left").eq(0),s=this.com.find(".visio_custom_top").eq(0),t=this.com.find(".visio_custom_btn").eq(0),r=this.com.find(".visio_custom_rotate").eq(0);null===e?(n.val(""),o.val(""),a.val(""),s.val(""),r.val(""),t.attr("disabled","disabled"),t.unbind("click")):(n.val(e.css("width").replace("px","")),o.val(e.css("height").replace("px","")),a.val(e.css("left").replace("px","")),s.val(e.css("top").replace("px","")),r.val(e.rotationDegrees()),t.removeAttr("disabled"),t.unbind("click").bind("click",function(t){t.stopPropagation(),e.css({width:n.val()+"px",height:o.val()+"px",left:a.val()+"px",top:s.val()+"px",transform:"rotate("+r.val()+"deg)","-ms-transform":"rotate("+r.val()+"deg)","-webkit-transform":"rotate("+r.val()+"deg)"}),i.fixResizeDiv(e)}))},initTemplate:function(){
for(var t=this.options.templateData,e="",i=0;i<t.length;i++)e+="<div class='visio_template_drag'><div class='visio_obj"+(t[i].container?" visio_container_custom":"")+"' visioType='"+t[i].type+"' style='height:"+(t[i].height?t[i].height:this.options.templHeight)+"px;background-color:"+t[i].color+";width:"+(.2*this.options.width-20-4)+"px;'><div class='visio_obj_font'></div></div><div class='visio_obj_text'>"+t[i].text+"</div></div>";return e},initObjCustom:function(){var t=""
;return!0===this.options.objCustom&&"edit"==this.options.type&&(t+='<div class="visio_obj_custom"><label>宽:</label><input class="visio_custom_width" type="text"></input><label>px</label><label>高:</label><input class="visio_custom_height" type="text"></input><label>px</label><br/><label>左:</label><input class="visio_custom_left" type="text"></input><label>px</label><label>上:</label><input class="visio_custom_top" type="text"></input><label>px</label><br/><label>转:</label><input class="visio_custom_rotate" type="text"></input><label>degree</label><br/><button class="visio_custom_btn" disabled="disabled">确定</button><div class="visio_arrow_left"></div><div class="visio_arrow_right"></div></div>'),t},cssVisio:function(){var t=this.options,e=this.com.find(".visio_main"),i=this.com.find(".visio_template"),n=this.com.find(".visio_container");e.css({height:t.height+"px",width:t.width+1+"px"}),i.css({"background-color":t.templBgColor,height:t.height+"px",width:.2*t.width+"px"}),n.css({
"background-color":t.containerBgColor,height:t.height+"px",width:.8*t.width+"px"})},dragAndDrop:function(){var n=this,o=null,t=n.com.find(".visio_template_drag > .visio_obj"),i=n.com.find(".visio_draggable").eq(0),a=n.com.find(".visio_container").eq(0);t.bind("mousedown",function(t){return o=$($(this).clone()),i.css({top:$(this)[0].offsetTop,left:$(this)[0].offsetLeft}),i.trigger(t),!1});var s=0,r=0;i.draggable({containment:"parent",opacity:.35,drag:function(t,e){i.append(o),s=t.target.offsetLeft-.2*n.options.width-(a.hasClass("visio_container_custom")?a[0].offsetLeft:0),r=t.target.offsetTop-a[0].offsetTop},stop:function(){i.html("")}}),a.droppable({drop:function(t,e){var i=n.com.find(".visio_container > .visio_container_custom");n.options.coustomContainer&&i.length<=0&&!o.hasClass("visio_container_custom")?alert("请先放入用户自定义容器"):(a.append(o),o.css({position:"absolute",top:r,left:s}),n.initDrag(o),n.bindEvents(o),
n.options.coustomContainer&&o.hasClass("visio_container_custom")&&(a.droppable("disable"),(a=n.com.find(".visio_container > .visio_container_custom").eq(0)).droppable({drop:function(t,e){o.hasClass("visio_container_custom")?alert("暂不允许自定义容器内出现自定义容器"):(a.append(o),o.css({position:"absolute",top:r,left:s}),n.initDrag(o),n.bindEvents(o))}})))}})},getPosition:function(t){for(var e=t.offsetLeft,i=t.offsetTop;t=t.offsetParent;)e+=t.offsetLeft,i+=t.offsetTop;return{left:e,top:i}},removeRPoint:function(){this.com.find(".visio_resizeBorder").removeClass("visio_resizeBorder"),this.com.find(".visio_resizePoint").remove(),this.com.find(".visio_rotate").remove(),this.com.find(".visio_obj_clear").remove(),this.com.find(".visio_obj_edit").trigger("blur")},bindEvents:function(e){var o=this;this.com.find(".visio_container").unbind("click").bind("click",function(t){t.stopPropagation(),o.removeRPoint(),o.setCustomValue(null)}),e.unbind("dblclick").bind("dblclick",function(t){if(t.stopPropagation(),
$(this).find(".visio_obj_edit").length<=0){var e=$(this).find(".visio_obj_font").eq(0),i=e.html();e.html(""),o.removeRPoint(),$(this).append('<textarea class="visio_obj_edit">'+i+"</textarea>");var n=$(this).find(".visio_obj_edit").eq(0);n.css({transform:"rotate(-"+n.parent().rotationDegrees()+"deg)"}),n.trigger("focus"),n.bind("blur",function(){var t=n.val();n.remove(),e.html(t)}),n.unbind("click").bind("click",function(t){t.stopPropagation()})}});e.unbind("click").bind("click",function(t){t.stopPropagation(),$(this).hasClass("visio_resizeBorder")?(o.removeRPoint(),o.setCustomValue(null)):(o.removeRPoint(),$(this).addClass("visio_resizeBorder"),
$(this).append('<div class="visio_resizePoint visio_rRightDown"> </div><div class="visio_resizePoint visio_rLeftDown"> </div><div class="visio_resizePoint visio_rRightUp"> </div><div class="visio_resizePoint visio_rLeftUp"> </div><div class="visio_resizePoint visio_rRight"> </div><div class="visio_resizePoint visio_rLeft"> </div><div class="visio_resizePoint visio_rUp"> </div><div class="visio_resizePoint visio_rDown"></div><div class="visio_rotate visio_rotate_hide visio_rotateLine"></div><div class="visio_rotate visio_rotateAxis"></div><div class="visio_rotate visio_rotateSquare"></div><div class="visio_rotate visio_rotate_hide visio_rotateCenter"></div><div class="visio_obj_clear"></div>'),o.fixResizeDiv(e),o.initClear($(this)),o.initResize($(this)),o.initRotate($(this)),o.setCustomValue($(this)))})},initDrag:function(t){t.draggable({containment:"parent",opacity:.35,drag:function(t,e){dragDivLeft=t.target.offsetLeft,dragDivTop=t.target.offsetTop},stop:function(){t.css({
top:dragDivTop,left:dragDivLeft})}})},initClear:function(e){var i=this;e.find(".visio_obj_clear").bind("click",function(t){t.stopPropagation(),e.remove(),i.setCustomValue(null)})},initResize:function(i){var n=this;i.find(".visio_resizePoint").unbind("click").bind("click",function(t){t.stopPropagation()});var t,e,o=(t=navigator.userAgent.toLowerCase(),(e={}).IE=!!t.match(/msie ([\d.]+)/),e.Firefox=!!t.match(/firefox\/([\d.]+)/),e.Chrome=!!t.match(/chrome\/([\d.]+)/),e.IE6=!(!e.IE||6!=/MSIE (\d)\.0/i.exec(navigator.userAgent)[1]),e.IE7=!(!e.IE||7!=/MSIE (\d)\.0/i.exec(navigator.userAgent)[1]),e.IE8=!(!e.IE||8!=/MSIE (\d)\.0/i.exec(navigator.userAgent)[1]),e),a=function(t,e){for(var i in e)t.style[i]=e[i]},s=function(e,i){var n=Array.prototype.slice.call(arguments).slice(2);return function(t){return i.apply(e,[t||window.event].concat(n))}},r=function(t){return t.currentStyle||document.defaultView.getComputedStyle(t,null)};function c(t,e,i){
t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)}function l(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent("on"+e,i)}var d=new function(t){var e=function(){return null!==arguments[0]&&this.initialize&&"function"==typeof this.initialize?this.initialize.apply(this,arguments):this};return e.prototype=t,e}({initialize:function(t){this.obj=t,this.resizeelm=null,this.fun=null,this.original=[],this.width=null,this.height=null,this.fR=s(this,this.resize),this.fS=function(t,e){var i=Array.prototype.slice.call(arguments).slice(2);return function(){return e.apply(t,i)}}(this,this.stop)},set:function(t,e){if(t)return this.resizeelm=t,c(this.resizeelm,"mousedown",s(this,this.start,this[e])),this},start:function(t,e){i.draggable("disable"),i.parent().hasClass("visio_container_custom")&&i.parent().draggable("disable"),this.fun=e,this.original=[parseInt(r(this.obj).width),parseInt(r(this.obj).height),parseInt(r(this.obj).left),parseInt(r(this.obj).top)],
this.width=(this.original[2]||0)+this.original[0],this.height=(this.original[3]||0)+this.original[1],c(this.obj.parentElement,"mousemove",this.fR),c(this.obj.parentElement,"mouseup",this.fS),c(this.obj.parentElement,"mouseleave",this.fS)},resize:function(t){this.fun(t),o.IE?this.resizeelm.onlosecapture=function(){this.fS()}:this.resizeelm.onblur=function(){this.fS()}},stop:function(){l(this.obj.parentElement,"mousemove",this.fR),l(this.obj.parentElement,"mouseup",this.fS),l(this.obj.parentElement,"mouseleave",this.fS),window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),i.draggable("enable"),i.parent().hasClass("visio_container_custom")&&i.parent().draggable("enable"),n.setCustomValue($(this.obj))},distance:function(t){for(var e=t.offsetLeft,i=t.offsetTop;t=t.offsetParent;)e+=t.offsetLeft,i+=t.offsetTop;return{left:e,top:i}},up:function(t){var e=this.distance(this.obj.parentElement).top;this.height>t.clientY-e&&0<=t.clientY-e&&(a(this.obj,{
top:t.clientY-e+"px",height:this.height-t.clientY+e+"px"}),n.fixResizeDiv(i))},down:function(t){var e=this.distance(this.obj.parentElement).top;t.clientY>this.original[3]&&t.clientY-e<=this.obj.parentElement.clientHeight&&(a(this.obj,{top:this.original[3]+"px",height:t.clientY-this.original[3]-e+"px"}),n.fixResizeDiv(i))},left:function(t){var e=this.distance(this.obj.parentElement).left;t.clientX-e<this.width&&0<=t.clientX-e&&(a(this.obj,{left:t.clientX-e+"px",width:this.width-t.clientX+e+"px"}),n.fixResizeDiv(i))},right:function(t){var e=this.distance(this.obj.parentElement).left;t.clientX+e>this.original[2]&&t.clientX-e<=this.obj.parentElement.clientWidth&&(a(this.obj,{left:this.original[2]+"px",width:t.clientX-this.original[2]-e+"px"}),n.fixResizeDiv(i))},leftUp:function(t){this.up(t),this.left(t)},leftDown:function(t){this.left(t),this.down(t)},rightUp:function(t){this.up(t),this.right(t)},rightDown:function(t){this.right(t),this.down(t)},turnDown:function(t){},
turnUp:function(t){},turnRight:function(t){},turnLeft:function(t){}}),u=i[0],h=i.find(".visio_rUp").eq(0)[0],p=i.find(".visio_rDown").eq(0)[0],f=i.find(".visio_rLeft").eq(0)[0],m=i.find(".visio_rRight").eq(0)[0],g=i.find(".visio_rLeftUp").eq(0)[0],v=i.find(".visio_rLeftDown").eq(0)[0],_=i.find(".visio_rRightDown").eq(0)[0],b=i.find(".visio_rRightUp").eq(0)[0];new d(u).set(h,"up").set(p,"down").set(f,"left").set(m,"right").set(g,"leftUp").set(v,"leftDown").set(_,"rightDown").set(b,"rightUp")},initRotate:function(c){var l=this;l.options.rotate[c]={},c.find(".visio_rotate").unbind("click").bind("click",function(t){t.stopPropagation()}),c.find(".visio_rotateSquare").unbind("mousemove").bind("mousemove",function(t){t.stopPropagation(),c.find(".visio_rotate_hide").removeClass("visio_rotate_hide")}).unbind("mousedown").bind("mousedown",function(t){var n=$(this);c.draggable("disable"),c.parent().hasClass("visio_container_custom")&&c.parent().draggable("disable")
;var o=l.options.rotate[c],e=n.parent().rotationDegrees();if(n.parent().css({transform:"rotate(0deg)"}),!o.centerPoint){var i={},a=n.parent().find(".visio_rotateCenter")[0].getBoundingClientRect();i.x=a.left,i.y=-a.top,l.options.rotate[c].centerPoint=i,console.log("center:"+i.x+"///"+i.y)}if(!o.firstPoint){var s={},r=n[0].getBoundingClientRect();s.x=r.left,s.y=-r.top,l.options.rotate[c].firstPoint=s,console.log("first:"+s.x+"///"+s.y)}n.parent().css({transform:"rotate("+e+"deg)"}),n.parent().parent().unbind("mousemove").bind("mousemove",function(t){var e={};e.x=t.clientX,e.y=-t.clientY;var i=l.getAngle(o.centerPoint,o.firstPoint,e);console.log("angleBefore:"+i),console.log("angleAfter:"+i),e.x<o.centerPoint.x&&(i=360-i),isNaN(i)?e.y>o.centerPoint.y?n.parent().css({transform:"rotate(360deg)"}):n.parent().css({transform:"rotate(180deg)"}):(i%=360,n.parent().css({transform:"rotate("+i+"deg)"}))}).unbind("mouseup").bind("mouseup",function(){$(this).unbind("mousemove"),
l.options.rotate[c]={},l.setCustomValue(c)})}).unbind("mouseup").bind("mouseup",function(){c.draggable("enable"),c.parent().hasClass("visio_container_custom")&&c.parent().draggable("enable")}).unbind("mouseout").bind("mouseout",function(){c.draggable("enable"),c.parent().hasClass("visio_container_custom")&&c.parent().draggable("enable")})},fixResizeDiv:function(t){},getAngle:function(t,e,i){var n=e.x-t.x,o=i.x-t.x,a=e.y-t.y,s=i.y-t.y,r=parseFloat(Math.sqrt(n*n+o*o)*Math.sqrt(a*a+s*s)),c=parseFloat((n*o+a*s)/r);return angle=Math.acos(c),angle=angle/Math.PI*180,angle},getData:function(){for(var t=[],e=this.com.find(".visio_container .visio_obj"),i=0;i<e.length;i++){var n=e.eq(i),o={};o.height=n.css("height"),o.width=n.css("width"),o.top=n.css("top"),o.left=n.css("left"),o.rotateDegree=n.rotationDegrees(),o.type=n.attr("visiotype"),o.text=n.find(".visio_obj_font").eq(0).html(),o.bgColor=n.css("backgroundColor"),o.container=n.hasClass("visio_container_custom"),t.push(o)}return t},
setData:function(t){var e=this.com.find(".visio_container");e.html("");for(var i="",n="",o=this.options.mappingName,a=this.options.mappingList,s=this.options.ratio,r=0;r<t.length;r++){var c="height:"+t[r].height.replace("px","")*s+"px;width:"+t[r].width.replace("px","")*s+"px;position:absolute;top:"+t[r].top.replace("px","")*s+"px;left:"+t[r].left.replace("px","")*s+"px;background-color:"+(t[r][o]&&a[t[r][o]]?a[t[r][o]]:t[r].bgColor)+";transform:rotate("+t[r].rotateDegree+"deg);-ms-transform:rotate("+t[r].rotateDegree+"deg);-webkit-transform:rotate("+t[r].rotateDegree+"deg);";!0===t[r].container?n+="<div dataindex='"+r+"' class='visio_obj visio_container_custom' visioType='"+t[r].type+"' style='"+c+"'><div class='visio_obj_font'>"+t[r].text+"</div></div>":i+="<div dataindex='"+r+"' class='visio_obj' visioType='"+t[r].type+"' style='"+c+"'><div class='visio_obj_font'>"+t[r].text+"</div></div>"}""!=n?(e.append(n),e.find(".visio_container_custom").append(i)):e.append(i),
this.options.data=t,"show"==this.options.type&&(this.options.onClick instanceof Function&&this.bindClick(),this.options.infoTempl instanceof Function&&this.bindMousemove())},bindClick:function(){var e=this;this.com.find(".visio_container .visio_obj").not(".visio_container_custom").unbind("click").bind("click",function(){if(e.options.onClick instanceof Function){var t=$(this).attr("dataindex");e.options.onClick(e.options.data[t])}})},bindMousemove:function(){var o=this;this.com.find(".visio_container .visio_obj").unbind("mousemove").bind("mousemove",function(t){var e=$(this).attr("dataindex"),i=o.options.infoTempl(o.options.data[e]);if(t.stopPropagation(),0==$(".visio_obj_info").length){var n='<div class="visio_obj_info">'+i+"</div>";$("body").append(n)}$(".visio_obj_info").css({"background-color":"rgb(255, 255, 255)",top:t.pageY+10,left:t.pageX+10})}).unbind("mouseout").bind("mouseout",function(t){$(".visio_obj_info").remove()})}}),PJF.apply(PJF.ui.visio.prototype,{
getClassName:function(){return"PJF.ui.visio"},destroy:function(){this.com&&this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null}}),jQuery.fn.rotationDegrees=function(){var t=this.css("-webkit-transform")||this.css("-moz-transform")||this.css("-ms-transform")||this.css("-o-transform")||this.css("transform");if("string"==typeof t&&"none"!==t)var e=t.split("(")[1].split(")")[0].split(","),i=e[0],n=e[1],o=Math.round(Math.atan2(n,i)*(180/Math.PI));else o=0;return o},PJF.ui.floatDiv=PJF.extend(PJF.ui.component,{init:function(t){this.trimParam(t),this.createDom(),this.bindEvents()},trimParam:function(t){this.options={msg:t.msg||"请输入提示信息！"},$.extend(this.options,t),this.transferMsg()},transferMsg:function(){this.options.helpUrl&&(this.options.msg="<a target = '_blank' href = 'http://"+location.host+"/bosWeb/page/common/operGuide/"+this.options.helpUrl+"' color = 'blue'>操作指引</a>")},bindEvents:function(t){var e=this
;PJF.hotKeyManager.addHotKeyListener(PJF.hotkeyMap.F1,function(){e.switchDom()}),this.com.find("div.pjf-float-get-m").off("click").on("click",function(){e.switchDom()})},keyDown:function(){},handlerContent:function(){this.com.find("div.pjf-float-mid").removeClass("no_limited"),this.handlerTip()},handlerTip:function(){var t=this.com.find("p.pjf-float-cont-t").height(),e=this.com.find("div.pjf-float-get-m");30<t?e.html("F1展开"):e.text("")},switchTip:function(){var t=this.com.find("div.pjf-float-get-m"),e=this.com.find("div.pjf-float-mid").height();t.text()&&(32<e?t.html("F1收缩"):t.html("F1展开"))},createDom:function(){var t;t=['<div class="pjf-float-div"><div class="pjf-float-mid"><div class="pjf-float-cont-f"><p class="pjf-float-cont-t">'+this.options.msg+'</p>  </div><div class="pjf-float-get-m">更多<b>&gt;&gt;</b></div></div><div class="pjf-float-get-p"></div><div class="pjf-float-help-b"></div></div>'],$("body").prepend(t.join("")),this.com=$(".pjf-float-div"),
this.com.attr("componentid",this.id),this.com.attr("componenttype","PJF.ui.floatDiv"),this.handlerContent()}}),PJF.apply(PJF.ui.floatDiv.prototype,{getClassName:function(){return"PJF.ui.floatDiv"},switchDom:function(){this.com.find("div.pjf-float-mid").toggleClass("no_limited"),this.switchTip()},setMessage:function(t,e){this.options.helpUrl=e,this.options.msg=t,this.transferMsg(),this.com.find("p.pjf-float-cont-t").html(this.options.msg),this.handlerContent()},destroy:function(){PJF.ui.componentMgr.remove(this.id),PJF.hotKeyManager.removeHotKeyListener(),this.com&&this.com.remove(),this.com=null}}),PJF.ui.floatMenu=PJF.extend(PJF.ui.component,{init:function(t){this.options={data:[],pageCount:12,title:"浮动菜单"},$.extend(this.options,t);this.initHtml(),this.initData(),this.bindEvents()},initHtml:function(){this.com=$("<div></div>");var t="<div class='floatMenu_main'><div class='floatMenu_title'>"+this.options.title+"</div><div class='floatMenu_content'></div></div>";this.com.append(t),
$("body").append(this.com)},initCss:function(){this.com.find(".floatMenu_content").css({height:30*this.options.pageCount+"px"})},initData:function(){this.options.pageNumber=1,this.setData(this.options.data)},setData:function(t){var e="",i=(this.options.pageNumber-1)*this.options.pageCount,n=this.options.pageNumber*this.options.pageCount;i>=this.options.pageCount&&(e+="<div class='floatMenu_pagePre'></div>");for(var o=i;o<(n>t.length?t.length:n);o++)e+="<div class='floatMenu_text' menuIndex='"+o+"'>"+t[o].text+"</div>";n<t.length&&(e+="<div class='floatMenu_pageNext'></div>"),this.com.find(".floatMenu_content").children().remove(),this.com.find(".floatMenu_content").append(e),this.bindDataEvents()},bindEvents:function(){var c=this,e=c.com.find(".floatMenu_title");e.unbind("mousedown").bind("mousedown",function(t){var a=t.clientX,s=t.clientY,r=!1;e.unbind("mousemove").bind("mousemove",function(t){r=!0
;var e=c.com.find(".floatMenu_main"),i=e[0],n=t.clientY-(s-i.offsetTop),o=t.clientX-(a-i.offsetLeft);n<0&&(n=0),n>document.documentElement.clientHeight-30&&(n=document.documentElement.clientHeight-30),o<0&&(o=0),o>document.documentElement.clientWidth-125&&(o=document.documentElement.clientWidth-125),e.css({top:n+"px",left:o+"px"}),a=t.clientX,s=t.clientY}),e.unbind("mouseup").bind("mouseup",function(t){e.unbind("mousemove"),r||($(this).hasClass("floatMenu_title_collapse")?(c.com.find(".floatMenu_content").slideDown(),$(this).removeClass("floatMenu_title_collapse")):(c.com.find(".floatMenu_content").slideUp(),$(this).addClass("floatMenu_title_collapse")))})}),e.unbind("mouseout").bind("mouseout",function(t){e.unbind("mousemove")})},bindDataEvents:function(){var t=this;t.com.find(".floatMenu_pagePre").unbind("click").bind("click",function(){t.options.pageNumber-=1,t.setData(t.options.data)}),t.com.find(".floatMenu_pageNext").unbind("click").bind("click",function(){
t.options.pageNumber+=1,t.setData(t.options.data)}),t.com.find(".floatMenu_text").unbind("click").bind("click",function(){t.com.find(".floatMenu_text_selected").removeClass("floatMenu_text_selected"),$(this).addClass("floatMenu_text_selected"),t.options.onClick instanceof Function&&t.options.onClick(t.options.data[$(this).attr("menuIndex")])})}}),PJF.apply(PJF.ui.floatMenu.prototype,{getClassName:function(){return"PJF.ui.floatMenu"},destroy:function(){this.com&&this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null}}),PJF.ui.dateselect=PJF.extend(PJF.ui.component,{init:function(t){this.initDateSelect(t)},initDateSelect:function(t){this.options={},$.extend(this.options,t),this.com.addClass("dateselect");var e=this.initHtml();this.com.append(e),this.options.showpanelFlag=!0,this.options.disableflag=!1,this.adjustStyle(),this.bindEvent()},bindEvent:function(){var e=this;e.com.find(".dateselect-combo-icon").mouseover(function(){
$(this).addClass("dateselect-combo-hover")}).mouseout(function(){$(this).removeClass("dateselect-combo-hover")}),e.com.find(".dateselect-combo-icon").click(function(){e.options.disableflag||(e.options.showpanelFlag?(e.com.find(".dateselect-panel").offset({left:e.com.find(".dateselect-combo-text ").offset().left}),e.com.find(".dateselect-panel").show(),e.options.showpanelFlag=!1):(e.com.find(".dateselect-panel").hide(),e.options.showpanelFlag=!0))}),e.com.find("td").mouseover(function(){$(this).addClass("dataselect-td-item-hover")}).mouseout(function(){$(this).removeClass("dataselect-td-item-hover")}).click(function(){if(!$(this).hasClass("dateselect-disabled")){var t=$(this).html();parseInt(t)<10&&(t="0"+parseInt(t)),e.com.find(".dateselect-combo-text").attr("value",t),e.com.find(".dateselect-panel").hide(),e.options.showpanelFlag=!0}})},adjustStyle:function(){this.com.find("td").addClass("dateselect-disabled");var t=this.options.data
;for(var e in t instanceof Array||new PJF.ui.messageBox({style:"warning",title:"警告",content:"data必须是数组"}),t)this.com.find("tr td").each(function(){$(this).text()==t[e]&&$(this).removeClass("dateselect-disabled")});this.com.find(".dateselect-panel").offset({left:this.com.find(".dateselect-combo-text ").offset().left}),this.options.showpanelFlag&&this.com.find(".dateselect-panel").hide()},initHtml:function(){var t=[],e=1;t.push('<span class="container" ><input type="text" class="dateselect-combo-text dateselsect-content "  /><span class="dateselect-combo-icon"></span></span>'),t.push('<div class="dateselect-panel" style="position:absolute;z-index: 900"><div class="calendar-body"><table cellspacing="0" cellpadding="0" border="0"><tbody>');for(var i=0;i<=5;i++){t.push("<tr>");for(var n=0;n<6&&!(31<e);n++)t.push('<td class="calendar-day">'+e+"</td>"),e++;t.push("</tr>")}return t.push("</tbody></table></div></div>"),t.join("")}}),PJF.apply(PJF.ui.dateselect.prototype,{
getClassName:function(){return"PJF.ui.dateselect"},getValue:function(){return this.com.find(".dateselsect-content").attr("value")},setValue:function(t){parseInt(t)<10&&(t="0"+parseInt(t,10)),this.com.find(".dateselsect-content").attr("value",t)},destroy:function(){this.com.remove()},disable:function(){this.options.disableflag=!0,this.com.find(".container .dateselsect-content ").addClass("dateselect_disabled_input").attr("disabled",!0),this.com.find(".container .dateselect-combo-icon ").addClass("dateselect-arrow-disable"),this.com.find(".dateselect-panel").hide(),this.showpanelFlag=!0},enable:function(){this.options.disableflag=!1,this.com.find(".container .dateselsect-content ").removeClass("dateselect_disabled_input").attr("disabled",!1),this.com.find(".container .dateselect-combo-icon").removeClass("dateselect-arrow-disable")},setReadOnly:function(t){
t?this.com.find(".container .dateselsect-content ").addClass("pjf_readonly_input").attr("readOnly",t):this.com.find(".container .dateselsect-content ").removeClass("pjf_readonly_input")}}),PJF.ui.scanViewer=PJF.extend(PJF.ui.component,{init:function(t){var e=this,i={col:2,colSet:!0,colSetCfg:[{desc:resource.SCANVIEWER_COL_TWO,name:2},{desc:resource.SCANVIEWER_COL_FOUR,name:4},{desc:resource.SCANVIEWER_COL_SIX,name:6},{desc:resource.SCANVIEWER_COL_EIGHT,name:8}],showBtn:[!0,!0,!0,!0,!0,!0,!0],data:[],onSelect:null};e.conf=$.extend(i,t),e.com.append('<div class="scanViewer_cntr"><div class="scanViewer_top"><div id="scanViewer_colset"></div><div class="scanViewer_top_right"><div id="scanViewer_topbtn1"></div><div id="scanViewer_topbtn2"></div></div></div><div class="scanViewer_center"><div class="scanViewer_content"></div></div><div class="scanViewer_bottom"><div class="scanViewer_btncntr"></div></div></div>'),e.size={height:600,width:800},e.imglist=[],e.btn=[],e.topbtn=[],
e.checkedImg=[],e.thumbView=!0,e.lastClickTime=new Date,e.setValue(t.data),e.topbtn.push(new PJF.ui.linkButton({dom:"scanViewer_topbtn1",style:"assistant",name:resource.SCANVIEWER_SELECT_ALL,onclick:function(){for(a in e.imglist)e.imglist[a].checked||e.imgSelect(a,!0)}})),e.topbtn.push(new PJF.ui.linkButton({dom:"scanViewer_topbtn2",style:"assistant",name:resource.SCANVIEWER_SELECT_INVERT,onclick:function(){for(a in e.imglist)e.imgSelect(a,!0)}}));var n=[{name:resource.SCANVIEWER_SETUP,onclick:function(){console.log(1)},bgimg:"scanViewer/setting.gif"},{name:resource.SCANVIEWER_ZOOM_IN,onclick:function(){console.log(2)},bgimg:"scanViewer/magnify.gif"},{name:resource.SCANVIEWER_ZOOM_OUT,onclick:function(){console.log(3)},bgimg:"scanViewer/reduce.gif"},{name:resource.SCANVIEWER_REPLACE,onclick:function(){console.log(4)},bgimg:"scanViewer/replace.gif"},{name:resource.SCANVIEWER_INSERT,onclick:function(){console.log(5)},bgimg:"scanViewer/replace.gif"},{name:resource.SCANVIEWER_REVERSE,
onclick:function(){console.log(6)},bgimg:"scanViewer/rollover.gif"},{name:resource.SCANVIEWER_ROTATE_LEFT,onclick:function(){console.log(7)},bgimg:"scanViewer/rotateleft.gif"},{name:resource.SCANVIEWER_ROTATE_RIGHT,onclick:function(){console.log(8)},bgimg:"scanViewer/rotateright.gif"},{name:resource.SCANVIEWER_DELETE,onclick:function(){console.log(9)},bgimg:"scanViewer/delete.gif"},{name:resource.SCANVIEWER_SCAN,onclick:function(){console.log(10)},bgimg:"scanViewer/scaner.gif"}];for(a in n)e.addBtn(n[a]);for(a in e.conf.showBtn)e.conf.showBtn[a]&&e.btn[a].dom.show();e.conf.colSet&&(e.colset=new PJF.ui.select({dom:"scanViewer_colset",data:e.conf.colSetCfg,onChange:function(){e.setCol(e.colset.getValue()),e.modSwitch(!0)}}))},addImg:function(t){var n=this,e={checked:!1,rt:0};for(var i in t){var o={};o=$.extend(o,e,t[i]),n.imglist.push(o)}if(n.reSize(!0),n.com.find(".scanViewer_backBtn").unbind("click").bind("click",function(t){t.stopPropagation()
;var e=$(this),i=parseInt(e.attr("imgid"))-1;!isNaN(i)&&-1<i&&n.imgSelect(parseInt(e.attr("imgid"))-1)}).bind("dblclick",function(t){t.stopPropagation()}),n.com.find(".scanViewer_nextBtn").unbind("click").bind("click",function(t){t.stopPropagation();var e=$(this),i=parseInt(e.attr("imgid"))+1;!isNaN(i)&&i<n.imglist.length&&n.imgSelect(i)}).bind("dblclick",function(t){t.stopPropagation()}),i){var a=n.imglist.length-1-i;n.imgSelect(a)}},setValue:function(t){this.imglist=[],this.addImg(t)},getValue:function(t){this.getImg(t)},getImg:function(t){return"object"==typeof t?t:"number"!=typeof t||t>=this.imglist.length?void console.error("PJF.ui.imgPreviewer.getImg() 参数必须为数字且小于图片数！"):this.imglist[t]},getImgByAttr:function(t,e){var i=this.imglist,n=[];for(a in i)i[a][t]==e&&n.push(i[a]);return n},getSelected:function(){return this.checkedImg},reSize:function(t,r){var e,c,l=this,n=l.imglist,d=l.conf.col,o=l.com.find(".scanViewer_center").scrollTop();function a(t){
var e=t.imgH,i=t.imgW,n=t.dom.find("img"),o=l.com.find(".scanViewer_center").height(),a=l.com.find(".scanViewer_center").width()-17,s=parseInt(t.dom.attr("imgid"));l.thumbView?(t.dom.css({width:u,height:u,left:s%d*u+20*(s%d+1),top:Math.ceil((s+1)/d-1)*u+20*Math.ceil((s+1)/d)}),l.com.find(".scanViewer_content").css("margin-left",0),t.dom.find(".scanViewer_imgOptBtn").hide(),i<e?(n.css({height:u,width:"auto"}),n.css({"margin-left":(u-n.width())/2,"margin-top":"0"})):(n.css({height:"auto",width:u}),n.css({"margin-left":0,"margin-top":(u-n.height())/2})),t.dom.find("img").css({transform:"rotate("+90*t.rt+"deg)"}),r||l.com.find(".scanViewer_content").height(parseInt(c.dom.css("top"))+u+30)):(t.dom.css({height:o-4,width:a-4,top:0,left:s*(a+10)}),t.dom.find(".scanViewer_imgOptBtn").show(),t.dom.find(".scanViewer_backBtn").css({top:(o-4-62)/2,left:10}),t.dom.find(".scanViewer_nextBtn").css({top:(o-4-62)/2,right:10}),t.rt%2==1?a/o<=e/i?(n.css({height:o-4,width:"auto"}),n.css({"margin-left":0,
"margin-top":(o-n.height())/2})):(n.css({height:"auto",width:o-4}),n.css({"margin-left":(a-n.width())/2,"margin-top":(n.width()-n.height())/2})):o/a<=e/i?(n.css({height:o-4,width:"auto"}),n.css({"margin-left":(a-n.width())/2,"margin-top":0})):(n.css({height:"auto",width:a-4}),n.css({"margin-left":0,"margin-top":(o-n.height())/2})),t.dom.find("img").css({transform:"rotate("+90*t.rt+"deg)"}),l.com.find(".scanViewer_content").height(o))}for(h in l.size.height=l.com.height(),l.size.width=l.com.width(),l.com.find(".scanViewer_center").height(l.size.height-95),e=(l.size.width-15-20*(d+1))/d,l.size.thumbSize=e-4,t&&l.com.find(".scanViewer_item").unbind("click").remove(),n){var u=l.size.thumbSize,s=n[h],h=parseInt(h);c=s,
t?(s.dom=$('<div class="scanViewer_item" id="imgid_'+h+'" imgid="'+h+'"><div class="scanViewer_backBtn scanViewer_imgOptBtn" imgid="'+h+'"></div><div class="scanViewer_nextBtn scanViewer_imgOptBtn" imgid="'+h+'"></div><div class="scanViewer_item_title" style="color:'+s.color+'">'+s.title+'</div><div class="scanViewer_item_page">'+(h+1)+"/"+n.length+"</div></div>"),s.imgDom&&s.oldUrl==s.url?s.imgDom.attr("imgid",h):(s.oldUrl=s.url,s.imgDom=$('<img src="'+PJF.util.addAtchBtchNoToUrl(s.url)+'" imgid="'+h+'" title="'+s.title+'"/>')),s.dom.append(s.imgDom),l.com.find(".scanViewer_content").append(s.dom)):(s.dom.find(".scanViewer_item").attr("imgid",h),s.dom.find(".scanViewer_imgOptBtn").attr("imgid",h),s.dom.find(".scanViewer_item_page").text(h+1+"/"+n.length),s.dom.find(".scanViewer_item_title").text(s.title).css("color",s.color),s.dom.find("img").attr("imgid",h).attr("title",s.title)),s.imgid=h,s.checked&&l.thumbView&&s.dom.addClass("scanViewer_item_selected");var p=s.dom.find("img")
;if(t){var f=function(){var t=$(this);t.css({height:"auto",width:"auto",margin:0}),n[t.attr("imgid")].imgH=t.height(),n[t.attr("imgid")].imgW=t.width(),a(n[t.attr("imgid")])};p[0].complete?(console.log(s.url+" complete"),f.call(p)):(console.log(s.url+" not complete"),p.bind("load",f))}else a(s);s.dom.unbind("click").bind("click",function(t){var e=$(this),n=new Date;if(300<n-l.lastClickTime){var o=Number($(this).attr("imgid"));if(t.ctrlKey)l.imgSelect(o,!0);else if(t.shiftKey){var a;if((a=l.checkedImg[0]?parseInt(l.checkedImg[0].dom.attr("imgid")):0)<=o)for(i=a;i<=o;i++)i==a?l.imgSelect(i):l.imgSelect(i,!0);else for(i=o;i<a;i++)l.imgSelect(i,!0)}else l.imgSelect(o)}else{e.attr("imgid");l.modSwitch()}l.lastClickTime=n}).unbind("contextmenu").bind("contextmenu",function(){return!1}),l.thumbView?(s.dom.find("img").unbind("mousedown"),s.dom.find("img").unbind("mousewheel")):s.dom.find("img").unbind("mousedown").bind("mousedown",function(t){t.preventDefault()
;var n=$(this),o=t.clientX,a=t.clientY,s=parseInt(n.css("margin-left")),r=parseInt(n.css("margin-top"));n.css({cursor:"move"}),n.bind("mousemove",function(t){if(!(n.width()<=n.parent().width()&&n.height()<=n.parent().height())){var e=t.clientX,i=t.clientY;n.css({"margin-left":s+(e-o),"margin-top":r+(i-a)})}})}).bind("mouseup",function(t){var e=$(this);e.css({cursor:"default"}),e.unbind("mousemove")}).unbind("mousewheel").bind("mousewheel",function(t){t.preventDefault();var e=$(this),i=t.originalEvent.wheelDelta,n=e.attr("imgid");0<i?l.imgMag(n,!0):l.imgMag(n,!1)})}l.com.find(".scanViewer_center").scrollTop(o),l.com.find(".scanViewer_backBtn").unbind("click").bind("click",function(t){t.stopPropagation();var e=$(this),i=parseInt(e.attr("imgid"))-1;!isNaN(i)&&-1<i&&l.imgSelect(parseInt(e.attr("imgid"))-1)}).bind("dblclick",function(t){t.stopPropagation()}),l.com.find(".scanViewer_nextBtn").unbind("click").bind("click",function(t){t.stopPropagation()
;var e=$(this),i=parseInt(e.attr("imgid"))+1;!isNaN(i)&&i<l.imglist.length&&l.imgSelect(i)}).bind("dblclick",function(t){t.stopPropagation()})},imgSwitch:function(t){},imgSelect:function(t,e){var i,n=this,o=n.checkedImg,s=n.imglist;if("object"==typeof t){if(!t.dom)return}else{if("number"!=typeof parseInt(t))return;if(t>=s.length){if(0==s.length)return;i=s[s.length-1]}else i=t<0?s[0]:s[t]}if(!e){for(a in o)o[a].checked=!1;n.checkedImg=[],o=n.checkedImg,n.com.find(".scanViewer_item").removeClass("scanViewer_item_selected")}if(n.thumbView)if(i.checked){i.checked=!1,i.dom.removeClass("scanViewer_item_selected");var r=o.indexOf(i);o.splice(r,1)}else i.checked=!0,i.dom.addClass("scanViewer_item_selected"),o.push(i),n.conf.onSelect&&n.conf.onSelect.call(i);else{if("object"==typeof t)return;var c=parseInt(t),l=n.size.width-17;i.checked=!0,o.push(i),n.com.find(".scanViewer_content").css({"margin-left":-(l+10)*c})}o.sort(function(t,e){
return parseInt(t.dom.attr("imgid"))-parseInt(e.dom.attr("imgid"))}),e||setTimeout(function(){o[0]&&o[0].dom&&n.com.find(".scanViewer_center").scrollTop(parseInt(o[0].dom.css("top"))-20)},100)},imgRotate:function(t,e){this.imglist;var i=(t=this.getImg(t)).rt;i=e?3==i?0:i+1:0==i?3:i-1,t.rt=i,this.reSize(!1,!0)},imgMag:function(t,e){"object"==typeof t&&(t=t[0].dom.attr("imgid"));var i=this.imglist[t],n=i.dom.find("img"),o=parseInt(n.css("margin-left")),a=parseInt(n.css("margin-top")),s=n.width(),r=n.height();if(e&&s<3e5)n.css({height:1.2*r,width:1.2*s,"margin-left":o-.1*s,"margin-top":a-.1*r});else{if(s<=i.dom.width()&&r<=i.dom.height())return this.reSize(),"minSize";n.css({height:r/1.2,width:s/1.2,"margin-left":o+s/12,"margin-top":a+r/12})}},setAttr:function(t,e,i){(t=this.getImg(t)).conf=$.extend(t,e),i?e.url?this.reSize(!0):this.reSize():t.dom.find(".scanViewer_item_title").text(t.title).css("color",t.color)},getAttr:function(t){},modSwitch:function(t){
"boolean"==typeof t?this.thumbView=t:this.thumbView?this.thumbView=!1:this.thumbView=!0,0<this.checkedImg.length&&this.imgSelect(this.checkedImg[0].imgid),this.reSize()},setCol:function(t){"number"==typeof(t=parseInt(t))&&(this.conf.col=t,this.colset.setValue(t,!1),this.reSize())},removeImg:function(t,e,n){var o,s,r=this.imglist;if("number"==typeof t){if(t>=r.length)return void console.error("PJF.ui.scanViewer.removeImg()参数错误！");o=r[t].name,s=r.splice(t,1)}else if("object"==typeof t)for(i=0;i<r.length;i++)if(r[i]==t[0]){s=r.splice(i,1);break}if(e)for(a in r)r[a].name==o&&r.splice(t,1);for(a in this.checkedImg)for(b in s)this.checkedImg[a].dom==s[b].dom&&this.checkedImg.splice(a,1);this.thumbView||this.modSwitch(),n&&this.reSize(!0),this.imgSelect(s[0].imgid)},addBtn:function(t){var e=this,i={},n=t.id?t.id:"scanViewer_btn"+e.btn.length;i.dom=$('<div id="'+n+'"><span>'+t.name+"</span></div>"),i.onclick=t.onclick,e.com.find(".scanViewer_btncntr").append(i.dom),
i.dom.bind("click",function(){i.disabled||i.onclick&&i.onclick(e)}),i.dom.css({height:50,width:52,position:"relative",display:"inline-block",margin:"0 10px",cursor:"pointer"}),i.dom.find("span").css({position:"absolute",bottom:"0px",left:"0",width:52,height:18,"text-align":"center","font-size":"12px","line-height":"18px"}),e.btn.push(i)},setBtnClick:function(t,e){this.btn[t].onclick=e},setBtnTitle:function(t,e){this.btn[t].name=e,this.btn[t].dom.find("span").text(e)},showBtn:function(t,e){e?this.btn[t].dom.show():this.btn[t].dom.hide()},disableBtn:function(t,e){this.btn[t].disabled=e},destroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com.html(""),this.com=null,this.id=null}}),PJF.ui.helpTip=PJF.extend(PJF.ui.component,{init:function(t){this.options={width:20,height:22},
$.extend(this.options,t);this.initHtml(),this.initCss(),this.bindEvents()},initHtml:function(){this.options.dom&&this.com.append("<span class='pfj_helpTip'></span>")},initCss:function(){this.com.find(".pfj_helpTip").css({width:this.options.width+"px",height:this.options.height+"px"});var t=this.com.parents("ul");0<t.length&&t.eq(0).hasClass("pjf_ul_three")&&!t.eq(0).hasClass("hasHelpTip")&&t.eq(0).addClass("hasHelpTip")},setHelpMsg:function(t){this.options.helpMessage=t},bindEvents:function(){var t=this;t.com.find(".pfj_helpTip").hover(function(){t.com.checkTip({Message:t.options.helpMessage||resource.TEXTFIELD_HELP_MSG,show:function(){return!1},flag:"help"})},function(){t.com.checkTip({Message:t.options.helpMessage||resource.TEXTFIELD_HELP_MSG,show:function(){return!0},flag:"help"})})}}),PJF.apply(PJF.ui.helpTip.prototype,{getClassName:function(){return"PJF.ui.helpTip"},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null}}),
PJF.ui.accountList=PJF.extend(PJF.ui.component,{init:function(t){this.conf=t,this.options={},$.extend(this.options,t),this.accountListJqObj=$("<div class = 'pjf_accountList'></div>"),this.titleJqObj=$("<div class= 'title'><span class='titleFont'>"+this.conf.title+"</span></div>"),this.accountListJqObj.append(this.titleJqObj),this.contentAreaJqObj=$("<div class = 'contentArea'></div>"),this.options.data?this.addAccount(this.options.data,!0):console.log("传入数据无效"),this.accountListJqObj.append(this.contentAreaJqObj),this.options.dom&&this.com.append(this.accountListJqObj),this.bindEvents()},checkAccVal:function(t,e){for(var i=!0,n=0;n<t.length;n++)t[n].accountNum[0].accountNo==e[0].accountNum[0].accountNo&&(console.log("所需增加账户已经存在"),i=!1);return i},updateAccView:function(t){for(var e=0;e<t.length;e++){if(!t[e].accountNum[0]){console.log("账户数据中缺失账号值");break}this.realInfoJqObj=$("<div class='realInfo'></div>"),
this.accountJqObj=$("<div class='account' > <div class= 'imgTriangle' ></div><div class='accountFont'>"+t[e].accountNum[0].accountNo+"</div></div>"),this.accountJqObj.attr("no",t[e].accountNum[0].accountNo),t[e].deleteEnable&&this.accountJqObj.append($("<div class= 'imgCross'></div>")),this.number=t[e].accountNum[0].accountNo,this.ulFeatureJqObj=$("<div class='ulFeature'></div>"),this.ulFeatureJqObj.attr("number",t[e].accountNum[0].accountNo),this.ulJqObj=$("<ul></ul>"),this.addProduct(t[e].info,t[e].accountNum[0].accountNo,!0),this.realInfoJqObj.append(this.accountJqObj),this.realInfoJqObj.append(this.ulFeatureJqObj),this.contentAreaJqObj.append(this.realInfoJqObj)}},addAccount:function(t,e){var i=this.options.data,n=!0;e||(n=this.checkAccVal(i,t))&&i.push(t[0]),t&&n?this.updateAccView(t):console.log("账户数据无效，请重新传入")},checkAccExt:function(t,e){for(var i=!1,n=0;n<e.length;n++)e[n].accountNum[0].accountNo==t&&(i=!0);return i},checkProVal:function(t,e,i){
for(var n=!0,o=0;o<i.length;o++)if(e==i[o].accountNum[0].accountNo)for(var a=0;a<i[o].info.length;a++)i[o].info[a].id==t[0].id&&(console.log("所需增加产品已经存在"),n=!1);return n},updateProView:function(t,e,i){for(var n=0;n<t.length;n++)this.liJqObj=$("<li class='unclick'> <span class='unclickText'>"+t[n].name+"</li>"),this.liJqObj.attr("id",t[n].id),i?this.ulJqObj.append(this.liJqObj):this.com.find("div[number = "+e+"]>ul").append(this.liJqObj);this.ulFeatureJqObj.append(this.ulJqObj)},addProduct:function(t,e,i){var n=this.options.data,o=!0,a=!1;if(!i&&(o=this.checkProVal(t,e,n),(a=this.checkAccExt(e,n))||console.log("所需增加产品填入的所属账号不存在，无法新增对应产品"),o&&a))for(var s=0;s<n.length;s++)e==n[s].accountNum[0].accountNo&&n[s].info.push(t[0]);t&&e&&o?this.updateProView(t,e,i):console.log("产品数据无效，请重新传入")},delAccount:function(t){for(var e,i=this.options.data,n=!1,o=$(".accountFont"),a=0;a<o.length;a++)if(t==o[a].innerText){$(o[a]).parents(".realInfo").remove();break}
for(a=0;a<i.length;a++)if(i[a].accountNum[0].accountNo==t){e=a,n=!0;break}n?i.splice(e,1):console.log("所需删除的账号不存在")},delProduct:function(t,e){for(var i,n,o,a=this.com.find("div[number = "+e+"]>ul").find("li"),s=this.options.data,r=!1,c=0;c<a.length;c++)if(a.eq(c).attr("id")==t){i=c;break}a.eq(i).remove();for(c=0;c<s.length;c++)if(e==s[c].accountNum[0].accountNo){n=c;for(var l=0;l<s[c].info.length;l++)if(s[c].info[l].id==t){o=l,r=!0;break}}r?s[n].info.splice(o,1):console.log("所需删除的产品不存在")},initProState:function(t,e){1==e?t.append("<div class='imgDone'> </div>"):2==e?t.append("<div class='imgUndone'></div>"):3==e?t.append("<div class='imgInput'></div>"):4==e?t.append("<div class='imgReview'></div>"):console.log("所输入产品状态码无效")},modProState:function(t,e){t.removeClass(),1==e?t.addClass("imgDone"):2==e?t.addClass("imgUndone"):3==e?t.addClass("imgInput"):4==e?t.addClass("imgReview"):console.log("所输入产品状态码无效")},checkStateVal:function(t,e,i){var n=!0
;return t.hasClass("imgDone")?e=1:t.hasClass("imgUndone")?e=2:t.hasClass("imgInput")?e=3:t.hasClass("imgReview")&&(e=4),e==i&&(n=!1,console.log("所需修改的产品状态与原状态相同")),n},setProductState:function(t,e,i){for(var n=this.com.find("div[number = "+e+"]>ul>li"),o=!1,a=this.options.data,s=0;s<n.length;s++){if(t==n.eq(s).attr("id")){var r=n.eq(s).find("div");r.length?this.checkStateVal(r,0,i)&&this.modProState(r,i):this.initProState(n.eq(s),i),o=!0}}for(s=0;s<a.length;s++)if(e==a[s].accountNum[0].accountNo)for(var c=0;c<a[s].info.length;c++)if(a[s].info[c].id==t){a[s].info[c].state=i;break}o||console.log("所需修改状态的产品不存在")},getAccountByNo:function(t){for(var e,i=this.options.data,n=!1,o=0;o<i.length;o++)if(t==i[o].accountNum[0].accountNo){e=i[o],n=!0;break}if(n)return console.log(e),e;console.log("根据该账号值所查询的账号不存在")},getProByAccNo:function(t){for(var e,i=this.options.data,n=!1,o=0;o<i.length;o++)if(t==i[o].accountNum[0].accountNo){e=i[o].info,n=!0;break}if(n)return console.log(e),e
;console.log("根据该账号值所查询的账号不存在")},getProductByID:function(t){for(var e,i=this.options.data,n=!1,o=0;o<i.length;o++)for(var a=0;a<i[o].info.length;a++)if(t==i[o].info[a].id){e=i[o].info[a],n=!0;break}if(n)return console.log(e),e;console.log("根据该产品ID所查询的产品不存在")},updateProSltCanView:function(t){t.removeClass("click")},cancelProSelected:function(t,e){for(var i=this.com.find("div[number = "+e+"]>ul>li"),n=!1,o=this.options.data,a=this.com.find("div[no = "+e+"]"),s=0;s<i.length;s++){if(i.eq(s).attr("id")==t){this.updateProSltCanView(i.eq(s)),n=!0;break}}if(n)for(s=0;s<o.length;s++)if(o[s].accountNum[0].accountNo==e)for(var r=0;r<o[s].info.length;r++)if(t==o[s].info[r].id){o[s].info[r].state=0;break}n?a.find(".active").length||this.updateAccSltView(a):console.log("所需主动撤销选中的产品不存在")},updateProSltView:function(t){t.siblings().removeClass("click"),t.addClass("click")},setAccSelected:function(t){var e,i=!1,n=this.options.data,o=this.com.find("div[no = "+t+"]");if(o.length&&(i=!0),i){
for(var a=0;a<n.length;a++)if(n[a].accountNum[0].accountNo==t){e=n[a];break}var s=o.parents(".realInfo").siblings().find(".account");for(a=0;a<s.length;a++)s.eq(a).hasClass("accountClick")&&(s.eq(a).removeClass("accountClick"),s.eq(a).find(".imgTriangle").removeClass("active"),s.eq(a).find(".accountFont").removeClass("accountFontActive"),s.eq(a).find(".imgCross").removeClass("imgCrossActive"));o.addClass("accountClick")}if(i)return console.log(e),e;console.log("所需主动控制选中的账户不存在")},setProSelected:function(t,e){for(var i,n=this.com.find("div[number = "+e+"]>ul>li"),o=!1,a=this.options.data,s=this.com.find("div[no = "+e+"]"),r=0;r<n.length;r++){if(n.eq(r).attr("id")==t){this.updateProSltView(n.eq(r)),o=!0;break}}if(o)for(r=0;r<a.length;r++)if(a[r].accountNum[0].accountNo==e)for(var c=0;c<a[r].info.length;c++)if(t==a[r].info[c].id){a[r].info[c].state=1,i=a[r].info[c],console.log(i);break}if(o)return s.find(".active").length||this.updateAccSltView(s),i;console.log("所需主动控制选中的产品不存在")},
updateAccSltView:function(t){var e=t.find(".active"),i=t.parents(".contentArea");t.parents(".contentArea").find(".accountClick").removeClass("accountClick"),t.addClass("accountClick"),i.find(".ulFeature").slideUp(),i.find(".imgTriangle").removeClass("active"),i.find(".imgTriangle").removeClass("activeSlideUp"),i.find(".accountFont").removeClass("accountFontActive"),i.find(".imgCross").removeClass("imgCrossActive"),e.length?t.find(".imgTriangle").addClass("activeSlideUp"):(t.next().slideDown(),t.find(".imgTriangle").addClass("active")),t.find(".imgCross").addClass("imgCrossActive"),t.find(".accountFont").addClass("accountFontActive")},setAccDisplay:function(t,e){var i=this.options.data,n=this.com.find("div[no = "+t+"]"),o=this.com.find("div[no = "+t+"]>.imgTriangle").hasClass("active");this.checkAccExt(t,i)?e&&o?console.log("所需主动控制展开的账号已经展开"):!e&&o?this.updateAccSltView(n):e&&!o?this.updateAccSltView(n):console.log("所需主动控制收起的账号已经收起"):console.log("所需主动控制展示或收起的账号不存在")},
getAccByClick:function(t,e){for(var i,n=0;n<e.length;n++)if(t==e[n].accountNum[0].accountNo){i=e[n];break}return i},bindEvents:function(){var s=this;s.com.on("click",".ulFeature>ul>li",function(){if(s.options.onClickLi){for(var t,e=$(this).find("span").text(),i=$(this).parents(".realInfo").find(".accountFont").text(),n=0;n<s.options.data.length;n++){var o=s.options.data[n];if(i==o.accountNum[0].accountNo)for(var a=0;a<o.info.length;a++)if(e==o.info[a].name){t=o.info[a];break}}s.options.onClickLi(t),s.updateProSltView($(this))}}),s.com.on("click",".imgTriangle",function(){for(var t=$(this).parents(".realInfo").siblings().find(".account"),e=0;e<t.length;e++)t.eq(e).hasClass("accountClick")&&t.eq(e).removeClass("accountClick");$(this).parent().addClass("accountClick"),s.updateAccSltView($(this).parent())}),s.com.on("click",".accountFont",function(){if(s.options.onClickAccount){var t,e=$(this).text();t=s.getAccByClick(e,s.options.data),s.options.onClickAccount(t)}}),
s.com.on("click",".imgCross",function(){if(s.options.onBeforeDelete){var t,e=$(this).parent().find(".accountFont").text();t=s.getAccByClick(e,s.options.data),s.options.onBeforeDelete(t)}})},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.id=null}}),PJF.ui.productList=PJF.extend(PJF.ui.component,{init:function(t){this.options={},$.extend(this.options,t),this.options.search=!!this.options.search&&this.options.search,this.setData(this.options.data,this.options.search)},bindEvents:function(){var n=this;n.com.find(".pjf-proList-main").bind("click",function(){var t=[],e=$(this).find(".pjf-proList-main-cover");if(!$(this).hasClass("disabled")&&0==e.length){for(var i=0;i<n.options.data.length;i++)n.options.data[i].id==$(this).attr("productId")&&t.push(n.options.data[i]);n.options.onClick&&n.options.onClick(t)}})},setProChecked:function(i){if(i!==undefined){var n=this;n.com.find(".pjf-proList-main").each(function(){
if($(this).attr("productId")==i)for(var t=0;t<n.options.data.length;t++)if(n.options.data[t].id==$(this).attr("productId")){var e=$(this).find(".pjf-proList-check");$(e).hasClass("pjf-proList-unchecked")?($(e).removeClass("pjf-proList-unchecked"),$(e).addClass("pjf-proList-checked"),n.options.data[t].isChecked=!0):($(e).removeClass("pjf-proList-checked"),$(e).addClass("pjf-proList-unchecked"),n.options.data[t].isChecked=!1)}})}},setProCovered:function(n,o){if(n!==undefined){var a=this,s="";a.com.find(".pjf-proList-main").each(function(){if($(this).attr("productId")==n){var t=$(this).find(".pjf-proList-main-cover"),e=$(this).find(".pjf-proList-link img");if(0==t.length)$(this).append('<div class="pjf-proList-main-cover"></div>'),e.attr("src",o);else{for(var i=0;i<a.options.data.length;i++)a.options.data[i].id==n&&(s=a.options.data[i].src);t.remove(),e.attr("src",s)}}})}},disabledCheck:function(e){if(e!==undefined){this.com.find(".pjf-proList-main").each(function(){
var t=$(this).find(".pjf-proList-check");$(this).attr("productId")==e&&$(t).hasClass("pjf-proList-checked")&&$(this).addClass("disabled")})}},enabledCheck:function(e){if(e!==undefined){this.com.find(".pjf-proList-main").each(function(){var t=$(this).find(".pjf-proList-check");$(this).attr("productId")==e&&$(t).hasClass("pjf-proList-checked")&&$(this).removeClass("disabled")})}},getValue:function(t){var i=this,n=[];if(0==t)for(var e=0;e<i.options.data.length;e++)i.options.data[e].isSigned&&n.push(i.options.data[e]);else i.com.find(".pjf-proList-main").each(function(){var t=$(this).find(".pjf-proList-check");if($(t).hasClass("pjf-proList-checked"))for(var e=0;e<i.options.data.length;e++)i.options.data[e].id==$(this).attr("productId")&&n.push(i.options.data[e])});return n},setValue:function(t){for(var e=this.com.find(".pjf-proList-main"),i=0;i<e.length;i++)for(var n=0;n<t.length;n++)if($(e[i]).attr("productId")==t[n].id){
var o=$(e[i]).find(".pjf-proList-sign"),a=$(e[i]).find(".pjf-proList-check"),s=$($(e[i]).find(".pjf-proList-link")).find("img"),r=$(e[i]).find(".pjf-proList-text"),c=$(e[i]).find(".pjf-proList-info");t[n].isSigned?$(o).addClass("pjf-proList-signed"):$(o).removeClass("pjf-proList-signed"),t[n].isChecked?($(a).removeClass("pjf-proList-unchecked"),$(a).addClass("pjf-proList-checked")):($(a).removeClass("pjf-proList-checked"),$(a).addClass("pjf-proList-unchecked")),$(r).html(t[n].text),$(s).attr("src",t[n].src),$(c).empty();for(var l="",d=0;d<t[n].info.length;d++)l+="<span class='pjf-proList-infoDetail'>"+t[n].info[d].name+"</span>";$(c).append(l)}for(i=0;i<this.options.data.length;i++)for(n=0;n<t.length;n++)this.options.data[i].id==t[n].id&&(this.options.data[i].isSigned=t[n].isSigned,this.options.data[i].isChecked=t[n].isChecked,this.options.data[i].text=t[n].text,this.options.data[i].src=t[n].src,this.options.data[i].info=t[n].info)},getData:function(){
for(var t=[],e=0;e<this.options.data.length;e++)t.push(this.options.data[e]);return t},setData:function(t,e){this.options.data=t,this.options.search=e;for(var i=this,n=i.options.numPerRow||0,o=i.options.space||14,a=142*n+n*o,s=$("<div class='pjf-proList-fixed-container'></div>"),r=$("<div class = 'pjf-proList-container' style =' width:"+(a||"")+"px;padding-left:"+o+"px;'></div>"),c=$("<br style = 'clear: both'/>"),l="",d="",u="",h=0;h<i.options.data.length;h++){l=$("<div style='margin-right: "+o+"px;' productId = "+i.options.data[h].id+" class = 'pjf-proList-main'></div>"),
d=$((i.options.data[h].isSigned?"<div class = 'pjf-proList-sign pjf-proList-signed'></div>":"<div class = 'pjf-proList-sign'></div>")+"<div class = 'pjf-proList-link'><img src = '"+i.options.data[h].src+"'/></div><div productId = "+i.options.data[h].id+" "+(i.options.search?"":"class = 'pjf-proList-check "+(i.options.data[h].isChecked?"pjf-proList-checked'":"pjf-proList-unchecked'"))+"></div><div class = 'pjf-proList-text'>"+i.options.data[h].text+"</div>"),u=$("<div class = 'pjf-proList-info'></div>");for(var p=0;p<i.options.data[h].info.length;p++)u.append("<span class='pjf-proList-infoDetail'>"+i.options.data[h].info[p].name+"</span>");l.append(d),l.append(u),r.append(l)}r.append(c),s.append(r),i.options.dom&&i.com.html(s),i.bindEvents()},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.id=null}}),PJF.ui.rareWord=PJF.extend(PJF.ui.component,{init:function(t){this._createDom(),this._fillWinCont(),this._fillWordCont(),
this._adjustCss(),this._bindEvent(),this.hide(),this._located()},_createDom:function(){var t=$('<div class="pjf-rareWord-frame"><div class="pjf-rareWord-icon"></div><div class="pjf-rareWord-control-area"><div class="pjf-rareWord-title" onselectstart="return false"><span class="pjf-rareWord-text">生僻字工具</span><span class="pjf-rareWord-hide"></span></div><div class="pjf-rareWord-level1"><div class="pjf-rareWord-btn pjf-rareWord-left"></div><div class="pjf-rareWord-win"></div><div class="pjf-rareWord-btn pjf-rareWord-right"></div></div><div class="pjf-rareWord-select"></div></div></div>');$(document.body).append(t),this.com=t,this.area=this.com.find(".pjf-rareWord-control-area"),this.win=this.com.find(".pjf-rareWord-win"),this.lis=this.com.find(".pjf-rareWord-select"),this.btn=this.com.find(".pjf-rareWord-btn"),this.bub=this.com.find(".pjf-rareWord-icon"),this.com.attr("componentid",this.id),this.com.attr("componenttype","PJF.ui.rareWord")},_fillWinCont:function(){
var e=['<ul class="pjf-rareWord-sets">'];$.each(this._wordsCache,function(t){e.push('<li class="pjf-rareWord-alpha">'+t+"</li>")}),e.push("</ul>"),this.win.html(e.join(""))},_fillWordCont:function(t){var e=this._wordsCache[t],i=["<ul>"];e&&e.length&&$.each(e,function(t,e){i.push('<li class="pjf-rareWord-unit">'+e+"</li>")}),i.push("</ul>"),this.lis.html(i.join(""))},_bindEvent:function(){var r=this;this.win.on("click",".pjf-rareWord-alpha",function(t){t.stopPropagation(),$(this).addClass("pjf-rareWord-alpha-current").siblings().removeClass("pjf-rareWord-alpha-current"),r._fillWordCont($(this).text())}),this.btn.on("click",function(){$(this).hasClass("pjf-rareWord-left")?t(!0):t(!1)});var c=0<navigator.userAgent.search(/MSIE\s[5-9]\.0/g)?$("body"):$(window);function t(t){var e=r.win.scrollLeft(),i=t?-234:234;r.win.stop().animate({scrollLeft:e+i})}this.com.on("mousedown",".pjf-rareWord-title,.pjf-rareWord-icon",function(t){
var a=t.clientX-parseInt(r.com.css("left")),s=t.clientY-parseInt(r.com.css("top"));c.on("mousemove",function(t){t.stopPropagation();var e=t.clientX-a,i=t.clientY-s,n=$(window).innerWidth(),o=$(window).innerHeight();r.com.css({left:e,top:i}),e<20&&(c.trigger("mouseup"),r.com.css({left:20,top:i})),n-290<e&&(c.trigger("mouseup"),r.com.css({left:n-290,top:i})),i<20&&(c.trigger("mouseup"),r.com.css({left:e,top:20})),o-40<i&&(c.trigger("mouseup"),r.com.css({left:e,top:o-40}))}).on("mouseup",function(t){t.stopPropagation(),c.off("mousemove mouseup")})}),this.bub.on("click",function(){r.show()}),this.com.find(".pjf-rareWord-hide").on("click",function(){r.hide()})},_adjustCss:function(){var t=this.win.find(".pjf-rareWord-sets"),e=this.win.find(".pjf-rareWord-alpha"),i=e.length;t.css({width:e.width()*i})},_located:function(){var t=$(window).innerWidth();this.com.css({left:t-340,top:"50%"})},_wordsCache:{a:"奡靉叆",c:"旵玚棽琤翀珵楮偲赪瑒篪珹捵茝鷐铖宬査嶒",b:"仌昺竝霦犇愊贲琲礴埗別骉錶",d:"炟耑昳菂頔遆珰龘俤叇槙璗惇",e:"峩",f:"沨仹汎沨昉璠雰峯洑茀渢棻棻頫",
g:"玍冮芶姏堽粿筦嘏釭",h:"郃浛訸嗃瓛翃隺鋐滈翚翯竑姮葓皜袆淏皞翙銲鉷澒澔閤婳黃峘鸻鈜褘锽谹嫮",j:"璟玠冏泂劼莙濬暕珒椈珺璟競煚傑玦鑑瑨瑨琎勣寯烱浕斚倢瑴畯雋傢峤",k:"凱堃蒯鹍崑焜姱衎鵾愷鎧",l:"玏呂俍冧倞琍綝壘孋瓅璘粦琍麗樑秝鍊崚链镠皊箖菻竻鸰琭瓈騄浬瑠嶺稜欐昽",m:"劢忞旻旼濛嫚媺铓鋩洺媌媔祃牻慜霂楙媄瑂",n:"婻寗嫟秾迺柟薿枏",p:"芃玭玶罴毰珮蘋慿弸掽逄砯",q:"玘佺耹踆骎啟蒨慬勍嵚婍璆碏焌駸綪锜荍釥嶔啓",r:"汭瑈瑢讱镕婼叡蒻羢瀼",s:"屾昇妽珅姼甡湦骦塽挻甦鉥燊遂陞莦湜奭佀聖骕琡",t:"沺凃禔慆弢颋譚曈榃湉珽瑱橦镋渟黇頲畑媞鰧",w:"韡卍彣炆溦娬韡暐偉湋妏硙珷娒",x:"珣仚旴忺炘昍烜爔斅豨勲敩虓鈃禤燮瑄晞賢翾譞諕璿琇晛焮珣晅郤禼皛哓肸谞迿咲婞昫缐姁猇欻箮翛暁",y:"韻霱祎乂冘弌贠伝伃杙沄旸玙玥垚訚堯溁嫈澐颺熤儀赟祎瑀湧燚嬿鋆嫄愔贇彧崟韻颙晹媖顒禕羕炀弇湲霙嫕浥飏峣曣億雲愔洢暘钖垟詠燿鹓歈貟瑩燏暎畇娫矞祐溳崯颍煬靷谳異軏繄",z:"烝梽喆禛誌曌衠淽枬詟炤昝珘赒"}}),PJF.apply(PJF.ui.rareWord.prototype,{getClassName:function(){return"PJF.ui.rareWord"},show:function(){this.area.show(),this.com.css({position:"absolute"})},hide:function(){this.area.hide(),this.com.css({position:"fixed"})},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove()}}),PJF.ui.title=PJF.extend(PJF.ui.component,{init:function(t){this.options={},$.extend(this.options,t),this.initHtml()},initHtml:function(){for(var t=this.options,e=0;e<t.doms.length;e++){var i=t.doms[e];if($("#"+i).text(t.values[e]),
t.classes[e])for(var n=0;n<t.classes[e].length;n++)$("#"+i).addClass(t.classes[e][n])}},setValue:function(t,e){for(var i=0;i<t.length;i++)$("#"+t[i]).text(e[i])}}),PJF.apply(PJF.ui.title.prototype,{getClassName:function(){return"PJF.ui.title"}}),PJF.ui.layout=PJF.extend(PJF.ui.component,{init:function(t){this.conf=t,this.options={title:"默认标题",dom:null,width:"auto",columns:2,rows:5,buttonList:[]},this.options=$.extend(this.options,t),this.buttonObjList={},this._initWrapHtml(),this._inifooterBtn(),this.compsObjAry=[],this.compsObjList={};for(var e=0;e<this.options.rows;e++)this.compsObjAry.push([])},_initWrapHtml:function(){var t=[];this.radomId=(new Date).getTime(),3<this.options.columns&&(console.log("此组件暂时只支持1、2、3列布局"),this.options.columns=3),t.push("<form id='"+this.radomId+"' class='pjf_layout_form'>"),t.push('<div class="pjf_layout pjf_layout_border ">'),t.push("<div class='pjf_layout_title' ><label id='"+this.radomId+"_label'>"+this.options.title+"</label></div>");var e="one"
;1==this.options.columns?e="one":2==this.options.columns?e="two":3==this.options.columns?e="three":console.log("初始化列数不正确！"),t.push("<div class='pjf_layout_content' >"),t.push("<ul class='pjf_layout_"+e+"'>");for(var i=0;i<this.options.columns*this.options.rows;i++){var n=i+1;t.push("<li curIndex='"+n+"' ></li>")}t.push("</ul>"),t.push("</div>"),t.push("<div class='pjf_layout_footer' >");for(var o=0;o<this.options.buttonList.length;o++)t.push("<div id='"+this.radomId+"-button"+o+"'></div>");t.push("</div></form>"),this.$srcDom=$("#"+this.options.dom);var a={width:this.options.width};this.$srcDom.css(a).html(t.join("")),this.$lis=this.$srcDom.find(".pjf_layout_content>ul>li")},_inifooterBtn:function(){for(var t=0;t<this.options.buttonList.length;t++){var e=this.options.buttonList[t];e.dom=this.radomId+"-button"+t,this.buttonObjList[e.dom]=new PJF.ui.linkButton(e)}},addComps:function(t){var e,i=[];if(t.position){if(2!=t.position.length)return void console.log("组件坐标position参数须为[x,y]")
;if(t.position[0]>this.options.rows||t.position[0]<=0)return void console.log("组件坐标position参数须为行数不合法");if(t.position[1]>this.options.columns||t.position[1]<=0)return void console.log("组件坐标position参数须为列数不合法")}else{var n=this.$srcDom.find(".pjf_layout_content>ul>li[hasIni]:last");if(0==n.size())t.position=[1,1];else{var o=n.attr("colspan")?parseInt(n.attr("colspan")):1;e=n.attr("curIndex")-0+o}}if(e||(e=this._getCurliIndex(t.position,this.options.columns)),e>this.options.columns*this.options.rows)console.log("格子超限了，已不能再追加！");else{if(this.$lis.eq(e-1).attr("hasIni"))console.log("此格子["+t.position[0]+","+t.position[1]+"]已经存放组件,此操作会覆盖之前的组件！"),this.$lis.eq(e-1).html("");else if("none"==this.$lis.eq(e-1).css("display"))return void console.log("此格子["+t.position[0]+","+t.position[1]+"]已经被合并，无法添加组件！");this.compsObjAry[e-1]=[];for(var a=0;a<t.comps.length;a++){t.comps[a].domHtml||(t.comps[a].domHtml="<div></div>");var s=t.comps[a].domHtml.replace(/'|"/g,""),r=this.radomId+"-"+e+"-"+a
;/\s*id\s*=([a-zA-Z0-9\-_]+)\s*/i.test(s)&&(r=RegExp.$1);var c=this.$lis.eq(e-1);$(t.comps[a].domHtml).attr("id",r).appendTo(c),c.attr("hasIni","true"),t.comps[a].args.dom=r;var l=t.comps[a].type.split(".");if("PJF"!=l[0]||"ui"!=l[1]||!l[2])return void console.log(t.comps[a].type+"组件名称不合法！");var d=new PJF.ui[l[2]](t.comps[a].args);this.compsObjAry[e-1].push(d),this.compsObjList[r]=d,i.push(d)}if(t.colspan>this.options.columns&&(console.log("格子合并数"+t.colspan+"不合法，自动转换为"+this.options.columns),t.colspan=this.options.columns),"2"!=this.options.columns||"2"!=t.colspan||e%2!=0)return"2"==t.colspan&&(c.attr("colspan",2),c.next().hide()),i;console.log("格子合并不正确,不能跨行合并,合并操作取消")}},removeComps:function(t){var e=this._getCurliIndex(t,this.options.columns),i=this.$lis.eq(e-1).html("");this.compsObjAry[e]=null,2==i.attr("colspan")?i.next().show():3==i.attr("colspan")&&(i.next().show(),i.next().next().show()),i.attr("colspan","1")},getCompsObj:function(t,e){e||(e=0)
;var i=this._getCurliIndex(t,this.options.columns);return this.compsObjAry[i-1][e]},getCompsObjById:function(t){return this.compsObjList[t]},_getCurliIndex:function(t,e){return(t[0]-1)*e+t[1]},controlRowsHeight:function(){for(var t=1;t<this.options.rows;t++){for(var e=0,i=(t-1)*this.options.columns;i<t*this.options.columns;i++){this.$lis.eq(i).css("height","auto"),e<this.$lis.eq(i).height()&&(e=this.$lis.eq(i).height())}for(i=(t-1)*this.options.columns;i<t*this.options.columns;i++)this.$lis.eq(i).height(e)}},getLayoutFormId:function(){return this.radomId},getLayoutTitleId:function(){return this.radomId+"_label"},setLayoutTitle:function(t){this.$srcDom.find(".pjf-layout-header").html(t)},addLayoutBorder:function(){this.$srcDom.find(".pjf_layout").addClass("pjf_layout_border")},removeLayoutBorder:function(){this.$srcDom.find(".pjf_layout").removeClass("pjf_layout_border")},destroy:function(){this.com.html(""),this.com=null,PJF.ui.componentMgr.remove(this.id)},newDestroy:function(){
this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com.html(""),this.com=null,this.id=null}}),PJF.ui.threeDPie=PJF.extend(PJF.ui.component,{init:function(t){this.colorStore=["#f1a077","#fa66a2","#38c3ff","#ff7200","#bd3b45","#fc6156","#af5f00","#e01b1a","#f4ac00","#b7d687","#e40002","#48bd33","#8cb469","#65666d","#fab042","#91abbc","#1edefd","#e0f080","#c9daff","#b49369","#8e97b3","#87fdff"],this.options={},this.combineParams(t),this.createDom(),this.trimData(),this.drawWhat(),this.bindEvent()},combineParams:function(t){var e=t.params,i=e&&e.itemTips;this.options={size:{w:null,h:null},scanStep:Math.PI/720,initAngle:0,params:{sightAngle:e.sightAngle||45,pieHeight:e.pieHeight||30,radius:e.radius||120,layout:e.layout||"topAndBottom",ringCenter:e.ringCenter||{xCenter:150,yCenter:150},itemTips:{
topOrient:i&&i.topOrient||"vertical",tipRowNum:i&&i.tipRowNum||2,tipFormatter:i&&i.tipFormatter||function(t){return t.title+": "+t.percent},tipStart:i&&i.tipStart||{xStart:275,yStart:360},tipSpace:i&&i.tipSpace||{xSpace:120,ySpace:30},tipStyle:i&&i.tipStyle||{font:14,color:"#9a9a9a"}},dataParam:e.dataParam},onPieClick:t.onPieClick}},createDom:function(){var t=this.com.width(),e=this.com.height(),i=this.options.size={w:t,h:e};this.com.html("<canvas width = "+i.w+" height = "+i.h+"></canvas>"),this.canvas=this.com.find("canvas"),this.pen=this.canvas[0].getContext("2d")},trimData:function(){this.$_adjustRingCoordinate(),this.$_assembleRingData(this.options.params.dataParam.data)},drawWhat:function(t){try{this.draw_3DPie(t)}catch(e){alert(e.message)}},bindEvent:function(){var o=this;o.canvas.on("mousedown",function(t){var e,i,n=(e=t,i=o.canvas.offset(),{x:e.clientX-i.left,y:e.clientY-i.top});n._eName="mousedown",o._clearAll(),o.drawWhat(n),o._clearAll(),o.drawWhat()})},
draw_3DPie:function(t,e){var i=this.options.params,n=i.radius;i.dataParam.summary&&this._drawBottomShadow(),this._drawCombinePiece(i.dataParam.data,n,t),this._drawTipsNSquare(t),i.showTitle&&this._drawSpaceFont(this.options.params.mainTitle,!0)},_drawBottomShadow:function(){var t=this.options.params,e=t.pieHeight,i=t.radius,n=t.ringCenter,o=t.sightAngle,a=this.$_round2Ellipse(i,t.sightAngle),s=Math.cos(o/180*Math.PI)*e,r={angle:2*Math.PI,color:"#6797d5",startAngle:0,radius:i,cx:n.xCenter,cy:n.yCenter+2*s};if(this.__drawPiece(r),t.dataParam.summary.sumData){var c={sx:n.xCenter,sy:n.yCenter+a+1.5*s},l=t.dataParam.summary.sumData.title;this.__drawFonts(c,l,{color:"white",font:"14px 黑体",textBaseline:"middle",textAlign:"center"})}},_drawCombinePiece:function(o,a,s){var r=this,c=r.pen,t=r.options.params,l=r.$_round2Ellipse(a,t.sightAngle),e=t.pieHeight,i=t.sightAngle,n=Math.cos(i/180*Math.PI)*e,d=r.options.onPieClick,u=t.ringCenter,h=-1,p=!1;$.each(o,function(t,e){e.current&&(h=t,p=!0),
r.__drawInnerSide(e,n)}),$.each(o,function(t,e){r.__drawOutSide(e,n)});for(var f=[],m=0,g=o.length;m<g;m++){var v=m+h+1;g<=v&&(v=Math.abs(v-g)),f.push(v)}$.each(f,function(t,e){var i=o[e];if(i.current,r.__drawPiece(i,!0),s){if("mousedown"==s._eName)if(c.isPointInPath(s.x,s.y)){if(i.current)i.cy=u.yCenter,i.cx=u.xCenter;else if(!p){var n=i.startAngle+.5*i.angle;i.cy+=.35*l*Math.sin(n),i.cx+=.35*a*Math.cos(n)}!i.current&&p||(i.current=!i.current),i.current&&$.isFunction(d)&&d.call(this,i)}else i.cy=u.yCenter,i.cx=u.xCenter,i.current=!1;"mousemove"==s._eName&&c.isPointInPath(s.x,s.y)}})},_drawTipsNSquare:function(m){var _=this,g=this.pen,v=this.options.params,t=v.itemTips,e=t.topOrient,i=v.dataParam.data,b=t.tipStart,y=t.tipSpace;switch(e){case"vertical":!function(t,e,i){for(var n=t.tipFormatter,o=v.dataParam.summary&&v.dataParam.summary.sumFormatter||n,a=t.tipStyle.font,s=t.tipStyle.color,r=!1,c=0,l=e.length,d=b.xStart,u=b.yStart,h=y.xSpace,p=y.ySpace;c<l;c++){try{
v.dataParam.summary.sumData&&!r&&(_.__drawSquare({sx:d,sy:u-p-.85*a},{color:"#6797d5"},{w:a,h:a}),_.__drawFonts({sx:d+1.5*a,sy:u-p},o.call(this,v.dataParam.summary.sumData),{font:a+"px 黑体",color:s}),r=!0)}catch(f){console.log("no summary")}_.__drawSquare({sx:d,sy:u-.9*a},{color:"transparent"},{w:a+h,h:a}),i&&g.isPointInPath(i.x,i.y)&&_.options.onPieClick instanceof Function&&_.options.onPieClick.call(this,e[c]),_.__drawSquare({sx:d,sy:u-.85*a},e[c],{w:a,h:a}),_.__drawFonts({sx:d+1.5*a,sy:u},n.call(this,e[c]),{font:a+"px 黑体",color:s}),u+=p}}(t,i,m),n(t,i);break;case"horizontal":!function(t,e){for(var i=t.tipFormatter,n=t.tipStyle.font,o=t.tipStyle.color,a=t.tipRowNum,s=0,r=e.length,c=Number(a||2),l=y.xSpace,d=y.ySpace,u=b.xStart,h=b.yStart;s<r;s++){var p=u+s%c*l,f=h+parseInt(s/c)*d;_.__drawSquare({sx:p,sy:f-.9*n},{color:"transparent"},{w:n+l,h:n}),m&&g.isPointInPath(m.x,m.y)&&_.options.onPieClick instanceof Function&&_.options.onPieClick.call(this,e[s]),_.__drawSquare({sx:p,sy:f-.85*n
},e[s],{w:n,h:n}),_.__drawFonts({sx:p+1.5*n,sy:f},i.call(this,e[s]),{font:n+"px 黑体",color:o})}}(t,i),n(t,i)}function n(t,e){for(var i=t.tipFormatter,n=t.tipStyle.font,o=(_.options.params.ringCenter,_.options.initAngle),a=_.options.params.radius,s=.5*Number(a),r=(_.$_round2Ellipse(s,_.options.params.sightAngle),_.$_round2Ellipse(a,_.options.params.sightAngle)),c=0,l=o;c<e.length;c++){var d=l+.5*e[c].angle,u=m(1.2,e[c]),h=m(1,e[c]),p=v(u,d),f=g(d);_.__drawLine(h,u,{color:"darkblue"}),_.__drawLine(u,p,{color:"darkblue"}),_.__drawFonts(p,i.call(this,e[c]),{font:n+"px  黑体",textAlign:f.textAlign,textBaseline:f.textBaseline,color:e[c].color}),l+=e[c].angle}function m(t,e){var i=t,n=e.startAngle+.5*e.angle;return{sx:e.cx+i*a*Math.cos(n),sy:e.cy+i*r*Math.sin(n)}}function g(t){var e={textAlign:null,textBaseline:"middle"};return t>.5*Math.PI&&t<=1.5*Math.PI?e.textAlign="right":e.textAlign="left",e}function v(t,e){var i={sy:t.sy,sx:null}
;return e>.5*Math.PI&&e<=1.5*Math.PI?i.sx=t.sx-20:i.sx=t.sx+20,i}}},_drawSpaceFont:function(t,e){t.isRingTitle;var i=this.options.size,n=t.titleStart,o=t.titleStyle,a={font:"normal "+o.font+"px 黑体",color:o.color,align:"center",baseline:"middle"};e&&(n.sx=i.w/2),this.__drawFonts({sx:n.sx,sy:n.sy},t.title,a),t.subTile&&(a.color="black",a.font="normal "+(o.font+7)+"px 黑体",this.__drawFonts({sx:n.sx,sy:n.sy+1.4*o.font},t.subTile,a))},_drawRectTip:function(t,e){},__drawInnerSide:function(i,n){var o=this.pen,t=i.startAngle,e=this.options.params.sightAngle,a=i.radius,s=this.$_round2Ellipse(a,e),r=function(t,e){o.lineTo(i.cx+a*Math.cos(t),i.cy+s*Math.sin(t)+e||0)},c=[t,t+i.angle];$.each(c,function(t,e){o.save(),o.beginPath(),o.fillStyle="#DFD7DA",o.globalAlpha=.9,o.moveTo(i.cx,i.cy),r(e,0),r(e,n),o.lineTo(i.cx,i.cy+n),o.lineTo(i.cx,i.cy),o.closePath(),o.fill(),o.restore()})},__drawOutSide:function(i,t){
var n=this.pen,e=i.startAngle,o=e+i.angle,a=this.options.params.sightAngle||90,s=this.options.scanStep,r=i.radius,c=this.$_round2Ellipse(r,a||90),l=function(t,e){n.lineTo(i.cx+r*Math.cos(t),i.cy+c*Math.sin(t)+e||0)},d="default";if(e>.5*Math.PI&&e<Math.PI&&o>Math.PI&&(o=Math.PI),0<=e&&e<.5*Math.PI&&o>Math.PI&&(o=Math.PI,d="source-over"),e>=Math.PI&&o<=2.05*Math.PI&&(d="destination-over"),t){var u=0,h=0;for(n.save(),n.beginPath(),n.fillStyle=i.color,n.globalAlpha=.8,n.strokeStyle="white",n.lineWidth=.4,n.globalCompositeOperation=d,l(e,0),l(e,t);u<o-e;)l(u+e,t),u+=s;for(l(o,t),l(o,0);e<h;)l(h+e,0),h-=s;l(e,0),n.closePath(),n.fill(),n.stroke(),n.restore()}},__drawPiece:function(t,e){var i,n,o,a,s=t.startAngle,r=t.startAngle,c=this.pen,l=this.options.scanStep,d=t.radius,u=this.$_round2Ellipse(d,this.options.params.sightAngle||90);for(c.save(),c.beginPath(),c.fillStyle=t.color,c.strokeStyle="white",c.lineWidth=.4,c.lineTo(t.cx,t.cy);s<r+t.angle;)i=s,n=0,o=d,a=u,
c.lineTo(t.cx+o*Math.cos(i),t.cy+a*Math.sin(i)+n||0),s+=l;c.lineTo(t.cx,t.cy),c.closePath(),c.fill(),e&&c.stroke(),c.restore()},__drawSquare:function(t,e,i){var n=this.pen;n.save(),n.beginPath(),n.fillStyle=e.color,n.rect(t.sx,t.sy,i.w,i.h),n.fill(),n.closePath(),n.restore()},__drawFonts:function(t,e,i){var n,o=this.pen;return o.save(),o.beginPath(),o.fillStyle=i&&i.color||"#000000",o.font=i&&i.font||"17px 黑体 ",i.textAlign&&(o.textAlign=i.textAlign),i.textBaseline&&(o.textBaseline=i.textBaseline),n=o.measureText(e),o.fillText(e,t.sx,t.sy),o.closePath(),o.restore(),n},__drawLine:function(t,e,i){var n=this.pen;n.save(),n.beginPath(),n.lineWidth=i.lineWidth||.5,n.strokeStyle=i.color||"black",n.moveTo(t.sx,t.sy),n.lineTo(e.sx,e.sy),n.stroke(),n.closePath(),n.restore()},_clearAll:function(){this.__clearArea({sx:0,sy:0},this.options.size)},__clearArea:function(t,e){this.pen;this.canvas[0].width=e.w},$_highlightColor:function(t){},$_round2Ellipse:function(t,e){return Math.sin(e/180*Math.PI)*t
},$_adjustRingCoordinate:function(){var n=this.options.params,o=this.options.size,t=n.layout,e=n.itemTips,a=n.radius,s=e.tipSpace.xSpace,r=e.tipRowNum,i=e.topOrient,c=e.tipStart;switch(function(){{if("vertical"==i)return r=1;if(r==undefined)r=2}}(),t){case"topAndBottom":l(!0);break;case"leftAndRight":l(!1)}function l(t){var e=.25*a,i=s*r;t?(n.ringCenter.xCenter=o.w/2,c.xStart=(o.w-i)/2):(n.ringCenter.xCenter=(o.w-(2*a+e+i))/2+a,c.xStart=n.ringCenter.xCenter+a+e)}},$_assembleRingData:function(n){var o=this,a=n.length,t=o.options.params,i=t.dataParam.dataKey,s=t.radius,r=t.ringCenter,c=0,l=0,d=0,u=0;$.isPlainObject(n)&&(n=[].concat(n)),$.each(n,function(t,e){e.title=e[i.title],e.value=parseFloat(e[i.value]),e.cx=r.xCenter,e.cy=r.yCenter,0<t&&e.value>n[t-1].value&&(u=t),l+=e.value}),$.each(n,function(t,e){var i;e.percent=(i=e.value,(100*parseFloat(i/l)).toFixed(1)+"%"),d+=Number((e.value/l*100).toFixed(1)),t===a-1&&(n[u].percent=(100-d+parseFloat(n[u].percent)).toFixed(1)+"%"),
e.angle=e.value/l*(2*Math.PI),e.startAngle=c,e.color=o.colorStore[t],e.radius=s,c+=e.angle}),t.totalQty=l},validateRingData:function(t){return t instanceof Array&&0<t.length||$.isPlainObject(t)},refreshPaint:function(t){this.validateRingData(t)?(this.options.params.dataParam.data=t,this.trimData(),this._clearAll(),this.drawWhat()):console.error("传入data不符合要求：非空数组，成员大于0个")}}),PJF.apply(PJF.ui.threeDPie.prototype,{getClassName:function(){return"PJF.ui.threeDPie"},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null}}),PJF.ui.tipSet=PJF.extend(PJF.ui.component,{init:function(t){this.options={},this.combineParams(t),this.createDom(),this.adjustCss(),this.bindEvent()},defaultConfig:{width:960,height:84,tipBtnWidth:null,tipData:[],tipBtnSet:[],tipTemplate:"<p>{{name:}}<br/>{{value:}}</p>"},combineParams:function(t){this.options=$.extend({},this.defaultConfig,t)},createDom:function(){
var t=$('<div class="tipSet-frame" ><div class="tipSet-container"></div><div class="btnSet-container"><ul class="btnSet-set" onselect="return false"></ul></div></div>');this.com.append(t),this.tsFrame=this.com.find(".tipSet-frame"),this.tsContainer=this.com.find(".tipSet-container"),this.btContainer=this.com.find(".btnSet-container"),this.btSetContainer=this.com.find(".btnSet-set"),this._rendTipContainer(),this._rendBtnContainer()},adjustCss:function(){var t=this.options;this.tsFrame.css({width:t.width,minHeight:t.height}),t.tipBtnWidth&&this.btContainer.css({width:t.tipBtnWidth})},bindEvent:function(){var a=this,n=this.options,t=this.tsContainer;t.on("click",".tipSet-tip",function(t){n.selectable&&$(this).toggleClass("tipSet-selected")}),t.on("click",".tipSet-close",function(t){var e=$(this).closest(".tipSet-tip").index(),i=n.tipData[e];a._reduceTip(e),n.onRemove(i)});var s=this.btSetContainer.find("li>a"),r=this.options.tipBtnSet;$.each(s,function(t,e){
var i=s[t].id,n=r[t].title,o=r[t].onClick;new PJF.ui.linkButton({dom:i,name:n,onclick:function(t){o.call(null,a.getAllTips())},style:"assistant"})})},_rendTipContainer:function(){var i=this,t=this.options.tipData,n=[];$.each(t,function(t,e){n.push(i._increaseTip(e))}),this.tsContainer.append(n.join(""))},_rendBtnContainer:function(){var i=this,t=this.options.tipBtnSet,n=[];$.each(t,function(t,e){n.push("<li><a id='"+i.com[0].id+(new Date).getTime()+t+"'></a></li>")}),this.btSetContainer.append(n.join(""))},_increaseTip:function(t){var e=['<div class="tipSet-tip"><span class="tipSet-close"></span><div class="tipSet-custom-style">'];return e.push(this._decodeTemplate(t)),e.push("</div></div>"),e.join("")},_clearTipContainer:function(){this.tsContainer.html("")},_decodeTemplate:function(t){var e=this.options.tipTemplate;for(var i in t){var n=new RegExp("{{"+i+":}}","gi");e=e.replace(n,t[i])}return e},addTip:function(t){var i=this,e=this.options.tipData
;$.isPlainObject(t)&&(t=[].concat(t)),this.options.tipData=e.concat(t);var n=[];$.each(t,function(t,e){n.push(i._increaseTip(e))}),this.tsContainer.append(n.join(""))},removeTip:function(t){var a=this.options.tipData,s=this;$.isPlainObject(t)&&(t=[].concat(t)),$.each(t,function(t,e){for(var i=0,n=a.length;i<n;i++){var o=a[i];if(e.name==o.name){s._reduceTip(i);break}}})},_reduceTip:function(t){var e=this.tsContainer.find(".tipSet-tip");this.options.tipData.splice(t,1),e.eq(t).remove()},clearTips:function(){this.options.tipData=[],this._clearTipContainer()},_getSelectedTip:function(){var i=[],t=this.options.tipData,n=this.tsContainer.find(".tipSet-tip");return $.each(t,function(t,e){n.eq(t).hasClass("tipSet-selected")&&i.push(e)}),i},getAllTips:function(){return this.options.tipData}}),PJF.apply(PJF.ui.tipSet.prototype,{getClassName:function(){return"PJF.ui.tipSet"},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null},newDestroy:function(){
this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null}}),function(){var t=function(){
/*@preserve
      <div class='pjf-simplecalendar-container'>
        <div class='pjf-simplecalendar-title'>
          <div class='pjf-simplecalendar-arrow pjf-simplecalendar-prearrow'>
            <i/>
          </div>
          <div>{{:currentYearMonth}}</div>
          <div class='pjf-simplecalendar-arrow pjf-simplecalendar-nextarrow'>
            <i/>
          </div>
        </div>
        <div class='pjf-simplecalendar-content'>
           {{for weekNames}}  {{!-- 星期一到星期日 --}}
             <span class = 'pjf-simplecalendar-span pjf-simplecalendar-day'>{{:#data}}</span>
           {{/for}}
           {{for preMonthDays ~today = today}} {{!-- 上个月可能的日期，补足日历 --}}
             <span class = 'pjf-simplecalendar-span pjf-simplecalendar-predate'><span tabindex="-1" dateStr = "{{:d}}" class='{{if ~today == d}}today{{/if}}'>{{convert:d date}}</span></span>
           {{/for}}
           {{for currentMonthDays ~today = today}} {{!-- 这个月的日期 --}}
             <span class = 'pjf-simplecalendar-span pjf-simplecalendar-date'><span tabindex="-1" dateStr = "{{:d}}" class='{{if ~today == d}}today{{/if}}'>{{convert:d date}}</span></span>
           {{/for}}
           {{for nextMonthDays ~today = today}} {{!-- 下个月的日期，补足日历 --}}
             <span class = 'pjf-simplecalendar-span pjf-simplecalendar-nextdate'><span tabindex="-1" dateStr = "{{:d}}" class='{{if ~today == d}}today{{/if}}'>{{convert:d date}}</span></span>
           {{/for}}
        </div>
      </div>
    */}.toString().match(/^[\s\S]*\/\*@preserve([\s\S]*)\*\//)[1],s=["日","一","二","三","四","五","六"],e=_defaultToday=PJF.communication.getServerTime()||PJF.util.formatDate(new Date),r=function(t){if(isNaN(t))throw"PJF.ui.simpleCalendar._transFormToDate: "+t+" is not a number";var e=(t+="").substr(0,4),i=t.substr(4,2),n=t.substr(6,2)||1,o=new Date(e,parseInt(i,10)-1,n);if(isNaN(o.getTime()))throw"PJF.ui.simpleCalendar._transFormToDate: "+t+" is not a correct date string";return o};PJF.ui.simpleCalendar=PJF.extend(PJF.ui.component,{init:function(){this.params.currentPageDay=this.params.currentPageDay||this.params.today,this.params=$.extend({today:_defaultToday,currentPageDay:e},this.params),this.template=$.templates({markup:t,allowCode:!0});var i=this;$.views.converters("convert",function(t,e){return i.params.formatter&&i.params.formatter.apply(i,arguments)||e},this.template),this.renderCalendar(),this.initEvent()},initEvent:function(){var a=this
;this.com.on("click",".pjf-simplecalendar-arrow",function(){var t=r(a.params.currentPageDay);$(this).hasClass("pjf-simplecalendar-prearrow")?t.setMonth(t.getMonth()-1):$(this).hasClass("pjf-simplecalendar-nextarrow")?t.setMonth(t.getMonth()+1):console.log("肿么可能");var e,i=PJF.util.formatDate(t).substr(0,6),n=!1;function o(){a.params.currentPageDay=PJF.util.formatDate(t),a.renderCalendar()}a.params.onClickArrow&&(2==a.params.onClickArrow.length?(n=!0,a.params.onClickArrow(i,o)):e=a.params.onClickArrow(i)),n||!1===e||o()});this.com.on("click",".pjf-simplecalendar-span>span[datestr]",function(t){var e=$(this).attr("dateStr"),i=$.data(this);i.isClick?(i.isClick=null,a.params.onDblClick&&a.params.onDblClick(e)):(i.isClick=!0,setTimeout(function(){i.isClick&&a.params.onClick&&a.params.onClick(e),i.isClick=null},200))})},renderCalendar:function(t){this.params.currentPageDay=t||this.params.currentPageDay;var e=r(this.params.currentPageDay),i=function(t){
if("[object Date]"!==Object.prototype.toString.call(t)||isNaN(t.getTime()))throw"PJF.ui.simpleCalendar._getMonthInfo: "+t+" is not a correct date object";var e={},i=new Date(t),n=i.getMonth();if(i.setMonth(n+1),i.setDate(0),e.dayCounts=i.getDate(),e.lastDay=i.getDay(),e.nextMonthDays=[],6!==e.lastDay)for(i.setDate(i.getDate()+1);0!==i.getDay();)e.nextMonthDays.push({d:PJF.util.formatDate(i),date:i.getDate(),day:i.getDay()}),i.setDate(i.getDate()+1);var o=new Date(t);o.setDate(0),o.setDate(o.getDate()+1),e.firstDay=o.getDay();var a=new Date(o);e.currentMonthDays=[];for(var s=0;s<e.dayCounts;s++)e.currentMonthDays.push({d:PJF.util.formatDate(o),date:o.getDate(),day:o.getDay()}),o.setDate(o.getDate()+1);if(e.preMonthDays=[],0!==e.firstDay)for(a.setDate(a.getDate()-1);6!==a.getDay();)e.preMonthDays.unshift({d:PJF.util.formatDate(a),date:a.getDate(),day:a.getDay()}),a.setDate(a.getDate()-1);return e}(e),n=this.template.render($.extend(i,{weekNames:s,
currentYearMonth:PJF.util.formatDate(e,"yyyy年MM月"),today:this.params.today}));this.com.html(n.replace(/>\s+</g,"><"));var o=this.com.find(".pjf-simplecalendar-span"),a=Math.ceil(o.length/7);o.css("height",1/a*100+"%")},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.off(),this.com.remove()}})}(),PJF.ui.device=PJF.extend(PJF.ui.component,{onSuccessful:null,onFailure:null,renderTo:null,maxWaitTime:null,baseInit:function(i){var n=this;this.successful=i.successful,this.afterSuccessful=i.afterSuccessful,this.failure=i.failure,this.renderTo=i.renderTo,this.afterSuccess=i.afterSuccess,this.maxWaitTime=i.maxWaitTime||3e4;var t=i.textid,e=i.textName,o=i.btid,a=i.textWidth||188,s=i.textBt,r=i.textLength,c="undefined"==typeof i.isRepeat||i.isRepeat,l=i.textRequired;null==l&&(l=!1);var d="text";i.inputType&&"text"!=i.inputType&&(d=i.inputType);var u,h,p=i.labelText;if(null!=p&&!i.hideLabel){var f=i.labelId;$("<label id="+f+">"+p+"</label>").appendTo(this.com);new PJF.ui.label({
dom:f})}$("<input/>",{type:d,width:a,id:t,maxLength:r,name:e}).appendTo(this.com),$("<a id="+o+' style="float:left"></a>').appendTo(this.com),this.params.keyScope&&this.params.keyIndex&&(u=this.params.keyScope,h=this.params.keyIndex+.1),this._inputText=new PJF.ui.textfield({dom:t,id:t+"ComponetId",width:a,keyScope:u,keyIndex:this.params.keyIndex,datatype:i.datatype,onChange:i.textOnChange,onFocus:i.textOnFocus,customDataType:i.customDataType,onBlur:i.textOnBlur,required:l,skipValidate:!1,validType:i.validType,invalidMessage:i.invalidMessage,disabled:i.disabled,readOnly:i.readOnly}),i.hideText&&this._inputText.com.hide(),n._Bt=new PJF.ui.linkButton({dom:o,name:s,keyScope:u,keyIndex:h,style:"assistant",onclick:function(t){n._Bt.setPlain(!0),n._Bt.isDisabled()?console.log("disable return "):(c||n._Bt.disable(),i.notification&&i.updateNotification(n,!0),setTimeout(function(){try{if(i.onBeforeDeviceHandler){var t=i.onBeforeDeviceHandler();if(!1===t)return void n._Bt.enable()}
i.deviceHandler(t)}catch(e){alert(e.message),n._Bt.enable(),i.updateNotification&&i.updateNotification(n,!1)}},0))},reValiDateDom:t+"ComponetId"}),this.params.keyScope=null,this.params.keyIndex=null,this.helpTip=null,i.helpTip&&this.setHelpTip(i.helpMessage)},setHelpTip:function(t,e){if(!1===e)this.helpTip&&this.helpTip.destroy(),this.helpTip=null;else if(this.helpTip)this.helpTip.setHelpMsg(t);else{var i="btn_tip_"+PJF.util.generateUUid();this._Bt.com.after('<span id="'+i+'"></span>'),this.helpTip=new PJF.ui.helpTip({dom:i,helpMessage:t||""})}},onSuccessful:function(t,e,i){var n=!0;t.shift(),this.afterSuccess&&this._Bt.enable(),null!=this.successful&&(n=this.successful(t)),null!=n&&1!=n||($("#"+e)[0].value=i),this.afterSuccess||this._Bt.enable(),this.afterSuccessful&&this.afterSuccessful(t),this._inputText.onBlur()},onFailure:function(t,e){var i=!0;null!=this.failure&&(t.shift(),i=this.failure(t)),null!=i&&1!=i||new PJF.ui.messageBox({style:"warning",
title:resource.DEVICE_BASE_EXCUTE_RESULT,content:e}),this._Bt.enable()},showInputText:function(t,e){$("#"+t)[0].value=e},getClassName:function(){return"PJF.ui.device"},showBtn:function(){this._Bt.setVisible(!0)},hideBtn:function(){this._Bt.setVisible(!1)},disableBtn:function(){this._Bt.disable()},enableBtn:function(){this._Bt.enable()},setLableText:function(t){$("label.pjf_label",this.com).html(t)},triggerBtn:function(){this._Bt.triggerBtnHandler()}}),PJF.apply(PJF.ui.device.prototype,{setKey:function(t){t.keyIndex&&t.keyScope?(this._inputText.params.keyIndex=t.keyIndex,this._inputText.params.keyScope=t.keyScope,this._Bt.params.keyIndex=t.keyIndex+.1,this._Bt.params.keyScope=t.keyScope,PJF.ui.componentMgr.reg(this._inputText),PJF.ui.componentMgr.reg(this._Bt)):alert("请同时传入keyScope和keyIndex!")},setRequired:function(t){this._inputText.setRequired(t)},setAvailable:function(t){t?$("#"+this._textid).attr("readonly",!0):$("#"+this._textid).attr("readonly",!1)},clear:function(){
$("#"+this._textid)[0].value="",$("#"+this._textid).filter(".invalid_box").addClass("validatebox-invalid")},disable:function(){$("#"+this._textid).attr("disabled",!0),$("#"+this._textid).addClass("pjf_disabled_input"),this._Bt.disable(),this._inputText.disableflag=!0},enable:function(){$("#"+this._textid).attr("disabled",!1),$("#"+this._textid).removeClass("pjf_disabled_input"),this._Bt.enable(),this._inputText.disableflag=!1},disableText:function(){this._inputText.disable()},enableText:function(){this._inputText.enable()},destroy:function(t){for(var e=$("#"+t),i=0;i<e.length;i++)e[i].className="",e[i].innerHTML=""},newDestroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.id=null,this.com=null},validateParam:function(t){return t.dom?(this.dom=t.dom,
!0):(alert("提示：dom属性不能为空！"),!1)}}),PJF.ui.cardReader=PJF.extend(PJF.ui.device,{_textid:null,_cardInfo:null,init:function(t){var e=this;t.textWidth=t.textWidth||"",t.textBt=t.textBt||resource.DEVICE_CARDREADER_TEXTBT,t.datatype="card",t.textid=t.textid||this.generateId(),t.labelText||(t.labelText=resource.DEVICE_CARDREADER_LABELTEXT),t.labelId=this.generateId(),e._textid=t.textid,t.btid=this.generateId(),t.deviceHandler=function(){e._cardInfo=PJF.communication.client.getCardInfo(),0==e._cardInfo[0]?e.onSuccessful(e._cardInfo,t.textid,e._cardInfo[1]):e.onFailure(e._cardInfo,resource.DEVICE_CARDREADER_ONFAILURE_INFO)},e.baseInit(t)},getClassName:function(){return"PJF.ui.cardReader"},focus:function(){this._inputText.focus()}}),PJF.apply(PJF.ui.cardReader.prototype,{getCardNo:function(){return this._inputText.getValue()},getSecondDisk:function(){return this._cardInfo?this._cardInfo[1]:null}}),PJF.ui.fingerReader=PJF.extend(PJF.ui.device,{_textid:null,_fingerReader:null,init:function(t){
var e=this;t.textWidth=t.textWidth||"",t.textBt=t.textBt||resource.DEVICE_FINGERREADER_TEXTBT;t.deviceName;t.textid=this.generateId(),t.labelText=t.labelText||resource.DEVICE_FINGERREADER_LABELTEXT,t.labelId=this.generateId(),this._textid=t.textid,t.btid=this.generateId(),t.deviceHandler=function(){setTimeout(function(){e._fingerReader=PJF.communication.client.getFingerInfo(),0==e._fingerReader[0]?(t.updateNotification(e,!1," "),e.onSuccessful(e._fingerReader,t.textid,resource.DEVICE_FINGERREADER_SUCCESS_INFO)):(t.updateNotification(e,!1,""),e.onFailure(e._fingerReader,resource.DEVICE_FINGERREADER_ONFAILURE_INFO))},0)},t.notification="请按下您的手指",t.updateNotification=function(t,e,i){e?(t._inputText.setValue(this.notification),t._inputText.com.addClass("device-warnbox-tipcolor device-warn-border")):(t._inputText.setValue(i),t._inputText.com.removeClass("device-warnbox-tipcolor device-warn-border"))},e.baseInit(t)},getClassName:function(){return"PJF.ui.fingerReader"}}),
PJF.apply(PJF.ui.fingerReader.prototype,{getAgentCode:function(){return this._fingerReader[0]},getFingerCode:function(){return this._fingerReader[1]}}),PJF.ui.grant=PJF.extend(PJF.ui.component,{_textid:null,grant:null,init:function(t){t.textBt=t.textBt||resource.DEVICE_GRANT_TEXTBT;t.deviceName;this._textid=this.generateId(),t.labelText=t.labelText||resource.DEVICE_GRANT_LABELTEXT,t.labelId=this.generateId(),t.btid=this.generateId(),$("<input/>",{type:"text",id:this._textid}).appendTo(this.com);new PJF.ui.textfield({dom:this._textid,required:!0,inputType:"help"});t.deviceHandler=function(){alert("触发函数！")}},getClassName:function(){return"PJF.ui.grant"}}),PJF.apply(PJF.ui.fingerReader.prototype,{clear:function(){$("#"+this._textid)[0].value=""}}),PJF.ui.icCardReader=PJF.extend(PJF.ui.device,{_textid:null,_icCardInfo:null,init:function(conf){var _super=this;conf.textWidth=conf.textWidth||"",conf.textBt=conf.textBt||resource.DEVICE_ICCARDREADER_TEXTBT;var deviceNameEx=conf.deviceName
;conf.textid=conf.textid||this.generateId(),conf.labelText=conf.labelText||resource.DEVICE_ICCARDREADER_LABELTEXT,conf.labelId=this.generateId(),conf.datatype="card",this._textid=conf.textid,conf.btid=this.generateId(),conf.deviceHandler=function(){_super._icCardInfo=PJF.communication.client.getIcCardInfo(conf.appType),0==_super._icCardInfo[0]?_super.onSuccessful(_super._icCardInfo,conf.textid,eval("("+_super._icCardInfo[1]+")").accountNo):_super.onFailure(_super._icCardInfo,resource.DEVICE_ICCARDREADER_ONFAILURE_INFO)},_super.baseInit(conf)},getClassName:function(){return"PJF.ui.icCardReader"},focus:function(){this._inputText.focus()}}),PJF.apply(PJF.ui.icCardReader.prototype,{getICCardNo:function(){return this._inputText.getValue()},getICCardIndex:function(){return this._icCardInfo[1]},getICCardSeqNo:function(){if(this._icCardInfo){var accountInfo=eval("("+this._icCardInfo[0]+")");return accountInfo.ICcardNo}return null},getICCardType:function(){var t=this.getICCardInfo()
;return t?t.ICCardType:null},getICCardInfo:function(){if(this._icCardInfo){var info=eval("("+this._icCardInfo[0]+")");return info}return null}}),PJF.ui.identityCard=PJF.extend(PJF.ui.device,{_identityCard:null,_textid:null,init:function(t){var e=this;t.textWidth=t.textWidth||"",t.textBt=t.textBt||resource.DEVICE_IDENTITYCARD_TEXTBT;t.deviceName;t.textid=t.textid||this.generateId(),t.labelText=t.labelText||resource.DEVICE_IDENTITYCARD_LABELTEXT,t.labelId=this.generateId(),e._textid=t.textid,t.btid=this.generateId(),t.deviceHandler=function(){e._identityCard=PJF.communication.client.getIdentityCardInfo(),0==e._identityCard[0]?e.onSuccessful(e._identityCard,t.textid,e._identityCard[6]):e.onFailure(e._identityCard,resource.DEVICE_IDENTITYCARD_ONFAILURE_INFO)},e.baseInit(t)},getClassName:function(){return"PJF.ui.identityCard"},focus:function(){this._inputText.focus()}}),PJF.apply(PJF.ui.identityCard.prototype,{getIdcardName:function(){return this._identityCard[0]},getIdcardSex:function(){
return this._identityCard[1]},getIdcardNation:function(){return this._identityCard[2]},getIdcardBirthDate:function(){return this._identityCard[3]},getIdcardAddress:function(){return this._identityCard[4]},setValue:function(t,e){e?this._inputText.setValue(t):$("#"+this._textid)[0].value=t},getIdcardNum:function(){return this.params.customDataType?this._inputText.getValue():$("#"+this._textid)[0].value},getIdcardIssueGovernment:function(){return this._identityCard[6]},getIdcardAvailableDate:function(){return this._identityCard[7]}}),PJF.ui.fingerMark=PJF.extend(PJF.ui.component,{onSuccessful:null,onFailure:null,maxWaitTime:null,testfingerinfo:null,init:function(t){this.onSuccessful=t.onSuccessful,this.onFailure=t.onFailure,this.maxWaitTime=t.maxWaitTime||3e4;t.deviceName;this.fingerType=t.fingerType||[resource.DEVICE_FINGERMARK_L1,resource.DEVICE_FINGERMARK_L2],this.fingerStatus=t.fingerStatus||[resource.DEVICE_FINGERMARK_STATUS_1,resource.DEVICE_FINGERMARK_STATUS_2],this.createBase()},
createBase:function(t){this.baseDiv=$('<div class="pjf_fingerprin_base_div"></div>'),this.baseDiv.appendTo(this.com),this.addOneRow(),this.addOneRow();var e=this,i=$('<div class="pjf_fingerprin_add_del_btn_div"></div>');$('<a id="addFingermark" href="#"></a>').appendTo(i),$('<a id="delFingermark" href="#"></a>').appendTo(i),i.appendTo(this.com);new PJF.ui.linkButton({dom:"addFingermark",name:resource.DEVICE_FINGERMARK_BTN_ADD,style:"assistant",onclick:function(t){e.addOneRow()}}),new PJF.ui.linkButton({dom:"delFingermark",name:resource.DEVICE_FINGERMARK_BTN_DEL,style:"assistant",onclick:function(t){e.delOneRow()}})},destroy:function(){this.com.remove(),PJF.ui.componentMgr.remove(this.id)},newDestroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,
this.id=null},getClassName:function(){return"PJF.ui.fingerMark"}}),PJF.apply(PJF.ui.fingerMark.prototype,{addOneRow:function(){var i='<div class="pjf_fingerprin"><span class="left"  ><input type="checkbox" style="padding-right: 5px;"/><label>'+resource.DEVICE_FINGERMARK_FINGER_INDEX+"<select>";$(this.fingerType).each(function(t,e){i+='<option value="'+t+'">'+e+"</option>"}),i+='</select></label><label style="margin-right:5px;">'+resource.DEVICE_FINGERMARK_FINGER_STATUS+'<select disabled="disabled">',$(this.fingerStatus).each(function(t,e){i+='<option value="'+t+'">'+e+"</option>"});var t=this.generateId();i+='</select></label></span><span id="'+t+'"></span></div>';var e=this;$(i).appendTo(this.baseDiv);var n=new PJF.ui.linkButton({dom:t,name:resource.DEVICE_FINGERMARK_FINGER_BTN_GATHER,style:"assistant",onclick:function(t){e.doFingermark(n)}})},delOneRow:function(){this.baseDiv;this.baseDiv.find(":checkbox").each(function(t,e){e.checked&&$($(e)[0].parentNode.parentNode).remove()})},
doFingermark:function(t){if(!t.isDisabled()){t.disable();var e=$(t.com).parents("div:first"),i=e.find("select:first"),n=e.find("select:last"),o={firstSelect:i,fingerIndex:i.val(),fingerDesc:i.find("option:selected").text(),secondSelect:n,printSelf:function(){}};this.updateFingerStatus(o,0);try{var a=PJF.communication.client.writeFingerInfo();a&&"0"==a[0]?(this.updateFingerStatus(o,1),this.onSuccessful?this.onSuccessful(a,o.fingerIndex,o.fingerDesc):alert("采集成功")):(this.updateFingerStatus(o,0),this.onFailure?this.onFailure(a,o.fingerIndex,o.fingerDesc):alert("采集失败"))}catch(s){alert(s.message),this.updateFingerStatus(o,0)}t.enable()}},updateFingerStatus:function(t,e){t.secondSelect.find("option").eq(e).attr("selected",!0)},validateParam:function(t){return t.dom?(this.dom=t.dom,!0):(alert("提示：fingermark组件的dom不能不为空!"),!1)}}),PJF.ui.identitycard1=PJF.extend(PJF.ui.component,{onSuccessful:null,onFailure:null,renderTo:null,maxWaitTime:null,init:function(t){this.onSuccessful=t.onSuccessful,
this.onFailudre=t.failure,this.renderTo=t.renderTo,this.maxWaitTime=t.maxWaitTime||3e4;var i=t.deviceName,e=this.generateId(),n=this.generateId();$("<input/>",{type:"text",readonly:"readonly",id:e}).appendTo(this.com),$("<a id="+n+' href="#"></a>').appendTo(this.com),identitycardText=new PJF.textfield({dom:e,required:!1}),identitycardBt=new PJF.ui.linkButton({dom:n,name:"扫描",style:"assistant",onclick:function(t){if(identitycardBt.setPlain(!0),!identitycardBt.isDisabled())try{PJF.communication.client.getAccountPassword(i+".reBackCall"),identitycardBt.disable()}catch(e){alert(e.message),identitycardBt.enable()}}})},getClassName:function(){return"PJF.ui.identitycard1"}}),PJF.apply(PJF.ui.identitycard1.prototype,{clear:function(){identitycardText.setValue("")},reBackCall:function(t){identitycardText.setValue(t),this.onSuccessful&&this.onSuccessful.call(this,t),identitycardBt.enable()}}),PJF.ui.password=PJF.extend(PJF.ui.device,{_textid:null,_password:null,init:function(a){var s=this
;a.textWidth=a.textWidth||"",a.textBt=a.textBt||resource.DEVICE_PASSWORD_TEXTBT;a.deviceName;a.textid=a.textid||this.generateId(),a.labelText=a.labelText||resource.DEVICE_PASSWORD_LABELTEXT,a.labelId=this.generateId(),a.inputType="password",a.textLength=6,s._textid=a.textid,a.btid=this.generateId(),a.deviceHandler=function(t){if(s._inputText.com.checkTip({Message:"",show:function(){return!0},flag:"validate"}),s._inputText.com.addClass("validatebox-invalid"),a.checkNumPwdFront){var e=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","smpwd.b.dat",a.times)[1],i=e.charAt(0),n=e.substr(2);s._password=[i,n],"0"==i?(s._password=PJF.communication.client.encryptParam(n),0==s._password[0]?PJF.validator.validate(n,a.checkPwdParam,"isStrNumPwd")?a.noTip?s.onFailure(s._password,"数字密码过于简单",!0):(s._inputText.com.checkTip({Message:"数字密码过于简单",show:function(){return!1},flag:"validate"}),
s.params.clearAfterFail&&s._inputText.com.val("")):s.onSuccessful(s._password,a.textid,s._password[1]):s.onFailure(s._password,s._password[1])):s.onFailure(s._password,s._password[1])}else if(s._password=PJF.communication.client.getAccountPassword(a.times,a.encryptType||"P2",a.checkNumPwd,a.checkPwdParam,t||""),0==s._password[0])s.onSuccessful(s._password,a.textid,s._password[1]);else if(-1!=s._password[1].indexOf("数字密码过于简单"))if(a.noTip&&"数字密码过于简单"!=s._password[1]){var o=s._password[1].indexOf(",");s._password[1]=s._password[1].slice(o+1),$("#"+s._textid)[0].value=s._password[1],s.onFailure(s._password,"数字密码过于简单",!0)}else s._inputText.com.checkTip({Message:"数字密码过于简单",show:function(){return!1},flag:"validate"}),s.params.clearAfterFail&&s._inputText.com.val("");else s.onFailure(s._password,s._password[1])},s.baseInit(a)},getClassName:function(){return"PJF.ui.password"},onFailure:function(t,e,i){this.params.clearAfterFail&&this._inputText.setValue("");var n=!0
;null!=this.failure&&(t.shift(),n=this.failure(t,i)),null!=n&&1!=n||new PJF.ui.messageBox({style:"warning",title:resource.DEVICE_BASE_EXCUTE_RESULT,content:e}),this._Bt.enable()}}),PJF.apply(PJF.ui.password.prototype,{getPassword:function(){return $("#"+this._textid)[0].value},setValue:function(t){this.showInputText(this._textid,t)}}),PJF.ui.printDev=PJF.extend(PJF.ui.component,{onSuccessful:null,onFailure:null,renderTo:null,maxWaitTime:null,paramArr:[],printHtmlArr:[],printCount:0,_retFunc:{},singleRetFunc:{},singleParamObj:{},init:function(conf){var that=this;this.onSuccessful=conf.onSuccessful,this.onFailudre=conf.failure,this.renderTo=conf.renderTo,this.maxWaitTime=conf.maxWaitTime||3e4;var deviceNameEx=conf.deviceName,btPrintId=this.generateId(),printArea=conf.printArea,cssNames=conf.cssNames;this.printTimes=conf.printTimes?conf.printTimes:0,this.forceSafari=conf.forceSafari,this.horizontalPrint=conf.horizontalPrint,this.closeAfterPrint=!!conf.closeAfterPrint,
$.browser.safari&&!0===conf.showPrintTip&&(conf.showPrintTip=!1,conf.appendInfo?conf.appendInfo+="&showPrintTip=1":conf.appendInfo="?showPrintTip=1"),this.appendInfo=conf.appendInfo,this.showPrintTip=conf.showPrintTip,$("<a id="+btPrintId+" ></a>").appendTo(this.com);var userAgent=window.navigator.userAgent.toLowerCase(),isWin7=-1!=userAgent.indexOf("windows nt 6.1");this.printWithOutClient=PJF.constants.PRINT_WITHOUT_CLIENT&&isWin7;var printLocal=PJF.communication.client.getDevConfig("dev_scrprt");"0"==printLocal[0]&&(printLocal=eval("("+printLocal+")").isopen),printLocal="true"===printLocal,this.isPrintLocal=isWin7&&printLocal&&PJF.communication.client.isInP2()&&!conf.noPrintLocal,this.printPrivew=($.browser.safari||this.params.forceSafari)&&!this.params.noPreview,this.printPrivew=!(!$.browser.safari||!isWin7)||this.printPrivew,this.printPrivew=!!this.isPrintLocal||this.printPrivew,
$('<div id="div_PRINT_FINAL" style="'+(conf.debugMode?"":"display:none;")+'"><div id="div_commonPrint"></div><iframe id="frm_print_area1" src="'+CONTEXT_PATH+'page/printFrame.html" width="100%"></iframe></div>').appendTo(this.com);var btnName=this.isPrintLocal?resource.DEVICE_PRINTDEV_PRINT_LOCAL:this.printPrivew?resource.DEVICE_PRINTDEV_PRINT_PREVIEW:resource.DEVICE_PRINTDEV_PRINT,xxb;that.printBt=new PJF.ui.linkButton({dom:btPrintId,name:conf.textBt||btnName,iconCls:"icon-print",isRepeat:conf.isRepeat,delayTime:conf.delayTime||2e3,onclick:(xxb=that,function(){if(that.params.showPrintTip)new PJF.ui.messageBox({title:resource.DEVICE_PRINTDEV_PRINT_TIP,style:"warning",content:resource.DEVICE_PRINTDEV_HORIZONTAL_PRINT_TIP,fn:function(){if(!conf.click||!1!==conf.click()){try{xxb.singlePrint(printArea,xxb,cssNames)}catch(t){console.log(t.message),alert(resource.DEVICE_PRINTDEV_PRINT_ERROR)}conf.afterPrint&&conf.afterPrint()}}});else{if(conf.click&&!1===conf.click())return;try{
xxb.singlePrint(printArea,xxb,cssNames)}catch(t){console.log(t.message),alert(resource.DEVICE_PRINTDEV_PRINT_ERROR)}conf.afterPrint&&conf.afterPrint()}})}),this.helpTip=null,conf.helpTip&&this.setHelpTip(conf.helpMessage)},setHelpTip:function(t,e){if(!1===e)this.helpTip&&this.helpTip.destroy(),this.helpTip=null;else if(this.helpTip)this.helpTip.setHelpMsg(t);else{var i="btn_tip_"+PJF.util.generateUUid();this.printBt.com.after('<span id="'+i+'"></span>'),this.helpTip=new PJF.ui.helpTip({dom:i,helpMessage:t||""})}},getClassName:function(){return"PJF.ui.printDev"}}),PJF.apply(PJF.ui.printDev.prototype,{printAreaContentFilter:function(){if(this.params.supportInput){var t=$("#"+this.params.printArea);$('input[type="text"]:visible',t).each(function(){var t=$(this);t.attr("value",t.val())}),$('input[type="checkbox"],input[type="radio"]',t).each(function(){var t=$(this);t.attr("checked",t.prop("checked"))}),$("textarea",t).each(function(){
var t=$(this),e=t.val().replace(new RegExp("\n","gm"),"\\n");t.val(e.replace(new RegExp("\\\\n","gm"),"\n"))})}},disable:function(){this.printBt.disable()},enable:function(){this.printBt.enable()},destroy:function(t){for(var e=$("#"+t),i=0;i<e.length;i++)e[i].className="",e[i].innerHTML=""},newDestroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.id=null,this.com=null},handlePrintRecord:function(){var t=PJF.communication.client.getClientEnv("cuurentMenu.menuName");if(t&&"0"==t[0]){var e=t[1];e==undefined&&(e="无标题"),PJF.communication.cpsJsonReq({fwServiceId:"databaseTransaction",sqlId:"printserver.insertPrintTypeInfo",fwTranId:"update",url:"/bosWeb/ecpJson.action",dataType:"json",jsonData:{transId:e,funcName:e,printType:"02",
printDate:PJF.util.formatDate(new Date,"yyyyMMddhhmmss")},async:!0,type:"post",timeout:"30000",success:function(t,e,i){console.log(t)},failure:function(t,e,i){console.error("保存打印记录失败")}})}else console.log("Error:获取menuName失败, result[0] = "+(t&&t[0]))},isFrmExsit:function(t,e,i,n,o){var a=frames.frm_print_area1.document,s=this;if(a.getElementById("div_printFrm")){this.params.forceSafari&&$("#div_printFrm",a).addClass("print-class");var r=!1;this.params.horizontalPrint&&(r=!0),$("#waitToPrint").hasClass("horizontalPrint")&&(r=!0),r&&$("#div_printFrm",a).addClass("horizontal-print"),this.printAreaContentFilter(),$("#div_printFrm",$(a)).html($("#"+t).html());if(n)for(var c in n){var l=window.frames.frm_print_area1.document.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css");var d=this.isPrintLocal?PJF.html.toAbsURL(n[c]):n[c];l.setAttribute("href",d),a.getElementById("div_printFrm").insertBefore(l,a.getElementById("div_printFrm").childNodes[0])}
if(i&&"undefined"!=i){var u=a.body.innerHTML;o&&"undefined"!=o&&(u=u.replaceAll(".js",""));a.write('<link href="" rel="stylesheet" type="text/css"/><link href="" rel="stylesheet" type="text/css"/>'+u),a.execCommand("SaveAs","true",i)}else{var h=this.handleAppendStyle();if(this.printPrivew&&!this.isPrintLocal){var p=a.getElementById("div_printFrm").innerHTML;p=(p=p.replace(/\\/g,"\\\\")).replace(/\'/g,"＇");var f="";this.params.horizontalPrint&&(f="horizontalPrint"),h&&(p+=h);var m='<span id="printFlag" class="'+this.printTimes+'" closeAfterPrint="'+this.params.closeAfterPrint+'"></span><div id="print_btn_div"><a id="printIt"></a><a style="display:none"id="printLocalId"></a><a id="closeIt"></a></div><div id="waitToPrint" class="'+f+'">'+p+'</div><style type="text/css">.print-class{margin:0 auto;}</style>',g=window.location,v=g.protocol+"//"+g.host+"/bosWeb/page/iePrintProxy.html",_=this.params.appendInfo||"";if(this.printWithOutClient){var b=PJF.util.generateUUid()+"print"
;PJF.communication.client.setAppData("PJF_DATA",b,m),_+=_?"&contentCacheKey="+b:"?contentCacheKey="+b,PJF.communication.client.doCommonCommand("openMenuTrade",JSON.stringify({menuId:"ccb.cddev"+b,menuName:resource.DEVICE_PRINTDEV_PRINT_PAGE_TITLE,browserType:"IEStd",funcUrl:v+_,className:"ccb.cddev.p2.base.browser.SWTBrowser"}))}else PJF.communication.client.printScreen(m,v+_)}else{if(h&&(a.body.innerHTML=a.body.innerHTML+h),this.isPrintLocal){var y=a.body.innerHTML;y=y.replace(/(href|src)(\s*=\s*['"])([^'"]*)(['"])/gm,function(t,e,i,n,o){return e+i+PJF.html.toAbsURL(n)+o});var P={CONTEXTPATH:PJF.html.toAbsURL("/bosWeb/"),JSLOADERPATH:PJF.html.toAbsURL(CONTEXT_PATH+"script/jsloader.js"),printContent:'<span id="printFlag" class="'+this.printTimes+'" closeAfterPrint="'+this.params.closeAfterPrint+'"></span><div id="print_btn_div"><a id="printIt"></a><a id="closeIt"></a></div><div id="waitToPrint" class="">'+y+'</div><style type="text/css">.print-class{margin:0 auto;}</style>'
},C=function(){
/*@preserve                
                <!DOCTYPE html>
                <html>
                <head>
                <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                <meta charset="UTF-8">
                {{EXTRA_CSS}}
                <style type='text/css'>
                  #print_btn_div {
                    margin-top: 20px;
                    width: 100% ;
                    height: 30px;
                    text-align: center;
                  }
                  #printIt {
                    padding-right: 15px;
                  }
                  .print_proxy_title {
                    height: 22px;
                    margin-top: 12px;
                    margin-bottom: 12px;
                    line-height: 22px;
                    font-size: 22px;
                    font-weight: bold;
                    text-align: center;
                  }
                  .pjf_no_preview {
                    display: none;
                  } 
                </style>
                  <script type='text/javascript'>
                    CONTEXT_PATH = '{{CONTEXTPATH}}';
                  </script>
                  <script src='{{JSLOADERPATH}}'></script>
                </head>
                <body>
    
                {{printContent}}
                <script>
                  var printBtn = new PJF.ui.linkButton({
                    dom: 'printIt',
                    name: '打印' ,//resource.DEVICE_PRINTDEV_PRINT,
                    iconCls: 'icon-print',
                    onclick: function() {
                      $('#print_btn_div').hide();
                      document.execCommand("print");
                      $('#print_btn_div').show();
                    }
                  });
    
                  var closeBtn = new PJF.ui.linkButton({
                    dom: 'closeIt',
                    name: '关闭', //resource.PRINT_PROXY_CLOSE,
                    iconCls: 'icon-cancel',
                    isRepeat: false,
                    onclick: function() {
                      // 表示没有执行打印操作
                      closePrintFlag = '0';
                      window.close();
                    }
                  });
                </script>
                </body>
                </html>
              */}.toString().match(/^[\s\S]*\/\*@preserve([\s\S]*)\*\//)[1].replace(/{{([^}]+)}}/gm,function(t,e){return P[e]?P[e]:""}),I=PJF.communication.client.fileUtils("getTempDir");return void("0"!=I[0]?alert("打印出错:"+I[1]):(PJF.communication.client.fileUtils2("createFile",I[1]+"pjfPrint.html",C,"utf-8"),PJF.communication.client.openNativeWindow("file:///"+I[1]+"pjfPrint.html")))}var F=!0;this.params.noPreview&&$.browser.safari&&(F=window.confirm("确认打印本页面?")),F&&(this.handlePrintRecord(),a.execCommand("print"))}}this.params.debugMode||(a.getElementById("div_printFrm").innerHTML="",$("div_commonPrint").innerHTML="")}else window.setTimeout(function(){s.isFrmExsit(t,e,i,n,o)},300)},handleAppendStyle:function(){var t=[];if(this.params.pjfUlTwoMode){var e=this.params.pjfUlTwoWidth||630,i=this.params.pjfContentWidth||e+10,n=this.params.pjfLabelWidth||70;t.push('<style type="text/css" media="print">'),t.push(".pjf_content{max-width:"+i+"px;"),t.push("width:"+i+"px;"),
t.push("max-width:"+i+"px !important;"),t.push("width:"+i+"px !important;"),t.push("_width:"+i+"px;}"),t.push(".pjf_ul_two{max-width:"+e+"px;"),t.push("width:"+e+"px;"),t.push("max-width:"+e+"px !important;"),t.push("width:"+e+"px !important;"),t.push("_width:"+e+"px;}"),t.push(".pjf_ul_two .pjf_label{max-width:"+n+"px;"),t.push("width:"+n+"px;"),t.push("max-width:"+n+"px !important;"),t.push("width:"+n+"px !important;"),t.push("_width:"+n+"px;}"),t.push("</style>")}return this.params.debugMode&&(t.push('<style type="text/css" media="screen">'),t.push("#div_printFrm{border:1px solid red;}"),t.push("</style>")),t.join("")},singlePrint:function(t,e,i,n,o,a,s,r){r&&(window.event?r.cancelBubble=!0:r.stopPropagation()),singleRetFunc={},singleParamObj={};frames.frm_print_area1.document;n&&(e.singleRetFunc=n),o&&(singleParamObj=o),e.isFrmExsit(t,a,s,i)}}),PJF.ui.modelPrint=PJF.extend(PJF.ui.component,{_content:null,_contentHandler:null,init:function(o){var a=this;a._content=o.content,
a._contentHandler=o.contentHandler,a.unitedVoucherPrintMode=!!o.unitedVoucherPrintMode,a.printVoucherMap=o.printVoucherMap,a.printVoucherKey=o.printVoucherKey,a.onBeforePrint=o.onBeforePrint,o.textBt=o.textBt||resource.DEVICE_MODELPRINT_TEXTBT;o.deviceName;var t=this.generateId();$("<a id="+t+" ></a>").appendTo(this.com),a.modelprintBt=new PJF.ui.linkButton({dom:t,name:o.textBt,iconCls:"icon-print",onclick:function(t){if(a.modelprintBt.setPlain(!0),!a.modelprintBt.isDisabled())if(!0!==a.unitedVoucherPrintMode)try{if(null==a._content&&null==a._contentHandler)return new PJF.ui.messageBox({style:"warning",title:"出错",content:resource.DEVICE_MODELPRINT_NO_CONTENT}),void a.modelprintBt.enable();null!=a._contentHandler&&(a._content=a._contentHandler());var e=PJF.communication.client.printDoc(a._content);if(0==e[0]){if(null!=o.successful)return void o.successful()}else{var i=!0;if(null!=o.failure&&(i=o.failure(e[1])),null==i||1==i)return new PJF.ui.messageBox({style:"warning",
title:resource.DEVICE_BASE_EXCUTE_RESULT,content:resource.DEVICE_MODELPRINT_PRINT_ERROR}),void a.modelprintBt.enable()}a.modelprintBt.disable()}catch(n){alert(n.message),a.modelprintBt.enable()}else a.handleUnitedVoucherPrint(o)}}),this.helpTip=null,o.helpTip&&this.setHelpTip(o.helpMessage)},setHelpTip:function(t,e){if(!1===e)this.helpTip&&this.helpTip.destroy(),this.helpTip=null;else if(this.helpTip)this.helpTip.setHelpMsg(t);else{var i="btn_tip_"+PJF.util.generateUUid();this.modelprintBt.com.after('<span id="'+i+'"></span>'),this.helpTip=new PJF.ui.helpTip({dom:i,helpMessage:t||""})}},triggerBtnHandler:function(){this.modelprintBt.triggerBtnHandler()},handleUnitedVoucherPrint:function(a){var s=this,r=this.printVoucherMap;if(r){var i=null;this.printVoucherKey&&(i=[].concat.apply([],[this.printVoucherKey]));if(!i)for(var t in i=[],r)i.push(t);var n=i.length,o=0;0!=n?l():this.handlePrintError(resource.DEVICE_MODELPRINT_NO_CONTENT)
}else this.handlePrintError(resource.DEVICE_MODELPRINT_NO_CONTENT);function c(t,e){try{var i=PJF.communication.client.printVoucher(e);if(0==i[0])return null!=a.successful&&a.successful(e,t,r),void l();var n=!0;if(null!=a.failure&&(n=a.failure(i[1],e,t,r)),null==n||1==n)return s.handlePrintError(i[1]||resource.DEVICE_MODELPRINT_PRINT_ERROR+" PrintId : "+t);s.modelprintBt.disable()}catch(o){alert(o.message),s.modelprintBt.enable()}}function l(){if(n<=o)a.allVoucherPrintedSuccessful&&a.allVoucherPrintedSuccessful(r);else{var t=i[o++],e=r[t];if(null!=s._contentHandler&&(e=s._contentHandler(e,t,r)),null==e)return s.handlePrintError(resource.DEVICE_MODELPRINT_NO_CONTENT+" PrintId : "+t);s.onBeforePrint?s.onBeforePrint(e,t,r,function(){c(t,e)}):c(t,e)}}},handlePrintError:function(t,e,i){return new PJF.ui.messageBox({style:i||"warning",title:e||resource.DEVICE_BASE_EXCUTE_RESULT,content:t}),this.modelprintBt.enable(),!1},getClassName:function(){return"PJF.ui.modelPrint"},
triggerClick:function(){this.modelprintBt.com.trigger("click")}}),PJF.apply(PJF.ui.modelPrint.prototype,{updateUnitedVoucherParams:function(t,e){this.printVoucherMap=t,this.printVoucherKey=e},setContentHandler:function(t){this._contentHandler=t},setContent:function(t){this._content=t},disable:function(){this.modelprintBt.disable()},enable:function(){this.modelprintBt.enable()},destroy:function(){this.com.html(""),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null},newDestroy:function(){this.com.find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),PJF.ui.componentMgr.remove(this.id),this.com.html(""),this.com=null,this.params=null,this.id=null}}),PJF.ui.scan=PJF.extend(PJF.ui.component,{onSuccessful:null,onFailure:null,renderTo:null,maxWaitTime:null,init:function(t){this.onSuccessful=t.onSuccessful,
this.onFailudre=t.failure,this.renderTo=t.renderTo,this.maxWaitTime=t.maxWaitTime||3e4;var i=t.deviceName,e=this.generateId(),n=this.generateId(),o=t.labelText||resource.DEVICE_SCAN_LABELTEXT,a=this.generateId();$("<label id="+a+">"+o+"</label>").appendTo(this.com),label=new PJF.ui.label({dom:a}),$("<input/>",{type:"text",readonly:"readonly",id:e}).appendTo(this.com),$("<a id="+n+' href="#"></a>').appendTo(this.com);new PJF.ui.textfield({dom:e,required:!1});var s=new PJF.ui.linkButton({dom:n,name:t.textBt||resource.DEVICE_SCAN_TEXTBT,style:"assistant",onclick:function(t){if(s.setPlain(!0),!s.isDisabled())try{PJF.communication.client.getAccountPassword(i+".reBackCall"),s.disable()}catch(e){alert(e.message),s.enable()}}})},getClassName:function(){return"PJF.ui.scan"}}),PJF.apply(PJF.ui.scan.prototype,{clear:function(){scanText.setValue("")},reBackCall:function(t){scanText.setValue(t),this.onSuccessful&&this.onSuccessful.call(this,t),scanBt.enable()}}),
PJF.ui.bankBookReader=PJF.extend(PJF.ui.device,{_textid:null,_bankBookInfo:null,init:function(t){var e=this;t.textWidth=t.textWidth||"",t.textBt=t.textBt||resource.DEVICE_BANKBOOKREADER_TEXTBT,t.textid=this.generateId(),t.labelText||(t.labelText=resource.DEVICE_BANKBOOKREADER_LABELTEXT),t.labelId=this.generateId(),e._textid=t.textid,t.btid=this.generateId(),t.deviceHandler=function(){setTimeout(function(){e._bankBookInfo=PJF.communication.client.getBankBookInfo(),t.updateNotification(e,!1),0==e._bankBookInfo[0]?e.onSuccessful(e._bankBookInfo,t.textid,e._bankBookInfo[1]):e.onFailure(e._bankBookInfo,resource.DEVICE_BANKBOOKREADER_ONFAILURE_INFO)},0)},t.notification="请划存折",t.updateNotification=function(t,e){e?(t._inputText.setValue(this.notification),t._inputText.com.addClass("device-warnbox-tipcolor device-warn-border")):(t._inputText.setValue(""),t._inputText.com.removeClass("device-warnbox-tipcolor device-warn-border"))},e.baseInit(t)},getClassName:function(){
return"PJF.ui.bankBookReader"}}),PJF.apply(PJF.ui.bankBookReader.prototype,{getCardNo:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[0]),t},getBankBookPrintNo:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[1]),t},getBankBookNumber:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[2]),t},getWithdrawalMode:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[3]),t}}),PJF.ui.paginationPrint=PJF.extend(PJF.ui.linkButton,{createButton:function(e){var i=this;this.paginationDiv=$("#"+e.paginationDivId),this.paginationContainerId=this.generateId(),this.com=$('<a id="'+e.dom+'"></a>').appendTo(this.paginationDiv),this.printBtnDomId=this.generateId(),this.printBtnDom=$('<a id="'+this.printBtnDomId+'"></a>').appendTo(this.paginationDiv),this.paginationContainer=$('<div id="'+this.paginationContainerId+'" style="'+(e.debugMode||e.autoPage?"":"display:none;")+'"></div>').appendTo(this.paginationDiv),this.bodyCss="",
this.paginationPrintKey=this.generateId(),this.printBtn=new PJF.ui.printDev({dom:i.printBtnDomId,noPrintLocal:!0,printArea:e.paginationDivId,deviceName:"printDev",forceSafari:!0,horizontalPrint:!e.verticalPrint,appendInfo:"?paginationPrintKey="+i.paginationPrintKey+"&showPrintTip="+(e.verticalPrint?"0":"1"),closeAfterPrint:!0,helpTip:e.helpTip,helpMessage:e.helpMessage}),this.printBtn.printBt.hide();var t={dom:e.dom,paginationDivId:e.paginationDivId,paginationContainerId:i.paginationContainerId,text:e.name||resource.DEVICE_PRINTDEV_PRINT_PREVIEW,iconCls:e.iconCls||"icon-print",style:e.style,extraContentId:e.extraContentId,defaultColWidth:e.defaultColWidth,defaultTitleMargin:e.defaultTitleMargin||8,defaultTitleFontWidth:e.defaultTitleFontWidth||14,defaultFontSize:e.defaultFontSize||12,defaultLineHeight:16,defaultMinColWidth:e.defaultMinColWidth||4*(e.defaultTitleFontWidth||14),defaultHeadHeight:e.defaultHeadHeight,fixedColumnWidth:e.fixedColumnWidth,autoPage:e.autoPage,
printId:e.printId,threshold:e.threshold||0,url:e.url||"ecpJson.action",jsonData:e.jsonData||{},isRepeat:!0,data:e.data,debugMode:e.debugMode,verticalPrint:e.verticalPrint,showPageNumber:e.showPageNumber,nowrap:e.nowrap,isHeadAttachedAllPage:!!e.isHeadAttachedAllPage,isEndAttachedAllPage:!!e.isEndAttachedAllPage,pageRenderCallBack:e.pageRenderCallBack,handler:function(){if(i.disable(),i.p.data)return i.handleResponseData(i.p.data),void i.enable();PJF.communication.ajax({safe:!0,type:"post",noRoleTransaction:e.noRoleTransaction,url:i.p.url,data:{_fw_service_id:"synPrintService",jsonData:PJF.util.json2str($.extend({printId:i.p.printId,threshold:i.p.threshold},i.p.jsonData))},dataType:"json",success:function(t){i.enable(),e.dataFilter&&e.dataFilter(t),t&&t.BK_STATUS&&t.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?(i.responseData=t,i.handleResponseData(t)):i.handleError(t)},failure:function(){i.enable(),i.handleError()}})},gridConf:$.extend({showRowNumber:!0,showCheckbox:!1},e.gridConf),
reqParamsBak:{}};(this.p=t).handler&&0<this.com.length&&this.regClickHandler(this,t),this.changeStyle(e,t)},updatePrintId:function(t){t?this.p.printId=t:alert("printId 不能为空！")},handleResponseData:function(u){var r=u.allRows;if(r){var h=r.length;if(0!=h)if(u.printMeta)if(u.printMeta.firstPageNum&&u.printMeta.otherPageNum){try{this.hasMore=parseInt(u.hasMore)}catch(X){this.hasMore=0}this.showLog("Total = "+h);var p=this,t=965,e=630;1==p.p.verticalPrint&&(t=630,e=965);var o=30,a=30,s=t,c=this.p.gridConf.showCheckbox,l=this.p.gridConf.showRowNumber,f=this.p.showPageNumber,d=s-(l?30:0)-(c?27:0)-4,m=u.printMeta.columnList,g=u.printMeta.columnWidthList||[];d-=m.length*this.p.defaultTitleMargin;var v=0,_=s-4,b={},y=0,i=p.p.verticalPrint?630:964,n=p.p.verticalPrint?104:241,P=p.p.verticalPrint?191:241,C={pageTitle:'<div class="page-title">',attachOuterHTML:'<div class="attach-info" >',attachOuterHTML_EMPTY:'<div class="attach-info attach-info-empty">',attachEndHTML:"</div>",
headAttach:'<span class="page-head-attach">',endAttach:'<span class="page-foot-attach">',pageTitleEnd:"</div>",attachEnd:"</span>",firstHeadAttachOutHTML:'<div class="first-head-attach-info" style="width:'+(p.p.verticalPrint?630:964)+'px;">',firstHeadAttachEndHTML:"</div>",firstHeadAttachContainerHTML:'<div class="first-head-attach-container" style="width:'+(p.p.verticalPrint?620:954)+'px;">',firstHeadAttachDetailLeftHTML:'<span class="first-head-attach-detail left">',firstHeadAttachDetailRightHTML:'<span class="first-head-attach-detail right">',firstHeadAttachDetailEndHTML:"</span>",firstHeadAttachContainerEndHTML:"</div>",attachInfoOuterHTML:'<div class="pjf_table_div" style="width: '+i+'px;"><table class="pjf_table" style="width: '+i+'px;"><tbody>',attachInfoEndHTML:"</tbody></table></div>",attachInfoLabelHTML:'<td class="pjf_td_label" style="width: '+n+'px;">',attachInfoLabelEndHTML:"</td>",attachInfoContentHTML:'<td class="pjf_td_content" style="width: '+P+'px;">',
attachInfoContentEndHTML:"</td>",attachInfoBottomLabelHTML:'<td class="pjf_td_label" style="width: '+n+'px;border-bottom: 1px solid rgb(134, 189, 236);">',attachInfoBottomLabelEndHTML:"</td>",attachInfoBottomContentHTML:'<td class="pjf_td_content" style="width: '+P+'px;border-bottom: 1px solid rgb(134, 189, 236);">',attachInfoBottomContentEndHTML:"</td>",footerContainerHTML:'<div class="footer-info" >',footerContainerEndHTML:"</div>",footerHTML:'<span class="page-footer">',footerEndHTML:"</span>",baseOuterHTML:'<div class="panel datagrid" style="width:'+s+'px;"><div class="datagrid-wrap panel-body panel-body-noheader" title="" style="width: auto; ">',baseEndHTML:"</div></div>",gridViewEnd:"</div>",gridView2:'<div class="datagrid-view2" style="height: auto; left:0px;">',gridView2End:"</div>",headView:'<div class="datagrid-header" style=" min-height: '+(p.p.defaultHeadHeight||29)+'px;"><div class="datagrid-header-inner" style="display: block;">',headViewEnd:"</div></div>",
bodyView:'<div class="datagrid-body" style="height: auto;">',bodyViewEnd:"</div>"},I={},F=p.p.isHeadAttachedAllPage,x=p.p.isEndAttachedAllPage;!function(){for(var t=0;t<m.length;t++)g[t]&&(g[t]=parseInt(g[t])),I[t]=g[t]||p.p.defaultColWidth||m[t].length*p.p.defaultTitleFontWidth;var e=u.printMeta.headAttach||[],i=[];if(e.length)for(var t=0;t<e.length;t++){var n=e[t];"#"==n.des.substr(0,1)&&(n.des=n.des.substr(1),i.push(n),e.splice(t,1),t--)}(u.printMeta.headAttach=e).length%2==1&&u.printMeta.headAttach.push({key:"",value:"",des:""});i.length%2==1&&i.push({key:"",value:"",des:""});u.printMeta.firstHeadAttach=i,e.length&&(o=e.length/2*26+1+2,v=i.length/2*26,o+=v+2);x&&(a*=2);F&&(o=30)}();var w=e-50-o-a-2,D=e-2-a;F&&(D-=50+o);var T=!0;this.paginationContainer.html(""),!p.p.debugMode&&p.p.autoPage&&this.paginationContainer.css("display",""),this.printDatas=[];var A={firstPage:parseInt(u.printMeta.firstPageNum),otherPage:parseInt(u.printMeta.otherPageNum)
},E=!0,J=!0,S=this.p.hasPrint?A.otherPage:A.firstPage;p.p.rowNumber=p.p.rowNumber||1;var N=0,k=this.p.currentPageNumber||0,j=!1;if(function(){for(var t=0;t<m.length;t++)T&&W(t,Y(m[t])*p.p.defaultTitleFontWidth);for(var e=0,i=0,n=m.length,o=[],a=0,s=0;s<n;s++){var r=0;p.p.fixedColumnWidth&&(r=p.p.fixedColumnWidth[m[s]]),r?i+=r:(e+=b[s],a+=m[s].length),o.push(b[s])}if(d-i<e){for(var t in p.showLog("表格内容太多，暂时不支持不够显示的情况!"),e=0,I)b[t]=I[t],(!p.p.fixedColumnWidth||!p.p.fixedColumnWidth[m[t]])&&(e+=I[t]);d<e&&p.showLog("表头内容太多，暂时不支持不够显示的情况!")}for(var c=(d-i-e)/a,t=0;t<n;t++){var r=0;p.p.fixedColumnWidth&&(r=p.p.fixedColumnWidth[m[t]]),r?b[t]=r:W(t,null,c*m[t].length)}}(),p.p.extraContentId&&0<$("#"+p.p.extraContentId).length&&(w-=$("#"+p.p.extraContentId).height()),p.p.autoPage){var R=this.paginationContainer;N=U();z=G(y,0);R.append("<style type='text/css'>"+p.bodyCss+"</style>"),R.append(z.replace(/\'/g,"＇"))
;for(var O=R.find(".datagrid-body").find("tbody")[0],L=$(R.find(".datagrid-header")).height();y<h;){for(var B=y,M=L,H=y;H<h;H++){if(p.p.rowNumber=0,O.innerHTML=K(H,!0).replace(/\'/g,"＇"),M+=$(O).height(),N<M){y=H;break}if(H==h-1){y=H+1;break}}p.p.pageRenderCallBack&&p.p.pageRenderCallBack(u,k,B,y-B),p.p.rowNumber=B+1,z=G(B,y-B),this.printDatas.push(z),N=U()}R.empty()}else for(;y<h;){N=U();var V=-1;h<=y+(V=S)&&(V=h-y),p.p.pageRenderCallBack&&p.p.pageRenderCallBack(u,k,y,V);var z=G(y,V);this.printDatas.push(z),y+=V}if(!p.p.debugMode&&p.p.autoPage&&this.paginationContainer.css("display","none"),p.p.extraContentId&&0<$("#"+p.p.extraContentId).length){var q=$("#"+p.p.extraContentId).html();this.paginationContainer.append('<div class="page-start" style="width:'+s+'px;">'+q+"</div>")}this.paginationContainer.append("<style type='text/css'>"+p.bodyCss+"</style>"),this.paginationContainer.append(this.printDatas.join("").replace(/\'/g,"＇"));try{
this.printBtn.singlePrint(this.p.paginationContainerId,this.printBtn,null)}catch(X){alert("打印错误！"+X.message)}this.hasMore?(this.p.hasPrint=!0,this.p.currentPageNumber=k,this.showLoading()):this.resetInnerParams()}else alert("返回数据格式不正确，不存在 firstPageNum或者 otherPageNum 属性！");else alert("返回数据格式不正确，不存在printMeta属性！");else alert("无可打印的数据")}else alert("无可打印的数据");function U(){return k++,0==y?(E=!0,p.p.hasPrint?D:w):(E=!1,F&&(E=!0),S=A.otherPage,D)}function G(t,e){var i=[];j=!(t+e<h),i.push('<div class="page-start" style="width:'+s+"px;"+(j?"":"page-break-after:always;")+'">'),E&&i.push(function(){p.p.hasPrint;var t=[],e=u.printMeta.headAttach,i=u.printMeta.firstHeadAttach,n=u.printMeta.title;if(n&&t.push(C.pageTitle+n+C.pageTitleEnd),e&&F){t.push(C.attachOuterHTML);for(var o="",a=0,s=e.length;a<s;a++){var r=e[a];o=r.des?"：":"",t.push(C.headAttach+r.des+o+r.value+C.attachEnd)}return t.push(C.attachEndHTML),t.join("")}var o="：";if(i){t.push(C.firstHeadAttachOutHTML)
;for(var s=i.length,c=0;c<s;c++){var r=i[c];t.push(C.firstHeadAttachContainerHTML),t.push(C.firstHeadAttachDetailLeftHTML+r.des+"："+r.value+C.firstHeadAttachDetailEndHTML),r=i[++c],o=r.des?"：":"",t.push(C.firstHeadAttachDetailRightHTML+r.des+o+r.value+C.firstHeadAttachDetailEndHTML),t.push(C.firstHeadAttachContainerEndHTML)}t.push(C.firstHeadAttachEndHTML)}if(e){t.push(C.attachInfoOuterHTML);for(var s=e.length,c=0;c<s;c++){t.push("<tr>");var l=!1;s<=c+3&&(l=!0);var r=e[c];t.push((l?C.attachInfoBottomLabelHTML:C.attachInfoLabelHTML)+r.des+"</td>"+(l?C.attachInfoBottomContentHTML:C.attachInfoContentHTML)+r.value+"</td>"),r=e[c+1],t.push((l?C.attachInfoBottomLabelHTML:C.attachInfoLabelHTML)+r.des+"</td>"+(l?C.attachInfoBottomContentHTML:C.attachInfoContentHTML)+r.value+"</td>"),t.push("</tr>"),c++}t.push(C.attachInfoEndHTML)}return t.join("")}()),i.push(C.baseOuterHTML),i.push('<div class="datagrid-view" style="height: '+N+'px; ">'),i.push(C.gridView2),i.push(C.headView),
i.push(function(){var t=[];t.push('<table border="0" cellspacing="0" cellpadding="0" class="datagrid-htable datagrid-table-'+y+'" style="min-height: 30px;"><tbody><tr class="datagrid-header-row">'),l&&t.push('<td rowspan="0" style="width:25px;"><div class="datagrid-header-rownumber"></div></td>'),c&&t.push('<td field="ck" style="width:27px;"><div class="datagrid-header-check"><input type="checkbox" textcontent="header"></div></td>');for(var e=m.length,i=0;i<e;i++)t.push('<td field="col_'+i+'" class="datagrid-cell-'+y+"-"+i+'"><div class="datagrid-cell datagrid-cell-'+y+"-"+i+'" style="text-align: left;"><span style="white-space: normal;">'+m[i]+"</span></div></td>");return t.push("</tr></tbody></table>"),t.join("")}()),i.push(C.headViewEnd),i.push(C.bodyView);var n=function(t,e){var i={},n=[];n.push(C.bodyView),n.push('<table border="0" cellspacing="0" cellpadding="0" class="datagrid-btable datagrid-table-'+y+'" ><tbody>'),h<=e+t&&(e=h-t);i.header=n.join("")
;for(var o=[],a=0;a<e;a++)o.push(K(a+t));p.bodyCss+=function(){var t=[];t.push(".datagrid-body .datagrid-cell, .datagrid-footer .datagrid-cell{white-space:normal;}"),t.push("div.first-head-attach-info{height:"+v+"px;line-height:"+v+"px;}"),t.push("div.page-title{width:"+_+"px;}"),t.push("div.attach-info{width:"+_+"px;}"),t.push("table.datagrid-table-"+y+"{width:"+_+"px;overflow-x:hidden;line-height:"+p.p.defaultLineHeight+"px;}");for(var e=m.length,i=0;i<e;i++)t.push("div.datagrid-cell-"+y+"-"+i+"{width:"+b[i]+"px;}"),t.push("td.datagrid-cell-"+y+"-"+i+"{width:"+b[i]+"px;}");t.push(".page-start .datagrid-header td{font-size: "+p.p.defaultFontSize+"px;}"),t.push(".page-start .datagrid-body td, .datagrid-footer td{font-size: "+p.p.defaultFontSize+"px;}"),t.push(".page-start .datagrid-header .datagrid-cell{padding:3px "+p.p.defaultTitleMargin/2+"px;}"),
t.push(".page-start .datagrid-body .datagrid-cell, .page-start .datagrid-footer .datagrid-cell{padding:0px "+p.p.defaultTitleMargin/2+"px;}"),p.p.defaultHeadHeight&&t.push(".page-start .datagrid-header .datagrid-cell{white-space: normal;}");return t.join("")}(),i.content=o.join("");var s=[];return s.push("</tbody></table>"),s.push(C.bodyViewEnd),i.footer=s.join(""),i}(t,e);return i.push(n.header),i.push(n.content),i.push(n.footer),i.push(C.bodyViewEnd),i.push(C.gridView2End),i.push(C.gridViewEnd),i.push(C.baseEndHTML),i.push(function(t,e,i){var n=[];if(p.showLog("make Page Footer Dom --\x3e rowIndexStart"+t+",showRowCount = "+e+" ,showEndAttach = "+i),p.showLog("hasMore ---\x3e "+p.hasMore),p.showLog("totalRec > showRowCount + rowIndexStart ---\x3e "+(e+t<h)),!x&&(p.hasMore||e+t<h))return n.push(C.footerContainerHTML),n.push(C.footerHTML+f?k:""+C.footerEndHTML),n.push(C.footerContainerEndHTML),n.join("");var o=u.printMeta.endAttach;if(x){var a=[],s=[];a.push(C.attachOuterHTML),
s.push(C.attachOuterHTML);var r=!1;if(o)for(var c=o.length,l=0;l<c;l++){var d=o[l];"secondRow"==d.style?(s.push(C.headAttach+d.des+"："+d.value+C.attachEnd),r=!0):a.push(C.headAttach+d.des+"："+d.value+C.attachEnd)}a.push(C.attachEndHTML),s.push(C.attachEndHTML),!1===r&&(s=[]),n=n.concat(a).concat(s)}else{var o=u.printMeta.endAttach;if(o){n.push(C.attachOuterHTML);for(var c=o.length,l=0;l<c;l++){var d=o[l];n.push(C.endAttach+d.des+"："+d.value+C.attachEnd)}n.push(C.attachEndHTML)}}return n.join("")}(t,e,J)),i.push("</div>"),i.join("")}function K(t,e){var i=[],n=e?0:y;i.push('<tr class="datagrid-row '+(t%2==1?"datagrid-row-alt":"")+'" datagrid-row-index="0"  style="height:24px;">'),l&&i.push('<td class="datagrid-td-rownumber" style="width:25px;"><div class="datagrid-cell-rownumber">'+p.p.rowNumber+++"</div></td>"),c&&i.push('<td field="ck" style="width:27px;"><div class="datagrid-cell-check " style=""><input type="checkbox" value="" name="ck" textcontent="cell"></div></td>')
;for(var o=r[t],a=o.length,s=0;s<a;s++)i.push('<td field="col_'+s+'" class="datagrid-cell-'+n+"-"+s+'"><div class="datagrid-cell datagrid-cell-'+n+"-"+s+'" style="text-align:left;height:auto;">'+o[s]+"</div></td>");return i.push("</tr>"),i.join("")}function W(t,e,i){i?b[t]+=i:b[t]?(e<p.p.defaultMinColWidth&&(e=p.p.defaultMinColWidth),b[t]<e&&(b[t]=e)):b[t]=e}function Y(t){if(!t)return 0;var e=t.length,i=/[a-zA-z]/g,n=0;null!=t.match(i)&&(n=t.match(i).length);var o=/\d/g,a=0;null!=t.match(o)&&(a=t.match(o).length);var s=/[\u4e00-\u9fa5]/g,r=0;null!=t.match(s)&&(r=t.match(s).length);return n+a+r!=e&&e-(n+a+r),Math.round(4/7*(e-r)+r)}},resetInnerParams:function(){for(var t in this.p.hasPrint=undefined,this.p.currentPageNumber=0,this.p.rowNumber=0,this.responseData=null,PJF.communication.client.removeAppData("paginationPrint",this.paginationPrintKey),this.p.reqParamsBak)delete this.p.jsonData[t];delete this.p.jsonData.nextRecNum},showLoading:function(){var e=this
;clearInterval(e.checkInterval),e.loading&&e.loading.destroy(),e.loading=new PJF.ui.loading({maskBody:!0,text:"等待执行打印操作....."}),e.checkInterval=setInterval(function(){var t=PJF.communication.client.getAppData("paginationPrint",e.paginationPrintKey);if("0,1"==t||"0,0"==t){if(clearInterval(e.checkInterval),e.loading&&e.loading.destroy(),e.loading=null,"0,0"==t)return void e.resetInnerParams();e.hasMore&&e.showConfirmWindow()}},300)},showConfirmWindow:function(t,e){var i=this;i.confirmBox=new PJF.ui.messageBox({buttonText:["继续打印","取消"],closable:!0,style:"confirm",title:t||"继续打印",content:e||"点击【继续打印】继续打印，点击【取消】结束打印。",cancel:function(){i.resetInnerParams(),i.loading&&i.loading.destroy(),i.loading=null},ok:function(){PJF.communication.client.removeAppData("paginationPrint",i.paginationPrintKey),i.showLoading(),i.responseData&&(i.updateReqParams($.extend({},{nextRecNum:i.responseData.nextRecNum},i.responseData.nextPageInfo)),$.extend(i.p.reqParamsBak,i.responseData.nextPageInfo)),
i.p.handler()}})},showLog:function(t){this.p.debugMode&&t&&(this.logDiv||(this.logDiv=$('<div id="'+this.printBtnDomId+'_log"></div>').appendTo($("body"))),this.logDiv.append(t+"<br/>"))},handleError:function(t){this.loading&&this.loading.destroy(),this.loading=null;var e="",i="";t?(e="交易失败",i="错误码："+t.BK_CODE+"<BR/>错误描述："+t.BK_DESC+"<BR/>"+(t.FLLW_GUIDE?t.FLLW_GUIDE:"")):(e="通讯错误",i="与后台通信发生错误！"),i+="<br/>点击【继续打印】继续打印，点击【取消】结束打印。",this.showConfirmWindow(e,i)},updateReqParams:function(t){$.extend(this.p.jsonData,t)},updateLocalLoadedData:function(t){this.p.data=t}}),PJF.apply(PJF.ui.paginationPrint.prototype,{validateParam:function(t){return t.dom?(t.paginationDivId=t.dom,t.dom=this.generateId(),!0):(alert("提示：paginationPrint 组件的dom属性不能为空！"),!1)},destroy:function(){this.printBtn.newDestroy(),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.printBtn=null,this.id=null}}),PJF.ui.bankBookWriter=PJF.extend(PJF.ui.component,{init:function(i){this.conf=i
;var n=this;i.textBt=i.textBt||resource.DEVICE_CARDWRITER_TEXTBT;var t=this.generateId();$("<a id="+t+" ></a>").appendTo(this.com),this.cardWriterBt=new PJF.ui.linkButton({dom:t,name:i.textBt,onclick:function(t){var e=PJF.communication.client.writeTrack(n.conf.content,n.conf.trackNum);0==e[0]?i.successful&&i.successful():i.failure&&i.failure(e[1])}})},getClassName:function(){return"PJF.ui.bankBookWriter"},setData:function(t,e){this.conf.content=t,this.conf.trackNum=e}}),PJF.apply(PJF.ui.bankBookWriter.prototype,{disable:function(){this.cardWriterBt.disable()},enable:function(){this.cardWriterBt.enable()},validateParam:function(t){return t.dom&&t.content&&t.trackNum?2==t.content.length||(alert(resource.DEVICE_CARDWRITER_VALIDATEPARAM_CONTENT),!1):(alert(resource.DEVICE_CARDWRITER_VALIDATEPARAM_REQUIRED),!1)},destroy:function(){this.cardWriterBt.destroy(),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.cardWriterBt=null,this.id=null}}),
PJF.ui.cardAndBankBookReader=PJF.extend(PJF.ui.device,{cardTypes:[0,1,-1,-1,6],newCardTypes:[2,3,4,5,6],cardNames:{0:resource.DEVICE_CARDANDBANKBOOKREADER_BASIC_NAME,1:resource.DEVICE_CARDANDBANKBOOKREADER_IC_NAME,"-1":"","-2":"",6:resource.DEVICE_CARDANDBANKBOOKREADER_BANKBOOK_NAME},newCardNames:{2:resource.DEVICE_CARDANDBANKBOOKREADER_BASICJJ_NAME,3:resource.DEVICE_CARDANDBANKBOOKREADER_BAISCDJ_NAME,4:resource.DEVICE_CARDANDBANKBOOKREADER_ICJJ_NAME,5:resource.DEVICE_CARDANDBANKBOOKREADER_ICDJ_NAME,6:resource.DEVICE_CARDANDBANKBOOKREADER_BANKBOOK_NAME},init:function(t){if(this.currentCardType=t.defaultType||(t.moreType?2:0),this.currentCardNames=t.moreType?this.newCardNames:this.cardNames,this.currentCardTypes=t.moreType?this.newCardTypes:this.cardTypes,this.currentCardNames=t.customCardNames||this.currentCardNames,this.blackList={},t.blackList){t.blackList instanceof Array||(t.blackList=[t.blackList]);for(var e=0,i=t.blackList.length;e<i;e++)this.blackList[t.blackList[e]]=!0}
var n=t.selectLabelId=t.selectLabelId||this.generateId(),o=t.selectLabel||resource.DEVICE_CARDANDBANKBOOKTYPE_LABEL_TXT,a=t.selectId||this.generateId(),s=t.selectName||"cardType",r=t.selectRequired;t.labelText=t.labelText||resource.DEVICE_CARDANDBANKBOOKREADER_LABEL_TXT,t.textWidth=t.textWidth||"",t.textBt=t.textBt||resource.DEVICE_CARDANDBANKBOOKREADER_BTN_TXT,t.textid=t.textid||this.generateId(),this._textid=t.textid,t.textName=t.textName||"cardNo",t.labelId=t.labelId||this.generateId(),t.btid=t.btid||this.generateId(),t.cardContainerId=t.cardContainerId||this.generateId(),t.textRequired=t.textRequired,t.datatype=t.datatype,t.hideLabel=t.hideLabel||!1,t.hideText=t.hideText||!1,t.readOnly=t.readOnly,t.disabled=t.disabled,t.textRequired&&(t.labelText='<a class="red">*</a>'+t.labelText),this.baseDom=t.dom,this.container=$("#"+t.dom),$('<li><div><label id="'+n+'">'+(r?'<a class="red">*</a>':"")+o+'</label><div id="'+a+'_dom"></div><div></li>').appendTo(this.container),new PJF.ui.label({
dom:n});var c,l,d,u,h,p=[],f=[],m=[];for(i=this.currentCardTypes.length,e=0;e<i;e++){var g=this.currentCardTypes[e];-1!=g&&(this.blackList[g]||(p.push({name:this.currentCardTypes[e],desc:this.currentCardNames[g]}),f.push(this.currentCardNames[g]),m.push(this.currentCardTypes[e])))}this.params.keyScope&&this.params.keyIndex&&(c=this.params.keyScope,l=this.params.keyIndex,this.params.keyIndex+=.1),t.radioType?this.cardTypeSelect=new PJF.ui.radio({dom:a+"_dom",id:a,keyScope:c,keyIndex:l,name:s,values:m,labels:f,onChange:(u=this,function(){u.cardTypeChangeHandler()})}):this.cardTypeSelect=new PJF.ui.select({dom:a+"_dom",id:a,keyScope:c,keyIndex:l,name:s,data:p,onChange:(d=this,function(){d.cardTypeChangeHandler()})}),this.currentCardType=this.cardTypeSelect.getValue(),t.breakLine&&$("<li></li>").appendTo(this.container),$('<li id="'+t.cardContainerId+'"></li>').appendTo(this.container),t.dom=t.cardContainerId,this.com=$("#"+t.dom),
t.notification=resource.DEVICE_CARDANDBANKBOOKREADER_NOTIFICATION_PREFIX+this.currentCardNames[this.currentCardType]+resource.DEVICE_CARDANDBANKBOOKREADER_NOTIFICATION_SUFFIX,this.notification=t.notification,t.updateNotification=this.updateNotification,t.deviceHandler=(h=this,function(){h.deviceHandler()}),t.moreType?this.deviceHandlers={2:this.cardReaderHandler,3:this.cardReaderHandler,4:this.icCardReaderHandler,5:this.icCardReaderHandler,6:this.bankBookHandler}:this.deviceHandlers={0:this.cardReaderHandler,1:this.icCardReaderHandler,6:this.bankBookHandler},this.conf=t,this.baseInit(t)},cardTypeChangeHandler:function(){this.currentCardType=this.cardTypeSelect.getValue(),this._cardInfo=null,this._icCardInfo=null,this._bankBookInfo=null,this.conf.notification=resource.DEVICE_CARDANDBANKBOOKREADER_NOTIFICATION_PREFIX+this.currentCardNames[this.currentCardType]+resource.DEVICE_CARDANDBANKBOOKREADER_NOTIFICATION_SUFFIX,this.updateNotification(this,!1),
this.conf.onCardTypeChange&&this.conf.onCardTypeChange(this.currentCardType)},updateNotification:function(t,e){e?(t._inputText.com.val(this.notification),t._inputText.com.addClass("device-warnbox-tipcolor device-warn-border")):(t._inputText.setValue(""),t.clearNotification(),t.clearErrorInfo())},clearNotification:function(){this._inputText.com.removeClass("device-warnbox-tipcolor device-warn-border")},clearErrorInfo:function(){this._inputText.com.removeClass("validatebox-tipcolor warnbox-tipcolor error-border warn-border"),this.com.find(".errorbox_ipt_help,.warnbox_ipt_help").remove()},deviceHandler:function(){var t=this;setTimeout(function(){t.deviceHandlers[t.currentCardType](t)},0)},cardReaderHandler:function(t){t._cardInfo=PJF.communication.client.getCardInfo(),0==t._cardInfo[0]?(t.commonSuccessHandler(),t.onSuccessful(t._cardInfo,t.conf.textid,t._cardInfo[1])):(t.commonFailureHandler(),t.onFailure(t._cardInfo,resource.DEVICE_CARDREADER_ONFAILURE_INFO))},
icCardReaderHandler:function(_super){if(_super.conf.newIcCardDriver){var strAIDList="A000000333010101|A000000333010102|A000000333010103|A000000333010106";PJF.util.compareClientVersion("1.3")&&(strAIDList+="|A0000000031010|A000000241010102|A0000000041010"),PJF.util.compareClientVersion("1.3","1")&&(strAIDList+="|A0000000651010"),_super._icCardInfo=PJF.communication.client.getICCardDataByArgs({strAIDList:strAIDList})}else _super._icCardInfo=PJF.communication.client.getIcCardInfo(_super.conf.appType);0==_super._icCardInfo[0]?(_super.conf.newIcCardDriver&&(_super._icCardInfo[1]=JSON.stringify(_super._icCardInfo[1])),_super.commonSuccessHandler(),_super.onSuccessful(_super._icCardInfo,_super.conf.textid,eval("("+_super._icCardInfo[1]+")").accountNo)):(_super.commonFailureHandler(),_super.onFailure(_super._icCardInfo,resource.DEVICE_ICCARDREADER_ONFAILURE_INFO))},bankBookHandler:function(t){
if(t.conf.newBankBookDriver?t._bankBookInfo=PJF.communication.client.getCardInfo():t._bankBookInfo=PJF.communication.client.getBankBookInfo(),t.updateNotification(t,!1),0==t._bankBookInfo[0]){if(t.conf.newBankBookDriver){var e=t._bankBookInfo[1],i=t._bankBookInfo[2];if(-1==PJF.util.array.indexOf(["'","=",">"],i[19])||i.length<31)return t._bankBookInfo=[1,"卡折二磁信息不正确:"+i],t.commonFailureHandler(),void t.onFailure(t._bankBookInfo,resource.DEVICE_BANKBOOKREADER_ONFAILURE_INFO);var n=t._bankBookInfo[2].substr(20,4),o=t._bankBookInfo[2].substr(24,3),a="0"+t._bankBookInfo[2].substr(27,2),s=t._bankBookInfo[2].substr(29,2),r=parseInt(s.charAt(0),10),c=parseInt(s.charAt(1),10);s=[Math.floor(r/2),r%2,Math.floor(c/2),c%2].join(""),t._bankBookInfo=[0,e,n,a,s,o,i]}t.commonSuccessHandler(),t.onSuccessful(t._bankBookInfo,t.conf.textid,t._bankBookInfo[1])}else t.commonFailureHandler(),t.onFailure(t._bankBookInfo,resource.DEVICE_BANKBOOKREADER_ONFAILURE_INFO)},commonSuccessHandler:function(){
this.clearNotification();var t=this;setTimeout(function(){t.params.noCommonHandler||(t.focus(),t.blur()),t.clearErrorInfo()},0)},commonFailureHandler:function(){},getClassName:function(){return"PJF.ui.cardAndBankBookReader"}}),PJF.apply(PJF.ui.cardAndBankBookReader.prototype,{setKey:function(t){t.keyIndex&&t.keyScope?(this.cardTypeSelect.params.keyIndex=t.keyIndex,this.cardTypeSelect.params.keyScope=t.keyScope,this._inputText.params.keyIndex=t.keyIndex+.1,this._inputText.params.keyScope=t.keyScope,this._Bt.params.keyIndex=t.keyIndex+.2,this._Bt.params.keyScope=t.keyScope,PJF.ui.componentMgr.reg(this.cardTypeSelect),PJF.ui.componentMgr.reg(this._inputText),PJF.ui.componentMgr.reg(this._Bt)):alert("请同时传入keyScope和keyIndex!")},destroy:function(){this.currentCardType=null,this.currentCardNames=null,this.currentCardTypes=null,this._cardInfo=null,this._icCardInfo=null,this._bankBookInfo=null,this.com=null,this.conf=null,$("#"+this.baseDom).remove()},newDestroy:function(){
$("#"+this.baseDom).find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),this.currentCardType=null,this.currentCardNames=null,this.currentCardTypes=null,this.cardTypeSelect=null,this._cardInfo=null,this._icCardInfo=null,this._bankBookInfo=null,PJF.ui.componentMgr.remove(this.id),$("#"+this.baseDom).remove(),this.id=null,this.com=null},validateParam:function(t){return!!t.dom||(alert("提示：dom属性不能为空！"),!1)},getCardType:function(){return this.currentCardType},getCardDesc:function(){return this.currentCardNames[this.currentCardType]},disableSelect:function(){this.cardTypeSelect.disable()},enableSelect:function(){this.cardTypeSelect.enable()},enableAll:function(){this.enable(),this.enableSelect()},disableAll:function(){this.disable(),this.disableSelect()},focus:function(){this._inputText.onFocus()},blur:function(){this._inputText.onBlur()},
getSecondDisk:function(){return this._cardInfo?this._cardInfo[1]:null},getICCardNo:function(){return $("#"+this.conf.textid)[0].value},getICCardIndex:function(){return this._icCardInfo?this._icCardInfo[1]:null},getICCardSeqNo:function(){if(this._icCardInfo){var accountInfo=eval("("+this._icCardInfo[0]+")");return accountInfo.ICcardNo}return null},getICCardType:function(){var t=this.getICCardInfo();return t?t.ICCardType:null},getICCardInfo:function(){if(this._icCardInfo){var info=eval("("+this._icCardInfo[0]+")");return info}return null},getCardNo:function(){return this._inputText.getValue()},getBankBookPrintNo:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[1]),t},getBankBookNumber:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[2]),t},getBankBookDvv:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[4]),t},getBankBookWithDrawMode:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[3]),t},
getBankBookSecDisk:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[5]),t}}),PJF.ui.accountReader=PJF.extend(PJF.ui.device,{basicCardTypes:[PJF.constants.COMMON_BANK_CARD,PJF.constants.IC_CARD,PJF.constants.BANKBOOK],moreCardTypes:[PJF.constants.COMMON_DEBIT_CARD,PJF.constants.COMMON_CREDIT_CARD,PJF.constants.IC_DEBIT_CARD,PJF.constants.IC_CREDIT_CARD,PJF.constants.BANKBOOK],initConstants:function(){this.btnNames={},this.btnNames[PJF.constants.COMMON_BANK_CARD]=resource.DEVICE_ACCOUNTREADER_BASIC_BTNNAME,this.btnNames[PJF.constants.IC_CARD]=resource.DEVICE_ACCOUNTREADER_IC_BTNNAME,this.btnNames[PJF.constants.COMMON_DEBIT_CARD]=resource.DEVICE_ACCOUNTREADER_BASICJJ_BTNNAME,this.btnNames[PJF.constants.COMMON_CREDIT_CARD]=resource.DEVICE_ACCOUNTREADER_BAISCDJ_BTNNAME,this.btnNames[PJF.constants.IC_DEBIT_CARD]=resource.DEVICE_ACCOUNTREADER_ICJJ_BTNNAME,this.btnNames[PJF.constants.IC_CREDIT_CARD]=resource.DEVICE_ACCOUNTREADER_ICDJ_BTNNAME,
this.btnNames[PJF.constants.BANKBOOK]=resource.DEVICE_ACCOUNTREADER_BANKBOOK_BTNNAME,this.btnNames[PJF.constants.FACE_CARD]=resource.DEVICE_ACCOUNTREADER_FACE_BTNNAME,this.btnNames[PJF.constants.QRCODE_CARD]=resource.DEVICE_ACCOUNTREADER_QRCODE_BTNNAME,this.btnNames[PJF.constants.NFC_CARD]=resource.DEVICE_ACCOUNTREADER_NFC_BTNNAME,this.cardNames={},this.cardNames[PJF.constants.COMMON_BANK_CARD]=resource.DEVICE_ACCOUNTREADER_BASIC_NAME,this.cardNames[PJF.constants.IC_CARD]=resource.DEVICE_ACCOUNTREADER_IC_NAME,this.cardNames[PJF.constants.COMMON_DEBIT_CARD]=resource.DEVICE_ACCOUNTREADER_BASICJJ_NAME,this.cardNames[PJF.constants.COMMON_CREDIT_CARD]=resource.DEVICE_ACCOUNTREADER_BAISCDJ_NAME,this.cardNames[PJF.constants.IC_DEBIT_CARD]=resource.DEVICE_ACCOUNTREADER_ICJJ_NAME,this.cardNames[PJF.constants.IC_CREDIT_CARD]=resource.DEVICE_ACCOUNTREADER_ICDJ_NAME,this.cardNames[PJF.constants.BANKBOOK]=resource.DEVICE_ACCOUNTREADER_BANKBOOK_NAME,
this.cardNames[PJF.constants.FACE_CARD]=resource.DEVICE_ACCOUNTREADER_FACE,this.cardNames[PJF.constants.QRCODE_CARD]=resource.DEVICE_ACCOUNTREADER_QRCODE,this.cardNames[PJF.constants.NFC_CARD]=resource.DEVICE_ACCOUNTREADER_NFC,this.deviceHandlers={},this.deviceHandlers[PJF.constants.COMMON_BANK_CARD]=this.cardReaderHandler,this.deviceHandlers[PJF.constants.IC_CARD]=this.icCardReaderHandler,this.deviceHandlers[PJF.constants.COMMON_DEBIT_CARD]=this.cardReaderHandler,this.deviceHandlers[PJF.constants.COMMON_CREDIT_CARD]=this.cardReaderHandler,this.deviceHandlers[PJF.constants.IC_DEBIT_CARD]=this.icCardReaderHandler,this.deviceHandlers[PJF.constants.IC_CREDIT_CARD]=this.icCardReaderHandler,this.deviceHandlers[PJF.constants.BANKBOOK]=this.bankBookHandler,this.deviceHandlers[PJF.constants.FACE_CARD]=this.faceHandler,this.deviceHandlers[PJF.constants.QRCODE_CARD]=this.qrcodeHandler,this.deviceHandlers[PJF.constants.NFC_CARD]=this.nfcHandler},init:function(t){this.initConstants()
;var e=t.moreType?this.moreCardTypes:this.basicCardTypes;if(t.customCardTypes){t.forceCustomCardTypes&&(e=[]);for(var i=0,n=t.customCardTypes.length;i<n;i++)-1===PJF.util.array.indexOf(e,t.customCardTypes[i])&&e.push(t.customCardTypes[i])}if(this.currentCardTypes=e,this.currentCardNames=t.customCardNames||this.cardNames,this.blackList={},t.blackList){t.blackList instanceof Array||(t.blackList=[t.blackList]);for(i=0,n=t.blackList.length;i<n;i++)this.blackList[t.blackList[i]]=!0}PJF.util.compareClientVersion("1.3","2")||(this.blackList[PJF.constants.FACE_CARD]=!0,this.blackList[PJF.constants.QRCODE_CARD]=!0,this.blackList[PJF.constants.NFC_CARD]=!0);var o=PJF.util.getValue(PJF,"orgInfo.orgCode");o&&-1===PJF.util.array.indexOf(PJF.ui.accountReader.orgArray,o)&&(this.blackList[PJF.constants.FACE_CARD]=!0,this.blackList[PJF.constants.QRCODE_CARD]=!0,this.blackList[PJF.constants.NFC_CARD]=!0)
;var a=t.selectLabelId=t.selectLabelId||this.generateId(),s=t.selectLabel||resource.DEVICE_ACCOUNTREADER_SELECT_LABEL,r=t.selectId||this.generateId(),c=t.selectName||"cardType",l=t.selectRequired;t.labelText=t.labelText||resource.DEVICE_ACCOUNTREADER_INPUT_LABEL,t.textWidth=t.textWidth||"",t.textid=t.textid||this.generateId(),this._textid=t.textid,t.textName=t.textName||"cardNo",t.labelId=t.labelId||this.generateId(),t.btid=t.btid||this.generateId(),t.cardContainerId=t.cardContainerId||this.generateId(),t.textRequired=t.textRequired,t.datatype=t.datatype,t.hideLabel=t.hideLabel||!1,t.hideText=t.hideText||!1,t.readOnly=t.readOnly,t.disabled=t.disabled,t.textRequired&&(t.labelText='<a class="red">*</a>'+t.labelText),this.baseDom=t.dom,this.container=$("#"+t.dom),$('<li><div><label id="'+a+'">'+(l?'<a class="red">*</a>':"")+s+'</label><div id="'+r+'_dom"></div><div></li>').appendTo(this.container),new PJF.ui.label({dom:a});var d,u,h,p,f,m=[],g=[],v=[];for(n=this.currentCardTypes.length,
i=0;i<n;i++){var _=this.currentCardTypes[i];-1!=_&&(this.blackList[_]||(m.push({name:this.currentCardTypes[i],desc:this.currentCardNames[_]}),g.push(this.currentCardNames[_]),v.push(this.currentCardTypes[i])))}this.params.keyScope&&this.params.keyIndex&&(d=this.params.keyScope,u=this.params.keyIndex,this.params.keyIndex+=.1),t.radioType?this.cardTypeSelect=new PJF.ui.radio({dom:r+"_dom",id:r,keyScope:d,keyIndex:u,name:c,values:v,labels:g,onChange:(p=this,function(){p.cardTypeChangeHandler()})}):this.cardTypeSelect=new PJF.ui.select({dom:r+"_dom",id:r,keyScope:d,keyIndex:u,name:c,data:m,onChange:(h=this,function(){h.cardTypeChangeHandler()})}),this.currentCardType=this.cardTypeSelect.getValue(),t.textBt=t.textBt||this.btnNames[this.currentCardType],t.breakLine&&$("<li></li>").appendTo(this.container),$('<li id="'+t.cardContainerId+'"></li>').appendTo(this.container),t.dom=t.cardContainerId,this.com=$("#"+t.dom),
t.notification=resource.DEVICE_CARDANDBANKBOOKREADER_NOTIFICATION_PREFIX+this.currentCardNames[this.currentCardType]+resource.DEVICE_CARDANDBANKBOOKREADER_NOTIFICATION_SUFFIX,this.notification=t.notification,t.updateNotification=this.updateNotification,t.deviceHandler=(f=this,function(){f.deviceHandler()}),this.conf=t,this.baseInit(t)},cardTypeChangeHandler:function(){this.currentCardType=this.cardTypeSelect.getValue(),this._Bt.updateButtonText(this.btnNames[this.currentCardType]),this._cardInfo=null,this._icCardInfo=null,this._bankBookInfo=null,this.conf.notification=resource.DEVICE_CARDANDBANKBOOKREADER_NOTIFICATION_PREFIX+this.currentCardNames[this.currentCardType]+resource.DEVICE_CARDANDBANKBOOKREADER_NOTIFICATION_SUFFIX,this.updateNotification(this,!1),this.conf.onCardTypeChange&&this.conf.onCardTypeChange(this.currentCardType)},updateNotification:function(t,e){},clearNotification:function(){this._inputText.com.removeClass("device-warnbox-tipcolor device-warn-border")},
clearErrorInfo:function(){this._inputText.com.removeClass("validatebox-tipcolor warnbox-tipcolor error-border warn-border"),this.com.find(".errorbox_ipt_help,.warnbox_ipt_help").remove()},deviceHandler:function(){var t=this;setTimeout(function(){t.deviceHandlers[t.currentCardType](t)},0)},cardReaderHandler:function(t){t._cardInfo=PJF.communication.client.getCardInfo(),0==t._cardInfo[0]?(t.commonSuccessHandler(),t.onSuccessful(t._cardInfo,t.conf.textid,t._cardInfo[1])):(t.commonFailureHandler(),t.onFailure(t._cardInfo,resource.DEVICE_CARDREADER_ONFAILURE_INFO))},icCardReaderHandler:function(_super){if(_super.conf.newIcCardDriver){var strAIDList="A000000333010101|A000000333010102|A000000333010103|A000000333010106";PJF.util.compareClientVersion("1.3")&&(strAIDList+="|A0000000031010|A000000241010102|A0000000041010"),PJF.util.compareClientVersion("1.3","1")&&(strAIDList+="|A0000000651010"),_super._icCardInfo=PJF.communication.client.getICCardDataByArgs({strAIDList:strAIDList})
}else _super._icCardInfo=PJF.communication.client.getIcCardInfo(_super.conf.appType);0==_super._icCardInfo[0]?(_super.conf.newIcCardDriver&&(_super._icCardInfo[1]=JSON.stringify(_super._icCardInfo[1])),_super.commonSuccessHandler(),_super.onSuccessful(_super._icCardInfo,_super.conf.textid,eval("("+_super._icCardInfo[1]+")").accountNo)):(_super.commonFailureHandler(),_super.onFailure(_super._icCardInfo,resource.DEVICE_ICCARDREADER_ONFAILURE_INFO))},bankBookHandler:function(t){if(t.conf.newBankBookDriver?t._bankBookInfo=PJF.communication.client.getCardInfo():t._bankBookInfo=PJF.communication.client.getBankBookInfo(),t.updateNotification(t,!1),0==t._bankBookInfo[0]){if(t.conf.newBankBookDriver){var e=t._bankBookInfo[1],i=t._bankBookInfo[2];if(-1==PJF.util.array.indexOf(["'","=",">"],i[19])||i.length<31)return t._bankBookInfo=[1,"卡折二磁信息不正确:"+i],t.commonFailureHandler(),void t.onFailure(t._bankBookInfo,resource.DEVICE_BANKBOOKREADER_ONFAILURE_INFO)
;var n=t._bankBookInfo[2].substr(20,4),o=t._bankBookInfo[2].substr(24,3),a="0"+t._bankBookInfo[2].substr(27,2),s=t._bankBookInfo[2].substr(29,2),r=parseInt(s.charAt(0),10),c=parseInt(s.charAt(1),10);s=[Math.floor(r/2),r%2,Math.floor(c/2),c%2].join(""),t._bankBookInfo=[0,e,n,a,s,o,i]}t.commonSuccessHandler(),t.onSuccessful(t._bankBookInfo,t.conf.textid,t._bankBookInfo[1])}else t.commonFailureHandler(),t.onFailure(t._bankBookInfo,resource.DEVICE_BANKBOOKREADER_ONFAILURE_INFO)},faceHandler:function(e){PJF.ui.accountReader.faceReader(function(t){0==(e._faceInfo=t)[0]?(e.commonSuccessHandler(),e.onSuccessful(e._faceInfo,e.conf.textid,e._faceInfo[1])):(e.commonFailureHandler(),e.onFailure(e._faceInfo,t[1]))})},qrcodeHandler:function(){},nfcHandler:function(){},commonSuccessHandler:function(){this.clearNotification();var t=this;setTimeout(function(){t.params.noCommonHandler||(t.focus(),t.blur()),t.clearErrorInfo()},0)},commonFailureHandler:function(){},getClassName:function(){
return"PJF.ui.accountReader"}}),PJF.apply(PJF.ui.accountReader.prototype,{setKey:function(t){t.keyIndex&&t.keyScope?(this.cardTypeSelect.params.keyIndex=t.keyIndex,this.cardTypeSelect.params.keyScope=t.keyScope,this._inputText.params.keyIndex=t.keyIndex+.1,this._inputText.params.keyScope=t.keyScope,this._Bt.params.keyIndex=t.keyIndex+.2,this._Bt.params.keyScope=t.keyScope,PJF.ui.componentMgr.reg(this.cardTypeSelect),PJF.ui.componentMgr.reg(this._inputText),PJF.ui.componentMgr.reg(this._Bt)):alert("请同时传入keyScope和keyIndex!")},destroy:function(){this.currentCardType=null,this.currentCardNames=null,this.currentCardTypes=null,this._cardInfo=null,this._icCardInfo=null,this._bankBookInfo=null,this.com=null,this.conf=null,$("#"+this.baseDom).remove()},newDestroy:function(){$("#"+this.baseDom).find("[componentid]").each(function(){try{var t=$(this).attr("componentid"),e=PJF.ui.componentMgr.get(t);if(!e)return;e.newDestroy?e.newDestroy():e.destroy()}catch(i){console.log(i.message)}}),
this.currentCardType=null,this.currentCardNames=null,this.currentCardTypes=null,this.cardTypeSelect=null,this._cardInfo=null,this._icCardInfo=null,this._bankBookInfo=null,PJF.ui.componentMgr.remove(this.id),$("#"+this.baseDom).remove(),this.id=null,this.com=null},validateParam:function(t){return!!t.dom||(alert("提示：dom属性不能为空！"),!1)},getCardType:function(){return this.currentCardType},getCardDesc:function(){return this.currentCardNames[this.currentCardType]},disableSelect:function(){this.cardTypeSelect.disable()},enableSelect:function(){this.cardTypeSelect.enable()},enableAll:function(){this.enable(),this.enableSelect()},disableAll:function(){this.disable(),this.disableSelect()},focus:function(){this._inputText.onFocus()},blur:function(){this._inputText.onBlur()},getSecondDisk:function(){return this._cardInfo?this._cardInfo[1]:null},getICCardNo:function(){return $("#"+this.conf.textid)[0].value},getICCardIndex:function(){return this._icCardInfo?this._icCardInfo[1]:null},
getICCardSeqNo:function(){if(this._icCardInfo){var accountInfo=eval("("+this._icCardInfo[0]+")");return accountInfo.ICcardNo}return null},getICCardType:function(){var t=this.getICCardInfo();return t?t.ICCardType:null},getICCardInfo:function(){if(this._icCardInfo){var info=eval("("+this._icCardInfo[0]+")");return info}return null},getCardNo:function(){return this._inputText.getValue()},getBankBookPrintNo:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[1]),t},getBankBookNumber:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[2]),t},getBankBookDvv:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[4]),t},getBankBookWithDrawMode:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[3]),t},getBankBookSecDisk:function(){var t="";return this._bankBookInfo&&(t=this._bankBookInfo[5]),t}}),PJF.ui.accountReader.winId="pjf_account_reader_win_dom",PJF.ui.accountReader.ensureWinDom=function(){var t=PJF.ui.accountReader.winId
;if(!(e=document.querySelector("#"+t))){var e=document.createElement("div");document.body.appendChild(e),e.setAttribute("id",t)}},PJF.ui.accountReader.faceReader=function(i){PJF.ui.accountReader.ensureWinDom();var n=new PJF.ui.window({dom:PJF.ui.accountReader.winId,url:"/bosWeb/page/common/faceReader/faceRecognition.html",width:700,title:"人脸识别",onClose:function(){},onLoad:function(){}}),t=PJF.observable({});t.one("done",function(){n.destroy();for(var t=[0],e=0;e<arguments.length;e++)t.push(arguments[e]);i(t)}),t.one("error",function(){n.destroy();for(var t=[1],e=0;e<arguments.length;e++)t.push(arguments[e]);i(t)}),t.one("cancel",function(){n.destroy()}),PJF.ui.accountReader.curMsgCenter=t},PJF.ui.accountReader.qrcodeReader=function(t){},PJF.ui.accountReader.nfcReader=function(t){},PJF.ui.accountReader.getCurMsgCenter=function(){return PJF.ui.accountReader.curMsgCenter},PJF.ui.accountReader.orgArray=["310874100","410636308"],PJF.ui.batchModelPrint=PJF.extend(PJF.ui.component,{
init:function(t){var e;t=this.conf=PJF.apply(t,{voucherDatas:t.voucherDatas||[],voucherName:t.voucherNameKey||"voucherName",voucherContent:t.voucherContentKey||"voucherContent",insertVoucherName:"insertVoucherName",insertOwnInfo:"insertOwnInfo",printResults:{length:0},contentHandler:t.contentHandler,closeBtnHandler:t.closeBtnHandler,confirmBtnHandler:t.confirmBtnHandler,authHandler:t.authHandler,afterPrint:t.afterPrint,needReceiptConfirm:!1,isReceiptConfirm:!1,noRePrint:t.noRePrint,multiVoucherMap:t.multiVoucherMap,printSelected:t.printSelected!==undefined?t.printSelected:!!PJF.util.isOverSea()}),this.initInsertVoucherName(t.voucherDatas),this.printBtn=new PJF.ui.linkButton({dom:t.dom,id:t.id||this.generateId(),name:t.printBtnName||resource.BATCH_MODEL_PRINTNM,iconCls:"icon-print",onclick:(e=this,function(){t.beforeClick&&!1===t.beforeClick(e.printBtn)||e.printBtnCallBack()})}),this.helpTip=null,t.helpTip&&this.setHelpTip(t.helpMessage)},setHelpTip:function(t,e){
if(!1===e)this.helpTip&&this.helpTip.destroy(),this.helpTip=null;else if(this.helpTip)this.helpTip.setHelpMsg(t);else{var i="btn_tip_"+PJF.util.generateUUid();this.printBtn.com.after('<span id="'+i+'"></span>'),this.helpTip=new PJF.ui.helpTip({dom:i,helpMessage:t||""})}},triggerBtnHandler:function(){this.printBtn.triggerBtnHandler()},printBtnCallBack:function(){var r=this;this.printListWindowDom&&this.destoryWindowContent();var t;this.printListWindowDom=$('<div id="printListWin"></div>').appendTo($("body")),this.printListWindow=new PJF.ui.window({dom:"printListWin",title:r.conf.printListWindowTitle||resource.BATCH_MODEL_WIN_TITLE,id:"printListWin",
content:'<div id="printListGrid"></div><div id="notificationInfo" class="print-list-info"></div><div class="pjf_submit_con"><a id="printList_confirm"></a><a id="printList_close"></a><a id="printList_scan"></a></div><style type="text/css">#printListWin div.datagrid-toolbar{display:none;}.print-list-info{height:50px;padding-left:10px; color: #008000;font-size: 18px;font-weight: bold;height: 50px;line-height: 50px;}</style>',width:this.conf.windowWidth||650,height:this.conf.windowHeight||350,closable:this.conf.closable,onClose:(t=r,function(){t.conf.closeBtnHandler&&t.conf.closeBtnHandler(),t.destoryWindowContent()}),cache:!1}),this.notificationInfo=$("#notificationInfo"),this.printListConfirmBtn=new PJF.ui.linkButton({dom:"printList_confirm",name:resource.BATCH_MODEL_CONFIRM_BTN,onclick:function(t){r.printListConfirmBtn.disable(),r.conf.printSelected?r.printMultiVoucher():r.printVoucher(r.conf.printResults.length,0)},iconCls:"icon-confirm"}),
PJF.constants.KEYBOARD_ENABLE&&this.printListConfirmBtn.focus(),this.printListCloseBtn=new PJF.ui.linkButton({dom:"printList_close",name:resource.BATCH_MODEL_CLOSE_BTN,onclick:function(t){r.conf.closeBtnHandler&&r.conf.closeBtnHandler(),r.destoryWindowContent()},iconCls:"icon-cancel"}),this.scanBtnConf&&this.scanBtnConf.flag&&(this.scanBtn=new PJF.ui.linkButton({dom:"printList_scan",name:this.scanBtnConf.btnName,onclick:this.scanBtnConf.btnFunc}),2==this.scanBtnConf.flag&&this.scanBtn.disable()),this.printListCloseBtn.setVisible(!1),this.conf.printSelected&&this.printListCloseBtn.setVisible(!0);var e=[[{title:resource.BATCH_MODEL_LIST_COLUMN[0],field:r.conf.voucherName,align:"center",formatter:function(t,e,i){return t}},{title:resource.BATCH_MODEL_LIST_COLUMN[1],field:"printStatus",align:"center",formatter:function(t,e,i){i+="";t="";var n=r.conf.printResults[i],o="";if("0"==(t=n?n.printResult:0))o=resource.BATCH_MODEL_LIST_STATUS[0];else if("1"==t){
for(var a=!0,s=0;s<PJF.constants.VOUCHER_LIST.length;s++)if(PJF.constants.VOUCHER_LIST[s][r.conf.voucherName]==e[r.conf.voucherName]){a=!1;break}a&&PJF.constants.VOUCHER_LIST.push(e),o='<span style="color:blue;">'+resource.BATCH_MODEL_LIST_STATUS[1]+"</span>"}else o="2"==t?'<span style="color:red;">'+resource.BATCH_MODEL_LIST_STATUS[2]+"</span>":"3"==t?'<span style="color:red;">'+resource.BATCH_MODEL_LIST_STATUS[3]+"</span>":resource.BATCH_MODEL_LIST_STATUS[4];return o}},{title:resource.BATCH_MODEL_LIST_COLUMN[2],field:"options",align:"center",formatter:function(t,e,i){i+="";t="";var n=r.conf.printResults[i];if(t=n?n.printResult:0,!1===r.conf.voucherDatas[i].isReprint)return"";var o="";return o=t?"1"==t?resource.BATCH_MODEL_LIST_OPERATION[0]:"2"==t?resource.BATCH_MODEL_LIST_OPERATION[1]:"3"==t?resource.BATCH_MODEL_LIST_OPERATION[2]:resource.BATCH_MODEL_LIST_OPERATION[3]:"",'<a href="####" onclick="PJF.ui.batchModelPrint.printCallBack(\''+r.id+"',"+i+","+t+')">'+o+"</a>"}}]]
;this.conf.printSelected&&e[0].unshift({field:"ck",checkbox:!0,rowspan:2}),this.printListGrid=new PJF.ui.grid({dom:"printListGrid",width:"auto",height:"auto",title:r.conf.printListGridTitle||resource.BATCH_MODEL_LIST,rownumbers:!1,pagination:!1,singleSelect:!this.conf.printSelected,initMsg:resource.BATCH_MODEL_LIST_INITMSG,noDataMsg:resource.BATCH_MODEL_LIST_INITMSG,toolbar:[],columns:e,isShowSelectAllCheckBox:!0,onLoadSuccess:function(){}});var i=this.conf.voucherDatas;i&&0!=i.length?this.printListGrid.loadData(this.conf.voucherDatas,this.conf.isFixSeparater):this.printListGrid.clearData(),this.conf.printSelected&&this.printListGrid.selectAllRow(),this.updateNavigation()},destoryWindowContent:function(){this.printListGrid&&this.printListGrid.destroy(),this.printListGrid=null,this.printListCloseBtn&&this.printListCloseBtn.destroy(),this.printListConfirmBtn&&this.printListConfirmBtn.destroy(),this.printListCloseBtn=null,this.printListConfirmBtn=null,this.notificationInfo=null,
this.printListWindow&&this.printListWindow.destroy(),this.printListWindowDom&&this.printListWindowDom.remove(),this.printListWindowDom=null,this.conf.printResults={length:0}},printMultiVoucher:function(){var e=this.printListGrid.getSelectedIndex();if(0===e.length)new PJF.ui.messageBox({style:"warning",title:"打印失败",content:"请勾选要打印的凭证回单"}),this.printListConfirmBtn.enable();else{var i=this,n=this.conf.printResults;this.conf.printMultiCallBack=function(){var t=e[0];t!=undefined&&(i.printListGrid.unSelectRow(t),i.printListGrid.disableCheckedByRow(t,!0)),e.splice(0,1),0<e.length?i.printVoucher(e[0],0,!!n[e[0]]):i.conf.voucherDatas.length===i.conf.printResults.length&&i.printListConfirmBtn.setVisible(!1)},this.printVoucher(e[0],0,!!n[e[0]])}},printVoucher:function(t,e,i){var n=this;if(i){var o=this.conf.printResults[t+""];if(!o)return void alert("Error: 内部错误 ，未找到对应的打印结果. index = "+t)
;if("1"==o.printResult&&this.conf.authHandler)return void this.conf.authHandler.call(this,t,this.conf.voucherDatas[t],a)}function a(){if(i)return n.updateNavigation(t,e,i),void n.doPrintVoucher(t,e,i);n.doPrintVoucher(t,e,i),n.printListConfirmBtn.enable(),PJF.constants.KEYBOARD_ENABLE&&n.printListConfirmBtn.focus()}a()},doPrintVoucher:function(n,t,o){var a=this;try{n=parseInt(n,10)}catch(d){return alert("Error: 内部错误 ---- index = "+n),!1}var i=this.conf.voucherDatas[n];if(!i)return alert("Error: 内部错误 --- 未找到指定凭证数据 , index = "+n),!1;var s=i[this.conf.voucherContent],r=i.elecSignPicBase64,c=i.elecSealInfo,e=i.contentHandler||this.conf.contentHandler;if(e&&(s=e(s,n,i)),s||alert("Error: 无凭证内容！ index = "+n),this.conf.beforePrint&&!1===this.conf.beforePrint(s,n,i))return this.updatePrintResult(n,3,i,o),void this.updateNavigation(n,2);function l(){var e=new PJF.ui.loading({text:"请按提示插入纸张打印...",maskBody:!0}),t=function(t){e&&e.destroy(),0==t[0]?(a.updatePrintResult(n,1,i),
a.updateNavigation(n,1),a.conf.afterPrint&&a.conf.afterPrint(o,!0,n,s,i)):(a.updatePrintResult(n,2,i,o),a.updateNavigation(n,2),a.conf.afterPrint&&a.conf.afterPrint(o,!1,n,s,i)),a.conf.printSelected&&a.conf.printMultiCallBack()};if(c)PJF.communication.client.pjfAsyncCall("PJF.communication.client.printVoucherWithSealAsync",1,[{jsonStr:s,elecSignBASE64Data:r,elecSealInfo:c},t]);else if(i.pdfTextUrl){t(PJF.communication.client.printUrlText(i.pdfTextUrl))}else PJF.communication.client.pjfAsyncCall("PJF.communication.client.printVoucherAsync",2,[s,r,t])}this.conf.isReceiptConfirm||!this.conf.needReceiptConfirm||"02"!=i.printType&&"05"!=i.printType||!PJF.communication.elecSign.canElecSign()?l.apply(this):this.receiptConfirm(s,n,i,function(t){if(0==t.status||2==t.status)l.apply(a),a.conf.isReceiptConfirm=!0;else if(1==t.status)for(var e,i=n;e=a.conf.voucherDatas[i];i++)e.isReprint=!1,a.updatePrintResult(i,3,e,o),a.updateNavigation(i,2),a.notificationInfo.html("客户不需要回单，操作结束")})},
updatePrintResult:function(t,e){this.conf.voucherDatas[t];var i=this.conf.printResults,n=i[t=t+""];n?(n.prePrintResult=n.printResult,n.printResult=e,n.hasRepeatPrint=!0):(n=i[t]={printResult:e,hasRepeatPrint:!1,prePrintResult:undefined},i.length+=1),this.printListGrid.updateColumnValueByIndex(t,"printStatus",e,!1),this.printListGrid.updateColumnValueByIndex(t,"options",e,!1)},updateNavigation:function(t,e,i){var n=this.conf,o=n.voucherDatas,a=n.printResults,s=n.voucherDatas.length;if(0==o.length)return this.printListCloseBtn.setVisible(!0),PJF.constants.KEYBOARD_ENABLE&&this.printListCloseBtn.focus(),void this.printListConfirmBtn.setVisible(!1);if(!0!==i)if(0!=arguments.length){if(a.length>s)alert("Error: 内部已打印数据长度与是总数据长度不一致！("+a.length+","+s+")");else if(a.length<s)t=a.length+"",this.notificationInfo.html(resource.BATCH_MODEL_LIST_TIP[0]+'<span style="color:#000;">'+o[t][n.insertVoucherName]+"</span>"+resource.BATCH_MODEL_LIST_TIP[1]+o[t][n.insertOwnInfo]);else if(a.length==s){
this.conf.printSelected||(this.printListCloseBtn.setVisible(!0),PJF.constants.KEYBOARD_ENABLE&&this.printListCloseBtn.focus(),this.printListConfirmBtn.setVisible(!1));for(var r=[],c=[],l=0;l<a.length;l++)r.push(l),c.push({options:a[l].printResult});this.printListGrid.updateColumnsValueByIndex(r,c,!1),this.notificationInfo.html("")}}else 0==s?this.notificationInfo.html('<span style="color:green;">'+resource.BATCH_MODEL_LIST_TIP[2]+"</span>"):this.notificationInfo.html(resource.BATCH_MODEL_LIST_TIP[0]+'<span style="color:#000;">'+o[0][n.insertVoucherName]+"</span>"+resource.BATCH_MODEL_LIST_TIP[1]+o[0][n.insertOwnInfo]);else this.notificationInfo.html(resource.BATCH_MODEL_LIST_TIP[0]+'<span style="color:#000;">'+o[t][n.insertVoucherName]+resource.BATCH_MODEL_LIST_TIP[1]+o[t][n.insertOwnInfo]+"</span>")},getClassName:function(){return"PJF.ui.batchModelPrint"}}),PJF.ui.batchModelPrint.printCallBack=function(t,e,i){PJF.ui.componentMgr.get(t).printVoucher(e,i,!0)},
PJF.apply(PJF.ui.batchModelPrint.prototype,{initInsertVoucherName:function(n){this.conf.isReceiptConfirm=!1;var t=this.conf;if("object"==PJF.util.getType(n)){var e,i,o=[],a=0,s=[],r={voucherIDS:[]};for(var c in n)i=n[c].sysEvtTraceId||n[c].SYS_EVT_TRACE_ID,o.push($.extend({},n[c],{pjfVoucherId:c,voucherContent:n[c].printContent})),n[c].paperPrintFlag&&!n[c].confirmNoSign&&n[c].elecSignFlag&&"02"!=n[c].printType&&"05"!=n[c].printType&&(r.sysEvtTraceId=n[c].sysEvtTraceId||n[c].SYS_EVT_TRACE_ID,r.voucherIDS.push(c)),n[c].paperPrintFlag&&(!0===n[c].countPrintFlag||n[c].countPrintFlag===undefined&&"01"==n[c].printType&&!n[c].vchrLvlTpcd)&&(s.push(c.substr(0,32)),a++,e=n[c].sysEvtTraceId||n[c].SYS_EVT_TRACE_ID);if(i&&!PJF.util.isOverSea()&&(this.scanBtnConf=PJF.html.getScanBtnInfo({PRINT_VOUCHER:n,TRACE_ID:i,transType:PJF.loadResource.PJF_LOAD_RESOURCES_CONF.sysEvtTraceId==i?PJF.loadResource.PJF_LOAD_RESOURCES_CONF.authResourceType:""}),
console.log("凭证按钮数据为:"+JSON.stringify(this.scanBtnConf))),i&&!PJF.util.isOverSea()&&16==i.length){var l={cartId:i},d={flag:0};PJF.communication.cpsJsonReq({jsonData:PJF.util.jsontostr(l),maskAll:!0,async:!1,noRoleTransaction:!0,fwServiceId:"remoteDatabaseTransaction",fwTranId:"findObject",sqlId:"journal.getBgCntByCartId",success:function(t){if("00"==t.BK_STATUS&&0!=t.database_result){var e=0;for(var i in n)0==i.indexOf("CARTVOUCHER")&&n[i].paperPrintFlag&&e++;0<e?(d.flag=2,d.btnType="BG",d.btnName="后台扫描",d.btnFunc=function(){}):(d.flag=1,d.btnType="XD",d.btnName="流水号选打",d.btnFunc=function(){PJF.html.openWin("/bosWeb/page/qdyw/dsde/serialQueryAndPrint.jsp","流水查询")})}},failure:function(t){new PJF.ui.messageBox({style:"warning",title:"提示",content:"根据组合交易套号判定扫描模式请求失败！"})}}),this.scanBtnConf=d,console.log("组合交易凭证按钮数据为："+JSON.stringify(this.scanBtnConf))}e&&PJF.communication.cpsJsonReq({jsonData:PJF.util.jsontostr({pprVchrCnt:a,pprVchrList:s.join(","),sysEvtTraceId:e}),
fwServiceId:"remoteDatabaseTransaction",fwTranId:"update",noRoleTransaction:!0,sqlId:"printplatform.updatePprVchrCntByMap",success:function(t){},failure:function(t){}}),r.sysEvtTraceId&&(r.voucherIDS=r.voucherIDS.join(","),PJF.communication.elecSign.uploadSign({CONFIRM_NO_SIGN_DATA:r,PRINT_VOUCHER_STRING_MAP:n})),this.conf.voucherDatas=o,n=o}else if(this.conf.multiVoucherMap){r=[],o=[];for(var u=0;u<n.length;u++){var h=n[u],p={voucherIDS:[]};for(var c in h)o.push($.extend({},h[c],{pjfVoucherId:c+PJF.communication.elecSign.getVoucherSeparator(),voucherContent:h[c].printContent})),h[c].paperPrintFlag&&!h[c].confirmNoSign&&(p.sysEvtTraceId=h[c].sysEvtTraceId||h[c].SYS_EVT_TRACE_ID,p.voucherIDS.push(c));r.push(p)}0<r.length&&PJF.communication.elecSign.uploadSign({CONFIRM_NO_SIGN_DATA:r}),this.conf.voucherDatas=o,n=o}else for(var u in n){var f=n[u][t.voucherName].split(";");2==f.length?(n[u][t.voucherName]=f[0],n[u][t.insertVoucherName]=f[1]):n[u][t.insertVoucherName]=n[u][t.voucherName]}
var m;for(u=0;m=n[u];u++)m[t.insertOwnInfo]=m[t.insertOwnInfo]||"",this.conf.noRePrint&&(m.isReprint=!1),-1!=PJF.util.array.indexOf(["01","02","03","04"],m.vchrLvlTpcd)&&(m.isReprint=!1),!1===m.paperPrintFlag&&n.splice(u--,1);n.sort(function(t,e){return"02"!=t.printType&&"05"!=t.printType||"02"==e.printType||"05"==e.printType?"02"!=e.printType&&"05"!=e.printType||"02"==t.printType||"05"==t.printType?0:-1:1})},receiptConfirm:function(e,i,n,o){var a=new PJF.ui.loading({text:"请等待客户选择是否打印回单...",maskBody:!0});this.notificationInfo.html("请等待客户选择是否打印回单");var s=this;PJF.communication.client.pjfAsyncCall("PJF.communication.client.dispConfirmAsync",1,[{strDispData:'<h1 style="position:absolute;top:50%;left:40%;">请确认是否需要回单</h1>',strVoiceNo:8},function(t){a.destroy(),0==t[0]?1==t[2]?o({status:0}):o({status:1}):new PJF.ui.messageBox({style:"confirm",buttonText:["重试","取消"],closable:!1,title:"柜外清确认失败",content:"原因:"+t[1],ok:function(){s.receiptConfirm(e,i,n,o)},cancel:function(){o({status:2})}})}])},
setVoucherDatas:function(t){this.conf.voucherDatas=t,this.initInsertVoucherName(t)},updateConfig:function(t){PJF.apply(this.conf,t),this.initInsertVoucherName(this.conf.voucherDatas)},destroy:function(){this.destoryWindowContent(),this.com.html(""),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null,this.conf=null},newDestroy:function(){this.destoryWindowContent(),this.printBtn.destroy(),this.com.html(""),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.com=null,this.params=null,this.id=null,this.conf=null},validateParam:function(t){return!!document.getElementById(t.dom)||(alert("Error: batchModelPrint 组件 dom 属性不能为空且指定dom节点必须存在！"),!1)}}),PJF.ui.fileupload=PJF.extend(PJF.ui.component,{init:function(t){if(this.upload=null,t)return this.upload=this.com.fileupload(t),this.com.css({"float":"left"}),t.url&&this.com.closest("li").css({width:"auto","min-width":"auto","float":"none",clear:"both",display:"block"}),this.upload},destroy:function(){
this.com.children().remove()},newDestroy:function(){$("#"+this.upload.fileInputID).die(),$("#"+this.upload.scanId).die(),this.com.find("[componentid]").each(function(){PJF.ui.componentMgr.get($(this).attr("componentid")).destroy()}),PJF.ui.componentMgr.remove(this.id),PJF.validator.base[this.upload.validateKeyName]=null,this.com.remove(),this.com.children().remove()},getUploadFileName:function(){return this.upload.getUploadFileName()},addDetail:function(t){for(var e=0;e<t.length;e++){var i=(new Date).getTime()+"_"+Math.floor(1048576*Math.random()).toString(16),n='<div class="pjf_fileupload_progressbar_box"  ><span class="pjf_fileupload_file_name">'+t[e].desc+'</span><span class="pjf_fileupload_file_operate"><a href="'+t[e].delLink+'" id="'+i+'">删除</a></span></div>';this.com.append(n),$("#"+i).live("click",function(){$(this).parent().parent().remove()})}},getClassName:function(){return"PJF.ui.fileupload"},setValue:function(t){this.upload.setValue(t)},clear:function(){
return this.upload.clear()},getValue:function(){return this.upload.getValue()},disable:function(){this.upload.disable()},enable:function(){this.upload.enable()}}),PJF.ui.buttonInput=PJF.extend(PJF.ui.device,{_textid:null,init:function(t){this.pmc_disable=t.pmc_disable;t.deviceName;t.textid="input_txt_"+t.dom,t.textName||(t.textName="input_txt_"+t.dom),this._textid=t.textid,t.btid=this.generateId(),t.deviceHandler=function(){t.onclick()},this.baseInit(t),this.com.css({"float":"left"})}}),PJF.apply(PJF.ui.buttonInput.prototype,{clear:function(){$("#"+this._textid)[0].value=""},getContent:function(){return $("#"+this._textid)[0].value},setAvailable:function(t){t?$("#"+this._textid).attr("readonly",!0):$("#"+this._textid).attr("readonly",!1)},setValue:function(t){this.showInputText(this._textid,t)},destroy:function(t){for(var e=$("#"+t),i=0;i<e.length;i++)e[i].className="",e[i].innerHTML=""},getClassName:function(){return"PJF.ui.buttonInput"}}),PJF.ui.dateSpan=PJF.extend(PJF.ui.component,{
init:function(t){var e=t.inputNames,i="",n="";e&&(e[0]&&(i=e[0]),e[1]&&(n=e[1]));var o,a=t.inputIds,s="",r="";a&&(a[0]&&(s=a[0]),a[1]&&(r=a[1])),o=t.showTime?"<input id='date0_"+t.dom+"' type='text'/><span class='pjf_dateSpan_separate'></span><input id='date1_"+t.dom+"' type=''/>":"<input id='date0_"+t.dom+"' name='"+i+"' type='text'/><span class='pjf_dateSpan_separate'></span><input id='date1_"+t.dom+"' name = '"+n+"'type=''/>";var c=this.com,l=t.minDate,d=t.maxDate,u=t.initDate;c.append(o),t.validType=t.validType?t.validType:[];var h=t.validType[0],p=t.validType[1];t.ruleValidateMsg=t.ruleValidateMsg?t.ruleValidateMsg:[];var f=t.ruleValidateMsg[0],m=t.ruleValidateMsg[1];t.defaultDate=t.defaultDate?t.defaultDate:[];var g=t.defaultDate[0],v=t.defaultDate[1];if(this.date1=new PJF.ui.dateinput({dom:"date0_"+t.dom,dateWidth:t.dateWidth,width:t.width,validMsg:t.validMsg,invalidMessage:t.invalidMessage,validComMsg:t.validComMsg,required:t.required,minDate:l,maxDate:d,dateSpan:!0,
notEql:t.notEql,onlyMonth:t.onlyMonth,blurEvent:t.blurEvent,noInput:t.noInput,validMiMaMsg:t.validMiMaMsg,change:t.change,missingMessage:t.missingMessage,showTime:t.showTime,validCurrentDateMsg:t.validCurrentDateMsg,isValidateWithStartDate:t.isValidateWithStartDate,isValidateWithEndDate:t.isValidateWithEndDate,validType:h,ruleValidateMsg:f,defaultDate:g,keyScope:t.keyScope,keyIndex:t.keyIndex+".001"}),this.date2=new PJF.ui.dateinput({dom:"date1_"+t.dom,dateWidth:t.dateWidth,width:t.width,validMsg:t.validMsg,invalidMessage:t.invalidMessage,validComMsg:t.validComMsg,required:t.required,minDate:l,maxDate:d,dateSpan:!0,notEql:t.notEql,preDateDom:this.date1,onlyMonth:t.onlyMonth,blurEvent:t.blurEvent,noInput:t.noInput,validMiMaMsg:t.validMiMaMsg,change:t.change,missingMessage:t.missingMessage,showTime:t.showTime,validCurrentDateMsg:t.validCurrentDateMsg,isValidateWithStartDate:t.isValidateWithStartDate,isValidateWithEndDate:t.isValidateWithEndDate,validType:p,ruleValidateMsg:m,
defaultDate:v,keyScope:t.keyScope,keyIndex:t.keyIndex+".002",helpTip:t.helpTip,helpMessage:t.helpMessage}),this.date1.setNexDateDom(this.date2),u){if(""!=u[0]&&""!=u[1]&&u[0]>u[1])return void alert(resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO+t.dom+resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO1);if(d<l)return void alert(resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO+resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO1);u[0]>=l&&u[0]<=d||!l&&u[0]<=d||!d&&u[0]>=l||!l&&!d&&u[0]?this.com.find("input[id^='date0']").next("span").children("input").val(u[0]):""!=u[0]&&(u[0]<l||u[0]>d)&&(this.com.find("input[id^='date0']").next("span").children("input:first").attr("error",resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO+t.dom+resource.DATESPAN_FIRSTINITDATE_COMPMAXMINDATE),alert(resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO+t.dom+resource.DATESPAN_FIRSTINITDATE_COMPMAXMINDATE)),
u[1]>=l&&u[1]<=d||!d&&u[1]>=l||!l&&u[1]<=d||!l&&!d&&u[1]?this.com.find("input[id^='date1']").next("span").children("input").val(u[1]):""!=u[1]&&(u[1]<l||u[1]>d)&&(this.com.find("input[id^='date1']").next("span").children("input:first").attr("error",resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO+resource.DATESPAN_SECONDINITDATE_COMPMAXMINDATE),alert(resource.DATEINPUT_MAXMIN_LIMITEDRANGE_INFO+t.dom+resource.DATESPAN_SECONDINITDATE_COMPMAXMINDATE))}this.com.find("input[id^='date0']").next("span").children("input:first").addClass("js_isdataspan"),this.com.find("input[id^='date1']").next("span").children("input:first").addClass("js_isdataspan"),t.showTime&&(this.com.find("input[id^='date0']").next("span").children("input:first").attr("name",i),this.com.find("input[id^='date1']").next("span").children("input:first").attr("name",n)),this.com.find("input[id^='date0']").next("span").children("input:first").attr("id",s),
this.com.find("input[id^='date1']").next("span").children("input:first").attr("id",r),this.params.keyScope=null,this.params.keyIndex=null},getPreValue:function(){this.com.find("input").next("span").children("input").val();return this.date1.getValue()},getNextValue:function(){this.com.find("input[id^='date1']").next("span").children("input").val();return this.date2.getValue()},disabled:function(){this.date1.disable(),this.date2.disable()},disable:function(){this.date1.disable(),this.date2.disable()},setPreDisabled:function(){this.date1.disable()},setNextDisabled:function(){this.date2.disable()},setPreDisable:function(){this.date1.disable()},setNextDisable:function(){this.date2.disable()},enable:function(){this.date1.enable(),this.date2.enable()},manualValidate:function(){
var t=this.com.find("input[id^='date1']").next("span").hasClass("validatebox-tipcolor"),e=this.com.find("input").next("span").children("input").val(),i=this.com.find("input[id^='date1']").next("span").children("input").val(),n=this.com.find("input[id^='date0']").next("span"),o=this.com.find("input[id^='date1']").next("span");if(""!=e||t?""!=e&&t&&n.removeClass("validatebox-tipcolor").children("input").removeClass("validatebox-tipcolor"):n.addClass("validatebox-tipcolor").children("input").addClass("validatebox-tipcolor"),""!=i||t){if(""!=i&&t)return o.removeClass("validatebox-tipcolor").children("input").removeClass("validatebox-tipcolor"),!1}else o.addClass("validatebox-tipcolor").children("input").addClass("validatebox-tipcolor");if(parseInt(i)<parseInt(e))return alert(resource.DATESPAN_MANUALVALIDATE_INFO),!1},setPreValue:function(t){var e=this.params.minDate,i=this.params.maxDate;""!=t&&(t<e||i<t)?alert(resource.DATESPAN_SETVALUE_MAXINMIN_INFO):this.date1.setValue(t)},
setNextValue:function(t){var e=this.params.minDate,i=this.params.maxDate;""!=t&&(t<e||i<t)?alert(resource.DATESPAN_SETVALUE_MAXINMIN_INFO):this.date2.setValue(t)},setMinDate:function(t){this.date1.setMinDate(t),this.date2.setMinDate(t)},setMaxDate:function(t){this.date1.setMaxDate(t),this.date2.setMaxDate(t)},getPreDateObj:function(t){return this.date1},getNextDateObj:function(t){return this.date2},getClassName:function(){return"PJF.ui.dateSpan"},setValidMiMaMsg:function(t){this.date1.setValidMiMaMsg(t),this.date2.setValidMiMaMsg(t)},setReadOnly:function(t){this.date1.setReadOnly(t),this.date2.setReadOnly(t)},setPreReadOnly:function(t){this.date1.setReadOnly(t)},setNextReadOnly:function(t){this.date2.setReadOnly(t)},setPreRequired:function(t){var e=!0;0==t&&(e=!1),
(this.date1.required=e)?this.com.find("input[id^='date0']").next("span").children("input:eq(0)").addClass("validatebox-invalid invalid_box"):this.com.find("input[id^='date0']").next("span").children("input:eq(0)").removeClass("validatebox-invalid invalid_box")},setNextRequired:function(t){var e=!0;0==t&&(e=!1),(this.date2.required=e)?this.com.find("input[id^='date1']").next("span").children("input:eq(0)").addClass("validatebox-invalid invalid_box"):this.com.find("input[id^='date1']").next("span").children("input:eq(0)").removeClass("validatebox-invalid invalid_box")},focus:function(){this.date1.focus()},isDisplay:function(){return!0},isDisabled:function(){return!1},isReadOnly:function(){return!1},newDestroy:function(){this.date1.newDestroy(),this.date2.newDestroy(),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.date1=null,this.date2=null,this.com=null,this.id=null,this.params=null}}),PJF.ui.submitButton=PJF.extend(PJF.ui.linkButton,{createButton:function(o){
var a=this,t={dom:o.dom,text:o.name||resource.SUBMITBUTTON_DEFAULT_NAME,iconCls:o.iconCls||"icon-default",style:o.style,isRepeat:o.isRepeat||!1,handler:function(){if(PJF.html.validateForm(o.src,"")){var t=PJF.html.getAreaData(o.src);if(o.encrypt)for(var e in t)for(var i=0;i<o.encrypt.length;i++)if(e==o.encrypt[i]){var n=t[e];t[e]=PJF.communication.client.encryptParam(n)}PJF.communication.cpsJsonReq({fwServiceId:o.fwServiceId,fwTranId:o.fwTranId,jsonData:PJF.util.json2str(t),success:function(t){PJF.html.setAreaData(t,o.target),o.success&&o.success(t)},failure:function(t){o.failure&&o.failure(t),0==o.isRepeat&&a.enable()}})}}};(this.p=t).handler&&0<this.com.length&&this.regClickHandler(this,t),this.changeStyle(o,t)}}),PJF.apply(PJF.ui.submitButton.prototype,{validateParam:function(t){return t.dom&&t.src&&t.fwServiceId?(this.dom=t.dom,!0):(alert("提示：submitButton的dom,src,fwServiceId属性不能为空！"),!1)}}),PJF.ui.dispatcherButton=PJF.extend(PJF.ui.linkButton,{txt_dispatcher_id:null,
createButton:function(a){var s=this,t={dom:a.dom,text:a.name||resource.DISPATCHERBUTTON_DEFAULT_NAME,iconCls:"icon-default",style:a.style,isRepeat:a.isRepeat||!1,handler:function(){var t;if(a.data)t=a.data;else if(a.src){if(!PJF.html.validateForm(a.src,""))return;t=PJF.html.getAreaData(a.src)}if(a.encrypt)for(var e in t)for(var i=0;i<a.encrypt.length;i++)if(e==a.encrypt[i]){var n=t[e];0==PJF.communication.client.encryptParam(n)[0]?t[e]=PJF.communication.client.encryptParam(n)[1]:alert("提示：加密失败")}var o={_fw_service_id:a.fwServiceId,jsonData:PJF.util.json2str(t),transaction_id:a.fwTranId};PJF.communication.ajax({url:a.url||PJF.constants.DEFAULT_ACTION,data:o,success:function(t){if(t){var e=t.dispatcherInfo;s.resultData=t.resultData,"page"==e.type&&("tab"==e.param?window.open(e.url):"dialog"==e.param&&(PJF.html.getDom("dispacherNewWin")||$("body").append('<div id="dispacherNewWin"></div>'),new PJF.ui.window({dom:"dispacherNewWin",title:"newWin",width:600,height:400,url:e.url,
onLoad:a.success})))}else alert("提示：无返回数据！")},failure:function(t){a.failure&&a.failure(t),0==a.isRepeat&&s.enable()}})}};t.handler&&($("#"+this.txt_dispatcher_id)[0]&&$("#"+this.txt_dispatcher_id).empty(),0<this.com.length&&this.regClickHandler(this,t)),this.changeStyle(a,t)}}),PJF.apply(PJF.ui.dispatcherButton.prototype,{getHidText:function(){return this.resultData},validateParam:function(t){return t.dom&&(t.src||t.data)&&t.fwServiceId?(this.dom=t.dom,!0):(alert("提示：dispatchButton的dom,src或者data,fwServiceId 属性不能为空！"),!1)}}),PJF.ui.orgTree=PJF.extend(PJF.ui.tree,{dom:null,conf:null,isCheckChildren:!1,default_fw_service_id:"jgygTreeService",orgNameQueryService:"orgNameQueryService",default_parent_code:"111111111",type:"0",orgProdTypeCode:PJF.constants.ORGTREE_TYPE_B,showRoot:!1,order:"asc",notLoaded:!0,hasData:!1,bakSelectedNodes:[],bakInputNodes:[],nodes:[],otherParam:{},isShowRoot:!1,preNodeObj:null,depth:null,limitNum:null,requestCount:-1,bakParentCode:null,init:function(t){var i=this
;t.orgProdTypeCode&&PJF.constants[t.orgProdTypeCode]&&(this.orgProdTypeCode=PJF.constants[t.orgProdTypeCode]),this.baseDomHTML=$("#"+t.dom)[0].outerHTML,this.dom=t.dom,this.type=t.type||this.type,this.showRoot=t.showRoot||this.showRoot,this.depth=t.depth,this.limitNum=t.limitNum,this.order=t.order||this.order,this.transId=t.transId,this.newMode=t.newMode,"ztree"!=this.com.attr("class")&&this.com.attr("class","ztree"),this.initConf(t),this.bakParentCode=t.parentCode||this.default_parent_code;var n,e=t.parentCode||this.default_parent_code;if("string"==typeof e&&(e=e.replace(/\s/g,"")),i.isMultiInit=-1<e.indexOf(","),this.showRoot)i.newMode?(n={CCBIns_ID:e},PJF.communication.addParam(n),this.otherParam={jsonData:PJF.util.json2str(n),_fw_service_id:"simpleTransaction",transaction_id:t.transId||"A0651C003-pjf"}):this.otherParam={parent_code:t.parentCode||this.default_parent_code,type:t.type||this.type,orgProdTypeCode:this.orgProdTypeCode,
_fw_service_id:t.orgNameQueryService||this.orgNameQueryService};else if(!this.showRoot||this.isShowRoot)if(i.newMode){var o=this.orgProdTypeCode;-1!=o.indexOf("ALL")?(n={Prim_CCBIns_ID:e,CCBInsInrHierStcTp_Cd:o.substr(3)},PJF.communication.addParam(n),this.otherParam={jsonData:PJF.util.json2str(n),_fw_service_id:"simpleTransaction",transaction_id:t.transId||"A0651S015-pjf"}):(n={Prim_CCBIns_ID:e,CCBInsInrHierStcTp_Cd:o,Enqr_Cnd:this.type},PJF.communication.addParam(n),this.otherParam={jsonData:PJF.util.json2str(n),_fw_service_id:"simpleTransaction",transaction_id:t.transId||"A0651S034-pjf"})}else this.otherParam={parent_code:t.parentCode||this.default_parent_code,type:t.type||this.type,orgProdTypeCode:this.orgProdTypeCode,_fw_service_id:t.fwServiceId||this.default_fw_service_id};if(t.transId&&(this.otherParam=this.otherParam||{},this.otherParam.transaction_id=t.transId),this.setting=$.extend({},t,{treeType:1,otherParam:this.otherParam,chkRange:t.chkRange,
selectedNodes:t.selectedNodes||[],inputNodes:t.inputNodes||[],isRemoteData:"undefined"==typeof t.isRemoteData||t.isRemoteData,check:"undefined"==typeof t.showCheckBox||t.showCheckBox,showIcon:t.showIcon,edit:!1,remove:!1,isMove:!1,checkType:t.checkType||{Y:"s",N:"s"},chkStyle:0==t.mutiple?"radio":"checkbox",radioType:t.radioType||"all",beforeAsync:this._beforeAsync(this),onAsyncSuccess:this._onAsyncSuccess(this),onAsyncError:this._onAsyncError(this),beforeExpand:this._beforeExpand(this),beforeCheck:this._beforeCheck(this),onCheck:this._onCheck(this),dataFilter:this._dataFilter(this)}),t.selectedNodes&&0<t.selectedNodes.length)for(var a in t.selectedNodes)this.bakSelectedNodes[a]=t.selectedNodes[a];if(t.inputNodes&&0<t.inputNodes.length)for(var a in t.inputNodes)this.bakInputNodes[a]=t.inputNodes[a];if(i.newMode&&i.isMultiInit){var s=[],r=e.split(","),c=[];r.forEach(function(t){var e;c.push((e=$.Deferred(),i.showRoot?n.CCBIns_ID=t:n.Prim_CCBIns_ID=t,PJF.communication.cpsJsonReq({
fwServiceId:"simpleTransaction",fwTranId:i.otherParam.transaction_id,jsonData:JSON.stringify(n),maskAll:!0,success:function(t){e.resolve(t)},failure:function(t){e.reject(t)}}),e))}),$.when.apply(null,c).done(function(){for(var t=0;t<arguments.length;t++)s=s.concat(arguments[t].INST_C_GRP||arguments[t].CCBINST_INF);i.setting.data=[],s.forEach(function(t){if(t){var e={};"A0651C003-pjf"===i.otherParam.transaction_id?(e.nodeId=t.CCBIns_ID,e.parentId="",e.ccbinsTpcd=t.CCBIns_TpCd||"",e.instLdgrHierCd=t.Inst_Ldgr_Hier_Cd||"",e.isParent=!0,e.open=!1,e.iconSkin="orgTree_org",e.type="org",e.instSvrlLgPsnID=t.Inst_SvrlLgPsn_ID||"",e.instSvrlLgPsnNm=t.Inst_SvrlLgPsn_Nm||"","zh-cn"===CLIENT_LANGUAGE?e.text=t.CCBIns_Chn_ShrtNm:"en-us"===CLIENT_LANGUAGE&&(e.text=t.CCBIns_Eng_ShrtNm?t.CCBIns_Eng_ShrtNm:t.CCBIns_Chn_ShrtNm),e.nodeId&&i.setting.data.push(e)):-1<["A0651S034-pjf","A0651S015-pjf"].indexOf(i.otherParam.transaction_id)&&(e.nodeId=t.Scdy_CCBIns_ID,e.parentId=t.Prim_CCBIns_ID,
e.ccbinsTpcd=t.CCBIns_TpCd,e.instLdgrHierCd=t.Inst_Ldgr_Hier_Cd,e.isParent=!0,e.open=!1,e.instSvrlLgPsnID=t.Inst_SvrlLgPsn_ID||"",e.instSvrlLgPsnNm=t.Inst_SvrlLgPsn_Nm||"","zh-cn"===CLIENT_LANGUAGE?e.text=t.LwLvCCBInsChnSht_Nm:"en-us"===CLIENT_LANGUAGE&&(e.text=t.LwLvCCBIns_EngShtNm?t.LwLvCCBIns_EngShtNm:t.LwLvCCBInsChnSht_Nm),i.setting.data.push(e))}}),i.setting.isMulti=!0,new PJF.ui.tree(i.setting),i.treeObj=$.fn.zTree.getZTreeObj(i.com.children(":first").attr("id"))}).fail(function(t){console.log("fail:"+JSON.stringify(t)),i.setting.isMulti=!0,new PJF.ui.tree(i.setting),i.treeObj=$.fn.zTree.getZTreeObj(i.com.children(":first").attr("id"))})}else new PJF.ui.tree(this.setting),this.treeObj=$.fn.zTree.getZTreeObj(this.com.children(":first").attr("id"))},log:function(t,e){if(this.conf.showLog)if(e)console.log(t);else if("string"!=typeof t)for(var i in console.log("type ---\x3e "+typeof t),console.log(t),t)console.log(t[i]);else console.log("-----------"+t+"-------------")},
initConf:function(t){this.conf=$.extend({},t,{showLog:"undefined"!=typeof t.showLog&&t.showLog})},_beforeAsync:function(n){var i=function(t,e){n.log("_beforeAsync");var i=!0;return n.conf.onLoadBefore&&(i=n.conf.onLoadBefore(t,e,"_beforeAsync"),n.log("conf.onLoadBefore return ---\x3e"+i),i=void 0===i||i,n.log("conf.onLoadBefore final ---\x3e"+i)),i&&null!=e&&n.updateRequestParam(e.nodeId),e&&(n.treeObj.setting.view.NoExpand=!i),n.log("_beforeAsync return "+i),i};return n.newMode&&n.isMultiInit?function(t,e){return!!e&&i(t,e)}:function(t,e){return i(t,e)}},_onAsyncSuccess:function(o){return function(t,e,i,n){o.log("_onAsyncSuccess"),o.log("_onAsyncSuccess  ---\x3e"+n),null==i&&o.log("current loaded is root data or null"),o.isCheckChildren&&(o.log("will check children "),o.isCheckChildren=!1,o.checkChildren(e,i,!0)),o.conf.onLoadAfter&&o.conf.onLoadAfter(t,e,i,n),0<o.setting.selectedNodes.length&&o.notLoaded&&(o.log(o.setting.selectedNodes),o.notLoaded=!1,o._loadselectedNodes()),
(0<o.nodes.length||0<o.setting.inputNodes.length)&&o.checkInputNodes(n)}},_onAsyncError:function(s){return function(t,e,i,n,o,a){s.log("_onAsyncError"),s.conf.onLoadError?s.conf.onLoadError(t,e,i,n,o,a):PJF.configuration.ajaxFailure()}},_dataFilter:function(d){return function(t,e,i){if(d.log("_dataFilter"),i.BK_STATUS&&i.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS)return d._showError(i),[];if(d.newMode){var n=[];if("A0651C003-pjf"==d.treeObj.setting.async.otherParam.transaction_id){if(i.CCBINST_INF)(a={}).nodeId=i.CCBINST_INF.CCBIns_ID,a.parentId="",a.ccbinsTpcd=i.CCBINST_INF.CCBIns_TpCd||"",a.instLdgrHierCd=i.CCBINST_INF.Inst_Ldgr_Hier_Cd||"",a.isParent=!0,a.open=!1,a.iconSkin="orgTree_org",a.type="org",a.instSvrlLgPsnID=i.CCBINST_INF.Inst_SvrlLgPsn_ID||"",a.instSvrlLgPsnNm=i.CCBINST_INF.Inst_SvrlLgPsn_Nm||"",
"zh-cn"==CLIENT_LANGUAGE?a.text=i.CCBINST_INF.CCBIns_Chn_ShrtNm:"en-us"==CLIENT_LANGUAGE&&(a.text=i.CCBINST_INF.CCBIns_Eng_ShrtNm?i.CCBINST_INF.CCBIns_Eng_ShrtNm:i.CCBINST_INF.CCBIns_Chn_ShrtNm),n.push(a);i=n}else if("A0651S034-pjf"==d.treeObj.setting.async.otherParam.transaction_id||"A0651S015-pjf"==d.treeObj.setting.async.otherParam.transaction_id){if(1<i.INST_C_GRP.length||null!=i.INST_C_GRP[0])for(var o in i.INST_C_GRP){var a;(a={}).nodeId=i.INST_C_GRP[o].Scdy_CCBIns_ID,a.parentId=i.Prim_CCBIns_ID,a.ccbinsTpcd=i.INST_C_GRP[o].CCBIns_TpCd,a.instLdgrHierCd=i.INST_C_GRP[o].Inst_Ldgr_Hier_Cd,a.isParent=!0,a.open=!1,a.instSvrlLgPsnID=i.Inst_SvrlLgPsn_ID||"",a.instSvrlLgPsnNm=i.Inst_SvrlLgPsn_Nm||"","zh-cn"==CLIENT_LANGUAGE?a.text=i.INST_C_GRP[o].LwLvCCBInsChnSht_Nm:"en-us"==CLIENT_LANGUAGE&&(a.text=i.INST_C_GRP[o].LwLvCCBIns_EngShtNm?i.INST_C_GRP[o].LwLvCCBIns_EngShtNm:i.INST_C_GRP[o].LwLvCCBInsChnSht_Nm),n.push(a)}i=n}}if(d.showRoot){if(e&&(d.requestCount=e.level,
d.depth==d.requestCount&&i))for(o=0;o<i.length;o++)i[o].isParent=!1}else if(e){if(d.requestCount=e.level+1,d.depth==d.requestCount&&i)for(o=0;o<i.length;o++)i[o].isParent=!1}else if(0==d.depth&&i)for(o=0;o<i.length;o++)i[o].isParent=!1;var s=[];try{if("asc"==d.order)for(o=0;o<i.length;o++)for(var r=i.length-1;o<=r;r--)0!=r&&parseInt(i[r-1].nodeId,10)>parseInt(i[r].nodeId,10)&&(s=i[r-1],i[r-1]=i[r],i[r]=s);else for(o=0;o<i.length;o++)for(r=i.length-1;o<=r;r--)0!=r&&parseInt(i[r-1].nodeId,10)<parseInt(i[r].nodeId,10)&&(s=i[r-1],i[r-1]=i[r],i[r]=s)}catch(l){alert("机构树节点nodeId有问题!"),alert(l.message)}if(d.conf.dataFilter){var c=d.conf.dataFilter(t,e,i);return void 0!==c?c:i}return i}},_loadselectedNodes:function(){this.log("_loadselectedNodes");var o=this,a=[];!function(t,e){for(var i in t)e[i]=t[i]}(o.setting.selectedNodes,a);var s=setInterval(function(){var t=a;0==t.length&&(o.log("clear loadNodeInterval"),clearInterval(s));var e=null,i=null
;for(var n in t)(e=t[n]).isParent?(i=o.treeObj.getNodeByParam("nodeId",e.nodeId+""))&&(o.reLoadChildNodes(i,"refresh",!1,!1),t.splice(n,1)):t.splice(n,1)},300),r=setInterval(function(){o.log("_checkSelectedNodes setInterval");var t=o.bakSelectedNodes;if(0==t.length)return o.log("clear checkNodeInterval"),void clearInterval(r);var e=null,i=null;for(var n in t)(i=t[n]).checked?(e=o.treeObj.getNodeByParam("nodeId",i.nodeId+""))&&(o.checkNode(e,!1),o.bakSelectedNodes.splice(n,1)):o.bakSelectedNodes.splice(n,1)},300)},_beforeExpand:function(n){return function(t,e){n.log("------_beforeExpand----------");var i=!0;return n.conf.beforeExpand&&(i=n.conf.beforeExpand(t,e),n.log("conf.beforeExpand return ---\x3e"+i),i=void 0===i||i,n.log("conf.beforeExpand final ---\x3e"+i)),i}},_beforeCheck:function(n){return function(t,e){
if(n.limitNum&&($("#"+e.tId).find("span :first").next().hasClass("checkbox_false_full_focus")||$("#"+e.tId).find("span :first").next().hasClass("checkbox_false_part_focus")||$("#"+e.tId).find("span :first").next().hasClass("checkbox_false_part")||$("#"+e.tId).find("span :first").next().hasClass("checkbox_false_full"))&&n.getCheckedNodes(!0).length==n.limitNum){if(n.preNodeObj=$("#"+e.tId),!(0<$("#"+t).find(".errorbox_ipt_help").length)){$("#"+e.tId).checkTip({show:function(){return!1},Message:resource.ORGTREE_BEFORECHECK_SELECTNUM+n.limitNum+resource.ORGTREE_BEFORECHECK_SELECTNUM}),$("#"+e.tId).removeClass("validatebox-invalid validatebox-tipcolor");setTimeout(function(){n.preNodeObj&&(n.preNodeObj.find(".errorbox_ipt_help").remove(),n.preNodeObj=null)},800)}return!1}n.log("----------before check-----------");var i=!0;return n.conf.beforeCheck&&(i=n.conf.beforeCheck(t,e)),i}},_onCheck:function(n){return function(t,e,i){n.log("----------_onCheck-----------"),
n.conf.onCheck&&n.conf.onCheck(t,e,i)}},destroy:function(){var t=this.com.parent();this.com.remove(),PJF.ui.componentMgr.remove(this.id),$(this.baseDomHTML).appendTo(t)},getClassName:function(){return"PJF.ui.orgTree"}}),PJF.apply(PJF.ui.orgTree.prototype,{validateParam:function(t){var e=document.getElementById(t.dom);return!(!t.dom||!e)||(alert(resource.ORGTREE_VALIDATEPARAM_INFO),!1)},_showError:function(t){if(t.BK_STATUS&&t.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS){var e=resource.ORGTREE_SHOWERROR_ERRCODE+t.BK_STATUS+"<BR/>"+resource.ORGTREE_SHOWERROR_ERRDESC+t.BK_DESC;new PJF.ui.messageBox({style:"warning",title:resource.ORGTREE_REQUEST_FAIL,content:e})}},updateRequestParam:function(t,e){if(this.newMode){var i=this.orgProdTypeCode;if(-1!=i.indexOf("ALL")){var n={Prim_CCBIns_ID:t||this.default_parent_code,CCBInsInrHierStcTp_Cd:i.substr(3)};PJF.communication.addParam(n),this.treeObj.setting.async.otherParam.jsonData=PJF.util.json2str(n),
this.treeObj.setting.async.otherParam.transaction_id=this.transId||"A0651S015-pjf"}else{n={Prim_CCBIns_ID:t||this.default_parent_code,CCBInsInrHierStcTp_Cd:i,Enqr_Cnd:this.type||"0"};PJF.communication.addParam(n),this.treeObj.setting.async.otherParam.jsonData=PJF.util.json2str(n),this.treeObj.setting.async.otherParam.transaction_id=this.transId||"A0651S034-pjf"}}else this.treeObj.setting.async.otherParam={parent_code:t||this.default_parent_code,type:this.type,orgProdTypeCode:this.orgProdTypeCode,_fw_service_id:e||this.default_fw_service_id}},reLoadChildNodes:function(t,e,i,n){if(!t)return this.treeObj.reAsyncChildNodes(t,e,void 0!==i&&i),void me.log("treeNode = null , will reload the root of tree!");t.isParent&&(this.updateRequestParam(t.nodeId),this.treeObj.reAsyncChildNodes(t,e,void 0!==i&&i),this.isCheckChildren=void 0===n||n)},checkChildren:function(t,e,i){if(this.log("checkChildren"),e&&e.isParent&&e.children){var n=this.getChildrenNodes(e);for(var o in i=void 0!==i?i:e.checked,
n)this.treeObj.checkNode(n[o],i,!0,!1)}},getCheckedNodes:function(t){return this.treeObj.getCheckedNodes(t)},getAllLoadedNodes:function(){return this.treeObj.transformToArray(this.treeObj.getNodes())},getSelectedNodes:function(){return this.treeObj.getSelectedNodes()},getNodeByNodeId:function(t){return this.treeObj.getNodeByParam("nodeId",t+"")},unCheckNode:function(t,e,i){this.treeObj.checkNode(t,!1,void 0===e||e,i)},checkNode:function(t,e,i){this.treeObj.checkNode(t,!0,void 0===e||e,i)},getParentNodes:function(t){var e=[];if(!t)return this._showError(resource.ORGTREE_GETPARENTNODES_PARMERR),e;if(e.unshift(t),"-1"==t.parentId)return this.log("node.parentId is -1 "),e;for(var i=t.getParentNode();i;)e.unshift(i),i=i.getParentNode();return e},getTransData:function(){var t=this.getCheckedNodes(),n={},e=[],o=[];function i(t){var e=null;for(var i in t)e=t[i],n[e.nodeId]||(n[e.nodeId]=!0,o.push(e))}for(var a in t)e=[],0<(e=this.getParentNodes(t[a])).length&&i(e)
;return this.log("finalNodes length = "+o.length),this.log(o),o},checkInputNodes:function(loadedNode){if(this.log("checkInputNodes"),loadedNode){try{loadedNode=eval("("+loadedNode+")")}catch(e){return void this.log("Error : eval loadedNode = "+loadedNode+"  error ! ")}var tmpNodeId="";for(var x in loadedNode)for(var n in this.bakInputNodes)tmpNodeId=this.bakInputNodes[n],loadedNode[x].nodeId==tmpNodeId&&this.checkNode(this.getNodeByNodeId(tmpNodeId))}else this.log("Function : checkInputNodes doLoadNode = "+loadedNode+"  return ! ")},expandNodeById:function(t,e,i,n,o){if(!t)return null;var a=this.getNodeByNodeId(t);return a&&a.isParent?this.expandNode(a,e,i,n,o):null},expandNode:function(t,e,i,n,o){return this.treeObj.expandNode(t,e,i,n,o)}}),PJF.ui.orgText=PJF.extend(PJF.ui.component,{_fw_service_id:"orgTextService",init:function(conf){this.copyComObj=this.com.clone(!1,!1).empty().insertAfter(this.com),this.copyComObj.attr("id",""),this.copyComObj.addClass("pjf_orgText")
;var buttonInputDom=conf.dom,buttonInputName=conf.deviceName,orgTreeSelectBtn=conf.textBt||resource.ORGTEXT_TEXTBT,winTitle=conf.winTitle,winWidth=conf.winWidth||550,winHeight=conf.winHeight||280,orgTreeUrl=conf.orgTreeUrl,parentCode=conf.parentCode,divId=buttonInputDom+"_div",inputId=conf.inputIdName||"input_txt_"+buttonInputDom,inputHiddenId=buttonInputDom,jq=this.com,me=this;me.orgTree=null,me.win=null,me.btnInput=null;var winDom=buttonInputDom+"_Win",winStr="<div id="+winDom+"> </div>";if(0<$("#"+winDom).length){var parentPanel=$("#"+winDom).parent();$("#"+winDom).hasClass("window-body")&&(parentPanel.next().next().hasClass("window-mask")&&parentPanel.next().next().remove(),parentPanel.next().hasClass("window-shadow")&&parentPanel.next().remove(),parentPanel.remove())}jq.append(winStr),$("<input/>",{type:"hidden",name:buttonInputDom,id:buttonInputDom}).appendTo(jq)
;var orgTreeDom=buttonInputDom+"_OrgTree",orgTreeStr="<div style ='display:none'><div  style='height:200px;overflow:auto;' id="+orgTreeDom+"> </div><div class='pjf_but_con'><div class='pjf_submit_con'><span id='btn_confirm_"+buttonInputDom+"'></span><span id='btn_cancel_"+buttonInputDom+"'></span></div></div></div>",orgTreeTwoBtn=$(orgTreeStr).appendTo(jq);this.com.css({"float":"left"}),jq.find(orgTreeDom)&&(me.orgTree=new PJF.ui.orgTree({dom:orgTreeDom,url:orgTreeUrl,parentCode:parentCode,showLog:!1,type:conf.type,orgProdTypeCode:conf.orgProdTypeCode,transId:conf.transId,showRoot:conf.showRoot,limitNum:conf.limitNum,depth:conf.depth,order:conf.order,checkType:conf.checkType,showCheckBox:conf.showCheckBox,inputNodes:conf.inputNodes,mutiple:conf.mutiple,radioType:conf.radioType,click:conf.orgTreeClick,beforeCheck:conf.beforeCheck,onCheck:conf.onCheck,onLoadBefore:conf.onLoadBefore,onLoadAfter:conf.onLoadAfter,dataFilter:conf.dataFilter,onLoadError:conf.onLoadError,
onCollapse:conf.onCollapse,beforeExpand:conf.beforeExpand}));var confirmBtn=new PJF.ui.linkButton({id:"btn_confirm_"+buttonInputDom,dom:"btn_confirm_"+buttonInputDom,name:resource.ORGTEXT_CONFIRMBTN,iconCls:"icon-confirm",onclick:function(){getCheckedNodes(me.orgTree),me.win.close(),conf.afterConfirm&&conf.afterConfirm(me.orgTree.getCheckedNodes()),0!=me.orgTree.getCheckedNodes(!0).length&&inputObj.checkTip({show:function(){return!0}})}}),cancelBtn=new PJF.ui.linkButton({id:"btn_cancel_"+buttonInputDom,dom:"btn_cancel_"+buttonInputDom,iconCls:"icon-cancel",name:resource.ORGTEXT_CANCELBTN,onclick:function(){me.win.close()}});null==me.btnInput&&(me.btnInput=new PJF.ui.buttonInput({dom:buttonInputDom,textBt:orgTreeSelectBtn,isRepeat:!0,onclick:function(){me.win?me.win.show():me.win=new PJF.ui.window({dom:winDom,title:winTitle,width:winWidth,height:winHeight,closeCacheData:!0,resizable:!1,content:orgTreeTwoBtn}),orgTreeTwoBtn.css("display","block")}})),
conf.disabled&&(me.btnInput.disable(),$("#"+inputId).removeClass("pjf_readonly_input"),$("#"+inputId).addClass("pjf_disabled_input"));var inputObj=jq.find("input:last");function getCheckedNodes(t){for(var e=t.getCheckedNodes(),i=e.length,n=[],o=[],a=0;a<i;a++)e[a].isParent,n.push(e[a].text),o.push(e[a].nodeId);PJF.html.getDom(inputId).value=n,PJF.html.getDom(inputHiddenId).value=o}if(inputObj.attr("readOnly",!0),inputObj.attr("readFlag","readonly"),conf.required&&inputObj.addClass("validatebox-invalid invalid_box"),jq.attr("id",divId),jq.closest("li").css({width:"auto"}),conf.inputIdName&&conf.inputIdName instanceof Array?(jq.find("input:last").attr("id",conf.inputIdName[0]),jq.find("input:last").attr("name",conf.inputIdName[1]),inputId=conf.inputIdName[0]):conf.inputIdName&&"string"==typeof conf.inputIdName&&(jq.find("input:last").attr("id",conf.inputIdName),jq.find("input:last").attr("name",conf.inputIdName)),
conf.inputNodes&&0<conf.inputNodes.length)for(var i in conf.inputNodes)null==conf.inputNodes[i]&&conf.inputNodes.splice(i,1);if(me.orgTree&&conf.inputNodes&&0<conf.inputNodes.length){var data={_fw_service_id:"orgTextService",nodeArr:conf.inputNodes};PJF.communication.ajax({url:conf.orgTreeUrl,data:data,success:function(data1){var respData=eval(data1);if(respData.BK_STATUS&&respData.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS)new PJF.ui.messageBox({title:resource.ORGTEXT_MESSAGERBOX_TITLE,style:"warning",content:respData.BK_STATUS+"-"+respData.BK_DESC});else{var names="",nodes="";if(respData instanceof Array)for(var i=0;i<respData.length;i++)respData[i].name&&respData[i].node&&(i!=respData.length-1?(names=names+respData[i].name+",",nodes=nodes+respData[i].node+","):(names+=respData[i].name,nodes+=respData[i].node));PJF.html.getDom(inputId).value=names,PJF.html.getDom(inputHiddenId).value=nodes}}})}inputObj.bind("blur.orgText",function(){conf.required&&(me.getContent()||inputObj.checkTip({
show:function(){return!1},Message:conf.invalidMessage}))})}}),PJF.apply(PJF.ui.orgText.prototype,{getParentNode:function(){var t=[];if(this.getValue()){var e=this.orgTree.getCheckedNodes();for(var i in e)t.push(e[i].getParentNode())}return t},clear:function(){this.com.find("input:first").val(""),this.com.find("input:last").val("").addClass("validatebox-invalid")},getContent:function(){return this.com.find("input:last").val()},getValue:function(){return this.com.find("input:first").val()},setContentValue:function(t,e){var i=e;this.orgTree.unCheckAllNodes(),this.orgTree.nodes=i,this.orgTree.bakInputNodes=i;var n=this.orgTree.getAllLoadedNodes();for(var o in i)for(var a in n)n[a].nodeId==i[o]&&this.orgTree.checkNode(n[a],!1);this.com.find("input:first").val(e.toString()),this.com.find("input:last").val(t.toString())},setContent:function(t){this.com.find("input:last").val(t)},setValue:function(t){return this.com.find("input:first").val(t)},destroy:function(){this.com.remove(),
this.win&&this.win.destroy(),this.copyComObj.attr("id",this.params.dom)},getClassName:function(){return"PJF.ui.orgText"},setReadOnly:function(t){t?(this.com.find("input:last").removeAttr("disabled"),this.btnInput.disable(),this.com.find("input:last").addClass("pjf_readonly_input")):(this.btnInput.enable(),this.com.find("input:last").removeClass("pjf_readonly_input"),this.com.find("input:last").removeClass("pjf_disabled_input"),this.com.find("input:last").removeAttr("disabled"))},enable:function(){this.com.find("input:last").removeClass("pjf_readonly_input"),this.com.find("input:last").removeClass("pjf_disabled_input"),this.com.find("input:last").removeAttr("disabled"),this.btnInput.enable()},disable:function(){this.btnInput.disable(),this.com.find("input:last").removeClass("pjf_readonly_input"),this.com.find("input:last").addClass("pjf_disabled_input")}}),PJF.ui.areaSelector=PJF.extend(PJF.ui.component,{init:function(t){this.options={dom:null,id:null,label:null,
provinceInputId:this.generateId(),provinceSpanId:this.generateId(),cityInputId:this.generateId(),citySpanId:this.generateId(),countyInputId:this.generateId(),countySpanId:this.generateId(),provinceName:null,provinceDefault:null,provinceId:this.generateId(),cityDefault:null,countyDefault:null,label:null,cityName:null,appId:null,clcd:null,cityId:this.generateId(),countyName:null,countyId:this.generateId(),detail:null,detailId:this.generateId(),detailName:null,isMouseLeave:!0,timeoutId:null,containerId1:this.generateId(),containerId2:this.generateId(),containerId3:this.generateId(),divId1:this.generateId(),divId2:this.generateId(),divId3:this.generateId(),nullOption:!1,isFilter:!1,showDatas:[],triggerKeyup:!1,selectIndex:-1,mainLabel:"",isShowSubLable:!0,autoSelect:PJF.constants.AREA_AUTOSELECT};var o=this;if($.extend(this.options,t),o.firstProvinceChange=!0,o.options.appId)o.options.nullOption?($("#"+o.options.provinceId).find("option:selected").removeAttr("selected"),
$("#"+o.options.provinceId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.provinceInputId).val(resource.AREA_NULL_LABEL),$("#"+o.options.provinceId).val("")):$("#"+o.options.provinceInputId).val($("#"+o.options.provinceId).find("option:selected").text()),o.options.cityName&&(o.options.nullOption&&($("#"+o.options.cityId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"/option>"),$("#"+o.options.cityInputId).val(resource.AREA_NULL_LABEL)),$("#"+o.options.provinceId).change(function(){var t=$(this).val();o.options.onProvinceChange instanceof Function&&!1===o.firstProvinceChange&&o.options.onProvinceChange(t),null!=t&&""!=t?($("#"+o.options.cityId).find("option").remove(),$("#"+o.options.cityInputId).val(""),$("#"+o.options.countyInputId).val(""),PJF.communication.getStandardCode({categoryId:"110256",appId:o.options.appId,clcd:t,async:!1,success:function(t){if($("#"+o.options.cityId).find("option").remove(),$("#"+o.options.cityInputId).val(""),
o.options.nullOption?($("#"+o.options.cityId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.cityInputId).val(resource.AREA_NULL_LABEL),$("#"+o.options.cityId).append(o.formatter1(t))):($("#"+o.options.cityId).append(o.formatter1(t)),$.isArray(t)&&0<t.length&&$("#"+o.options.cityInputId).val(t[0].itemName)),o.options.countyName){$("#"+o.options.countyId).find("option").remove(),$("#"+o.options.countyInputId).val(""),o.options.nullOption&&($("#"+o.options.countyId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL));var e=$("#"+o.options.cityId).val();e&&PJF.communication.getStandardCode({categoryId:"110256",appId:o.options.appId,clcd:e,async:!1,success:function(t){!o.options.nullOption&&0<t.length&&($("#"+o.options.countyId).append(o.formatter1(t)),$("#"+o.options.countyInputId).val(t[0].itemName))}})}},failure:function(){}})):($("#"+o.options.cityId).children().remove(),
$("#"+o.options.cityId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.cityInputId).val(resource.AREA_NULL_LABEL),o.options.countyName&&($("#"+o.options.countyId).children().remove(),$("#"+o.options.countyId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL)))})),o.options.countyName&&(o.options.nullOption&&($("#"+o.options.countyId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL)),$("#"+o.options.cityId).change(function(){var t=$(this).val();o.options.onCityChange instanceof Function&&o.options.onCityChange(t),t?($("#"+o.options.countyId).find("option").remove(),$("#"+o.options.countyInputId).val(""),o.options.nullOption&&($("#"+o.options.countyId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL)),
PJF.communication.getStandardCode({categoryId:"110256",appId:o.options.appId,clcd:t,async:!1,success:function(t){$("#"+o.options.countyId).append(o.formatter1(t)),!o.options.nullOption&&$.isArray(t)&&0<t.length&&$("#"+o.options.countyInputId).val(t[0].itemName)},failure:function(){}})):($("#"+o.options.countyId).find("option").remove(),$("#"+o.options.countyId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL))}),$("#"+o.options.countyId).change(function(){var t=$(this).val();o.options.onCountyChange instanceof Function&&o.options.onCountyChange(t)}));else{if(!$("#"+this.options.provinceId).is("select")){var e="";""!=this.options.mainLabel?(e+='<div class="pjf_label">'+this.options.mainLabel+"</div>",e+='<label class="pjf_areacitylabel">'+(this.options.isShowSubLable?resource.AREA_PROVINCE+"：":"")+"</label>",
e+='<input readonly="readonly" class="pjf_select validatebox-text pjf_areacity" '+(this.options.isShowSubLable?" ":'style="margin-left:0px;" ')+'id="'+this.options.provinceInputId+'"/><span class="pjf_span" id="'+this.options.provinceSpanId+'"></span><select style="display:none"  id="'+this.options.provinceId+'" name="'+this.options.provinceName+'"></select>'):(e+='<label class="pjf_label">'+(this.options.isShowSubLable?resource.AREA_PROVINCE+"：":"")+"</label>",e+='<input readonly="readonly" class="pjf_select validatebox-text pjf_areacity" style="margin-left:0px;" id="'+this.options.provinceInputId+'"/><span class="pjf_span" id="'+this.options.provinceSpanId+'"></span><select style="display:none"  id="'+this.options.provinceId+'" name="'+this.options.provinceName+'"></select>'),
this.options.cityName&&(e+='<div class="pjf_areacitylabel">'+(this.options.isShowSubLable?resource.AREA_CITY+"：":"")+'</div><input readonly="readonly" class="pjf_select validatebox-text pjf_areacity" id="'+this.options.cityInputId+'"/><span class="pjf_span" id="'+this.options.citySpanId+'"></span><select style="display:none" id="'+this.options.cityId+'"  name="'+this.options.cityName+'" ></select>'),this.options.countyName&&(e+='<div class="pjf_areacitylabel">'+(this.options.isShowSubLable?resource.AREA_COUNTY+"：":"")+'</div><input readonly="readonly" id="'+this.options.countyInputId+'" class="pjf_select validatebox-text pjf_areacity"/><span class="pjf_span" id="'+this.options.countySpanId+'"></span> <select style="display:none"  id="'+this.options.countyId+'"  name="'+this.options.countyName+'" ></select>'),
this.options.detail&&(e+='<div class="pjf_areacitylabel" style="width:auto;">'+(this.options.isShowSubLable?resource.AREA_DETAIL+"：":"")+'</div><input type="text" class="validatebox" style="border:1px solid #C5C5C5;'+(this.options.isShowSubLable?"":"margin-left:10px;")+(this.options.detailWidth?"width:"+this.options.detailWidth+"px;":"")+'" id="'+o.options.detailId+'"name="'+o.options.detailName+'"/>'),$("#"+this.options.dom).append(e),PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode=101573",type:"get",async:!1,dataType:"json",success:function(t){if($("#"+o.options.provinceId).find("option").remove(),$("#"+o.options.provinceId).append(o.formatter(t)),o.options.cityName){$("#"+o.options.cityId).find("option").remove();var n=t[0].name;PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+n,type:"get",async:!1,dataType:"json",success:function(t){
if(o.options.countyName)if(n!=PJF.constants.AREA_BEIJING||n!=PJF.constants.AREA_TIANJING||n!=PJF.constants.AREA_SHANGHAI||n!=PJF.constants.AREA_CHONGQING){$("#"+o.options.cityId).append(o.formatter(t));var e=t[0].name;PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+e,type:"get",dataType:"json",async:!1,success:function(t){$("#"+o.options.countyId).append(o.formatter(t))}})}else{$("#"+o.options.cityId).find("option").remove();var i=$("#"+o.options.provinceId).find("option[value="+n+"]").text();$("#"+o.options.cityId).append("<optoin value='"+n+"'>"+i+"</option>"),$("#"+o.options.countyId).append(o.formatter(t)),!0===o.options.autoSelect&&($("#"+o.options.cityInputId).val(i),$("#"+o.options.cityId).val(n))}else if(n!=PJF.constants.AREA_BEIJING&&n!=PJF.constants.AREA_TIANJING&&n!=PJF.constants.AREA_SHANGHAI&&n!=PJF.constants.AREA_CHONGQING)$("#"+o.options.cityId).append(o.formatter(t));else{$("#"+o.options.cityId).find("option").remove()
;i=$("#"+o.options.provinceId).find("option[value="+n+"]").text();$("#"+o.options.cityId).append("<optoin value='"+n+"'>"+i+"</option>"),$("#"+o.options.countyId).append(o.formatter(t)),!0===o.options.autoSelect&&($("#"+o.options.cityInputId).val(i),$("#"+o.options.cityId).val(n))}}})}},failure:function(){}})}o.options.nullOption?($("#"+o.options.provinceId).find("option:selected").removeAttr("selected"),$("#"+o.options.provinceId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.provinceInputId).val(resource.AREA_NULL_LABEL),$("#"+o.options.provinceId).val("")):$("#"+o.options.provinceInputId).val($("#"+o.options.provinceId).find("option:selected").text()),o.options.cityName&&(o.options.nullOption&&($("#"+o.options.cityId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.cityInputId).val(resource.AREA_NULL_LABEL)),$("#"+o.options.provinceId).change(function(){var n=$(this).val()
;o.options.onProvinceChange instanceof Function&&!1===o.firstProvinceChange&&o.options.onProvinceChange(n),null!=n&&""!=n?($("#"+o.options.cityId).find("option").remove(),$("#"+o.options.cityInputId).val(""),$("#"+o.options.countyInputId).val(""),PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+n,type:"get",async:!1,dataType:"json",success:function(t){if($("#"+o.options.cityId).find("option").remove(),o.options.nullOption&&($("#"+o.options.cityId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.cityInputId).val(resource.AREA_NULL_LABEL)),o.options.countyName)if($("#"+o.options.countyId).find("option").remove(),o.options.nullOption&&($("#"+o.options.countyId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL)),n==PJF.constants.AREA_BEIJING||n==PJF.constants.AREA_TIANJING||n==PJF.constants.AREA_SHANGHAI||n==PJF.constants.AREA_CHONGQING){
var e=$("#"+o.options.provinceId).find("option:selected").text();$("#"+o.options.cityId).append("<option value='"+n+"'>"+e+"</option>"),$("#"+o.options.countyId).append(o.formatter(t)),o.options.nullOption||$("#"+o.options.cityInputId).val(e),!0===o.options.autoSelect&&($("#"+o.options.cityInputId).val(e),$("#"+o.options.cityId).val(n)),$("#"+o.options.countyInputId).val($("#"+o.options.countyId).find("option:selected").text())}else{$("#"+o.options.cityId).append(o.formatter(t)),!o.options.nullOption&&0<t.length&&$("#"+o.options.cityInputId).val(t[0].desc);var i=$("#"+o.options.cityId).val();i&&PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+i,type:"get",async:!1,dataType:"json",success:function(t){!o.options.nullOption&&0<t.length&&($("#"+o.options.countyId).append(o.formatter(t)),$("#"+o.options.countyInputId).val(t[0].desc))}})
}else if(n!=PJF.constants.AREA_BEIJING&&n!=PJF.constants.AREA_TIANJING&&n!=PJF.constants.AREA_SHANGHAI&&n!=PJF.constants.AREA_CHONGQING)$("#"+o.options.cityId).append(o.formatter(t)),!o.options.nullOption&&0<t.length&&$("#"+o.options.cityInputId).val(t[0].desc);else{e=$("#"+o.options.provinceId).find("option:selected").text();$("#"+o.options.cityId).append("<option value='"+n+"'>"+e+"</option>"),o.options.nullOption&&($("#"+o.options.cityId).find("option:selected").removeAttr("selected"),$("#"+o.options.cityInputId).val(resource.AREA_NULL_LABEL)),!0===o.options.autoSelect&&($("#"+o.options.cityInputId).val(e),$("#"+o.options.cityId).val(n))}},failure:function(){}})):($("#"+o.options.cityId).children().remove(),$("#"+o.options.cityId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.cityInputId).val(resource.AREA_NULL_LABEL),o.options.countyName&&($("#"+o.options.countyId).children().remove(),
$("#"+o.options.countyId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL)))})),o.options.countyName&&(o.options.nullOption&&($("#"+o.options.countyId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL)),$("#"+o.options.cityId).change(function(){var t=$(this).val();o.options.onCityChange instanceof Function&&o.options.onCityChange(t),null!=t&&""!=t?($("#"+o.options.countyId).find("option").remove(),$("#"+o.options.countyInputId).val(""),o.options.nullOption&&($("#"+o.options.countyId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL)),PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+t,type:"get",dataType:"json",async:!1,success:function(t){$("#"+o.options.countyId).append(o.formatter(t)),
!o.options.nullOption&&0<t.length&&$.isArray(t)&&$("#"+o.options.countyInputId).val(t[0].desc)},failure:function(){}})):($("#"+o.options.countyId).find("option").remove(),$("#"+o.options.countyId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+o.options.countyInputId).val(resource.AREA_NULL_LABEL))}),$("#"+o.options.countyId).change(function(){var t=$(this).val();o.options.onCountyChange instanceof Function&&o.options.onCountyChange(t)}))}o.options.provinceName&&!o.options.cityName?($("#"+o.options.provinceInputId).removeClass("pjf_areaprovince").addClass("validatebox-text").attr("readonly","readonly"),$("#"+o.options.provinceSpanId).css("float","")):o.options.provinceName&&o.options.cityName&&!o.options.countyName?($("#"+o.options.provinceId).siblings("input").addClass("validatebox-text").css("width","56px").attr("readonly","readonly"),
$("#"+o.options.cityId).siblings("input").addClass("validatebox-text").css("width","56px").attr("readonly","readonly")):($("#"+o.options.provinceInputId).attr("readonly","readonly").removeClass("pjf_province").addClass("validatebox-text").addClass("pjf_province"),$("#"+o.options.cityInputId).attr("readonly","readonly").removeClass("pjf_areacity").addClass("validatebox-text").addClass("pjf_areacity"),$("#"+o.options.countyInputId).attr("readonly","readonly").removeClass("pjf_areacity").addClass("validatebox-text").addClass("pjf_areacity")),$("#"+o.options.provinceId).trigger("change"),this.options.provinceDefault&&($("#"+o.options.provinceId).val(o.options.provinceDefault),$("#"+o.options.provinceInputId).val($("#"+o.options.provinceId).find("option:selected").text()),$("#"+o.options.provinceId).trigger("change")),this.options.cityDefault&&($("#"+o.options.cityId).val(this.options.cityDefault),$("#"+o.options.cityInputId).val($("#"+this.options.cityId).find("option:selected").text()),
$("#"+o.options.cityId).trigger("change")),this.options.countyDefault&&($("#"+this.options.countyId).val(this.options.countyDefault),$("#"+this.options.countyInputId).val($("#"+this.options.countyId).find("option:selected").text())),$("#"+this.options.provinceSpanId).on("click",function(){o.addDiv(o.options.provinceId,o.options.provinceInputId,o.options.containerId1,o.options.divId1)}),this.hiddeDivEvent(o.options.provinceInputId,o.options.containerId1),o.options.cityName&&($("#"+this.options.citySpanId).on("click",function(){o.addDiv(o.options.cityId,o.options.cityInputId,o.options.containerId2,o.options.divId2)}),this.hiddeDivEvent(o.options.cityInputId,o.options.containerId2)),o.options.countyName&&($("#"+this.options.countySpanId).on("click",function(){o.addDiv(o.options.countyId,o.options.countyInputId,o.options.containerId3,o.options.divId3)}),this.hiddeDivEvent(o.options.countyInputId,o.options.containerId3)),
o.options.detail&&$("#"+o.options.detailId).addClass("validatebox-text").addClass(""),$.browser.msie&&$.browser.version<7&&o.options.countyName&&$("#"+o.options.provinceId).closest("li").css("width","auto"),(!0===o.options.isFilter||PJF.constants.KEYBOARD_ENABLE)&&o.keyBoardEnableFn(),this.bindBlurEvents(),o.firstProvinceChange=!1},keyBoardEnableFn:function(){var e=this,t=$("#"+e.options.provinceInputId),i=$("#"+e.options.cityInputId),n=$("#"+e.options.countyInputId);!0===e.options.isFilter&&(t.removeAttr("readonly"),i.removeAttr("readonly"),n.removeAttr("readonly")),t.keyup(function(t){e.divId=e.options.divId1,e.onBoardKeyPress(t,"province")}),i.keyup(function(t){e.divId=e.options.divId2,e.onBoardKeyPress(t,"city")}),n.keyup(function(t){e.divId=e.options.divId3,e.onBoardKeyPress(t,"county")})},onBoardKeyPress:function(t,e){var i=this;switch(t.keyCode){case 107:PJF.constants.KEYBOARD_ENABLE&&($("#"+i.options[e+"SpanId"]).trigger("click"),$("#"+i.divId).scrollTop(10).scrollTop(0));break
;case 13:if(PJF.constants.KEYBOARD_ENABLE){if(-1===i.options.selectIndex)return;if((c=$("#"+i.divId)).length&&"block"==c.css("display")){var n=c.find("li").eq(i.options.selectIndex),o=$("#"+i.options[e+"Id"]),a=o.val(),s=n.attr("value"),r=n.text();$("#"+i.options[e+"InputId"]).val(r),o.val(s),a!=s&&o.trigger("change"),c.css("display","none")}}break;case 38:if(PJF.constants.KEYBOARD_ENABLE)(c=$("#"+i.divId)).length&&"block"==c.css("display")&&i.moveUp();break;case 40:var c;if(PJF.constants.KEYBOARD_ENABLE)(c=$("#"+i.divId)).length&&"block"==c.css("display")&&i.moveDown();break;default:!0===i.options.isFilter&&i.onKeyPress(t,e)}},scrollPosition:function(t){var e=$("#"+this.divId);e.scrollLeft(1);var i=e.scrollLeft();e.scrollLeft(0);var n=e.height()-(0<i?17:0),o=parseInt(e.scrollTop()/27),a=parseInt(n/27);if(this.options.selectIndex+1<=o+1||this.options.selectIndex+1>o+a){var s=0;"up"==t&&(s=27*this.options.selectIndex),"down"==t&&(s=27-n%27+27*(this.options.selectIndex-a)),e.scrollTop(s)
}},moveUp:function(){var t=$("#"+this.divId);0!=this.options.selectIndex&&(this.options.selectIndex-=1),t.find("li").eq(this.options.selectIndex).addClass("selected"),t.find("li").eq(this.options.selectIndex+1).removeClass("selected"),this.scrollPosition("up")},moveDown:function(){var t=$("#"+this.divId),e=t.find("li").length;this.options.selectIndex<e-1&&(this.options.selectIndex!=e-1&&(this.options.selectIndex+=1),t.find("li").eq(this.options.selectIndex).addClass("selected"),t.find("li").eq(this.options.selectIndex-1).removeClass("selected")),this.scrollPosition("down")},filter:function(){var e=this,t=$("#"+e.options.provinceInputId),i=$("#"+e.options.cityInputId),n=$("#"+e.options.countyInputId);t.removeAttr("readonly"),i.removeAttr("readonly"),n.removeAttr("readonly");$("#"+e.options.divId1),$("#"+e.options.divId2),$("#"+e.options.divId3);t.keyup(function(t){e.div=$("#"+e.options.divId1),e.onKeyPress(t,"province")}),i.keyup(function(t){e.div=$("#"+e.options.divId2),
e.onKeyPress(t,"city")}),n.keyup(function(t){e.div=$("#"+e.options.divId3),e.onKeyPress(t,"county")})},bindBlurEvents:function(){if(this.options.isFilter){var t=this;$("#"+this.options.provinceInputId).on("blur",function(){$(this).val($("#"+t.options.provinceId).find(":selected").text())}),$("#"+this.options.cityInputId).on("blur",function(){$(this).val($("#"+t.options.cityId).find(":selected").text())}),$("#"+this.options.countyInputId).on("blur",function(){$(this).val($("#"+t.options.countyId).find(":selected").text())})}},onKeyPress:function(t,e){var i=$("#"+this.options[e+"InputId"]).val().trim(),n=$("#"+this.options[e+"Id"]),o=$("#"+this.divId),a=!0,s=[],r=[];if(this.options.triggerKeyup=!0,$("#"+this.options[e+"Id"]).find("option").each(function(){var t={};t.value=$(this).val(),t.text=$(this).text(),s.push(t)}),""==i)r=s;else for(var c=i.split(""),l=PJF.util.getPinyinDict(),d=0;d<s.length;d++){if(i==s[d].text){a=!1,o.css("display","none"),n.val(s[d].value),
this[e+"PreVal"]!==i&&n.trigger("change");break}for(var u="",h=0;h<s[d].text.length;h++)u+=s[d].text.charAt(h)+(l[s[d].text.charAt(h)]||"");for(var p=0;p<c.length;p++){var f=u.indexOf(c[p],s[d].lastIndex?s[d].lastIndex+1:0);if(f<0)break;s[d].lastIndex=f}p==c.length&&(delete s[d].lastIndex,r.push(s[d]))}this.options.showDatas=r,this[e+"PreVal"]=i,!0===a&&$("#"+this.options[e+"SpanId"]).trigger("click"),this.options.triggerKeyup=!1},hiddeDivEvent:function(t,e){var i=this;$("#"+t).bind("blur",function(){i.options.timeoutId=setTimeout(function(){i.options.isMouseLeave&&$("#"+e).remove()},500)})},addDiv:function(s,r,t,e){this.options.selectIndex=-1;var i=this,n=$("#"+r).offset(),o=$("#"+r).attr("disabled"),a=$("#"+r).hasClass("pjf_readonly_input");if(!o&&!a){i.options.timeoutId&&(window.clearTimeout(i.options.timeoutId),i.options.timeoutId=null),$("#"+r).focus(),$("#"+t).remove(),
$('<div id="'+t+'" style="position:absolute;z-index:9999;"><div class="autocomplete-w1"><ul class="autocomplete1" style="display:none" id="'+e+'" ></ul></div></div>').appendTo("body");var c="";if(!0===i.options.isFilter&&!0===i.options.triggerKeyup)for(var l=i.options.showDatas,d=0;d<l.length;d++)c+="<li value='"+l[d].value+"'>"+l[d].text+"</li>";else $("#"+s).find("option").each(function(){var t=$(this),e=t.val(),i=t.text();c+="<li value='"+e+"'>"+i+"</li>"});$("#"+e).append(c),width=$("#"+r).width()+21,$("#"+e).css("width",width+"px"),$("#"+e).unbind("mouseover").bind("mouseover",function(t){var e=t.target;i.options.isMouseLeave=!1,"li"==e.nodeName.toLowerCase()&&$(e).addClass("selected")}).unbind("mouseout").bind("mouseout",function(t){var e=t.target;"li"==e.nodeName.toLowerCase()&&$(e).removeClass("selected")}).bind("mouseleave",function(t){i.options.isMouseLeave=!1,$(this).css("display","none"),i.options.isMouseLeave=!0}).bind("click",function(t){var e=t.target
;if("li"==e.nodeName.toLowerCase()){var i=$(e),n=$("#"+s).val(),o=i.attr("value"),a=i.text();$("#"+r).val(a),$("#"+s).val(o),n!=o&&$("#"+s).trigger("change"),$(this).css("display","none")}}),$("#"+e).css("display","block"),350<$("#"+e).height()&&$("#"+e).css("max-height","350px"),$("#"+t).css("top",n.top+$("#"+r).innerHeight()+"px"),$("#"+t).css("left",n.left+"px")}},formatter:function(t){var e="";for(var i in t)e+="<option value='"+t[i].name+"'>"+t[i].desc+"</option>";return e},formatter1:function(t){var e="";for(var i in t)e+="<option value='"+t[i].itemValue+"'>"+t[i].itemName+"</option>";return e},getProvinceText:function(){return $("#"+this.options.provinceId).find("option:selected").text()},disable:function(){$("#"+this.options.provinceInputId).attr("disabled","disabled").addClass("pjf_disabled_input"),$("#"+this.options.cityInputId).attr("disabled","disabled").addClass("pjf_disabled_input"),
$("#"+this.options.countyInputId).attr("disabled","disabled").addClass("pjf_disabled_input"),$("#"+this.options.detailId).attr("disabled","disabled").addClass("pjf_disabled_input")},enable:function(){$("#"+this.options.provinceInputId).removeAttr("disabled","disabled").removeClass("pjf_disabled_input"),$("#"+this.options.cityInputId).removeAttr("disabled","disabled").removeClass("pjf_disabled_input"),$("#"+this.options.countyInputId).removeAttr("disabled","disabled").removeClass("pjf_disabled_input"),$("#"+this.options.detailId).removeAttr("disabled","disabled").removeClass("pjf_disabled_input")},setReadOnly:function(t){t?($("#"+this.options.provinceInputId).addClass("pjf_readonly_input"),$("#"+this.options.cityInputId).addClass("pjf_readonly_input"),$("#"+this.options.countyInputId).addClass("pjf_readonly_input"),$("#"+this.options.detailId).addClass("pjf_readonly_input")):($("#"+this.options.provinceInputId).removeClass("pjf_readonly_input"),
$("#"+this.options.cityInputId).removeClass("pjf_readonly_input"),$("#"+this.options.countyInputId).removeClass("pjf_readonly_input"),$("#"+this.options.detailId).removeClass("pjf_readonly_input"))},getProvinceValue:function(){return $("#"+this.options.provinceId).val()},setProvinceValue:function(t){$("#"+this.options.provinceId).val(t),$("#"+this.options.provinceInputId).val($("#"+this.options.provinceId).find("option:selected").text()),$("#"+this.options.provinceId).trigger("change")},setCityValue:function(i){var n=this,e=$("#"+n.options.provinceId).val(),o=$("#"+n.options.provinceInputId).val();$("#"+n.options.cityId).find("option").remove(),$("#"+n.options.cityInputId).val("");var t=i.substring(0,2);"11"!=t&&"12"!=t&&"31"!=t&&"50"!=t||(i=t+"0000"),e&&(n.options.appId?PJF.communication.getStandardCode({categoryId:"110256",appId:n.options.appId,async:!1,clcd:e,success:function(t){if($("#"+n.options.cityId).append(n.formatter1(t)),$("#"+n.options.cityId).val(i),
$.isArray(t)&&0<t.length)for(var e=0;e<t.length;e++)t[e].itemValue==i&&$("#"+n.options.cityInputId).val(t[e].itemName);n.options.countyName&&PJF.communication.getStandardCode({categoryId:"110256",appId:n.options.appId,clcd:i,async:!1,success:function(t){$("#"+n.options.countyId).find("option").remove(),$("#"+n.options.countyId).append(n.formatter1(t)),n.options.nullOption?($("#"+n.options.countyId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+n.options.countyInputId).val(resource.AREA_NULL_LABEL)):$.isArray(t)&&0<t.length&&($("#"+n.options.countyId).val(t[0].itemValue),$("#"+n.options.countyInputId).val(t[0].itemName))},failure:function(){}})},failure:function(){}}):PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+e,type:"get",async:!1,dataType:"json",success:function(t){$("#"+n.options.cityId).find("option").remove(),n.options.countyName?($("#"+n.options.countyId).find("option").remove(),
$("#"+n.options.countyInputId).val(""),e==PJF.constants.AREA_BEIJING||e==PJF.constants.AREA_TIANJING||e==PJF.constants.AREA_SHANGHAI||e==PJF.constants.AREA_CHONGQING?($("#"+n.options.cityId).children().remove(),$("#"+n.options.cityId).append("<option value='"+e+"'>"+o+"</option>"),$("#"+n.options.cityInputId).val(o),$("#"+n.options.countyId).append(n.formatter(t)),$("#"+n.options.countyInputId).val(t[0].desc)):($("#"+n.options.cityId).append(n.formatter(t)),$("#"+n.options.cityId).val(i),$("#"+n.options.cityInputId).val($("#"+n.options.cityId).find("option:selected").text()),PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+i,type:"get",async:!1,dataType:"json",success:function(t){0<t.length&&($("#"+n.options.countyId).append(n.formatter(t)),$("#"+n.options.countyInputId).val(t[0].desc))}
}))):e==PJF.constants.AREA_BEIJING||e==PJF.constants.AREA_TIANJING||e==PJF.constants.AREA_SHANGHAI||e==PJF.constants.AREA_CHONGQING?($("#"+n.options.cityId).append("<option value='"+e+"'>"+o+"</option>"),$("#"+n.options.cityInputId).val(o)):($("#"+n.options.cityId).append(n.formatter(t)),$("#"+n.options.cityId).val(i),$("#"+n.options.cityInputId).val($("#"+n.options.cityId).find("option:selected").text()),$("#"+n.options.cityId).trigger("change"))},failure:function(){}})),$("#"+this.options.cityId).trigger("change")},setCountyValue:function(i){var n=this,t=$("#"+n.options.cityId).val();n.options.appId?PJF.communication.getStandardCode({categoryId:"110256",appId:n.options.appId,clcd:t,async:!1,success:function(t){$("#"+n.options.countyId+" option").remove(),n.options.nullOption&&$("#"+n.options.countyId).prepend("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+n.options.countyId).append(n.formatter1(t)),$("#"+n.options.countyId).val(i)
;for(var e=0;e<t.length;e++)t[e].itemValue==i&&$("#"+n.options.countyInputId).val(t[e].itemName)},failure:function(){}}):PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+t,type:"get",dataType:"json",async:!1,success:function(t){$("#"+n.options.countyId).find("option").remove(),n.options.nullOption&&$("#"+n.options.countyId).append("<option value=''>"+resource.AREA_NULL_LABEL+"</option>"),$("#"+n.options.countyId).append(n.formatter(t)),$("#"+n.options.countyId).val(i),$("#"+n.options.countyInputId).val($("#"+n.options.countyId).find("option:selected").text())}}),$("#"+this.options.countyId).trigger("change")},getCityText:function(){return $("#"+this.options.cityId).find("option:selected").text()},getCityValue:function(){return $("#"+this.options.cityId).val()},getCountyText:function(){if(this.options.countyName)return $("#"+this.options.countyId).find("option:selected").text()},getCountyValue:function(){
if(this.options.countyName)return $("#"+this.options.countyId).val()},getClassName:function(){return"PJF.ui.areaSelector"},getDetailValue:function(){return $("#"+this.options.detailId).val()},setDetailValue:function(t){$("#"+this.options.detailId).val(t)},bindProvinceEvent:function(t,e){$("#"+this.options.provinceId).unbind("province"+t).bind(t+".province"+t,e)},bindCityEvent:function(t,e){$("#"+this.options.cityId).unbind("city"+t).bind(t+".city"+t,e)},bindCountyEvent:function(t,e){$("#"+this.options.countyId).unbind("county"+t).bind(t+".county"+t,e)},clear:function(){$("#"+this.options.provinceId).val(""),$("#"+this.options.cityId).val(""),$("#"+this.options.countyId).val(""),$("#"+this.options.provinceInputId).val(""),$("#"+this.options.cityInputId).val(""),$("#"+this.options.countyInputId).val("")},destroy:function(){$("#"+this.options.containerId1).remove(),$("#"+this.options.containerId2).remove(),$("#"+this.options.containerId3).remove(),
$("#"+this.options.provinceSpanId).off("click"),$("#"+this.options.provinceId).off("change"),$("#"+this.options.cityId).off("change"),$("#"+this.options.provinceId).siblings().remove(),$("#"+this.options.provinceId).remove(),$("#"+this.options.countyId).off("change"),$("#"+this.options.citySpanId).off("click"),$("#"+this.options.countySpanId).off("click"),$("#"+this.options.provinceInputId).off("blur"),$("#"+this.options.cityInputId).off("blur"),$("#"+this.options.countyInputId).off("blur"),this.options.cityInputId=null,this.options.countyInputId=null,this.options.provinceInputId=null,this.options.cityId=null,this.options.provinceId=null,this.options.countyId=null,this.options.citySpanId=null,this.options.provinceSpanId=null,this.options.countySpanId=null,this.options.containerId1=null,this.options.containerId2=null,this.options.containerId3=null,this.com=null,this.id=null},newDestroy:function(){PJF.ui.componentMgr.remove(this.id),this.destroy()},setValue:function(t){if(6==t.length){
var e=t.substring(0,2)+"0000";this.setProvinceValue(e);var i=t.substring(0,4)+"00";if(this.options.cityName)0<$("#"+this.options.cityId).find("option[value='"+t+"']").length?this.setCityValue(t):this.setCityValue(i);this.options.countyName&&this.setCountyValue(t)}else this.setProvinceValue("")}}),PJF.apply(PJF.ui.areaSelector.prototype,{validateParam:function(t){return!0}}),PJF.ui.standerdCodeTree=PJF.extend(PJF.ui.tree,{dom:null,conf:null,isCheckChildren:!1,default_fw_service_id:"fetchStanderdCodeModelListByParams",jsonClass:"com.ccb.model.StandardDataCategory",notLoaded:!0,hasData:!1,bakSelectedNodes:[],bakInputNodes:[],init:function(t){if(this.jsonData={},this.jsonData.categoryId=t.categoryId,this.jsonData.appId=t.appId,this.jsonData.clcd=t.clcd,this.jsonData.sorted=t.sorted||!1,this.dom=t.dom,"ztree"!=this.com.attr("class")&&this.com.attr("class","ztree"),this.initConf(t),this.setting=$.extend({},t,{treeType:1,otherParam:{_fw_service_id:t.fwServiceId||this.default_fw_service_id,
jsonData:PJF.util.json2str($.extend({},this.jsonData,t.jsonData)),jsonClass:t.jsonClass||this.jsonClass},selectedNodes:t.selectedNodes||[],inputNodes:t.inputNodes||[],isRemoteData:"undefined"==typeof t.isRemoteData||t.isRemoteData,check:"undefined"==typeof t.showCheckBox||t.showCheckBox,edit:!1,remove:!1,isMove:!1,checkType:t.checkType||{Y:"s",N:"s"},chkStyle:0==t.mutiple?"radio":"checkbox",radioType:t.radioType||"all",beforeAsync:this._beforeAsync(this),onAsyncSuccess:this._onAsyncSuccess(this),onAsyncError:this._onAsyncError(this),beforeExpand:this._beforeExpand(this),beforeCheck:this._beforeCheck(this),onCheck:this._onCheck(this),dataFilter:this._dataFilter(this)}),t.selectedNodes&&0<t.selectedNodes.length)for(var e in t.selectedNodes)this.bakSelectedNodes[e]=t.selectedNodes[e];if(t.inputNodes&&0<t.inputNodes.length)for(var e in t.inputNodes)this.bakInputNodes[e]=t.inputNodes[e];this.pjfTree=new PJF.ui.tree(this.setting),
this.treeObj=$.fn.zTree.getZTreeObj(this.com.children(":first").attr("id"))},log:function(t,e){if(this.conf.showLog)if(e)console.log(t);else if("string"!=typeof t)for(var i in console.log("type ---\x3e "+typeof t),console.log(t),t)console.log(t[i]);else console.log("-----------"+t+"-------------")},initConf:function(t){this.conf=$.extend({},t,{showLog:"undefined"!=typeof t.showLog&&t.showLog})},_beforeAsync:function(n){return function(t,e){n.log("_beforeAsync");var i=!0;return n.conf.onLoadBefore&&(i=n.conf.onLoadBefore(t,e,"_beforeAsync"),n.log("conf.onLoadBefore return ---\x3e"+i),i=void 0===i||i,n.log("conf.onLoadBefore final ---\x3e"+i)),i&&null!=e&&n.updateRequestParam(e.itemValue,e.categoryId),e&&(n.treeObj.setting.view.NoExpand=!i),n.log("_beforeAsync return "+i),i}},_onAsyncSuccess:function(o){return function(t,e,i,n){o.log("_onAsyncSuccess"),o.log("_onAsyncSuccess  ---\x3e"+n),null==i&&o.log("current loaded is root data or null"),
o.isCheckChildren&&(o.log("will check children "),o.isCheckChildren=!1,o.checkChildren(e,i,!0)),o.conf.onLoadAfter&&o.conf.onLoadAfter(t,e,i,n),0<o.setting.selectedNodes.length&&o.notLoaded&&(o.log(o.setting.selectedNodes),o.notLoaded=!1,o._loadselectedNodes()),0<o.setting.inputNodes.length&&o.checkInputNodes(n)}},_onAsyncError:function(s){return function(t,e,i,n,o,a){s.log("_onAsyncError"),s.conf.onLoadError?s.conf.onLoadError(t,e,i,n,o,a):PJF.configuration.ajaxFailure()}},_dataFilter:function(a){return function(t,e,i){if(a.log("_dataFilter"),i.BK_CODE&&i.BK_CODE!=PJF.constants.BK_CODE_SUCCESS)return a._showError(i),[];if(a.conf.dataFilter){for(var n=0;n<i.length;n++)"undefined"==typeof i[n].isParent&&(i[n].isParent=!0);var o=a.conf.dataFilter(t,e,i);return void 0!==o?o:i}return i}},_loadselectedNodes:function(){this.log("_loadselectedNodes");var o=this,a=setInterval(function(){var t=o.setting.selectedNodes;0==t.length&&(o.log("clear loadNodeInterval"),clearInterval(a))
;var e=null,i=null;for(var n in t)(e=t[n]).isParent?(i=o.treeObj.getNodeByParam("nodeId",e.nodeId+""))&&(o.reLoadChildNodes(i,"refresh",!1,!1),t.splice(n,1)):t.splice(n,1)},300),s=setInterval(function(){o.log("_checkSelectedNodes setInterval");var t=o.bakSelectedNodes;if(0==t.length)return o.log("clear checkNodeInterval"),void clearInterval(s);var e=null,i=null;for(var n in t)(i=t[n]).checked?(e=o.treeObj.getNodeByParam("nodeId",i.nodeId+""))&&(o.checkNode(e,!1),o.bakSelectedNodes.splice(n,1)):o.bakSelectedNodes.splice(n,1)},300)},_beforeExpand:function(n){return function(t,e){n.log("------_beforeExpand----------");var i=!0;return n.conf.beforeExpand&&(i=n.conf.beforeExpand(t,e),n.log("conf.beforeExpand return ---\x3e"+i),i=void 0===i||i,n.log("conf.beforeExpand final ---\x3e"+i)),i}},_beforeCheck:function(n){return function(t,e){n.log("----------before check-----------");var i=!0;return n.conf.beforeCheck&&(i=n.conf.beforeCheck(t,e)),i}},_onCheck:function(n){return function(t,e,i){
n.log("----------_onCheck-----------"),n.conf.onCheck&&n.conf.onCheck(t,e,i)}}}),PJF.apply(PJF.ui.standerdCodeTree.prototype,{validateParam:function(t){var e=document.getElementById(t.dom);return!(!t.dom||!e)||(alert(resource.STANDERDCODETREE_VALIDATEPARAM_INFO),!1)},_showError:function(t){if(t.BK_CODE&&t.BK_CODE!=PJF.constants.BK_CODE_SUCCESS){var e=resource.ORGTREE_SHOWERROR_ERRCODE+t.BK_CODE+"<BR/>"+resource.ORGTREE_SHOWERROR_ERRDESC+t.BK_DESC;new PJF.ui.messageBox({style:"warning",title:resource.ORGTREE_REQUEST_FAIL,content:e})}},updateRequestParam:function(t,e){this.jsonData.clcd=t,this.jsonData.categoryId=e,this.treeObj.setting.async.otherParam={_fw_service_id:this.conf.fwServiceId||this.default_fw_service_id,jsonData:PJF.util.json2str(this.jsonData),jsonClass:this.conf.jsonClass||this.jsonClass}},reLoadChildNodes:function(t,e,i,n){t.isParent&&(this.updateRequestParam(t.nodeId),this.treeObj.reAsyncChildNodes(t,e,void 0!==i&&i),this.isCheckChildren=void 0===n||n)},
checkChildren:function(t,e,i){if(this.log("checkChildren"),e&&e.isParent&&e.children){var n=this.getChildrenNodes(e);for(var o in i=void 0!==i?i:e.checked,n)this.treeObj.checkNode(n[o],i,!0,!1)}},getCheckedNodes:function(t){return this.treeObj.getCheckedNodes(t)},getAllLoadedNodes:function(){return this.treeObj.transformToArray(this.treeObj.getNodes())},getSelectedNodes:function(){return this.treeObj.getSelectedNodes()},getNodeByNodeId:function(t){return this.treeObj.getNodeByParam("nodeId",t+"")},getNodeByParam:function(t,e){return this.treeObj.getNodeByParam(t,e+"")},unCheckNode:function(t,e,i){this.treeObj.checkNode(t,!1,void 0===e||e,i)},checkNode:function(t,e,i){this.treeObj.checkNode(t,!0,void 0===e||e,i)},getParentNodes:function(t){var e=[];if(!t)return this._showError(resource.ORGTREE_GETPARENTNODES_PARMERR),e;if(e.unshift(t),"-1"==t.parentId)return this.log("node.parentId is -1 "),e;for(var i=t.getParentNode();i;)e.unshift(i),i=i.getParentNode();return e},
getTransData:function(){var t=this.getCheckedNodes(),n={},e=[],o=[];function i(t){var e=null;for(var i in t)e=t[i],n[e.nodeId]||(n[e.nodeId]=!0,o.push(e))}for(var a in t)e=[],0<(e=this.getParentNodes(t[a])).length&&i(e);return this.log("finalNodes length = "+o.length),this.log(o),o},checkInputNodes:function(loadedNode){this.log("checkInputNodes");var loadedNode=eval("("+loadedNode+")"),tmpNodeId="";for(var x in loadedNode)for(var n in this.bakInputNodes)tmpNodeId=this.bakInputNodes[n],loadedNode[x].nodeId==tmpNodeId&&this.checkNode(this.getNodeByNodeId(tmpNodeId))},getTree:function(){return this.pjfTree}}),PJF.ui.selectionBox=PJF.extend(PJF.ui.component,{init:function(e){var i=this;if(!e||!e.url)return this.com.selectionBox(e);e.success=function(t){return e.leftData=t.leftData,e.rightData=t.rightData,i.com.selectionBox(e)},e.data=e.param,PJF.communication.ajax(e)},getValue:function(t){return t?this.com.selectionBox("getValue",t):this.com.selectionBox("getValue")},getObject:function(t){
return this.com.selectionBox("getObject",t)},refresh:function(e){var i=this;if(null!=e){var n=e.target,t=e.url;if(null!=t&&""!=t){e.success=function(t){return e.data=t.data,i.com.selectionBox("refresh",n,e.data)},e.data=e.param,PJF.communication.ajax(e)}else{var o=e.data;this.com.selectionBox("refresh",n,o)}}},destroy:function(){this.com.selectionBox("destroy"),PJF.ui.componentMgr.remove(this.id)},getClassName:function(){return"PJF.ui.selectionBox"},setMovable:function(t,e,i){this.com.selectionBox("setMovable",t,e,i)},disable:function(){this.com.find("input").each(function(){$(this).attr("disabled","disabled").addClass("pjf_disabled_input")})},enable:function(){this.com.find("input").each(function(){$(this).removeAttr("disabled","disabled").removeClass("pjf_disabled_input")})}}),PJF.ui.empTree=PJF.extend(PJF.ui.tree,{dom:null,conf:null,isCheckChildren:!1,default_fw_service_id:"employeeTreeService",orgNameQueryService:"orgNameQueryService",default_parent_code:"111111111",type:"1",
showRoot:!1,notLoaded:!0,hasData:!1,bakSelectedNodes:[],bakInputNodes:[],nodes:[],otherParam:{},isShowRoot:!1,preNodeObj:null,depth:null,limitNum:null,requestCount:-1,bakParentCode:null,init:function(t){if(this.dom=t.dom,this.type=t.type||this.type,this.showRoot=t.showRoot||this.showRoot,this.depth=t.depth,this.limitNum=t.limitNum,"ztree"!=this.com.attr("class")&&this.com.attr("class","ztree"),this.initConf(t),this.bakParentCode=t.parentCode||this.default_parent_code,this.showRoot?(this.otherParam={parent_code:t.parentCode||this.default_parent_code,type:t.type||this.type,_fw_service_id:t.orgNameQueryService||this.orgNameQueryService},isShowRoot=!0):this.showRoot&&!this.isShowRoot||(this.otherParam={parent_code:t.parentCode||this.default_parent_code,type:t.type||this.type,_fw_service_id:t.fwServiceId||this.default_fw_service_id}),this.setting=$.extend({},t,{treeType:1,otherParam:this.otherParam,chkRange:t.chkRange,selectedNodes:t.selectedNodes||[],inputNodes:t.inputNodes||[],
isRemoteData:"undefined"==typeof t.isRemoteData||t.isRemoteData,check:"undefined"==typeof t.showCheckBox||t.showCheckBox,showIcon:t.showIcon,edit:!1,remove:!1,isMove:!1,checkType:t.checkType||{Y:"s",N:"s"},chkStyle:0==t.mutiple?"radio":"checkbox",radioType:t.radioType||"all",beforeAsync:this._beforeAsync(this),onAsyncSuccess:this._onAsyncSuccess(this),onAsyncError:this._onAsyncError(this),beforeExpand:this._beforeExpand(this),beforeCheck:this._beforeCheck(this),onCheck:this._onCheck(this),dataFilter:this._dataFilter(this)}),t.selectedNodes&&0<t.selectedNodes.length)for(var e in t.selectedNodes)this.bakSelectedNodes[e]=t.selectedNodes[e];if(t.inputNodes&&0<t.inputNodes.length)for(var e in t.inputNodes)this.bakInputNodes[e]=t.inputNodes[e];new PJF.ui.tree(this.setting),this.treeObj=$.fn.zTree.getZTreeObj(this.com.children(":first").attr("id"))},log:function(t,e){if(this.conf.showLog)if(e)console.log(t);else if("string"!=typeof t)for(var i in console.log("type ---\x3e "+typeof t),
console.log(t),t)console.log(t[i]);else console.log("-----------"+t+"-------------")},initConf:function(t){this.conf=$.extend({},t,{showLog:"undefined"!=typeof t.showLog&&t.showLog})},_beforeAsync:function(n){return function(t,e){n.log("_beforeAsync");var i=!0;return n.conf.onLoadBefore&&(i=n.conf.onLoadBefore(t,e,"_beforeAsync"),n.log("conf.onLoadBefore return ---\x3e"+i),i=void 0===i||i,n.log("conf.onLoadBefore final ---\x3e"+i)),i&&null!=e&&n.updateRequestParam(e.nodeId),e&&(n.treeObj.setting.view.NoExpand=!i),n.log("_beforeAsync return "+i),i}},_onAsyncSuccess:function(o){return function(t,e,i,n){o.log("_onAsyncSuccess"),o.log("_onAsyncSuccess  ---\x3e"+n),null==i&&o.log("current loaded is root data or null"),o.isCheckChildren&&(o.log("will check children "),o.isCheckChildren=!1,o.checkChildren(e,i,!0)),o.conf.onLoadAfter&&o.conf.onLoadAfter(t,e,i,n),0<o.setting.selectedNodes.length&&o.notLoaded&&(o.log(o.setting.selectedNodes),o.notLoaded=!1,o._loadselectedNodes()),
(0<o.nodes.length||0<o.setting.inputNodes.length)&&o.checkInputNodes(n)}},_onAsyncError:function(s){return function(t,e,i,n,o,a){s.log("_onAsyncError"),s.conf.onLoadError?s.conf.onLoadError(t,e,i,n,o,a):PJF.configuration.ajaxFailure()}},_dataFilter:function(a){return function(t,e,i){if(a.log("_dataFilter"),i.BK_STATUS&&i.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS)return a._showError(i),[];if(a.showRoot?e&&(a.requestCount=e.level):e&&(a.requestCount=e.level+1),e&&a.depth==a.requestCount&&i)for(var n=0;n<i.length;n++)i[n].isParent=!1;if(a.conf.dataFilter){var o=a.conf.dataFilter(t,e,i);return void 0!==o?o:i}return i}},_loadselectedNodes:function(){this.log("_loadselectedNodes");var o=this,a=[];!function(t,e){for(var i in t)e[i]=t[i]}(o.setting.selectedNodes,a);var s=setInterval(function(){var t=a;0==t.length&&(o.log("clear loadNodeInterval"),clearInterval(s));var e=null,i=null
;for(var n in t)(e=t[n]).isParent?(i=o.treeObj.getNodeByParam("nodeId",e.nodeId+""))&&(o.reLoadChildNodes(i,"refresh",!1,!1),t.splice(n,1)):t.splice(n,1)},300),r=setInterval(function(){o.log("_checkSelectedNodes setInterval");var t=o.bakSelectedNodes;if(0==t.length)return o.log("clear checkNodeInterval"),void clearInterval(r);var e=null,i=null;for(var n in t)(i=t[n]).checked?(e=o.treeObj.getNodeByParam("nodeId",i.nodeId+""))&&(o.checkNode(e,!1),o.bakSelectedNodes.splice(n,1)):o.bakSelectedNodes.splice(n,1)},300)},_beforeExpand:function(n){return function(t,e){n.log("------_beforeExpand----------");var i=!0;return n.conf.beforeExpand&&(i=n.conf.beforeExpand(t,e),n.log("conf.beforeExpand return ---\x3e"+i),i=void 0===i||i,n.log("conf.beforeExpand final ---\x3e"+i)),i}},_beforeCheck:function(n){return function(t,e){
if(n.limitNum&&($("#"+e.tId).find("span :first").next().hasClass("checkbox_false_full_focus")||$("#"+e.tId).find("span :first").next().hasClass("checkbox_false_part_focus")||$("#"+e.tId).find("span :first").next().hasClass("checkbox_false_part")||$("#"+e.tId).find("span :first").next().hasClass("checkbox_false_full"))&&n.getCheckedNodes(!0).length==n.limitNum){if(n.preNodeObj=$("#"+e.tId),!(0<$("#"+t).find(".errorbox_ipt_help").length)){$("#"+e.tId).checkTip({show:function(){return!1},Message:resource.ORGTREE_BEFORECHECK_SELECTNUM+n.limitNum+resource.ORGTREE_BEFORECHECK_SELECTNUM}),$("#"+e.tId).removeClass("validatebox-invalid validatebox-tipcolor");setTimeout(function(){n.preNodeObj&&(n.preNodeObj.find(".errorbox_ipt_help").remove(),n.preNodeObj=null)},800)}return!1}n.log("----------before check-----------");var i=!0;return n.conf.beforeCheck&&(i=n.conf.beforeCheck(t,e)),i}},_onCheck:function(n){return function(t,e,i){n.log("----------_onCheck-----------"),
n.conf.onCheck&&n.conf.onCheck(t,e,i)}},destroy:function(){this.com.remove(),PJF.ui.componentMgr.remove(this.id)}}),PJF.apply(PJF.ui.empTree.prototype,{validateParam:function(t){var e=document.getElementById(t.dom);return!(!t.dom||!e)||(alert(resource.EMPTREE_VALIDATEPARAM_INFO),!1)},_showError:function(t){if(t.BK_STATUS&&t.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS){var e=resource.ORGTREE_SHOWERROR_ERRCODE+t.BK_STATUS+"<BR/>"+resource.ORGTREE_SHOWERROR_ERRDESC+t.BK_DESC;new PJF.ui.messageBox({style:"warning",title:resource.ORGTREE_REQUEST_FAIL,content:e})}},updateRequestParam:function(t,e){this.treeObj.setting.async.otherParam={parent_code:t||this.default_parent_code,type:this.type,_fw_service_id:e||this.default_fw_service_id}},reLoadChildNodes:function(t,e,i,n){if(!t)return this.treeObj.reAsyncChildNodes(t,e,void 0!==i&&i),void me.log("treeNode = null , will reload the root of tree!");t.isParent&&(this.updateRequestParam(t.nodeId),this.treeObj.reAsyncChildNodes(t,e,void 0!==i&&i),
this.isCheckChildren=void 0===n||n)},checkChildren:function(t,e,i){if(this.log("checkChildren"),e&&e.isParent&&e.children){var n=this.getChildrenNodes(e);for(var o in i=void 0!==i?i:e.checked,n)this.treeObj.checkNode(n[o],i,!0,!1)}},getCheckedNodes:function(t){return this.treeObj.getCheckedNodes(t)},getAllLoadedNodes:function(){return this.treeObj.transformToArray(this.treeObj.getNodes())},getSelectedNodes:function(){return this.treeObj.getSelectedNodes()},getNodeByNodeId:function(t){return this.treeObj.getNodeByParam("nodeId",t+"")},unCheckNode:function(t,e,i){this.treeObj.checkNode(t,!1,void 0===e||e,i)},checkNode:function(t,e,i){this.treeObj.checkNode(t,!0,void 0===e||e,i)},getParentNodes:function(t){var e=[];if(!t)return this._showError(resource.ORGTREE_GETPARENTNODES_PARMERR),e;if(e.unshift(t),"-1"==t.parentId)return this.log("node.parentId is -1 "),e;for(var i=t.getParentNode();i;)e.unshift(i),i=i.getParentNode();return e},getTransData:function(){
var t=this.getCheckedNodes(),n={},e=[],o=[];function i(t){var e=null;for(var i in t)e=t[i],n[e.nodeId]||(n[e.nodeId]=!0,o.push(e))}for(var a in t)e=[],0<(e=this.getParentNodes(t[a])).length&&i(e);return this.log("finalNodes length = "+o.length),this.log(o),o},checkInputNodes:function(loadedNode){if(this.log("checkInputNodes"),loadedNode){try{loadedNode=eval("("+loadedNode+")")}catch(e){return void this.log("Error : eval loadedNode = "+loadedNode+"  error ! ")}var tmpNodeId="";for(var x in loadedNode)for(var n in this.bakInputNodes)tmpNodeId=this.bakInputNodes[n],loadedNode[x].nodeId==tmpNodeId&&this.checkNode(this.getNodeByNodeId(tmpNodeId))}else this.log("Function : checkInputNodes doLoadNode = "+loadedNode+"  return ! ")},getClassName:function(){return"PJF.ui.empTree"},setChkDisabled:function(t,e){this.treeObj.setChkDisabled(t,e)}}),PJF.namespace("PJF.pmc.util"),PJF.pmc.util={disablePmcCmp:function(t){var e=[];$("#"+t+" ul li span").each(function(){var t=$(this).attr("id")
;t&&e.push(t)});for(var i=e.length,n=0;n<i;n++){var o=e[n];PJF.pmc.cmpMgr.get(o)&&PJF.pmc.cmpMgr.get(o).disable()}},enablePmcCmp:function(t){var e=[];$("#"+t+" ul li span").each(function(){var t=$(this).attr("id");t&&e.push(t)});for(var i=e.length,n=0;n<i;n++){var o=e[n];PJF.pmc.cmpMgr.get(o)&&PJF.pmc.cmpMgr.get(o).enable()}}},PJF.namespace("PJF.pmc"),PJF.pmc.cmpMgr=function(){var e=new PJF.util.Collection;return{get:function(t){return e.item(t)},reg:function(t){e.containsKey(t.params.dom)?alert("cmpMgr已包含id为"+t.getId()+"的组件"):e.add(t.params.dom,t)},unReg:function(t){e.removeKey(t)},clear:function(){e.clear()}}}(),PJF.ui.pmcBound=PJF.extend(PJF.ui.component,{init:function(o){var a=new PJF.ui.buttonInput({dom:o.dom,inputType:"text",textName:o.dom,id:"pmc_btnInputId_"+o.dom,deviceName:"btnInput",textBt:o.btnName,isRepeat:!0,pmc_disable:o.disable,onclick:function(){if(0==$("div#pmcWindow_"+o.dom).length){var t='<div id="pmcWindow_'+o.dom+'"></div>';$("body").append(t)}
var e='<div class="pjf_content" ><div class="pjf_ul_title_box"><h2 class="pjf_ul_title">'+o.label+'</h2></div><div class="div_ulbox" id="boundDiv_'+o.dom+'"><table style="margin:auto;"><tr><td><label class="hide">下限值：</label><input id="pmcUpValue_'+o.dom+'"  type="text" /></td><td>-</td><td><label class="hide">上限值：</label><input id="pmcDownValue_'+o.dom+'"  type="text" /></td></tr></table></div><div class="pjf_submit_con"><span id="pmcConfirmBtn_'+o.dom+'"></span><span id="boundCancel_'+o.dom+'"></span></div></div><script type="text/javascript">'
;o.pmcValid?e+="var pmcUp_"+o.dom+' = new PJF.ui.textfield({dom:"pmcUpValue_'+o.dom+'",id:"pmcUpValue_'+o.dom+'",width:172,validType:"'+o.pmcValid+'",invalidMessage:"'+o.pmcVmsg+'"});var pmcDown_'+o.dom+' = new PJF.ui.textfield({\tdom:"pmcDownValue_'+o.dom+'",\tid:"pmcDownValue_'+o.dom+'",\twidth:172,\tvalidType:"'+o.pmcValid+'",\tinvalidMessage:"'+o.pmcVmsg+'"\t});':e+="var pmcUp_"+o.dom+' = new PJF.ui.textfield({dom:"pmcUpValue_'+o.dom+'",id:"pmcUpValue_'+o.dom+'",width:172,validType:"digit"});var pmcDown_'+o.dom+' = new PJF.ui.textfield({\tdom:"pmcDownValue_'+o.dom+'",\tid:"pmcDownValue_'+o.dom+'",\twidth:172,\tvalidType:"digit"\t});',
e+="\tvar boundCancel_"+o.dom+' = new PJF.ui.linkButton({\t\tdom:"boundCancel_'+o.dom+'",\t\tname:"取消",\t\ticonCls : "icon-cancel",\t\tonclick:function(){\t\t\tPJF.ui.componentMgr.get("pmcWindowID_'+o.dom+'").close();\t}});\tvar pmcConfirm_'+o.dom+' = new PJF.ui.linkButton({\t\tdom:"pmcConfirmBtn_'+o.dom+'",\t\tid:"pmcConfirmBtn_'+o.dom+'",\t\tname:"确认",\t\ticonCls : "icon-confirm",\t\tonclick:function(){\t\tvar v1= pmcUp_'+o.dom+".getValue();\t\tvar v2 = pmcDown_"+o.dom+'.getValue();\t\tvar v = v1+","+v2;\t\tif(v.length>1){\t\tif (!PJF.html.validateForm("boundDiv_'+o.dom+'")) return;\t\tif(parseFloat(v2)<=parseFloat(v1)){new PJF.ui.messageBox({style : "warning",title : "警告",\tcontent :"上限值必须大于下限值"});return;}\t\tPJF.ui.componentMgr.get("pmc_btnInputId_'+o.dom+'").setValue(v);}else{\t\tPJF.ui.componentMgr.get("pmc_btnInputId_'+o.dom+'").setValue("");}\t\tPJF.ui.componentMgr.get("pmcWindowID_'+o.dom+'").close();\t\t}\t});';var i=a.getContent();if(i){var n=i.split(",")
;e+="pmcUp_"+o.dom+".setValue("+n[0]+");pmcDown_"+o.dom+".setValue("+n[1]+");"}PJF.ui.componentMgr.get("pmc_btnInputId_"+o.dom).params.pmc_disable&&(e+="pmcUp_"+o.dom+".disabled();pmcDown_"+o.dom+".disabled();pmcConfirm_"+o.dom+".disable();"),e+="<\/script>";new PJF.ui.window({dom:"pmcWindow_"+o.dom,id:"pmcWindowID_"+o.dom,title:o.title,width:500,height:240,content:e})}});a.setAvailable(!0),$("#"+o.dom).find("a").eq(0).attr("style","float:left;")}}),PJF.apply(PJF.ui.pmcBound.prototype,{setValue:function(t){var e=this.params.dom;/^-?\d+(\.\d+)?,\d+(\.\d+)?$|^-?\d+(\.\d+)?,|,\d+(\.\d+)?/.test(t)&&PJF.ui.componentMgr.get("pmc_btnInputId_"+e).setValue(t)},disable:function(){var t=this.params.dom;PJF.ui.componentMgr.get("pmc_btnInputId_"+t).params.pmc_disable=!0},enable:function(){var t=this.params.dom;PJF.ui.componentMgr.get("pmc_btnInputId_"+t).params.pmc_disable=!1}}),PJF.ui.pmcWindowGrid=PJF.extend(PJF.ui.component,{init:function(s){var r=new PJF.ui.buttonInput({dom:s.dom,
inputType:"text",textName:s.dom,id:"pmc_btnInputId_"+s.dom,deviceName:"btnInput",textBt:s.btnName,isRepeat:!0,onclick:function(){if(0==$("div#pmcWindowGrid_"+s.dom).length){var t='<div id="pmcWindowGrid_'+s.dom+'"></div>';$("body").append(t)}
var e='<div class="pjf_content" ><div class="pjf_ul_title_box"><h2 class="pjf_ul_title">'+s.label+'</h2></div><div class="div_ulbox"><div id="gridDivBox_'+s.dom+'"></div></div><div class="pjf_submit_con"><span id="wingridBtn_'+s.dom+'"></span><span id="wingridCancel_'+s.dom+'"></span></div></div>\t<script type="text/javascript">\tvar gridDivBox_'+s.dom+'  = new PJF.ui.grid({\t\tid:"gridDivBoxID_'+s.dom+'",\t\tdom:"gridDivBox_'+s.dom+'",\t\twidth:480,\t\theight:230,       pagination:false,        singleSelect:false,        noDataMsg:"",        columns:[[                  {title:"选择", checkbox:true, align:"center"},                  {title:"要素取值", field:"itemValue",align:"center"},                  {title:"要素取值描述", field:"itemName",align:"center"},\t\t\t\t  {title:"默认",field:"pmc_default", align:"center",                          formatter:function(value,rowData,rowIndex){                           return "<input type=\'radio\' name=\'pmc_wingrid_radio_'+s.dom+'\' value=\'"+rowData["itemValue"]+"\'   />";                        }                   }                ]]\t\t\t});\tvar wingridCancel_'+s.dom+' = new PJF.ui.linkButton({\t\tdom:"wingridCancel_'+s.dom+'",\t\tname:"取消",\t\ticonCls : "icon-cancel",\t\tonclick:function(){\t\t\tPJF.ui.componentMgr.get("pmcWindowGridID_'+s.dom+'").close();\t}});\tvar wingridBtn_'+s.dom+' = new PJF.ui.linkButton({\t\tdom:"wingridBtn_'+s.dom+'",\t\tid:"wingridBtn_'+s.dom+'",\t\tname:"确定",\t\ticonCls : "icon-confirm",\t\tonclick:function(){\t\tvar radioVal = $("input[name=\'pmc_wingrid_radio_'+s.dom+'\']:checked").val();\t\tif(radioVal){\t\t\tvar result = radioVal+",";\t\t\tvar selectVal = gridDivBox_'+s.dom+'.getSelections();\t\t\tvar len = selectVal.length;\t\t\tfor(var i =0; i < len; i++){\t\t\t\tvar tmp = selectVal[i]["itemValue"];\t\t\t\tif(tmp!=radioVal){result +=tmp+",";}\t\t\t}\t\t\tresult = result.substring(0,result.length-1);\t\t\tPJF.ui.componentMgr.get("pmc_btnInputId_'+s.dom+'").setValue(result);\t\t\tPJF.ui.componentMgr.get("pmcWindowGridID_'+s.dom+'").close();\t\t}else{\t\t\tnew PJF.ui.messageBox({title:"警告",content:"请选择默认值！"});\t\t}\t\t}\t});'
;if(PJF.ui.componentMgr.get("pmc_btnInputId_"+s.dom).params.pmc_disable&&(e+="wingridBtn_"+s.dom+".disable();"),s.dataGetFunc){var i=s.dataGetFunc(),n=PJF.util.json2str(i);e+='PJF.ui.componentMgr.get("gridDivBoxID_'+s.dom+'").loadData(eval('+n+"));"}else if(s.data){i=s.data,n=PJF.util.json2str(i);e+='PJF.ui.componentMgr.get("gridDivBoxID_'+s.dom+'").loadData(eval('+n+"));"}var o=r.getContent();if(o){var a=o.split(",").length;0<a&&(e+=' var backDataTmp = PJF.ui.componentMgr.get("gridDivBoxID_'+s.dom+'").getData();',e+='var backData=  backDataTmp["rows"];',e+='var v_backStr ="'+o+'";',e+='var v_back = v_backStr.split(",");',e+="var indexTmp=[];",e+='for(var j = 0; j < backData.length; j++){\tif(v_back[0]==backData[j]["itemValue"]){$("input[name=\'pmc_wingrid_radio_'+s.dom+"']\")[j].checked=true;indexTmp.push(j);}}",e+="for(var i =1 ; i<"+a+'; i++){for(var j = 0; j < backData.length; j++){if(v_back[i]==backData[j]["itemValue"]){\tindexTmp.push(j);}\t}}',
e+='for(var i =0; i <indexTmp.length; i++){\tPJF.ui.componentMgr.get("gridDivBoxID_'+s.dom+'").selectRow(indexTmp[i]);\t}')}e+="<\/script>",new PJF.ui.window({dom:"pmcWindowGrid_"+s.dom,id:"pmcWindowGridID_"+s.dom,title:s.title,width:588,height:360,content:e})}});r.setAvailable(!0),$("#"+s.dom).find("a").eq(0).attr("style","float:left;")}}),PJF.apply(PJF.ui.pmcWindowGrid.prototype,{setValue:function(t){var e=this.params.dom;PJF.ui.componentMgr.get("pmc_btnInputId_"+e).setValue(t)},disable:function(){var t=this.params.dom;PJF.ui.componentMgr.get("pmc_btnInputId_"+t).params.pmc_disable=!0},enable:function(){var t=this.params.dom;PJF.ui.componentMgr.get("pmc_btnInputId_"+t).params.pmc_disable=!1}}),PJF.ui.trsTextfield=PJF.extend(PJF.ui.textfield,{init:function(e){e.defaultValue||(e.defaultValue="");var t=null;t=e.equalTextfield?new PJF.ui.textfield(e):new PJF.ui.textfield({dom:e.dom,width:e.width,required:!1,defaultValue:e.defaultValue,invalidMessage:e.invalidMessage,disabled:e.disabled,
readonly:e.readonly,inputType:e.inputType,datatype:e.datatype}),this.war=t;var i=this.com;this.com.bind("focus",function(){$(this).css("border-color","#75B4E9")}).bind("blur",function(){var t=$(this).val();i.checkTip({Message:e.invalidMessage,show:function(){return t==e.defaultValue},flag:"warn"})})},setDefaultVal:function(t){return this.params.defaultValue=t},destroy:function(){this.war.destroy(),PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.war=null,this.com=null,this.id=null}}),PJF.ui.trsAutoComplete=PJF.extend(PJF.ui.component,{init:function(t){this.auto=new PJF.ui.autoComplete({dom:t.dom,id:t.id,autoSubmit:t.autoSubmit,minChars:t.minChars||1,maxHeight:t.Height||300,maxLength:t.maxLength||100,deferRequestBy:0,width:t.width,highlight:t.highlight||!0,params:{},fnFormatResult:t.fnFormatResult,delimiter:null,zIndex:9999,name:t.name,onChange:t.onChange||null,lookup:[],required:t.required||!1,blur:t.blur||null,focus:t.focus||null,missingMessage:t.missingMessage,
defaultValue:t.defaultValue||null,autoCheck:t.autoCheck,queryName:t.queryName,cpsReq:t.cpsReq,count:t.count})},addOptions:function(t){this.auto.addOptions(t)},getSelectValue:function(){this.auto.getSelectValue()},setDefaultValue:function(t){this.auto.setDefaultValue(t)},removeOptions:function(t){this.auto.removeOptions(t)},removeAll:function(){this.auto.removeAll()}}),PJF.apply(PJF.ui.trsAutoComplete.prototype,{}),PJF.ui.customerInfo=PJF.extend(PJF.ui.component,{gridInfo:null,init:function(t){this._fw_service_id="simpleTransaction",this.transaction_id="A00421518",t.jsonData.MULTI_TENANCY_ID=t.jsonData.MULTI_TENANCY_ID||"CN000";var e,i=t.jsonData.Ctc_Inf_TpCd+"";"1"==i[0]?e=[[{field:"Ctc_Inf_TpCd_DESC",title:"电话类型",sortable:!0},{field:"TelCtcMod_Itnl_DstcNo",title:"国际长途区号",sortable:!0},{field:"TelCtcMod_Dmst_DstcNo",title:"国内长途区号",sortable:!0},{field:"TelCtcMod_No",title:"电话号码",sortable:!0},{field:"TelCtcMod_Exn_No",title:"分机号码",sortable:!0}]]:"2"==i[0]&&(e=[[{field:"Ctc_Inf_TpCd_DESC",
title:"地址类型",sortable:!0},{field:"CtyRgon_Cd_DESC",title:"国家和地区",sortable:!0},{field:"Prov_AtnmsRgon_Cd_DESC",title:"省",sortable:!0},{field:"Urbn_Cd_DESC",title:"市",sortable:!0},{field:"CntyAndDstc_Cd_DESC",title:"县",sortable:!0},{field:"Dtl_Adr_Cntnt",title:"详细地址",sortable:!0},{field:"ZipECD",title:"邮政编码",sortable:!0}]]),e&&(gridInfo=new PJF.ui.grid({dom:t.dom,showPageList:!0,onSelect:null,url:PJF.constants.DEFAULT_ACTION,queryParams:{_fw_service_id:this._fw_service_id,transaction_id:this.transaction_id,jsonData:PJF.util.json2str(t.jsonData),adapterId:"ecpJson"},totalPath:"Vld_Rcrd_Cnt",rowsPath:"FMPC1518_CONTACT_GROUP",columns:e}))}}),PJF.apply(PJF.ui.customerInfo.prototype,{validateParam:function(t){var e=!0;switch(t.jsonData||(e=!1),parseInt(t.jsonData.Cst_Id_MtdCd)){case 1:t.jsonData.Id_Crdt_TpCd&&t.jsonData.Id_Crdt_No&&t.jsonData.Id_Idv_Lgl_Nm||(e=!1);break;case 2:t.jsonData.SrcSys_Cst_ID&&t.jsonData.Src_Inf_Stm_Cd||(e=!1);break;case 3:t.jsonData.SrcSys_AR_ID||(e=!1);break
;case 4:t.jsonData.Cst_ID||(e=!1);break;case 5:t.jsonData.Blgc_Ftr_TpCd&&t.jsonData.Rcgz_TpCd&&t.jsonData.Dsc||(e=!1);break;default:e=!1}return t.jsonData.Ctc_Inf_TpCd||(e=!1),e||alert("客户信息查询组件conf配置错误"),!0},getClassName:function(){return"PJF.ui.customerInfo"}}),PJF.flowDesignerTemplates={
"array-input-tmpl":"<div class='object-array-input-container'>\n                <div class='edit-area'>\n                    <p class='input-fields-title'></p>\n                    <div class='field-info-container'>\n    \n                    </div>\n                    <div class='save-btn-container'>\n                        <p>\n                            <span class='save-btn'></span>\n                        </p>\n                    </div>\n                    <hr>\n                </div>\n                <div class='display-area'>\n   \n                </div>\n                <div class=\"save-btn-container\" style=\"display: none\">\n                    <div class='save-btn-container'>\n                        <p>\n                            <span class='save-btn'></span>\n                        </p>\n                    </div>\n                </div>\n            </div>",
"control-window-tmpl":"<div class=\"control-window-container\">\n            <div class='wrapper'>\n                <div class='control-container'></div>\n                <div class='save-btn-container'>\n                    <p>\n                        <span class='save-btn'></span>\n                    </p>\n                </div>\n            </div>   \n        </div>",
"approver-select-tmpl":' <ul class="input-list">\n            <li>\n                <label><span>*</span>有权审批人所属机构：</label>\n                <span class="margin-top-5px">\n                    <span class="select-org-disp line-height-24px"></span>\n                    <span class=\'button-select-org\'></span>\n                    <span class=\'button-select-org-2\'></span>\n                </span>\n            </li>\n            <li>\n                <label><span>*</span>有权审批人：</label>\n                <span class="margin-top-5px">\n                    <span class="select-approver-disp line-height-24px"></span>\n                    <span class=\'button-select-positions\'/>\n                    <span class=\'button-select-operators\'/>\n                </span>\n            </li>\n        </ul>\n        <div class="org-tree-window-container" style="display: none">\n            <div class="wrapper">\n                <div class="org-type"></div>\n                <div class="upper-org-select-container"></div>\n                <div class="org-tree"></div>\n                <div class="save-btn-container">\n                    <span class="save-btn"></span>\n                </div>\n            </div>\n        </div>',
"approver-condition-tmpl":"<ul class='input-list'>\n                <li>\n                    <label><span>*</span>条件说明：</label>\n                    <textarea class='condition-description' placeholder='请输入条件的说明，如[当金额>500万时，需要行长审批]'></textarea>\n                </li>\n                <li>\n                    <label><span>*</span>条件设置：</label>\n                    <span class=\"condition-disp\"></span><span class='condition-set-btn'></span>\n                    <div class='condition-set-window-container' style='display: none'>\n                        <div class='wrapper'>\n                            <p>条件设置</p>\n                            <div class='condition-group-grid'>\n    \n                            </div>\n                        </div>\n                    </div>\n                    <div class='condition-input-window-container' style='display: none'>\n                        <div class='wrapper'>\n                            <div class='condition-input'>\n    \n                            </div>\n                        </div>\n                    </div>\n                </li>\n            </ul>",
"approval-step-condition-input-tmpl":" <ul class='input-list'>\n                <li>\n                    <label><span>*</span>审批步骤类型：</label>\n                    <div class='input-container'>\n                        <span class='node-type'></span>\n                    </div>\n                </li>\n            </ul>\n            <div class='approval-step-condition-container'>\n    \n            </div>\n            <div class='approval-step-input-container'>\n    \n            </div>",
"approval-step-input-tmpl":"  <ul class='input-list'>\n                <li>\n                    <label><span>*</span>审批步骤名：</label>\n                    <input class='node-title' type='text' placeholder='请输入审批步骤名，如[所在一级行内控合规部审批]'/>\n                </li>\n                <li>\n                    <label><span>*</span>审批步骤说明：</label>\n                    <textarea class='node-description' placeholder='请输入审批步骤说明，如[请对交易合规性进行审批]'></textarea>\n                </li>\n                <li>\n                    \x3c!--label><span>*</span>指定有权审批人：</label--\x3e\n                    <div class='approver-info-container'>\n                    </div>\n                </li>\n            </ul>",
"workflow-node-root-template-editor-tmpl":"<div class='edit-area'>\n            编辑区域\n            <ul class='input-list'>\n                <li>\n                    <label><span>*</span>审批步骤：</label>\n                    <span class='add-step' style=''></span>\n                    <div class='approval-step-add-container' style='display: none'>\n                        <span class='close-btn'>x</span>\n                        <div class='wrapper'>\n                            <p class='approval-step-title'></p>\n                            <div class='approval-step-add'>\n\n                            </div>\n                            <div class='text-align-right save-btn-container'>\n                                <span class='save-btn'></span>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n        </div>\n        <div class='flow-image-container'>\n\n        </div>",
tmpl:"<div class='pjf-flow-designer-container'>\n                <div class='basic-info'>\n                    <ul class='input-list'>\n                        <li>\n                            <label><span>*</span>审批流程名：</label>\n                            <input class='title' type='text' placeholder='请输入审批流程名，如[大额转账交易预审批流程]'/>\n                        </li>\n                        <li>\n                            <label><span>*</span>审批流程说明：</label>\n                            <textarea class='description' placeholder='请输入审批流程的简要说明，如[进行大额转账交易时，需要进行事前审批，当金额>500万时，需要行长审批。]'></textarea>\n                        </li>\n                        <li>\n                            <label><span>*</span>录入要素：</label>\n                            <span class='edit-input-field' style=''></span>\n                        </li>\n                    </ul>\n                </div>\n                <hr>\n                <div class='workflow-node-root-template-editor-container'>\n    \n                </div>\n                <div class='input-fields-input-window-container' style='display: none'></div>\n                <div style='clear: both'></div>\n            </div>"
};try{!function(t){var s=function(t){return PJF.flowDesignerTemplates[t]===undefined&&console.error("[PJF.ui.flow-designer.getTemplate]读取模板%s失败！",t),console.debug("[PJF.ui.flow-designer.getTemplate]读取模板%s！",t),PJF.flowDesignerTemplates[t]},r=function(){return window.console?{error:console.error||console.log,debug:console.debug||function(){},info:console.info||console.log,log:console.log||console.log,warn:console.warn||console.log,error:console.error||console.log}:{error:function(){},debug:function(){},info:function(){},log:function(){},warn:function(){}}},e=PJF.extend(PJF.ui.component,{domId:null,___constructor:function(){this._outputField2ComponentMap={},this.params.dom=this.getSelector(),this.outputData=this.util.deepCopy(this.outputData),this.getDom().html("")},getClassName:function(){return"PJF.ui.flow-designer.baseClass"},genDomIdForInnerElem:function(t,e){r().debug("[%s]开始为DOM[id=%s]内[%s]选择器对应的元素生成Id",this.getClassName(),t,e);var i={"-a":"A","-b":"B","-c":"C","-d":"D","-e":"E",
"-f":"F","-g":"G","-h":"H","-i":"I","-j":"J","-k":"K","-l":"L","-m":"M","-n":"N","-o":"O","-p":"P","-q":"Q","-r":"R","-s":"S","-t":"T","-u":"U","-v":"V","-w":"W","-x":"X","-y":"Y","-z":"Z"},n=(t+"_"+e).replace(new RegExp("\\.","g"),"_").replace(new RegExp("#","g"),"_").replace(new RegExp(" ","g"),"_").replace(new RegExp(">","g"),"_");for(var o in i)n=n.replace(new RegExp(o,"g"),i[o]);return r().debug("[%s]生成的DOM Id为%s",this.getClassName(),n),n},createLabel:function(e){var t=$("#"+e),i=[],n=this;t.find("label").each(function(){var t=n.genDomIdForInnerElem(e,"label.label"+i.length);$(this).attr("id",t),i.push(t)}),new PJF.ui.label({doms:i})},util:{deepCopy:function(t){return JSON.parse(JSON.stringify(t))},map2Array:function(t){var e=[];for(var i in t)e.push(t[i]);return e},objectArray2Map:function(t,e){var i={};for(var n in t)i[t[n][e]]=t[n];return i},objectArray2PlainMap:function(t,e,i){var n={};for(var o in t)n[t[o][e]]=t[o][i];return n},objectArray2FieldArray:function(t,e){var i=[]
;for(var n in t)i.push(t[n][e]);return i},keyArray2ValueArray:function(t,e){var i=[];for(var n in t)i.push(e[t[n]]);return i},stringArray2ObjectArray:function(t,e){var i=[];for(var n in t){var o={};o[e]=t[n],i.push(o)}return i},revertKVMap:function(t){var e={};for(var i in t)e[t[i]]=i;return e}},getSelector:function(){return"#"+this.params.domId},getDom:function(){return $(this.getSelector())},getInnerElemDomId:function(t){this.params.dom;var e=this.genDomIdForInnerElem(this.params.domId,t),i=t;if(0<$("#"+e).length)return e;var n=this.getDom().find(i);if(n.length<1)r().error("[%s]%s下的%s元素不存在!请检查模板！",this.getClassName(),this.params.domId,i);else{if(!(1<n.length))return n.attr("id",e),e;r().error("[%s]%s下的%s元素多于一个!请检查模板！",this.getClassName(),this.params.domId,i)}},outputData:{},setValue:function(t){for(var e in r().debug("[%s]开始调用本控件的setValue",this.getClassName()),this._outputField2ComponentMap){
if(null==t[e]||null==t[e])return void r().warn("[%s]传入的值不包含输出字段[%s]，已跳过，请注意。",this.getClassName(),e);this.setFieldValueByFieldName(e,t[e])}},setFieldValueByFieldName:function(t,e){r().debug("[%s]开始设置字段[%s]",this.getClassName(),t);var i=this._outputField2ComponentMap[t];i!==undefined&&null!=i?i.setValue!==undefined?(r().debug("[%s]把字段[%s]赋值给对应组件[%s]",this.getClassName(),t,i.getClassName()),i.setValue(e)):r().warn("[%s]输出字段[%s]对应的组件不存在setValue方法，已跳过，请注意。",this.getClassName(),t):r().warn("[%s]输出字段[%s]在字段-组件映射表中不存在，已跳过，请注意。需要使用bindOutput进行注册。",this.getClassName(),t)},getFieldValueByFieldName:function(t){if(r().debug("[%s]开始读取字段[%s]",this.getClassName(),t),this.outputData[t]!==undefined&&null!=this.outputData[t])return r().debug("[%s]字段[%s]设置为常量输出。",this.getClassName(),t),this.outputData[t];r().debug("[%s]尝试获取其绑定的组件",this.getClassName());var e=this._outputField2ComponentMap[t];return null==e||e.getValue===undefined?(r().error("[%s]自动填充数据失败：请绑定控件到字段或者重载getValue方法！",this.getClassName()),
null):(r().debug("[%s]字段[%s]的值从组件%s读取。",this.getClassName(),t,e.getClassName()),e.getValue())},getValue:function(){r().debug("[%s]开始调用本控件的getValue",this.getClassName());var t=this.util.deepCopy(this.outputData),e=0;for(var i in this.outputData)t[i]=this.getFieldValueByFieldName(i),e++;return r().debug("[%s]一共输出%d个字段。",this.getClassName(),e),0===e&&r().error("[%s]自动填充数据失败,没有任何输出字段",this.getClassName()),t},_outputField2ComponentMap:{},bindOutput:function(t,e){null!=e&&e!==undefined?(r().debug("[%s]绑定输出字段[%s]到控件[%s]",this.getClassName(),t,e.getClassName()),this._outputField2ComponentMap[t]=e):r().warn("[%s]传入bindOutput的控件为空，如需解除绑定请调用unbindOutput",this.getClassName())},unbindOutput:function(t){var e=this._outputField2ComponentMap[t]!==undefined&&null!==this._outputField2ComponentMap[t]&&this._outputField2ComponentMap[t].getClassName?this._outputField2ComponentMap[t].getClassName:function(){return"空"};r().debug("[%s]解除输出字段[%s]到控件[%s]的绑定",this.getClassName(),t,e()),
delete this._outputField2ComponentMap[t]}}),c=PJF.extend(e,{getClassName:function(){return"PJF.ui.flow-designer.ObjectInputControl"},outputData:null,_getClassByFieldName:function(t){return"field-"+t},_getContainerClassByFieldName:function(t){return"field-"+t+"-container"},_createFieldContainerDOM:function(t){var e=$("<li></li>");return e.addClass(this._getContainerClassByFieldName(t.name)),e},_createComponentAndBind:function(t,e){var i=PJF.apply(t.config||{},{dom:this.getInnerElemDomId("."+this._getClassByFieldName(t.name)),domId:this.getInnerElemDomId("."+this._getClassByFieldName(t.name)),required:t.required});switch(t.type){case"select":var n=[];for(var o in t.options)n.push({name:t.options[o],desc:o});this.bindOutput(t.name,new PJF.ui.select(PJF.apply(i,{data:n})));break;default:this.bindOutput(t.name,new t.control(PJF.apply(i,{})));break;case"text":this.bindOutput(t.name,new PJF.ui.textfield(PJF.apply(i,{})))}},_fieldListDom:null,_createFieldInput:function(t){
var e="ul.input-list>li."+this._getContainerClassByFieldName(t.name);this._fieldListDom.append(this._createFieldContainerDOM(t)),this.getInnerElemDomId(e),this.updateField(t)},updateField:function(t){var e="ul.input-list>li."+this._getContainerClassByFieldName(t.name);if(this.getDom().find(e).length<0)r().error("[%s]字段%s不存在！",this.getClassName(),t.name);else{var i=this.getInnerElemDomId(e),n=$("#"+i);if(n.html(""),t.title){var o=$("<label></label>");t.required&&o.append($("<span>*</span>")),o.append(t.title),n.append(o)}var a=null;switch(t.type){case"select":a=$(document.createElement("span"));break;default:a=$(document.createElement(t.tag||"div"));break;case"text":var s="multi"===(t.config||{}).datatype?"textarea":"input";a=$(document.createElement(s)),t.tip!==undefined&&a.attr("placeholder",t.tip)}a.addClass(this._getClassByFieldName(t.name)),n.append(a),this._createComponentAndBind(t),this.outputData[t.name]=null}},init:function(t){this.___constructor();var e=this.getDom()
;if(e.html(""),t.title){var i=$(document.createElement("p"));i.attr("style","width:100%;"),i.addClass("input-title"),i.addClass("pjf_ul_title"),i.text(t.title),e.append(i)}var n=$(document.createElement("ul"));(this._fieldListDom=n).addClass("input-list"),t["class"]&&n.addClass(t["class"]),e.append(n);for(var o in this.outputData={},t.fields){var a=t.fields[o];this._createFieldInput(a)}this.createLabel(t.domId)}}),n=PJF.extend(e,{outputData:[],getClassName:function(){return"PJF.ui.flow-designer.ObjectArrayInputControl"},_getName:function(){return this.params.name},_getFields:function(){return this.params.fields},_fields2GridColumns:function(t){var e=[],i=this;for(var n in t){var o=t[n],a=undefined;"select"===o.type&&(a=function(){var e=i.util.revertKVMap(o.options);return function(t){return e[t]}}()),a=o.formatter||a,e.push({title:o.title,field:o.name,hidden:!1,formatter:a})}return[e]},init:function(t){this.___constructor(),this.getDom().html(s("array-input-tmpl"))
;var i=this,n=$("#"+i.getInnerElemDomId("div.edit-area")),e=!0===t.showSaveBtn,o=t.onSave||function(){};e&&($("#"+i.getInnerElemDomId("div.object-array-input-container > div.save-btn-container")).show(),new PJF.ui.linkButton({dom:i.getInnerElemDomId("div.object-array-input-container > div.save-btn-container span.save-btn"),name:"保存",onclick:function(){o(i.getValue())}})),n.hide();var a=new PJF.ui.grid({dom:i.getInnerElemDomId("div.display-area"),columns:i._fields2GridColumns(t.fields),checkbox:!0,width:"auto",toolbar:[{bt:"custom",text:"添加",onclick:function(){n.show();var t=new c({domId:i.getInnerElemDomId("div.field-info-container"),fields:i._getFields()});$("#"+i.getInnerElemDomId("p.input-fields-title")).text("新增"+i._getName()),new PJF.ui.linkButton({dom:i.getInnerElemDomId("div.edit-area > div.save-btn-container > p> span.save-btn"),name:"保存",onclick:function(){i.outputData.push(t.getValue()),r().debug("[%s]保存当前编辑%s数据:%s",i.getClassName(),i._getName(),JSON.stringify(t.getValue())),
a.loadData(i.outputData),n.hide()}})}},{bt:"custom",text:"编辑",onclick:function(){n.show();var t=a.getSelected();if(t!==undefined&&null!=t){r().log("[%s]当前选中的数据为：",i.getClassName(),t),$("#"+i.getInnerElemDomId("p.input-fields-title")).text("编辑"+i._getName());var e=new c({domId:i.getInnerElemDomId("div.field-info-container"),fields:i._getFields()});e.setValue(t),new PJF.ui.linkButton({dom:i.getInnerElemDomId("span.save-btn"),name:"保存",onclick:function(){r().debug("[%s]保存当前编辑数据:%s",i.getClassName(),JSON.stringify(e.getValue())),i.outputData[a.getCurrentIndex()]=e.getValue(),a.loadData(i.outputData),n.hide()}})}else alert("未选中任何数据！")}},{bt:"del"}]});this._grid=a},getValue:function(){return this.outputData},setValue:function(t){this.outputData=t,this._grid.loadData(this.getValue())}}),o=PJF.extend(e,{_dom:null,_control:null,getClassName:function(){return"PJF.ui.flow-designer.ObjectArrayInputWindow"},_createWindowContainer:function(){
var t=this,e=this.params.showWindowBtnDomId,i=$(s("control-window-tmpl"));(this._dom=i).hide();var n=this.genDomIdForInnerElem(e||this.id,"div.window-container");this.params.domId=n,$("#"+n).remove(),i.attr("id",n),$("body").append(i),!0===this.params.showSaveBtn&&new PJF.ui.linkButton({dom:t.getInnerElemDomId("div.wrapper > div.save-btn-container span.save-btn"),name:"保存",onclick:function(){t._control.getValue!==undefined&&(t.value=t._control.getValue()),t.params.onSave(t.value),t.hide()},style:"assistant"})},init:function(t){this.___constructor(),this._createWindowContainer();var e=this;this.params.onSave=t.onSave||function(){},this._dom.show(),this._dom.window({modal:!0,title:t.windowTitle}),e.hide();var i=this.getInnerElemDomId("div.wrapper > div.control-container");e._control=new t.control(PJF.apply({domId:i,dom:i},t.controlConfig)),this.params.showWindowBtnDomId!==undefined&&new PJF.ui.linkButton({dom:this.params.showWindowBtnDomId,name:t.showWindowBtnName,onclick:function(){
e.show()},style:t.showWindowBtnStyle||"assistant"})},getValue:function(){return this._control.getValue.call(this._control)},setValue:function(t){return this._control.setValue.call(this._control,t)},show:function(){this._dom.window("open")},hide:function(){this._dom.window("close")}}),i=PJF.extend(e,{getClassName:function(){return"PJF.ui.flow-designer.FlowImageControl"},_calcNodeWidth:function(t){var e=0;for(var i in t)t[i].length>e&&(e=t[i].length);return e},_getDepthMap:function(t){for(var e={1:[]},i=[{depth:1,node:t}];0<i.length;){var n=i.pop();e[n.depth]===undefined&&(e[n.depth]=[]),e[n.depth].push(n);var o=undefined;for(var a in 0<e[n.depth].length&&(o={rowIndex:e[n.depth].length-1,depth:n.depth}),n.node.nodeTemplate.branches)i.push({depth:n.depth+1,node:n.node.nodeTemplate.branches[a],parentIndex:o})}return e},_calcNodeOccupiedWidth:function(t,e){return e/t},_calcNodePos:function(t,e,i,n,o){
var a=this._calcNodeOccupiedWidth(i[e].length,n),s=parseInt(t)*a,r=.6*a,c=.6*o,l=o*(e-1),d=l+(o-c)/2,u=s+(a-r)/2;return{topY:d,centerY:d+c/2,bottomY:d+c,leftX:u,centerX:u+r/2,width:r,height:c,frameLeftX:s,frameTopY:l,frameHeight:o,frameWidth:a}},_drawNode:function(t,e,i,n,o,a){var s=this._calcNodePos(a,o,n,e,i);t.beginPath();for(var r={width:99999},c=20,l="";r.width>s.width-20&&1<c;)t.font=c+"px 微软雅黑",l=n[o][a].node.nodeTemplate.title,r=t.measureText(l),c--;return!0===n[o][a].highlight?(t.fillStyle="blue",t.fillRect(s.leftX,s.topY,s.width,s.height),t.fillStyle="white"):t.rect(s.leftX,s.topY,s.width,s.height),t.fillText(l,s.centerX-r.width/2,s.centerY),t.fillStyle="black",s},_drawNodes:function(t,e,i,n){var o=PJF.apply({},n);for(var a in o)for(var s in o[a]){var r=this._drawNode(t,e,i,n,a,s),c=o[a][s].parentIndex;if(c!==undefined){var l=this._calcNodePos(c.rowIndex,c.depth,n,e,i),d=r.topY-l.bottomY,u={start:{x:l.centerX,y:l.bottomY},end:{x:r.centerX,y:r.topY},controlPoint:{x:r.centerX,
y:r.topY-d}};t.moveTo(u.start.x,u.start.y),t.lineTo(u.end.x,u.end.y)}t.stroke()}},_render:function(t,e){var i=document.createElement("canvas"),n=$(this.getDom()).width(),o=this._getDepthMap(t);this._currentDepthMap=o,e&&e.highlight&&(o[e.highlight.depth][e.highlight.rowIndex].highlight=!0);var a=this.util.map2Array(o).length*this.params.layerHeight;i.setAttribute("height",a+"px"),i.setAttribute("width",n+"px");var s=i.getContext("2d");this._drawNodes(s,n,this.params.layerHeight,o),this.getDom().html(i)},_nodeData:null,_currentDepthMap:null,nodeSelected:function(t){},setValue:function(t){this._nodeData=PJF.apply({},t),this._render(this._nodeData)},init:function(t){this.___constructor(),t.layerHeight=t.layerHeight||80,this.nodeSelected=t.nodeSelected||this.nodeSelected;var r=this;this.getDom().click(function(t){var e=t.offsetX,i=t.offsetY,n=parseInt(i/r.params.layerHeight)+1,o=r._currentDepthMap[n].length,a=r._calcNodeOccupiedWidth(o,$(r.getDom()).width()),s=parseInt(e/a)
;r._render(r._nodeData,{highlight:{depth:n,rowIndex:s}}),r.nodeSelected(r._currentDepthMap[n][s].node)}),this.setValue(t.initValue)}}),a=PJF.extend(e,{outputData:{expression:"true",description:null},conditions:[],_parentGetter:null,_cond2Str:function(t,e,i){var n=[];for(var o in t){var a=t[o],s=e||function(t){return"['"+t.field+"']"+t.operator+t.value};n.push(s.call(this,a))}return n.join(i?"且":"&&")},_conds2Str:function(t,e,i){var n=[];for(var o in this.conditions)n.push(this._cond2Str(this.conditions[o].condition,e,i));return 0<n.length?n.join(i?" 或 ":"||"):"true"},_getValue:function(){return this.outputData.expression=this._conds2Str(this.conditions),this._parentGetter()},setValue:function(t){if(this.outputData.expression=t.expression||"true",this.setFieldValueByFieldName("description",t.description||""),this.outputData.expression!==undefined&&"true"!==this.outputData.expression){var e=[],i=t.expression.split("||");for(var n in i){var o=i[n].split("&&"),a=[];for(var s in o){
var r=o[s].split(new RegExp("(==|!=|<=|>=|>|<)"));3==r.length?(r[0]=r[0].replace(/[\[|\]]/g,"").replace(/'/g,""),a.push({field:r[0],operator:r[1],value:r[2]})):console.error("[%s]分离审批分支条件失败！输入值%s",this.getClassName(),o[s])}e.push({condition:a})}this.conditions=e,this._conditionsUpdated()}else this.conditions=[]},getClassName:function(){return"PJF.ui.flow-designer.ApproverConditionInput"},operatorName2OperatorMap:{"等于":"==","不等于":"!=","大于":">","小于":"<","大于等于":">=","小于等于":"<="},_conditionsUpdated:function(){var t=$("#"+this.getInnerElemDomId("span.condition-disp"));this.conditionGroupGrid!==undefined&&this.conditionGroupGrid.loadData(this.conditions),t.text(this._conds2Str(this.conditions,this._condChineseFormatter,!0))},_setCondition:function(t,e){this.conditions[t]=e,this._conditionsUpdated()},_addCondition:function(t){this.conditions.push(t),this._conditionsUpdated()},openEditWindow:function(e){var i=this,t=new o({windowTitle:"设置条件",control:n,controlConfig:{name:"条件",fields:[{
name:"field",title:"字段",type:"select",options:i.util.objectArray2PlainMap(i.params.fieldGetter.call(i),"title","name")},{name:"operator",title:"操作符",type:"select",options:i.operatorName2OperatorMap},{name:"value",title:"值",type:"text"}]},showSaveBtn:!0,onSave:function(t){i._setCondition(e,{condition:t})}});t.setValue(i.conditions[e].condition),t.show()},_condChineseFormatter:function(t){var e=this.util.revertKVMap(this.operatorName2OperatorMap);return this.util.objectArray2PlainMap(this.params.fieldGetter.call(this),"name","title")[t.field]+e[t.operator]+t.value},init:function(t){this.___constructor(),this.conditions=new Array,this.getDom().html(s("approver-condition-tmpl")),this.createLabel(t.domId);var e=this;this._parentGetter=this.getValue,this.getValue=this._getValue,this.bindOutput("description",new PJF.ui.textfield({dom:e.getInnerElemDomId("textarea.condition-description"),type:"multi"})),new PJF.ui.linkButton({dom:e.getInnerElemDomId("span.condition-set-btn"),name:"设置条件",
onclick:function(){var t=$("#"+e.getInnerElemDomId("div.condition-set-window-container"));e.conditionGroupGrid=new PJF.ui.grid({dom:e.getInnerElemDomId("div.condition-group-grid"),width:"auto",columns:[[{title:"条件组",field:"condition",formatter:function(t){return e._cond2Str(t,e._condChineseFormatter,!0)}}]],toolbar:[{bt:"custom",text:"添加",onclick:function(){e._addCondition({condition:[]}),e.openEditWindow(e.conditions.length-1)}},{bt:"del"},{bt:"custom",text:"编辑",onclick:function(){e.openEditWindow(e.conditionGroupGrid.getCurrentIndex())}}]}),e.conditionGroupGrid.loadData(e.conditions),t.show(),t.window({modal:!0})}})}}),l=PJF.extend(e,{outputData:{organizations:[],operators:null,positions:null},_unsetOperators:function(){this.outputData.operators=[]},_unsetPositions:function(){this.outputData.positions=[]},_updateApproverDisp:function(){
var t=$("#"+this.getInnerElemDomId("span.select-approver-disp")),e=this.getFieldValueByFieldName("operators"),i=this.getFieldValueByFieldName("positions");e&&0<e.length?t.text("有权审批人："+this.util.objectArray2FieldArray(this.getFieldValueByFieldName("operators"),"operatorId").join(",")):i&&0<i.length&&t.text("有权审批岗位："+this.util.objectArray2FieldArray(this.getFieldValueByFieldName("positions"),"positionId").join(","))},_setOrgs:function(t){t===undefined||t.length<=0||(this.outputData.organizations=t,$("#"+this.getInnerElemDomId("span.select-org-disp")).text(this.util.keyArray2ValueArray(t,this._orgId2NameMap).join(",")))},_baseSetValue:null,_setValue:function(t){var e=this.util.deepCopy(t);e.organizations!==undefined&&this._setOrgs(e.organizations),this._baseSetValue(t),this._updateApproverDisp()},_orgId2NameMap:{SUBMIT_ORG:"交易提交机构同机构",LV1:"交易提交机构所在一级行",LV2:"交易提交机构所在二级行"},getClassName:function(){return"PJF.ui.flow-designer.ApproverSelect"},init:function(t){this.___constructor(),
this.getDom().html(s("approver-select-tmpl")),this.createLabel(t.domId),this._baseSetValue=this.setValue,this.setValue=this._setValue;var i=this;new o({showWindowBtnName:"精确选择机构",showWindowBtnDomId:i.getInnerElemDomId("span.button-select-org"),windowTitle:"精确选择机构",control:PJF.extend(PJF.ui.orgTree,{getValue:function(){return this.getCheckedNodes()}}),controlConfig:{chkStyle:"radio",mutiple:!1,url:"/bosWeb/ecpJson",onLoadAfter:function(){}},showSaveBtn:!0,onSave:function(t){for(var e in r().debug("[%s]选中的机构为:%s",i.getClassName(),JSON.stringify(t)),t)i._orgId2NameMap[t[e].nodeId]=t[e].text;i._setOrgs(i.util.objectArray2FieldArray(t,"nodeId"))}}),new o({showWindowBtnName:"交易提交机构上级机构",showWindowBtnDomId:i.getInnerElemDomId("span.button-select-org-2"),windowTitle:"交易提交机构上级机构",control:PJF.ui.select,controlConfig:{data:[{name:"SUBMIT_ORG",desc:"交易提交机构同机构"},{name:"LV1",desc:"所在一级行"},{name:"LV2",desc:"所在二级行"}]},showSaveBtn:!0,onSave:function(t){i._setOrgs([t])}}),
this.bindOutput("operators",new o({showWindowBtnDomId:this.getInnerElemDomId("span.button-select-operators"),showWindowBtnName:"指定审批人",windowTitle:"指定审批人",showWindowBtnStyle:"assistant",control:n,controlConfig:{fields:[{title:"员工编号",name:"operatorId",type:"text",required:!0}],name:"审批人"},showSaveBtn:!0,onSave:function(){i._unsetPositions(),i._updateApproverDisp()}})),this.bindOutput("positions",new o({showWindowBtnDomId:this.getInnerElemDomId("span.button-select-positions"),showWindowBtnName:"指定岗位",windowTitle:"指定岗位",showWindowBtnStyle:"assistant",control:n,controlConfig:{fields:[{title:"岗位编号",name:"positionId",type:"text",required:!0}],name:"审批岗位"},onSave:function(){i._unsetOperators(),i._updateApproverDisp()},showSaveBtn:!0}))}}),d=PJF.extend(e,{getClassName:function(){return"PJF.ui.flow-designer.ApprovalStepInput"},outputData:{title:null,description:null,"@type":"com.ccb.p2.approval.workflow.template.model.extend.node.spa.SPANodeTemplate",type:"SINGLE_PERSON_APPROVAL",
participantsInfo:null,branches:[]},init:function(t){this.___constructor(),this.getDom().html(s("approval-step-input-tmpl")),this.createLabel(t.domId);this.bindOutput("title",new PJF.ui.textfield({dom:this.getInnerElemDomId("input.node-title"),required:!0,missingMessage:"必填"})),this.bindOutput("description",new PJF.ui.textfield({dom:this.getInnerElemDomId("textarea.node-description"),required:!0,dataType:"multi",missingMessage:"必填"})),this.bindOutput("participantsInfo",new l({domId:this.getInnerElemDomId("div.approver-info-container")}))}}),u=PJF.extend(e,{getClassName:function(){return"PJF.ui.flow-designer.ApprovalStepWithConditionInput"},outputData:{condition:{expression:"true",description:"无条件"},nodeTemplate:null},emptyStep:{condition:{expression:"true",description:"无条件"},nodeTemplate:{title:"",description:"",participantsInfo:{}}},fieldGetter:null,_closeCondition:function(){this.outputData.condition={expression:"true",description:"无条件"},this.unbindOutput("condition"),
$("#"+this.getInnerElemDomId("div.approval-step-condition-container")).html("")},_showCondition:function(t){this.outputData.condition=null;var e=new a({domId:this.getInnerElemDomId("div.approval-step-condition-container"),fieldGetter:this.fieldGetter});this.bindOutput("condition",e),t&&e.setValue(t)},_setValue:function(t){r().debug("[%s]开始设置带条件审批步骤控件的值:%s",this.getClassName(),JSON.stringify(t)),"true"!==t.condition.expression?(this._typeSelect.setValue("BRANCH"),this._showCondition(t.condition)):(this._typeSelect.setValue("NO_BRANCH"),this._closeCondition()),this.parentSetter(t)},_typeSelect:null,init:function(t){this.___constructor(),this.getDom().html(s("approval-step-condition-input-tmpl")),this.createLabel(t.domId);var e=this;this.fieldGetter=t.fieldGetter,this.bindOutput("nodeTemplate",new d({domId:e.getInnerElemDomId("div.approval-step-input-container")})),this._typeSelect=new PJF.ui.select({dom:e.getInnerElemDomId("span.node-type"),data:[{name:"NO_BRANCH",desc:"指定唯一下一级审批机构"},{
name:"BRANCH",desc:"按条件指定不同下一级审批机构"}],param:{},name:"nodeType",nullOption:!1,onChange:function(){switch(e._typeSelect.getValue()){case"NO_BRANCH":e._closeCondition();break;case"BRANCH":e._showCondition()}}}),this.parentSetter=this.setValue,this.setValue=this._setValue}}),h=PJF.extend(e,{getClassName:function(){return"PJF.ui.flow-designer.WorkflowNodeRootTemplateEditor"},outputData:{title:"审批开始",description:"审批开始流转",type:"ROOT",branches:[]},currentNode:null,_getCurrentNode:function(){return this.currentNode===undefined||null==this.currentNode?{nodeTemplate:this.outputData,condition:{expression:"true"}}:this.currentNode},_getCurrentNodeTitle:function(){return this._getCurrentNode().nodeTemplate.title},_updateCurrentNode:function(t){r().debug("[%s]开始更新当前选中节点",this.getClassName()),r().debug("[%s]需要更新的节点信息:%s",this.getClassName(),JSON.stringify(t)),r().debug("[%s]当前节点信息:%s",this.getClassName(),JSON.stringify(this._getCurrentNode())),
this._getCurrentNode().nodeTemplate!==this.outputData?(delete t.branches,t.nodeTemplate!==undefined&&delete t.nodeTemplate.branches,this._getCurrentNode().condition=this.util.deepCopy(t.condition),PJF.apply(this._getCurrentNode().nodeTemplate,t.nodeTemplate)):r().warn("[%s]根节点不允许修改",this.getClassName())},_imgControl:null,updateImage:function(){this._imgControl.setValue({nodeTemplate:this.outputData,condition:{expression:"true"}})},_fieldGetter:null,_createNodeEditControl:function(i,t){var n=this,o=$("#"+n.getInnerElemDomId("div.approval-step-add-container")),e=o.find(".close-btn");o.hide();var a=new u({domId:n.getInnerElemDomId("div.approval-step-add"),fieldGetter:this._fieldGetter});if(e.unbind("click"),e.click(function(){o.hide()}),"ADD"===i){var s=n.util.deepCopy(a.emptyStep);r().debug("[%s]开始添加新步骤，初始化数据：%s",n.getClassName(),JSON.stringify(s)),a.setValue(s),$("#"+n.getInnerElemDomId("p.approval-step-title")).text("添加审批步骤到["+n._getCurrentNodeTitle()+"]后")}else n.currentNode=t,
i="UPDATE",$("#"+n.getInnerElemDomId("p.approval-step-title")).text("维护审批步骤["+n._getCurrentNodeTitle()+"]"),a.setValue(n.util.deepCopy(t));return o.show(),new PJF.ui.linkButton({dom:this.getInnerElemDomId("div.approval-step-add-container > div.wrapper > div.save-btn-container > span.save-btn"),name:"保存",onclick:function(t){r().debug("[%s]开始保存审批步骤信息",n.getClassName());var e=a.getValue();r().debug("[%s]编辑后的审批步骤信息：%s",n.getClassName(),JSON.stringify(e)),"ADD"===i?(r().debug("[%s]当前为新增审批步骤",n.getClassName()),r().debug("[%s]这个步骤是[%s]的下一级审批步骤",n.getClassName(),JSON.stringify(n._getCurrentNode())),n._getCurrentNode().nodeTemplate.branches.push(e)):(r().debug("[%s]当前为修改审批步骤",n.getClassName()),n._updateCurrentNode(e)),r().debug("[%s]开始更新流程图视图",n.getClassName()),n.updateImage(),o.hide(),r().debug("[%s]保存完毕，隐藏对应的DOM",n.getClassName())},style:"assistant"}),a},init:function(t){this.___constructor(),this.getDom().html(s("workflow-node-root-template-editor-tmpl")),this.createLabel(t.domId);var e=this
;this._fieldGetter=t.fieldGetter,this._imgControl=new i({domId:this.getInnerElemDomId("div.flow-image-container"),initValue:{nodeTemplate:e.outputData,condition:{expression:"true"}},nodeSelected:function(t){r().debug("[%s]节点被选中，节点信息：%s",this.getClassName(),JSON.stringify(t)),e._createNodeEditControl("UPDATE",t)}}),new PJF.ui.linkButton({dom:this.getInnerElemDomId("span.add-step"),name:"增加步骤",onclick:function(t){e._createNodeEditControl("ADD")},style:"assistant"}),e._createNodeEditControl("ADD")},setValue:function(t){PJF.apply(this.outputData,this.util.deepCopy(t)),this.updateImage()}}),p=PJF.extend(e,{getClassName:function(){return"PJF.ui.flow-designer.flowDesigner"},outputData:{title:null,description:null,inputFields:null,workflowNodeTemplateRoot:null},init:function(t){this.___constructor(),this.getDom().html(s("tmpl")),this.createLabel(t.domId);var e=this;this.bindOutput("title",new PJF.ui.textfield({dom:this.getInnerElemDomId("input.title"),required:!0,missingMessage:"必填"})),
this.bindOutput("description",new PJF.ui.textfield({dom:this.getInnerElemDomId("textarea.description"),required:!0,dataType:"multi",missingMessage:"必填"})),this.bindOutput("inputFields",new o({showWindowBtnDomId:this.getInnerElemDomId("span.edit-input-field"),showWindowBtnName:"编辑录入要素",windowTitle:"编辑录入要素",control:n,controlConfig:{name:"录入要素",fields:[{title:"字段名",name:"title",type:"text",tip:"请输入字段名，如[转账金额]",required:!0},{title:"字段类型",name:"type",type:"select",options:{"金额":"AMT","文本":"TEXT"},required:!0},{title:"字段英文名",name:"name",type:"text",tip:"请输入字段英文名或拼音，如[transferAmt]",required:!0}]},showSaveBtn:!0})),this.bindOutput("workflowNodeTemplateRoot",new h({domId:this.getInnerElemDomId("div.workflow-node-root-template-editor-container"),fieldGetter:function(){var t=e.getFieldValueByFieldName("inputFields");return r().debug("[%s]开始获取录入要素，内容:%s",this.getClassName(),JSON.stringify(t)),t}}))},validateParam:function(t){return!0}})
;t.ui.flowDesigner!==undefined?t.ui.flowDesigner=PJF.extend(p,t.ui.flowDesigner):t.ui.flowDesigner=p,r().debug("flow-designer结束")}(PJF)}catch(e){console&&(console.log("加载flow-designer失败！"),console.log(e))}!function(f){f.fn.qrcode=function(l){var i;function e(t){this.mode=i,this.data=t}function d(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function u(t,e){if(null==t.length)throw Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=Array(t.length-i+e);for(var n=0;n<t.length-i;n++)this.num[n]=t[n+i]}function h(t,e){this.totalCount=t,this.dataCount=e}function s(){this.buffer=[],this.length=0}e.prototype={getLength:function(){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}},d.prototype={addData:function(t){this.dataList.push(new e(t)),this.dataCache=null},isDark:function(t,e){
if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){if(this.typeNumber<1){var t=1;for(t=1;t<40;t++){for(var e=h.getRSBlocks(t,this.errorCorrectLevel),i=new s,n=0,o=0;o<e.length;o++)n+=e[o].dataCount;for(o=0;o<this.dataList.length;o++)e=this.dataList[o],i.put(e.mode,4),i.put(e.getLength(),p.getLengthInBits(e.mode,t)),e.write(i);if(i.getLengthInBits()<=8*n)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[i][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),
this.setupTypeInfo(t,e),7<=this.typeNumber&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=d.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var i=-1;i<=7;i++)if(!(t+i<=-1||this.moduleCount<=t+i))for(var n=-1;n<=7;n++)e+n<=-1||this.moduleCount<=e+n||(this.modules[t+i][e+n]=0<=i&&i<=6&&(0==n||6==n)||0<=n&&n<=6&&(0==i||6==i)||2<=i&&i<=4&&2<=n&&n<=4)},getBestMaskPattern:function(){for(var t=0,e=0,i=0;i<8;i++){this.makeImpl(!0,i);var n=p.getLostPoint(this);(0==i||n<t)&&(t=n,e=i)}return e},createMovieClip:function(t,e,i){for(t=t.createEmptyMovieClip(e,i),this.make(),e=0;e<this.modules.length;e++){i=1*e;for(var n=0;n<this.modules[e].length;n++){var o=1*n;this.modules[e][n]&&(t.beginFill(0,100),t.moveTo(o,i),t.lineTo(o+1,i),t.lineTo(o+1,i+1),t.lineTo(o,i+1),t.endFill())}}return t},setupTimingPattern:function(){
for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=0==t%2);for(t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=0==t%2)},setupPositionAdjustPattern:function(){for(var t=p.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var i=0;i<t.length;i++){var n=t[e],o=t[i];if(null==this.modules[n][o])for(var a=-2;a<=2;a++)for(var s=-2;s<=2;s++)this.modules[n+a][o+s]=-2==a||2==a||-2==s||2==s||0==a&&0==s}},setupTypeNumber:function(t){for(var e=p.getBCHTypeNumber(this.typeNumber),i=0;i<18;i++){var n=!t&&1==(e>>i&1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=n}for(i=0;i<18;i++)n=!t&&1==(e>>i&1),this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=n},setupTypeInfo:function(t,e){for(var i=p.getBCHTypeInfo(this.errorCorrectLevel<<3|e),n=0;n<15;n++){var o=!t&&1==(i>>n&1);n<6?this.modules[n][8]=o:n<8?this.modules[n+1][8]=o:this.modules[this.moduleCount-15+n][8]=o}for(n=0;n<15;n++)o=!t&&1==(i>>n&1),
n<8?this.modules[8][this.moduleCount-n-1]=o:n<9?this.modules[8][15-n-1+1]=o:this.modules[8][15-n-1]=o;this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var i=-1,n=this.moduleCount-1,o=7,a=0,s=this.moduleCount-1;0<s;s-=2)for(6==s&&s--;;){for(var r=0;r<2;r++)if(null==this.modules[n][s-r]){var c=!1;a<t.length&&(c=1==(t[a]>>>o&1)),p.getMask(e,n,s-r)&&(c=!c),this.modules[n][s-r]=c,-1==--o&&(a++,o=7)}if((n+=i)<0||this.moduleCount<=n){n-=i,i=-i;break}}}},d.PAD0=236,d.PAD1=17,d.createData=function(t,e,i){e=h.getRSBlocks(t,e);for(var n=new s,o=0;o<i.length;o++){var a=i[o];n.put(a.mode,4),n.put(a.getLength(),p.getLengthInBits(a.mode,t)),a.write(n)}for(o=t=0;o<e.length;o++)t+=e[o].dataCount;if(n.getLengthInBits()>8*t)throw Error("code length overflow. ("+n.getLengthInBits()+">"+8*t+")");for(n.getLengthInBits()+4<=8*t&&n.put(0,4);0!=n.getLengthInBits()%8;)n.putBit(!1);for(;!(n.getLengthInBits()>=8*t)&&(n.put(d.PAD0,8),!(n.getLengthInBits()>=8*t));)n.put(d.PAD1,8)
;return d.createBytes(n,e)},d.createBytes=function(t,e){for(var i=0,n=0,o=0,a=Array(e.length),s=Array(e.length),r=0;r<e.length;r++){var c=e[r].dataCount,l=e[r].totalCount-c;n=Math.max(n,c),o=Math.max(o,l);a[r]=Array(c);for(var d=0;d<a[r].length;d++)a[r][d]=255&t.buffer[d+i];for(i+=c,d=p.getErrorCorrectPolynomial(l),c=new u(a[r],d.getLength()-1).mod(d),s[r]=Array(d.getLength()-1),d=0;d<s[r].length;d++)l=d+c.getLength()-s[r].length,s[r][d]=0<=l?c.get(l):0}for(d=r=0;d<e.length;d++)r+=e[d].totalCount;for(i=Array(r),d=c=0;d<n;d++)for(r=0;r<e.length;r++)d<a[r].length&&(i[c++]=a[r][d]);for(d=0;d<o;d++)for(r=0;r<e.length;r++)d<s[r].length&&(i[c++]=s[r][d]);return i},i=4;for(var p={
PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=p.getBCHDigit(e)-p.getBCHDigit(p.G15);)e^=p.G15<<p.getBCHDigit(e)-p.getBCHDigit(p.G15);return(t<<10|e)^p.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=p.getBCHDigit(e)-p.getBCHDigit(p.G18);)e^=p.G18<<p.getBCHDigit(e)-p.getBCHDigit(p.G18);return t<<12|e},
getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return p.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,i){switch(t){case 0:return 0==(e+i)%2;case 1:return 0==e%2;case 2:return 0==i%3;case 3:return 0==(e+i)%3;case 4:return 0==(Math.floor(e/2)+Math.floor(i/3))%2;case 5:return 0==e*i%2+e*i%3;case 6:return 0==(e*i%2+e*i%3)%2;case 7:return 0==(e*i%3+(e+i)%2)%2;default:throw Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new u([1],0),i=0;i<t;i++)e=e.multiply(new u([1,o.gexp(i)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case 1:return 10;case 2:return 9;case i:case 8:return 8;default:throw Error("mode:"+t)}else if(e<27)switch(t){case 1:return 12;case 2:return 11;case i:return 16;case 8:return 10;default:throw Error("mode:"+t)}else{if(!(e<41))throw Error("type:"+e);switch(t){case 1:return 14;case 2:return 13;case i:return 16;case 8:return 12;default:throw Error("mode:"+t)}}},
getLostPoint:function(t){for(var e=t.getModuleCount(),i=0,n=0;n<e;n++)for(var o=0;o<e;o++){for(var a=0,s=t.isDark(n,o),r=-1;r<=1;r++)if(!(n+r<0||e<=n+r))for(var c=-1;c<=1;c++)o+c<0||e<=o+c||0==r&&0==c||s==t.isDark(n+r,o+c)&&a++;5<a&&(i+=3+a-5)}for(n=0;n<e-1;n++)for(o=0;o<e-1;o++)a=0,t.isDark(n,o)&&a++,t.isDark(n+1,o)&&a++,t.isDark(n,o+1)&&a++,t.isDark(n+1,o+1)&&a++,(0==a||4==a)&&(i+=3);for(n=0;n<e;n++)for(o=0;o<e-6;o++)t.isDark(n,o)&&!t.isDark(n,o+1)&&t.isDark(n,o+2)&&t.isDark(n,o+3)&&t.isDark(n,o+4)&&!t.isDark(n,o+5)&&t.isDark(n,o+6)&&(i+=40);for(o=0;o<e;o++)for(n=0;n<e-6;n++)t.isDark(n,o)&&!t.isDark(n+1,o)&&t.isDark(n+2,o)&&t.isDark(n+3,o)&&t.isDark(n+4,o)&&!t.isDark(n+5,o)&&t.isDark(n+6,o)&&(i+=40);for(o=a=0;o<e;o++)for(n=0;n<e;n++)t.isDark(n,o)&&a++;return i+10*(t=Math.abs(100*a/e/e-50)/5)}},o={glog:function(t){if(t<1)throw Error("glog("+t+")");return o.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return o.EXP_TABLE[t]},EXP_TABLE:Array(256),
LOG_TABLE:Array(256)},t=0;t<8;t++)o.EXP_TABLE[t]=1<<t;for(t=8;t<256;t++)o.EXP_TABLE[t]=o.EXP_TABLE[t-4]^o.EXP_TABLE[t-5]^o.EXP_TABLE[t-6]^o.EXP_TABLE[t-8];for(t=0;t<255;t++)o.LOG_TABLE[o.EXP_TABLE[t]]=t;return u.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=Array(this.getLength()+t.getLength()-1),i=0;i<this.getLength();i++)for(var n=0;n<t.getLength();n++)e[i+n]^=o.gexp(o.glog(this.get(i))+o.glog(t.get(n)));return new u(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=o.glog(this.get(0))-o.glog(t.get(0)),i=Array(this.getLength()),n=0;n<this.getLength();n++)i[n]=this.get(n);for(n=0;n<t.getLength();n++)i[n]^=o.gexp(o.glog(t.get(n))+e);return new u(i,0).mod(t)}},
h.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],
h.getRSBlocks=function(t,e){var i=h.getRsBlockTable(t,e);if(null==i)throw Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var n=i.length/3,o=[],a=0;a<n;a++)for(var s=i[3*a+0],r=i[3*a+1],c=i[3*a+2],l=0;l<s;l++)o.push(new h(r,c));return o},h.getRsBlockTable=function(t,e){switch(e){case 1:return h.RS_BLOCK_TABLE[4*(t-1)+0];case 0:return h.RS_BLOCK_TABLE[4*(t-1)+1];case 3:return h.RS_BLOCK_TABLE[4*(t-1)+2];case 2:return h.RS_BLOCK_TABLE[4*(t-1)+3]}},s.prototype={get:function(t){return 1==(this.buffer[Math.floor(t/8)]>>>7-t%8&1)},put:function(t,e){for(var i=0;i<e;i++)this.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},"string"==typeof l&&(l={text:l}),l=f.extend({},{render:"canvas",width:256,height:256,typeNumber:-1,correctLevel:2,background:"#ffffff",foreground:"#000000"},l),this.each(function(){
var t;if("canvas"==l.render){(t=new d(l.typeNumber,l.correctLevel)).addData(l.text),t.make();var e=document.createElement("canvas");e.width=l.width,e.height=l.height;for(var i=e.getContext("2d"),n=l.width/t.getModuleCount(),o=l.height/t.getModuleCount(),a=0;a<t.getModuleCount();a++)for(var s=0;s<t.getModuleCount();s++){i.fillStyle=t.isDark(a,s)?l.foreground:l.background;var r=Math.ceil((s+1)*n)-Math.floor(s*n),c=Math.ceil((a+1)*n)-Math.floor(a*n);i.fillRect(Math.round(s*n),Math.round(a*o),r,c)}}else for((t=new d(l.typeNumber,l.correctLevel)).addData(l.text),t.make(),e=f("<table></table>").css("width",l.width+"px").css("height",l.height+"px").css("border","0px").css("border-collapse","collapse").css("background-color",l.background),i=l.width/t.getModuleCount(),n=l.height/t.getModuleCount(),o=0;o<t.getModuleCount();o++)for(a=f("<tr></tr>").css("height",n+"px").appendTo(e),
s=0;s<t.getModuleCount();s++)f("<td></td>").css("width",i+"px").css("background-color",t.isDark(o,s)?l.foreground:l.background).appendTo(a);t=e,jQuery(t).appendTo(this)})}}(jQuery),PJF.namespace("PJF.debug.constants"),PJF.debug={createClientInfo:function(){PJF.userInfo={terminalId:"",orgCode:"110378300",userId:"77976569",userName:"董杰",rightWidgets:[],userCode:"77976569",ccbinsChnShrtnm:"北京银地支行",usrNmCpaFullnm:"dongjie",operLevel:"",userCcbssState:"",empeIdLandNm:"dongjie1.bj",blngInsid:"110378300",ccbsId:"110378300021",ccbEmpid:"77976569",hmnrscEmpid:"110372001040008"},PJF.otherInfo={topId:"",txnList:[],topPort:"",logicTerminalNo:"110378300A01003",token:"ticket-1-MFWqLjUShceoi9vgRDmWjWNiCMj9e0Bbbll",macAddress:"shenye.zh",chaTypeId:"002911037830000        ",clientIP:"128.160.216.133",chaType:"20170029"},PJF.orgInfo={orgType:"104030100",orgInstRgonIdCd:"BJ",orgState:"2",loginModeName:"",acCrTpCdSet:"B01",orgPropertyName:"",provinceCode:"",prefLngCd:"zh",parentOrgCode:"110005300",
ctyRgonCd:"156",orgPhysicClass:"",orgCode:"110378300",preBusiDay:"",ancestorOrgCode:"110005300",instSvrlLgPsnNm:"建行总行",adivCd:"110106",orgShortCName:"北京银地支行",orgEName:"BEIJING YINDI OFFICE",postCode:"",loginMode:"",hrMns:"8",parentOrgLevel:"3",instSvrlLgPsnID:"CN000",lclCcyCd:"156",dccOrgCode:"",instLevel1BranchId:"110000000",tmzonCd:"29",instLevel1BranchChnFullNm:"中国建设银行股份有限公司北京市分行",orgCName:"中国建设银行股份有限公司北京银地支行",orgEAdd:"",orgLocationInfo:{bldNm:"",cntyanddstcTpcd:"",strNm:"",urbnAtnmsdstcTpcd:"",ltt:"",provAtnmSrgonTpcd:"",rskCtyInd:"",ccbinsId:"110378300",floorNum:"",gergSptlCordDsc:"",rsdncCommNm:"",provAtnmsrgonCd:"",zipecd:"100070",unitNo:"",ccbinsandloreledTm:null,lgt:"",ccbinsandlorelstTm:null,dtlAdr:"银地家园1号楼首层04北侧",cntyanddstcCd:"",gergTpcd:"",roomNo:"",ccbinsandlorelmdfDsc:"",gergDsc:"",bdno:"",loId:"",urbnAtnmsdstcCd:"",ctyCd:"156",ccbinsAndLoRetpcd:"",provAtnmsrgonTpcd:"",mlbxNo:""},orgShortEName:"",orgCAdd:"",curBusiDay:"",orgClass:"4",orgProperty:"",levOne_code:"110000",
levTwo_code:"110000"},PJF.roleInfo={positionPriority:"",signControls:[],noRepeatRoleAuthInfoList:[],authRolesMap:{},id:"G00000000006_110378300",positionTypeCode:"",roleAuthInfos:"",expNode2:"",pstMgrDepId:"010230000",pstMgrDeptNm:"总行渠道与运营管理部",expNode1:"110378300_G00000000006=G00000000006|110378300_G00000000007=G00000000007",orgCode:"110378300",positionId:"G00000000006",roleAuthInfoList:[{ahrNm:"注销账户或解除协议",pstRlId:"J000000048",aplId:"Y0000000000000000033",pstRlNm:"财富交易员",avyId:"n22.002.050.010",ahrId:"85"}],positionDesc:"高级柜员",systemId:"",positionName:"高级柜员",insFTUInd:"0"},PJF.userInfo.userName=PJF.debug.constants.USER_NAME||PJF.userInfo.userName,PJF.userInfo.userCode=PJF.debug.constants.USER_CODE||PJF.userInfo.userCode,PJF.userInfo.orgCode=PJF.debug.constants.ORG_CODE||PJF.userInfo.orgCode,PJF.userInfo.ccbsId=PJF.debug.constants.CCBS_ID||PJF.userInfo.ccbsId,PJF.otherInfo.token=PJF.debug.constants.TOKEN||PJF.otherInfo.token,
PJF.otherInfo.transSerNo=PJF.debug.constants.TRANS_SER_NO||PJF.otherInfo.transSerNo,PJF.otherInfo.macAddress=PJF.debug.constants.MAC_ADDRESS||PJF.otherInfo.macAddress,PJF.otherInfo.clientIP=PJF.debug.constants.CLIENT_IP||PJF.otherInfo.clientIP,PJF.otherInfo.logicTerminalNo=PJF.debug.constants.LOGIC_TERMINAL_NO||PJF.otherInfo.logicTerminalNo,PJF.orgInfo.orgShortCName=PJF.debug.constants.ORG_SHORT_CNAME||PJF.orgInfo.orgShortCName,PJF.orgInfo.orgClass=PJF.debug.constants.ORG_CLASS||PJF.orgInfo.orgClass,PJF.roleInfo.positionId=PJF.debug.constants.POSITION_ID||PJF.roleInfo.positionId,PJF.roleInfo.noRepeatRoleAuthInfoList=PJF.debug.constants.NO_REPEAT_ROLE_AUTH_INFO_LIST||PJF.roleInfo.noRepeatRoleAuthInfoList,PJF.roleInfo.orgCode=PJF.debug.constants.ORG_CODE||PJF.roleInfo.orgCode}},$(function(){if(!PJF.communication.client.isInP2()&&PJF.constants.FORBIDDEN_BROWSER&&!PJF.constants.D2D&&window.top===window.self){
for(var t=0;t<PJF.constants.BROWSER_WHITE_LIST.length;t++)if(-1!=location.href.indexOf(PJF.constants.BROWSER_WHITE_LIST[t]))return;window.location.href="http://"+window.location.host+"/bosWeb/page/common/notFoundPage.html"}PJF.communication.client.isInP2()&&"true"==PJF.html.getUrlParam("PJF_PAGE_READY")&&PJF.communication.client.sendEvent("PJF_PAGE_READY",location.href)}),JSLoader.loadJavaScript(CONTEXT_PATH+"PJFServlet?operType=load"),function(i){function n(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var o={};n.m=i,n.c=o,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=12)}([function(t,e,i){"use strict";function n(t,e,i){
return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0});var o,a=e.SET_A=0,s=e.SET_B=1,r=e.SET_C=2,c=(e.SHIFT=98,e.START_A=103),l=e.START_B=104,d=e.START_C=105;e.MODULO=103,e.STOP=106,e.SET_BY_CODE=(n(o={},c,a),n(o,l,s),n(o,d,r),o),e.SWAP={101:a,100:s,99:r},e.A_START_CHAR=String.fromCharCode(208),e.B_START_CHAR=String.fromCharCode(209),e.C_START_CHAR=String.fromCharCode(210),e.A_CHARS="[\0-_È-Ï]",e.B_CHARS="[ -È-Ï]",e.C_CHARS="(Ï*[0-9]{2}Ï*)",
e.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]
},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t};e["default"]=function(t,e){return n({},t,e)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=i(13),s=(n=a)&&n.__esModule?n:{"default":n},c=i(0),r=function(t){function r(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e
}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t.substring(1),e));return i.bytes=t.split("").map(function(t){return t.charCodeAt(0)}),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,s["default"]),o(r,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var t=this.bytes,e=t.shift()-105,i=c.SET_BY_CODE[e];if(void 0===i)throw new RangeError("The encoding does not start with a start character.");var n=r.next(t,1,i);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:r.getBar(e)+n.result+r.getBar((n.checksum+e)%c.MODULO)+r.getBar(c.STOP)}}}],[{key:"getBar",value:function(t){return c.BARS[t]?c.BARS[t].toString():""}
},{key:"correctIndex",value:function(t,e){if(e===c.SET_A){var i=t.shift();return i<32?i+64:i-32}return e===c.SET_B?t.shift()-32:10*(t.shift()-48)+t.shift()-48}},{key:"next",value:function(t,e,i){if(!t.length)return{result:"",checksum:0};var n=void 0,o=void 0;if(200<=t[0]){o=t.shift()-105;var a=c.SWAP[o];void 0!==a?n=r.next(t,e+1,a):(i!==c.SET_A&&i!==c.SET_B||o!==c.SHIFT||(t[0]=i===c.SET_A?95<t[0]?t[0]-96:t[0]:t[0]<32?t[0]+96:t[0]),n=r.next(t,e+1,i))}else o=r.correctIndex(t,i),n=r.next(t,e+1,i);var s=o*e;return{result:r.getBar(o)+n.result,checksum:s+n.checksum}}}]),r}();e["default"]=r},function(t,e,i){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){
if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function n(t,e){o(this,n);var i=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return i.name="InvalidInputException",i.symbology=t,i.input=e,i.message='"'+i.input+'" is not a valid input for '+i.symbology,i}return s(n,Error),n}(),r=function(t){function e(){o(this,e);var t=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return s(e,Error),e}(),c=function(t){function e(){o(this,e);var t=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}
return s(e,Error),e}();e.InvalidInputException=n,e.InvalidElementException=r,e.NoElementException=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var i in e)e.hasOwnProperty(i)&&"string"==typeof t[i=e[i]]&&(t[i]=parseInt(t[i],10));return"string"==typeof t.displayValue&&(t.displayValue="false"!=t.displayValue),t}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e["default"]={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}}},function(t,e,i){"use strict";function c(t,e){
return e.height+(e.displayValue&&0<t.text.length?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function l(t,e,i){if(i.displayValue&&e<t){if("center"==i.textAlign)return Math.floor((t-e)/2);if("left"==i.textAlign)return 0;if("right"==i.textAlign)return Math.floor(t-e)}return 0}function d(t,e,i){var n;if(i)n=i;else{if("undefined"==typeof document)return 0;n=document.createElement("canvas").getContext("2d")}return n.font=e.fontOptions+" "+e.fontSize+"px "+e.font,n.measureText(t).width}Object.defineProperty(e,"__esModule",{value:!0}),e.getTotalWidthOfEncodings=e.calculateEncodingAttributes=e.getBarcodePadding=e.getEncodingHeight=e.getMaximumHeightOfEncodings=void 0;var n,o=i(1),u=(n=o)&&n.__esModule?n:{"default":n};e.getMaximumHeightOfEncodings=function(t){for(var e=0,i=0;i<t.length;i++)t[i].height>e&&(e=t[i].height);return e},e.getEncodingHeight=c,e.getBarcodePadding=l,e.calculateEncodingAttributes=function(t,e,i){for(var n=0;n<t.length;n++){var o,a=t[n],s=(0,
u["default"])(e,a.options);o=s.displayValue?d(a.text,s,i):0;var r=a.data.length*s.width;a.width=Math.ceil(Math.max(o,r)),a.height=c(a,s),a.barcodePadding=l(o,r,s)}},e.getTotalWidthOfEncodings=function(t){for(var e=0,i=0;i<t.length;i++)e+=t[i].width;return e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(19);e["default"]={CODE128:n.CODE128,CODE128A:n.CODE128A,CODE128B:n.CODE128B,CODE128C:n.CODE128C}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),o=function(){function e(t){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),this.api=t}return n(e,[{key:"handleCatch",value:function(t){
if("InvalidInputException"!==t.name)throw t;if(this.api._options.valid===this.api._defaults.valid)throw t.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(t){try{var e=t.apply(void 0,arguments);return this.api._options.valid(!0),e}catch(t){return this.handleCatch(t),this.api}}}]),e}();e["default"]=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t){return t.marginTop=t.marginTop||t.margin,t.marginBottom=t.marginBottom||t.margin,t.marginRight=t.marginRight||t.margin,t.marginLeft=t.marginLeft||t.margin,t}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t){if("string"==typeof t)return function(t){var e=document.querySelectorAll(t);if(0!==e.length){for(var i=[],n=0;n<e.length;n++)i.push(a(e[n]));return i}}(t);if(Array.isArray(t)){for(var e=[],i=0;i<t.length;i++)e.push(a(t[i]));return e}
if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLImageElement)return n=t,{element:o=document.createElement("canvas"),options:(0,r["default"])(n),renderer:c["default"].CanvasRenderer,afterRender:function(){n.setAttribute("src",o.toDataURL())}};var n,o;if(t&&"svg"===t.nodeName||"undefined"!=typeof SVGElement&&t instanceof SVGElement)return{element:t,options:(0,r["default"])(t),renderer:c["default"].SVGRenderer};if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement)return{element:t,options:(0,r["default"])(t),renderer:c["default"].CanvasRenderer};if(t&&t.getContext)return{element:t,renderer:c["default"].CanvasRenderer};if(t&&"object"===(void 0===t?"undefined":s(t))&&!t.nodeName)return{element:t,renderer:c["default"].ObjectRenderer};throw new l.InvalidElementException}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){
return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(i(20)),c=n(i(22)),l=i(3);e["default"]=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(e){var n=[];return function t(e){if(Array.isArray(e))for(var i=0;i<e.length;i++)t(e[i]);else e.text=e.text||"",e.data=e.data||"",n.push(e)}(e),n}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function c(t,e,i){var n=new e(t=""+t,i);if(!n.valid())throw new f.InvalidInputException(n.constructor.name,t);var o=n.encode();o=(0,r["default"])(o);for(var a=0;a<o.length;a++)o[a].options=(0,l["default"])(i,o[a].options);return o}function o(){return s["default"].CODE128?"CODE128":Object.keys(s["default"])[0]}function a(t,e,i){e=(0,r["default"])(e);for(var n=0;n<e.length;n++)e[n].options=(0,l["default"])(i,e[n].options),(0,d["default"])(e[n].options);(0,d["default"])(i),new(0,t.renderer)(t.element,e,i).render(),
t.afterRender&&t.afterRender()}var s=n(i(7)),l=n(i(1)),r=n(i(11)),d=n(i(9)),u=n(i(10)),h=n(i(4)),p=n(i(8)),f=i(3),m=n(i(5)),g=function(){},v=function(t,e,i){var n=new g;if(void 0===t)throw Error("No element to render on was provided.");return n._renderProperties=(0,u["default"])(t),n._encodings=[],n._options=m["default"],n._errorHandler=new p["default"](n),void 0!==e&&((i=i||{}).format||(i.format=o()),n.options(i)[i.format](e,i).render()),n};for(var _ in v.getModule=function(t){return s["default"][t]},s["default"])s["default"].hasOwnProperty(_)&&function(s,r){g.prototype[r]=g.prototype[r.toUpperCase()]=g.prototype[r.toLowerCase()]=function(n,o){var a=this;return a._errorHandler.wrapBarcodeCall(function(){o.text=void 0===o.text?void 0:""+o.text;var t=(0,l["default"])(a._options,o);t=(0,h["default"])(t);var e=s[r],i=c(n,e,t);return a._encodings.push(i),a})}}(s["default"],_);g.prototype.options=function(t){return this._options=(0,l["default"])(this._options,t),this},
g.prototype.blank=function(t){var e=new Array(t+1).join("0");return this._encodings.push({data:e}),this},g.prototype.init=function(){var e;if(this._renderProperties)for(var t in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){e=this._renderProperties[t];var i=(0,l["default"])(this._options,e.options);"auto"==i.format&&(i.format=o()),this._errorHandler.wrapBarcodeCall(function(){var t=c(i.value,s["default"][i.format.toUpperCase()],i);a(e,t,i)})}},g.prototype.render=function(){if(!this._renderProperties)throw new f.NoElementException;if(Array.isArray(this._renderProperties))for(var t=0;t<this._renderProperties.length;t++)a(this._renderProperties[t],this._encodings,this._options);else a(this._renderProperties,this._encodings,this._options);return this},g.prototype._defaults=m["default"],"undefined"!=typeof window&&(window.JsBarcode=v),"undefined"!=typeof jQuery&&(jQuery.fn.JsBarcode=function(t,e){var i=[]
;return jQuery(this).each(function(){i.push(this)}),v(i,t,e)}),t.exports=v},function(e,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i["default"]=function t(e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.data=e,this.text=i.text||e,this.options=i}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=i(2),s=(n=a)&&n.__esModule?n:{"default":n},r=i(0),c=function(t){function i(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
;return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,r.A_START_CHAR+t,e))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,s["default"]),o(i,[{key:"valid",value:function(){return new RegExp("^"+r.A_CHARS+"+$").test(this.data)}}]),i}();e["default"]=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=i(2),s=(n=a)&&n.__esModule?n:{"default":n},r=i(0),c=function(t){function i(t,e){
return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,r.B_START_CHAR+t,e))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,s["default"]),o(i,[{key:"valid",value:function(){return new RegExp("^"+r.B_CHARS+"+$").test(this.data)}}]),i}();e["default"]=c},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,
"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=i(2),s=(n=a)&&n.__esModule?n:{"default":n},r=i(0),c=function(t){function i(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,r.C_START_CHAR+t,e))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,s["default"]),o(i,[{key:"valid",value:function(){return new RegExp("^"+r.C_CHARS+"+$").test(this.data)}}]),i}()
;e["default"]=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}Object.defineProperty(e,"__esModule",{value:!0});var a=n(i(2)),s=n(i(18)),r=function(t){function n(t,e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var i=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,(0,s["default"])(t),e));else i=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e));return o(i)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)
}(n,a["default"]),n}();e["default"]=r},function(t,e,i){"use strict";function a(t,e){var i=e?r.A_CHARS:r.B_CHARS,n=t.match(new RegExp("^("+i+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(n)return n[1]+String.fromCharCode(204)+s(t.substring(n[1].length));var o=t.match(new RegExp("^"+i+"+"))[0];return o.length===t.length?t:o+String.fromCharCode(e?205:206)+a(t.substring(o.length),!e)}function s(t){var e=l(t),i=e.length;if(i===t.length)return t;t=t.substring(i);var n=o(t)>=c(t);return e+String.fromCharCode(n?206:205)+a(t,n)}Object.defineProperty(e,"__esModule",{value:!0});var r=i(0),o=function(t){return t.match(new RegExp("^"+r.A_CHARS+"*"))[0].length},c=function(t){return t.match(new RegExp("^"+r.B_CHARS+"*"))[0].length},l=function(t){return t.match(new RegExp("^"+r.C_CHARS+"*"))[0]};e["default"]=function(t){var e=void 0;if(2<=l(t).length)e=r.C_START_CHAR+s(t);else{var i=o(t)>c(t);e=(i?r.A_START_CHAR:r.B_START_CHAR)+a(t,i)}return e.replace(/[\xCD\xCE]([\s\S])[\xCD\xCE]/,function(t,e){
return String.fromCharCode(203)+e})}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.CODE128C=e.CODE128B=e.CODE128A=e.CODE128=void 0;var o=n(i(17)),a=n(i(14)),s=n(i(15)),r=n(i(16));e.CODE128=o["default"],e.CODE128A=a["default"],e.CODE128B=s["default"],e.CODE128C=r["default"]},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(i(4)),a=n(i(5));e["default"]=function(t){var e={};for(var i in a["default"])a["default"].hasOwnProperty(i)&&(t.hasAttribute("jsbarcode-"+i.toLowerCase())&&(e[i]=t.getAttribute("jsbarcode-"+i.toLowerCase())),t.hasAttribute("data-"+i.toLowerCase())&&(e[i]=t.getAttribute("data-"+i.toLowerCase())));return e.value=t.getAttribute("jsbarcode-value")||t.getAttribute("data-value"),(0,o["default"])(e)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=function(){
function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=i(1),s=(n=a)&&n.__esModule?n:{"default":n},r=i(6),c=function(){function n(t,e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.canvas=t,this.encodings=e,this.options=i}return o(n,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var e=(0,s["default"])(this.options,this.encodings[t].options);this.drawCanvasBarcode(e,this.encodings[t]),this.drawCanvasText(e,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,
r.calculateEncodingAttributes)(this.encodings,this.options,t);var e=(0,r.getTotalWidthOfEncodings)(this.encodings),i=(0,r.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=e+this.options.marginLeft+this.options.marginRight,this.canvas.height=i,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,e){var i,n=this.canvas.getContext("2d"),o=e.data;i="top"==t.textPosition?t.marginTop+t.fontSize+t.textMargin:t.marginTop,n.fillStyle=t.lineColor;for(var a=0;a<o.length;a++){var s=a*t.width+e.barcodePadding;"1"===o[a]?n.fillRect(s,i,t.width,t.height):o[a]&&n.fillRect(s,i,t.width,t.height*o[a])}}},{key:"drawCanvasText",value:function(t,e){var i,n,o=this.canvas.getContext("2d"),a=t.fontOptions+" "+t.fontSize+"px "+t.font
;t.displayValue&&(n="top"==t.textPosition?t.marginTop+t.fontSize-t.textMargin:t.height+t.textMargin+t.marginTop+t.fontSize,o.font=a,"left"==t.textAlign||0<e.barcodePadding?(i=0,o.textAlign="left"):"right"==t.textAlign?(i=e.width-1,o.textAlign="right"):(i=e.width/2,o.textAlign="center"),o.fillText(e.text,i,n))}},{key:"moveCanvasDrawing",value:function(t){this.canvas.getContext("2d").translate(t.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),n}();e["default"]=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(i(21)),a=n(i(24)),s=n(i(23));e["default"]={CanvasRenderer:o["default"],SVGRenderer:a["default"],ObjectRenderer:s["default"]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,
"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),n=function(){function n(t,e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.object=t,this.encodings=e,this.options=i}return o(n,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),n}();e["default"]=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),a=i(1),s=(n=a)&&n.__esModule?n:{"default":n},r=i(6),c="http://www.w3.org/2000/svg",l=function(){function n(t,e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.svg=t,this.encodings=e,
this.options=i,this.document=i.xmlDocument||document}return o(n,[{key:"render",value:function(){var t=this.options.marginLeft;this.prepareSVG();for(var e=0;e<this.encodings.length;e++){var i=this.encodings[e],n=(0,s["default"])(this.options,i.options),o=this.createGroup(t,n.marginTop,this.svg);this.setGroupOptions(o,n),this.drawSvgBarcode(o,n,i),this.drawSVGText(o,n,i),t+=i.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,r.calculateEncodingAttributes)(this.encodings,this.options);var t=(0,r.getTotalWidthOfEncodings)(this.encodings),e=(0,r.getMaximumHeightOfEncodings)(this.encodings),i=t+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(i,e),this.options.background&&this.drawRect(0,0,i,e,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(t,e,i){var n,o=i.data;n="top"==e.textPosition?e.fontSize+e.textMargin:0
;for(var a=0,s=0,r=0;r<o.length;r++)s=r*e.width+i.barcodePadding,"1"===o[r]?a++:0<a&&(this.drawRect(s-e.width*a,n,e.width*a,e.height,t),a=0);0<a&&this.drawRect(s-e.width*(a-1),n,e.width*a,e.height,t)}},{key:"drawSVGText",value:function(t,e,i){var n,o,a=this.document.createElementNS(c,"text");e.displayValue&&(a.setAttribute("style","font:"+e.fontOptions+" "+e.fontSize+"px "+e.font),o="top"==e.textPosition?e.fontSize-e.textMargin:e.height+e.textMargin+e.fontSize,"left"==e.textAlign||0<i.barcodePadding?(n=0,a.setAttribute("text-anchor","start")):"right"==e.textAlign?(n=i.width-1,a.setAttribute("text-anchor","end")):(n=i.width/2,a.setAttribute("text-anchor","middle")),a.setAttribute("x",n),a.setAttribute("y",o),a.appendChild(this.document.createTextNode(i.text)),t.appendChild(a))}},{key:"setSvgAttributes",value:function(t,e){var i=this.svg;i.setAttribute("width",t+"px"),i.setAttribute("height",e+"px"),i.setAttribute("x","0px"),i.setAttribute("y","0px"),
i.setAttribute("viewBox","0 0 "+t+" "+e),i.setAttribute("xmlns",c),i.setAttribute("version","1.1"),i.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(t,e,i){var n=this.document.createElementNS(c,"g");return n.setAttribute("transform","translate("+t+", "+e+")"),i.appendChild(n),n}},{key:"setGroupOptions",value:function(t,e){t.setAttribute("style","fill:"+e.lineColor+";")}},{key:"drawRect",value:function(t,e,i,n,o){var a=this.document.createElementNS(c,"rect");return a.setAttribute("x",t),a.setAttribute("y",e),a.setAttribute("width",i),a.setAttribute("height",n),o.appendChild(a),a}}]),n}();e["default"]=l}]);