PJF.apply=function(t,e){if(t&&e&&"object"==typeof e)for(var n in e)t[n]=e[n];return t},PJF.override=function(t,e){if(e){var n=t.prototype;PJF.apply(n,e),n.toString=e.toString}},PJF.extend=function(){var s=function(t){for(var e in t)this[e]=t[e]},r=Object.prototype.constructor;return function(e,t,n){"object"==typeof t&&(n=t,t=e,e=n.constructor!=r?n.constructor:function(){t.apply(this,arguments)});var i,o=function(){},a=t.prototype;return o.prototype=a,(((i=e.prototype=new o).constructor=e).superclass=a).constructor==r&&(a.constructor=t),e.override=function(t){PJF.override(e,t)},i.superclass=i.supr=function(){return a},i.override=s,PJF.override(e,n),e.extend=function(t){return PJF.extend(e,t)},e}}(),PJF.namespace=function(){for(var t,e,n,i,o,a=arguments.length,s=0;s<a;++s)for(arguments[s],n=arguments[s].split("."),void 0===(o=window[n[0]])&&(o=window[n[0]]={}),t=(i=n.slice(1)).length,e=0;e<t;++e)o=o[i[e]]=o[i[e]]||{};return o},PJF.namespace("PJF.util"),PJF.util={extend:jQuery.extend,
json2str:function(t,e,n){var i=!1;if(e&&(i=e),!t)return"";if(n)t=$.extend(!0,{},t);var o=[],a=function(t,e){return"object"==typeof t&&null!=t?PJF.util.json2str(t,e):/^(string|number)$/.test(typeof t)?"'"+t+"'":t};if(t.constructor===Array){for(var s in t)i||"string"!=typeof t[s]||(t[s]=t[s].replace(new RegExp("\\\\","gm"),"\\\\"),t[s]=t[s].replace(new RegExp("'","gm"),"\\'"),t[s]=t[s].replace(new RegExp('"',"gm"),'\\"'),t[s]=t[s].replace(new RegExp("\n","gm"),"\\n"),t[s]=t[s].replace(new RegExp("\r","gm"),"\\r")),o.push(a(t[s],i));return"["+o.join(",")+"]"}for(var s in t)i||"string"!=typeof t[s]||(t[s]=t[s].replace(new RegExp("\\\\","gm"),"\\\\"),t[s]=t[s].replace(new RegExp("'","gm"),"\\'"),t[s]=t[s].replace(new RegExp('"',"gm"),'\\"'),t[s]=t[s].replace(new RegExp("\n","gm"),"\\n"),t[s]=t[s].replace(new RegExp("\r","gm"),"\\r")),o.push("'"+s+"':"+a(t[s],i));return"{"+o.join(",")+"}"},json2str2:function(t){if(window.JSON&&window.JSON.stringify)return JSON.stringify(t);if(!t)return""
;var e=[],n=function(t){return"object"==typeof t&&null!=t?PJF.communication.ra.handler_json2str(t):/^(string|number)$/.test(typeof t)?'"'+t+'"':t};if((t=$.extend(!0,{},t)).constructor===Array){for(var i in t)"string"==typeof t[i]&&(t[i]=t[i].replace(new RegExp("\\\\","gm"),"\\\\"),t[i]=t[i].replace(new RegExp("'","gm"),"\\'"),t[i]=t[i].replace(new RegExp('"',"gm"),'\\"'),t[i]=t[i].replace(new RegExp("\n","gm"),"\\n"),t[i]=t[i].replace(new RegExp("\r","gm"),"\\r")),e.push(n(t[i]));return"["+e.join(",")+"]"}for(var i in t)"string"==typeof t[i]&&(t[i]=t[i].replace(new RegExp("\\\\","gm"),"\\\\"),t[i]=t[i].replace(new RegExp("'","gm"),"\\'"),t[i]=t[i].replace(new RegExp('"',"gm"),'\\"'),t[i]=t[i].replace(new RegExp("\n","gm"),"\\n"),t[i]=t[i].replace(new RegExp("\r","gm"),"\\r")),e.push('"'+i+'":'+n(t[i]));return"{"+e.join(",")+"}"},jsontostr:JSON.stringify,parseJson:JSON.parse,getType:function(t){var e
;return("object"==(e=typeof t)?null==t?"null":Object.prototype.toString.call(t).slice(8,-1):e).toLowerCase()},batchSetText:function(a,t){t||(t=document.body),$("[pjf-text]",t).each(function(t,e){var n=$(e),i=n.attr("pjf-text");if(i){var o=PJF.util.getValue(a,i);o?n.text(o):console.warn("no text value found for pjf-text "+i)}})},getValue:function(t,e){if(!t||"string"!=typeof e)return null;for(var n,i=e.split("."),o=t,a=0;n=i[a];a++){if(!o)return null;o=o[n]}return o},setValue:function(t,e,n){if(!t||"string"!=typeof e)return!1;var i=e.lastIndexOf(".");if(-1===i)return t[e]=n,!0;var o=e.substr(0,i),a=e.substr(i+1),s=this.getValue(t,o),r=typeof s;return!(!s||"object"!==r&&"function"!==r)&&(s[a]=n,!0)},trim:function(t){return $.trim(t)},hashCode:function(t){for(var e=0,n=t.length,i=0;i<n;i++)e=(e<<5)-e+t.charCodeAt(i),e&=e;return e},apply:function(t,e){return PJF.apply(t,e)},isExist:function(t){if("string"==typeof t){var e=arguments[1]||window,n=t.split("."),i=n[0];n.shift()
;var o=n.join(".");return null!==e[i]&&void 0!==e[i]&&(!o||arguments.callee(o,e[i]))}return null!=t},convertCounty:function(t){function e(){new PJF.ui.messageBox({style:"alert",title:resource.convertCounty_messageBox_title,content:resource.convertCounty_messageBox_content})}if($.isArray(t)){for(var n=[],i=t.length,o=0;o<i;o++){if((a=t[o]+"").length<6)return void e();"0000"!=a.substring(2,6)?"00"!=a.substring(4,6)?n.push({province:a.substring(0,2)+"0000",city:a.substring(0,4)+"00",county:a}):n.push({province:a.substring(0,2)+"0000",city:a.substring(0,4)+"00",county:""}):n.push({province:a.substring(0,2)+"0000",city:"",county:""})}return n}var a;return(a=t+"").length<6?void e():"0000"==a.substring(2,6)?{province:a.substring(0,2)+"0000",city:"",county:""}:"00"==a.substring(4,6)?{province:a.substring(0,2)+"0000",city:a.substring(0,4)+"00",county:""}:{province:a.substring(0,2)+"0000",city:a.substring(0,4)+"00",county:t}},formatDate:function(t,e){e||(e="yyyyMMdd");var n={
"y+":t.getFullYear(),"M+":t.getMonth()+1,"d+":t.getDate(),"H+":t.getHours(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),"S+":t.getMilliseconds()};for(var i in n){var o,a=new RegExp("("+i+")");for(n[i]+="";o=a.exec(e);){for(var s="",r=0,c=o[0].length-n[i].length;r<c;r++)s+="0";e=e.replace(o[0],s+n[i].substr(0,o[0].length))}}return e},generateUUid:function(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0,o=0;o<36;o++)8==o||13==o||18==o||23==o?n[o]="-":14==o?n[o]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[o]=e[19==o?3&t|8:t]);return n.join("").replace(/-/g,"")},number2Money:function(t,e){if(0==t&&""!=$.trim(t))return e?e+"整":"零元整";if(!/^-?([1-9]\d*|0)(\.\d+)?$/.test(t)||!t)return"";var n="",i=!1;"-"==(t=""+t)[0]&&(t=t.substr(1),i=!0);var o=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],a=["","拾","佰","仟","万","亿","元",""],s=["角","分"],r=t.split(".")
;r[1]&&(r[1].match(/^0{2}/)||r[1].match(/^0$/)?r.pop():r[1].match(/^[1-9]0/)&&(r[1]=r[1][0]));var c=0;if(0<r[0])for(var l=r[0].length-1;0<=l;l--){switch(c){case 0:n=a[7]+n;break;case 4:new RegExp("0{4}\\d{"+(r[0].length-l-1)+"}$").test(r[0])||(n=a[4]+n);break;case 8:n=a[5]+n,a[7]=a[5],c=0}c%4!=0&&"0"==r[0].charAt(l)&&""!=r[0].charAt(l+1)&&"0"!=r[0].charAt(l+1)&&(n=o[0]+n),0!=r[0].charAt(l)&&(n=o[r[0].charAt(l)]+a[c%4]+n),c++}if(1<r.length){0<r[0]&&(n+=a[6]);for(l=0;l<r[1].length&&l<=1;l++)"0"==r[1].charAt(l)?0<r[0]&&(n+=o[0]):n+=o[r[1].charAt(l)]+s[l]}else n+=e?e+"整":"元整";return i&&(n="负"+n),n},number2Money2:function(t){if("number"==typeof t)t=t.toString();else{if("string"!=typeof t)return 0;t=this.trim(t)}if(!t)return 0;var e,n,i=t.indexOf("."),o=/(\d+)(\d{3})/;if(0<=i){for(e=t.substring(0,i)||"0",n=t.substring(i+1,t.length);o.test(e);)e=e.replace(o,"$1,$2");t=e+"."+n}else for(;o.test(t);)t=t.replace(o,"$1,$2");return t},activeKeyScope:function(t){if(t){
var e=PJF.ui.componentMgr.getFirstComp(t);if(e&&(console.log("激活第一个组件，组件类型为:"+e.getClassName()),e.focus))return void e.focus()}},getClientVersion:function(){if(!PJF.constants.clientVersion){var t=PJF.constants.clientVersion="";if(PJF.communication.client.isInP2())try{var e=PJF.communication.client.getClientEnv("localVersion");t=(t=0==e[0]?e[1]:t)||""}catch(t){}PJF.constants.clientVersion=t}return PJF.constants.clientVersion},getClientSubVersion:function(){if(!PJF.constants.clientSubVersion){var t=PJF.constants.clientSubVersion="";if(PJF.communication.client.isInP2())try{var e=PJF.communication.client.getClientEnv("localAddon");t=(t=0==e[0]?e[1]:t)||""}catch(t){}PJF.constants.clientSubVersion=t}return PJF.constants.clientSubVersion},compareVersion:function(t,e){if("string"!=typeof(t=t||"")&&(t+=""),t===(e=e||""))return 0;for(var n,i,o=t.split("."),a=e.split("."),s=0,r=o.length;s<r;s++){if((n=parseInt(o[s]))<(i=parseInt(a[s])))return-1;if(i<n)return 1}return a.length>o.length?-1:1},
compareClientVersion:function(t,e){var n=PJF.util.getClientVersion(),i=PJF.util.getClientSubVersion()+"",o=PJF.util.clientVersionTransform(n,i);n=o.version,i=parseInt(o.addon,10)||0;for(var a=t.split("."),s=n.split("."),r=Math.min(s.length,a.length),c=0;c<r;c++){a[c]=a[c].match(/[0-9]+/),a[c]=a[c]?a[c][0]:0,s[c]=s[c].match(/[0-9]+/),s[c]=s[c]?s[c][0]:0;var l=parseInt(a[c],10),u=parseInt(s[c],10);if(u<l)return!1;if(l<u)return!0}if(e&&a.length==s.length){if(i<e)return!1;if(e<i)return!0}return a.length<=s.length},isCrossDomain:function(t){var e,n,i=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/;try{n=location.href}catch(t){(n=document.createElement("a")).href="",n=n.href}e=i.exec(n.toLowerCase())||[],t=(t||"").replace(/#.*$/,"").replace(/^\/\//,e[1]+"//");var o=i.exec(t.toLowerCase());return!(!o||o[1]===e[1]&&o[2]===e[2]&&(o[3]||("http:"===o[1]?80:443))==(e[3]||("http:"===e[1]?80:443)))},_keyboard_height_:0,_top_scroll_ele_:null,_get_scroll_ele_:function(){if(!this._top_scroll_ele_){
var t=document.documentElement,e=t.style.overflowY,n=t.scrollTop;t.style.overflowY="auto",t.scrollTop=10,this._top_scroll_ele_=0===t.scrollTop?document.body:t,t.scrollTop=n,t.style.overflowY=e}return this._top_scroll_ele_},_calc_eleKeyboardUp_:function(t,e){e=e||$(window).height();var n=t.getBoundingClientRect().bottom-.4*e;return 0<n?n:0},_adaptElekeyboard_:function(t,e){var n=$(window).height(),i=this._calc_eleKeyboardUp_(t,n);(e&&(document.body.style.marginBottom=.6*n+"px"),0<i)&&(document.documentElement.style.overflowY="auto",this._get_scroll_ele_().scrollTop+=i)},adaptKeyBoard:function(n,i){var o=this;PJF.event.addSubscriber(PJF.PadClientEvents.shell.keyboardShow,PJF.util.debounce(function(t){function e(){document.activeElement&&o._adaptElekeyboard_(document.activeElement,!0)}t=t||n,o._keyboard_height_=t,i?setTimeout(e,i):e()},150)),PJF.event.addSubscriber(PJF.PadClientEvents.shell.keyboardHide,PJF.util.debounce(function(t){o._keyboard_height_=0,o._get_scroll_ele_().scrollTop=0,
document.body.style.marginBottom="0",document.documentElement.style.overflowY=""},150))},adaptEle4Keyboard:function(t){0!==this._keyboard_height_&&("string"==typeof t&&(t=document.getElementById(t)),t&&this._adaptElekeyboard_(t,!1))},getStyle:function(t){for(var e in document.styleSheets){var n=document.styleSheets[e].cssRules;for(var i in n)if(n[i].selectorText==t)return n[i]}return null},loadJavaScript:function(t){if(document.head){var e=document.createElement("script");e.type="text/javascript",e.src=t,document.head.appendChild(e)}},numStrip:function(t){var e=parseFloat(t);if(isNaN(e))return t;var n=e.toPrecision(15);return parseFloat(n)},numSplit:function(t,e,n,i){if(!t)return t;!isNaN(i)&&0<=i&&(t=parseFloat(t).toFixed(i)),e=e||",",n=n||3;var o="";"-"==(t+="").charAt(0)&&(t=t.substr(1),o="-");var a=t.indexOf("."),s=[];-1==a&&(a=t.length),s.push(t.substr(a));for(var r=a;n<r;)r-=n,s.unshift(e+t.substr(r,n));return s.unshift(t.substring(0,r)),o+(t=s.join(""))},
getBase64Sign:function(t){var e=$.extend({str:"测试",color:"#999",fontSize:24,padding:10},t),n=document.createElement("canvas");n.height=500;var i=n.getContext("2d");i.font=e.fontSize+"px 微软雅黑";for(var o,a=e.str.split("\n"),s=a.length*e.fontSize,r=0,c=0;c<a.length;c++)r<(o=i.measureText(a[c]).width)&&(r=o);var l=(s+r+4*e.padding)/1.4;n.width=l,n.height=l,i.translate(n.width/2,n.height/2),i.rotate(-Math.PI/4),i.font=e.fontSize+"px 微软雅黑",i.fillStyle=e.color,i.textAlign="center";var u=a.length%2,d=(a.length-u)/2,h=1===u?0:.5*e.fontSize;for(c=0;c<a.length;c++)i.fillText(a[c],0,h+(c-d)*e.fontSize);return n.toDataURL("image/png")},clearSign:function(){$(document.body).children(".pjf-sys-sign").remove()},setSignStyle:function(t,e){this.clearSign();var n=$(document.body),i="background-image:url("+t+");background-repeat:repeat;position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000000;pointer-events:none;";i+="opacity:"+(e=e||.2)+";",
$("<div/>").attr("class","pjf-sys-sign").attr("pointer-events","none").attr("style",i).appendTo(n)},sign:function(t){this.setSignStyle(this.getBase64Sign(t),t.opacity)},numClean:function(t){return("-"===(t=(t||"")+"").charAt(0)?"-":"")+t.replace(/[^0-9\.]/g,"")},debounce:function(n,i,o){if(!$.isFunction(n))return null;var a,s,r=-1,t=Array.prototype.slice;return function(){s=t.apply(arguments),a=Date.now(),r<0&&(r=function e(t){return setTimeout(function(){var t=Date.now();if(t-a<i)return e(i-(t-a));r=-1,n.apply(o,s)},t)}(i))}},md5:window.md5,queryOpp:function(t,e){if(e&&(window.jumpObj=e),t){window._businsOpp={queryData:t};var n=document.getElementsByTagName("HEAD").item(0),i=document.createElement("script");i.type="text/javascript",i.src="/bosWeb/page/business/queryOpp.js",n.appendChild(i)}},htmlDecode:function(t){return t?t.replace(/&gt;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&#39;/g,"'").replace(/&quot;/g,'"').replace(/<br>/g,"\n"):""},
htmlEncode:function(t){return t?t.replace(/&/g,"&gt;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;").replace(/\n/g,"<br>"):""},qrCode:function(t,e){var n=$("<div style='display:none' ></div>").appendTo(document.body);n.qrcode($.extend({text:t},e));n[0].firstChild.toDataURL("image/png");var i=n[0].firstChild;return n.remove(),PJF.util.generateBmpBase64(i)},barCode:function(t,e){jq=$("<canvas style='display:none'></canvas>").appendTo(document.body),jq.JsBarcode(t,e);var n=jq[0];return jq.remove(),PJF.util.generateBmpBase64(n)},generateBmpBase64:function(t,e){e=e||1;for(var n=t.getContext("2d").getImageData(0,0,t.width,t.height).data,i=[],o=t.height-1;0<=o;o--){for(var a=[],s=0;s<t.width;s++){var r=o*t.width*4+4*s;if(e<=8){var c=Math.floor(255/(Math.pow(2,e)-1)),l=Math.floor((n[r]+n[r+1]+n[r+2])/c/3);a.push(l)}else if(16==e){var u=Math.ceil(n[r]/255*31),d=Math.ceil(n[r+1]/255*31),h=Math.ceil(n[r+2]/255*31)
;a.push(((7&d)<<5)+h),a.push(0+(u<<2)+(d>>3))}else{var m=(32==e?n[r+3]:255)/255;a.push(n[r+2]*m+255*(1-m)),a.push(n[r+1]*m+255*(1-m)),a.push(n[r]*m+255*(1-m)),32==e&&a.push(n[r+3])}}if(e<=8){for(var p=[],f=Math.floor(8/e),g=0,P=a.length;g<P;g+=f){for(var v=0,C=0;C<f;C+=1)v+=a[g+C]<<f-C-1;p.push(v)}a=p}for(var _=4*Math.floor((e*t.width+31)/32);_>a.length;)a.push(0);i=i.concat(a)}return function(t,e,n,i){var o,a;function s(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}if(o=e<=8?54+4*Math.pow(2,e):54,a="BM",a+=s(o+Math.ceil(n*i*e/8)),a+=s(0),a+=s(o),a+=s(40),a+=s(n),a+=s(i),a+=String.fromCharCode(1,0),a+=String.fromCharCode(e,0),a+=s(0),a+=s(t.length),a+=s(0),a+=s(0),a+=s(0),a+=s(0),e<=8){a+=s(0);for(var r=Math.floor(255/(Math.pow(2,e)-1)),c=r;c<256;c+=r)a+=s(c+256*c+65536*c)}for(var c=0,l=t.length;c<l;c++)a+=String.fromCharCode(t[c]);return"data:image/bmp;base64,"+btoa(a)}(i,e,t.width,t.height)},getClientUUid:function(){
if("pc"==PJF.constants.termType&&PJF.communication.client.isInP2()){if(0==(t=PJF.communication.client.getUniqueNo())[0])return t[1]}else if("stm"!=PJF.constants.termType&&"pad"!=PJF.constants.termType||!PJF.communication.isInClient()){if("mobile"==PJF.constants.termType&&PJF.client&&PJF.client.isInClient()){if((t=PJF.client.getUUID()).success)return t.result}}else{var t;if((t=PJF.communication.GetUniqueNo()).success)return t.result}},addAtchBtchNoToUrl:function(t){if(!t)return t;if(-1===t.indexOf("getLocalFile.action?")||-1!==t.indexOf("ATCH_BTCH_NO"))return t;var e=PJF.util.getClientUUid();return e?t.replace("getLocalFile.action?","getLocalFile.action?ATCH_BTCH_NO="+e+"&"):t},addAtchBtchNoToJsonData:function(t){if("object"===PJF.util.getType(t)){var e=PJF.util.getClientUUid();if(e)if(t.jsonData){if("object"===PJF.util.getType(t.jsonData))t.jsonData.ATCH_BTCH_NO=e;else if("string"===PJF.util.getType(t.jsonData))try{var n=JSON.parse(t.jsonData);n.ATCH_BTCH_NO=e,
t.jsonData=JSON.stringify(n)}catch(t){console.log("addAtchBtchNoToJsonData error:"+t.message)}}else t.jsonData=JSON.stringify({ATCH_BTCH_NO:e})}return t},addAtchBtchNoToJsonDataEval:function(data){if("object"===PJF.util.getType(data)){var uuid=PJF.util.getClientUUid();if(uuid)if(data.jsonData){if("object"===PJF.util.getType(data.jsonData))data.jsonData.ATCH_BTCH_NO=uuid;else if("string"===PJF.util.getType(data.jsonData))try{var jsonData=eval("("+data.jsonData+")");jsonData.ATCH_BTCH_NO=uuid,data.jsonData=JSON.stringify(jsonData)}catch(t){console.log("addAtchBtchNoToJsonDataEval error:"+t.message)}}else data.jsonData=JSON.stringify({ATCH_BTCH_NO:uuid})}else if("string"===PJF.util.getType(data)){var uuid=PJF.util.getClientUUid();if(uuid){var num=data.indexOf("jsonData");data=-1!==num?data.replace("jsonData={",'jsonData={"ATCH_BTCH_NO":"'+uuid+'",'):data+'&jsonData={"ATCH_BTCH_NO":"'+uuid+'",'}}return data}};var mySeed=0;function ClientCallProxy(){try{
var args=Array.prototype.slice.call(arguments),fn=args.shift();return eval(fn).apply(window,args)}catch(t){return 3455045118}}function json2str(t){var e=[],n=function(t){return"object"==typeof t&&null!=t?json2str(t):/^(string|number)$/.test(typeof t)?"'"+t+"'":t};if(t.constructor===Array){for(var i in t)e.push(n(t[i]));return"["+e.join(",")+"]"}for(var i in t)e.push("'"+i+"':"+n(t[i]));return"{"+e.join(",")+"}"}PJF.util.Collection=function(t,e){this.items=[],this.map={},this.keys=[],this.length=0,this.id=mySeed++,this.allowFunctions=!0===t,e&&(this.getKey=e)},PJF.util.array={indexOf:function(t,e,n){var i=t.length;for(n=n||0,n+=n<0?i:0;n<i;++n)if(t[n]===e)return n;return-1},locateOf:function(t,e){for(var n=t.length,i=0;i<n;++i)if(t[i]<=e)return i;return n}},PJF.util.string={replaceall:function(t,e,n){return t.replace(new RegExp(e,"gm"),n)},startWith:function(t,e){return new RegExp("^"+e).test(t)},endWith:function(t,e){return new RegExp(e+"$").test(t)}},
PJF.apply(PJF.util.Collection.prototype,{allowFunctions:!1,add:function(t,e){if(1==arguments.length&&(e=t,t=this.getKey(e)),null!=t){if(void 0!==this.map[t])return this.replace(t,e);this.map[t]=e}return this.length++,this.items.push(e),this.keys.push(t),e},getKey:function(t){return t.id},replace:function(t,e){1==arguments.length&&(e=t,t=this.getKey(e));var n=this.map[t];if(null==t||void 0===n)return this.add(t,e);var i=this.indexOfKey(t);return this.items[i]=e,this.map[t]=e},addAll:function(t){if(1<arguments.length||"array"==PJF.util.getType(t))for(var e=1<arguments.length?arguments:t,n=0,i=e.length;n<i;n++)this.add(e[n]);else for(var o in t)(this.allowFunctions||"function"!=typeof t[o])&&this.add(o,t[o])},each:function(t,e){for(var n=[].concat(this.items),i=0,o=n.length;i<o&&!1!==t.call(e||n[i],n[i],i,o);i++);},eachKey:function(t,e){for(var n=0,i=this.keys.length;n<i&&!1!==t.call(e||window,this.keys[n],this.items[n],n,i);n++);},find:function(t,e){
for(var n=0,i=this.items.length;n<i;n++)if(t.call(e||window,this.items[n],this.keys[n]))return this.items[n];return null},insert:function(t,e,n){return 2==arguments.length&&(n=e,e=this.getKey(n)),this.containsKey(e)&&(this.suspendEvents(),this.removeKey(e),this.resumeEvents()),t>=this.length?this.add(e,n):(this.length++,this.items.splice(t,0,n),null!=e&&(this.map[e]=n),this.keys.splice(t,0,e),n)},remove:function(t){return this.removeAt(this.indexOf(t))},removeAt:function(t){if(t<this.length&&0<=t){this.length--;var e=this.items[t];this.items.splice(t,1);var n=this.keys[t];return void 0!==n&&delete this.map[n],this.keys.splice(t,1),e}return!1},removeKey:function(t){return this.removeAt(this.indexOfKey(t))},getCount:function(){return this.length},indexOf:function(t){return PJF.util.array.indexOf(this.items,t)},indexOfKey:function(t){return PJF.util.array.indexOf(this.keys,t)},item:function(t){var e=this.map[t],n=void 0!==e?e:"number"==typeof t?this.items[t]:void 0
;return"function"!=typeof n||this.allowFunctions?n:null},itemAt:function(t){return this.items[t]},key:function(t){return this.map[t]},contains:function(t){return-1!=this.indexOf(t)},containsKey:function(t){return void 0!==this.map[t]},clear:function(){this.length=0,this.items=[],this.keys=[],this.map={}},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},_sort:function(i,t,o){var e,n,a="DESC"==String(t).toUpperCase()?-1:1,s=[],r=this.keys,c=this.items;for(o=o||function(t,e){return t-e},e=0,n=c.length;e<n;e++)s[s.length]={key:r[e],value:c[e],index:e};for(s.sort(function(t,e){var n=o(t[i],e[i])*a;return 0===n&&(n=t.index<e.index?-1:1),n}),e=0,n=s.length;e<n;e++)c[e]=s[e].value,r[e]=s[e].key},sort:function(t,e){this._sort("value",t,e)},reorder:function(t){var e,n=this.items,i=0,o=n.length,a=[],s=[];for(e in t)a[t[e]]=n[e];for(i=0;i<o;i++)null==t[i]&&s.push(n[i]);for(i=0;i<o;i++)null==a[i]&&(a[i]=s.shift());this.clear(),this.addAll(a),
this.resumeEvents()},keySort:function(t,e){this._sort("key",t,e||function(t,e){var n=String(t).toUpperCase(),i=String(e).toUpperCase();return i<n?1:n<i?-1:0})},getRange:function(t,e){var n=this.items;if(n.length<1)return[];var i,o=[];if((t=t||0)<=(e=Math.min(void 0===e?this.length-1:e,this.length-1)))for(i=t;i<=e;i++)o[o.length]=n[i];else for(i=t;e<=i;i--)o[o.length]=n[i];return o},filter:function(e,n,t,i){return Ext.isEmpty(n,!1)?this.clone():(n=this.createValueMatcher(n,t,i),this.filterBy(function(t){return t&&n.test(t[e])}))},filterBy:function(t,e){var n=new Ext.util.MixedCollection;n.getKey=this.getKey;for(var i=this.keys,o=this.items,a=0,s=o.length;a<s;a++)t.call(e||this,o[a],i[a])&&n.add(i[a],o[a]);return n},findIndex:function(e,n,t,i,o){return Ext.isEmpty(n,!1)?-1:(n=this.createValueMatcher(n,i,o),this.findIndexBy(function(t){return t&&n.test(t[e])},null,t))},findIndexBy:function(t,e,n){
for(var i=this.keys,o=this.items,a=n||0,s=o.length;a<s;a++)if(t.call(e||this,o[a],i[a]))return a;return-1},createValueMatcher:function(t,e,n,i){if(!t.exec){var o=Ext.escapeRe;t=String(t),!0===e?t=o(t):(t="^"+o(t),!0===i&&(t+="$")),t=new RegExp(t,n?"":"i")}return t},clone:function(){for(var t=new Ext.util.MixedCollection,e=this.keys,n=this.items,i=0,o=n.length;i<o;i++)t.add(e[i],n[i]);return t.getKey=this.getKey,t}}),PJF.util.supportHideWebView=function(){var t=PJF.communication.getClientType(),e="android"==t?PJF.communication.GetApplicationVersion():PJF.communication.GetClientInfo();if(e=e.success?e.result:"1.0","windows"==t&&0<=PJF.util.compareVersion(e,"2.0.7.0")||"android"==t&&0<=PJF.util.compareVersion(e,"1.4.8"))return!0},function(t){function a(t){var e=t.charCodeAt(0),n=0;return 48<=e&&e<=57?n=e-48:97<=e&&e<=102?n=e-97+10:65<=e&&e<=70&&(n=e-65+10),n}function o(t){return 9<t&&t<16?String.fromCharCode(97+t-10):0<=t&&t<=9?String.fromCharCode(48+t):String.fromCharCode(48)}
t.des=function(t,e,n,i,o,a){
var s,r,c,l,u,d,h,m,p,f,g,P,v,C,_=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756),F=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344),y=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584),J=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928),I=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080),b=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312),S=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154),T=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696),D=function(t){
pc2bytes0=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964),pc2bytes1=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697),pc2bytes2=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272),pc2bytes3=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144),pc2bytes4=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256),pc2bytes5=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488),pc2bytes6=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746),
pc2bytes7=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568),pc2bytes8=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578),pc2bytes9=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488),pc2bytes10=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800),pc2bytes11=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744),pc2bytes12=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128),pc2bytes13=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261)
;for(var e,n,i,o=8<t.length?3:1,a=new Array(32*o),s=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0),r=0,c=0,l=0;l<o;l++){left=t.charCodeAt(r++)<<24|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<8|t.charCodeAt(r++),right=t.charCodeAt(r++)<<24|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<8|t.charCodeAt(r++),i=252645135&(left>>>4^right),right^=i,left^=i<<4,i=65535&(right>>>-16^left),left^=i,right^=i<<-16,i=858993459&(left>>>2^right),right^=i,left^=i<<2,i=65535&(right>>>-16^left),left^=i,right^=i<<-16,i=1431655765&(left>>>1^right),right^=i,left^=i<<1,i=16711935&(right>>>8^left),left^=i,right^=i<<8,i=1431655765&(left>>>1^right),right^=i,left^=i<<1,i=left<<8|right>>>20&240,left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240,right=i;for(var u=0;u<s.length;u++)s[u]?(left=left<<2|left>>>26,right=right<<2|right>>>26):(left=left<<1|left>>>27,right=right<<1|right>>>27),left&=-15,right&=-15,
e=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15],n=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15],i=65535&(n>>>16^e),a[c++]=e^i,a[c++]=n^i<<16}return a}(t),A=0,w=e.length,x=0,E=32==D.length?3:9;for(m=3==E?n?new Array(0,32,2):new Array(30,-2,-2):n?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2),2==a?e+="        ":1==a?(c=8-w%8,e+=String.fromCharCode(c,c,c,c,c,c,c,c),8==c&&(w+=8)):a||(e+="\0\0\0\0\0\0\0\0"),result="",tempresult="",1==i&&(p=o.charCodeAt(A++)<<24|o.charCodeAt(A++)<<16|o.charCodeAt(A++)<<8|o.charCodeAt(A++),g=o.charCodeAt(A++)<<24|o.charCodeAt(A++)<<16|o.charCodeAt(A++)<<8|o.charCodeAt(A++),A=0);A<w;){for(d=e.charCodeAt(A++)<<24|e.charCodeAt(A++)<<16|e.charCodeAt(A++)<<8|e.charCodeAt(A++),
h=e.charCodeAt(A++)<<24|e.charCodeAt(A++)<<16|e.charCodeAt(A++)<<8|e.charCodeAt(A++),1==i&&(n?(d^=p,h^=g):(f=p,P=g,p=d,g=h)),d^=(c=252645135&(d>>>4^h))<<4,d^=(c=65535&(d>>>16^(h^=c)))<<16,d^=c=858993459&((h^=c)>>>2^d),d^=c=16711935&((h^=c<<2)>>>8^d),d=(d^=(c=1431655765&(d>>>1^(h^=c<<8)))<<1)<<1|d>>>31,h=(h^=c)<<1|h>>>31,r=0;r<E;r+=3){for(v=m[r+1],C=m[r+2],s=m[r];s!=v;s+=C)l=h^D[s],u=(h>>>4|h<<28)^D[s+1],c=d,d=h,h=c^(F[l>>>24&63]|J[l>>>16&63]|b[l>>>8&63]|T[63&l]|_[u>>>24&63]|y[u>>>16&63]|I[u>>>8&63]|S[63&u]);c=d,d=h,h=c}h=h>>>1|h<<31,h^=c=1431655765&((d=d>>>1|d<<31)>>>1^h),h^=(c=16711935&(h>>>8^(d^=c<<1)))<<8,h^=(c=858993459&(h>>>2^(d^=c)))<<2,h^=c=65535&((d^=c)>>>16^h),h^=c=252645135&((d^=c<<16)>>>4^h),d^=c<<4,1==i&&(n?(p=d,g=h):(d^=f,h^=P)),tempresult+=String.fromCharCode(d>>>24,d>>>16&255,d>>>8&255,255&d,h>>>24,h>>>16&255,h>>>8&255,255&h),512==(x+=8)&&(result+=tempresult,tempresult="",x=0)}return result+tempresult},t.stringToHex=function(t){
for(var e="",n=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),i=0;i<t.length;i++)e+=n[t.charCodeAt(i)>>4]+n[15&t.charCodeAt(i)];return e},t.hexToString=function(t){for(var e="",n="0x"==t.substr(0,2)?2:0;n<t.length;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e},t.stringToBCD=function(t){if(t.length%2!=0)return null;for(var e=[],n=0;n<t.length;n+=2){var i=t[n],o=t[n+1];e.push((a(i)<<4)+a(o))}return String.fromCharCode.apply(String,e)},t.bcdToString=function(t){for(var e="",n=0;n<t.length;n++){var i=t[n].charCodeAt(0);e+=o(i>>4)+o(15&i)}return e},t.string16ToHex=function(t){for(var e="",n=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),i=0;i<t.length;i++){var o=t.charCodeAt(i);e+=n[o>>12]+n[o>>8&15]+n[o>>4&15]+n[15&o]}return e},t.hexToString16=function(t){for(var e="",n="0x"==t.substr(0,2)?2:0;n<t.length;n+=4)e+=String.fromCharCode(parseInt(t.substr(n,4),16));return e}}(PJF.util),PJF.namespace("PJF.cache"),
function(i){var o,n={};i.keys={SERVER_TIME:"serverTime"},i.set=function(t,e){n[t]=e},i.get=function(t){return n[t]},i.clear=function(){n={}},i.getServerTime=function(){return i.get(i.keys.SERVER_TIME)},i.setServerTime=function(t){clearTimeout(o);var e=new Date(t.substr(0,4),parseInt(t.substr(4,2))-1,t.substr(6,2),t.substr(8,2),t.substr(10,2),t.substr(12,2)),n=new Date(t.substr(0,4),parseInt(t.substr(4,2))-1,parseInt(t.substr(6,2))+1);o=setTimeout(function(){i.set(i.keys.SERVER_TIME,void 0)},n-e),i.set(i.keys.SERVER_TIME,t.substr(0,8))}}(PJF.cache),PJF.apply(PJF.util,{Encrypt0x88:function(t){var e=PJF.communication.Encrypt0x88(t,PJF.otherInfo.devId,PJF.otherInfo.token,PJF.otherInfo.secNode);if(e.success)return e.result},encrypt:function(t){var e=PJF.communication.Encrypt(t,PJF.otherInfo.devId,PJF.otherInfo.token,PJF.otherInfo.secNode);if(e.success)return e.result},formatTpl:function(t,n){return t.replace(/{{([^}]+)}}/g,function(t,e){return n[e]?n[e]:""})},_keyboard_height_:0,
_top_scroll_ele_:null,_get_scroll_ele_:function(){if(!this._top_scroll_ele_){var t=document.documentElement,e=t.style.overflowY,n=t.scrollTop;t.style.overflowY="auto",t.scrollTop=10,this._top_scroll_ele_=0===t.scrollTop?document.body:t,t.scrollTop=n,t.style.overflowY=e}return this._top_scroll_ele_},_calc_eleKeyboardUp_:function(t,e){e=e||$(window).height();var n=t.getBoundingClientRect().bottom-(this._keyboard_height_+30);return 0<n?n:0},_adaptElekeyboard_:function(t,e){var n=$(window).height(),i=this._calc_eleKeyboardUp_(t,n);(e&&(document.body.style.marginBottom=this._keyboard_height_+30+"px"),0<i)&&(document.documentElement.style.overflowY="auto",this._get_scroll_ele_().scrollTop+=i)},adaptKeyBoard:function(n,i){var o=this;PJF.event.addSubscriber(PJF.PadClientEvents.shell.keyboardShow,PJF.util.debounce(function(t){function e(){document.activeElement&&o._adaptElekeyboard_(document.activeElement,!0)}t=t||n,o._keyboard_height_=t,i?setTimeout(e,i):e()},150)),
PJF.event.addSubscriber(PJF.PadClientEvents.shell.keyboardHide,PJF.util.debounce(function(t){o._keyboard_height_=0,o._get_scroll_ele_().scrollTop=0,document.body.style.marginBottom="0",document.documentElement.style.overflowY=""},150))},adaptEle4Keyboard:function(t){0!==this._keyboard_height_&&("string"==typeof t&&(t=document.getElementById(t)),t&&this._adaptElekeyboard_(t,!1))},openKeyboard:function(t){PJF.communication.isInClient()&&(PJF.util.deviceType.tcr&&PJF.communication.isSecondScreen()?PJF.communication.IME.OpenWindowsKeyboard(function(t){console.log("打开WINDOWS输入法，结果为:"+t)}):PJF.util.deviceType.pad||PJF.util.deviceType.ytd&&!PJF.util.compareClientVersion("1.16.3.0")||(PJF.util.deviceType.ytd&&PJF.constants.YTD_WINDOWS_KEYBOARD?PJF.communication.IME.OpenWindowsKeyboard(function(t){console.log("打开WINDOWS输入法，结果为:"+t)}):PJF.stm.AppIME.openSoftKeyboard({hmode:t||0},function(t){PJF.util.isKylinSTM()&&PJF.event.asyncPublish(PJF.PadClientEvents.shell.keyboardShow,400),
t.status||console.log("IME调用输入法出错:"+JSON.stringify(t))})))},closeKeyboard:function(){PJF.communication.isInClient()&&(PJF.util.deviceType.tcr&&PJF.communication.isSecondScreen()||PJF.util.deviceType.pad||PJF.util.deviceType.ytd&&!PJF.util.compareClientVersion("1.16.3.0")||PJF.util.deviceType.ytd&&PJF.constants.YTD_WINDOWS_KEYBOARD||PJF.stm.AppIME.closeSoftKeyboard({},function(t){PJF.util.isKylinSTM()&&PJF.event.asyncPublish(PJF.PadClientEvents.shell.keyboardHide,400),t.status||console.log("IME关闭输入法出错"+JSON.stringify(t))}))},saveHtml:function(t){var e=document.getElementById(t);if(e){var n='<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body>';n+=e.innerHTML,n+="</body></html>";var i=PJF.otherInfo.devId+Date.now()+PJF.util.generateUUid()+".html",o=PJF.communication.writeTextFile(i,n);return o.success?o.result.replace(new RegExp("\\\\","gm"),"/"):""}},getComputerKey:function(){
if(PJF.communication.isInClient()){var ipMacs=PJF.communication.GetMachine().result,temp=[];if(ipMacs){ipMacs=eval(ipMacs);for(var a=0;a<ipMacs.length;a++){var result=ipMacs[a];temp.push(result.IP),temp.push("-"),temp.push(result.MAC)}}var hash=PJF.util.hashCode(temp.join(""));return hash+"-"+temp.join("")}return""},compareClientVersion:function(t){var e=PJF.communication.GetClientInfo();if(!e.success)return!1;for(var n=e.result,i=t.split("."),o=n.split("."),a=Math.min(o.length,i.length),s=0;s<a;s++){i[s]=i[s].match(/[0-9]+/),i[s]=i[s]?i[s][0]:0,o[s]=o[s].match(/[0-9]+/),o[s]=o[s]?o[s][0]:0;var r=parseInt(i[s]),c=parseInt(o[s]);if(c<r)return!1;if(r<c)return!0}return i.length<=o.length},routeClassList:[],routeClassAllowRepeat:["templateInfo"],registerRoute:function(t,e){for(var n in t=t||{},e)t[n]&&!PJF.constants.ON_PROD?alert("error,路由配置出现重复的page id:"+n):t[n]=e[n]},safeParse:function(e,n){var i;if($.isNumeric(e))return e;try{i=JSON.parse(e)}catch(t){i=void 0===n?e:n}return i},
loadJavaScript:function(e,t,n){if(document.head){var i="";t&&PJF.util.isCCBSTransform()&&(i="_ccbstransform"),e=/(.*)(\.js)/.exec(e)[1]+i+".js",console.log("将要加载js:"+e);var o=document.createElement("script");if(n){var a=PJF.html.toAbsURL(e).split("bosWeb/page/")[1];$.ajax({async:!1,url:"/bosWeb/FileServlet?type=status&path="+a,success:function(t){o.src="true"==t?"/bosWeb/FileServlet?type=load&path="+a:e},error:function(){o.src=e}})}else o.src=e;o.type="text/javascript",PJF.constants.jsLoadingCount++,o.onload=o.onerror=function(){PJF.constants.jsLoadingCount--},document.head.appendChild(o)}},isCCBSTransform:function(){return!0},barCode:function(t,e){jq=$("<canvas style='display:none'></canvas>").appendTo(document.body),jq.JsBarcode(t,e);var n=jq[0];return jq.remove(),PJF.util.generateBmpBase64(n)},deviceType:{icm:!1,stm:!1,ytd:!1,tcr:!1},isKylinSTM:function(){return"Linux aarch64"==navigator.platform}}),JSON.safeParse=PJF.util.safeParse,function(t){var n={};t.addPageData=function(t,e){
n[t]=e},t.getPageData=function(t){return n[t]},t.removePageData=function(t){n[t]=void 0},t.getPinyinDict=function(){return{"啊":"a","阿":"a","锕":"a","埃":"ai","挨":"ai","哎":"ai","唉":"ai","哀":"ai","皑":"ai","癌":"ai","蔼":"ai","矮":"ai","艾":"ai","碍":"ai","爱":"ai","隘":"ai","诶":"ai","捱":"ai","嗳":"ai","嗌":"ai","嫒":"ai","瑷":"ai","暧":"ai","砹":"ai","锿":"ai","霭":"ai","鞍":"an","氨":"an","安":"an","俺":"an","按":"an","暗":"an","岸":"an","胺":"an","案":"an","谙":"an","埯":"an","揞":"an","犴":"an","庵":"an","桉":"an","铵":"an","鹌":"an","顸":"an","黯":"an","肮":"ang","昂":"ang","盎":"ang","凹":"ao","敖":"ao","熬":"ao","翱":"ao","袄":"ao","傲":"ao","奥":"ao","懊":"ao","澳":"ao","坳":"ao","拗":"ao","嗷":"ao","噢":"ao","岙":"ao","廒":"ao","遨":"ao","媪":"ao","骜":"ao","聱":"ao","螯":"ao","鏊":"ao","鳌":"ao","鏖":"ao","芭":"ba","捌":"ba","扒":"ba","叭":"ba","吧":"ba","笆":"ba","八":"ba","疤":"ba","巴":"ba","拔":"ba","跋":"ba","靶":"ba","把":"ba","耙":"ba","坝":"ba","霸":"ba","罢":"ba","爸":"ba","茇":"ba","菝":"ba","萆":"ba","捭":"ba","岜":"ba","灞":"ba","杷":"ba","钯":"ba",
"粑":"ba","鲅":"ba","魃":"ba","白":"bai","柏":"bai","百":"bai","摆":"bai","佰":"bai","败":"bai","拜":"bai","稗":"bai","薜":"bai","掰":"bai","鞴":"bai","斑":"ban","班":"ban","搬":"ban","扳":"ban","般":"ban","颁":"ban","板":"ban","版":"ban","扮":"ban","拌":"ban","伴":"ban","瓣":"ban","半":"ban","办":"ban","绊":"ban","阪":"ban","坂":"ban","豳":"ban","钣":"ban","瘢":"ban","癍":"ban","舨":"ban","邦":"bang","帮":"bang","梆":"bang","榜":"bang","膀":"bang","绑":"bang","棒":"bang","磅":"bang","蚌":"bang","镑":"bang","傍":"bang","谤":"bang","蒡":"bang","螃":"bang","苞":"bao","胞":"bao","包":"bao","褒":"bao","雹":"bao","保":"bao","堡":"bao","饱":"bao","宝":"bao","抱":"bao","报":"bao","暴":"bao","豹":"bao","鲍":"bao","爆":"bao","勹":"bao","葆":"bao","宀":"bao","孢":"bao","煲":"bao","鸨":"bao","褓":"bao","趵":"bao","龅":"bao","剥":"bo","薄":"bo","玻":"bo","菠":"bo","播":"bo","拨":"bo","钵":"bo","波":"bo","博":"bo","勃":"bo","搏":"bo","铂":"bo","箔":"bo","伯":"bo","帛":"bo","舶":"bo","脖":"bo","膊":"bo","渤":"bo","泊":"bo","驳":"bo","亳":"bo","蕃":"bo","啵":"bo","饽":"bo","檗":"bo","擘":"bo",
"礴":"bo","钹":"bo","鹁":"bo","簸":"bo","跛":"bo","杯":"bei","碑":"bei","悲":"bei","卑":"bei","北":"bei","辈":"bei","背":"bei","贝":"bei","钡":"bei","倍":"bei","狈":"bei","备":"bei","惫":"bei","焙":"bei","被":"bei","孛":"bei","陂":"bei","邶":"bei","埤":"bei","蓓":"bei","呗":"bei","怫":"bei","悖":"bei","碚":"bei","鹎":"bei","褙":"bei","鐾":"bei","奔":"ben","苯":"ben","本":"ben","笨":"ben","畚":"ben","坌":"ben","锛":"ben","崩":"beng","绷":"beng","甭":"beng","泵":"beng","蹦":"beng","迸":"beng","唪":"beng","嘣":"beng","甏":"beng","逼":"bi","鼻":"bi","比":"bi","鄙":"bi","笔":"bi","彼":"bi","碧":"bi","蓖":"bi","蔽":"bi","毕":"bi","毙":"bi","毖":"bi","币":"bi","庇":"bi","痹":"bi","闭":"bi","敝":"bi","弊":"bi","必":"bi","辟":"bi","壁":"bi","臂":"bi","避":"bi","陛":"bi","匕":"bi","仳":"bi","俾":"bi","芘":"bi","荜":"bi","荸":"bi","吡":"bi","哔":"bi","狴":"bi","庳":"bi","愎":"bi","滗":"bi","濞":"bi","弼":"bi","妣":"bi","婢":"bi","嬖":"bi","璧":"bi","贲":"bi","畀":"bi","铋":"bi","秕":"bi","裨":"bi","筚":"bi","箅":"bi","篦":"bi","舭":"bi","襞":"bi","跸":"bi","髀":"bi","鞭":"bian","边":"bian",
"编":"bian","贬":"bian","扁":"bian","便":"bian","变":"bian","卞":"bian","辨":"bian","辩":"bian","辫":"bian","遍":"bian","匾":"bian","弁":"bian","苄":"bian","忭":"bian","汴":"bian","缏":"bian","煸":"bian","砭":"bian","碥":"bian","稹":"bian","窆":"bian","蝙":"bian","笾":"bian","鳊":"bian","标":"biao","彪":"biao","膘":"biao","表":"biao","婊":"biao","骠":"biao","飑":"biao","飙":"biao","飚":"biao","灬":"biao","镖":"biao","镳":"biao","瘭":"biao","裱":"biao","鳔":"biao","鳖":"bie","憋":"bie","别":"bie","瘪":"bie","蹩":"bie","鳘":"bie","彬":"bin","斌":"bin","濒":"bin","滨":"bin","宾":"bin","摈":"bin","傧":"bin","浜":"bin","缤":"bin","玢":"bin","殡":"bin","膑":"bin","镔":"bin","髌":"bin","鬓":"bin","兵":"bing","冰":"bing","柄":"bing","丙":"bing","秉":"bing","饼":"bing","炳":"bing","病":"bing","并":"bing","禀":"bing","邴":"bing","摒":"bing","绠":"bing","枋":"bing","槟":"bing","燹":"bing","捕":"bu","卜":"bu","哺":"bu","补":"bu","埠":"bu","不":"bu","布":"bu","步":"bu","簿":"bu","部":"bu","怖":"bu","拊":"bu","卟":"bu","逋":"bu","瓿":"bu","晡":"bu","钚":"bu","醭":"bu","擦":"ca","嚓":"ca",
"礤":"ca","猜":"cai","裁":"cai","材":"cai","才":"cai","财":"cai","睬":"cai","踩":"cai","采":"cai","彩":"cai","菜":"cai","蔡":"cai","餐":"can","参":"can","蚕":"can","残":"can","惭":"can","惨":"can","灿":"can","骖":"can","璨":"can","粲":"can","黪":"can","苍":"cang","舱":"cang","仓":"cang","沧":"cang","藏":"cang","伧":"cang","操":"cao","糙":"cao","槽":"cao","曹":"cao","草":"cao","艹":"cao","嘈":"cao","漕":"cao","螬":"cao","艚":"cao","厕":"ce","策":"ce","侧":"ce","册":"ce","测":"ce","刂":"ce","帻":"ce","恻":"ce","层":"ceng","蹭":"ceng","噌":"ceng","插":"cha","叉":"cha","茬":"cha","茶":"cha","查":"cha","碴":"cha","搽":"cha","察":"cha","岔":"cha","差":"cha","诧":"cha","猹":"cha","馇":"cha","汊":"cha","姹":"cha","杈":"cha","楂":"cha","槎":"cha","檫":"cha","钗":"cha","锸":"cha","镲":"cha","衩":"cha","拆":"chai","柴":"chai","豺":"chai","侪":"chai","茈":"chai","瘥":"chai","虿":"chai","龇":"chai","搀":"chan","掺":"chan","蝉":"chan","馋":"chan","谗":"chan","缠":"chan","铲":"chan","产":"chan","阐":"chan","颤":"chan","冁":"chan","谄":"chan","谶":"chan","蒇":"chan","廛":"chan","忏":"chan",
"潺":"chan","澶":"chan","孱":"chan","羼":"chan","婵":"chan","嬗":"chan","骣":"chan","觇":"chan","禅":"chan","镡":"chan","裣":"chan","蟾":"chan","躔":"chan","昌":"chang","猖":"chang","场":"chang","尝":"chang","常":"chang","长":"chang","偿":"chang","肠":"chang","厂":"chang","敞":"chang","畅":"chang","唱":"chang","倡":"chang","伥":"chang","鬯":"chang","苌":"chang","菖":"chang","徜":"chang","怅":"chang","惝":"chang","阊":"chang","娼":"chang","嫦":"chang","昶":"chang","氅":"chang","鲳":"chang","超":"chao","抄":"chao","钞":"chao","朝":"chao","嘲":"chao","潮":"chao","巢":"chao","吵":"chao","炒":"chao","怊":"chao","绉":"chao","晁":"chao","耖":"chao","车":"che","扯":"che","撤":"che","掣":"che","彻":"che","澈":"che","坼":"che","屮":"che","砗":"che","郴":"chen","臣":"chen","辰":"chen","尘":"chen","晨":"chen","忱":"chen","沉":"chen","陈":"chen","趁":"chen","衬":"chen","称":"chen","谌":"chen","抻":"chen","嗔":"chen","宸":"chen","琛":"chen","榇":"chen","肜":"chen","胂":"chen","碜":"chen","龀":"chen","撑":"cheng","城":"cheng","橙":"cheng","成":"cheng","呈":"cheng","乘":"cheng",
"程":"cheng","惩":"cheng","澄":"cheng","诚":"cheng","承":"cheng","逞":"cheng","骋":"cheng","秤":"cheng","埕":"cheng","嵊":"cheng","徵":"cheng","浈":"cheng","枨":"cheng","柽":"cheng","樘":"cheng","晟":"cheng","塍":"cheng","瞠":"cheng","铖":"cheng","裎":"cheng","蛏":"cheng","酲":"cheng","吃":"chi","痴":"chi","持":"chi","匙":"chi","池":"chi","迟":"chi","弛":"chi","驰":"chi","耻":"chi","齿":"chi","侈":"chi","尺":"chi","赤":"chi","翅":"chi","斥":"chi","炽":"chi","傺":"chi","墀":"chi","芪":"chi","茌":"chi","搋":"chi","叱":"chi","哧":"chi","啻":"chi","嗤":"chi","彳":"chi","饬":"chi","沲":"chi","媸":"chi","敕":"chi","胝":"chi","眙":"chi","眵":"chi","鸱":"chi","瘛":"chi","褫":"chi","蚩":"chi","螭":"chi","笞":"chi","篪":"chi","豉":"chi","踅":"chi","踟":"chi","魑":"chi","充":"chong","冲":"chong","虫":"chong","崇":"chong","宠":"chong","茺":"chong","忡":"chong","憧":"chong","铳":"chong","艟":"chong","抽":"chou","酬":"chou","畴":"chou","踌":"chou","稠":"chou","愁":"chou","筹":"chou","仇":"chou","绸":"chou","瞅":"chou","丑":"chou","俦":"chou","圳":"chou","帱":"chou","惆":"chou","溴":"chou",
"妯":"chou","瘳":"chou","雠":"chou","鲋":"chou","臭":"chu","初":"chu","出":"chu","橱":"chu","厨":"chu","躇":"chu","锄":"chu","雏":"chu","滁":"chu","除":"chu","楚":"chu","础":"chu","储":"chu","矗":"chu","搐":"chu","触":"chu","处":"chu","亍":"chu","刍":"chu","憷":"chu","绌":"chu","杵":"chu","楮":"chu","樗":"chu","蜍":"chu","蹰":"chu","黜":"chu","揣":"chuan","川":"chuan","穿":"chuan","椽":"chuan","传":"chuan","船":"chuan","喘":"chuan","串":"chuan","掾":"chuan","舛":"chuan","惴":"chuan","遄":"chuan","巛":"chuan","氚":"chuan","钏":"chuan","镩":"chuan","舡":"chuan","疮":"chuang","窗":"chuang","幢":"chuang","床":"chuang","闯":"chuang","创":"chuang","怆":"chuang","吹":"chui","炊":"chui","捶":"chui","锤":"chui","垂":"chui","陲":"chui","棰":"chui","槌":"chui","春":"chun","椿":"chun","醇":"chun","唇":"chun","淳":"chun","纯":"chun","蠢":"chun","促":"chun","莼":"chun","沌":"chun","肫":"chun","朐":"chun","鹑":"chun","蝽":"chun","戳":"chuo","绰":"chuo","蔟":"chuo","辶":"chuo","辍":"chuo","镞":"chuo","踔":"chuo","龊":"chuo","疵":"ci","茨":"ci","磁":"ci","雌":"ci","辞":"ci","慈":"ci",
"瓷":"ci","词":"ci","此":"ci","刺":"ci","赐":"ci","次":"ci","荠":"ci","呲":"ci","嵯":"ci","鹚":"ci","螅":"ci","糍":"ci","趑":"ci","聪":"cong","葱":"cong","囱":"cong","匆":"cong","从":"cong","丛":"cong","偬":"cong","苁":"cong","淙":"cong","骢":"cong","琮":"cong","璁":"cong","枞":"cong","凑":"cu","粗":"cu","醋":"cu","簇":"cu","猝":"cu","殂":"cu","蹙":"cu","蹿":"cuan","篡":"cuan","窜":"cuan","汆":"cuan","撺":"cuan","昕":"cuan","爨":"cuan","摧":"cui","崔":"cui","催":"cui","脆":"cui","瘁":"cui","粹":"cui","淬":"cui","翠":"cui","萃":"cui","悴":"cui","璀":"cui","榱":"cui","隹":"cui","村":"cun","存":"cun","寸":"cun","磋":"cun","忖":"cun","皴":"cun","撮":"cuo","搓":"cuo","措":"cuo","挫":"cuo","错":"cuo","厝":"cuo","脞":"cuo","锉":"cuo","矬":"cuo","痤":"cuo","鹾":"cuo","蹉":"cuo","躜":"cuo","搭":"da","达":"da","答":"da","瘩":"da","打":"da","大":"da","耷":"da","哒":"da","嗒":"da","怛":"da","妲":"da","疸":"da","褡":"da","笪":"da","靼":"da","鞑":"da","呆":"dai","歹":"dai","傣":"dai","戴":"dai","带":"dai","殆":"dai","代":"dai","贷":"dai","袋":"dai","待":"dai","逮":"dai","怠":"dai","埭":"dai",
"甙":"dai","呔":"dai","岱":"dai","迨":"dai","逯":"dai","骀":"dai","绐":"dai","玳":"dai","黛":"dai","耽":"dan","担":"dan","丹":"dan","单":"dan","郸":"dan","掸":"dan","胆":"dan","旦":"dan","氮":"dan","但":"dan","惮":"dan","淡":"dan","诞":"dan","弹":"dan","蛋":"dan","亻":"dan","儋":"dan","卩":"dan","萏":"dan","啖":"dan","澹":"dan","檐":"dan","殚":"dan","赕":"dan","眈":"dan","瘅":"dan","聃":"dan","箪":"dan","当":"dang","挡":"dang","党":"dang","荡":"dang","档":"dang","谠":"dang","凼":"dang","菪":"dang","宕":"dang","砀":"dang","铛":"dang","裆":"dang","刀":"dao","捣":"dao","蹈":"dao","倒":"dao","岛":"dao","祷":"dao","导":"dao","到":"dao","稻":"dao","悼":"dao","道":"dao","盗":"dao","叨":"dao","啁":"dao","忉":"dao","洮":"dao","氘":"dao","焘":"dao","忑":"dao","纛":"dao","德":"de","得":"de","的":"de","锝":"de","蹬":"deng","灯":"deng","登":"deng","等":"deng","瞪":"deng","凳":"deng","邓":"deng","噔":"deng","嶝":"deng","戥":"deng","磴":"deng","镫":"deng","簦":"deng","堤":"di","低":"di","滴":"di","迪":"di","敌":"di","笛":"di","狄":"di","涤":"di","翟":"di","嫡":"di","抵":"di","底":"di","地":"di",
"蒂":"di","第":"di","帝":"di","弟":"di","递":"di","缔":"di","氐":"di","籴":"di","诋":"di","谛":"di","邸":"di","坻":"di","莜":"di","荻":"di","嘀":"di","娣":"di","柢":"di","棣":"di","觌":"di","砥":"di","碲":"di","睇":"di","镝":"di","羝":"di","骶":"di","颠":"dian","掂":"dian","滇":"dian","碘":"dian","点":"dian","典":"dian","靛":"dian","垫":"dian","电":"dian","佃":"dian","甸":"dian","店":"dian","惦":"dian","奠":"dian","淀":"dian","殿":"dian","丶":"dian","阽":"dian","坫":"dian","埝":"dian","巅":"dian","玷":"dian","癜":"dian","癫":"dian","簟":"dian","踮":"dian","碉":"diao","叼":"diao","雕":"diao","凋":"diao","刁":"diao","掉":"diao","吊":"diao","钓":"diao","调":"diao","轺":"diao","铞":"diao","蜩":"diao","粜":"diao","貂":"diao","跌":"die","爹":"die","碟":"die","蝶":"die","迭":"die","谍":"die","叠":"die","佚":"die","垤":"die","堞":"die","揲":"die","喋":"die","渫":"die","轶":"die","牒":"die","瓞":"die","褶":"die","耋":"die","蹀":"die","鲽":"die","鳎":"die","丁":"ding","盯":"ding","叮":"ding","钉":"ding","顶":"ding","鼎":"ding","锭":"ding","定":"ding","订":"ding","丢":"ding","仃":"ding",
"啶":"ding","玎":"ding","腚":"ding","碇":"ding","町":"ding","铤":"ding","疔":"ding","耵":"ding","酊":"ding","东":"dong","冬":"dong","董":"dong","懂":"dong","动":"dong","栋":"dong","侗":"dong","恫":"dong","冻":"dong","洞":"dong","垌":"dong","咚":"dong","岽":"dong","峒":"dong","夂":"dong","氡":"dong","胨":"dong","胴":"dong","硐":"dong","鸫":"dong","兜":"dou","抖":"dou","斗":"dou","陡":"dou","豆":"dou","逗":"dou","痘":"dou","蔸":"dou","钭":"dou","窦":"dou","窬":"dou","蚪":"dou","篼":"dou","酡":"dou","都":"du","督":"du","毒":"du","犊":"du","独":"du","读":"du","堵":"du","睹":"du","赌":"du","杜":"du","镀":"du","肚":"du","度":"du","渡":"du","妒":"du","芏":"du","嘟":"du","渎":"du","椟":"du","橐":"du","牍":"du","蠹":"du","笃":"du","髑":"du","黩":"du","端":"duan","短":"duan","锻":"duan","段":"duan","断":"duan","缎":"duan","彖":"duan","椴":"duan","煅":"duan","簖":"duan","堆":"dui","兑":"dui","队":"dui","对":"dui","怼":"dui","憝":"dui","碓":"dui","墩":"dun","吨":"dun","蹲":"dun","敦":"dun","顿":"dun","囤":"dun","钝":"dun","盾":"dun","遁":"dun","炖":"dun","砘":"dun","礅":"dun","盹":"dun",
"镦":"dun","趸":"dun","掇":"duo","哆":"duo","多":"duo","夺":"duo","垛":"duo","躲":"duo","朵":"duo","跺":"duo","舵":"duo","剁":"duo","惰":"duo","堕":"duo","咄":"duo","哚":"duo","缍":"duo","柁":"duo","铎":"duo","裰":"duo","踱":"duo","蛾":"e","峨":"e","鹅":"e","俄":"e","额":"e","讹":"e","娥":"e","恶":"e","厄":"e","扼":"e","遏":"e","鄂":"e","饿":"e","噩":"e","谔":"e","垩":"e","垭":"e","苊":"e","莪":"e","萼":"e","呃":"e","愕":"e","屙":"e","婀":"e","轭":"e","曷":"e","腭":"e","硪":"e","锇":"e","锷":"e","鹗":"e","颚":"e","鳄":"e","恩":"en","蒽":"en","摁":"en","唔":"en","嗯":"en","而":"er","儿":"er","耳":"er","尔":"er","饵":"er","洱":"er","二":"er","贰":"er","迩":"er","珥":"er","铒":"er","鸸":"er","鲕":"er","发":"fa","罚":"fa","筏":"fa","伐":"fa","乏":"fa","阀":"fa","法":"fa","珐":"fa","垡":"fa","砝":"fa","藩":"fan","帆":"fan","番":"fan","翻":"fan","樊":"fan","矾":"fan","钒":"fan","繁":"fan","凡":"fan","烦":"fan","反":"fan","返":"fan","范":"fan","贩":"fan","犯":"fan","饭":"fan","泛":"fan","蘩":"fan","幡":"fan","犭":"fan","梵":"fan","攵":"fan","燔":"fan","畈":"fan","蹯":"fan","坊":"fang","芳":"fang",
"方":"fang","肪":"fang","房":"fang","防":"fang","妨":"fang","仿":"fang","访":"fang","纺":"fang","放":"fang","匚":"fang","邡":"fang","彷":"fang","钫":"fang","舫":"fang","鲂":"fang","菲":"fei","非":"fei","啡":"fei","飞":"fei","肥":"fei","匪":"fei","诽":"fei","吠":"fei","肺":"fei","废":"fei","沸":"fei","费":"fei","芾":"fei","狒":"fei","悱":"fei","淝":"fei","妃":"fei","绋":"fei","绯":"fei","榧":"fei","腓":"fei","斐":"fei","扉":"fei","祓":"fei","砩":"fei","镄":"fei","痱":"fei","蜚":"fei","篚":"fei","翡":"fei","霏":"fei","鲱":"fei","芬":"fen","酚":"fen","吩":"fen","氛":"fen","分":"fen","纷":"fen","坟":"fen","焚":"fen","汾":"fen","粉":"fen","奋":"fen","份":"fen","忿":"fen","愤":"fen","粪":"fen","偾":"fen","瀵":"fen","棼":"fen","愍":"fen","鲼":"fen","鼢":"fen","丰":"feng","封":"feng","枫":"feng","蜂":"feng","峰":"feng","锋":"feng","风":"feng","疯":"feng","烽":"feng","逢":"feng","冯":"feng","缝":"feng","讽":"feng","奉":"feng","凤":"feng","俸":"feng","酆":"feng","葑":"feng","沣":"feng","砜":"feng","佛":"fu","否":"fu","夫":"fu","敷":"fu","肤":"fu","孵":"fu","扶":"fu","拂":"fu","辐":"fu",
"幅":"fu","氟":"fu","符":"fu","伏":"fu","俘":"fu","服":"fu","浮":"fu","涪":"fu","福":"fu","袱":"fu","弗":"fu","甫":"fu","抚":"fu","辅":"fu","俯":"fu","釜":"fu","斧":"fu","脯":"fu","腑":"fu","府":"fu","腐":"fu","赴":"fu","副":"fu","覆":"fu","赋":"fu","复":"fu","傅":"fu","付":"fu","阜":"fu","父":"fu","腹":"fu","负":"fu","富":"fu","讣":"fu","附":"fu","妇":"fu","缚":"fu","咐":"fu","匐":"fu","凫":"fu","郛":"fu","芙":"fu","苻":"fu","茯":"fu","莩":"fu","菔":"fu","呋":"fu","幞":"fu","滏":"fu","艴":"fu","孚":"fu","驸":"fu","绂":"fu","桴":"fu","赙":"fu","黻":"fu","黼":"fu","罘":"fu","稃":"fu","馥":"fu","虍":"fu","蚨":"fu","蜉":"fu","蝠":"fu","蝮":"fu","麸":"fu","趺":"fu","跗":"fu","鳆":"fu","噶":"ga","嘎":"ga","蛤":"ga","尬":"ga","呷":"ga","尕":"ga","尜":"ga","旮":"ga","钆":"ga","该":"gai","改":"gai","概":"gai","钙":"gai","盖":"gai","溉":"gai","丐":"gai","陔":"gai","垓":"gai","戤":"gai","赅":"gai","胲":"gai","干":"gan","甘":"gan","杆":"gan","柑":"gan","竿":"gan","肝":"gan","赶":"gan","感":"gan","秆":"gan","敢":"gan","赣":"gan","坩":"gan","苷":"gan","尴":"gan","擀":"gan","泔":"gan","淦":"gan",
"澉":"gan","绀":"gan","橄":"gan","旰":"gan","矸":"gan","疳":"gan","酐":"gan","冈":"gang","刚":"gang","钢":"gang","缸":"gang","肛":"gang","纲":"gang","岗":"gang","港":"gang","戆":"gang","罡":"gang","颃":"gang","筻":"gang","杠":"gong","工":"gong","攻":"gong","功":"gong","恭":"gong","龚":"gong","供":"gong","躬":"gong","公":"gong","宫":"gong","弓":"gong","巩":"gong","汞":"gong","拱":"gong","贡":"gong","共":"gong","蕻":"gong","廾":"gong","咣":"gong","珙":"gong","肱":"gong","蚣":"gong","蛩":"gong","觥":"gong","篙":"gao","皋":"gao","高":"gao","膏":"gao","羔":"gao","糕":"gao","搞":"gao","镐":"gao","稿":"gao","告":"gao","睾":"gao","诰":"gao","郜":"gao","蒿":"gao","藁":"gao","缟":"gao","槔":"gao","槁":"gao","杲":"gao","锆":"gao","哥":"ge","歌":"ge","搁":"ge","戈":"ge","鸽":"ge","胳":"ge","疙":"ge","割":"ge","革":"ge","葛":"ge","格":"ge","阁":"ge","隔":"ge","铬":"ge","个":"ge","各":"ge","鬲":"ge","仡":"ge","哿":"ge","塥":"ge","嗝":"ge","纥":"ge","搿":"ge","膈":"ge","硌":"ge","铪":"ge","镉":"ge","袼":"ge","颌":"ge","虼":"ge","舸":"ge","骼":"ge","髂":"ge","给":"gei","根":"gen","跟":"gen",
"亘":"gen","茛":"gen","哏":"gen","艮":"gen","耕":"geng","更":"geng","庚":"geng","羹":"geng","埂":"geng","耿":"geng","梗":"geng","哽":"geng","赓":"geng","鲠":"geng","钩":"gou","勾":"gou","沟":"gou","苟":"gou","狗":"gou","垢":"gou","构":"gou","购":"gou","够":"gou","佝":"gou","诟":"gou","岣":"gou","遘":"gou","媾":"gou","缑":"gou","觏":"gou","彀":"gou","鸲":"gou","笱":"gou","篝":"gou","鞲":"gou","辜":"gu","菇":"gu","咕":"gu","箍":"gu","估":"gu","沽":"gu","孤":"gu","姑":"gu","鼓":"gu","古":"gu","蛊":"gu","骨":"gu","谷":"gu","股":"gu","故":"gu","顾":"gu","固":"gu","雇":"gu","嘏":"gu","诂":"gu","菰":"gu","哌":"gu","崮":"gu","汩":"gu","梏":"gu","轱":"gu","牯":"gu","牿":"gu","胍":"gu","臌":"gu","毂":"gu","瞽":"gu","罟":"gu","钴":"gu","锢":"gu","瓠":"gu","鸪":"gu","鹄":"gu","痼":"gu","蛄":"gu","酤":"gu","觚":"gu","鲴":"gu","骰":"gu","鹘":"gu","刮":"gua","瓜":"gua","剐":"gua","寡":"gua","挂":"gua","褂":"gua","卦":"gua","诖":"gua","呱":"gua","栝":"gua","鸹":"gua","乖":"guai","拐":"guai","怪":"guai","哙":"guai","棺":"guan","关":"guan","官":"guan","冠":"guan","观":"guan","管":"guan","馆":"guan",
"罐":"guan","惯":"guan","灌":"guan","贯":"guan","倌":"guan","莞":"guan","掼":"guan","涫":"guan","盥":"guan","鹳":"guan","鳏":"guan","光":"guang","广":"guang","逛":"guang","犷":"guang","桄":"guang","胱":"guang","疒":"guang","瑰":"gui","规":"gui","圭":"gui","硅":"gui","归":"gui","龟":"gui","闺":"gui","轨":"gui","鬼":"gui","诡":"gui","癸":"gui","桂":"gui","柜":"gui","跪":"gui","贵":"gui","刽":"gui","匦":"gui","刿":"gui","庋":"gui","宄":"gui","妫":"gui","桧":"gui","炅":"gui","晷":"gui","皈":"gui","簋":"gui","鲑":"gui","鳜":"gui","辊":"gun","滚":"gun","棍":"gun","丨":"gun","衮":"gun","绲":"gun","磙":"gun","鲧":"gun","锅":"guo","郭":"guo","国":"guo","果":"guo","裹":"guo","过":"guo","馘":"guo","蠃":"guo","埚":"guo","掴":"guo","呙":"guo","囗":"guo","帼":"guo","崞":"guo","猓":"guo","椁":"guo","虢":"guo","锞":"guo","聒":"guo","蜮":"guo","蜾":"guo","蝈":"guo","哈":"ha","骸":"hai","孩":"hai","海":"hai","氦":"hai","亥":"hai","害":"hai","骇":"hai","咴":"hai","嗨":"hai","颏":"hai","醢":"hai","酣":"han","憨":"han","邯":"han","韩":"han","含":"han","涵":"han","寒":"han","函":"han","喊":"han",
"罕":"han","翰":"han","撼":"han","捍":"han","旱":"han","憾":"han","悍":"han","焊":"han","汗":"han","汉":"han","邗":"han","菡":"han","撖":"han","阚":"han","瀚":"han","晗":"han","焓":"han","颔":"han","蚶":"han","鼾":"han","夯":"hen","痕":"hen","很":"hen","狠":"hen","恨":"hen","杭":"hang","航":"hang","沆":"hang","绗":"hang","珩":"hang","桁":"hang","壕":"hao","嚎":"hao","豪":"hao","毫":"hao","郝":"hao","好":"hao","耗":"hao","号":"hao","浩":"hao","薅":"hao","嗥":"hao","嚆":"hao","濠":"hao","灏":"hao","昊":"hao","皓":"hao","颢":"hao","蚝":"hao","呵":"he","喝":"he","荷":"he","菏":"he","核":"he","禾":"he","和":"he","何":"he","合":"he","盒":"he","貉":"he","阂":"he","河":"he","涸":"he","赫":"he","褐":"he","鹤":"he","贺":"he","诃":"he","劾":"he","壑":"he","藿":"he","嗑":"he","嗬":"he","阖":"he","盍":"he","蚵":"he","翮":"he","嘿":"hei","黑":"hei","哼":"heng","亨":"heng","横":"heng","衡":"heng","恒":"heng","訇":"heng","蘅":"heng","轰":"hong","哄":"hong","烘":"hong","虹":"hong","鸿":"hong","洪":"hong","宏":"hong","弘":"hong","红":"hong","黉":"hong","讧":"hong","荭":"hong","薨":"hong","闳":"hong",
"泓":"hong","喉":"hou","侯":"hou","猴":"hou","吼":"hou","厚":"hou","候":"hou","后":"hou","堠":"hou","後":"hou","逅":"hou","瘊":"hou","篌":"hou","糇":"hou","鲎":"hou","骺":"hou","呼":"hu","乎":"hu","忽":"hu","瑚":"hu","壶":"hu","葫":"hu","胡":"hu","蝴":"hu","狐":"hu","糊":"hu","湖":"hu","弧":"hu","虎":"hu","唬":"hu","护":"hu","互":"hu","沪":"hu","户":"hu","冱":"hu","唿":"hu","囫":"hu","岵":"hu","猢":"hu","怙":"hu","惚":"hu","浒":"hu","滹":"hu","琥":"hu","槲":"hu","轷":"hu","觳":"hu","烀":"hu","煳":"hu","戽":"hu","扈":"hu","祜":"hu","鹕":"hu","鹱":"hu","笏":"hu","醐":"hu","斛":"hu","花":"hua","哗":"hua","华":"hua","猾":"hua","滑":"hua","画":"hua","划":"hua","化":"hua","话":"hua","劐":"hua","浍":"hua","骅":"hua","桦":"hua","铧":"hua","稞":"hua","槐":"huai","徊":"huai","怀":"huai","淮":"huai","坏":"huai","还":"huai","踝":"huai","欢":"huan","环":"huan","桓":"huan","缓":"huan","换":"huan","患":"huan","唤":"huan","痪":"huan","豢":"huan","焕":"huan","涣":"huan","宦":"huan","幻":"huan","郇":"huan","奂":"huan","垸":"huan","擐":"huan","圜":"huan","洹":"huan","浣":"huan","漶":"huan","寰":"huan",
"逭":"huan","缳":"huan","锾":"huan","鲩":"huan","鬟":"huan","荒":"huang","慌":"huang","黄":"huang","磺":"huang","蝗":"huang","簧":"huang","皇":"huang","凰":"huang","惶":"huang","煌":"huang","晃":"huang","幌":"huang","恍":"huang","谎":"huang","隍":"huang","徨":"huang","湟":"huang","潢":"huang","遑":"huang","璜":"huang","肓":"huang","癀":"huang","蟥":"huang","篁":"huang","鳇":"huang","灰":"hui","挥":"hui","辉":"hui","徽":"hui","恢":"hui","蛔":"hui","回":"hui","毁":"hui","悔":"hui","慧":"hui","卉":"hui","惠":"hui","晦":"hui","贿":"hui","秽":"hui","会":"hui","烩":"hui","汇":"hui","讳":"hui","诲":"hui","绘":"hui","诙":"hui","茴":"hui","荟":"hui","蕙":"hui","哕":"hui","喙":"hui","隳":"hui","洄":"hui","彗":"hui","缋":"hui","珲":"hui","晖":"hui","恚":"hui","虺":"hui","蟪":"hui","麾":"hui","荤":"hun","昏":"hun","婚":"hun","魂":"hun","浑":"hun","混":"hun","诨":"hun","馄":"hun","阍":"hun","溷":"hun","缗":"hun","豁":"huo","活":"huo","伙":"huo","火":"huo","获":"huo","或":"huo","惑":"huo","霍":"huo","货":"huo","祸":"huo","攉":"huo","嚯":"huo","夥":"huo","钬":"huo","锪":"huo","镬":"huo",
"耠":"huo","蠖":"huo","击":"ji","圾":"ji","基":"ji","机":"ji","畸":"ji","稽":"ji","积":"ji","箕":"ji","肌":"ji","饥":"ji","迹":"ji","激":"ji","讥":"ji","鸡":"ji","姬":"ji","绩":"ji","缉":"ji","吉":"ji","极":"ji","棘":"ji","辑":"ji","籍":"ji","集":"ji","及":"ji","急":"ji","疾":"ji","汲":"ji","即":"ji","嫉":"ji","级":"ji","挤":"ji","几":"ji","脊":"ji","己":"ji","蓟":"ji","技":"ji","冀":"ji","季":"ji","伎":"ji","祭":"ji","剂":"ji","悸":"ji","济":"ji","寄":"ji","寂":"ji","计":"ji","记":"ji","既":"ji","忌":"ji","际":"ji","妓":"ji","继":"ji","纪":"ji","居":"ji","丌":"ji","乩":"ji","剞":"ji","佶":"ji","佴":"ji","脔":"ji","墼":"ji","芨":"ji","芰":"ji","萁":"ji","蒺":"ji","蕺":"ji","掎":"ji","叽":"ji","咭":"ji","哜":"ji","唧":"ji","岌":"ji","嵴":"ji","洎":"ji","彐":"ji","屐":"ji","骥":"ji","畿":"ji","玑":"ji","楫":"ji","殛":"ji","戟":"ji","戢":"ji","赍":"ji","觊":"ji","犄":"ji","齑":"ji","矶":"ji","羁":"ji","嵇":"ji","稷":"ji","瘠":"ji","瘵":"ji","虮":"ji","笈":"ji","笄":"ji","暨":"ji","跻":"ji","跽":"ji","霁":"ji","鲚":"ji","鲫":"ji","髻":"ji","麂":"ji","嘉":"jia","枷":"jia","夹":"jia","佳":"jia",
"家":"jia","加":"jia","荚":"jia","颊":"jia","贾":"jia","甲":"jia","钾":"jia","假":"jia","稼":"jia","价":"jia","架":"jia","驾":"jia","嫁":"jia","伽":"jia","郏":"jia","拮":"jia","岬":"jia","浃":"jia","迦":"jia","珈":"jia","戛":"jia","胛":"jia","恝":"jia","铗":"jia","镓":"jia","痂":"jia","蛱":"jia","笳":"jia","袈":"jia","跏":"jia","歼":"jian","监":"jian","坚":"jian","尖":"jian","笺":"jian","间":"jian","煎":"jian","兼":"jian","肩":"jian","艰":"jian","奸":"jian","缄":"jian","茧":"jian","检":"jian","柬":"jian","碱":"jian","硷":"jian","拣":"jian","捡":"jian","简":"jian","俭":"jian","剪":"jian","减":"jian","荐":"jian","槛":"jian","鉴":"jian","践":"jian","贱":"jian","见":"jian","键":"jian","箭":"jian","件":"jian","健":"jian","舰":"jian","剑":"jian","饯":"jian","渐":"jian","溅":"jian","涧":"jian","建":"jian","僭":"jian","谏":"jian","谫":"jian","菅":"jian","蒹":"jian","搛":"jian","囝":"jian","湔":"jian","蹇":"jian","謇":"jian","缣":"jian","枧":"jian","柙":"jian","楗":"jian","戋":"jian","戬":"jian","牮":"jian","犍":"jian","毽":"jian","腱":"jian","睑":"jian","锏":"jian","鹣":"jian",
"裥":"jian","笕":"jian","箴":"jian","翦":"jian","趼":"jian","踺":"jian","鲣":"jian","鞯":"jian","僵":"jiang","姜":"jiang","将":"jiang","浆":"jiang","江":"jiang","疆":"jiang","蒋":"jiang","桨":"jiang","奖":"jiang","讲":"jiang","匠":"jiang","酱":"jiang","降":"jiang","茳":"jiang","洚":"jiang","绛":"jiang","缰":"jiang","犟":"jiang","礓":"jiang","耩":"jiang","糨":"jiang","豇":"jiang","蕉":"jiao","椒":"jiao","礁":"jiao","焦":"jiao","胶":"jiao","交":"jiao","郊":"jiao","浇":"jiao","骄":"jiao","娇":"jiao","嚼":"jiao","搅":"jiao","铰":"jiao","矫":"jiao","侥":"jiao","脚":"jiao","狡":"jiao","角":"jiao","饺":"jiao","缴":"jiao","绞":"jiao","剿":"jiao","教":"jiao","酵":"jiao","轿":"jiao","较":"jiao","叫":"jiao","佼":"jiao","僬":"jiao","茭":"jiao","挢":"jiao","噍":"jiao","峤":"jiao","徼":"jiao","姣":"jiao","纟":"jiao","敫":"jiao","皎":"jiao","鹪":"jiao","蛟":"jiao","醮":"jiao","跤":"jiao","鲛":"jiao","窖":"jie","揭":"jie","接":"jie","皆":"jie","秸":"jie","街":"jie","阶":"jie","截":"jie","劫":"jie","节":"jie","桔":"jie","杰":"jie","捷":"jie","睫":"jie","竭":"jie","洁":"jie","结":"jie",
"解":"jie","姐":"jie","戒":"jie","藉":"jie","芥":"jie","界":"jie","借":"jie","介":"jie","疥":"jie","诫":"jie","届":"jie","偈":"jie","讦":"jie","诘":"jie","喈":"jie","嗟":"jie","獬":"jie","婕":"jie","孑":"jie","桀":"jie","獒":"jie","碣":"jie","锴":"jie","疖":"jie","袷":"jie","颉":"jie","蚧":"jie","羯":"jie","鲒":"jie","骱":"jie","髫":"jie","巾":"jin","筋":"jin","斤":"jin","金":"jin","今":"jin","津":"jin","襟":"jin","紧":"jin","锦":"jin","仅":"jin","谨":"jin","进":"jin","靳":"jin","晋":"jin","禁":"jin","近":"jin","烬":"jin","浸":"jin","尽":"jin","卺":"jin","荩":"jin","堇":"jin","噤":"jin","馑":"jin","廑":"jin","妗":"jin","缙":"jin","瑾":"jin","槿":"jin","赆":"jin","觐":"jin","钅":"jin","锓":"jin","衿":"jin","矜":"jin","劲":"jing","荆":"jing","兢":"jing","茎":"jing","睛":"jing","晶":"jing","鲸":"jing","京":"jing","惊":"jing","精":"jing","粳":"jing","经":"jing","井":"jing","警":"jing","景":"jing","颈":"jing","静":"jing","境":"jing","敬":"jing","镜":"jing","径":"jing","痉":"jing","靖":"jing","竟":"jing","竞":"jing","净":"jing","刭":"jing","儆":"jing","阱":"jing","菁":"jing",
"獍":"jing","憬":"jing","泾":"jing","迳":"jing","弪":"jing","婧":"jing","肼":"jing","胫":"jing","腈":"jing","旌":"jing","炯":"jiong","窘":"jiong","冂":"jiong","迥":"jiong","扃":"jiong","揪":"jiu","究":"jiu","纠":"jiu","玖":"jiu","韭":"jiu","久":"jiu","灸":"jiu","九":"jiu","酒":"jiu","厩":"jiu","救":"jiu","旧":"jiu","臼":"jiu","舅":"jiu","咎":"jiu","就":"jiu","疚":"jiu","僦":"jiu","啾":"jiu","阄":"jiu","柩":"jiu","桕":"jiu","鹫":"jiu","赳":"jiu","鬏":"jiu","鞠":"ju","拘":"ju","狙":"ju","疽":"ju","驹":"ju","菊":"ju","局":"ju","咀":"ju","矩":"ju","举":"ju","沮":"ju","聚":"ju","拒":"ju","据":"ju","巨":"ju","具":"ju","距":"ju","踞":"ju","锯":"ju","俱":"ju","句":"ju","惧":"ju","炬":"ju","剧":"ju","倨":"ju","讵":"ju","苣":"ju","苴":"ju","莒":"ju","掬":"ju","遽":"ju","屦":"ju","琚":"ju","枸":"ju","椐":"ju","榘":"ju","榉":"ju","橘":"ju","犋":"ju","飓":"ju","钜":"ju","锔":"ju","窭":"ju","裾":"ju","趄":"ju","醵":"ju","踽":"ju","龃":"ju","雎":"ju","鞫":"ju","捐":"juan","鹃":"juan","娟":"juan","倦":"juan","眷":"juan","卷":"juan","绢":"juan","鄄":"juan","狷":"juan","涓":"juan","桊":"juan",
"蠲":"juan","锩":"juan","镌":"juan","隽":"juan","撅":"jue","攫":"jue","抉":"jue","掘":"jue","倔":"jue","爵":"jue","觉":"jue","决":"jue","诀":"jue","绝":"jue","厥":"jue","劂":"jue","谲":"jue","矍":"jue","蕨":"jue","噘":"jue","崛":"jue","獗":"jue","孓":"jue","珏":"jue","桷":"jue","橛":"jue","爝":"jue","镢":"jue","蹶":"jue","觖":"jue","均":"jun","菌":"jun","钧":"jun","军":"jun","君":"jun","峻":"jun","俊":"jun","竣":"jun","浚":"jun","郡":"jun","骏":"jun","捃":"jun","狻":"jun","皲":"jun","筠":"jun","麇":"jun","喀":"ka","咖":"ka","卡":"ka","佧":"ka","咔":"ka","胩":"ka","咯":"ke","坷":"ke","苛":"ke","柯":"ke","棵":"ke","磕":"ke","颗":"ke","科":"ke","壳":"ke","咳":"ke","可":"ke","渴":"ke","克":"ke","刻":"ke","客":"ke","课":"ke","岢":"ke","恪":"ke","溘":"ke","骒":"ke","缂":"ke","珂":"ke","轲":"ke","氪":"ke","瞌":"ke","钶":"ke","疴":"ke","窠":"ke","蝌":"ke","髁":"ke","开":"kai","揩":"kai","楷":"kai","凯":"kai","慨":"kai","剀":"kai","垲":"kai","蒈":"kai","忾":"kai","恺":"kai","铠":"kai","锎":"kai","刊":"kan","堪":"kan","勘":"kan","坎":"kan","砍":"kan","看":"kan","侃":"kan","凵":"kan","莰":"kan",
"莶":"kan","戡":"kan","龛":"kan","瞰":"kan","康":"kang","慷":"kang","糠":"kang","扛":"kang","抗":"kang","亢":"kang","炕":"kang","坑":"kang","伉":"kang","闶":"kang","钪":"kang","考":"kao","拷":"kao","烤":"kao","靠":"kao","尻":"kao","栲":"kao","犒":"kao","铐":"kao","肯":"ken","啃":"ken","垦":"ken","恳":"ken","垠":"ken","裉":"ken","颀":"ken","吭":"keng","忐":"keng","铿":"keng","空":"kong","恐":"kong","孔":"kong","控":"kong","倥":"kong","崆":"kong","箜":"kong","抠":"kou","口":"kou","扣":"kou","寇":"kou","芤":"kou","蔻":"kou","叩":"kou","眍":"kou","筘":"kou","枯":"ku","哭":"ku","窟":"ku","苦":"ku","酷":"ku","库":"ku","裤":"ku","刳":"ku","堀":"ku","喾":"ku","绔":"ku","骷":"ku","夸":"kua","垮":"kua","挎":"kua","跨":"kua","胯":"kua","侉":"kua","块":"kuai","筷":"kuai","侩":"kuai","快":"kuai","蒯":"kuai","郐":"kuai","蒉":"kuai","狯":"kuai","脍":"kuai","宽":"kuan","款":"kuan","髋":"kuan","匡":"kuang","筐":"kuang","狂":"kuang","框":"kuang","矿":"kuang","眶":"kuang","旷":"kuang","况":"kuang","诓":"kuang","诳":"kuang","邝":"kuang","圹":"kuang","夼":"kuang","哐":"kuang","纩":"kuang",
"贶":"kuang","亏":"kui","盔":"kui","岿":"kui","窥":"kui","葵":"kui","奎":"kui","魁":"kui","傀":"kui","馈":"kui","愧":"kui","溃":"kui","馗":"kui","匮":"kui","夔":"kui","隗":"kui","揆":"kui","喹":"kui","喟":"kui","悝":"kui","愦":"kui","阕":"kui","逵":"kui","暌":"kui","睽":"kui","聩":"kui","蝰":"kui","篑":"kui","臾":"kui","跬":"kui","坤":"kun","昆":"kun","捆":"kun","困":"kun","悃":"kun","阃":"kun","琨":"kun","锟":"kun","醌":"kun","鲲":"kun","髡":"kun","括":"kuo","扩":"kuo","廓":"kuo","阔":"kuo","蛞":"kuo","垃":"la","拉":"la","喇":"la","蜡":"la","腊":"la","辣":"la","啦":"la","剌":"la","摺":"la","邋":"la","旯":"la","砬":"la","瘌":"la","莱":"lai","来":"lai","赖":"lai","崃":"lai","徕":"lai","涞":"lai","濑":"lai","赉":"lai","睐":"lai","铼":"lai","癞":"lai","籁":"lai","蓝":"lan","婪":"lan","栏":"lan","拦":"lan","篮":"lan","阑":"lan","兰":"lan","澜":"lan","谰":"lan","揽":"lan","览":"lan","懒":"lan","缆":"lan","烂":"lan","滥":"lan","啉":"lan","岚":"lan","懔":"lan","漤":"lan","榄":"lan","斓":"lan","罱":"lan","镧":"lan","褴":"lan","琅":"lang","榔":"lang","狼":"lang","廊":"lang","郎":"lang",
"朗":"lang","浪":"lang","莨":"lang","蒗":"lang","啷":"lang","阆":"lang","锒":"lang","稂":"lang","螂":"lang","捞":"lao","劳":"lao","牢":"lao","老":"lao","佬":"lao","姥":"lao","酪":"lao","烙":"lao","涝":"lao","唠":"lao","崂":"lao","栳":"lao","铑":"lao","铹":"lao","痨":"lao","醪":"lao","勒":"le","乐":"le","肋":"le","仂":"le","叻":"le","嘞":"le","泐":"le","鳓":"le","雷":"lei","镭":"lei","蕾":"lei","磊":"lei","累":"lei","儡":"lei","垒":"lei","擂":"lei","类":"lei","泪":"lei","羸":"lei","诔":"lei","荽":"lei","咧":"lei","漯":"lei","嫘":"lei","缧":"lei","檑":"lei","耒":"lei","酹":"lei","棱":"ling","冷":"ling","拎":"ling","玲":"ling","菱":"ling","零":"ling","龄":"ling","铃":"ling","伶":"ling","羚":"ling","凌":"ling","灵":"ling","陵":"ling","岭":"ling","领":"ling","另":"ling","令":"ling","酃":"ling","塄":"ling","苓":"ling","呤":"ling","囹":"ling","泠":"ling","绫":"ling","柃":"ling","棂":"ling","瓴":"ling","聆":"ling","蛉":"ling","翎":"ling","鲮":"ling","楞":"leng","愣":"leng","厘":"li","梨":"li","犁":"li","黎":"li","篱":"li","狸":"li","离":"li","漓":"li","理":"li","李":"li","里":"li",
"鲤":"li","礼":"li","莉":"li","荔":"li","吏":"li","栗":"li","丽":"li","厉":"li","励":"li","砾":"li","历":"li","利":"li","傈":"li","例":"li","俐":"li","痢":"li","立":"li","粒":"li","沥":"li","隶":"li","力":"li","璃":"li","哩":"li","俪":"li","俚":"li","郦":"li","坜":"li","苈":"li","莅":"li","蓠":"li","藜":"li","捩":"li","呖":"li","唳":"li","喱":"li","猁":"li","溧":"li","澧":"li","逦":"li","娌":"li","嫠":"li","骊":"li","缡":"li","珞":"li","枥":"li","栎":"li","轹":"li","戾":"li","砺":"li","詈":"li","罹":"li","锂":"li","鹂":"li","疠":"li","疬":"li","蛎":"li","蜊":"li","蠡":"li","笠":"li","篥":"li","粝":"li","醴":"li","跞":"li","雳":"li","鲡":"li","鳢":"li","黧":"li","俩":"lian","联":"lian","莲":"lian","连":"lian","镰":"lian","廉":"lian","怜":"lian","涟":"lian","帘":"lian","敛":"lian","脸":"lian","链":"lian","恋":"lian","炼":"lian","练":"lian","挛":"lian","蔹":"lian","奁":"lian","潋":"lian","濂":"lian","娈":"lian","琏":"lian","楝":"lian","殓":"lian","臁":"lian","膦":"lian","裢":"lian","蠊":"lian","鲢":"lian","粮":"liang","凉":"liang","梁":"liang","粱":"liang","良":"liang","两":"liang",
"辆":"liang","量":"liang","晾":"liang","亮":"liang","谅":"liang","墚":"liang","椋":"liang","踉":"liang","靓":"liang","魉":"liang","撩":"liao","聊":"liao","僚":"liao","疗":"liao","燎":"liao","寥":"liao","辽":"liao","潦":"liao","了":"liao","撂":"liao","镣":"liao","廖":"liao","料":"liao","蓼":"liao","尥":"liao","嘹":"liao","獠":"liao","寮":"liao","缭":"liao","钌":"liao","鹩":"liao","耢":"liao","列":"lie","裂":"lie","烈":"lie","劣":"lie","猎":"lie","冽":"lie","埒":"lie","洌":"lie","趔":"lie","躐":"lie","鬣":"lie","琳":"lin","林":"lin","磷":"lin","霖":"lin","临":"lin","邻":"lin","鳞":"lin","淋":"lin","凛":"lin","赁":"lin","吝":"lin","蔺":"lin","嶙":"lin","廪":"lin","遴":"lin","檩":"lin","辚":"lin","瞵":"lin","粼":"lin","躏":"lin","麟":"lin","溜":"liu","琉":"liu","榴":"liu","硫":"liu","馏":"liu","留":"liu","刘":"liu","瘤":"liu","流":"liu","柳":"liu","六":"liu","抡":"liu","偻":"liu","蒌":"liu","泖":"liu","浏":"liu","遛":"liu","骝":"liu","绺":"liu","旒":"liu","熘":"liu","锍":"liu","镏":"liu","鹨":"liu","鎏":"liu","龙":"long","聋":"long","咙":"long","笼":"long","窿":"long","隆":"long",
"垄":"long","拢":"long","陇":"long","弄":"long","垅":"long","茏":"long","泷":"long","珑":"long","栊":"long","胧":"long","砻":"long","癃":"long","楼":"lou","娄":"lou","搂":"lou","篓":"lou","漏":"lou","陋":"lou","喽":"lou","嵝":"lou","镂":"lou","瘘":"lou","耧":"lou","蝼":"lou","髅":"lou","芦":"lu","卢":"lu","颅":"lu","庐":"lu","炉":"lu","掳":"lu","卤":"lu","虏":"lu","鲁":"lu","麓":"lu","碌":"lu","露":"lu","路":"lu","赂":"lu","鹿":"lu","潞":"lu","禄":"lu","录":"lu","陆":"lu","戮":"lu","垆":"lu","摅":"lu","撸":"lu","噜":"lu","泸":"lu","渌":"lu","漉":"lu","璐":"lu","栌":"lu","橹":"lu","轳":"lu","辂":"lu","辘":"lu","氇":"lu","胪":"lu","镥":"lu","鸬":"lu","鹭":"lu","簏":"lu","舻":"lu","鲈":"lu","驴":"lv","吕":"lv","铝":"lv","侣":"lv","旅":"lv","履":"lv","屡":"lv","缕":"lv","虑":"lv","氯":"lv","律":"lv","率":"lv","滤":"lv","绿":"lv","捋":"lv","闾":"lv","榈":"lv","膂":"lv","稆":"lv","褛":"lv","峦":"luan","孪":"luan","滦":"luan","卵":"luan","乱":"luan","栾":"luan","鸾":"luan","銮":"luan","掠":"lue","略":"lue","锊":"lue","轮":"lun","伦":"lun","仑":"lun","沦":"lun","纶":"lun","论":"lun","囵":"lun",
"萝":"luo","螺":"luo","罗":"luo","逻":"luo","锣":"luo","箩":"luo","骡":"luo","裸":"luo","落":"luo","洛":"luo","骆":"luo","络":"luo","倮":"luo","荦":"luo","摞":"luo","猡":"luo","泺":"luo","椤":"luo","脶":"luo","镙":"luo","瘰":"luo","雒":"luo","妈":"ma","麻":"ma","玛":"ma","码":"ma","蚂":"ma","马":"ma","骂":"ma","嘛":"ma","吗":"ma","唛":"ma","犸":"ma","嬷":"ma","杩":"ma","麽":"ma","埋":"mai","买":"mai","麦":"mai","卖":"mai","迈":"mai","脉":"mai","劢":"mai","荬":"mai","咪":"mai","霾":"mai","瞒":"man","馒":"man","蛮":"man","满":"man","蔓":"man","曼":"man","慢":"man","漫":"man","谩":"man","墁":"man","幔":"man","缦":"man","熳":"man","镘":"man","颟":"man","螨":"man","鳗":"man","鞔":"man","芒":"mang","茫":"mang","盲":"mang","忙":"mang","莽":"mang","邙":"mang","漭":"mang","朦":"mang","硭":"mang","蟒":"mang","氓":"meng","萌":"meng","蒙":"meng","檬":"meng","盟":"meng","锰":"meng","猛":"meng","梦":"meng","孟":"meng","勐":"meng","甍":"meng","瞢":"meng","懵":"meng","礞":"meng","虻":"meng","蜢":"meng","蠓":"meng","艋":"meng","艨":"meng","黾":"meng","猫":"miao","苗":"miao","描":"miao","瞄":"miao",
"藐":"miao","秒":"miao","渺":"miao","庙":"miao","妙":"miao","喵":"miao","邈":"miao","缈":"miao","缪":"miao","杪":"miao","淼":"miao","眇":"miao","鹋":"miao","蜱":"miao","茅":"mao","锚":"mao","毛":"mao","矛":"mao","铆":"mao","卯":"mao","茂":"mao","冒":"mao","帽":"mao","貌":"mao","贸":"mao","侔":"mao","袤":"mao","勖":"mao","茆":"mao","峁":"mao","瑁":"mao","昴":"mao","牦":"mao","耄":"mao","旄":"mao","懋":"mao","瞀":"mao","蛑":"mao","蝥":"mao","蟊":"mao","髦":"mao","么":"me","玫":"mei","枚":"mei","梅":"mei","酶":"mei","霉":"mei","煤":"mei","没":"mei","眉":"mei","媒":"mei","镁":"mei","每":"mei","美":"mei","昧":"mei","寐":"mei","妹":"mei","媚":"mei","坶":"mei","莓":"mei","嵋":"mei","猸":"mei","浼":"mei","湄":"mei","楣":"mei","镅":"mei","鹛":"mei","袂":"mei","魅":"mei","门":"men","闷":"men","们":"men","扪":"men","玟":"men","焖":"men","懑":"men","钔":"men","眯":"mi","醚":"mi","靡":"mi","糜":"mi","迷":"mi","谜":"mi","弥":"mi","米":"mi","秘":"mi","觅":"mi","泌":"mi","蜜":"mi","密":"mi","幂":"mi","芈":"mi","冖":"mi","谧":"mi","蘼":"mi","嘧":"mi","猕":"mi","獯":"mi","汨":"mi","宓":"mi","弭":"mi",
"脒":"mi","敉":"mi","糸":"mi","縻":"mi","麋":"mi","棉":"mian","眠":"mian","绵":"mian","冕":"mian","免":"mian","勉":"mian","娩":"mian","缅":"mian","面":"mian","沔":"mian","湎":"mian","腼":"mian","眄":"mian","蔑":"mie","灭":"mie","咩":"mie","蠛":"mie","篾":"mie","民":"min","抿":"min","皿":"min","敏":"min","悯":"min","闽":"min","苠":"min","岷":"min","闵":"min","泯":"min","珉":"min","明":"ming","螟":"ming","鸣":"ming","铭":"ming","名":"ming","命":"ming","冥":"ming","茗":"ming","溟":"ming","暝":"ming","瞑":"ming","酩":"ming","谬":"miu","摸":"mo","摹":"mo","蘑":"mo","模":"mo","膜":"mo","磨":"mo","摩":"mo","魔":"mo","抹":"mo","末":"mo","莫":"mo","墨":"mo","默":"mo","沫":"mo","漠":"mo","寞":"mo","陌":"mo","谟":"mo","茉":"mo","蓦":"mo","馍":"mo","嫫":"mo","镆":"mo","秣":"mo","瘼":"mo","耱":"mo","蟆":"mo","貊":"mo","貘":"mo","谋":"mou","牟":"mou","某":"mou","厶":"mou","哞":"mou","婺":"mou","眸":"mou","鍪":"mou","拇":"mu","牡":"mu","亩":"mu","姆":"mu","母":"mu","墓":"mu","暮":"mu","幕":"mu","募":"mu","慕":"mu","木":"mu","目":"mu","睦":"mu","牧":"mu","穆":"mu","仫":"mu","苜":"mu","呒":"mu",
"沐":"mu","毪":"mu","钼":"mu","拿":"na","哪":"na","呐":"na","钠":"na","那":"na","娜":"na","纳":"na","内":"na","捺":"na","肭":"na","镎":"na","衲":"na","箬":"na","氖":"nai","乃":"nai","奶":"nai","耐":"nai","奈":"nai","鼐":"nai","艿":"nai","萘":"nai","柰":"nai","南":"nan","男":"nan","难":"nan","囊":"nan","喃":"nan","囡":"nan","楠":"nan","腩":"nan","蝻":"nan","赧":"nan","挠":"nao","脑":"nao","恼":"nao","闹":"nao","孬":"nao","垴":"nao","猱":"nao","瑙":"nao","硇":"nao","铙":"nao","蛲":"nao","淖":"ne","呢":"ne","讷":"ne","馁":"nei","嫩":"nen","能":"nen","枘":"nen","恁":"nen","妮":"ni","霓":"ni","倪":"ni","泥":"ni","尼":"ni","拟":"ni","你":"ni","匿":"ni","腻":"ni","逆":"ni","溺":"ni","伲":"ni","坭":"ni","猊":"ni","怩":"ni","滠":"ni","昵":"ni","旎":"ni","祢":"ni","慝":"ni","睨":"ni","铌":"ni","鲵":"ni","蔫":"nian","拈":"nian","年":"nian","碾":"nian","撵":"nian","捻":"nian","念":"nian","廿":"nian","辇":"nian","黏":"nian","鲇":"nian","鲶":"nian","娘":"niang","酿":"niang","鸟":"niao","尿":"niao","茑":"niao","嬲":"niao","脲":"niao","袅":"niao","捏":"nie","聂":"nie","孽":"nie","啮":"nie","镊":"nie",
"镍":"nie","涅":"nie","乜":"nie","陧":"nie","蘖":"nie","嗫":"nie","肀":"nie","颞":"nie","臬":"nie","蹑":"nie","您":"nin","柠":"nin","狞":"ning","凝":"ning","宁":"ning","拧":"ning","泞":"ning","佞":"ning","蓥":"ning","咛":"ning","甯":"ning","聍":"ning","牛":"niu","扭":"niu","钮":"niu","纽":"niu","狃":"niu","忸":"niu","妞":"niu","蚴":"niu","脓":"nong","浓":"nong","农":"nong","侬":"nong","奴":"nu","努":"nu","怒":"nu","呶":"nu","帑":"nu","弩":"nu","胬":"nu","孥":"nu","驽":"nu","女":"nv","恧":"nv","钕":"nv","衄":"nv","暖":"nuan","虐":"nuenue","疟":"nue","谑":"nue","挪":"nuo","懦":"nuo","糯":"nuo","诺":"nuo","傩":"nuo","搦":"nuo","喏":"nuo","锘":"nuo","哦":"ou","欧":"ou","鸥":"ou","殴":"ou","藕":"ou","呕":"ou","偶":"ou","沤":"ou","怄":"ou","瓯":"ou","耦":"ou","啪":"pa","趴":"pa","爬":"pa","帕":"pa","怕":"pa","琶":"pa","葩":"pa","筢":"pa","拍":"pai","排":"pai","牌":"pai","徘":"pai","湃":"pai","派":"pai","俳":"pai","蒎":"pai","攀":"pan","潘":"pan","盘":"pan","磐":"pan","盼":"pan","畔":"pan","判":"pan","叛":"pan","爿":"pan","泮":"pan","袢":"pan","襻":"pan","蟠":"pan","蹒":"pan","乓":"pang",
"庞":"pang","旁":"pang","耪":"pang","胖":"pang","滂":"pang","逄":"pang","抛":"pao","咆":"pao","刨":"pao","炮":"pao","袍":"pao","跑":"pao","泡":"pao","匏":"pao","狍":"pao","庖":"pao","脬":"pao","疱":"pao","呸":"pei","胚":"pei","培":"pei","裴":"pei","赔":"pei","陪":"pei","配":"pei","佩":"pei","沛":"pei","掊":"pei","辔":"pei","帔":"pei","淠":"pei","旆":"pei","锫":"pei","醅":"pei","霈":"pei","喷":"pen","盆":"pen","湓":"pen","砰":"peng","抨":"peng","烹":"peng","澎":"peng","彭":"peng","蓬":"peng","棚":"peng","硼":"peng","篷":"peng","膨":"peng","朋":"peng","鹏":"peng","捧":"peng","碰":"peng","坯":"peng","堋":"peng","嘭":"peng","怦":"peng","蟛":"peng","砒":"pi","霹":"pi","批":"pi","披":"pi","劈":"pi","琵":"pi","毗":"pi","啤":"pi","脾":"pi","疲":"pi","皮":"pi","匹":"pi","痞":"pi","僻":"pi","屁":"pi","譬":"pi","丕":"pi","陴":"pi","邳":"pi","郫":"pi","圮":"pi","鼙":"pi","擗":"pi","噼":"pi","庀":"pi","媲":"pi","纰":"pi","枇":"pi","甓":"pi","睥":"pi","罴":"pi","铍":"pi","痦":"pi","癖":"pi","疋":"pi","蚍":"pi","貔":"pi","篇":"pian","偏":"pian","片":"pian","骗":"pian","谝":"pian","骈":"pian",
"犏":"pian","胼":"pian","褊":"pian","翩":"pian","蹁":"pian","飘":"piao","漂":"piao","瓢":"piao","票":"piao","剽":"piao","嘌":"piao","嫖":"piao","缥":"piao","殍":"piao","瞟":"piao","螵":"piao","撇":"pie","瞥":"pie","丿":"pie","苤":"pie","氕":"pie","拼":"pin","频":"pin","贫":"pin","品":"pin","聘":"pin","拚":"pin","姘":"pin","嫔":"pin","榀":"pin","牝":"pin","颦":"pin","乒":"ping","坪":"ping","苹":"ping","萍":"ping","平":"ping","凭":"ping","瓶":"ping","评":"ping","屏":"ping","俜":"ping","娉":"ping","枰":"ping","鲆":"ping","坡":"po","泼":"po","颇":"po","婆":"po","破":"po","魄":"po","迫":"po","粕":"po","叵":"po","鄱":"po","溥":"po","珀":"po","钋":"po","钷":"po","皤":"po","笸":"po","剖":"pou","裒":"pou","踣":"pou","扑":"pu","铺":"pu","仆":"pu","莆":"pu","葡":"pu","菩":"pu","蒲":"pu","埔":"pu","朴":"pu","圃":"pu","普":"pu","浦":"pu","谱":"pu","曝":"pu","瀑":"pu","匍":"pu","噗":"pu","濮":"pu","璞":"pu","氆":"pu","镤":"pu","镨":"pu","蹼":"pu","期":"qi","欺":"qi","栖":"qi","戚":"qi","妻":"qi","七":"qi","凄":"qi","漆":"qi","柒":"qi","沏":"qi","其":"qi","棋":"qi","奇":"qi","歧":"qi","畦":"qi",
"崎":"qi","脐":"qi","齐":"qi","旗":"qi","祈":"qi","祁":"qi","骑":"qi","起":"qi","岂":"qi","乞":"qi","企":"qi","启":"qi","契":"qi","砌":"qi","器":"qi","气":"qi","迄":"qi","弃":"qi","汽":"qi","泣":"qi","讫":"qi","亟":"qi","亓":"qi","圻":"qi","芑":"qi","萋":"qi","葺":"qi","嘁":"qi","屺":"qi","岐":"qi","汔":"qi","淇":"qi","骐":"qi","绮":"qi","琪":"qi","琦":"qi","杞":"qi","桤":"qi","槭":"qi","欹":"qi","祺":"qi","憩":"qi","碛":"qi","蛴":"qi","蜞":"qi","綦":"qi","綮":"qi","趿":"qi","蹊":"qi","鳍":"qi","麒":"qi","掐":"qia","恰":"qia","洽":"qia","葜":"qia","牵":"qian","扦":"qian","钎":"qian","铅":"qian","千":"qian","迁":"qian","签":"qian","仟":"qian","谦":"qian","乾":"qian","黔":"qian","钱":"qian","钳":"qian","前":"qian","潜":"qian","遣":"qian","浅":"qian","谴":"qian","堑":"qian","嵌":"qian","欠":"qian","歉":"qian","佥":"qian","阡":"qian","芊":"qian","芡":"qian","荨":"qian","掮":"qian","岍":"qian","悭":"qian","慊":"qian","骞":"qian","搴":"qian","褰":"qian","缱":"qian","椠":"qian","肷":"qian","愆":"qian","钤":"qian","虔":"qian","箝":"qian","枪":"qiang","呛":"qiang","腔":"qiang","羌":"qiang",
"墙":"qiang","蔷":"qiang","强":"qiang","抢":"qiang","嫱":"qiang","樯":"qiang","戗":"qiang","炝":"qiang","锖":"qiang","锵":"qiang","镪":"qiang","襁":"qiang","蜣":"qiang","羟":"qiang","跫":"qiang","跄":"qiang","橇":"qiao","锹":"qiao","敲":"qiao","悄":"qiao","桥":"qiao","瞧":"qiao","乔":"qiao","侨":"qiao","巧":"qiao","鞘":"qiao","撬":"qiao","翘":"qiao","峭":"qiao","俏":"qiao","窍":"qiao","劁":"qiao","诮":"qiao","谯":"qiao","荞":"qiao","愀":"qiao","憔":"qiao","缲":"qiao","樵":"qiao","毳":"qiao","硗":"qiao","跷":"qiao","鞒":"qiao","切":"qie","茄":"qie","且":"qie","怯":"qie","窃":"qie","郄":"qie","唼":"qie","惬":"qie","妾":"qie","挈":"qie","锲":"qie","箧":"qie","钦":"qin","侵":"qin","亲":"qin","秦":"qin","琴":"qin","勤":"qin","芹":"qin","擒":"qin","禽":"qin","寝":"qin","沁":"qin","芩":"qin","蓁":"qin","蕲":"qin","揿":"qin","吣":"qin","嗪":"qin","噙":"qin","溱":"qin","檎":"qin","螓":"qin","衾":"qin","青":"qing","轻":"qing","氢":"qing","倾":"qing","卿":"qing","清":"qing","擎":"qing","晴":"qing","氰":"qing","情":"qing","顷":"qing","请":"qing","庆":"qing","倩":"qing","苘":"qing",
"圊":"qing","檠":"qing","磬":"qing","蜻":"qing","罄":"qing","箐":"qing","謦":"qing","鲭":"qing","黥":"qing","琼":"qiong","穷":"qiong","邛":"qiong","茕":"qiong","穹":"qiong","筇":"qiong","銎":"qiong","秋":"qiu","丘":"qiu","邱":"qiu","球":"qiu","求":"qiu","囚":"qiu","酋":"qiu","泅":"qiu","俅":"qiu","氽":"qiu","巯":"qiu","艽":"qiu","犰":"qiu","湫":"qiu","逑":"qiu","遒":"qiu","楸":"qiu","赇":"qiu","鸠":"qiu","虬":"qiu","蚯":"qiu","蝤":"qiu","裘":"qiu","糗":"qiu","鳅":"qiu","鼽":"qiu","趋":"qu","区":"qu","蛆":"qu","曲":"qu","躯":"qu","屈":"qu","驱":"qu","渠":"qu","取":"qu","娶":"qu","龋":"qu","趣":"qu","去":"qu","诎":"qu","劬":"qu","蕖":"qu","蘧":"qu","岖":"qu","衢":"qu","阒":"qu","璩":"qu","觑":"qu","氍":"qu","祛":"qu","磲":"qu","癯":"qu","蛐":"qu","蠼":"qu","麴":"qu","瞿":"qu","黢":"qu","圈":"quan","颧":"quan","权":"quan","醛":"quan","泉":"quan","全":"quan","痊":"quan","拳":"quan","犬":"quan","券":"quan","劝":"quan","诠":"quan","荃":"quan","獾":"quan","悛":"quan","绻":"quan","辁":"quan","畎":"quan","铨":"quan","蜷":"quan","筌":"quan","鬈":"quan","缺":"que","炔":"que","瘸":"que",
"却":"que","鹊":"que","榷":"que","确":"que","雀":"que","阙":"que","悫":"que","裙":"qun","群":"qun","逡":"qun","然":"ran","燃":"ran","冉":"ran","染":"ran","苒":"ran","髯":"ran","瓤":"rang","壤":"rang","攘":"rang","嚷":"rang","让":"rang","禳":"rang","穰":"rang","饶":"rao","扰":"rao","绕":"rao","荛":"rao","娆":"rao","桡":"rao","惹":"ruo","若":"ruo","弱":"ruo","热":"re","偌":"re","壬":"ren","仁":"ren","人":"ren","忍":"ren","韧":"ren","任":"ren","认":"ren","刃":"ren","妊":"ren","纫":"ren","仞":"ren","荏":"ren","葚":"ren","饪":"ren","轫":"ren","稔":"ren","衽":"ren","扔":"reng","仍":"reng","日":"ri","戎":"rong","茸":"rong","蓉":"rong","荣":"rong","融":"rong","熔":"rong","溶":"rong","容":"rong","绒":"rong","冗":"rong","嵘":"rong","狨":"rong","缛":"rong","榕":"rong","蝾":"rong","揉":"rou","柔":"rou","肉":"rou","糅":"rou","蹂":"rou","鞣":"rou","茹":"ru","蠕":"ru","儒":"ru","孺":"ru","如":"ru","辱":"ru","乳":"ru","汝":"ru","入":"ru","褥":"ru","蓐":"ru","薷":"ru","嚅":"ru","洳":"ru","溽":"ru","濡":"ru","铷":"ru","襦":"ru","颥":"ru","软":"ruan","阮":"ruan","朊":"ruan","蕊":"rui","瑞":"rui",
"锐":"rui","芮":"rui","蕤":"rui","睿":"rui","蚋":"rui","闰":"run","润":"run","撒":"sa","洒":"sa","萨":"sa","卅":"sa","仨":"sa","挲":"sa","飒":"sa","腮":"sai","鳃":"sai","塞":"sai","赛":"sai","噻":"sai","三":"san","叁":"san","伞":"san","散":"san","彡":"san","馓":"san","氵":"san","毵":"san","糁":"san","霰":"san","桑":"sang","嗓":"sang","丧":"sang","搡":"sang","磉":"sang","颡":"sang","搔":"sao","骚":"sao","扫":"sao","嫂":"sao","埽":"sao","臊":"sao","瘙":"sao","鳋":"sao","瑟":"se","色":"se","涩":"se","啬":"se","铩":"se","铯":"se","穑":"se","森":"sen","僧":"seng","莎":"sha","砂":"sha","杀":"sha","刹":"sha","沙":"sha","纱":"sha","傻":"sha","啥":"sha","煞":"sha","脎":"sha","歃":"sha","痧":"sha","裟":"sha","霎":"sha","鲨":"sha","筛":"shai","晒":"shai","酾":"shai","珊":"shan","苫":"shan","杉":"shan","山":"shan","删":"shan","煽":"shan","衫":"shan","闪":"shan","陕":"shan","擅":"shan","赡":"shan","膳":"shan","善":"shan","汕":"shan","扇":"shan","缮":"shan","剡":"shan","讪":"shan","鄯":"shan","埏":"shan","芟":"shan","潸":"shan","姗":"shan","骟":"shan","膻":"shan","钐":"shan","疝":"shan",
"蟮":"shan","舢":"shan","跚":"shan","鳝":"shan","墒":"shang","伤":"shang","商":"shang","赏":"shang","晌":"shang","上":"shang","尚":"shang","裳":"shang","垧":"shang","绱":"shang","殇":"shang","熵":"shang","觞":"shang","梢":"shao","捎":"shao","稍":"shao","烧":"shao","芍":"shao","勺":"shao","韶":"shao","少":"shao","哨":"shao","邵":"shao","绍":"shao","劭":"shao","苕":"shao","潲":"shao","蛸":"shao","笤":"shao","筲":"shao","艄":"shao","奢":"she","赊":"she","蛇":"she","舌":"she","舍":"she","赦":"she","摄":"she","射":"she","慑":"she","涉":"she","社":"she","设":"she","厍":"she","佘":"she","猞":"she","畲":"she","麝":"she","砷":"shen","申":"shen","呻":"shen","伸":"shen","身":"shen","深":"shen","娠":"shen","绅":"shen","神":"shen","沈":"shen","审":"shen","婶":"shen","甚":"shen","肾":"shen","慎":"shen","渗":"shen","诜":"shen","谂":"shen","吲":"shen","哂":"shen","渖":"shen","椹":"shen","矧":"shen","蜃":"shen","声":"sheng","生":"sheng","甥":"sheng","牲":"sheng","升":"sheng","绳":"sheng","省":"sheng","盛":"sheng","剩":"sheng","胜":"sheng","圣":"sheng","丞":"sheng","渑":"sheng","媵":"sheng",
"眚":"sheng","笙":"sheng","师":"shi","失":"shi","狮":"shi","施":"shi","湿":"shi","诗":"shi","尸":"shi","虱":"shi","十":"shi","石":"shi","拾":"shi","时":"shi","什":"shi","食":"shi","蚀":"shi","实":"shi","识":"shi","史":"shi","矢":"shi","使":"shi","屎":"shi","驶":"shi","始":"shi","式":"shi","示":"shi","士":"shi","世":"shi","柿":"shi","事":"shi","拭":"shi","誓":"shi","逝":"shi","势":"shi","是":"shi","嗜":"shi","噬":"shi","适":"shi","仕":"shi","侍":"shi","释":"shi","饰":"shi","氏":"shi","市":"shi","恃":"shi","室":"shi","视":"shi","试":"shi","谥":"shi","埘":"shi","莳":"shi","蓍":"shi","弑":"shi","唑":"shi","饣":"shi","轼":"shi","耆":"shi","贳":"shi","炻":"shi","礻":"shi","铈":"shi","铊":"shi","螫":"shi","舐":"shi","筮":"shi","豕":"shi","鲥":"shi","鲺":"shi","收":"shou","手":"shou","首":"shou","守":"shou","寿":"shou","授":"shou","售":"shou","受":"shou","瘦":"shou","兽":"shou","扌":"shou","狩":"shou","绶":"shou","艏":"shou","蔬":"shu","枢":"shu","梳":"shu","殊":"shu","抒":"shu","输":"shu","叔":"shu","舒":"shu","淑":"shu","疏":"shu","书":"shu","赎":"shu","孰":"shu","熟":"shu","薯":"shu",
"暑":"shu","曙":"shu","署":"shu","蜀":"shu","黍":"shu","鼠":"shu","属":"shu","术":"shu","述":"shu","树":"shu","束":"shu","戍":"shu","竖":"shu","墅":"shu","庶":"shu","数":"shu","漱":"shu","恕":"shu","倏":"shu","塾":"shu","菽":"shu","忄":"shu","沭":"shu","涑":"shu","澍":"shu","姝":"shu","纾":"shu","毹":"shu","腧":"shu","殳":"shu","镯":"shu","秫":"shu","鹬":"shu","刷":"shua","耍":"shua","唰":"shua","涮":"shua","摔":"shuai","衰":"shuai","甩":"shuai","帅":"shuai","蟀":"shuai","栓":"shuan","拴":"shuan","闩":"shuan","霜":"shuang","双":"shuang","爽":"shuang","孀":"shuang","谁":"shui","水":"shui","睡":"shui","税":"shui","吮":"shun","瞬":"shun","顺":"shun","舜":"shun","恂":"shun","说":"shuo","硕":"shuo","朔":"shuo","烁":"shuo","蒴":"shuo","搠":"shuo","嗍":"shuo","濯":"shuo","妁":"shuo","槊":"shuo","铄":"shuo","斯":"si","撕":"si","嘶":"si","思":"si","私":"si","司":"si","丝":"si","死":"si","肆":"si","寺":"si","嗣":"si","四":"si","伺":"si","似":"si","饲":"si","巳":"si","厮":"si","俟":"si","兕":"si","菥":"si","咝":"si","汜":"si","泗":"si","澌":"si","姒":"si","驷":"si","缌":"si","祀":"si",
"祠":"si","锶":"si","鸶":"si","耜":"si","蛳":"si","笥":"si","松":"song","耸":"song","怂":"song","颂":"song","送":"song","宋":"song","讼":"song","诵":"song","凇":"song","菘":"song","崧":"song","嵩":"song","忪":"song","悚":"song","淞":"song","竦":"song","搜":"sou","艘":"sou","擞":"sou","嗽":"sou","叟":"sou","嗖":"sou","嗾":"sou","馊":"sou","溲":"sou","飕":"sou","瞍":"sou","锼":"sou","螋":"sou","苏":"su","酥":"su","俗":"su","素":"su","速":"su","粟":"su","僳":"su","塑":"su","溯":"su","宿":"su","诉":"su","肃":"su","夙":"su","谡":"su","蔌":"su","嗉":"su","愫":"su","簌":"su","觫":"su","稣":"su","酸":"suan","蒜":"suan","算":"suan","虽":"sui","隋":"sui","随":"sui","绥":"sui","髓":"sui","碎":"sui","岁":"sui","穗":"sui","遂":"sui","隧":"sui","祟":"sui","蓑":"sui","冫":"sui","谇":"sui","濉":"sui","邃":"sui","燧":"sui","眭":"sui","睢":"sui","孙":"sun","损":"sun","笋":"sun","荪":"sun","狲":"sun","飧":"sun","榫":"sun","跣":"sun","隼":"sun","梭":"suo","唆":"suo","缩":"suo","琐":"suo","索":"suo","锁":"suo","所":"suo","唢":"suo","嗦":"suo","娑":"suo","桫":"suo","睃":"suo","羧":"suo","塌":"ta",
"他":"ta","它":"ta","她":"ta","塔":"ta","獭":"ta","挞":"ta","蹋":"ta","踏":"ta","闼":"ta","溻":"ta","遢":"ta","榻":"ta","沓":"ta","胎":"tai","苔":"tai","抬":"tai","台":"tai","泰":"tai","酞":"tai","太":"tai","态":"tai","汰":"tai","邰":"tai","薹":"tai","肽":"tai","炱":"tai","钛":"tai","跆":"tai","鲐":"tai","坍":"tan","摊":"tan","贪":"tan","瘫":"tan","滩":"tan","坛":"tan","檀":"tan","痰":"tan","潭":"tan","谭":"tan","谈":"tan","坦":"tan","毯":"tan","袒":"tan","碳":"tan","探":"tan","叹":"tan","炭":"tan","郯":"tan","蕈":"tan","昙":"tan","钽":"tan","锬":"tan","覃":"tan","汤":"tang","塘":"tang","搪":"tang","堂":"tang","棠":"tang","膛":"tang","唐":"tang","糖":"tang","傥":"tang","饧":"tang","溏":"tang","瑭":"tang","铴":"tang","镗":"tang","耥":"tang","螗":"tang","螳":"tang","羰":"tang","醣":"tang","倘":"thang","躺":"thang","淌":"thang","趟":"theng","烫":"theng","掏":"tao","涛":"tao","滔":"tao","绦":"tao","萄":"tao","桃":"tao","逃":"tao","淘":"tao","陶":"tao","讨":"tao","套":"tao","挑":"tao","鼗":"tao","啕":"tao","韬":"tao","饕":"tao","特":"te","藤":"teng","腾":"teng","疼":"teng","誊":"teng",
"滕":"teng","梯":"ti","剔":"ti","踢":"ti","锑":"ti","提":"ti","题":"ti","蹄":"ti","啼":"ti","体":"ti","替":"ti","嚏":"ti","惕":"ti","涕":"ti","剃":"ti","屉":"ti","荑":"ti","悌":"ti","逖":"ti","绨":"ti","缇":"ti","鹈":"ti","裼":"ti","醍":"ti","天":"tian","添":"tian","填":"tian","田":"tian","甜":"tian","恬":"tian","舔":"tian","腆":"tian","掭":"tian","忝":"tian","阗":"tian","殄":"tian","畋":"tian","钿":"tian","蚺":"tian","条":"tiao","迢":"tiao","眺":"tiao","跳":"tiao","佻":"tiao","祧":"tiao","铫":"tiao","窕":"tiao","龆":"tiao","鲦":"tiao","贴":"tie","铁":"tie","帖":"tie","萜":"tie","餮":"tie","厅":"ting","听":"ting","烃":"ting","汀":"ting","廷":"ting","停":"ting","亭":"ting","庭":"ting","挺":"ting","艇":"ting","莛":"ting","葶":"ting","婷":"ting","梃":"ting","蜓":"ting","霆":"ting","通":"tong","桐":"tong","酮":"tong","瞳":"tong","同":"tong","铜":"tong","彤":"tong","童":"tong","桶":"tong","捅":"tong","筒":"tong","统":"tong","痛":"tong","佟":"tong","僮":"tong","仝":"tong","茼":"tong","嗵":"tong","恸":"tong","潼":"tong","砼":"tong","偷":"tou","投":"tou","头":"tou","透":"tou","亠":"tou",
"凸":"tu","秃":"tu","突":"tu","图":"tu","徒":"tu","途":"tu","涂":"tu","屠":"tu","土":"tu","吐":"tu","兔":"tu","堍":"tu","荼":"tu","菟":"tu","钍":"tu","酴":"tu","湍":"tuan","团":"tuan","疃":"tuan","推":"tui","颓":"tui","腿":"tui","蜕":"tui","褪":"tui","退":"tui","忒":"tui","煺":"tui","吞":"tun","屯":"tun","臀":"tun","饨":"tun","暾":"tun","豚":"tun","窀":"tun","拖":"tuo","托":"tuo","脱":"tuo","鸵":"tuo","陀":"tuo","驮":"tuo","驼":"tuo","椭":"tuo","妥":"tuo","拓":"tuo","唾":"tuo","乇":"tuo","佗":"tuo","坨":"tuo","庹":"tuo","沱":"tuo","柝":"tuo","砣":"tuo","箨":"tuo","舄":"tuo","跎":"tuo","鼍":"tuo","挖":"wa","哇":"wa","蛙":"wa","洼":"wa","娃":"wa","瓦":"wa","袜":"wa","佤":"wa","娲":"wa","腽":"wa","歪":"wai","外":"wai","豌":"wan","弯":"wan","湾":"wan","玩":"wan","顽":"wan","丸":"wan","烷":"wan","完":"wan","碗":"wan","挽":"wan","晚":"wan","皖":"wan","惋":"wan","宛":"wan","婉":"wan","万":"wan","腕":"wan","剜":"wan","芄":"wan","苋":"wan","菀":"wan","纨":"wan","绾":"wan","琬":"wan","脘":"wan","畹":"wan","蜿":"wan","箢":"wan","汪":"wang","王":"wang","亡":"wang","枉":"wang","网":"wang",
"往":"wang","旺":"wang","望":"wang","忘":"wang","妄":"wang","罔":"wang","尢":"wang","惘":"wang","辋":"wang","魍":"wang","威":"wei","巍":"wei","微":"wei","危":"wei","韦":"wei","违":"wei","桅":"wei","围":"wei","唯":"wei","惟":"wei","为":"wei","潍":"wei","维":"wei","苇":"wei","萎":"wei","委":"wei","伟":"wei","伪":"wei","尾":"wei","纬":"wei","未":"wei","蔚":"wei","味":"wei","畏":"wei","胃":"wei","喂":"wei","魏":"wei","位":"wei","渭":"wei","谓":"wei","尉":"wei","慰":"wei","卫":"wei","倭":"wei","偎":"wei","诿":"wei","隈":"wei","葳":"wei","薇":"wei","帏":"wei","帷":"wei","崴":"wei","嵬":"wei","猥":"wei","猬":"wei","闱":"wei","沩":"wei","洧":"wei","涠":"wei","逶":"wei","娓":"wei","玮":"wei","韪":"wei","軎":"wei","炜":"wei","煨":"wei","熨":"wei","痿":"wei","艉":"wei","鲔":"wei","瘟":"wen","温":"wen","蚊":"wen","文":"wen","闻":"wen","纹":"wen","吻":"wen","稳":"wen","紊":"wen","问":"wen","刎":"wen","愠":"wen","阌":"wen","汶":"wen","璺":"wen","韫":"wen","殁":"wen","雯":"wen","嗡":"weng","翁":"weng","瓮":"weng","蓊":"weng","蕹":"weng","挝":"wo","蜗":"wo","涡":"wo","窝":"wo","我":"wo","斡":"wo",
"卧":"wo","握":"wo","沃":"wo","莴":"wo","幄":"wo","渥":"wo","杌":"wo","肟":"wo","龌":"wo","巫":"wu","呜":"wu","钨":"wu","乌":"wu","污":"wu","诬":"wu","屋":"wu","无":"wu","芜":"wu","梧":"wu","吾":"wu","吴":"wu","毋":"wu","武":"wu","五":"wu","捂":"wu","午":"wu","舞":"wu","伍":"wu","侮":"wu","坞":"wu","戊":"wu","雾":"wu","晤":"wu","物":"wu","勿":"wu","务":"wu","悟":"wu","误":"wu","兀":"wu","仵":"wu","阢":"wu","邬":"wu","圬":"wu","芴":"wu","庑":"wu","怃":"wu","忤":"wu","浯":"wu","寤":"wu","迕":"wu","妩":"wu","骛":"wu","牾":"wu","焐":"wu","鹉":"wu","鹜":"wu","蜈":"wu","鋈":"wu","鼯":"wu","昔":"xi","熙":"xi","析":"xi","西":"xi","硒":"xi","矽":"xi","晰":"xi","嘻":"xi","吸":"xi","锡":"xi","牺":"xi","稀":"xi","息":"xi","希":"xi","悉":"xi","膝":"xi","夕":"xi","惜":"xi","熄":"xi","烯":"xi","溪":"xi","汐":"xi","犀":"xi","檄":"xi","袭":"xi","席":"xi","习":"xi","媳":"xi","喜":"xi","铣":"xi","洗":"xi","系":"xi","隙":"xi","戏":"xi","细":"xi","僖":"xi","兮":"xi","隰":"xi","郗":"xi","茜":"xi","葸":"xi","蓰":"xi","奚":"xi","唏":"xi","徙":"xi","饩":"xi","阋":"xi","浠":"xi","淅":"xi","屣":"xi","嬉":"xi","玺":"xi",
"樨":"xi","曦":"xi","觋":"xi","欷":"xi","熹":"xi","禊":"xi","禧":"xi","钸":"xi","皙":"xi","穸":"xi","蜥":"xi","蟋":"xi","舾":"xi","羲":"xi","粞":"xi","翕":"xi","醯":"xi","鼷":"xi","瞎":"xia","虾":"xia","匣":"xia","霞":"xia","辖":"xia","暇":"xia","峡":"xia","侠":"xia","狭":"xia","下":"xia","厦":"xia","夏":"xia","吓":"xia","掀":"xia","葭":"xia","嗄":"xia","狎":"xia","遐":"xia","瑕":"xia","硖":"xia","瘕":"xia","罅":"xia","黠":"xia","锨":"xian","先":"xian","仙":"xian","鲜":"xian","纤":"xian","咸":"xian","贤":"xian","衔":"xian","舷":"xian","闲":"xian","涎":"xian","弦":"xian","嫌":"xian","显":"xian","险":"xian","现":"xian","献":"xian","县":"xian","腺":"xian","馅":"xian","羡":"xian","宪":"xian","陷":"xian","限":"xian","线":"xian","冼":"xian","藓":"xian","岘":"xian","猃":"xian","暹":"xian","娴":"xian","氙":"xian","祆":"xian","鹇":"xian","痫":"xian","蚬":"xian","筅":"xian","籼":"xian","酰":"xian","跹":"xian","相":"xiang","厢":"xiang","镶":"xiang","香":"xiang","箱":"xiang","襄":"xiang","湘":"xiang","乡":"xiang","翔":"xiang","祥":"xiang","详":"xiang","想":"xiang","响":"xiang","享":"xiang",
"项":"xiang","巷":"xiang","橡":"xiang","像":"xiang","向":"xiang","象":"xiang","芗":"xiang","葙":"xiang","饷":"xiang","庠":"xiang","骧":"xiang","缃":"xiang","蟓":"xiang","鲞":"xiang","飨":"xiang","萧":"xiao","硝":"xiao","霄":"xiao","削":"xiao","哮":"xiao","嚣":"xiao","销":"xiao","消":"xiao","宵":"xiao","淆":"xiao","晓":"xiao","小":"xiao","孝":"xiao","校":"xiao","肖":"xiao","啸":"xiao","笑":"xiao","效":"xiao","哓":"xiao","咻":"xiao","崤":"xiao","潇":"xiao","逍":"xiao","骁":"xiao","绡":"xiao","枭":"xiao","枵":"xiao","筱":"xiao","箫":"xiao","魈":"xiao","楔":"xie","些":"xie","歇":"xie","蝎":"xie","鞋":"xie","协":"xie","挟":"xie","携":"xie","邪":"xie","斜":"xie","胁":"xie","谐":"xie","写":"xie","械":"xie","卸":"xie","蟹":"xie","懈":"xie","泄":"xie","泻":"xie","谢":"xie","屑":"xie","偕":"xie","亵":"xie","勰":"xie","燮":"xie","薤":"xie","撷":"xie","廨":"xie","瀣":"xie","邂":"xie","绁":"xie","缬":"xie","榭":"xie","榍":"xie","歙":"xie","躞":"xie","薪":"xin","芯":"xin","锌":"xin","欣":"xin","辛":"xin","新":"xin","忻":"xin","心":"xin","信":"xin","衅":"xin","囟":"xin","馨":"xin","莘":"xin",
"歆":"xin","铽":"xin","鑫":"xin","星":"xing","腥":"xing","猩":"xing","惺":"xing","兴":"xing","刑":"xing","型":"xing","形":"xing","邢":"xing","行":"xing","醒":"xing","幸":"xing","杏":"xing","性":"xing","姓":"xing","陉":"xing","荇":"xing","荥":"xing","擤":"xing","悻":"xing","硎":"xing","兄":"xiong","凶":"xiong","胸":"xiong","匈":"xiong","汹":"xiong","雄":"xiong","熊":"xiong","芎":"xiong","休":"xiu","修":"xiu","羞":"xiu","朽":"xiu","嗅":"xiu","锈":"xiu","秀":"xiu","袖":"xiu","绣":"xiu","莠":"xiu","岫":"xiu","馐":"xiu","庥":"xiu","鸺":"xiu","貅":"xiu","髹":"xiu","墟":"xu","戌":"xu","需":"xu","虚":"xu","嘘":"xu","须":"xu","徐":"xu","许":"xu","蓄":"xu","酗":"xu","叙":"xu","旭":"xu","序":"xu","畜":"xu","恤":"xu","絮":"xu","婿":"xu","绪":"xu","续":"xu","讴":"xu","诩":"xu","圩":"xu","蓿":"xu","怵":"xu","洫":"xu","溆":"xu","顼":"xu","栩":"xu","煦":"xu","砉":"xu","盱":"xu","胥":"xu","糈":"xu","醑":"xu","轩":"xuan","喧":"xuan","宣":"xuan","悬":"xuan","旋":"xuan","玄":"xuan","选":"xuan","癣":"xuan","眩":"xuan","绚":"xuan","儇":"xuan","谖":"xuan","萱":"xuan","揎":"xuan","馔":"xuan","泫":"xuan",
"洵":"xuan","渲":"xuan","漩":"xuan","璇":"xuan","楦":"xuan","暄":"xuan","炫":"xuan","煊":"xuan","碹":"xuan","铉":"xuan","镟":"xuan","痃":"xuan","靴":"xue","薛":"xue","学":"xue","穴":"xue","雪":"xue","血":"xue","噱":"xue","泶":"xue","鳕":"xue","勋":"xun","熏":"xun","循":"xun","旬":"xun","询":"xun","寻":"xun","驯":"xun","巡":"xun","殉":"xun","汛":"xun","训":"xun","讯":"xun","逊":"xun","迅":"xun","巽":"xun","埙":"xun","荀":"xun","薰":"xun","峋":"xun","徇":"xun","浔":"xun","曛":"xun","窨":"xun","醺":"xun","鲟":"xun","压":"ya","押":"ya","鸦":"ya","鸭":"ya","呀":"ya","丫":"ya","芽":"ya","牙":"ya","蚜":"ya","崖":"ya","衙":"ya","涯":"ya","雅":"ya","哑":"ya","亚":"ya","讶":"ya","伢":"ya","揠":"ya","吖":"ya","岈":"ya","迓":"ya","娅":"ya","琊":"ya","桠":"ya","氩":"ya","砑":"ya","睚":"ya","痖":"ya","焉":"yan","咽":"yan","阉":"yan","烟":"yan","淹":"yan","盐":"yan","严":"yan","研":"yan","蜒":"yan","岩":"yan","延":"yan","言":"yan","颜":"yan","阎":"yan","炎":"yan","沿":"yan","奄":"yan","掩":"yan","眼":"yan","衍":"yan","演":"yan","艳":"yan","堰":"yan","燕":"yan","厌":"yan","砚":"yan","雁":"yan",
"唁":"yan","彦":"yan","焰":"yan","宴":"yan","谚":"yan","验":"yan","厣":"yan","靥":"yan","赝":"yan","俨":"yan","偃":"yan","兖":"yan","讠":"yan","谳":"yan","郾":"yan","鄢":"yan","芫":"yan","菸":"yan","崦":"yan","恹":"yan","闫":"yan","阏":"yan","洇":"yan","湮":"yan","滟":"yan","妍":"yan","嫣":"yan","琰":"yan","晏":"yan","胭":"yan","腌":"yan","焱":"yan","罨":"yan","筵":"yan","酽":"yan","魇":"yan","餍":"yan","鼹":"yan","殃":"yang","央":"yang","鸯":"yang","秧":"yang","杨":"yang","扬":"yang","佯":"yang","疡":"yang","羊":"yang","洋":"yang","阳":"yang","氧":"yang","仰":"yang","痒":"yang","养":"yang","样":"yang","漾":"yang","徉":"yang","怏":"yang","泱":"yang","炀":"yang","烊":"yang","恙":"yang","蛘":"yang","鞅":"yang","邀":"yao","腰":"yao","妖":"yao","瑶":"yao","摇":"yao","尧":"yao","遥":"yao","窑":"yao","谣":"yao","姚":"yao","咬":"yao","舀":"yao","药":"yao","要":"yao","耀":"yao","夭":"yao","爻":"yao","吆":"yao","崾":"yao","徭":"yao","瀹":"yao","幺":"yao","珧":"yao","杳":"yao","曜":"yao","肴":"yao","鹞":"yao","窈":"yao","繇":"yao","鳐":"yao","椰":"ye","噎":"ye","耶":"ye","爷":"ye","野":"ye",
"冶":"ye","也":"ye","页":"ye","掖":"ye","业":"ye","叶":"ye","曳":"ye","腋":"ye","夜":"ye","液":"ye","谒":"ye","邺":"ye","揶":"ye","馀":"ye","晔":"ye","烨":"ye","铘":"ye","一":"yi","壹":"yi","医":"yi","揖":"yi","铱":"yi","依":"yi","伊":"yi","衣":"yi","颐":"yi","夷":"yi","遗":"yi","移":"yi","仪":"yi","胰":"yi","疑":"yi","沂":"yi","宜":"yi","姨":"yi","彝":"yi","椅":"yi","蚁":"yi","倚":"yi","已":"yi","乙":"yi","矣":"yi","以":"yi","艺":"yi","抑":"yi","易":"yi","邑":"yi","屹":"yi","亿":"yi","役":"yi","臆":"yi","逸":"yi","肄":"yi","疫":"yi","亦":"yi","裔":"yi","意":"yi","毅":"yi","忆":"yi","义":"yi","益":"yi","溢":"yi","诣":"yi","议":"yi","谊":"yi","译":"yi","异":"yi","翼":"yi","翌":"yi","绎":"yi","刈":"yi","劓":"yi","佾":"yi","诒":"yi","圪":"yi","圯":"yi","埸":"yi","懿":"yi","苡":"yi","薏":"yi","弈":"yi","奕":"yi","挹":"yi","弋":"yi","呓":"yi","咦":"yi","咿":"yi","噫":"yi","峄":"yi","嶷":"yi","猗":"yi","饴":"yi","怿":"yi","怡":"yi","悒":"yi","漪":"yi","迤":"yi","驿":"yi","缢":"yi","殪":"yi","贻":"yi","旖":"yi","熠":"yi","钇":"yi","镒":"yi","镱":"yi","痍":"yi","瘗":"yi","癔":"yi","翊":"yi","衤":"yi",
"蜴":"yi","舣":"yi","羿":"yi","翳":"yi","酏":"yi","黟":"yi","茵":"yin","荫":"yin","因":"yin","殷":"yin","音":"yin","阴":"yin","姻":"yin","吟":"yin","银":"yin","淫":"yin","寅":"yin","饮":"yin","尹":"yin","引":"yin","隐":"yin","印":"yin","胤":"yin","鄞":"yin","堙":"yin","茚":"yin","喑":"yin","狺":"yin","夤":"yin","氤":"yin","铟":"yin","瘾":"yin","蚓":"yin","霪":"yin","龈":"yin","英":"ying","樱":"ying","婴":"ying","鹰":"ying","应":"ying","缨":"ying","莹":"ying","萤":"ying","营":"ying","荧":"ying","蝇":"ying","迎":"ying","赢":"ying","盈":"ying","影":"ying","颖":"ying","硬":"ying","映":"ying","嬴":"ying","郢":"ying","茔":"ying","莺":"ying","萦":"ying","撄":"ying","嘤":"ying","膺":"ying","滢":"ying","潆":"ying","瀛":"ying","瑛":"ying","璎":"ying","楹":"ying","鹦":"ying","瘿":"ying","颍":"ying","罂":"ying","哟":"yo","唷":"yo","拥":"yong","佣":"yong","臃":"yong","痈":"yong","庸":"yong","雍":"yong","踊":"yong","蛹":"yong","咏":"yong","泳":"yong","涌":"yong","永":"yong","恿":"yong","勇":"yong","用":"yong","俑":"yong","壅":"yong","墉":"yong","慵":"yong","邕":"yong","镛":"yong","甬":"yong",
"鳙":"yong","饔":"yong","幽":"you","优":"you","悠":"you","忧":"you","尤":"you","由":"you","邮":"you","铀":"you","犹":"you","油":"you","游":"you","酉":"you","有":"you","友":"you","右":"you","佑":"you","釉":"you","诱":"you","又":"you","幼":"you","卣":"you","攸":"you","侑":"you","莸":"you","呦":"you","囿":"you","宥":"you","柚":"you","猷":"you","牖":"you","铕":"you","疣":"you","蝣":"you","鱿":"you","黝":"you","鼬":"you","迂":"yu","淤":"yu","于":"yu","盂":"yu","榆":"yu","虞":"yu","愚":"yu","舆":"yu","余":"yu","俞":"yu","逾":"yu","鱼":"yu","愉":"yu","渝":"yu","渔":"yu","隅":"yu","予":"yu","娱":"yu","雨":"yu","与":"yu","屿":"yu","禹":"yu","宇":"yu","语":"yu","羽":"yu","玉":"yu","域":"yu","芋":"yu","郁":"yu","吁":"yu","遇":"yu","喻":"yu","峪":"yu","御":"yu","愈":"yu","欲":"yu","狱":"yu","育":"yu","誉":"yu","浴":"yu","寓":"yu","裕":"yu","预":"yu","豫":"yu","驭":"yu","禺":"yu","毓":"yu","伛":"yu","俣":"yu","谀":"yu","谕":"yu","萸":"yu","蓣":"yu","揄":"yu","喁":"yu","圄":"yu","圉":"yu","嵛":"yu","狳":"yu","饫":"yu","庾":"yu","阈":"yu","妪":"yu","妤":"yu","纡":"yu","瑜":"yu","昱":"yu","觎":"yu",
"腴":"yu","欤":"yu","於":"yu","煜":"yu","燠":"yu","聿":"yu","钰":"yu","鹆":"yu","瘐":"yu","瘀":"yu","窳":"yu","蝓":"yu","竽":"yu","舁":"yu","雩":"yu","龉":"yu","鸳":"yuan","渊":"yuan","冤":"yuan","元":"yuan","垣":"yuan","袁":"yuan","原":"yuan","援":"yuan","辕":"yuan","园":"yuan","员":"yuan","圆":"yuan","猿":"yuan","源":"yuan","缘":"yuan","远":"yuan","苑":"yuan","愿":"yuan","怨":"yuan","院":"yuan","塬":"yuan","沅":"yuan","媛":"yuan","瑗":"yuan","橼":"yuan","爰":"yuan","眢":"yuan","鸢":"yuan","螈":"yuan","鼋":"yuan","曰":"yue","约":"yue","越":"yue","跃":"yue","钥":"yue","岳":"yue","粤":"yue","月":"yue","悦":"yue","阅":"yue","龠":"yue","樾":"yue","刖":"yue","钺":"yue","耘":"yun","云":"yun","郧":"yun","匀":"yun","陨":"yun","允":"yun","运":"yun","蕴":"yun","酝":"yun","晕":"yun","韵":"yun","孕":"yun","郓":"yun","芸":"yun","狁":"yun","恽":"yun","纭":"yun","殒":"yun","昀":"yun","氲":"yun","匝":"za","砸":"za","杂":"za","拶":"za","咂":"za","栽":"zai","哉":"zai","灾":"zai","宰":"zai","载":"zai","再":"zai","在":"zai","咱":"zai","崽":"zai","甾":"zai","攒":"zan","暂":"zan","赞":"zan","瓒":"zan",
"昝":"zan","簪":"zan","糌":"zan","趱":"zan","錾":"zan","赃":"zang","脏":"zang","葬":"zang","奘":"zang","戕":"zang","臧":"zang","遭":"zao","糟":"zao","凿":"zao","藻":"zao","枣":"zao","早":"zao","澡":"zao","蚤":"zao","躁":"zao","噪":"zao","造":"zao","皂":"zao","灶":"zao","燥":"zao","唣":"zao","缫":"zao","责":"ze","择":"ze","则":"ze","泽":"ze","仄":"ze","赜":"ze","啧":"ze","迮":"ze","昃":"ze","笮":"ze","箦":"ze","舴":"ze","贼":"zei","怎":"zen","谮":"zen","增":"zeng","憎":"zeng","曾":"zeng","赠":"zeng","缯":"zeng","甑":"zeng","罾":"zeng","锃":"zeng","扎":"zha","喳":"zha","渣":"zha","札":"zha","轧":"zha","铡":"zha","闸":"zha","眨":"zha","栅":"zha","榨":"zha","咋":"zha","乍":"zha","炸":"zha","诈":"zha","揸":"zha","吒":"zha","咤":"zha","哳":"zha","怍":"zha","砟":"zha","痄":"zha","蚱":"zha","齄":"zha","摘":"zhai","斋":"zhai","宅":"zhai","窄":"zhai","债":"zhai","寨":"zhai","砦":"zhai","瞻":"zhan","毡":"zhan","詹":"zhan","粘":"zhan","沾":"zhan","盏":"zhan","斩":"zhan","辗":"zhan","崭":"zhan","展":"zhan","蘸":"zhan","栈":"zhan","占":"zhan","战":"zhan","站":"zhan","湛":"zhan","绽":"zhan",
"谵":"zhan","搌":"zhan","旃":"zhan","樟":"zhang","章":"zhang","彰":"zhang","漳":"zhang","张":"zhang","掌":"zhang","涨":"zhang","杖":"zhang","丈":"zhang","帐":"zhang","账":"zhang","仗":"zhang","胀":"zhang","瘴":"zhang","障":"zhang","仉":"zhang","鄣":"zhang","幛":"zhang","嶂":"zhang","獐":"zhang","嫜":"zhang","璋":"zhang","蟑":"zhang","招":"zhao","昭":"zhao","找":"zhao","沼":"zhao","赵":"zhao","照":"zhao","罩":"zhao","兆":"zhao","肇":"zhao","召":"zhao","爪":"zhao","诏":"zhao","棹":"zhao","钊":"zhao","笊":"zhao","遮":"zhe","折":"zhe","哲":"zhe","蛰":"zhe","辙":"zhe","者":"zhe","锗":"zhe","蔗":"zhe","这":"zhe","浙":"zhe","谪":"zhe","陬":"zhe","柘":"zhe","辄":"zhe","磔":"zhe","鹧":"zhe","褚":"zhe","蜇":"zhe","赭":"zhe","珍":"zhen","斟":"zhen","真":"zhen","甄":"zhen","砧":"zhen","臻":"zhen","贞":"zhen","针":"zhen","侦":"zhen","枕":"zhen","疹":"zhen","诊":"zhen","震":"zhen","振":"zhen","镇":"zhen","阵":"zhen","缜":"zhen","桢":"zhen","榛":"zhen","轸":"zhen","赈":"zhen","胗":"zhen","朕":"zhen","祯":"zhen","畛":"zhen","鸩":"zhen","蒸":"zheng","挣":"zheng","睁":"zheng","征":"zheng",
"狰":"zheng","争":"zheng","怔":"zheng","整":"zheng","拯":"zheng","正":"zheng","政":"zheng","帧":"zheng","症":"zheng","郑":"zheng","证":"zheng","诤":"zheng","峥":"zheng","钲":"zheng","铮":"zheng","筝":"zheng","芝":"zhi","枝":"zhi","支":"zhi","吱":"zhi","蜘":"zhi","知":"zhi","肢":"zhi","脂":"zhi","汁":"zhi","之":"zhi","织":"zhi","职":"zhi","直":"zhi","植":"zhi","殖":"zhi","执":"zhi","值":"zhi","侄":"zhi","址":"zhi","指":"zhi","止":"zhi","趾":"zhi","只":"zhi","旨":"zhi","纸":"zhi","志":"zhi","挚":"zhi","掷":"zhi","至":"zhi","致":"zhi","置":"zhi","帜":"zhi","峙":"zhi","制":"zhi","智":"zhi","秩":"zhi","稚":"zhi","质":"zhi","炙":"zhi","痔":"zhi","滞":"zhi","治":"zhi","窒":"zhi","卮":"zhi","陟":"zhi","郅":"zhi","埴":"zhi","芷":"zhi","摭":"zhi","帙":"zhi","忮":"zhi","彘":"zhi","咫":"zhi","骘":"zhi","栉":"zhi","枳":"zhi","栀":"zhi","桎":"zhi","轵":"zhi","轾":"zhi","攴":"zhi","贽":"zhi","膣":"zhi","祉":"zhi","祗":"zhi","黹":"zhi","雉":"zhi","鸷":"zhi","痣":"zhi","蛭":"zhi","絷":"zhi","酯":"zhi","跖":"zhi","踬":"zhi","踯":"zhi","豸":"zhi","觯":"zhi","中":"zhong","盅":"zhong","忠":"zhong",
"钟":"zhong","衷":"zhong","终":"zhong","种":"zhong","肿":"zhong","重":"zhong","仲":"zhong","众":"zhong","冢":"zhong","锺":"zhong","螽":"zhong","舂":"zhong","舯":"zhong","踵":"zhong","舟":"zhou","周":"zhou","州":"zhou","洲":"zhou","诌":"zhou","粥":"zhou","轴":"zhou","肘":"zhou","帚":"zhou","咒":"zhou","皱":"zhou","宙":"zhou","昼":"zhou","骤":"zhou","啄":"zhou","着":"zhou","倜":"zhou","诹":"zhou","荮":"zhou","鬻":"zhou","纣":"zhou","胄":"zhou","碡":"zhou","籀":"zhou","舳":"zhou","酎":"zhou","鲷":"zhou","珠":"zhu","株":"zhu","蛛":"zhu","朱":"zhu","猪":"zhu","诸":"zhu","诛":"zhu","逐":"zhu","竹":"zhu","烛":"zhu","煮":"zhu","拄":"zhu","瞩":"zhu","嘱":"zhu","主":"zhu","著":"zhu","柱":"zhu","助":"zhu","蛀":"zhu","贮":"zhu","铸":"zhu","筑":"zhu","住":"zhu","注":"zhu","祝":"zhu","驻":"zhu","伫":"zhu","侏":"zhu","邾":"zhu","苎":"zhu","茱":"zhu","洙":"zhu","渚":"zhu","潴":"zhu","驺":"zhu","杼":"zhu","槠":"zhu","橥":"zhu","炷":"zhu","铢":"zhu","疰":"zhu","瘃":"zhu","蚰":"zhu","竺":"zhu","箸":"zhu","翥":"zhu","躅":"zhu","麈":"zhu","抓":"zhua","拽":"zhuai","专":"zhuan","砖":"zhuan",
"转":"zhuan","撰":"zhuan","赚":"zhuan","篆":"zhuan","抟":"zhuan","啭":"zhuan","颛":"zhuan","桩":"zhuang","庄":"zhuang","装":"zhuang","妆":"zhuang","撞":"zhuang","壮":"zhuang","状":"zhuang","丬":"zhuang","椎":"zhui","锥":"zhui","追":"zhui","赘":"zhui","坠":"zhui","缀":"zhui","萑":"zhui","骓":"zhui","缒":"zhui","谆":"zhun","准":"zhun","捉":"zhuo","拙":"zhuo","卓":"zhuo","桌":"zhuo","琢":"zhuo","茁":"zhuo","酌":"zhuo","灼":"zhuo","浊":"zhuo","倬":"zhuo","诼":"zhuo","廴":"zhuo","蕞":"zhuo","擢":"zhuo","啜":"zhuo","浞":"zhuo","涿":"zhuo","杓":"zhuo","焯":"zhuo","禚":"zhuo","斫":"zhuo","兹":"zi","咨":"zi","资":"zi","姿":"zi","滋":"zi","淄":"zi","孜":"zi","紫":"zi","仔":"zi","籽":"zi","滓":"zi","子":"zi","自":"zi","渍":"zi","字":"zi","谘":"zi","嵫":"zi","姊":"zi","孳":"zi","缁":"zi","梓":"zi","辎":"zi","赀":"zi","恣":"zi","眦":"zi","锱":"zi","秭":"zi","耔":"zi","笫":"zi","粢":"zi","觜":"zi","訾":"zi","鲻":"zi","髭":"zi","鬃":"zong","棕":"zong","踪":"zong","宗":"zong","综":"zong","总":"zong","纵":"zong","腙":"zong","粽":"zong","邹":"zou","走":"zou","奏":"zou","揍":"zou","鄹":"zou",
"鲰":"zou","租":"zu","足":"zu","卒":"zu","族":"zu","祖":"zu","诅":"zu","阻":"zu","组":"zu","俎":"zu","菹":"zu","啐":"zu","徂":"zu","驵":"zu","蹴":"zu","钻":"zuan","纂":"zuan","攥":"zuan","缵":"zuan","嘴":"zui","醉":"zui","最":"zui","罪":"zui","尊":"zun","遵":"zun","撙":"zun","樽":"zun","鳟":"zun","昨":"zuo","左":"zuo","佐":"zuo","柞":"zuo","做":"zuo","作":"zuo","坐":"zuo","座":"zuo","阝":"zuo","阼":"zuo","胙":"zuo","祚":"zuo","酢":"zuo","薮":"cou","楱":"cou","辏":"cou","腠":"cou","攮":"nang","哝":"nang","囔":"nang","馕":"nang","曩":"nang","喔":"o","嗲":"dia","嘬":"chuai","膪":"chuai","踹":"chuai","岑":"cen","涔":"cen","铥":"diu","耨":"nou","缶":"fou","髟":"bia"}}}(PJF.util),function(e){var r=function(){
/*@preserve
    <svg width="144" height="144" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="badge">
      <defs>
        <style type="text/css">
          <![CDATA[
            .badge-header, .badge-footer {
              letter-spacing: 2px;
            }
            .class1 {
              letter-spacing: 4px;
            }
            text {
              font-family: '仿宋';
              text-anchor: middle;
            }
          ]]>
        </style>
      </defs>
      <g>
        <title>background</title>
        <rect y="-1" x="-1" width="146" height="146" id="canvas_background" fill="none"/>
      </g>
      <g>
        <title>Layer 1</title>
        <circle stroke="#FF0000" stroke-width="2" class="circle" fill="#FFFFFF" cx="72" cy="72" r="70" id="svg_1"/>
        <path d="m45.5,117.9a53,53 0 1 1 53,0" id="SVGID_x5F_2_x5F_" fill="none" stroke="red" stroke-width="0"/>
        <text font-weight="bold" text-anchor="middle" id="svg_2">
          <textPath xlink:href="#SVGID_x5F_2_x5F_" startOffset="50%">
            <tspan class="badge-header" fill="#FF0000" font-family="'仿宋'" font-size="13" id="svg_3" stroke="null">中国建设银行股份有限公司</tspan>
          </textPath>
        </text>
      <text font-size="15" fill="#FF0000" x="72" y="109" id="svg_7" font-weight="bold">业务专用章</text>
      <text font-size="{{FstFontSize}}" fill="#FF0000" x="72" y="{{FstYCor}}" id="svg_4">{{FstVal}}</text>
      <text font-size="{{FstFontSize}}" fill="#FF0000" id="svg_5" y="{{SndYCor}}" x="72">{{SndVal}}</text>
      <text font-size="{{TrdFontSize}}" fill="#FF0000" x="72" y="{{TrdYCor}}" id="svg_6">{{TrdVal}}</text>
      </g>
    </svg>
  */}.toString().match(/^[\s\S]*\/\*@preserve([\s\S]*)\*\//)[1];e.simpleDownload=function(e,t,n){var i,o;PJF.communication.FileDownload.Add(e,t),PJF.event.onceSubscriber(PJF.PadClientEvents.download.completed,i=function(t){e.match(new RegExp(t+"$"))&&(PJF.event.removeSubscriber(PJF.PadClientEvents.download.failed,o),n({success:!0,fileName:t}))}),PJF.event.onceSubscriber(PJF.PadClientEvents.download.failed,o=function(t){e.match(new RegExp(t+"$"))&&(PJF.event.removeSubscriber(PJF.PadClientEvents.download.completed,i),n({success:!1,fileName:t}))})};var d=function(n,i){i=i||"svg";var o=document.createElement("canvas"),a=o.getContext("2d"),s=new Image;s.onload=function(){var t=144/s.width;if("svg"===i){var e=PJF.util.formatTpl(r,{FstYCor:parseInt(n.StmpFstBankPTYCordVal,10)*t+parseInt(n.StmpFstBankPtTxFmtDsc,10)*t,FstVal:n.StmpFstBankPrtTxCntnt,SndYCor:parseInt(n.StmpSndBankPTYCordVal,10)*t+parseInt(n.StmpFstBankPtTxFmtDsc,10)*t,SndVal:n.StmpSndBankPrtTxCntnt,TrdVal:n.ValiCd,
TrdYCor:parseInt(n.StmpTrdBankPTYCordVal,10)*t+parseInt(n.StmpTrdBankPtTxFmtDsc,10)*t,FstFontSize:parseInt(n.StmpFstBankPtTxFmtDsc,10)*t,TrdFontSize:parseInt(n.StmpTrdBankPtTxFmtDsc,10)*t});n.callback({height:"144",width:"144",svg:e,type:"svg"})}else"img"===i&&(s.width=s.width*t,s.height=s.height*t,o.height=s.width,o.width=s.height,a.drawImage(s,0,0,s.width,s.height),a.font=n.StmpFstBankPtTxFmtDsc*t+"px 宋体",a.fillStyle="#000000",a.textAlign="center",a.fillText(n.StmpFstBankPrtTxCntnt,o.width/2,parseInt(n.StmpFstBankPTYCordVal,10)*t+parseInt(n.StmpFstBankPtTxFmtDsc,10)*t),a.fillText(n.StmpSndBankPrtTxCntnt,o.width/2,parseInt(n.StmpSndBankPTYCordVal,10)*t+parseInt(n.StmpFstBankPtTxFmtDsc,10)*t),a.font=n.StmpTrdBankPtTxFmtDsc*t+"px 宋体",a.fillText(n.ValiCd,o.width/2,parseInt(n.StmpTrdBankPTYCordVal,10)*t+parseInt(n.StmpTrdBankPtTxFmtDsc,10)*t),n.callback({base64:o.toDataURL("image/png"),height:s.height,width:s.width,type:"img"}))},s.onerror=function(){n.callback()},
s.src="data:image/jpg;base64,"+n.sealBase64};e._composeSeal=d,e.getTransSeal=function(l){var u=function(t){l.callback({success:!1,errMsg:t})};PJF.roleInfo._elec_seal_switch?PJF.communication.cpsJsonReq({url:"ecpJson",fwServiceId:"simpleTransaction",fwTranId:"A0161M539",loadingText:"正在查询电子印章识别码",maskAll:!0,jsonData:JSON.stringify($.extend({Txn_Dt_Tm:PJF.communication.getServerTime("yyyyMMddHHmmssSSS")||PJF.util.formatDate(new Date,"yyyyMMddHHmmssSSS"),Txn_Chnl_Cd:"02",Vchr_RePrt_Cnt:"0",Txn_InsID:PJF.roleInfo.orgCode,Txn_TrID:PJF.otherInfo.devId},l.jsonData)),success:function(s){for(var r=new PJF.ui.loading({msg:"正在查询电子印章数据..."}),c=[],t=0;s.Vchr_Grp[t];t++){if("N"===s.Vchr_Grp[t].Eltc_Stmp_Wthr_Us_Ind)return r.destroy(),console.log("该机构电子印章没有开启"),void u("该机构电子印章没有开启");c.push($.ajax({url:"ecpJson",dataType:"json",data:{_fw_service_id:"getElecSealInfo",jsonData:JSON.stringify({sealID:l.jsonData.Vchr_Grp[t].Stmp_Bsn_Ctlg_ID})}}))}$.when.apply(null,c).done(function(){r.destroy()
;for(var t=[],e=new PJF.ui.loading({msg:"正在合成电子印章数据..."}),n=1==c.length?[arguments]:arguments,i=0,o=n.length;i<o;i++){var a=$.Deferred();t.push(a.promise()),function(n,t,i){t.sealMD5?PJF.stm.util.elecSealHandler({sealId:l.jsonData.Vchr_Grp[i].Stmp_Bsn_Ctlg_ID,sealRemotePath:t.sealPath,sealFileMd5:t.sealMD5},function(t){if(0==t.status)console.log("电子印章下载失败"),n.rejectWith(null,[t.errorMsg]);else{var e=PJF.communication.fileSystem.readImage(t.localUrl);e.success?(console.log("电子印章读取成功"),e=e.result,d($.extend({sealBase64:e,callback:function(t){t?n.resolveWith(null,[t]):(console.log("电子印章合成失败"),n.rejectWith(null,["电子印章合成失败"]))}},s.Vchr_Grp[i]))):(console.log("电子印章读取失败"),n.rejectWith(null,["电子印章读取失败:"+e.error]))}}):(console.log("getElecSealInfo 电子印章不存在"),n.rejectWith(null,["电子印章查询失败"]))}(a,n[i][0],i)}$.when.apply(null,t).done(function(){e.destroy(),l.callback({success:!0,Vchr_Grp:s.Vchr_Grp,sealArray:Array.prototype.slice.apply(arguments)})}).fail(function(t){e.destroy(),u(t)})
}).fail(function(t,e,n){r.destroy(),u(e+" "+n)})},failure:function(t){u(t.BK_DESC)}}):u("机构电子印章关闭")},e.savePaginationHtml=function(n,i){if(i.sealCfg){i.sealCfg=$.extend({sealLeft:0,sealTop:0},i.sealCfg),i.sealCfg.Vchr_Grp&&i.sealCfg.Vchr_Grp.forEach(function(t){var e={Stmp_Bsn_Ctlg_ID:"001",VchID:PJF.util.generateUUid()};$.extend(e,t),$.extend(t,e)}),e.getTransSeal({jsonData:i.sealCfg,callback:function(t){t.success&&(i.sealInfo={sealContent:t.sealArray[0],sealLeft:i.sealCfg.sealLeft||0,sealTop:i.sealCfg.sealTop||0,Vchr_Grp:t.Vchr_Grp});var e=o(n,i);t.success?(e.Vchr_Grp=t.Vchr_Grp,e.sealInfo=i.sealInfo,e.sealSuccess=!0):(e.sealSuccess=!1,e.sealErrMsg=t.errMsg),i.callback(e)}})}else{if(!i.sealInfo)return o(n,i);var t=o(n,i);t.Vchr_Grp=i.sealInfo.Vchr_Grp,t.sealInfo=i.sealInfo,t.sealSuccess=!0,i.callback(t)}};var o=function(l,t){var u={bodyCss:""},s={};s=$.extend(s,t);var r=l&&l.allRows;if(!r)return alert("无可打印的数据"),{success:!1,errMsg:"无可打印的数据"};var c=r.length
;if(0==c)return alert("无可打印的数据"),{success:!1,errMsg:"无可打印的数据"};if(!l.printMeta)return alert("返回数据格式不正确，不存在printMeta属性！"),{success:!1,errMsg:"返回数据格式不正确，不存在printMeta属性！"};if(!l.printMeta.firstPageNum||!l.printMeta.otherPageNum)return alert("返回数据格式不正确，不存在 firstPageNum或者 otherPageNum 属性！"),{success:!1,errMsg:"返回数据格式不正确，不存在 firstPageNum或者 otherPageNum 属性！"};try{u.hasMore=parseInt(l.hasMore)}catch(t){u.hasMore=0}var e={defaultColWidth:s.defaultColWidth,defaultTitleMargin:s.defaultTitleMargin||4,defaultFontSize:s.defaultFontSize||12,defaultMinColWidth:s.defaultMinColWidth||4*(s.defaultFontSize||12),defaultHeadHeight:s.defaultHeadHeight,fixedColumnWidth:s.fixedColumnWidth,autoPage:s.autoPage,isRepeat:!0,width:s.width,height:s.height,verticalPrint:void 0===s.verticalPrint||s.verticalPrint,showPageNumber:s.showPageNumber,nowrap:s.nowrap,isHeadAttachedAllPage:!!s.isHeadAttachedAllPage,pageRenderCallBack:s.pageRenderCallBack,gridConf:$.extend({showRowNumber:!0,showCheckbox:!1},s.gridConf),
reqParamsBak:{}};u.p=e;var n=965,i=630;1==u.p.verticalPrint&&(n=750,i=965),u.p.width&&(n=u.p.width),u.p.height&&(i=u.p.height);var o=30,d=n,h=u.p.gridConf.showCheckbox,m=u.p.gridConf.showRowNumber,p=u.p.showPageNumber,f=d-(m?30:0)-(h?27:0)-4,g=l.printMeta.columnList,a=l.printMeta.columnWidthList||[];f-=g.length*u.p.defaultTitleMargin;var P=0,v=d-4,C={},_=0,F=n,y=u.p.verticalPrint?104:241,J=u.p.verticalPrint?191:241,I={pageTitle:'<div class="page-title">',attachOuterHTML:'<div class="attach-info" >',attachOuterHTML_EMPTY:'<div class="attach-info attach-info-empty">',attachEndHTML:"</div>",headAttach:'<span class="page-head-attach">',endAttach:'<span class="page-foot-attach">',pageTitleEnd:"</div>",attachEnd:"</span>",firstHeadAttachOutHTML:'<div class="first-head-attach-info" style="width:'+n+'px;">',firstHeadAttachEndHTML:"</div>",firstHeadAttachContainerHTML:'<div class="first-head-attach-container" style="width:'+(n-10)+'px;">',
firstHeadAttachDetailLeftHTML:'<span class="first-head-attach-detail left">',firstHeadAttachDetailRightHTML:'<span class="first-head-attach-detail right">',firstHeadAttachDetailEndHTML:"</span>",firstHeadAttachContainerEndHTML:"</div>",attachInfoOuterHTML:'<div class="pjf_table_div" style="width: '+F+'px;"><table class="pjf_table" style="width: '+F+'px;"><tbody>',attachInfoEndHTML:"</tbody></table></div>",attachInfoLabelHTML:'<td class="pjf_td_label" style="width: '+y+'px;">',attachInfoLabelEndHTML:"</td>",attachInfoContentHTML:'<td class="pjf_td_content" style="width: '+J+'px;">',attachInfoContentEndHTML:"</td>",attachInfoBottomLabelHTML:'<td class="pjf_td_label" style="width: '+y+'px;border-bottom: 1px solid rgb(134, 189, 236);">',attachInfoBottomLabelEndHTML:"</td>",attachInfoBottomContentHTML:'<td class="pjf_td_content" style="width: '+J+'px;border-bottom: 1px solid rgb(134, 189, 236);">',attachInfoBottomContentEndHTML:"</td>",footerContainerHTML:'<div class="footer-info" >',
footerContainerEndHTML:"</div>",footerHTML:'<span class="page-footer">',footerEndHTML:"</span>",baseOuterHTML:'<div class="panel datagrid" style="width:'+d+'px;"><div class="datagrid-wrap panel-body panel-body-noheader" title="" style="width: auto; ">',baseEndHTML:"</div></div>",gridViewEnd:"</div>",gridView2:'<div class="datagrid-view2" style="height: auto; left:0px;">',gridView2End:"</div>",headView:'<div class="datagrid-header" style=" min-height: '+(u.p.defaultHeadHeight||29)+'px;"><div class="datagrid-header-inner" style="display: block;">',headViewEnd:"</div></div>",bodyView:'<div class="datagrid-body" style="height: auto;">',bodyViewEnd:"</div>"},b={},S=u.p.isHeadAttachedAllPage;!function(){for(var t=0;t<g.length;t++)a[t]&&(a[t]=parseInt(a[t])),b[t]=a[t]||u.p.defaultColWidth||g[t].length*u.p.defaultFontSize;var e=l.printMeta.headAttach||[],n=[];if(e.length)for(var t=0;t<e.length;t++){var i=e[t];"#"==i.des.substr(0,1)&&(i.des=i.des.substr(1),n.push(i),e.splice(t,1),t--)}
(l.printMeta.headAttach=e).length%2==1&&l.printMeta.headAttach.push({key:"",value:"",des:""});n.length%2==1&&n.push({key:"",value:"",des:""});l.printMeta.firstHeadAttach=n,e.length&&(o=e.length/2*26+1+2,P=n.length/2*26,o+=P+2);S&&(o=30)}();var T=i-50-o-30-2,D=i-2-30;S&&(D-=50+o);var A=!0;u.printDatas=[];var w={firstPage:parseInt(l.printMeta.firstPageNum),otherPage:parseInt(l.printMeta.otherPageNum)},x=!0,E=u.p.hasPrint?w.otherPage:w.firstPage;u.p.rowNumber=u.p.rowNumber||1;var R=0,O=u.p.currentPageNumber||0,N=!1;!function(){for(var t=0;t<g.length;t++)A&&Z(t,X(g[t])*u.p.defaultFontSize);for(var e=0,n=0,i=g.length,o=[],a=0,s=0;s<i;s++){var r=0;u.p.fixedColumnWidth&&(r=u.p.fixedColumnWidth[g[s]]),r?n+=r:(e+=C[s],a+=g[s].length),o.push(C[s])}if(f-n<e)for(var t in e=0,b)C[t]=b[t],(!u.p.fixedColumnWidth||!u.p.fixedColumnWidth[g[t]])&&(e+=b[t]);for(var c=(f-n-e)/a,t=0;t<i;t++){var r=0;u.p.fixedColumnWidth&&(r=u.p.fixedColumnWidth[g[t]]),r?C[t]=r:Z(t,null,c*g[t].length)}}();var k=0
;if(u.p.autoPage){var M=$("<div></div>").appendTo($("body"));R=W();q=Y(_,0);M.append("<style type='text/css'>"+u.bodyCss+"</style>"),M.append(q.replace(/\'/g,"＇"));for(var j=M.find(".datagrid-body").find("tbody")[0],L=$(M.find(".datagrid-header")).height();_<c;){for(var B=_,H=L,U=_;U<c;U++){if(u.p.rowNumber=0,j.innerHTML=Q(U,!0).replace(/\'/g,"＇"),H+=$(j).height(),R<H){H-=$(j).height(),_=U;break}if(U==c-1){_=U+1;break}}u.p.rowNumber=B+1,q=Y(B,_-B,H),u.printDatas.push(q),R=W(),k++}M.remove()}else for(;_<c;){R=W();var z=-1;c<=_+(z=E)&&(z=c-_);var q=Y(_,z);u.printDatas.push(q),_+=z,k++}var V='<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body>';V+="<style type='text/css'>"+u.bodyCss+"</style>"+u.printDatas.join("").replace(/\'/g,"＇").replace(/共total页/g,"共"+k+"页"),V+="</body></html>"
;var K=PJF.otherInfo.devId+Date.now()+PJF.util.generateUUid()+".html",G=PJF.communication.writeTextFile(K,V);return G.success?{path:G.result.replace(new RegExp("\\\\","gm"),"/"),count:k,success:!0}:{errMsg:G.error,success:!1};function W(){return O++,0==_?(x=!0,u.p.hasPrint?D:T):(x=!1,S&&(x=!0),E=w.otherPage,D)}function Y(t,e,n){var i=[];if(N=!(t+e<c),i.push('<div class="page-start" style="position:relative;width:'+d+"px;"+(N?"":"page-break-after:always;")+'">'),s.sealInfo){if(i.push(PJF.util.formatTpl('<div style = "width:{{width}}px;height:{{height}}px;position:absolute;z-index:-1;left:{{left}};top:{{top}};">',{width:s.sealInfo.sealContent.width,height:s.sealInfo.sealContent.height,left:s.sealInfo.sealLeft,top:s.sealInfo.sealTop})),"img"==s.sealInfo.sealContent.type){i.push('<img src = "'+s.sealInfo.sealContent.base64+'" style="position:absolute"></img>')}else"svg"===s.sealInfo.sealContent.type&&i.push(s.sealInfo.sealContent.svg);i.push("</div>")}x&&i.push(function(){u.p.hasPrint
;var t=[],e=l.printMeta.headAttach,n=(l.printMeta.firstHeadAttach,l.printMeta.title);if(n&&t.push(I.pageTitle+n+I.pageTitleEnd),e){t.push(I.attachOuterHTML);for(var i="",o=0,a=e.length;o<a;o++){var s=e[o];i=s.des?"：":"",t.push(I.headAttach+s.des+i+s.value+I.attachEnd)}return t.push(I.attachEndHTML),t.join("")}}()),i.push(I.baseOuterHTML);var o=n||R;i.push('<div class="datagrid-view" style="height: '+o+'px; ">'),i.push(I.gridView2),i.push(I.headView),i.push(function(){var t=[];t.push('<table border="0" cellspacing="0" cellpadding="0" class="datagrid-htable datagrid-table-'+_+'" style="min-height: 30px;"><tbody><tr class="datagrid-header-row">'),m&&t.push('<td rowspan="0" style="width:25px;"><div class="datagrid-header-rownumber"></div></td>'),h&&t.push('<td field="ck" style="width:27px;"><div class="datagrid-header-check"><input type="checkbox" textcontent="header"></div></td>')
;for(var e=g.length,n=0;n<e;n++)t.push('<td field="col_'+n+'" class="datagrid-cell-'+_+"-"+n+'"><div class="datagrid-cell datagrid-cell-'+_+"-"+n+'"><span style="white-space: normal;">'+g[n]+"</span></div></td>");return t.push("</tr></tbody></table>"),t.join("")}()),i.push(I.headViewEnd),i.push(I.bodyView);var a=function(t,e){var n={},i=[];i.push(I.bodyView),i.push('<table border="0" cellspacing="0" cellpadding="0" class="datagrid-btable datagrid-table-'+_+'" ><tbody>'),c<=e+t&&(e=c-t);n.header=i.join("");for(var o=[],a=0;a<e;a++)o.push(Q(a+t));u.bodyCss+=function(){var t=[];t.push(".page-start{margin:0;padding:0;font-family: '宋体','Microsoft Yahei','微软雅黑';}"),t.push(".page-start{margin: 0 auto;}"),t.push(".page-start div,tr,td {box-sizing: border-box;-ms-box-sizing: border-box;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;}"),t.push(".datagrid-view {position: relative;overflow: hidden;border: 1px solid #000;}"),
t.push(".datagrid-header {overflow: hidden;border-bottom: 1px solid #000;cursor: default;font-weight: bold;}"),t.push(".datagrid-row {height: 25px;border-bottom: 1px solid #000;}"),t.push(".datagrid-body .datagrid-cell, .datagrid-footer .datagrid-cell{white-space:normal;}"),t.push(".page-start .datagrid-cell{word-break:break-all;}"),t.push("div.first-head-attach-info{padding-bottom: 2px;height:"+P+"px;line-height:"+P+"px;}"),t.push("div..first-head-attach-detail,.first-head-attach-container{height: 26px; \tpadding: 0px 5px;line-height: 26px;}"),t.push("div.page-title{text-align: center;font-size: 16px;font-weight: bold;height: 50px;line-height: 50px;margin: 0 auto;width:"+v+"px;}"),t.push("div.attach-info{margin: 0 auto;height: auto;margin-bottom: 8px;width:"+v+"px;font-size: "+u.p.defaultFontSize+"px;}"),t.push("div.footer-info{margin: 0 auto;height: 30px;text-align: center;}"),t.push(".page-head-attach{padding-right: 15px;}"),t.push(".page-foot-attach{padding-right: 15px;}"),
t.push(".page-start .pjf_table_div{padding-bottom: 2px;}");var e=u.p.defaultFontSize+4;t.push("table.datagrid-table-"+_+"{width:"+v+"px;overflow-x:hidden;line-height:"+e+"px;}");for(var n=g.length,i=0;i<n;i++){t.push("div.datagrid-cell-"+_+"-"+i+"{width:"+C[i]+"px;}"),t.push("td.datagrid-cell-"+_+"-"+i+"{width:"+C[i]+"px;text-align:left;}");var o=u.p.pageRenderCallBack&&u.p.pageRenderCallBack(g[i]);o&&t.push("td.datagrid-cell-"+_+"-"+i+o)}t.push(".page-start .datagrid-header td{border-right: 1px solid #000;font-size: "+u.p.defaultFontSize+"px;}"),t.push(".page-start .datagrid-body td, .datagrid-footer td{font-size: "+u.p.defaultFontSize+"px;}"),t.push(".page-start .datagrid-body td{border-bottom: 1px solid #000;border-right: 1px solid #000;}"),t.push(".page-start .datagrid-body tr td:last-child{border-right:none;}"),t.push(".page-start .datagrid-header tr td:last-child{border-right:none;}"),
t.push(".page-start .datagrid-header .datagrid-cell{padding:2px "+u.p.defaultTitleMargin/2+"px;}"),t.push(".page-start .datagrid-body .datagrid-cell, .page-start .datagrid-footer .datagrid-cell{padding:0px "+u.p.defaultTitleMargin/2+"px;}"),u.p.defaultHeadHeight&&t.push(".page-start .datagrid-header .datagrid-cell{white-space: normal;}");return t.join("")}(),n.content=o.join("");var s=[];return s.push("</tbody></table>"),s.push(I.bodyViewEnd),n.footer=s.join(""),n}(t,e);return i.push(a.header),i.push(a.content),i.push(a.footer),i.push(I.bodyViewEnd),i.push(I.gridView2End),i.push(I.gridViewEnd),i.push(I.baseEndHTML),i.push(function(t,e,n){var i=[],o=l.printMeta.endAttach;if(o){i.push(I.attachOuterHTML);for(var a=o.length,s=0;s<a;s++){var r=o[s];i.push(I.endAttach+r.des+"："+r.value+I.attachEnd)}i.push(I.attachEndHTML)}if(p){var c=p?O:"";i.push(I.footerContainerHTML),i.push(I.footerHTML+"- 第"+c+"页 /共total页 -"+I.footerEndHTML),i.push(I.footerContainerEndHTML)}return i.join("")}()),
i.push("</div>"),i.join("")}function Q(t,e){var n=[],i=e?0:_;n.push('<tr class="datagrid-row '+(t%2==1?"datagrid-row-alt":"")+'" datagrid-row-index="0"  style="height:24px;">'),m&&n.push('<td class="datagrid-td-rownumber" style="width:25px;"><div class="datagrid-cell-rownumber">'+u.p.rowNumber+++"</div></td>"),h&&n.push('<td field="ck" style="width:27px;"><div class="datagrid-cell-check " style=""><input type="checkbox" value="" name="ck" textcontent="cell"></div></td>');for(var o=r[t],a=o.length,s=0;s<a;s++)n.push('<td field="col_'+s+'" class="datagrid-cell-'+i+"-"+s+'"><div class="datagrid-cell datagrid-cell-'+i+"-"+s+'" style="height:auto;">'+o[s]+"</div></td>");return n.push("</tr>"),n.join("")}function Z(t,e,n){n?C[t]+=n:C[t]?(e<u.p.defaultMinColWidth&&(e=u.p.defaultMinColWidth),C[t]<e&&(C[t]=e)):C[t]=e}function X(t){if(!t)return 0;var e=t.length,n=/[a-zA-z]/g,i=0;null!=t.match(n)&&(i=t.match(n).length);var o=/\d/g,a=0;null!=t.match(o)&&(a=t.match(o).length)
;var s=/[\u4e00-\u9fa5]/g,r=0;null!=t.match(s)&&(r=t.match(s).length);return i+a+r!=e&&e-(i+a+r),Math.round(4/7*(e-r)+r)}}}(PJF.util),PJF.namespace("PJF.fsm"),function(t){var e={};t.create=function(r){if((r=$.extend({},r)).id)if(e[r.id]&&console.log("状态机ID重复:"+r.id),r.initial){if(r.actions&&!(r.actions.length<=0))return e[r.id]=function(){for(var t=r.actions,e=(r.callbacks,[]),n={},i=r.initial,o={},a=0;a<t.length;a++){var s=t[a];-1==PJF.util.array.indexOf(e,s.from)&&e.push(s.from),-1==PJF.util.array.indexOf(e,s.to)&&e.push(s.to),o[s.name]={from:s.from,to:s.to},function(t){n[t.name]=function(){i==t.from?(i=t.to,console.log("状态机转化"+t.name+", 从"+t.from+"转化为"+t.to)):console.log("状态机转化"+t.name+"错误, 不能从"+i+"转化为"+t.to)}}(s)}return n.is=function(t){return i===t},n.current=function(){return i},n.can=function(t){return o[t]&&o[t].from==i},n.cannot=function(t){return!this.can(t)},n.isDone=function(){return i===r.done},n}();alert("状态机必须至少有一个状态转化")}else alert("状态机必须有初始状态");else alert("状态机id未定义")},
t.get=function(t){return e[t]},t.isDone=function(t){return 0==t.length||!this.get(t[0])||this.get(t[0]).isDone()&&this.isDone(t.slice(1))},t.fmIds={STM_CAMERA:"pjfStmCamera",STM_SIGNATURE:"pjfStmSignature",STM_ICCARD:"pjfStmIccard",STM_IDCARD:"pjfStmIdcard",STM_PAD_TEMPLATEINFO:"pjfStmPadTemInfo",STM_PRT:"pjfStmPrt"}}(PJF.fsm),PJF.namespace("PJF.validator"),PJF.validator.base={isNum:{key:"number",fn:function(t){return!!t&&null==t.match(/\D/)}},isDigit:{key:"digit",fn:function(t){return null!=t.match(/^-?\d+(\.\d+)?$/g)}},isInt:{key:"int",fn:function(t){return null!=t.match(/^[-+]?\d*$/)}},pInt:{key:"pInt",fn:function(t){return!!t.match(/^\+?[1-9][0-9]*$/)}},notNegaInt:{key:"notNegaInt",fn:function(t){return!!t.match(/^(0|[1-9]\d*)$/)}},pNum:{key:"pNum",fn:function(t){return!!(t.match(/^[\+]?[0-9]*\d(\.\d+)?$/)&&0<parseFloat(t))}},greaterZero:{key:"gZero",fn:function(t){return!!t.match(/^[\+]?[0-9]*\d(\.\d+)?$/)}},isChinese:{key:"chinese",fn:function(t){return-1!=escape(t).indexOf("%u")
}},isEmail:{key:"email",fn:function(t){return null!=t.match(/^[\w-_]+(\.[\w-_]+)*@[\w-_]+((\.[\w-_]+)+)$/)}},isMobile:{key:"mobile",fn:function(t){return null!=t.match(/^1\d{2}-?\d{5}(\d{3}|\*{3})$/)}},isTel:{key:"tel",fn:function(t){return null!=t.match(/^(([0\+]\d{2,3}-)?(0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/)}},isIDCard:{key:"IDCard",fn:function(t){if(15==t.length)var e=new Number("19"+t.slice(6,8)),n=new Number(t.slice(8,10))-1,i=new Number(t.slice(10,12));else if(18==t.length)e=new Number(t.slice(6,10)),n=new Number(t.slice(10,12))-1,i=new Number(t.slice(12,14));var o=new Date(e,n,i),a=new Date;return(null!=t.match(/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$/)||null!=t.match(/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[X])$/))&&(!(e<1900||a<o)&&(o.getFullYear()==e&&o.getMonth()==n&&o.getDate()==i))}},is18IDCard:{key:"18IDCard",fn:function(t){
var e=new Number(t.slice(6,10)),n=new Number(t.slice(10,12))-1,i=new Number(t.slice(12,14)),o=new Date(e,n,i),a=new Date;return null!=t.match(/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[X])$/)&&(!(e<1900||a<o)&&(o.getFullYear()==e&&o.getMonth()==n&&o.getDate()==i))}},isName:{key:"user",fn:function(t){return!(t.match(/(\\|:|\/|\*|\?|\"|>|<|\|)/)||t.match(/^[\s]|[\u4E00-\u9FA5]\s/)||t.match(/[a-z]/)||t.match(/([\uFF00-\uFF07] | [\uFF0A-\uFFEF] | [\u3000-\u3009] | [\u300C-\u303F])/))}},isCnNumEn:{key:"isCnNumEn",fn:function(t){return!!t.match(/^[\u4e00-\u9fff\u3400-\u4DB5\uF900-\uFA2D\uFA30-\uFA6A\uFA70-\uFAD9\uFF00-\uFFEF\u2E80-\u2EFF\u3000-\u303F\u31C0-\u31EF\ue815-\ue864\ue000-\uefffA-Za-z0-9]*$/)}},iciUserName:{key:"iciUserName",fn:function(t){var e="一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--",n=new RegExp("^(["+e+"A-Za-z])+((·| |-)(["+e+"A-Za-z])+)*$");if(!t.match(n))return!1
;if(t.match("([一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--])( )+([一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--])"))return!1;if(t.match("([一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--]( )+[A-Za-z])|([A-Za-z]( )+[一-鿿㐀-䶵豈-鶴侮-頻並-龎＀-￯⺀-⻿　-〿㇀-㇯--])"))return!1;return!t.match(/[A-Za-z]+( ){2,}[A-Za-z]+/)&&(-1==t.indexOf("·")||!t.match(/([A-Za-z]| )/))}},isSpecChar:{key:"specChar",fn:function(t){return!t.match(/(^[\s]|\\|:|\/|\*|\?|\"|>|<|\|)/)&&!t.match(/(\uFF3C|\uFF0F|\uFF1A|\uFF0A|\uFF1F|\uFF02|\uFF1C|\uFF1E|\uFF5C)/)}},length:{key:"length",fn:function(t,e){if(e){if(1==e.length)return t.length==e[0];if(2==e.length)return t.length<=e[1]&&t.length>=e[0]}return!0}},isNumberOrLetter:{key:"isNumberOrLetter",fn:function(t){return!!t.match(/^[A-Za-z0-9]+$/)}},isChnChar:{key:"isChnChar",fn:function(t){return!!t.match(/[\u4E00-\u9FA5]/)}},decLength:{key:"decLength",fn:function(t,e){if(e){var n="^-?([0-9])+(\\.[0-9]{1,"+e[1]+"})?$",i=t.split(".");return!(!t.match(n)||i[0].length>e[0])}}},byteLength:{key:"byteLength",
fn:function(t,e){var n,i;if(e){if((i=t.match(/[^\x00-\xff]/g))||(i=""),n=t.length-i.length+3*i.length,1==e.length)return n==e[0];if(2==e.length)return n<=e[1]&&n>=e[0]}return!0}},isStrNumPwd:{key:"isStrNumPwd",fn:function(t,e){var n=[];n.push(function(t){return t.match(/^[0-9]{6}$/g)});n.push(function(t){return!t.match(/^([0-9]{1})\1{5}$/g)});n.push(function(t){for(var e=!0,n=0;n<t.length-1;n++)if(t.charCodeAt(n)-t.charCodeAt(n+1)!=1){e=!1;break}var i=!0;for(n=0;n<t.length-1;n++)if(t.charCodeAt(n+1)-t.charCodeAt(n)!=1){i=!1;break}return!e&&!i});n.push(function(t){return!t.match(/^([0-9]{1})\1{1}([0-9]{1})\2{1}([0-9]{1})\3{1}$/g)&&!t.match(/^([0-9]{1})\1{2}([0-9]{1})\2{2}$/g)});n.push(function(t,e){if(!e)return!0;for(var n,i=e.split(";"),o=0;o<i.length;o++){if((n=i[o]).match(/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$/)&&"0"==n[10]&&"0"==n[12]&&t.substring(0,4)==n.substring(6,10)&&t[4]==n[11]&&t[5]==n[13])return!1;if(-1!=n.indexOf(t))return!1}return!0
});for(var i=0;i<n.length;i++){if(!n[i].call(this,t,e))return!1}return!0}},loanAccount:{key:"loanAccount",fn:function(t,e){if(e)return!!t.match("\\d{2}\\s\\d{3}\\s\\d{3}\\s\\d{4}-\\d{14}")}},zipCode:{key:"zipCode",fn:function(t){return!!t.match(/^[0-9]\d{5}$/)}},numFixedFormat:{key:"numFixedFormat",fn:function(t,e){if(!e||2!=e.length)return alert("numFixedFormat 参数格式错误 ,格式为[int,int]"),!1;var n=e[0]||1,i=e[1];if(/^-0$/.test(t))return!1;var o="^[-]?(([1-9]\\d{0,"+(n-1)+"})|([0]))",a="";return a=0<i?"(\\.\\d{1,"+i+"})?$":"$",console.log(o+a),new RegExp(o+a).test(t)}},isPhoneNumber:{key:"isPhoneNumber",fn:function(t){return null!=t.match(/^1\d{2}-?\d{5}(\d{3}|\*{3})$/)}},identityType:{key:"identityType",fn:function(t,e){if(!e)return!1;var n;switch(e=1==e.length?e[0]:e){case PJF.constants.IDENTITY_GANG_AO:n=/^(H|M)\d{8}$/;break;case PJF.constants.IDENTITY_TAI_WAN:n=/^\d{8}$/}return!!t.match(n)}}},PJF.validator.rules=function(){if(PJF.validator.base){var t=PJF.validator.base,e={}
;for(var n in t)e[t[n].key]=t[n].fn;return e}},PJF.validator.validate=function(t,e,n){n=(n=n||"").split(",");for(var i=PJF.validator.rules(),o=0;o<n.length;o++)if(i[n[o]]&&!i[n[o]](t,e))return n[o]},PJF.validator.expand=function(t){if(PJF.apply(PJF.validator.base,t),$.fn.validatebox){var e=PJF.validator.rules(),n={},i=function(n){return{fn:function(t,e){return!PJF.validator.validate(t,e,n)}}};for(var o in e)n[o]={validator:i(o).fn,message:o+"!"};$.extend($.fn.validatebox.defaults.rules,n)}},function(){function addParam(t,e){var n=(t=t||"").split("&"),i=[];for(var o in e)i.push(o);for(var a=n.length;0<a--;)-1!=PJF.util.array.indexOf(i,n[a].split("=")[0])&&n.splice(a,1);for(var o in t=n.join("&"),e)e[o]=e[o]||"",t+=(""===t?"":"&")+o+"="+encodeURIComponent(e[o]);return t}function getParam(t,e){for(var n=(t=t||"").split("&"),i=0,o=n.length;i<o;i++)if(n[i].split("=")[0]===e)return n[i].split("=")[1]}function needMac(t,e){
return!(!e.data||!e.data.jsonData||"string"!=typeof e.data.jsonData)||(!("pc"!=PJF.constants.termType||!t.data||"string"!=typeof getParam(t.data,"jsonData"))||void 0)}$.ajaxPrefilter(function(options,originalOptions,jqxhr){if("pc"==PJF.constants.termType&&!PJF.constants.D2D&&PJF.constants.LOGIN_TOKEN&&"string"==typeof PJF.util.getValue(originalOptions,"data.jsonData")){var loginToken=PJF.util.getLoginToken();if(loginToken){var jsonData=decodeURIComponent(getParam(options.data,"jsonData").replace(/\+/g," "));try{jsonData=eval("("+jsonData+")"),jsonData._login_tk=loginToken,options.data=addParam(options.data,{jsonData:JSON.stringify(jsonData)})}catch(t){console.info("注入login token时jsondata eval失败:"+t.message)}}}if(!PJF.constants.NO_AJAX_PREFILTER){var _operCode="stm"==PJF.constants.termType?PJF.util.getValue(window,"PJF.otherInfo.devId"):PJF.util.getValue(window,"PJF.userInfo.userCode");if(_operCode&&needMac(options,originalOptions)){var encryptData;switch(PJF.constants.termType){
case"pc":if(PJF.communication.client.isInP2()){var macRst;if("string"!=typeof originalOptions.data)console.debug("macData普通情况"),macRst=PJF.communication.client.macContent(decodeURIComponent(getParam(options.data,"jsonData").replace(/\+/g," ")));else{var jsonData=getParam(options.data,"jsonData").replace(/\+/g," ");try{decodeURIComponent(jsonData)!==jsonData?(console.debug("macData data为encode字符串情况"),macRst=PJF.communication.client.macContent(decodeURIComponent(jsonData))):(console.debug("macData data为未encode字符串情况"),macRst=PJF.communication.client.macContent(jsonData))}catch(t){console.debug("macData data为未encode字符串情况, 并且有%号的情况"),macRst=PJF.communication.client.macContent(jsonData)}}0==macRst[0]&&(encryptData=macRst[1])}else encryptData="pc not in client";break;case"stm":if(PJF.util.compareClientVersion("1.17.1.0")){var macres=PJF.communication.SecAPI.generateMac(PJF.otherInfo.devId,PJF.otherInfo.token,PJF.otherInfo.secNode,originalOptions.data.jsonData)
;encryptData=macres.success?macres.result:macres.error}break;case"mobile":encryptData=PJF.client.encryptData(originalOptions.data.jsonData);break;case"pad":encryptData=PJF.util.encryptData(originalOptions.data.jsonData);break;default:encryptData="unknown device type : "+PJF.constants.termType,console.log("ajax mac加密失败, 未知的设备类型:"+PJF.constants.termType)}encryptData&&(options.data=addParam(options.data,{macData:encryptData,_terminal_type:PJF.constants.termType,OPER_CODE:_operCode}))}}})}(),PJF.namespace("PJF.event"),PJF.event=function(){var s={};return{publish:function(e){var t=s[e];if(t){for(var n=Array.prototype.slice.call(arguments,1),i=void 0,o=0,a=(t=t.slice()).length;o<a;o++)try{t[o].__run_once&&PJF.event.removeSubscriber(e,t[o]),i=t[o].apply(window,n)}catch(t){console.log("publish callback error for event:"+e),console.log(t.stack)}return i}},asyncPublish:function(o){var a=arguments;setTimeout(function(){var t=s[o]
;if(t)for(var e=Array.prototype.slice.call(a,1),n=0,i=(t=t.slice()).length;n<i;n++)try{t[n].__run_once&&PJF.event.removeSubscriber(o,t[n]),t[n].apply(window,e)}catch(t){console.log("asyncPublish callback error for event:"+o),console.log(t.stack)}},0)},hasEvent:function(t){return t in s},onceSubscriber:function(t,e){"function"==typeof e&&(e.__run_once=!0,this.addSubscriber(t,e,null))},addSubscriber:function(t,e,n,i){t&&(s[t]&&!i?s[t].push(e):s[t]=[e])},removeSubscriber:function(t,e){if(t||e){var n=s[t];if(n){if(e){for(var i=0,o=n.length;i<o;i++)if(e===n[i]){n.splice(i,1);break}}else n=[];0===n.length&&delete s[t]}}else s={}},getCallBackList:function(t){return s[t]||[]}}}(),PJF.namespace("PJF.html"),PJF.html={setAreaData:function(t){for(var e in t){var n=PJF.ui.componentMgr.get(e);n.setValue&&n.setValue(t[e])}},getAreaData:function(t){var e={};e=t?PJF.ui.componentMgr.getOuterAll(t):PJF.ui.componentMgr.getAll();var n={};for(var i in e)e[i].getValue&&(n[i]=e[i].getValue());return n},
disableArea:function(t,e){var n=PJF.ui.componentMgr.getAll(t);for(var i in n)e?n[i].disabled instanceof Function&&n[i].disabled():n[i].enable instanceof Function&&n[i].enable()},readOnlyArea:function(t,e){var n=PJF.ui.componentMgr.getAll(t);for(var i in n)n[i].readOnly instanceof Function&&n[i].readOnly(e)},validatedArea:function(t){var e=PJF.ui.componentMgr.getAll(t),n=!0;for(var i in e){if(e[i].com.is(":visible")&&e[i].validated instanceof Function)e[i].validated()&&(n=!1)}return n},template:function(t,e){return $.templates(t).render(e)},getDom:function(t){return $("#"+t)[0]},getUrlParam:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?unescape(n[2]):null},getTemplate:function(t){var e=document.getElementById(t),n=$.data(e,"templateObj");if(!n){var i=e.innerHTML||e.text;i&&(i=i.replace(/&gt;/g,">").replace(/&lt;/g,"<")),n=$.templates(i),$.data(e,"templateObj",n)}return n},render:function(t,e,n){if(t){
"string"==typeof t&&(t=PJF.html.getTemplate(t));var i=t.render(e);return n&&$("#"+n).html(i),i}},empty:function(t){$("#"+t).empty()},remove:function(t){$("#"+t).remove()},content:function(t,e){$("#"+t).html(e)},append:function(t,e){$("#"+t).append(e)},resetRem:function(t){var e;e=t&&t.width?Math.min($(window).width()/PJF.constants.DEFAULT_WINDOWWIDTH*PJF.constants.DEFAULT_FONTSIZE,document.body.clientHeight/PJF.constants.DEFAULT_WINDOWHEIGHT*PJF.constants.DEFAULT_FONTSIZE):Math.min($(window).width()/PJF.constants.DEFAULT_WINDOWWIDTH*PJF.constants.DEFAULT_FONTSIZE,$(window).height()/PJF.constants.DEFAULT_WINDOWHEIGHT*PJF.constants.DEFAULT_FONTSIZE),$("html").css("fontSize",e+"px")},px2Rem:function(t){return("string"==typeof t?t.split("px")[0]:t)/$("html").css("fontSize").split("px")[0]},toAbsURL:function(){var t=function(t){var e=document.createElement("a");return e.href=t,e.href};return""===t("")?function(t){var e=document.createElement("div")
;return e.innerHTML='<a href="'+t.replace(/"/g,"%22")+'"/>',e.firstChild.href}:t}(),addUrlParam:function(t,e){if("string"==typeof t&&!$.isEmptyObject(e)){-1==t.indexOf("?")?t+="?":t+="&";var n=[];for(var i in e)n.push(i+"="+e[i]);return t+n.join("&")}}},function(t,u,_){"use strict";if(!(u&&u.views||t.jsviews)){var F,e,i,d,o="{",a="{",s="}",r="}",c="^",J=!1,A=!0,I=/^(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,n=/(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)/g,l=/\r?\n/g,w=/\\(['"])/g,h=/([\\'"])/g,x=/\x08(~)?([^\x08]+)\x08/g,E=/^if\s/,m=/<(\w+)[>\s]/,p=0,f=0,g={"&":"&amp;","<":"&lt;",">":"&gt;"},P=/[<"'&]/g,v=/[\x00<>"'&]/g,C="data-jsv-tmpl",R="var j=j||"+(u?"jQuery.":"js")+"views,",y=[].slice,b={},S={template:{compile:function e(n,t,i,o,a,s){function r(t){
if(""+t===t||0<t.nodeType){try{l=0<t.nodeType?t:!d.test(t)&&u&&u(t)[0]}catch(t){}return l&&(t=l.getAttribute(C),n=n||t,(t=D[t])||(n=n||"_"+p++,l.setAttribute(C,n),t=D[n]=e(n,l.innerHTML,i,o,a,s))),t}}var c,l;t=t||"";c=r(t);s=s||(t.markup?t:{});s.tmplName=n;i&&(s._parentTmpl=i);!c&&t.markup&&(c=r(t.markup))&&(!c.fn||c.debug===t.debug&&c.allowCode===t.allowCode||(c=c.markup));if(c!==_)return n&&!i&&(b[n]=function(){return t.render.apply(t,arguments)}),c.fn||t.fn?c.fn&&(t=n&&n!==c.tmplName?tt(s,c):c):(t=V(c,s),Q(c,t)),function(t){var e,n,i,o,a;for(e in S)if(o=S[e],(a=o.compile)&&(n=t[e+"s"]))for(i in n)n[i]=a(i,n[i],t,e,o)}(s),t}},tag:{compile:function(t,e,n){var i,o;"function"==typeof e?e={tagName:t,render:e,depends:e.depends}:(e.tagName=t,(o=e.template)&&(e.template=""+o===o?D[o]||D(o):o),e.init!==J&&((i=e.init=e.init||function(t){}).prototype=e,(i.prototype=e).constructor=i));e.renderContent=G,e.attr="html",n&&(e._parentTmpl=n);return e}},helper:{},converter:{}},T={jsviews:"v1.0pre",
render:b,View:q,settings:{delimiters:B,debugMode:A,tryCatch:A},sub:{Error:j,tmplFn:Q,parse:Z,extend:L,error:W},_cnvt:function(t,e,n,i,o,a){if(t||o){var s,r=!n.markup&&n,c={tagName:t+":",tagCtx:i},l=i.args=y.call(arguments,5);i.view=e,i.bind=!(!r&&!o),r&&((r.tag=c).linkCtx=r,i.ctx=tt(i.ctx,r.view.ctx)),c.ctx=i.ctx||{},i.props=i.props||{},delete i.ctx,t&&((s=e.getRsc("converters",t))||W("Unknown converter: {{"+t+":"))&&(a=s.apply(c,l)),o&&(o=e.tmpl.bnds[o-1],r.paths=o,e._.tag=c,a=e._.onRender(a,e,A))}return a},_tag:function(t,e,n,i,o,a){var s,r,c,l,u,d,h=n.markup&&n,m=!h&&n,p=e._,f=h||e.tmpl,g=(f.templates,e.getRsc("tags",t)||W("Unknown tag: {{"+t+"}}")),P=o.args=6<arguments.length?y.call(arguments,6):[],v=o.props=o.props||{};o.view=e,o.ctx=tt(o.ctx,e.ctx),c=o.ctx||{},delete o.ctx,h=v.tmpl,i=i&&f.tmpls[i-1],h=""+(h=h||i||g.template||_)===h?e.getRsc("templates",h)||D(h):h,"else"===t&&(u=e._.tag,(l=u._elses=u._elses||[]).push(h),o.isElse=l.length,r=u.render)
;g.init?(d=c.tags=e.ctx&&tt(c.tags,e.ctx.tags)||{},(u=u||m.tag)?d[t]=u:((u=d[t]=new g.init(o,m,c)).tmpl=h,m&&(u.attr=m.attr=m.attr||g.attr||"")),c.tag=u):u=u||{render:g.render,renderContent:G,tmpl:h,tagName:t};u.tagCtx=o,u.ctx=c,m&&((m.tag=u).linkCtx=m);u._is="tag",u._done=o.isElse?u._done:J,h=h||u.tmpl,l=u._elses,p.tag=u,(r=r||u.render)&&(s=r.apply(u,P));return s=s!==_?s:h?u.renderContent(o.data!==_?o.data:e.data,_,e):"",a?p.onRender(s,e,a):s},_err:function(t){return M.debugMode?"Error: "+(t.message||t)+". ":""}};for(e in(j.prototype=new Error).constructor=j,H.depends=function(t){return[t.get("item"),"index"]},S)K(e,S[e]);var D=T.templates,O=T.converters,N=(T.helpers,T.tags),k=T.sub,M=T.settings;u?((F=u).render=b,F.views=T,F.templates=D=T.templates,F.fn.render=G):(F=t.jsviews=T).isArray=Array&&Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},N({if:function(t){return this._done||arguments.length&&!t?"":(this._done=!0,
this.renderContent(this.tagCtx.view))},else:function(){},for:function(){var t,e,n=this.tagCtx,i="",o=arguments,a=0,s=o.length;if(!s)return n.done?"":(n.done=A,this.renderContent(n.view));for(t=0;t<s;t++){if((e=o[t])===_)return"";a+=F.isArray(e)?e.length:1,i+=this.renderContent(e)}return n.done=a,i},"*":function(t){return t}}),O({html:function(t){return t!=_?String(t).replace(v,X):""},attr:function(t){return t!=_?String(t).replace(P,X):""},url:function(t){return t!=_?encodeURI(String(t)):""}}),B()}function j(t,e){e&&e.onError&&e.onError(t)===J||(this.name="JsRender Error",this.message=t||"JsRender error")}function L(t,e){var n;for(n in t=t||{},e)t[n]=e[n];return t}function B(t,e,n){return k.rTag&&!arguments.length||(o=t?t.charAt(0):o,a=t?t.charAt(1):a,s=e?e.charAt(0):s,r=e?e.charAt(1):r,t="\\"+o+"(\\"+(c=n||c)+")?\\"+a,e="\\"+s+"\\"+r,i="(?:(?:(\\w+(?=[\\/\\s\\"+s+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))\\s*((?:[^\\"+s+"]|\\"+s+"(?!\\"+r+"))*?)",k.rTag=i+")",
i=new RegExp(t+i+"(\\/)?|(?:\\/(\\w+)))"+e,"g"),d=new RegExp("<.*>|([^\\\\]|^)[{}]|"+t+".*"+e)),[o,a,s,r,c]}function $(t){for(var e=this,n=!t||"root"===t;n&&e.parent.parent||e&&e.type!==t;)e=e.parent;return e}function H(){var t=this.get("item");return t?t.index:_}function U(t){var e,n=this,i=(n.ctx||{})[t];return(i=i===_?n.getRsc("helpers",t):i)&&"function"==typeof i&&L(e=function(){return i.apply(n,arguments)},i),e||i}function z(t,e){var n,i=this,o=T[t];for(n=o&&o[e];n===_&&i;)n=(o=i.tmpl[t])&&o[e],i=i.parent;return n}function q(t,e,n,i,o,a,s){var r,c,l="array"===e,u={key:0,useKey:l?0:1,id:""+f++,onRender:s,bnd:{}},d={data:i,tmpl:o,views:l?[]:{},parent:n,ctx:t,type:e,get:$,getIndex:H,getRsc:z,_hlp:U,_:u};return n&&(r=n.views,(c=n._).useKey?r[u.key="_"+c.useKey++]=d:r.splice(u.key=d.index=a!==_?a:r.length,0,d),d.ctx=t||n.ctx),d}function V(t,e){var n,i=M.wrapMap||{},o=L({markup:t,tmpls:[],links:{},bnds:[],render:G},e);return e.htmlTag||(n=m.exec(t),o.htmlTag=n?n[1].toLowerCase():""),
(n=i[o.htmlTag])&&n!==i.div&&(o.markup=F.trim(o.markup),o._elCnt=A),o}function K(c,l){var u=c+"s";T[u]=function t(e,n,i){var o,a,s,r;if(e&&""+e!==e&&!e.nodeType&&!e.markup){for(s in e)t(s,e[s],n);return T}return r=i?i[u]=i[u]||{}:t,n===_&&(n=e,e=_),a=l.compile,(o=k.onBeforeStoreItem)&&(a=o(r,e,n,a)||a),e?""+e===e&&(null===n?delete r[e]:r[e]=a?n=a(e,n,i,c,l):n):n=a(_,n),n&&(n._is=c),(o=k.onStoreItem)&&o(r,e,n,a),n},S[c]=l}function G(t,e,n,i,o,a){var s,r,c,l,u,d,h,m,p,f,g=this,P=g,v=g.attr===_||"html"===g.attr,C="";if(i===A&&(m=A,i=0),"tag"===g._is?(P=(p=g.tagCtx).isElse?g._elses[p.isElse-1]:g.tmpl,e=tt(e,g.ctx),p.props.link===J&&((e=e||{}).link=J),n=n||p.view):P=g.jquery&&(g[0]||W('Unknown template: "'+g.selector+'"'))||g,P&&(n&&(a=a||n._.onRender,h=n.ctx,t===n&&(t=n.data,o=A)),e=tt(e,h),P.fn||(P=D[P]||D(P)),P)){if((f=a=(e&&e.link)!==J&&v&&a)===A&&(f=_,a=n._.onRender),F.isArray(t)&&!o)for(l=m?n:i!==_&&n||q(e,"array",n,t,P,i,a),s=0,r=t.length;s<r;s++)u=q(e,"item",l,c=t[s],P,(i||0)+s,a),
d=P.fn(c,u,T),C+=l._.onRender?l._.onRender(d,u):d;else l=m?n:q(e,g.tagName||"data",n,t,P,i,a),C+=P.fn(t,l,T);return f?f(C,l):C}return""}function W(t){if(M.debugMode)throw new T.sub.Error(t)}function Y(t){W("Syntax error\n"+t)}function Q(C,t,_){function F(t){(t-=b)&&T.push(C.substr(b,t).replace(l,"\\n"))}function y(t){t&&Y('Unmatched or missing tag: "{{/'+t+'}}" in template:\n'+C)}var J,I=t&&t.allowCode,e=[],b=0,S=[],T=e,D=[,,,e];return C=C.replace(h,"\\$1"),y(S[0]&&S[0][3].pop()[0]),C.replace(i,function(t,e,n,i,o,a,s,r,c,l,u,d){a&&(o=":",i="html");var h,m,p=[],f="",g="",P="",v=!(l||o||s||_);n=n||o,F(d),b=d+t.length,r?I&&T.push(["*","\n"+c.replace(w,"$1")+"\n"]):n?("else"===n&&(E.test(c)&&Y('for "{{else if expr}}" use "{{else expr}}"'),D[7]=C.substring(D[7],d),D=S.pop(),T=D[3],v=A),c&&(f=Z(c=c.replace(/\s*\n\s*/g," "),p).replace(x,function(t,e,n){return e?P+=n+",":g+=n+",",""})),g=g.slice(0,-1),f=f.slice(0,-1),h=g&&g.indexOf("noerror:true")+1&&g||"",
J=[n,i||"",f,v&&[],"{"+(g?"props:"+(h?"hsh":"{"+g+"}")+",":"")+'params:"'+c+'"'+(P?",ctx:{"+P.slice(0,-1)+"}":"")+"},",h,e&&p||0],T.push(J),v&&(S.push(D),(D=J)[7]=b)):u&&(y(u!==(m=D[0])&&m&&"else"!==m),D[7]=C.substring(D[7],d),D=S.pop()),y(!D&&u),T=D[3]}),F(C.length),(b=e[e.length-1])&&y(""+b!==b&&+b[7]===b[7]&&b[0]),function t(e,n){var i,o,a,s,r,c,l,u,d,h,m,p,f,g,P,v,C,_,F,y="",J={},I=e.length;n&&(n.allowCode&&(J.allowCode=A),n.debug&&(J.debug=A),g=n.bnds,v=n.tmpls);for(o=0;o<I;o++)a=e[o],(i="")+a===a?i='ret+="'+a+'";':"*"===(h=a[0])?i=""+a[1]:(m=a[1],p=a[2],_=a[3],f=a[4],r=a[5],P=a[6],F=a[7],_&&(C=V(F,J),t(_,C),v.push(C)),P&&(g.push(P),P=g.length),d=d||-1<f.indexOf("view"),r&&(r="try{prm="+p+";hsh={"+r+'};}catch(e){prm="";hsh={};}\n',p="prm"),i+=r+"ret+="+(":"===h?"html"!==m||P?m||P?(u=A,'c("'+m+'",view,this,'+f+P+","+p+");"):(l=A,"(v="+p+')!=u?v:"";'):(c=A,"h("+p+");"):(s=A,'t("'+h+'",view,this,'+(_?v.length:'""')+","+f+P+(p?",":"")+p+");"))),y+="\n"+i
;y=R+(r?"prm,hsh,":"")+(l?"v,":"")+(s?"t=j._tag,":"")+(u?"c=j._cnvt,":"")+(c?"h=j.converters.html,":"")+'ret="";\n'+(M.tryCatch?"try{\n":"")+(J.debug?"debugger;":"")+y+"\nreturn ret;\n"+(M.tryCatch?"\n}catch(e){return j._err(e);}":"");try{y=new Function("data, view, j, u",y)}catch(t){Y("Compiled template code:\n\n"+y)}n&&(n.fn=y);return y}(e,t)}function Z(g,P){var v,C={},_=0,F=J,y=J;return P.expr=g.replace(w,"$1"),(g+" ").replace(n,function(t,e,n,c,i,o,a,s,r,l,u,d,h,m,p,f){if(i=i||"",n=n||e||u,c=c||s,r=r||p||"",!o)return y?(y=!d)?t:'"':F?(F=!h)?t:'"':(n?(_++,n):"")+(f?_?"":v?(v=J,"\b"):",":a?(_&&Y(g),v=A,"\b"+c+":"):c?c.split("^").join(".").replace(I,function(t,e,n,i,o,a,s){if(e&&(P.push(c),"."!==e)){var r=(n?'view._hlp("'+n+'")':i?"view":"data")+(s?(o?"."+o:n?"":i?"":"."+e)+(a||""):(s=n?"":i?o||"":e,""));return r="view.data"===(r+=s?"."+s:"").slice(0,9)?r.slice(5):r}return t})+(r?(C[++_]=A,r):i):i||(m?(C[_--]=J,m+(r?(C[++_]=A,r):"")):l?(C[_]||Y(g),","):e?"":(y=d,F=h,'"')));Y(g)})}
function X(t){return g[t]||(g[t]="&#"+t.charCodeAt(0)+";")}function tt(t,e){return t&&t!==e?e?L(L({},e),t):t:e&&L({},e)}}(this,this.jQuery),function(e){!function(t){function c(t,e){if(!t)return e;for(var n=t.firstChild;n;)e.push(n),n=(t=n).nextSibling;return e}e.walkDomTree=function(t,e,n){for(var i,o,a={},s=[t];0<s.length;){var r=s.shift();r&&("none"!==(o=(i=r.nodeType===Node.ELEMENT_NODE)?getComputedStyle(r):a).display&&(e(r,o)?n&&n(r):i&&c(r,s)))}}}(),function(t){var f=["INPUT","TEXTAREA","SELECT"],g="CANVAS",P=Node.TEXT_NODE;function v(t){return!!t&&!/^\s*$/.test(t)}function C(t,e,n){var i=t.getBoundingClientRect();return _({content:e,type:"text",color:n.color,fontSize:n.fontSize,input:"INPUT"===t.tagName||"SELECT"===t.tagName,textAlign:n.textAlign,lineHeight:n.lineHeight,whiteSpace:n.whiteSpace},i)}function _(t,e){return t.top=e.top,t.left=e.left,t.height=e.height,t.width=e.width,t}function r(t,o){return t.replace(/{([^\}]+)\}/g,function(t,e){var n;if("?"===e.charAt(0)){
e=e.substr(1);var i=/<([^>]+)>/.exec(e);return 2!=i.length?"":null==(n=o[i[1]])?"":e.replace(i[0],n)}return null==(n=o[e])?"":n})}t.transFilter=function(t,e,n){var i,o,a,s,r,c,l,u,d,h=e.tagName,m=!0;if(h&&(r=(s=n).backgroundColor.replace(/\s+/g,""),-1!==s.backgroundImage.indexOf("url(")||-1===r.indexOf("transparent")&&-1===r.indexOf("255,255,255")&&-1===r.indexOf("0,0,0,0"))&&t.push((i=n,o=e.getBoundingClientRect(),_({type:"bg",background:(a=i).backgroundColor+" "+a.backgroundImage+" "+a.backgroundRepeat+" "+a.backgroundAttachment+" "+a.backgroundPosition+" / "+a.backgroundSize+" "+a.backgroundOrigin+" "+a.backgroundClip},o))),-1!==f.indexOf(h)){var p=function(t){var e=null;switch(t.tagName){case"INPUT":switch(t.type){case"checkbox":case"radio":e=t.checked+"";break;default:e=t.value}break;case"SELECT":e=t.options[t.selectedIndex].text;break;case"TEXTAREA":e=t.value}return e}(e);v(p)&&t.push(C(e,p,n))}else g===h?t.push((d=(u=e).getBoundingClientRect(),_({content:u.toDataURL(),type:"img"
},d))):"IMG"===h?t.push((l=(c=e).getBoundingClientRect(),_({content:c.src,type:"img"},l))):e.nodeType===P?v(e.nodeValue)&&t.push(C(e.parentNode,e.nodeValue,getComputedStyle(e.parentNode))):m=!1;return m},t.transToHtml=function(t,e,n,i,o,a){var s="";return t.forEach(function(t){t.top=t.top-i,t.left=t.left-o,"text"===t.type?(t.input&&(t.lineHeight=t.height+"px"),s+=r("<div class=\"abs\" style='top: {top}px; left: {left}px; height: {height}px; width: {width}px;color:{color}; text-align:{textAlign};font-size:{fontSize};white-space:{whiteSpace};{?line-height:<lineHeight>;}'>{content}</div>",t)):"img"===t.type?s+=r('<img class="abs" style=\'top: {top}px; left: {left}px; height: {height}px; width: {width}px;\' src="{content}"/>',t):"bg"===t.type&&(s+=r("<div class=\"abs\" style='top: {top}px; left: {left}px; height: {height}px; width: {width}px; background:{background};'></div>",t))}),function(t){var n=Array.prototype.slice.call(arguments);return n.shift(),t.replace(/{(\d+)\}/g,function(t,e){
return n[e]||""})}('<!DOCTYPE html><html><head lang="en"><meta charset="UTF-8"><style>body,html{height:{0};width:{1};font-family:"Microsoft Yahei","微软雅黑"; -ms-overflow-style: -ms-autohiding-scrollbar;} html::-webkit-scrollbar{ display: none;} div{word-break: break-all;} .abs{position: absolute;} *{margin: 0;padding: 0;}</style></head><body>{2}</body></html>',n+"px",e+"px",s)},t.transFillTmpl=r}(e),e.extractHtml=function(t){if(!t||t.nodeType!==Node.ELEMENT_NODE)return console.warn("invalid dom to extract");var e=[];this.walkDomTree(t,this.transFilter.bind(null,e));var n=t.getBoundingClientRect();return{height:t.scrollHeight,width:t.scrollWidth,html:this.transToHtml(e,t.scrollWidth,t.scrollHeight,n.top-t.scrollTop,n.left-t.scrollLeft,n.bottom)}},e.htmlToJpg=function(t,e){var n=this.extractHtml(document.getElementById(t));return PJF.communication.HtmlToJpg(n.html,n.width+5,n.height+5,e)}}(PJF.html.domTrans={}),PJF.namespace("PJF.ui"),PJF.ui.component=function(conf){
if(this.validateParam(conf)){var visible=!0;if(void 0!==conf.accessControl&&(visible=eval(conf.accessControl)),!visible)return void $("#"+conf.dom).hide();this.params=conf,this.id=conf.id,"string"==typeof conf?this.com=$("#"+conf):"string"==typeof conf.dom&&(this.com=$("#"+conf.dom)),this.id||(this.id=this.generateId()),this.com&&(this.com.attr("componentId",this.id),this.com.attr("componentType",this.getClassName()));var beforeInitTime=(new Date).getTime();this.init(conf),PJF.ui.componentMgr.reg(this)}},PJF.apply(PJF.ui.component.prototype,{init:function(){},getId:function(){return this.id},validateParam:function(){return!0},isDisabled:function(){return!1},isReadOnly:function(){return!1},isDisplay:function(){return!0},show:function(){this.com.show()},hide:function(){this.com.hide()},setKey:function(t){t.keyIndex&&t.keyScope?(this.params.keyIndex=t.keyIndex,this.params.keyScope=t.keyScope,PJF.ui.componentMgr.reg(this)):alert("请同时传入keyScope和keyIndex!")},destroy:function(){
this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null},generateId:function(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0,o=0;o<36;o++)8==o||13==o||18==o||23==o?n[o]="-":14==o?n[o]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[o]=e[19==o?3&t|8:t]);return n.join("").replace(/-/g,"")},focus:function(){this.com.focus()},getClassName:function(){return"PJF.ui.component"},focusable:function(){return!1},display:function(t){t?this.com.show():this.com.hide()},setAreaKeyBoardFlag:function(t){this.areaKeyBoardFlag=this.areaKeyBoardFlag||{isDisplay:!0,isDisable:!1,isReadonly:!1},PJF.apply(this.areaKeyBoardFlag,t)},isAreaKeyBoardValid:function(){return this.areaKeyBoardFlag=this.areaKeyBoardFlag||{isDisplay:!0,isDisable:!1,isReadonly:!1},this.areaKeyBoardFlag.isDisplay&&!this.areaKeyBoardFlag.isDisable&&!this.areaKeyBoardFlag.isReadonly}}),PJF.ui.componentMgr=function(){
var s=new PJF.util.Collection;return{get:function(t){return s.item(t)},reg:function(t){s.containsKey(t.getId())&&console.log(resource.REG_EXIST_ID_INFO+t.getId()+resource.REG_EXIST_ID_INFO1),s.add(t.getId(),t),t.params.noDestroy||PJF.event.publish("onCompCreated",t)},remove:function(t){s.removeKey(t)},clear:function(){s.clear()},getAll:function(n){var i={};return s.eachKey(function(t,e){n?1==$("#"+n).find('[componentid="'+t+'"]').length&&(i[t]=e):i[t]=e}),i},getOuterAll:function(t){var a={};return function t(e){if(e.is("[componentid]")){var n=e.attr("componentid");a[n]=s.item(n)}else for(var i=e.children(),o=0;o<i.length;o++)t($(i[o]))}($("#"+t)),a}}}(),PJF.namespace("PJF.communication"),PJF.communication.validateAjaxReqParams=function(t,e){return!0},PJF.communication.prepareAjaxReqParams=function(conf,params){var myData={};conf.data&&(myData="string"==PJF.util.getType(conf.data)?eval("("+conf.data+")"):conf.data,myData.REQ_LANG=myData.REQ_LANG||CLIENT_LANGUAGE),
conf.safe&&("string"==PJF.util.getType(myData.jsonData)?myData.jsonData=eval("("+myData.jsonData+")"):myData.jsonData=myData.jsonData||{},PJF.communication.addParam(myData.jsonData),(conf.noRoleTransaction||"noRoleSimpleTransaction"==myData._fw_service_id)&&(myData.jsonData.RL_IDS=[]),myData.jsonData=PJF.util.json2str2(myData.jsonData)),"noRoleSimpleTransaction"==myData._fw_service_id&&(myData._fw_service_id="simpleTransaction"),conf.data=myData,conf.async=!1!==conf.async},PJF.communication.beforeAjaxReq=function(t,e,n){return!0},PJF.communication.afterAjaxReq=function(t,e,n){return!0},PJF.communication.sendAjaxReq=function(i,t,e){$.ajax({url:i.url,dataType:i.dataType||PJF.constants.AJAX_DATA_TYPE,data:t,async:i.async,traditional:i.traditional,type:i.type||PJF.constants.AJAX_METHOD,headers:i.headers||{},timeout:i.timeOut||PJF.constants.AJAX_TIMEOUT,success:function(t,e,n){i.success(t,e,n)},error:function(t,e,n){console.log(JSON.stringify(t.statusCode())),
i.failure?i.failure(t,e,n):"timeout"==e?PJF.configuration.ajaxTimeOut():"parsererror"==e?PJF.configuration.ajaxParseError():PJF.configuration.ajaxFailure()},complete:function(){i.complete&&i.complete(),PJF.communication.afterAjaxReq(i,t,e)}})},PJF.communication.ajax=function(t){var e={};if(!1!==PJF.communication.validateAjaxReqParams(t,e)){var n=PJF.communication.prepareAjaxReqParams(t,e)||t.data;if(!1!==PJF.communication.beforeAjaxReq(t,n,e))return PJF.communication.sendAjaxReq(t,n,e)}},PJF.communication.validateCPSJsonReqParams=function(t,e){if(!t.fwServiceId||!t.fwTranId||!t.success)return alert("PJF.communication.cpsJsonReq参数不正确!当前参数为:fwServiceId="+t.fwServiceId+",fwTranId="+t.fwTranId+",success="+t.success),!1;PJF.constants.lastTransId=t.fwTranId},PJF.communication.prepareCPSJsonReqParams=function(t,e){return t.pjfReSend?delete t.pjfReSend:PJF.communication.cleanResource(),PJF.communication.ra&&(t.jsonData=PJF.communication.ra.copyRefuseInfo(t.jsonData)),
e.copyOfConf=PJF.apply({},t),PJF.communication.setEcpJsonParam(t.fwServiceId,t.fwTranId,t.jsonData,!0,t.encrypt,t.sqlId,t.fmtPrintId,t)},PJF.communication.beforeCPSJsonReq=function(e,n,i){function o(){e.mask?i.ajaxMask=new PJF.ui.loading({dom:e.mask,text:e.loadingText}):e.maskAll&&(i.ajaxMask=new PJF.ui.loading({maskBody:!0,text:e.loadingText}))}var t=e.elecSignParam||{};return!t.ootcSign||PJF.communication.elecSign.getTelclrFlag()||PJF.communication.elecSign.canElecSign()?t.fmtPrintId&&PJF.communication.elecSign&&!t.noNeedProtocolSign?(i.copyOfConf.elecSignParam.noNeedProtocolSign=!0,PJF.communication.elecSign.protocolSign({fmtPrintId:t.fmtPrintId,jsonData:e.jsonData,agentName:t.agentName,customerName:t.customerName,onetime:t.onetime,callback:function(t){0==t.status&&(i.copyOfConf.elecSignParam.notConfirm=e.elecSignParam.notConfirm=t.notConfirm||t.notAttnProtocol,i.copyOfConf.elecSignParam.elecSignUploadData=e.elecSignParam.elecSignUploadData=t.uploadProtocolList,o(),
PJF.communication.sendCPSJsonReq(e,n,i))}}),!1):(o(),!0):(new PJF.ui.messageBox({style:"warning",title:"警告",content:"系统无法执行交易，请开通互动确认或电子签名开关"}),!1)},PJF.communication.sendCPSJsonReq=function(conf,data,params){var beginTime=(new Date).getTime();return $.ajax({url:conf.url||PJF.constants.DEFAULT_ACTION,dataType:conf.dataType||PJF.constants.AJAX_DATA_TYPE,data:data,traditional:conf.traditional,async:!1!==conf.async,type:PJF.constants.AJAX_METHOD,timeout:conf.timeOut||PJF.constants.AJAX_TIMEOUT,success:function(data){if(params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=void 0),data)if("string"==typeof data&&(data=eval("("+data+")")),data.BK_STATUS&&data.BK_STATUS==PJF.constants.BK_CODE_SUCCESS){if(data._COMMON&&data._COMMON.P2S_EVT_TRACE_ID&&(PJF.loadResource.PJF_LOAD_RESOURCES_CONF.sysEvtTraceId=data._COMMON.P2S_EVT_TRACE_ID),
data.BK_CODE&&(0==data.BK_CODE.indexOf("IOK")||"0"==data.BK_CODE.indexOf("WOK")||"999999999999"==data.BK_CODE)&&PJF.constants.TIP_WARNING&&(PJF.constants.floatDiv?PJF.constants.floatDiv.setMessage(data.BK_DESC):PJF.constants.floatDiv=new PJF.ui.floatDiv({msg:data.BK_DESC})),conf.raTellSuccRst&&conf.raTellSuccRst(data),conf.elecSignParam)return void PJF.communication.afterCpsSucc(conf,data,params);conf.success(data,conf.authUserInfo)}else data._curr_val_key||data._val_page?(PJF.communication.handleAuthResource(data,params.copyOfConf),PJF.loadResource.PJF_LOAD_RESOURCES_CALLBACK=function(t,e){PJF.communication.cpsJsonReqResend(t,e)}):data._similar_trans_status?PJF.communication.handleSimilarTrans(data,params.copyOfConf):conf.failure(data);else alert("提示：无返回数据！")},error:function(t,e,n){console.log(JSON.stringify(t.statusCode())),params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=void 0),
"timeout"==e?PJF.configuration.ajaxTimeOut(conf.failure):"parsererror"==e?PJF.configuration.ajaxParseError(conf.failure):PJF.configuration.ajaxFailure(conf.failure)},complete:function(t,e){params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=void 0),conf.complete&&conf.complete(t,e),console.log("cps ajax共耗时"+((new Date).getTime()-beginTime)+"ms,参数为:"+conf.fwTranId+","+conf.fwServiceId+(conf.sqlId?","+conf.sqlId:"")),PJF.communication.afterCPSJsonReq(conf,data,params)}})},PJF.communication.afterCpsSucc=function(a,s,t){var r;function c(){if(s.PRINT_VOUCHER_STRING_MAP&&s.needSignFlag){var t=[];for(var e in s.PRINT_VOUCHER_STRING_MAP)s.PRINT_VOUCHER_STRING_MAP[e].paperPrintFlag=!0,s.PRINT_VOUCHER_STRING_MAP[e].confirmNoSign=!0,t.push(e);0<t.length&&PJF.communication.elecSign.uploadSign({CONFIRM_NO_SIGN_DATA:{sysEvtTraceId:r,voucherIDS:t.join(",")}})}a.success(s,a.authUserInfo)}function e(){if(s.PRINT_VOUCHER_STRING_MAP&&s.needSignFlag)if(a.elecSignParam.ootcSignUploadData){
a.elecSignParam.ootcSignUploadData.sysEvtTraceId=r;var t=[],e=[];for(var n in s.PRINT_VOUCHER_STRING_MAP)s.PRINT_VOUCHER_STRING_MAP[n].elecSignFlag&&t.push(n),s.PRINT_VOUCHER_STRING_MAP[n].paperPrintFlag&&e.push(n);if(0<t.length||0<e.length){var i;a.elecSignParam.ootcSignUploadData.voucherIDS=t.join(","),0<e.length&&(i={sysEvtTraceId:r,voucherIDS:e.join(",")});var o=a.elecSignParam.ootcSignUploadData.signPicData;PJF.communication.elecSign.uploadSign({SIGN_DATA:a.elecSignParam.ootcSignUploadData,CONFIRM_NO_SIGN_DATA:i,PRINT_VOUCHER_STRING_MAP:s.PRINT_VOUCHER_STRING_MAP,callback:function(t){if(0==t.status){for(var e in s.PRINT_VOUCHER_STRING_MAP)s.PRINT_VOUCHER_STRING_MAP[e].elecSignFlag&&(s.PRINT_VOUCHER_STRING_MAP[e].elecSignPicBase64=o);a.success(s,a.authUserInfo)}else c()}})}else a.success(s,a.authUserInfo)}else!1===a.elecSignParam.ootcSignUploadData?c():PJF.communication.elecSign.oneTimeSign($.extend({},a.elecSignParam,{data:s,callback:function(){a.success(s,a.authUserInfo)}
}));else a.success(s,a.authUserInfo)}s._COMMON&&(r=s._COMMON.P2S_EVT_TRACE_ID||s._COMMON.SYS_EVT_TRACE_ID),PJF.communication.elecSign.canElecSign()?a.elecSignParam.elecSignUploadData?(a.elecSignParam.elecSignUploadData.sysEvtTraceId=r,PJF.communication.elecSign.uploadSign({SIGN_DATA:a.elecSignParam.elecSignUploadData,callback:function(t){2==t.status?c():0==t.status?e():1==t.status&&e()}})):a.elecSignParam.notConfirm?(a.elecSignParam.notConfirm.sysEvtTraceId=r,PJF.communication.elecSign.uploadSign({CONFIRM_NO_SIGN_DATA:a.elecSignParam.notConfirm,callback:function(t){c()}})):e():c()},PJF.communication.afterCPSJsonReq=function(t,e,n){},PJF.communication.cpsJsonReq=function(t){var e={};if(!1!==PJF.communication.validateCPSJsonReqParams(t,e)){var n=PJF.communication.prepareCPSJsonReqParams(t,e);if(!1!==PJF.communication.beforeCPSJsonReq(t,n,e))return PJF.communication.sendCPSJsonReq(t,n,e)}},PJF.communication.handleSimilarTrans=function(data,copyOfConf){
"SUCC"==data._similar_trans_status?new PJF.ui.messageBox({buttonText:["继续交易","取消"],closable:!1,style:"confirm",title:"疑似重复交易",content:data._flow_guide,cancel:function(){PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:"ST"})},ok:function(){if(copyOfConf.atchBtchNo&&PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(copyOfConf.atchBtchNo=uNo[1])}var tempJsonData=copyOfConf.jsonData;tempJsonData?"string"==typeof tempJsonData&&(tempJsonData=eval("("+tempJsonData+")")):tempJsonData={},"string"!=typeof data._curr_val_no||isNaN(data._curr_val_no)||(data._curr_val_no=parseInt(data._curr_val_no,10)),"number"==typeof data._curr_val_no&&(tempJsonData._curr_val_no=data._curr_val_no+1),copyOfConf.jsonData=PJF.util.json2str(tempJsonData),PJF.communication.cpsJsonReq(copyOfConf)}}):"NOSU"==data._similar_trans_status&&new PJF.ui.messageBox({style:"warning",title:"交易可能重复",content:data._flow_guide,fn:function(){
PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:"ST"})}})},PJF.communication.handleAuthResource=function(data,copyOfConf,cancelCallback){PJF.auth._lastAuthData=data,copyOfConf.originalSuccess&&(copyOfConf.success=copyOfConf.originalSuccess,delete copyOfConf.originalSuccess),copyOfConf.originalFailure&&(copyOfConf.failure=copyOfConf.originalFailure,delete copyOfConf.originalFailure),PJF.loadResource.PJF_LOAD_RESOURCES_CONF={},PJF.apply(PJF.loadResource.PJF_LOAD_RESOURCES_CONF,copyOfConf);var isAjax=!copyOfConf.fwServiceId;if(!isAjax&&copyOfConf.atchBtchNo&&PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(PJF.loadResource.PJF_LOAD_RESOURCES_CONF.atchBtchNo=uNo[1])}var tempJsonData=isAjax?copyOfConf.data.jsonData:copyOfConf.jsonData;tempJsonData?"string"==typeof tempJsonData&&(tempJsonData=eval("("+tempJsonData+")")):tempJsonData={};var ootcData=tempJsonData.ootcData;"IT"==data._curr_val_key&&(tempJsonData._inte_trl_auth=1),
"HW"==data._curr_val_key&&(tempJsonData.AUTH_AUDIT_TAG=1),"CP"==data._curr_val_key&&(tempJsonData._customer_pwd_input=1),"number"==typeof data._auth_step_no&&(tempJsonData._auth_step_no=data._auth_step_no+1),"number"==typeof data._curr_val_no&&(tempJsonData._curr_val_no=data._curr_val_no);var valData=data._val_data||{};if("string"==typeof valData&&(valData=eval("("+valData+")")),"dynamic"==data.AuthCategory&&valData.CCBS_AUTH_CODE&&(tempJsonData.CCBS_AUTH_CODE=valData.CCBS_AUTH_CODE,PJF.communication.client.isInP2()&&(tempJsonData.autherPwd=PJF.communication.client.encrypt0x88(16)[1])),tempJsonData._auth_info=$.extend(!0,{},tempJsonData._auth_info,{AHN_INFOS:[]}),valData.dynAuths){var dynArray=[];for(var i in valData.dynAuths)dynArray.push({AHN_CD:valData.dynAuths[i].authCode});tempJsonData._auth_info.AHN_INFOS=tempJsonData._auth_info.AHN_INFOS.concat(dynArray)}if(tempJsonData=PJF.util.json2str(tempJsonData),
isAjax?PJF.loadResource.PJF_LOAD_RESOURCES_CONF.data.jsonData=copyOfConf.data.jsonData=tempJsonData:PJF.loadResource.PJF_LOAD_RESOURCES_CONF.jsonData=copyOfConf.jsonData=tempJsonData,PJF.loadResource._val_msg=data._val_msg,PJF.loadResource.PJF_LOAD_RESOURCES_CONF.fwTranId=isAjax?copyOfConf.data.transaction_id:copyOfConf.fwTranId,PJF.loadResource.AUTH_SERVER_RTDATA=data,PJF.loadResource.AUTH_VAL_DATA=valData,valData._red_columns)for(var i in valData._red_columns){var domId=$.trim(valData._red_columns[i]);if(domId)if(PJF.ui.componentMgr.get(domId))PJF.ui.componentMgr.get(domId).addHighlight();else for(var selector=["#"+domId+":input:visible","#"+domId+" > input:visible","#"+domId+" + > input:visible","#"+domId+" +:input:visible",'[name="'+domId+'"]:visible'],i=0;i<selector.length;i++){var result=$(selector[i]);if(0<result.length){result.addClass("validatebox-tipcolor error-border");break}}}
if("2"==PJF.loadResource.CHANGE_SA)PJF.communication.handleSAIT(data,cancelCallback);else if("IT"==data._curr_val_key||"SA"==data._curr_val_key||!data._curr_val_key&&data._val_page){if("IT"==data._curr_val_key&&ootcData&&(PJF.communication.ootcTemplate(ootcData),""==PJF.communication.client.OOTC_CONTENT))return;PJF.communication.client.OOTC_CONTENT=$.trim(PJF.communication.client.OOTC_CONTENT),"1"==data.Test_Run&&"SA"==data._curr_val_key?"CA"==PJF.loadResource.Test_Run_Flag?PJF.loadResource.CA_TWICE&&PJF.communication.handleTwiceCA(data):"SA"==PJF.loadResource.Test_Run_Flag?PJF.communication.handleSAIT(data,cancelCallback):new PJF.ui.messageBox({style:"confirm",closable:!1,title:"授权提示",content:"该交易处于远程集中授权试运行期，确定将进行远程集中授权，取消将进行本地授权",ok:function(){PJF.loadResource.PJF_LOAD_RESOURCES_CONF.authResourceType="CA",PJF.loadResource.Test_Run_Flag="CA",PJF.communication.handleCA(data)},cancel:function(){PJF.loadResource.Test_Run_Flag="SA",PJF.communication.handleSAIT(data,cancelCallback)}
}):PJF.communication.handleSAIT(data,cancelCallback)}else if("CA"==data._curr_val_key)PJF.loadResource.PJF_LOAD_RESOURCES_CONF.authResourceType="CA",PJF.loadResource.CA_TWICE?PJF.communication.handleTwiceCA(data):PJF.communication.handleCA(data);else if("KA"==data._curr_val_key);else if("RW"==data._curr_val_key)new PJF.ui.messageBox({style:"info",title:resource.AUTH_REVIEW_TITLE,content:data._val_msg,fn:function(){copyOfConf.interceptParams&&copyOfConf.interceptParams.rwCallBack&&copyOfConf.interceptParams.rwCallBack(data)}});else if("HW"==data._curr_val_key){var loading=new PJF.ui.loading({maskBody:!0,text:resource.AJAX_HW_REAUTH});PJF.communication.client.beforeCloseTab=function(){return!1},PJF.communication.client.registerEvent("SQFH_msg_003",function(hwData){PJF.communication.client.beforeCloseTab=function(){return!0},console.log("收到复核消息:"+hwData),hwData=eval("("+hwData+")"),hwData.msgData._event_id==data._event_id&&(loading.destroy(),
"1"==hwData.msgData._val_ret?PJF.communication.cpsJsonReqResend():(new PJF.ui.messageBox({style:"info",title:"",content:hwData.msgData._val_data}),PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:"HW"})))})}else if("AP"==data._curr_val_key)PJF.communication.handleSAIT(data);else if("CP"==data._curr_val_key)PJF.communication.handleSAIT(data);else if("MA"==data._curr_val_key)new PJF.ui.messageBox({style:"warning",title:"交易未上送加密数据",content:"请重新启动员工渠道后重试"});else if("VC"==data._curr_val_key)new PJF.ui.messageBox({style:"warning",title:"错误",content:"验证码过期或输入错误"});else if("IDEN"==data._curr_val_key){if(null==PJF.html.getDom(PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)){var winDiv=document.createElement("div");document.body.appendChild(winDiv),winDiv.setAttribute("id",PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)}new PJF.ui.window({dom:PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID,id:PJF.loadResource.PJF_LOAD_RESOURCES_ID,title:"身份证联网核查",width:850,height:450,showTip:!0,closable:!1,
url:CONTEXT_PATH+data._val_page,onClose:function(){PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:data._curr_val_key})}})}else new PJF.ui.messageBox({style:"warning",title:"后端返回不正确标志",content:data._curr_val_key})},PJF.communication.handleTwiceCA=function(t){PJF.auth.startAuth()?(PJF.communication.ra.initLoading(),PJF.communication.ra.tellAuthMoreRA(PJF.loadResource.PJF_LOAD_RESOURCES_CA_BACKDATA,t)):new PJF.ui.messageBox({title:"禁止进行授权交易",style:"warning",content:"当前存在处于授权等待中的交易，前先完成前序交易！"})},PJF.communication.handleSAIT=function(data,cancelCallback){var conf=PJF.loadResource.PJF_LOAD_RESOURCES_CONF,_closable=!0;if(null==PJF.html.getDom(PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)){var winDiv=document.createElement("div");document.body.appendChild(winDiv),winDiv.setAttribute("id",PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID)}("IT"==data._curr_val_key||"CA"==data._curr_val_key)&&conf.interceptParams&&conf.interceptParams.beforeHandleSA&&conf.interceptParams.beforeHandleSA(data),
"AP"==data._curr_val_key&&conf.interceptParams&&conf.interceptParams.beforeHandleAP&&conf.interceptParams.beforeHandleAP(data);var url=data._val_page;if("CA"==data._curr_val_key){var valData=data._val_data||{};"string"==typeof valData&&(valData=eval("("+valData+")")),url=valData._TO_SAME_URL||url}var title=resource.AUTH_WINDOW_TITLE[0];"IT"==data._curr_val_key?(title=resource.AUTH_WINDOW_TITLE[1],conf.elecSignParam&&conf.elecSignParam.ootcSign&&PJF.communication.elecSign.canElecSign()&&PJF.communication.elecSign.getElecSignCapability()&&(url=PJF.constants.OOTC_SIGN_URL,_closable=!1)):"CP"==data._curr_val_key?title=resource.AUTH_WINDOW_TITLE[2]:"AP"==data._curr_val_key&&(title=resource.AUTH_WINDOW_TITLE[3]),"SA"!=data._curr_val_key||PJF.auth.startAuth()?new PJF.ui.window({dom:PJF.loadResource.PJF_LOAD_RESOURCES_DOM_ID,id:PJF.loadResource.PJF_LOAD_RESOURCES_ID,title:title,left:0,position:"fixed",fixPosition:!0,top:(window.innerHeight||document.documentElement.height)-300,width:420,
height:300,showTip:!0,closable:_closable,url:CONTEXT_PATH+url,cache:!1,onClose:function(){PJF.auth.endAuth(),PJF.event.publish(PJF.loadResource.PJF_AUTH_FAILURE,{type:data._curr_val_key}),cancelCallback&&cancelCallback()}}):new PJF.ui.messageBox({title:"禁止进行授权交易",style:"warning",content:"当前存在处于授权等待中的交易，前先完成前序交易！"})},PJF.communication.handleCA=function(t){PJF.auth.startAuth()?(PJF.communication.ra.initLoading(),PJF.communication.client.openAuthPage(t._val_data,"YGQD"),PJF.communication.ra.registerHandler(t)):new PJF.ui.messageBox({title:"禁止进行授权交易",style:"warning",content:"当前存在处于授权等待中的交易，前先完成前序交易！"})},PJF.communication.cpsJsonReqResend=function(authUserInfo,authType){PJF.auth.endAuth(),"1"==PJF.loadResource.CHANGE_SA&&(PJF.loadResource.CHANGE_SA="2");var cpsAuthWin=PJF.ui.componentMgr.get(PJF.loadResource.PJF_LOAD_RESOURCES_ID);cpsAuthWin&&(cpsAuthWin.destroy(),cpsAuthWin=null);var re={};PJF.apply(re,PJF.loadResource.PJF_LOAD_RESOURCES_CONF)
;var tempJsonData=re.fwServiceId?re.jsonData:re.data.jsonData;if(tempJsonData?"string"==typeof tempJsonData&&(tempJsonData=eval("("+tempJsonData+")")):tempJsonData={},re.interceptParams&&re.interceptParams.beforeSaResend){var tmpData=re.interceptParams.beforeSaResend(tempJsonData,authUserInfo,PJF.loadResource.AUTH_VAL_DATA);tempJsonData=tmpData||tempJsonData}if(tempJsonData._auth_info&&tempJsonData._auth_info.AHN_INFOS)for(var i in tempJsonData._auth_info.AHN_INFOS)tempJsonData._auth_info.AHN_INFOS[i].AHN_STFF_ID=authUserInfo.CCB_EmpID,tempJsonData._auth_info.AHN_INFOS[i].AUTH_TYPE=0;if(PJF.loadResource.operIdKey&&authUserInfo&&authUserInfo.CCB_EmpID&&(authUserInfo[PJF.loadResource.operIdKey]=authUserInfo.CCB_EmpID),re.pjfReSend=!0,re.authUserInfo=authUserInfo,re.fwServiceId)authUserInfo&&(PJF.apply(tempJsonData,authUserInfo),re.jsonData=PJF.util.json2str(tempJsonData)),PJF.communication.cpsJsonReq(re);else if(re.data&&re.data.isFromCrossDomain){if(delete re.data.isFromCrossDomain,
authUserInfo){if(PJF.apply(tempJsonData,authUserInfo),PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(tempJsonData.ATCH_BTCH_NO=uNo[1])}re.data.jsonData=tempJsonData}re.data=PJF.util.json2str(re.data),PJF.communication.crossDomainReq(re)}else{if(authUserInfo&&(PJF.apply(tempJsonData,authUserInfo),re.data.jsonData=PJF.util.json2str(tempJsonData)),PJF.communication.client.isInP2()){var uNo=PJF.communication.client.getUniqueNo();0==uNo[0]&&(tempJsonData.ATCH_BTCH_NO=uNo[1]),re.data.jsonData=PJF.util.json2str(tempJsonData)}PJF.communication.ajax(re)}},PJF.communication.cleanResource=function(){PJF.loadResource.Already_Run=null,PJF.loadResource.Test_Run_Flag=null,PJF.loadResource.CA_TWICE=null,PJF.loadResource.CHANGE_SA=null},PJF.communication.setEcpJsonParam=function(serviceId,tranId,data,needAdapterId,encryptDatas,sqlId,fmtPrintId,conf){var myData={},enData={};fmtPrintId=fmtPrintId||tranId,conf=conf||{},
myData=PJF.communication.addParam(myData,serviceId),("noRoleSimpleTransaction"==serviceId||conf.noRoleTransaction)&&(myData.RL_IDS=[]);var menuId=conf.menuId||PJF.html.getUrlParam("menuId"),resultData;if(menuId&&(myData._menu_id=menuId),encryptDatas){var dataObj;dataObj=""==data?{}:eval("("+data+")");for(var a=0;a<encryptDatas.length;a++){var key=encryptDatas[a];if(dataObj[key]){var result=PJF.communication.client.encryptParam(dataObj[key]);0==result[0]&&(enData[key]=result[1])}}}if("string"==PJF.util.getType(data)&&""!=data&&(data=eval("("+data+")")),myData.ATCH_BTCH_NO&&data&&(data.ATCH_BTCH_NO=myData.ATCH_BTCH_NO),myData=PJF.apply(myData,data),conf.atchBtchNo&&(myData.ATCH_BTCH_NO=conf.atchBtchNo),PJF.communication.client.isInP2()){try{var telclrFlag=PJF.communication.client.getClientEnv("telclrFlag");telclrFlag&&"true"==telclrFlag[1]&&(myData._inte_trl_enable=1)}catch(t){}
conf.elecSignParam&&conf.elecSignParam.ootcSign&&"pc"==PJF.constants.termType&&PJF.communication.elecSign.canElecSign()&&(myData._inte_trl_enable=1);var tabName=PJF.communication.client.getClientEnv("cuurentMenu.menuName");"0"==tabName[0]&&(myData.TAB_NAME=tabName[1])}if(myData=PJF.apply(myData,enData),!PJF.constants.D2D){var QUOTA_BATCHNO=PJF.html.getUrlParam("batchNo");QUOTA_BATCHNO&&(myData.QUOTA_BATCHNO=QUOTA_BATCHNO)}if("noRoleSimpleTransaction"==serviceId&&(serviceId="simpleTransaction"),resultData=needAdapterId?{adapterId:"ecpJson",_fw_service_id:serviceId,jsonData:PJF.util.json2str2(myData),transaction_id:tranId}:{_fw_service_id:serviceId,jsonData:PJF.util.json2str2(myData),transaction_id:tranId},sqlId&&(resultData._sql_id=sqlId),fmtPrintId&&(resultData.fmtPrintId=fmtPrintId),conf&&(conf.docType&&(resultData.docType=conf.docType),conf.transFlag&&(resultData.transFlag=conf.transFlag),conf.serverFilePath&&(resultData.serverFilePath=conf.serverFilePath),
conf.remotePath&&(resultData.remotePath=conf.remotePath),conf.otherParams))for(var i in conf.otherParams)resultData[i]=conf.otherParams[i];return"undefined"!=typeof CLIENT_LANGUAGE&&(resultData.REQ_LANG=CLIENT_LANGUAGE),resultData},PJF.communication.addParam=function(t,e){if(t){if(t.REQ_LANG=CLIENT_LANGUAGE,PJF.userInfo&&(t.OPER_CODE=PJF.userInfo.userCode,t.OPER_NAME=PJF.userInfo.userName,t.CCBS_ID=PJF.userInfo.ccbsId),PJF.otherInfo&&(t.TOKEN=PJF.otherInfo.token,t.TERMINAL_MAC=PJF.otherInfo.macAddress,t.TERMINAL_IP=PJF.otherInfo.clientIP,PJF.otherInfo.chaType||(PJF.otherInfo.chaType="0101"),t.TXN_ITT_CHNL_CGY_CODE||(t.TXN_ITT_CHNL_CGY_CODE=PJF.otherInfo.chaType),PJF.otherInfo.logicTerminalNo&&(t.LOGIC_TERMINAL_NO=PJF.otherInfo.logicTerminalNo),PJF.otherInfo.chaTypeId&&(t.TXN_ITT_CHNL_ID=PJF.otherInfo.chaTypeId),PJF.otherInfo.seqId&&(t.SCAN_SEQ_ID=PJF.otherInfo.seqId),"pc"==PJF.constants.termType&&(PJF.otherInfo.customerAcctNo&&(t._customer_account_no=PJF.otherInfo.customerAcctNo),
PJF.otherInfo.customerIdenNo&&(t._customer_identity_no=PJF.otherInfo.customerIdenNo),PJF.otherInfo.customerIdenNm&&(t._customer_identity_name=PJF.otherInfo.customerIdenNm)),void 0!==PJF.otherInfo.scp&&(t.CLUSTER_ID=PJF.otherInfo.scp)),PJF.orgInfo&&(t.ORG_SHORT_CNAME=PJF.orgInfo.orgShortCName,PJF.orgInfo.orgShortEName&&(t.ORG_SHORT_ENAME=PJF.orgInfo.orgShortEName),t.ORG_PHYSIC_CLASS=PJF.orgInfo.orgClass,PJF.orgInfo.instLevel1BranchId&&(t.INST_LEVEL1_BRANCH_ID=PJF.orgInfo.instLevel1BranchId),PJF.orgInfo.instSvrlLgPsnID&&(t.BSN_MT_ENT_IDR=PJF.orgInfo.instSvrlLgPsnID),PJF.orgInfo.instSvrlLgPsnNm&&(t.REQ_TENANCY_NAME=PJF.orgInfo.instSvrlLgPsnNm),PJF.orgInfo.lclCcyCd&&(t.LOC_CCY=PJF.orgInfo.lclCcyCd),PJF.orgInfo.ctyRgonCd&&(t.COUN_CD=PJF.orgInfo.ctyRgonCd),PJF.orgInfo.tmzonCd&&(t.CLIENT_TIMEZONE=PJF.orgInfo.tmzonCd)),PJF.roleInfo){if(t.OPER_ROLE=PJF.roleInfo.positionId,PJF.roleInfo.noRepeatRoleAuthInfoList&&PJF.roleInfo.noRepeatRoleAuthInfoList.constructor!==Array){var n=[],i=[]
;for(var o in PJF.roleInfo.noRepeatRoleAuthInfoList)PJF.util.array.indexOf(i,PJF.roleInfo.noRepeatRoleAuthInfoList[o].pstRlId)<0&&(i.push(PJF.roleInfo.noRepeatRoleAuthInfoList[o].pstRlId),n.push(PJF.roleInfo.noRepeatRoleAuthInfoList[o]));PJF.roleInfo.noRepeatRoleAuthInfoList=n}for(var a in t.RL_IDS=[],PJF.roleInfo.noRepeatRoleAuthInfoList)t.RL_IDS.push({pstRlId:PJF.roleInfo.noRepeatRoleAuthInfoList[a].pstRlId});"databaseTransaction"==e&&(t.RL_IDS=[]),t.BRANCH_ID||(t.BRANCH_ID=PJF.roleInfo.orgCode)}if(PJF.communication.client&&PJF.communication.client.isInP2()){var s=PJF.communication.client.getUniqueNo();"array"==PJF.util.getType(s)&&0==s[0]&&(t.ATCH_BTCH_NO=s[1]);var r=PJF.communication.client.getClientEnv("outputLoginBean.orgAncestorInfo.instLevel1BranchId");0==r[0]&&r[1]&&(t.LVL1_BRANCH_ID=r[1]);var c=PJF.communication.client.getClientEnv("outputLoginBean.orgAncestorInfo.instHeadOfficeId");0==c[0]&&(t.HEAD_BRANCH_ID=c[1])}return t._terminal_type=PJF.constants.termType,
PJF.communication.elecSign&&PJF.communication.client&&PJF.communication.client.isInP2()&&PJF.communication.elecSign.addElecParam(t),t}},PJF.communication.getStandardCode=function(i){var t=i.REQ_LANG||CLIENT_LANGUAGE;if(i.lgPsn){var e=i.lgPsn.split(","),n=PJF.orgInfo&&PJF.orgInfo.instSvrlLgPsnID;if(n)for(var o=0,a=e.length;o<a;o++)if(e[o]==n){t+="_"+n;break}}if(i.categoryId){var s,r=!PJF.constants.D2D&&"pc"==PJF.constants.termType&&PJF.communication.client.isInP2();if(r){s=[i.categoryId,i.appId||"00000",i.clcd||"00000",t].join("");var c=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","getStdCode",s)[1];if("0"==c[0]&&c.substr(2)){var l=JSON.parse(c.substr(2));return void(!1===i.async?i.success(l,"success",{}):setTimeout(function(){i.success(l,"success",{})},0))}}var u={};u.categoryId=i.categoryId,i.appId&&(u.appId=i.appId),i.clcd&&(u.clcd=i.clcd),i.sorted&&(u.sorted=i.sorted);var d={};d.REQ_LANG=t,d._fw_service_id="fetchStanderdCodeModelListByParams",
d.jsonClass="com.ccb.model.StandardDataCategory",d.jsonData=PJF.util.json2str(u),PJF.communication.ajax({data:d,async:i.async,url:"ecpJson2Bean.action",success:function(t,e,n){if(r)try{PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","setStdCode",s,JSON.stringify(t))}catch(t){console.log("pc cliet set std cache error:"+t.message)}i.success(t,e,n)}})}else alert("PJF.communication.getStandardCode需要的参数信息不正确!当前参数为:categoryId:"+i.categoryId+",appId:"+i.appId+",clcd:"+i.clcd)},PJF.communication.getOrgDesc=function(t){t&&t.codes&&$.isArray(t.codes)&&0!==t.codes.length&&t.codes[0]?new PJF.communication.ajax({url:"/bosWeb/ecpJson.action",data:{_fw_service_id:"orgTextService",nodeArr:t.codes,REQ_LANG:CLIENT_LANGUAGE},async:t.async,success:t.success,failure:t.failure}):alert("PJF.communication.getOrgDesc没有传入机构号信息!")},PJF.communication.printData=function(t){
var e=t.teminalId,n=t.fileName,i=PJF.util.generateUUid(),o=t.url+"/print/PrintService?IN_teminalId="+e+"&IN_fileName="+n+"&uuid="+i;console.log("PJF.communication.printData统一打印服务URL为:"+o);var a=document.createElement("script");a.type="text/javascript",a.src=o,a.onerror=function(){t.failure&&t.failure()},PJF.communication.printData.callback=t.callback,document.body.appendChild(a)},PJF.communication.crossDomainReq=function(conf){if("string"==typeof conf.data){var dataTmp=eval("("+conf.data+")"),token=PJF.util.getLoginToken();if(token&&dataTmp.jsonData)if("string"==typeof dataTmp.jsonData)try{dataTmp.jsonData=eval("("+dataTmp.jsonData+")"),dataTmp.jsonData._login_tk=token}catch(t){console.info("crossdomain req 添加login token出错:"+t.message)}else dataTmp.jsonData._login_tk=token;PJF.util.getValue(window,"PJF.userInfo.userCode")&&(dataTmp.jsonData&&("object"==typeof dataTmp.jsonData&&(dataTmp.jsonData=PJF.util.jsontostr(dataTmp.jsonData)),
dataTmp.macData=PJF.communication.client.macContent(dataTmp.jsonData)[1]),dataTmp.OPER_CODE=PJF.util.getValue(window,"PJF.userInfo.userCode"),dataTmp._terminal_type=PJF.constants.termType),conf.data=PJF.util.jsontostr(dataTmp)}var copyOfConf=$.extend(!0,{},conf);"string"==typeof copyOfConf.data&&(copyOfConf.data=eval("("+copyOfConf.data+")")),copyOfConf.data.isFromCrossDomain=!0;var success=function(data){if("string"!=typeof data||-1==data.indexOf("_curr_val_key")&&-1==data.indexOf("_val_page"))if(conf.elecSignParam){var datatmp=data||{};"string"==typeof datatmp&&(datatmp=eval("("+datatmp+")")),datatmp.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?PJF.communication.afterCpsSucc(copyOfConf,datatmp,{}):conf.success(data)}else conf.success(data);else data=data||{},"string"==typeof data&&(data=eval("("+data+")")),PJF.communication.handleAuthResource(data,copyOfConf)},url=conf.url;if(conf.data){var result=PJF.communication.client.sendHttp(url,conf.data)
;0==result[0]?success(result[1]):conf.failure(result[1])}else{var result=PJF.communication.client.sendHttp(url);0==result[0]?success(result[1]):conf.failure(result[1])}},PJF.communication.getStandardCodeDescByValue=function(i){if(i.categoryId&&i.value){var o,a=!PJF.constants.D2D&&"pc"==PJF.constants.termType&&PJF.communication.client.isInP2();if(a){o=[i.categoryId,i.appId||"00000",i.clcd||"00000",i.value].join("");var t=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","getStdCode",o)[1];if("0"==t[0]&&t.substr(2)){var e=JSON.parse(t.substr(2));return void i.success(e,"success",{})}}var n={};n.category=i.categoryId,i.appId&&(n.appId=i.appId),i.clcd&&(n.clcd=i.clcd),i.value&&(n.value=i.value);var s={_fw_service_id:"getDataItemNameByCategoryAndItem",jsonClass:"com.ccb.model.StandardDataCategory"};s.jsonData=PJF.util.json2str(n),PJF.communication.ajax({data:s,async:!1,url:"ecpJson.action",success:function(t,e,n){if(a&&t)try{
PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","setStdCode",o,JSON.stringify(t))}catch(t){console.log("pc cliet set std value cache error:"+t.message)}i.success(t,e,n)}})}else alert("必须输入categoryId和value")},PJF.communication.printServiceReq=function(t){if(t.success){t.funId||(t.funId="genPrintString"),t.voucherId||(t.voucherId="all"),t.jsonData||(t.jsonData={});var e=!1;t.async&&(e=t.async);var n={_fw_service_id:"FormatPrintService"};n.funId=t.funId,n.voucherId=t.voucherId,n.branchId=PJF.userInfo.orgCode,t.version&&(n.version=t.version),n.jsonData=PJF.util.json2str(t.jsonData),PJF.communication.ajax({data:n,async:e,url:"ecpJson.action",success:t.success})}else alert("PJF.communication.printServiceReq需要的参数信息不正确!")},PJF.communication.getVoucherPrintContent=function(t){if(t.success&&t.fmtPrintId&&t.jsonData){var e=!1;t.async&&(e=t.async),t.printType=void 0===t.printType?1:t.printType;var n={_fw_service_id:"voucherPrintServiceReq"}
;n.unitedVoucherId=t.fmtPrintId,n.jsonData=PJF.util.json2str(t.jsonData),n._print_type=t.printType,n._elec_seal_switch=PJF.communication.elecSign.canElecSign(),n._elec_seal=PJF.communication.elecSign.canElecSeal(),PJF.communication.ajax({data:n,async:e,url:"ecpJson.action",success:t.success})}else alert("PJF.communication.getVoucherPrintContent需要的参数信息不正确!")},PJF.communication.getServerTime=function(n,t){n=n||"yyyyMMdd";var i=null,e="";t?e=t:PJF.orgInfo&&PJF.orgInfo.instSvrlLgPsnID&&(e=PJF.orgInfo.instSvrlLgPsnID);var o=!PJF.constants.D2D&&"pc"==PJF.constants.termType&&PJF.communication.client.isInP2()&&e&&!t,a="yyyyMMdd"==n&&o,s="stm"==PJF.constants.termType&&!t,r="yyyyMMdd"==n&&s;if(a)try{if("0"==(i=PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","getServerTime")[1])[0]&&i.substr(2))return i.substr(2)}catch(t){console.log("pc client get servertime cache error: "+t.message)}else if(r){if(i=PJF.cache.getServerTime())return i}
return(o||s)&&(n+=",yyyyMMddHHmmss"),PJF.communication.ajax({url:"ecpJson.action",async:!1,data:{_fw_service_id:"getServerTime",timePattern:n,legalPerson:e},success:function(t){if(i=t,(o||s)&&i&&i.currentTime)try{var e=i.currentTime.substr(n.length-15).substr(1);i.currentTime=i.currentTime.substr(0,n.length-15),o?PJF.communication.client.doCommonCommand("InvokeSptCommandHandler","cltFuns.b.dat","setServerTime",e):s&&PJF.cache.setServerTime(e)}catch(t){console.log("set servertime cache error: "+t.message)}},failure:function(t,e,n){console.log("获取系统时间失败,错误原因:"+e)}}),i?i.currentTime:i},PJF.communication.convertDateString=function(t){var e,n,i=arguments[1],o=arguments[2]||"yyyyMMdd HH:mm:ss",a=arguments[3]||o,s=arguments[4]||PJF.util.getValue(PJF,"orgInfo.instSvrlLgPsnID")||"CN000";switch(t){case 1:n="convertDateStringToLegalPerson",e=[a,s];break;case 2:n="convertDateStringToBaseTz",e=[s,a]}return PJF.communication.ajax({traditional:!0,url:"ecpJson.action",async:!1,data:{_fw_service_id:n,
arg0:i,arg1:o,args:e},success:function(t){result=t},failure:function(t,e,n){console.log("获取系统时间失败,错误原因:"+e)}}),result?result.i18nTime:result},PJF.communication.convertDateStringToLegalPerson=function(t,e,n,i){return PJF.communication.convertDateString.apply(window,Array.prototype.concat.apply([1],arguments))},PJF.communication.convertDateStringToBaseTz=function(t,e,n,i){return PJF.communication.convertDateString.apply(window,Array.prototype.concat.apply([2],arguments))},PJF.communication.file2Swf=function(t){t.convertModel="real",t.convertType="swf",PJF.communication.ajax({url:"/bosWeb/ecpJson.action",data:{_fw_service_id:"file2SwfNew",jsonData:PJF.util.json2str(t)},success:function(t){if("00"!=t.TX_STATUS)return new PJF.ui.messageBox({style:"warning",title:"提示",content:"打开pdf文件"+t.FILE_NAME+"失败,错误描述信息["+t.ERROR_MSG+"]!"}),null;PJF.html.openWin("/bosWeb/page/swfdemo/viewSwf.html?fileName="+t.FILE_NAME,"pdf文件浏览")},failure:function(t){return new PJF.ui.messageBox({style:"warning",
title:"提示",content:"打开pdf文件发生异常, 请稍后再试!"}),null}})},PJF.communication.ootcTemplate=function(ootcData){PJF.communication.ajax({url:"/bosWeb/ecpJsonAsym.action",async:!1,data:{_fw_service_id:"transformData",jsonData:PJF.util.json2str(ootcData)},dataType:"html",success:function(data){var obj=data;if("string"==typeof data)try{obj=eval("("+data+")")}catch(t){return void(PJF.communication.client.OOTC_CONTENT=data)}PJF.communication.client.OOTC_CONTENT="";var desc=obj.BK_DESC;obj.FLLW_GUIDE&&(desc+="~"+obj.FLLW_GUIDE);var transId="";data._COMMON&&data._COMMON.SYS_EVT_TRACE_ID&&(transId=data._COMMON.SYS_EVT_TRACE_ID),new PJF.ui.errorMessageBox({title:"提示",desc:desc,code:obj.BK_CODE,traceId:transId})},failure:function(t){new PJF.ui.messageBox({style:"warning",title:"提示",content:"获取互动终端显示内容失败"}),PJF.communication.client.OOTC_CONTENT=""}})},PJF.communication.hanyu2PinYin=function(t){t||(t={});var e="";return PJF.communication.ajax({url:"ecpJson.action",async:!1,data:{
_fw_service_id:"hanyu2PinYin",jsonData:PJF.util.json2str(t)},success:function(t){t.replace(/·/g,""),e=t},failure:function(t){new PJF.ui.messageBox({title:"失败",content:"转换拼音失败"})}}),e},PJF.communication.getPostCode=function(t){t.categoryId="p20015",t.appId="p2015",t.clcd="p2015",PJF.communication.getStandardCodeDescByValue(t)},PJF.communication.getCityCodeByDesc=function(t){var e={};e.address=t.address;var n={_fw_service_id:"parseAddress"};n.jsonData=PJF.util.json2str(e),PJF.communication.ajax({data:n,async:!1,url:"ecpJson.action",success:t.success})},PJF.communication.PcsCrdAutoWtof=function(t,e,n,i,o){var a={Blng_InsNo:t,BnkTailBox_Blng_TrID:e,Mnplt_Tp_Ind:"0",Mnul_Ind:"0",SEGMENT_GRP:n};new PJF.communication.cpsJsonReq({fwServiceId:"simpleTransaction",fwTranId:"A0791T847",jsonData:PJF.util.json2str(a),maskAll:!0,success:function(t){i&&i(t);var e={};PJF.util.extend(!0,e,t),console.log("Call A0791T847 success,result type = [object], result value = ["+PJF.util.json2str(e)+"]")},
failure:function(t){if(o)o(t);else if("string"==typeof t)console.log("Call A0791T847 fail,result type = [string], result value = ["+t+"]"),new PJF.ui.messageBox({title:"错误",content:t});else{var e={};PJF.util.extend(!0,e,t),console.log("Call A0791T847 fail,result type = [object], result value = ["+PJF.util.json2str(e)+"]"),new PJF.ui.errorMessageBox({title:"预制卡自动销记失败，请尝试手工销记",desc:t&&t.BK_DESC,code:t&&t.BK_CODE,traceId:t&&t._COMMON&&t._COMMON.SYS_EVT_TRACE_ID})}}})},PJF.namespace("PJF.im"),PJF.im=function(a){if("pc"===PJF.constants.termType&&"1"===PJF.communication.client.doCommonCommand("cmdCfg","_SWC_IM_TP")[1])return PJF.im=PJF.ecp.im,new PJF.ecp.im(a);if(a.id&&a.type){this.url=a.url||PJF.constants.IM_URL,this.username=a.id.toLowerCase()+a.type,this.recMsgHandler=a.recMsgHandler,this.offMsgHandler=a.offMsgHandler,this.onlineStatusHandler=a.onlineStatusHandler,this.chatMsgHandler=a.chatMsgHandler,this.type=a.type,this.orgCode=a.orgCode,this.chatPresHandler=a.chatPresHandler,
this.inviteHandler=a.inviteHandler,this.resources="strophe",this.receiptHandler=a.receiptHandler,this.ackHandler=a.ackHandler,this.retry=!(!1===a.retry),this.retryCount=0,this.MaxRetryCount=5,this.retryTimeSpan=[5,10,30,60,120],this.lastError="";var C=this;this.messageSendAckHandler=function(t){if("message"==t.nodeName){var e=t.getElementsByTagName("body"),n=t.getElementsByTagName("pic");if(0==e.length&&0==n.length)return;if(C.ackHandler)try{var i=t.getAttribute("id"),o=t.getAttribute("to");C.ackHandler(i,Strophe.getNodeFromJid(o))}catch(t){}}},Strophe.log=function(t,e){3==t&&(C.lastError=e)};var s=function(t,e){var n={_fw_service_id:"remoteDatabaseTransaction",transaction_id:"update",_sql_id:"im.addErrorInfo",_db_no:"1"},i={im_id:C.username,error_reason:t,param_remark:e+"["+C.lastError+"]",create_time:PJF.util.formatDate(new Date,"yyyy-MM-dd HH:mm:ss")};n.jsonData=JSON.stringify(i),$.ajax({data:n,dataType:"json",url:"ecpJson.action",success:function(t){
"00"==t.BK_STATUS?console.log("上报连接错误状态成功"):"01"==t.BK_STATUS&&console.log("上报连接错误状态异常:"+t)},error:function(t,e,n){console.log("上报连接错误状态异常"+n)}})},n=function(t){if(t==Strophe.Status.CONNECTING)console.log("即时通讯正在连接"),PJF.event.publish(PJF.constants.IM_CONNECTING_EVENT);else if(t==Strophe.Status.CONNFAIL)console.log("即时通讯连接失败"),s(t,"即时通讯连接失败:"+C.url),C.retry&&C.retryCount<C.MaxRetryCount-1?(C.retryCount=C.retryCount+1,setTimeout(function(){C.connection.connect(C.username+"@"+C.domainName+"/"+C.resources,PJF.constants.DEF_IM_PASSWORD,n)},1e3*C.retryTimeSpan[C.retryCount])):PJF.event.publish(PJF.constants.IM_CONNECT_FAIL);else if(t==Strophe.Status.DISCONNECTING)console.log("即时通讯正在断开"),PJF.event.publish(PJF.constants.IM_DISCONNECTING_EVENT);else if(t==Strophe.Status.DISCONNECTED)console.log("即时通讯已断开"),PJF.event.publish(PJF.constants.IM_DISCONNECTED_EVENT);else if(t==Strophe.Status.AUTHFAIL){console.log("用户验证失败")
;var e="用户验证失败:[user->"+C.username+"@"+C.domainName+"/pwd->"+PJF.constants.DEF_IM_PASSWORD+"]";s(t,e),PJF.event.publish(PJF.constants.IM_CONNECT_AUTHFAIL)}else if(t==Strophe.Status.CONNTIMEOUT)console.log("连接超时"),s(t,"连接超时:"+C.url);else if(t==Strophe.Status.ERROR)s(t,"未知异常");else if(t==Strophe.Status.CONNECTED){console.log("即时通讯已连接"),C.retryCount=0,PJF.event.publish(PJF.constants.IM_CONNECTED_EVENT),C.ackHandler&&(C.connection.streamManagement.enable(),C.connection.streamManagement.sendCountOnEveryIncomingStanza=!0,C.connection.streamManagement.requestResponseInterval=1);C.connection.addHandler(function(t){try{!function(t){var e=t.getAttribute("to"),n=t.getAttribute("from"),i=t.getAttribute("type"),o=t.getElementsByTagName("pic"),a=t.getElementsByTagName("body");if("error"!=i){var s=0,r=t.getElementsByTagName("delay");if(0<r.length){var c=r[0].getAttribute("duration");s=parseInt(c)}if(0<a.length){var l=a[0],u=Strophe.getText(l)
;if(console.log("即时通信：目标:"+e+",内容:"+u+",来自于:"+n+",消息类型:"+i),"groupchat"==i&&e!=C.orgCode+C.type)return;0<s&&C.offMsgHandler?C.offMsgHandler(u,n,e,i,o,s):C.recMsgHandler&&C.recMsgHandler(u,n,e,i,o)}else{for(var d=t.getElementsByTagName("x"),h=null,m=null,p=null,f=0;f<d.length;f++){var g=d[f].getAttribute("xmlns");if("jabber:x:conference"==g&&(h=d[f].getAttribute("jid")),g==Strophe.NS.MUC_USER){var P=d[f].getElementsByTagName("invite")[0];p=P.getAttribute("from"),m=Strophe.getText(P.firstElementChild)}}if(null!=h){inviteHandler&&C.inviteHandler(h,p,m);var v=Strophe.getNodeFromJid(C.connection.jid);C.connection.muc.join(h,v,function(t,e){try{console.info(Strophe.serialize(t));var n=t.getAttribute("from"),i=Strophe.getBareJidFromJid(n),o=Strophe.getResourceFromJid(n),a=Strophe.getText(t.getElementsByTagName("body")[0]),s=t.getElementsByTagName("pic");C.chatchatMsgHandler&&C.chatMsgHandler(i,o,a,s)}catch(t){console.error(t)}return!0},function(t,e){try{console.info(Strophe.serialize(t))
;var n=t.getAttribute("from"),i=Strophe.getBareJidFromJid(n),o=Strophe.getResourceFromJid(n),a="unavailable"!=t.getAttribute("type");C.chatPresHandler&&C.chatPresHandler(i,o,a)}catch(t){console.error(t)}return!0},function(t,e){return!0})}}}else console.info("服务器返回异常消息"+Strophe.serialize(t))}(t)}catch(t){console.error(t)}return!0},null,"message",null,null,null);C.connection.addHandler(function(t){try{var e=t.getAttribute("from");if(t.getAttribute("to")==e)return!0;var n=t.getAttribute("type");switch(n||(n="available"),n){case"available":C.onlineStatusHandler&&C.onlineStatusHandler(Strophe.getNodeFromJid(e),!0);break;case"unavailable":C.onlineStatusHandler&&C.onlineStatusHandler(Strophe.getNodeFromJid(e),!1)}}catch(t){console.error(t)}return!0},null,"presence",null,null,null),C.connection.send($pres().tree())}},r=function(t){$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users/"+C.username+"/groups/"+t,data:null,type:"POST",beforeSend:function(t){
t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json")},success:function(t){console.log("即时通讯:当前用户组注册成功:"+a.orgCode+C.type),C.connection=new Strophe.Connection(C.url),C.receiptHandler&&(C.connection.receipts._resendCount=0,C.connection.receipts.addReceiptHandler(function(t){t=t.tree();var e=Strophe.getNodeFromJid(t.getAttribute("to")),n=t.getElementsByTagName("body");if(0<n.length)var i=Strophe.getText(n[0]);C.receiptHandler(e,i,!0)}),C.connection.receipts.addTimeoutHandler(function(t){t=t.tree();var e,n=Strophe.getNodeFromJid(t.getAttribute("to")),i=t.getElementsByTagName("body");0<i.length&&(e=Strophe.getText(i[0])),C.receiptHandler(n,e,!1)})),C.ackHandler&&(C.connection.streamManagement.returnWholeStanza=!0,C.connection.streamManagement._acknowledgedStanzaListeners=[],C.connection.streamManagement.addAcknowledgedStanzaListener(C.messageSendAckHandler)),
C.connection.connect(C.username+"@"+C.domainName+"/"+C.resources,PJF.constants.DEF_IM_PASSWORD,n)},error:function(t,e,n){var i="即时通讯:当前用户组创建失败，失败原因:"+n;console.log(i),s(24,i),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}})};$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/system/properties/xmpp.domain",data:null,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json")},success:function(t){C.domainName=t["@value"],console.log("即时通讯:domainName:"+C.domainName);var o=a.id.toLowerCase()+a.type;$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users/"+o,data:null,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json")},success:function(t){$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users/"+o+"/groups",data:null,type:"GET",beforeSend:function(t){
t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json")},success:function(t){if(t&&t.groupname){console.log("即时通讯:当前用户:"+o+",所属组"+PJF.util.json2str2(t));var e=t.groupname;"string"==PJF.util.getType(e)&&e!=C.orgCode+C.type||"array"==PJF.util.getType(e)&&PJF.util.array.indexOf(e,C.orgCode+C.type)<0?(console.log("即时通讯:当前用户:"+o+",所属组"+e+"不在"+C.orgCode+C.type+"中,需要创建新组"),r(C.orgCode+C.type)):(C.connection=new Strophe.Connection(a.url),C.receiptHandler&&(C.connection.receipts._resendCount=0,C.connection.receipts.addReceiptHandler(function(t){t=t.tree();var e=Strophe.getNodeFromJid(t.getAttribute("to")),n=t.getElementsByTagName("body");if(0<n.length)var i=Strophe.getText(n[0]);C.receiptHandler(e,i,!0)},null,null,null),C.connection.receipts.addTimeoutHandler(function(t){t=t.tree();var e,n=Strophe.getNodeFromJid(t.getAttribute("to")),i=t.getElementsByTagName("body");0<i.length&&(e=Strophe.getText(i[0])),C.receiptHandler(n,e,!1)})),
C.ackHandler&&(C.connection.streamManagement.returnWholeStanza=!0,C.connection.streamManagement._acknowledgedStanzaListeners=[],C.connection.streamManagement.addAcknowledgedStanzaListener(C.messageSendAckHandler)),C.connection.connect(o+"@"+C.domainName+"/"+C.resources,PJF.constants.DEF_IM_PASSWORD,n))}},error:function(t,e,n){var i="即时通讯:当前用户组获取失败，失败原因:"+n;console.log(i),s(25,i),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}})},error:function(t,e,n){if("Not Found"==n)console.log("即时通讯:当前用户没注册:"+a.id.toLowerCase()+a.type),$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users",data:'{"username":"'+o+'","password":"'+PJF.constants.DEF_IM_PASSWORD+'"}',type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json")},success:function(t){console.log("即时通讯:当前用户注册成功:"+o+",开始创建用户组:"+a.orgCode+C.type),r(a.orgCode+C.type)},error:function(t,e,n){
var i="即时通讯:当前用户创建失败，失败原因:"+n;console.log(i),s(22,i),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}});else{var i="即时通讯:查找用户失败，失败原因:"+n;console.log(i),s(23,i),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}}})},error:function(t,e,n){var i="即时通讯:获取domainName失败,失败原因:"+n;console.log(i),s(21,i),PJF.event.publish(PJF.constants.IM_CONNECT_FAIL)}})}else alert("PJF.im初始化出错,请传入id,type属性")},PJF.im.prototype={sendMessageToAll:function(i){$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/messages/users",data:'{"body":"'+i.msg+'"}',type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json")},success:function(t){console.log("即时通讯:发送所有用户消息成功!"),i.success&&i.success()},error:function(t,e,n){console.log("即时通讯:发送所有用户消息失败!"),i.failure&&i.failure(t,e,n)}})},isUserExist:function(t,i){$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/users/"+t,
data:null,type:"GET",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json")},success:function(t){i(!0)},error:function(t,e,n){i(!1)}})},sendMessageToMany:function(i){var t={};t.many=i.toIds,t.content=i.msg,$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/restapi/v1/messages/many",data:JSON.stringify(t),type:"POST",beforeSend:function(t){t.setRequestHeader("Authorization",PJF.constants.IM_REQ_AUTH),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Content-Type","application/json")},success:function(t){console.log("即时通讯:发送多人消息成功!"),i.success&&i.success()},error:function(t,e,n){console.log("即时通讯:发送多人消息失败!"),i.failure&&i.failure(t,e,n)}})},sendMessageToUser:function(t){var e,n=this.connection.getUniqueId();return e=t.pic?$msg({to:t.toId+"@ygqd-im",type:"chat",id:n}).c("body").t(t.msg).up().c("pic").attrs({xmlns:"http://ccb.com.cn/protocol/picture"}).t(t.pic):$msg({to:t.toId+"@ygqd-im",
type:"chat",id:n}).c("body").t(t.msg),this.receiptHandler?this.connection.receipts.sendMessage(e):this.connection.send(e),n},addRoster:function(t){var e=$pres({to:t+"@ygqd-im",type:"subscribe"});this.connection.send(e)},sendMessageToGroups:function(t){var e;e=t.pic?$msg({to:t.group+"@broadcast.ygqd-im",type:"chat"}).c("body").t(t.msg).up().c("pic").attrs({xmlns:"http://ccb.com.cn/protocol/picture"}).t(t.pic).tree():$msg({to:t.group+"@broadcast.ygqd-im",type:"chat"}).c("body").t(t.msg).tree(),this.connection.send(e)},logout:function(){this.connection.disconnect()},createGroup:function(t){},getUserStatus:function(i,n,o){null==n&&(n=function(t,e){console.info(t+" status is :"+e?"online":"offline")}),null==o&&(o=function(t){console.warn(t)}),$.ajax({url:PJF.constants.IM_HTTP_URL+"/plugins/presence/status?type=xml&jid="+i+"@"+this.domainName,type:"GET",success:function(t){var e=t.firstChild.getAttribute("type");"error"!=e?n(i,"unavailable"!=e):o("user not exists!")},error:function(t,e,n){
console.log("即时通讯:获取"+i+"失败"),failure&&o("http request error")}})},createRoom:function(t,e){var n=Strophe.getNodeFromJid(this.connection.jid),i=n+"-"+Strophe.getUniqueId()+"@conference.ygqd-im",r=this;return this.connection.muc.join(i,n,function(t,e){try{console.info(Strophe.serialize(t));var n=t.getAttribute("from"),i=Strophe.getBareJidFromJid(n),o=Strophe.getResourceFromJid(n),a=Strophe.getText(t.getElementsByTagName("body")[0]),s=t.getElementsByTagName("pic");r.chatMsgHandler(i,o,a,s)}catch(t){console.error(t)}return!0},function(t,e){try{console.info(Strophe.serialize(t));var n=t.getAttribute("from"),i=Strophe.getBareJidFromJid(n),o=Strophe.getResourceFromJid(n),a="unavailable"!=t.getAttribute("type");r.chatPresHandler&&r.chatPresHandler(i,o,a)}catch(t){console.error(t)}return!0},function(t,e){return!0}),this.connection.muc.createInstantRoom(i,t,e),i},inviteUserToRoom:function(t,e,n){this.connection.muc.invite(t,e+"@ygqd-im",n)},sendRoomMsg:function(t,e){
this.connection.muc.groupchat(t,e)},setInfo:function(o,a,r,t){var e=$iq({type:"get"}).c("vCard").attrs({xmlns:"vcard-temp"}),c=function(){t&&t()};this.connection.sendIQ(e,function(t){t.removeAttribute("to"),t.removeAttribute("id"),t.setAttribute("type","set");var e=t.getElementsByTagName("vCard")[0],n=e.getElementsByTagName(o);0<n.length&&e.removeChild(n[0]);var i=Strophe.xmlElement(o);i.append(a),e.appendChild(i),this.connection.sendIQ(t,function(t){r&&r()},function(t){console.log("设置个人信息失败,"+Strophe.serialize(t)),c()},function(){console.log("设置个人信息超时"),c()})},function(t){console.log("设置个人信息失败,"+Strophe.serialize(s)),c()},function(){console.log("设置个人信息超时"),c()})},getInfo:function(t,i,o,e){t||(t=conn.jid),-1==t.indexOf("@")&&(t=t+"@"+this.domainName);var n=$iq({type:"get",to:Strophe.getBareJidFromJid(t)}).c("vCard").attrs({xmlns:"vcard-temp"});this.connection.sendIQ(n,function(t){var e=t.getElementsByTagName(i),n="";0<e.length&&(n=Strophe.getText(e[0])),o&&o(n)},function(t){
console.log("获取个人信息失败,"+Strophe.serialize(s)),e&&e()},function(){console.log("获取个人信息超时"),e&&e()})}},PJF.communication.setEcpJsonParam=function(serviceId,tranId,data,needAdapterId,encryptDatas,sqlId,fmtPrintId,conf){var myData={},enData={};fmtPrintId=fmtPrintId,myData=PJF.communication.addParam(myData),conf.userCode&&(myData.OPER_CODE=conf.userCode),myData._cli_sec_id=PJF.otherInfo.devId,myData.IS_SELF_SERVICE_BANK=!0,PJF.otherInfo.devId&&(myData.STM_DEV_ID=PJF.otherInfo.devId),PJF.util.deviceType.pad&&(myData.STM_DEV_ID=PJF.otherInfo.devId,myData.TXN_ELMT11=PJF.userInfo.userCode),PJF.otherInfo.MENU_ID&&(myData.STM_MNU_ID=PJF.otherInfo.MENU_ID,myData._menu_id=PJF.otherInfo.MENU_ID),PJF.otherInfo.SVC_ID&&(myData.STM_SVC_ID=PJF.otherInfo.SVC_ID),PJF.roleInfo.orgName&&(myData.STM_INS_NAME=PJF.roleInfo.orgName),PJF.otherInfo.typeInfo&&(myData.STM_DEV_TYPE=PJF.otherInfo.typeInfo),conf.IS_AUTH&&(myData.IS_AUTH=conf.IS_AUTH),conf.IS_SIGN&&(myData.IS_SIGN=conf.IS_SIGN),
conf.cashTransaction&&(myData.TXN_ITT_CHNL_CGY_CODE=PJF.otherInfo.cashChaType),conf.cashTransaction&&(myData.TXN_ITT_CHNL_ID=PJF.otherInfo.cashChaId),conf.AUTH_OPER_CODE&&(myData.AUTH_OPER_CODE=conf.AUTH_OPER_CODE),PJF.otherInfo.transTime&&(myData.STM_START_TXN_DT=PJF.otherInfo.transTime),PJF.util.isExist("PJF.stm.idenAuth.idenAudit")&&(PJF.stm.idenAuth.idenAudit.STM_IDENTITY_AUDIT_CODE&&(myData.STM_IDENTITY_AUDIT_CODE=PJF.stm.idenAuth.idenAudit.STM_IDENTITY_AUDIT_CODE),PJF.stm.idenAuth.idenAudit.STM_IDENTITY_AUDIT_NAME&&(myData.STM_IDENTITY_AUDIT_NAME=PJF.stm.idenAuth.idenAudit.STM_IDENTITY_AUDIT_NAME),PJF.stm.idenAuth.idenAudit.STM_FACE_SMLR_DGR&&(myData.STM_FACE_SMLR_DGR=PJF.stm.idenAuth.idenAudit.STM_FACE_SMLR_DGR+"|"),PJF.stm.idenAuth.idenAudit.STM_FACE_BLACK&&(myData.STM_FACE_BLACK=PJF.stm.idenAuth.idenAudit.STM_FACE_BLACK)),PJF.util.isExist("PJF.stm.faceAudit")&&(PJF.stm.faceAudit.STM_FACE_AUDIT_CODE&&(myData.STM_FACE_AUDIT_CODE=PJF.stm.faceAudit.STM_FACE_AUDIT_CODE),
PJF.stm.faceAudit.STM_FACE_AUDIT_NAME&&(myData.STM_FACE_AUDIT_NAME=PJF.stm.faceAudit.STM_FACE_AUDIT_NAME),PJF.stm.faceAudit.STM_FACE_SMLR_DGR&&(myData.STM_FACE_SMLR_DGR?myData.STM_FACE_SMLR_DGR+=PJF.stm.faceAudit.STM_FACE_SMLR_DGR:myData.STM_FACE_SMLR_DGR="|"+PJF.stm.faceAudit.STM_FACE_SMLR_DGR)),myData._elec_seal_switch=PJF.roleInfo._elec_seal_switch,myData._elec_seal_capability=!0,PJF.util.isExist("PJF.stm.idenAuth.selfCustInfo")?(PJF.stm.idenAuth.selfCustInfo.idBack&&(myData.ID_BACK=PJF.stm.idenAuth.selfCustInfo.idBack),PJF.stm.idenAuth.selfCustInfo.idFront&&(myData.ID_FRONT=PJF.stm.idenAuth.selfCustInfo.idFront),PJF.stm.idenAuth.selfCustInfo.idPhoto&&(myData.ID_PHOTO=PJF.stm.idenAuth.selfCustInfo.idPhoto),PJF.stm.idenAuth.selfCustInfo.name&&(myData.CUST_NM=PJF.stm.idenAuth.selfCustInfo.name),PJF.stm.idenAuth.selfCustInfo.identity&&(myData.CRDT_NO=PJF.stm.idenAuth.selfCustInfo.identity),PJF.stm.idenAuth.selfCustInfo.identity&&(myData.CRDT_TPCD="1010"),
PJF.util.isExist("PJF.stm.idenAuth.custInfo")&&PJF.stm.idenAuth.custInfo.name&&(myData.STM_AGENT_NAME=PJF.stm.idenAuth.custInfo.name)):PJF.util.isExist("PJF.stm.idenAuth.custInfo")&&(PJF.stm.idenAuth.isNonIdentityAuth?(PJF.stm.idenAuth.custInfo.psrBack&&(myData.ID_BACK=PJF.stm.idenAuth.custInfo.psrBack),PJF.stm.idenAuth.custInfo.psrFront&&(myData.ID_FRONT=PJF.stm.idenAuth.custInfo.psrFront),PJF.stm.idenAuth.custInfo.psrPhoto&&(myData.ID_PHOTO=PJF.stm.idenAuth.custInfo.psrPhoto),PJF.stm.idenAuth.custInfo.photo&&(myData.SNAP_FILE_NAME=PJF.stm.idenAuth.custInfo.photo),PJF.stm.idenAuth.custInfo.nativeName&&(myData.CUST_NM=PJF.stm.idenAuth.custInfo.nativeName),PJF.stm.idenAuth.custInfo.credID&&(myData.CRDT_NO=PJF.stm.idenAuth.custInfo.credID),PJF.stm.idenAuth.custInfo.tpcd&&(myData.CRDT_TPCD=PJF.stm.idenAuth.custInfo.tpcd)):(PJF.stm.idenAuth.custInfo.idBack&&(myData.ID_BACK=PJF.stm.idenAuth.custInfo.idBack),
PJF.stm.idenAuth.custInfo.idFront&&(myData.ID_FRONT=PJF.stm.idenAuth.custInfo.idFront),PJF.stm.idenAuth.custInfo.idPhoto&&(myData.ID_PHOTO=PJF.stm.idenAuth.custInfo.idPhoto),PJF.stm.idenAuth.custInfo.photo&&(myData.SNAP_FILE_NAME=PJF.stm.idenAuth.custInfo.photo),PJF.stm.idenAuth.custInfo.name&&(myData.CUST_NM=PJF.stm.idenAuth.custInfo.name),PJF.stm.idenAuth.custInfo.identity&&(myData.CRDT_NO=PJF.stm.idenAuth.custInfo.identity),PJF.stm.idenAuth.custInfo.identity&&(myData.CRDT_TPCD="1010"))),PJF.stm.util&&PJF.stm.util.hasInsertedCard&&PJF.stm.util.hasInsertedCard(!0,!0)?(PJF.stm.CUSTOM_INFO.Idv_Lgl_Nm&&(myData.CUST_NM=PJF.stm.CUSTOM_INFO.Idv_Lgl_Nm),PJF.stm.CUSTOM_INFO.Crdt_No&&(myData.CRDT_NO=PJF.stm.CUSTOM_INFO.Crdt_No),PJF.stm.CUSTOM_INFO.Crdt_TpCd&&(myData.CRDT_TPCD=PJF.stm.CUSTOM_INFO.Crdt_TpCd),
PJF.stm.CUSTOM_INFO.Cst_ID&&(myData.CUST_ID=PJF.stm.CUSTOM_INFO.Cst_ID)):PJF.stm.util&&PJF.stm.util.hasInsertedCardCor&&PJF.stm.util.hasInsertedCardCor()&&(PJF.stm.CUSTOM_INFO_COR.CrdHldr_Nm&&(myData.CUST_NM=PJF.stm.CUSTOM_INFO_COR.CrdHldr_Nm),PJF.stm.CUSTOM_INFO_COR.CrdHldr_Crdt_No&&(myData.CRDT_NO=PJF.stm.CUSTOM_INFO_COR.CrdHldr_Crdt_No),PJF.stm.CUSTOM_INFO_COR.CrdHldr_Crdt_TpCd&&(myData.CRDT_TPCD=PJF.stm.CUSTOM_INFO_COR.CrdHldr_Crdt_TpCd));var isIdentity=(PJF.util.isExist("PJF.stm.idenAuth.selfCustInfo")||PJF.util.isExist("PJF.stm.idenAuth.custInfo"))&&!PJF.stm.idenAuth.faceCheck,isCard=PJF.stm.util&&(PJF.stm.util.hasInsertedCard&&PJF.stm.util.hasInsertedCard(!1,!0)||PJF.stm.util.hasInsertedCardCor&&PJF.stm.util.hasInsertedCardCor()),isPassbook=PJF.stm.IC_CARD_INFO&&PJF.stm.IC_CARD_INFO.isPassbook||PJF.util.isExist("PJF.stm.PASSBOOK_INFO"),isFromFace=PJF.util.isExist("PJF.stm.idenAuth")&&PJF.stm.idenAuth.fromFace&&!PJF.stm.idenAuth.faceCheck
;if(isIdentity&&isCard?(myData.ACCT_TYPE="3",myData.ACCT_TYPE_DESC="卡证"):isIdentity&&isPassbook?(myData.ACCT_TYPE="4",myData.ACCT_TYPE_DESC="折证"):isPassbook?(myData.ACCT_TYPE="0",myData.ACCT_TYPE_DESC="存折"):isCard?(myData.ACCT_TYPE="1",myData.ACCT_TYPE_DESC="卡"):isIdentity?(myData.ACCT_TYPE="2",myData.ACCT_TYPE_DESC="身份证"):(myData.ACCT_TYPE="5",myData.ACCT_TYPE_DESC="其他"),isFromFace&&(myData.ACCT_TYPE="6",myData.ACCT_TYPE_DESC="刷脸"),PJF.util.isExist("PJF.stm.idenAuth")&&PJF.stm.idenAuth.authAfterFace&&(myData.ACCT_TYPE="7",myData.ACCT_TYPE_DESC="脸证"),PJF.util.deviceType.stm?myData.STM_LOCAL_CHNL=PJF.util.deviceType.tcr?"2":PJF.util.deviceType.icm?"3":"1":myData.STM_LOCAL_CHNL=PJF.util.deviceType.pad?"5":"4",conf.cashTransaction?myData.STM_LOCAL_CHNL+="2":myData.STM_LOCAL_CHNL+="1",encryptDatas){var dataObj;dataObj=""==data?{}:eval("("+data+")");for(var a=0;a<encryptDatas.length;a++){var key=encryptDatas[a];if(dataObj[key]){var result=PJF.communication.client.encryptParam(dataObj[key])
;0==result[0]&&(enData[key]=result[1])}}}if("string"==PJF.util.getType(data)&&""!=data&&(data=eval("("+data+")")),myData.ATCH_BTCH_NO&&data&&(data.ATCH_BTCH_NO=myData.ATCH_BTCH_NO),myData=PJF.apply(myData,data),myData.STM_IDPHOTOS=myData.STM_IDPHOTOS||[],myData.STM_PIC_PATH=PJF.otherInfo.picPath+PJF.otherInfo.devId+"/IMAGE/",PJF.util.isExist("PJF.stm.idenAuth.selfCustInfo")){var master=PJF.stm.idenAuth.selfCustInfo;myData.STM_IDPHOTOS=myData.STM_IDPHOTOS.concat([master.idBack,master.idFront,master.idPhoto])}if(PJF.util.isExist("PJF.stm.idenAuth.custInfo")){var iden=PJF.stm.idenAuth.custInfo;PJF.stm.idenAuth.isNonIdentityAuth?myData.STM_IDPHOTOS=myData.STM_IDPHOTOS.concat([iden.psrBack,iden.psrFront,iden.psrPhoto,iden.photo]):myData.STM_IDPHOTOS=myData.STM_IDPHOTOS.concat([iden.idBack,iden.idFront,iden.idPhoto,iden.photo])}myData.STM_IDPHOTOS=myData.STM_IDPHOTOS.join(","),myData=PJF.apply(myData,enData);var macContent="",resultData
;if(PJF.otherInfo&&PJF.otherInfo.txnList&&-1<PJF.util.array.indexOf(PJF.otherInfo.txnList,tranId)){var macResult=PJF.communication.client.macContent(PJF.util.json2str(myData));0==macResult[0]&&(macContent=macResult[1])}return conf&&conf.coverJsonData&&PJF.apply(myData,conf.coverJsonData),resultData=needAdapterId?{adapterId:"ecpJsonStm",_fw_service_id:serviceId,jsonData:PJF.util.json2str(myData),transaction_id:tranId,macData:macContent}:{_fw_service_id:serviceId,jsonData:PJF.util.json2str(myData),transaction_id:tranId,macData:macContent},sqlId&&(resultData._sql_id=sqlId),fmtPrintId&&(resultData.fmtPrintId=fmtPrintId),conf&&(conf.docType&&(resultData.docType=conf.docType),conf.transFlag&&(resultData.transFlag=conf.transFlag),conf.serverFilePath&&(resultData.serverFilePath=conf.serverFilePath),conf.remotePath&&(resultData.remotePath=conf.remotePath)),resultData.REQ_LANG=CLIENT_LANGUAGE,resultData},PJF.communication.getHostStmSeqNo=function(t){var e={_fw_service_id:"getStmSvcNo"}
;e.jsonData=PJF.util.json2str({STM_DEV_ID:PJF.otherInfo.devId,_menu_id:t||PJF.otherInfo.MENU_ID});var n="";return PJF.communication.ajax({data:e,async:!1,url:"ecpJson.action",success:function(t){n=t.hostTimeSeqNo}}),n},PJF.communication.callPad=function(n,i,o){var a={};a.INS_ID=PJF.roleInfo.orgCode,a.DEV_ID=PJF.otherInfo.devId,a.CALL_FLAG="1",a.CALL_DATE=PJF.communication.getServerTime()||PJF.util.formatDate(new Date,"yyyyMMdd"),a.CALL_TIM=PJF.communication.getServerTime("HHmmss")||PJF.util.formatDate(new Date,"hhmmss"),a.BUSI_NM=n.busiName,a.CUST_NM=n.custName||(PJF.stm.idenAuth.custInfo?PJF.stm.idenAuth.custInfo.name:""),a.CUST_ID=n.custId||(PJF.stm.idenAuth.custInfo?PJF.stm.idenAuth.custInfo.identity:""),a.DEAL_STA="0",a.BUSI_TYPE=n.busiType||"2",n.dealContent&&(a.DEAL_CONTENT=JSON.stringify(n.dealContent)),console.log("插入呼叫表参数为"+JSON.stringify(a))
;var t=PJF.constants.AUTH_SERVER+"/bosWeb/ecpJson.action",e="jsonData="+JSON.stringify(a)+"&_fw_service_id=databaseTransaction&transaction_id=update&_sql_id=stm.checkCall";PJF.communication.Http.SendCrossDomainRequest(t,e,3e4,function(t,e){console.log("跨域返回结果,status:"+t+";responseData:"+e),(t=JSON.parse(t)).success&&e?(e=JSON.parse(e))&&e.BK_STATUS&&e.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?(console.log(n.busiName+"，插入呼叫表成功"),"2"==a.BUSI_TYPE&&PJF.stm.util.imHandler&&PJF.stm.util.imHandler("警告类"),i&&"function"==typeof i&&i(e)):(console.log(n.busiName+"，插入呼叫表失败"),o&&"function"==typeof o&&o(e)):(console.log(n.busiName+"，插入呼叫表，通信失败"),o&&"function"==typeof o&&o(t.error))})},PJF.communication.returnCardTrade=function(t){var e={_fw_service_id:"returnCardTrade"};e.jsonData=PJF.util.json2str({devId:PJF.otherInfo.devId,result:t.result}),console.log("returnCardTrade发送请求:"+e.jsonData),PJF.communication.ajax({data:e,async:t.async,url:"ecpJson.action",success:function(t){
console.log("returnCardTrade返回结果:"+JSON.stringify(t))}})},PJF.communication.returnKeyTrade=function(t){var e={_fw_service_id:"returnKeyTrade"};e.jsonData=PJF.util.json2str({devId:PJF.otherInfo.devId,result:t.result}),console.log("returnKeyTrade发送请求:"+e.jsonData),PJF.communication.ajax({data:e,async:t.async,url:"ecpJson.action",success:function(t){console.log("returnKeyTrade返回结果:"+JSON.stringify(t))}})},PJF.communication.returnCard=function(t){var e={};PJF.otherInfo.devId&&(e.devId=PJF.otherInfo.devId),PJF.roleInfo.orgCode&&(e.insId=PJF.roleInfo.orgCode),e.ourbnkCrdInd=e.ourbnkCrdInd||"0",PJF.stm.IC_CARD_INFO_BAK&&PJF.stm.IC_CARD_INFO_BAK.resInfo?(e.ourbnkCrdInd="1",PJF.stm.IC_CARD_INFO_BAK.resInfo.accountNo&&(e.accountNo=PJF.stm.IC_CARD_INFO_BAK.resInfo.accountNo),PJF.stm.CUSTOM_INFO_BAK.Idv_Lgl_Nm&&(e.customerName=PJF.stm.CUSTOM_INFO_BAK.Idv_Lgl_Nm),PJF.stm.CUSTOM_INFO_BAK.Crdt_TpCd&&(e.certType=PJF.stm.CUSTOM_INFO_BAK.Crdt_TpCd),
PJF.stm.CUSTOM_INFO_BAK.Crdt_No&&(e.identityCardno=PJF.stm.CUSTOM_INFO_BAK.Crdt_No)):PJF.stm.IC_CARD_INFO_COR_BAK&&PJF.stm.IC_CARD_INFO_COR_BAK.resInfo&&(PJF.stm.IC_CARD_INFO_COR_BAK.resInfo.accountNo&&(e.accountNo=PJF.stm.IC_CARD_INFO_COR_BAK.resInfo.accountNo),PJF.stm.CUSTOM_INFO_COR_BAK.Idv_Lgl_Nm&&(e.customerName=PJF.stm.CUSTOM_INFO_COR_BAK.Idv_Lgl_Nm),PJF.stm.CUSTOM_INFO_COR_BAK.Crdt_TpCd&&(e.certType=PJF.stm.CUSTOM_INFO_COR_BAK.Crdt_TpCd),PJF.stm.CUSTOM_INFO_COR_BAK.Crdt_No&&(e.identityCardno=PJF.stm.CUSTOM_INFO_COR_BAK.Crdt_No),e.ourbnkCrdInd="1");var n=PJF.util.formatDate(new Date,"yyyyMMddhhmmss");e.operateDate=n.substr(0,8),e.operateTime=n.substr(8),e.insName=PJF.roleInfo.orgName,e.recycleType=t.recycleType||"9",console.log("insertStmCardRecycle发送请求:"+JSON.stringify(e)),PJF.communication.cpsJsonReq({jsonData:PJF.util.json2str(e),fwServiceId:"p8DatabaseTransaction",fwTranId:"update",sqlId:"stm.insertStmCardRecycle",success:function(t){
console.log("insertStmCardRecycle业务吞卡返回结果:"+JSON.stringify(t))},failure:function(t){console.log("insertStmCardRecycle业务吞卡返回结果:"+JSON.stringify(t))}}),PJF.communication.addSwallowCardRecord(e)},PJF.communication.addSwallowCardRecord=function(t){PJF.communication.ajax({url:"ecpJson.action",safe:!0,data:{jsonData:t,_fw_service_id:"stm.addSwallowCardRecord"},success:function(t){console.log("外来吞卡stm.addSwallowCardRecord返回结果",JSON.stringify(t))},failure:function(t,e,n){}})},PJF.communication.setSendCardSate=function(t){var e={},n={_fw_service_id:"setSendCardSate"};PJF.otherInfo.devId&&(e.devId=PJF.otherInfo.devId),t.devCardNo&&(e.devCardNo=t.devCardNo),t.devCardBoxNo&&(e.devCardBoxNo=t.devCardBoxNo),t.sendingCardNo&&(e.sendingCardNo=t.sendingCardNo),n.jsonData=PJF.util.json2str(e),console.log("setSendCardSate发送请求:"+n.jsonData),PJF.communication.ajax({data:n,async:t.async,url:"ecpJson.action",success:function(t){console.log("setSendCardSate返回结果:"+JSON.stringify(t))}})},
PJF.communication.setSendKeySate=function(t){var e={},n={_fw_service_id:"setSendKeySate"};PJF.otherInfo.devId&&(e.devId=PJF.otherInfo.devId),t.devKeyNo&&(e.devKeyNo=t.devKeyNo),t.devKeyBoxNo&&(e.devKeyBoxNo=t.devKeyBoxNo),t.sendingKeyNo&&(e.sendingKeyNo=t.sendingKeyNo),n.jsonData=PJF.util.json2str(e),console.log("setSendKeySate发送请求:"+n.jsonData),PJF.communication.ajax({data:n,async:t.async,url:"ecpJson.action",success:function(t){console.log("setSendKeySate返回结果:"+JSON.stringify(t))}})},PJF.communication.sendCardTrade=function(t){var e={},n={_fw_service_id:"sendCardTrade",jsonClass:"com.ccb.p2.stm.localManagement.moder.CardTrade"};PJF.otherInfo.devId&&(e.devId=PJF.otherInfo.devId),t.cardTypeId&&(e.cardTypeId=t.cardTypeId),t.devCardNo&&(e.devCardNo=t.devCardNo),t.devCardBoxNo&&(e.devCardBoxNo=t.devCardBoxNo),t.tranType&&(e.tranType=t.tranType),t.cardNo&&(e.cardNo=t.cardNo),t.sendType&&(e.sendType=t.sendType),t.customerName&&(e.customerName=t.customerName),
t.certType&&(e.certType=t.certType),t.identityCardNo&&(e.identityCardNo=t.identityCardNo),t.operateDate&&(e.operateDate=t.operateDate),t.operateTime&&(e.operateTime=t.operateTime),t.cardMediaId&&(e.cardMediaId=t.cardMediaId),t.depositAmt&&(e.depositAmt=t.depositAmt),PJF.otherInfo.SVC_ID&&(e.transerialNo=PJF.otherInfo.SVC_ID),n.jsonData=PJF.util.json2str(e),PJF.communication.ajax({data:n,async:t.async,url:"ecpJson2BeanRaw.action",success:function(t){console.log("sendCardTrade返回结果:"+JSON.stringify(t))}})},PJF.communication.sendKeyTrade=function(t){var e={},n={_fw_service_id:"sendKeyTrade",jsonClass:"com.ccb.p2.stm.localManagement.moder.KeyTrade"};PJF.otherInfo.devId&&(e.devId=PJF.otherInfo.devId),t.keyTypeId&&(e.keyTypeId=t.keyTypeId),t.devKeyNo&&(e.devKeyNo=t.devKeyNo),t.devKeyBoxNo&&(e.devKeyBoxNo=t.devKeyBoxNo),t.tranType&&(e.tranType=t.tranType),t.keyNo&&(e.keyNo=t.keyNo),t.sendType&&(e.sendType=t.sendType),t.customerName&&(e.customerName=t.customerName),
t.certType&&(e.certType=t.certType),t.identityCardNo&&(e.identityCardNo=t.identityCardNo),t.operateDate&&(e.operateDate=t.operateDate),t.operateTime&&(e.operateTime=t.operateTime),PJF.otherInfo.SVC_ID&&(e.transerialNo=PJF.otherInfo.SVC_ID),n.jsonData=PJF.util.json2str(e),PJF.communication.ajax({data:n,async:t.async,url:"ecpJson2BeanRaw.action",success:function(t){console.log("sendCardTrade返回结果:"+JSON.stringify(t))}})},PJF.communication.sendPicRequest=function(t,e){var n={_fw_service_id:"imageTransService"};t.path=PJF.otherInfo.picPath+t.path,n.jsonData=PJF.util.json2str(t),PJF.communication.ajax({data:n,dataType:"text",url:"ecpJson.action",success:function(t){console.log("sendPicRequest图片发送成功,返回结果:"+t),e&&e()},failure:function(t,e,n){console.log("sendPicRequest图片发送失败,原因:"+e+","+n)}})},PJF.communication.sendPicReq=function(t,e,i){var n={_fw_service_id:"imageTransService"};t.path=PJF.otherInfo.picPath+t.path,n.jsonData=PJF.util.json2str(t),PJF.communication.ajax({data:n,
url:"ecpJson.action",success:function(t){console.log("sendPicReq图片发送成功,返回结果:"+JSON.stringify(t)),t&&"01"==t.BK_STATUS?i&&i():e&&e(t)},failure:function(t,e,n){console.log("sendPicRequest图片发送失败,原因:"+e+","+n),i&&i(e)}})},PJF.communication.createVoucherImageReq=function(t){if(t.success&&t.jsonData){if(!t.jsonData.path)return void alert("生成凭证图片路径必须填写！");var e=!1;t.async&&(e=t.async);var n={_fw_service_id:"createVoucherImageReq"};n.jsonData=PJF.util.json2str(t.jsonData),PJF.communication.ajax({data:n,async:e,url:"ecpJson.action",success:t.success})}else alert("PJF.communication.createVoucherImageReq需要的参数信息不正确!")},PJF.communication.getUserInfo=function(i,o){var t={},e={};t.devId=PJF.otherInfo.devId,e._fw_service_id="selTermMatchByParam",e.jsonData=PJF.util.json2str(t);var a=!1;return PJF.communication.ajax({data:e,url:"ecpJson.action",async:!1,safe:!0,success:function(t){if(t&&"00"==t.BK_STATUS){PJF.otherInfo.dev_operUser=t.dev_operUser;var e=t.dev_operUser[i];e?(a=!0,o=o||0,
PJF.userInfo.userCode=e[o].USER_CODE,PJF.userInfo.ccbsId=e[o].CCBS_ID,PJF.otherInfo.logicTerminalNo=e[o].ZD_NO,e[o].CCBINS_CHN_SHRTNM&&(PJF.orgInfo.orgShortCName=e[o].CCBINS_CHN_SHRTNM),e[o].CCBINS_TPCD&&(PJF.orgInfo.orgType=e[o].CCBINS_TPCD),console.log("获取当前设备柜员号成功:"+JSON.stringify(t))):console.log("获取柜员号成功，但是对应编号的柜员不存在，编号为:"+i)}else{var n=t&&t.BK_MSG?t.BK_MSG:"无";console.log("获取当前设备柜员失败，错误信息为:"+n)}},failure:function(t,e){console.log("获取当前设备柜员号失败:"+e)}}),a},PJF.communication.stmManageAjax=function(o){if(o.retryTime=o.retryTime||1,o.async=void 0===o.async||o.async,"stmDriveTest"!=template.getLocation()){var n,t={};if(t._fw_service_id=o.fwServiceId,"string"==typeof o.jsonData&&(o.jsonData=JSON.parse(o.jsonData)),PJF.communication.addParam(o.jsonData),o.jsonClass&&(t.jsonClass=o.jsonClass),o.jsonData.dev_type=PJF.otherInfo.typeInfo,o.jsonData._spl_log_mapping=t.fwServiceId,t.jsonData=JSON.stringify(PJF.communication.addParam(o.jsonData)),o.maskBody&&(n=new PJF.ui.loading({
text:o.loadingText})),o.url=o.url||"ecpJson.action",console.log("stmManageAjax参数为:"+JSON.stringify(t)),4==o.retryTime&&PJF.communication.isInClient()){var e=$.param(t,!0);o.url="http://"+location.host+(o.url.match(/$\/.*/g)?"":"/bosWeb/")+o.url;PJF.communication.Http.SendCrossDomainAjax(o.url,e,3e4,!0,o.async,function(t,e){n&&n.destroy(),console.log("stm后台管理服务返回status:"+t),console.log("stm后台管理服务返回responseData:"+e),(t=JSON.parse(t)).result=e;try{t.success&&t.result?(t.result=JSON.parse(t.result),t.result&&t.result.BK_STATUS&&t.result.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?(o.success&&"function"==typeof o.success&&o.success(t.result),i(t.result)):o.failure&&"function"==typeof o.failure&&o.failure(t.result)):o.failure&&o.failure({BK_STATUS:"01",BK_DESC:"STM库存HTTP网络请求出错:"+JSON.stringify(t)})}catch(t){throw console.log("stm后台管理服务返回解析出错:"+t.message),console.log(t.stack),t.description="stm后台管理服务返回解析出错:"+t.description,t}})}else $.ajax({async:o.async,data:t,
type:o.type||PJF.constants.AJAX_METHOD,dataType:o.dataType||PJF.constants.AJAX_DATA_TYPE,url:o.url,success:function(t){console.log("stm后台管理服务"+o.fwServiceId+"返回结果:"+JSON.stringify(t)),t&&t.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?(o.success&&o.success(t),i(t)):o.failure&&o.failure(t)},error:function(t,e,n){console.log(JSON.stringify(t.statusCode())),console.log("stm后台管理服务"+o.fwServiceId+"异常返回结果:"+e+","+n);var i=t.statusCode();if(0==i.readyState&&0==i.status&&"error"==i.statusText&&o.retryTime<=3)return o.retryTime++,void PJF.communication.stmManageAjax(o);o.failure&&o.failure({BK_STATUS:"01",BK_DESC:"STM库存HTTP网络请求出错:"+e+","+n})},complete:function(){n&&n.destroy()}})}else o.success&&o.success({});function i(t){if(("stm.doModifyCardKeySurplus"==o.fwServiceId||"stm.doSellCheques"==o.fwServiceId)&&t.STM_LOW_STORAGE){var e={};e.busiName=t.STM_LOW_STORAGE_DESC,e.dealContent={CARDKEY_TYPE:t.CARDKEY_TYPE,CHECK_TYPE:t.CHECK_TYPE,LEFT_CARDKEY:t.LEFT_CARDKEY},PJF.communication.callPad(e)}}},
PJF.communication.sendCPSJsonReq=function(conf,data,params){conf.retryTime=void 0===conf.retryTime?-1:conf.retryTime;var beginTime=(new Date).getTime();return $.ajax({url:conf.url||PJF.constants.DEFAULT_ACTION,dataType:conf.dataType||PJF.constants.AJAX_DATA_TYPE,data:data,traditional:conf.traditional,async:!1!==conf.async,type:PJF.constants.AJAX_METHOD,timeout:conf.timeOut||PJF.constants.AJAX_TIMEOUT,success:function(data){params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=void 0),data?("string"==typeof data&&(data=eval("("+data+")")),data._COMMON=data._COMMON||{},data.BK_STATUS&&data.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?(data._COMMON&&data._COMMON.SYS_EVT_TRACE_ID?PJF.stm.log(conf.fwTranId+"，流水号："+data._COMMON.SYS_EVT_TRACE_ID,"PJF_LOG_TRANSACTION"):PJF.stm.log(conf.fwTranId,"PJF_LOG_TRANSACTION"),conf.success(data)):(PJF.stm.log(conf.fwTranId,"PJF_LOG_TRANSACTION"),conf.failure(data))):alert("提示：无返回数据！")},error:function(t,e,n){console.log(JSON.stringify(t.statusCode())),
params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=void 0);var i=t.statusCode();0!=i.readyState||0!=i.status||"NetworkError"!=i.statusText||-1==conf.retryTime?(PJF.stm.log(conf.fwTranId,"PJF_LOG_TRANSACTION"),"timeout"==e?PJF.configuration.ajaxTimeOut(conf.failure):"parsererror"==e?PJF.configuration.ajaxParseError(conf.failure):PJF.configuration.ajaxFailure(conf.failure)):PJF.communication.retryCps(conf,data)},complete:function(t,e){params.ajaxMask&&(params.ajaxMask.destroy(),params.ajaxMask=void 0),conf.complete&&conf.complete(t,e),console.log("cps ajax共耗时"+((new Date).getTime()-beginTime)+"ms,参数为:"+conf.fwTranId+","+conf.fwServiceId),PJF.communication.afterCPSJsonReq(conf,data,params)}})},PJF.communication.sendToMDM=function(){PJF.communication.Http.SendCrossDomainRequest("http://mdm.jh/zeus/app/checkstatuscallback",$.param({deviceidentifier:PJF.communication.getMDMuuid().result,appPkgName:"STMClient["+PJF.otherInfo.verInfo+"]",
status:"设备编号="+PJF.otherInfo.devId+"|INFO\n机构号="+PJF.roleInfo.orgCode+"|INFO"},!0),3e4,function(t,e){})},PJF.communication.FHTSCpsJsonReq=function(n){n.timeOut=n.timeOut||61e3,n.async=void 0===n.async||n.async,n.post=void 0===n.type||n.type==PJF.constants.AJAX_METHOD;var i=n.failure;if(n.failure=function(){var t=arguments[0];if(n.noTransfer&&t&&t.BK_DESC){var e=t.BK_DESC.match(/(\[)([^\]]*)(\])/);e&&e[2]&&(t.BK_DESC=e[2])}i&&i.apply(n,arguments)},PJF.constants.FHTS_GROUP&&PJF.communication.isInClient()&&!PJF.util.deviceType.pad&&!n.isFHTSZW){var o={};if(!1===PJF.communication.validateCPSJsonReqParams(n,o))return;var t=PJF.communication.prepareCPSJsonReqParams(n,o);if(!1===PJF.communication.beforeCPSJsonReq(n,t,o))return;var e=PJF.constants.FHTS_GROUP,a=$.param(t,!0);PJF.communication.Http.SendCrossDomainAjax(e,a,n.timeOut,n.post,n.async,function(t,e){o.ajaxMask&&(o.ajaxMask.destroy(),o.ajaxMask=void 0),console.log("分行跨域请求返回stats:"+t),console.log("分行跨域请求返回responseData:"+e),
(t=JSON.parse(t)).result=e;try{t.success&&t.result?(t.result=JSON.parse(t.result),t.result&&t.result.BK_STATUS&&t.result.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?n.success&&"function"==typeof n.success&&n.success(t.result):n.failure&&"function"==typeof n.failure&&n.failure(t.result)):n.failure&&"function"==typeof n.failure&&n.failure({BK_DESC:t.error,_COMMON:{}}),n.complete&&n.complete()}catch(t){throw console.log("分行特色路由外呼交易出错:"+t.message),console.log(t.stack),t.description="分行特色路由外呼交易出错:"+t.description,t}})}else PJF.communication.cpsJsonReq(n)},PJF.communication.retryCps=function(n,t){if(console.log("cps resend"),-1!=n.retryTime)if(0==n.retryTime){var i;n.async=void 0===n.async||n.async,n.loadingText&&(i=new PJF.ui.loading({text:n.loadingText})),n.url=n.url||PJF.constants.DEFAULT_ACTION;var e=$.param(t,!0);n.url="http://"+location.host+(n.url.match(/^\/?bosWeb.*/)?"":"/bosWeb/")+n.url
;PJF.communication.Http.SendCrossDomainAjax(n.url,e,n.timeOut||PJF.constants.AJAX_TIMEOUT,!0,n.async,function(t,e){i&&i.destroy(),console.log("retryCps服务返回status:"+t),console.log("retryCps服务返回responseData:"+e),(t=JSON.parse(t)).result=e;try{t.success&&t.result?(t.result=JSON.parse(t.result),t.result&&t.result.BK_STATUS&&t.result.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?n.success&&"function"==typeof n.success&&n.success(t.result):n.failure&&"function"==typeof n.failure&&n.failure(t.result)):n.failure&&n.failure({BK_STATUS:"01",BK_DESC:"retryCps网络请求出错:"+JSON.stringify(t)})}catch(t){throw console.log("retryCps服务返回解析出错:"+t.message),console.log(t.stack),t.description="retryCps服务返回解析出错:"+t.description,t}})}else n.retryTime--,PJF.communication.cpsJsonReq(n)},PJF.communication.cashCpsJsonReq=function(t){return t.cashTransaction=!0,PJF.communication.cpsJsonReq(t)},PJF.communication.FHTSLogReq=function(t){return t=$.extend(!0,{fwServiceId:"databaseTransaction",fwTranId:"update",
sqlId:"stm.insertStmRgstBook_fhts",success:function(){},failure:function(){}},t),PJF.communication.cpsJsonReq(t)},PJF.namespace("PJF.communication"),PJF.communication.websocket=function(e){WebSocket&&(e.url?(this.ws=new WebSocket(e.url),this.ws.onopen=function(){console.log("建立websocket链接,url为:"+e.url),e.onOpen()},this.ws.onmessage=function(t){console.log("收到服务端信息:"+t),e.onMessage(t)}):console.error("websocket没有传入url"))},PJF.communication.websocket.prototype.sendMessage=function(t){console.log("发送服务端信息:"+t),this.ws.send(t)},"undefined"==typeof PJF?(PJF={},PJF.communication={},PJF.padClientEvents={}):(PJF.communication=PJF.communication||{},PJF.padClientEvents=PJF.padClientEvents||{}),window.navigator=window.navigator||{},PJF.communication.isPageLoadSucceed=!1,PJF.PadClientEvents={download:{addNew:"Client_DownloadAddNew",progressUpdate:"Client_DownloadProgress",failed:"Client_DownloadFailed",completed:"Client_DownloadCompleted"},upload:{addNew:"Client_UploadAddNew",
progressUpdate:"Client_UploadProgress",failed:"Client_UploadFailed",completed:"Client_UploadCompleted"},shell:{generalError:"Client_GeneralClientError",lockApp:"Client_LockApplication",keyboardShow:"Client_KeyboardShow",keyboardHide:"Client_KeyboardHide",keyboardHeightChanged:"Client_KeyboardHeightChanged",keyboardClicked:"Client_KeyboardClicked",logAppend:"Client_LogAppend",htmlToPic:"htmlToPic_Done"},player:{videoPlayComplete:"Player_videoPlayComplete"},dns:{dnsResolved:"Dns_Resolved"},device:{pinKeyPressed:"dev_pinKeyPressed",genDeviceEvent:"dev_genDeviceEvent"},tab:{canCloseThisTab:"CanUserCloseThisTab",tabActived:"TabActived"}},PJF.communication.shell={OnGeneralError:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.shell.generalError,t)},OnLockApp:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.shell.lockApp,t)},OnKeyboardShow:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.shell.keyboardShow,t)},OnKeyboardHide:function(t){
PJF.event.asyncPublish(PJF.PadClientEvents.shell.keyboardHide,t)},OnKeyboardClick:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.shell.keyboardClicked,t)},OnKeyboardHeightChanged:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.shell.keyboardHeightChanged,t)},OnLogAppend:function(t,e){var n=[{time:t,detail:e}];PJF.event.asyncPublish(PJF.PadClientEvents.shell.logAppend,n)},OnDnsResolved:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.dns.dnsResolved,t)},OnHtmlToPicDone:function(t,e){return PJF.event.asyncPublish(t,e)}},function(exports){
var _uiMethods=["opendoconline","exit","appRestart","unlockapp","createClientLoading","destroyClientLoading","ChangeMaintainMode","IsSecondScreen","debugwindow","showToolbar","openVideo","playVideo","pauseVideo","showVideoPlayer","hideVideoPlayer","rotateVideoPlayer","showAndRotate","getCurrentVideoUrl","singlepoint","broadcastTabMessage","activateTabByIndex","ExecuteScript","GetCurrentTabIndex","GetActivedTabIndex","IsTabActived","RefreshThisPage","OpenNewTab","CloseThisTab","GetWebBrowserListInUse","ShowLoadingMask","HideLoadingMask","RecordVideo","RecordVideoEx","RecordAudio","RecordAudioEx","TakePicture","GetThumbnailImage","OpenMediaViewer","openCamera","startDetect","endDetect","closeCamera","closeSoftKeyboard","openSoftKeyboard"];exports.CallShellExt=function(t,e,n,i){try{if(PJF.communication.isInClient()){if("Kylin"!=PJF.communication.getClientType()){var o=PJF.communication.generateEventId();n.__eventId__=o,i&&PJF.event.onceSubscriber(o,function(){i.apply(window,arguments)})
;var a=external.callDynamicExt(t,e,JSON.stringify(n),o);return JSON.parse(a)}return PJF.communication.CallClientPro(t,e,n,i)}return{success:!1,error:"须在客户端里调用此方法",errorCode:"1",result:"0"}}catch(t){return{success:!1,error:"call client exception"+t,errorCode:"1",result:" "}}},exports.CallClientPro=function(t,e,n,i){try{if(PJF.communication.isInClient()){var o=PJF.communication.generateEventId();if(i&&PJF.event.onceSubscriber(o,function(){i.apply(window,arguments)}),"Kylin"!=PJF.communication.getClientType()){var a=external.InvokeFromJsPro(t,e,JSON.stringify(n),o);return JSON.parse(a)}var s={success:!0,errorCode:"0",error:"",result:""},r=null!=i||null!=n.eventId;null!=n.eventId&&(o=n.eventId);var c=0<=_uiMethods.indexOf(e)?"12316":"12315";return $.ajax({async:r,type:"post",url:"http://localhost:"+c+"/CallClient",data:JSON.stringify({moduleId:t,method:e,jsonArgs:JSON.stringify(n),eventId:o}),contentType:"text/plain",success:function(t){
r?"[object Array]"==Object.prototype.toString.call(t)?(t.unshift(o),PJF.event.asyncPublish.apply(window,t)):PJF.event.asyncPublish(o,t):s=t},error:function(t){s=JSON.stringify({success:!1,errorCode:"0",error:t,result:0})}}),s}return{success:!1,error:"须在客户端里调用此方法",errorCode:"1",result:"0"}}catch(t){return{success:!1,error:"call client exception"+t,errorCode:"1",result:" "}}},exports.CallClient=function(funcName,paramJson,remoteDebugCallback){try{if(PJF.communication.isInClient()){if("Kylin"!=PJF.communication.getClientType()){var remoteFunc={methodName:funcName,inData:paramJson},tmp=window.external.InvokeFromJs(JSON.stringify(remoteFunc)),retJson=eval("("+tmp+")");return retJson}return PJF.communication.CallClientPro("LegacyAPI",funcName,paramJson,null)}var ret="0";return{success:!1,error:"须在客户端里调用此方法",errorCode:"1",result:ret}}catch(t){return{success:!1,error:"call client exception"+t,errorCode:"1",result:" "}}}}(PJF.communication),PJF.communication.isInClient=function(){
return window.external&&void 0!==window.external.InvokeFromJs||"Win32"!=navigator.platform},PJF.communication.getClientType=function(){try{switch(navigator.platform){case"Linux aarch64":return"Kylin";case"Linux armv81":return"android";case"Win32":return"windows";default:return!1}}catch(t){return"windows"}},PJF.communication.readTextFile=function(t,e){var n=PJF.communication.generateEventId();return PJF.event.onceSubscriber(n,e),PJF.communication.CallClient("readTextFile",{eventId:n,jsonArgs:JSON.stringify(t)})},PJF.communication.writeTextFile=function(t,e,n){var i={fileName:t,content:e=encodeURIComponent(e),charset:null==n?"utf-8":n},o={jsonArgs:JSON.stringify(i)};return PJF.communication.CallClient("writeTextFile",o)},PJF.communication.saveBase64Image=function(t,e){var n={imgEncodeByBase64:t,saveFullPath:e};return PJF.communication.CallClient("saveBase64Image",n)},PJF.communication.setIdleInterval=function(t){var e={idleInterval:t||6e4}
;PJF.communication.CallClient("setIdleInterval",e)},PJF.communication.ClearCache=function(){return PJF.communication.CallClient("ClearCache",{type:"",key:""})},PJF.communication.Refresh=function(){return PJF.communication.CallClient("Refresh",{type:"",key:""})},PJF.communication.PageLoadSucceed=function(){return 1!=arguments.length||1!=arguments[0]&&0!=arguments[0]||(PJF.communication.isPageLoadSucceed=arguments[0]),PJF.communication.isPageLoadSucceed},PJF.communication.Database={SqlQuery:function(t){var e={sqlStr:t};return PJF.communication.CallClient("ExecSql",e)},Write:function(t,e,n,i){var o={type:t,key:e,value:n,bForceUpdate:i};return PJF.communication.CallClient("setvalue",o)},Read:function(t,e){var n={type:t,key:e};return PJF.communication.CallClient("getvalue",n)},Delete:function(t,e){var n={type:t,key:e};return PJF.communication.CallClient("delvalue",n)}},PJF.communication.localStorage={setValue:function(t,e){
PJF.communication.isInClient()?PJF.communication.Database.Write(1,t,e,!0):window.localStorage.setItem(t,e)},getValue:function(t){if(PJF.communication.isInClient())return PJF.communication.Database.Read(1,t);var e=window.localStorage.getItem(t);return null==e?{success:!1,error:"Not Exist",errorCode:"1",result:""}:{success:!0,error:"",errorCode:"",result:e}},removeItem:function(t){PJF.communication.isInClient()?PJF.communication.Database.Delete(1,t):window.localStorage.removeItem(t)},clear:function(){PJF.communication.isInClient()||window.localStorage.clear()}},PJF.communication.sessionStorage={setValue:function(t,e){PJF.communication.isInClient()?PJF.communication.Database.Write(0,t,e,!0):window.sessionStorage.setItem(t,e)},getValue:function(t){if(PJF.communication.isInClient())return PJF.communication.Database.Read(0,t);var e=window.sessionStorage.getItem(t);return null==e?{success:!1,error:"Not Exist",errorCode:"1",result:""}:{success:!0,error:"",errorCode:"",result:e}},
removeItem:function(t){PJF.communication.isInClient()?PJF.communication.Database.Delete(0,t):window.sessionStorage.removeItem(t)},clear:function(){PJF.communication.isInClient()||window.sessionStorage.clear()}},PJF.communication.OpenDocOnline=function(t,e,n,i){if(t=PJF.util.addAtchBtchNoToUrl(t),e=1==e,n=n||{},i){var o=PJF.communication.generateEventId();PJF.event.onceSubscriber(o,i),n.eventId=o}n.readButtonText=n.readButtonText||"我已阅读";var a={docFullAddr:t,canPrintPdf:e,printerArgs:JSON.stringify(n)};return PJF.communication.CallClient("opendoconline",a)},PJF.communication.AppExit=function(){return PJF.communication.CallClient("exit","")},PJF.communication.AppRestart=function(t){var e={jsonArgs:t||""};return PJF.communication.CallClient("appRestart",e)},PJF.communication.LockComputer=function(){return PJF.communication.CallClient("lockcomputer","")},PJF.communication.UnlockApp=function(){return PJF.communication.CallClient("unlockapp","")},PJF.communication.PlaySound=function(t){
var e=["Ding","Error","Exclamation","Logoff","Logon","Notify","Unlock"];-1==e.indexOf(t)&&(t=e[0]);var n={soundType:t};return PJF.communication.CallClient("playsound",n)},PJF.communication.Common={QrCodeVerify:function(t){var e={codeStr:t};return PJF.communication.CallClientPro("QrCode","Verify",e,null)}},PJF.communication.HtmlToJpg=function(t,e,n,i){try{var o=PJF.communication.generateEventId();PJF.event.onceSubscriber(o,i);var a={html:encodeURIComponent(t),imgWidth:e,imgHeight:n,eventId:o};return PJF.communication.CallClient("htmlToJpg",a)}catch(t){return{success:!1,error:"call client exception"+t,errorCode:"1",result:" "}}},PJF.communication.createClientLoading=function(t){var e={timeout:t};return PJF.communication.CallClient("createClientLoading",e)},PJF.communication.destroyClientLoading=function(){return PJF.communication.CallClient("destroyClientLoading",{})},PJF.communication.changeMaintainMode=function(t){
return PJF.communication.CallClientPro("MutliScreenManager","ChangeMaintainMode",{enable:t})},PJF.communication.isSecondScreen=function(){return"true"===PJF.communication.CallClientPro("MutliScreenManager","IsSecondScreen",{}).result.toLowerCase()},PJF.communication.DebugExtension=function(t){var e={show:t};return PJF.communication.CallClient("debugwindow",e)},PJF.communication.ShowKeyboard=function(){return PJF.communication.CallClient("keyboard","")},PJF.communication.DnsResolve=function(t,e){var n={domainName:t,serverIp:e};return PJF.communication.CallClient("dnsResolve",n)},PJF.communication.GetIp=function(){return PJF.communication.CallClient("getIpAddress","")},PJF.communication.GetMac=function(){return PJF.communication.CallClient("getMacAddress","")},PJF.communication.GetMachine=function(){return PJF.communication.CallClient("getMachineInfo","")},PJF.communication.GetCpuNo=function(){return PJF.communication.CallClient("getCpuNo","")},PJF.communication.GetUniqueNo=function(){
return PJF.communication.CallClient("getUniqueNo","")},PJF.communication.GetClientInfo=function(){return PJF.communication.CallClient("getLocalVersion","")},PJF.communication.Encrypt=function(t,e,n,i){var o={data:t,userName:e,key:n,secNodeId:i};return PJF.communication.CallClient("encrypt",o)},PJF.communication.Encrypt0x88=function(t,e,n,i){var o={count:t,userName:e,key:n,secNodeId:i};return PJF.communication.CallClient("encrypt0x88",o)},PJF.communication.Decrypt=function(t,e,n,i){var o={data:t,userName:e,key:n,secNodeId:i};return PJF.communication.CallClient("decrypt",o)},PJF.communication.SecAPI={E2EEncryptPin:function(t,e,n,i,o){var a={secNodeId:t,userName:e,key:n,pan:i,pin:o};return PJF.communication.CallClient("E2EEncryptPin",a)},E2EEncryptPwd:function(t,e,n,i,o){var a={type:t,secNodeId:e,clientId:n,key:i,data:o};return PJF.communication.CallClient("E2EEncryptPwd",a)},generateMac:function(t,e,n,i){var o={data:i,userName:t,key:e,secNodeId:n}
;return PJF.communication.CallClient("generateMac",o)}},PJF.communication.player={OpenVideo:function(t,e){var n;return n=4==e.length?{url:t,left:e[0],top:e[1],width:e[2],height:e[3]}:{url:t,left:null,top:null,width:null,height:null},PJF.communication.CallClient("openVideo",n)},PlayVideo:function(){return PJF.communication.CallClient("playVideo","")},PauseVideo:function(){return PJF.communication.CallClient("pauseVideo","")},ShowVideoPlayer:function(t){var e;return e=4==t.length?{left:t[0],top:t[1],width:t[2],height:t[3]}:{left:null,top:null,width:null,height:null},PJF.communication.CallClient("showVideoPlayer",e)},HideVideoPlayer:function(){return PJF.communication.CallClient("hideVideoPlayer","")},RotateVideoPlayer:function(t){var e={degree:t};return PJF.communication.CallClient("rotateVideoPlayer",e)},ShowAndRotate:function(t,e,n,i,o){var a={left:t,top:e,width:n,height:i,rotataDegree:o};return PJF.communication.CallClient("showAndRotate",a)},GetCurrentVideoUrl:function(){
return PJF.communication.CallClient("getCurrentVideoUrl","")},OnVideoPlayComplete:function(){PJF.event.asyncPublish(PJF.PadClientEvents.player.videoPlayComplete)},PlaySoundByUrl:function(t,e){var n={url:t,playNow:!(!1===e)};return PJF.communication.CallClient("playsoundByUrl",n)},SpeekText:function(t,e){e||(e=-1);var n={text:t,volume:e};return PJF.communication.CallClient("speekText",n)}},PJF.communication.log={WriteLog:function(t){var e={logStr:encodeURIComponent(t)};return PJF.communication.CallClient("writelog",e)},WriteAppMonLog:function(t){var e={logStr:encodeURIComponent(t),otherInfo:""};return PJF.communication.CallClient("WriteAppMonLog",e)},ReadLog:function(t,e){var n={logType:t,logTime:e};return PJF.communication.CallClient("readlog",n)},ClearLog:function(){return PJF.communication.CallClient("clearlog",{})},GetLatestLogs:function(){return PJF.communication.CallClient("getLatestLogs",{})},GetScreenSnapshotStr:function(t,e){var n={width:t||1280,height:e||720}
;return PJF.communication.CallClient("getScreenSnapShot",n)}},PJF.communication.GetApplicationVersion=function(){return PJF.communication.CallClient("getfwkversion","")},PJF.communication.getMDMuuid=function(){return PJF.communication.CallClientPro("ClientInfo","getMDMuuid",null,null)},PJF.communication.getDevicePhysicalId=function(){return PJF.communication.CallClientPro("ClientInfo","getDevicePhysicalId",null,null)},PJF.communication.SocketServer={OnEvent:function(t,e,n,i){return i?PJF.event.publish(t,e,n):PJF.event.asyncPublish(t,e,n)},StartServer:function(t,e,n){var i={port:t,eof:e,async:!(null==n)};return PJF.communication.CallClientPro("SocketServer","StartServer",i,n)},StopServer:function(t,e){var n={serverId:t,async:!(null==e)};return PJF.communication.CallClientPro("SocketServer","StopServer",n,e)},Send:function(t,e,n){var i={socketid:t,message:e,async:!(null==n)};return PJF.communication.CallClientPro("SocketServer","Send",i,n)},CloseSocket:function(t,e){var n={socketid:t,
async:!(null==e)};return PJF.communication.CallClientPro("SocketServer","CloseSocket",n,e)}},PJF.communication.SocketClient={OnEvent:function(t,e,n,i){return i?PJF.event.publish(t,e,n):PJF.event.asyncPublish(t,e,n)},Connect:function(t,e,n,i){var o={ip:t,port:e,eof:n,async:!(null==i)};return PJF.communication.CallClientPro("SocketClient","Connect",o,i)},Close:function(t,e){var n={socketId:t,async:!(null==e)};return PJF.communication.CallClientPro("SocketClient","Close",n,e)},Send:function(t,e,n){var i={socketId:t,message:e,async:!(null==n)};return PJF.communication.CallClientPro("SocketClient","Send",i,n)}},PJF.communication.TTS={VoicePlay:function(t,e,n,i,o){var a={service:t,content:n};return e&&(a.voice_id=e),i&&(a.timeout=i),PJF.communication.CallShellExt("VoiceMergeExt","VoicePlay",a,o)},VoiceStop:function(){return PJF.communication.CallShellExt("VoiceMergeExt","VoiceStop",{})}},PJF.communication.IAT={Starting:!1,VoiceWakeUpStart:function(t,e,n){var i={word:t,duration:e}
;return PJF.communication.CallShellExt("VoiceWakeUpExt","Start",i,n)},VoiceWakeUpStop:function(t){return PJF.communication.CallShellExt("VoiceWakeUpExt","End",{},t)},OnVoiceWakeUpRecognized:function(t,e){PJF.communication.IAT.Starting||PJF.event.asyncPublish("VoiceWakeUp")},StartTransForm:function(t,e){var n={};return t&&(n.param=t),n.file="",PJF.communication.CallShellExt("AudioTransFormExt","StartTransForm",n,e)},StartRecording:function(t,e,n){PJF.communication.IAT.Starting=!0;var i={file:t,duration:n};return PJF.communication.CallShellExt("AudioTransFormExt","StartRecording",i,e)},StopRecording:function(t){return PJF.communication.IAT.Starting=!1,PJF.communication.CallShellExt("AudioTransFormExt","StopRecording",{},t)},VoicePlay:function(t,e,n){var i={param:t,txt:e};return PJF.communication.CallShellExt("SpeechSynthesisExt","Play",i,n)},VoiceStop:function(){return PJF.communication.CallShellExt("SpeechSynthesisExt","Stop",{})},VoiceToFile:function(t,e,n,i){var o={param:t,txt:e,
file:n};return PJF.communication.CallShellExt("SpeechSynthesisExt","TransToFile",o,i)}},PJF.communication.Http={OnCrossDomainResponse:function(t,e,n,i){return i?PJF.event.publish(t,e,n):PJF.event.asyncPublish(t,e,n)},OnPostUploaded:function(t,e,n){return PJF.event.asyncPublish(t,e,n)},SendCrossDomainRequest:function(t,e,n,i,o){var a=PJF.communication.generateEventId();if(i){var s=i;i=function(t,e){"object"==typeof t&&(t=JSON.stringify(t)),"object"==typeof e&&(e=JSON.stringify(e)),s(t,e)}}PJF.event.onceSubscriber(a,i);var r={url:t,data:e,post:!0,headers:o,timeOut:n||3e4,eventId:a};return PJF.communication.CallClient("sendhttp",r)},SendWebCrossDomainRequest:function(t,e,n,i,o){var a=PJF.communication.generateEventId();if(i){var s=i;i=function(t,e){"object"==typeof t&&(t=JSON.stringify(t)),"object"==typeof e&&(e=JSON.stringify(e)),s(t,e)}}PJF.event.onceSubscriber(a,i);var r={url:t,data:e,post:!0,headers:o,timeOut:n||3e4,eventId:a}
;return PJF.communication.CallClient("sendhttpWebService",r)},SendCrossDomainAjax:function(t,e,n,i,o,a){var s={url:t,data:e,post:i,async:o,timeOut:n||3e4};return PJF.communication.CallClientPro("CrossDomainRequest","SendAjax",s,a)},PostUpload:function(t,e,n,i,o){PJF.util.addAtchBtchNoToJsonData(n),$.isFunction(i)&&(o=i,i=null),null==i&&(i=3e4);var a=PJF.communication.generateEventId(),s={url:t,filePath:e,formData:n,eventId:a};if("android"===PJF.communication.getClientType())return s.timeout=i,PJF.event.onceSubscriber(a,o),PJF.communication.CallClient("postUpload",s);var r=PJF.communication.GetClientInfo();return r.success&&"2.0.8.0"<r.result?(s.timeout=i,s.formData=JSON.stringify(n),PJF.communication.CallClientPro("WebPageControl","PostUploadEx",s,o)):(PJF.event.onceSubscriber(a,o),PJF.communication.CallClient("postUpload",s))},SimpleDownload:function(t,e,n,i){return t=PJF.util.addAtchBtchNoToUrl(t),PJF.communication.CallClientPro("FileDownload","SimpleDownload",{path:e,url:t},i)},
SendSocketMsg:function(t,e,n,i,o){var a={ip:t,port:e,data:n,async:i,timeOut:3e4};return PJF.communication.CallClientPro("CrossDomainRequest","SendSocketMsg",a,o)}},PJF.communication.Calculate=function(t,e,n){var i={type:t,val1:e,val2:n};return PJF.communication.CallClient("calculate",i)},PJF.communication.SinglePoint=function(t){var e={url:t};return PJF.communication.CallClient("singlepoint",e)},PJF.communication.Tabs={CanCloseThisTab:function(){return PJF.event.publish(PJF.PadClientEvents.tab.canCloseThisTab)},BroadcastMessage:function(t,e,n){return PJF.communication.CallClientPro("IeTabControl","broadcastTabMessage",{},null)},ActivateTabByIndex:function(t,e){var n={tabIndex:t,jsToInvoke:e};return PJF.communication.CallClient("activateTabByIndex",n)},ExecuteScript:function(t,e){var n={tabIndex:t,jsToInvoke:e};return PJF.communication.CallClientPro("IeTabControl","ExecuteScript",n,null)},GetCurrentTabIndex:function(){
return PJF.communication.CallClientPro("IeTabControl","GetCurrentTabIndex",{},null)},GetActivedTabIndex:function(){return PJF.communication.CallClientPro("IeTabControl","GetActivedTabIndex",{},null)},IsTabActived:function(t){null==t&&(t=-1);var e={tabindex:t};return PJF.communication.CallClientPro("IeTabControl","IsTabActived",e,null)},RefreshThisTab:function(){return PJF.communication.CallClientPro("IeTabControl","RefreshThisPage",{},null)},OpenNewTab:function(t,e){var n={url:t,settings:e};return PJF.communication.CallClientPro("IeTabControl","OpenNewTab",n,null)},CloseThisTab:function(t,e){null==t&&(t=-1);var n={tabIndex:t,onlyHide:e};return PJF.communication.CallClientPro("IeTabControl","CloseThisTab",n,null)},GetWebBrowserListInUse:function(){return PJF.communication.CallClientPro("IeTabControl","GetWebBrowserListInUse",{},null)},ShowLoadingMask:function(t){var e={showTime:t};return PJF.communication.CallClientPro("IeTabControl","ShowLoadingMask",e,null)},
HideLoadingMask:function(){return PJF.communication.CallClientPro("IeTabControl","HideLoadingMask",{},null)}},PJF.communication.FileDownload={Add:function(t,e){var n={fileName:t,url:e};return PJF.communication.CallClient("downloadfile",n)},Pause:function(t){var e={fileName:t};return PJF.communication.CallClient("downloadpause",e)},Cancel:function(t){var e={fileName:t};return PJF.communication.CallClient("downloadcancel",e)},Delete:function(t){var e={fileName:t};return PJF.communication.CallClient("downloaddelete",e)},GetDownloadList:function(){return PJF.communication.CallClient("getdownloadlist","")},OnDownloadNew:function(t){return PJF.event.asyncPublish(PJF.PadClientEvents.download.addNew,t,0,0,"newdownload"),"success"},OnProgressUpdate:function(t,e,n,i){return PJF.event.asyncPublish(PJF.PadClientEvents.download.progressUpdate,t,e,n,"downloading"),"success"},OnDownloadFailed:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.download.failed,t,0,0,"failed")},
OnDownloadCompleted:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.download.completed,t,0,0,"complete")}},PJF.communication.FileUpload={Add:function(t,e,n){var i={filePath:t,url:e};if("android"===PJF.communication.getClientType())return i.timeout=n,PJF.communication.CallClient("uploadfile",i);var o=PJF.communication.GetClientInfo();return o.success&&"2.0.8.0"<o.result?(i.timeout=n,PJF.communication.CallClientPro("FileUpload","UploadEx",i)):PJF.communication.CallClient("uploadfile",i)},Cancel:function(t){var e={fileName:t};return PJF.communication.CallClient("uploadcancel",e)},Delete:function(t){var e={fileName:t};return PJF.communication.CallClient("uploaddelete",e)},GetUploadList:function(){return PJF.communication.CallClient("uploadlist","")},OnUploadNew:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.upload.addNew,t,0,0,"newupload")},OnProgressUpdate:function(t,e,n,i){PJF.event.asyncPublish(PJF.PadClientEvents.upload.progressUpdate,t,e,n,"uploading")},
OnUploadFailed:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.upload.failed,t,0,0,"failed")},OnUploadCompleted:function(t){PJF.event.asyncPublish(PJF.PadClientEvents.upload.completed,t,0,0,"complete")}},PJF.communication.fileSystem={readPdfPic:function(t,e){var n={pdfName:t,pageId:e};return PJF.communication.CallClient("readpdfpage",n)},getPdfPageCount:function(t){var e={pdfName:t};return PJF.communication.CallClient("pdfpagecount",e)},getPdfFilePageCount:function(t){return PJF.communication.CallClientPro("ShellControl","GetPdfFilePageCount",{pdfPath:t},null)},getAppStorageFolder:function(){return PJF.communication.CallClient("getAppFolder",{})},getUserRootDir:function(){return PJF.communication.CallClient("getUserRootDir",{})},getAppWorkingDir:function(){return PJF.communication.CallClientPro("ClientInfo","GetApplicationWorkingPath",{},null)},getAppResourceDir:function(){return{success:!0,error:"",errorCode:"0",
result:"Kylin"==PJF.communication.getClientType()?"/usr/KIOSK/stmClient/resources/":"D:/STMClient/Bin/Resources/"}},readImage:function(t){var e={imagePath:t};return PJF.communication.CallClient("readImage",e)},FO_MOVE:"FO_MOVE",FO_COPY:"FO_COPY",FO_DELETE:"FO_DELETE",FO_RENAME:"FO_RENAME",FO_MKDIR:"FO_MKDIR",FO_DIR:"FO_DIR",fileOperation:function(t,e){var n={eventId:"",jsonArgs:JSON.stringify({operation:t,tasks:e})},i=PJF.communication.CallClient("fileOperation",n);return function(t,e,n){if(n.success&&"FO_DIR"===t){var i=e[0];if(i&&!i.showFolder){var o=JSON.parse(n.result),a=o[0];if(a.success){for(var s=[],r=0,c=a.result.length;r<c;r++)a.result[r].isFolder||s.push(a.result[r]);s.length!==c&&(a.result=s,n.result=JSON.stringify(o))}}}}(t,e,i),i.success&&"FO_DELETE"===t&&(PJF.communication.fileSystem.runWinCmd('"start /b rd /s /q c:\\$Recycle.bin"'),PJF.communication.fileSystem.runWinCmd('"start /b rd /s /q d:\\$Recycle.bin"')),i},EnumerateFiles:function(t,e,n){var i={path:t,
searchPattern:e,option:n};return PJF.communication.CallClientPro("ShellControl","EnumerateFiles",i)},dirCompress:function(t,e,n,i,o){var a=PJF.communication.generateEventId();PJF.event.onceSubscriber(a,o);var s={eventId:a,srcDir:t,ext:e,destDir:n,outFileName:i};return PJF.communication.CallClient("dirCompress",s)},filesCompress:function(t,e,n,i,o){var a=PJF.communication.generateEventId();PJF.event.onceSubscriber(a,o);var s={eventId:a,filesArray:t,ext:e,destDir:n,outFileName:i};return PJF.communication.CallClientPro("ShellControl","FilesCompress",s,o)},writeFile:function(t,e,n,i,o){var a={fullPath:t,content:encodeURIComponent(e),bOverwrite:n,bAutoNewLine:i,charset:null==o?"utf-8":o};return PJF.communication.CallClientPro("ShellControl","WriteFile",a,null)},readFile:function(t,e,n,i){var o={fullPath:t,startLine:e,lines:n};return PJF.communication.CallClientPro("ShellControl","ReadFile",o,null)},getFileLineCount:function(t){
return PJF.communication.CallClientPro("ShellControl","GetFileLineCount",{},null)},getFileSize:function(t){var e={fullPath:t};return PJF.communication.CallClient("getFileSize",e)},runWinCmd:function(t){var e={winCmd:t};return PJF.communication.CallClient("runWinCmd",e)}},PJF.communication.clientOkInLastSession=function(){return PJF.communication.CallClient("didclientclosednormally","")},PJF.communication.counter=0,PJF.communication.generateEventId=function(){return PJF.communication.counter++,"_autoGenEventId_"+Date.now()+"_"+PJF.communication.counter},PJF.communication.OnShellCallBack=function(t,e){PJF.event.asyncPublish.apply(null,arguments)},PJF.communication.IME={OpenWindowsKeyboard:function(t){PJF.communication.devices.CallDevice("AppIME","openWinKeyboard",{},t)},DisableWindowsKeyboard:function(t){PJF.communication.devices.CallDevice("AppIME","disableWinKeyboard",{},t)},EnableWindowsKeyboard:function(t,e){var n={autoTrack:1==e}
;PJF.communication.devices.CallDevice("AppIME","enableWinKeyboard",n,t)},OpenSoftKeyboard:function(t,e){var n={hmode:t};PJF.communication.devices.CallDevice("AppIME","openSoftKeyboard",n,e)},CloseSoftKeyboard:function(t){PJF.communication.devices.CallDevice("AppIME","closeSoftKeyboard",{},t)}},PJF.communication.devices={OnDeviceCallCompleted:function(t,e,n,i){PJF.event.asyncPublish(t,e,n,i)},OnDeviceEvents:function(t,e,n,i){PJF.event.asyncPublish(PJF.PadClientEvents.device.genDeviceEvent,t,e,n,i)},GetDeviceDllPath:function(t,e){return PJF.communication.devices.CallDevice("__DeviceService__","GetDeviceDllPath",t,e)},SetDeviceDllPath:function(t,e){return PJF.communication.devices.CallDevice("__DeviceService__","SetDeviceDllPath",t,e)},GetDeviceConfigs:function(){return PJF.communication.CallClientPro("ShellControl","GetDeviceConfigs",{},null)},IsDeviceRegistered:function(t,e,n,i){var o={deviceType:t,OEMCode:e,HWSpecific:n}
;return PJF.communication.devices.CallDevice("__OEMInfoManager__","IsDeviceRegistered",o,i)},SetTDFingerFlag:function(t){var e={FingerFlag:t};return PJF.communication.devices.CallDevice("__OEMInfoManager__","SetTDFingerFlag",e)},GetTDFingerFlag:function(t){return PJF.communication.devices.CallDevice("__OEMInfoManager__","GetTDFingerFlag",{timeout:60},t)},RegisterDevice:function(t,e,n,i){var o={deviceType:t,OEMCode:e,HWSpecific:n};return PJF.communication.devices.CallDevice("__OEMInfoManager__","RegisterDevice",o,i)},ResetDevice:function(t){var e={deviceType:t};return PJF.communication.devices.CallDevice("__OEMInfoManager__","ResetDevice",e,function(t){})},CallDevice:function(t,e,n,i){if(n.timeout=void 0===n.timeout?30:n.timeout,PJF.communication.isInClient()&&"Kylin"!=PJF.communication.getClientType()){var o=PJF.communication.generateEventId();PJF.event.onceSubscriber(o,i);var a=PJF.communication.CallClient("deviceCall",{deviceName:t,funcName:e,eventId:o,jsonArgs:JSON.stringify(n)})
;return a.eventId=o,a}if(["LHA","AppIME"].includes(t))return PJF.communication.CallClientPro(t+"DevHandler",e,n,i);var s={};return"[object String]"===Object.prototype.toString.call(n)?s.args=n:s.args=JSON.stringify(n),s.deviceId=t,s.funcName=e,$.ajax({type:"POST",url:"http://localhost:12315/CallDevice",data:JSON.stringify(s),contentType:"application/json;charset=utf-8",success:function(t){i&&i(t)},dataType:"text"}),{success:!0,error:"",errorCode:"0",result:0}},CallDeviceSync:function(t,e,n){return n.timeout=void 0===n.timeout?30:n.timeout,PJF.communication.isInClient()?PJF.communication.CallClientPro("ShellControl","CallDeviceSync",{deviceName:t,funcName:e,jsonArgs:JSON.stringify(n)},null):{success:!1,errorCode:1,errorInfo:"不支持本调用",result:""}}},PJF.communication.ShowToolbar=function(t){var e={visible:t};return PJF.communication.CallClient("showToolbar",e)},PJF.communication.MediaCaptureExt={RecordVideo:function(t,e,n,i,o,a){var s={Folder:t,Width:e,Height:n,BitRate:i,TimeLimitSec:o}
;return s.IsEncrypt=PJF.communication.MediaCaptureExt.checkEncryptOptions(0),PJF.communication.CallShellExt("MediaCaptureExt","RecordVideo",s,a)},RecordVideoEx:function(t,e,n,i,o,a){var s={Folder:t,Width:e,Height:n,BitRate:i,TimeLimitSec:o};return s.IsEncrypt=PJF.communication.MediaCaptureExt.checkEncryptOptions(0),PJF.communication.CallShellExt("MediaCaptureExt","RecordVideoEx",s,a)},RecordAudio:function(t,e,n,i){var o={Folder:t,FileNamePattern:e,TimeLimitSec:n};return o.IsEncrypt=PJF.communication.MediaCaptureExt.checkEncryptOptions(1),PJF.communication.CallShellExt("MediaCaptureExt","RecordAudio",o,i)},RecordAudioEx:function(t,e,n,i){var o={Folder:t,FileNamePattern:e,TimeLimitSec:n};return o.IsEncrypt=PJF.communication.MediaCaptureExt.checkEncryptOptions(1),PJF.communication.CallShellExt("MediaCaptureExt","RecordAudioEx",o,i)},TakePicture:function(t,e,n,i){var o={Folder:t,Width:e,Height:n};return o.IsEncrypt=PJF.communication.MediaCaptureExt.checkEncryptOptions(2),
PJF.communication.CallShellExt("MediaCaptureExt","TakePicture",o,i)},GetThumbnailImage:function(t,e,n,i,o){var a={imagePath:t,targetPath:e,targetWidth:n,targetHeight:i,targetFormat:o};return PJF.communication.CallShellExt("MediaCaptureExt","GetThumbnailImage",a)},OpenMediaViewer:function(t,e,n){var i={};return t&&(i.imagePath=t),e&&(i.audioPath=e),n&&(i.videoPath=n),PJF.communication.CallShellExt("MediaViewerExt","OpenMediaViewer",i)},checkEncryptOptions:function(t){var e=PJF.communication.localStorage.getValue("sys_sec_encrypt_flag");return!e.success||(""==e.result||"1"==e.result[t])}},PJF.communication.DynamicShellExtMgr={GetShellExtList:function(){return PJF.communication.CallShellExt("DynamicShellExtMgr","GetShellExtList",{})},UnloadShellExt:function(t){var e={extId:t};return PJF.communication.CallShellExt("DynamicShellExtMgr","UnloadShellExt",e)},LoadShellExt:function(t){var e={extPath:t};return PJF.communication.CallShellExt("DynamicShellExtMgr","LoadShellExt",e)},
ForbidShellExt:function(t){var e={extId:t};return PJF.communication.CallShellExt("DynamicShellExtMgr","ForbidShellExt",e)},UnForbidShellExt:function(t){var e={extId:t};return PJF.communication.CallShellExt("DynamicShellExtMgr","UnForbidShellExt",e)}},PJF.communication.WinPrinterExt={GetAllPrinters:function(){return PJF.communication.CallShellExt("WinPrinterExt","GetAllPrinters",{})},GetPrinterSupportPaperName:function(t){var e={};return e.printerName=t,PJF.communication.CallShellExt("WinPrinterExt","GetPrinterSupportPaperName",e)},PrintImage:function(t,e,n,i,o){var a={};return a.imgFile=t,a.printerName=e,a.paperName=n,a.paperOrientation=i,PJF.communication.CallShellExt("WinPrinterExt","PrintImage",a,o)},PrintPage:function(t,e,n,i){var o={};return o.printerName=t,o.paperName=e,o.paperOrientation=n,PJF.communication.CallShellExt("WinPrinterExt","PrintPage",o,i)}},PJF.communication.CameraFaceSnap={SnapMsgCallback:function(t,e,n){return n?PJF.event.publish(t,e):PJF.event.asyncPublish(t,e)
},InitDevice:function(t,e,n,i,o,a,s,r){var c={ip:t,port:e,userName:n,pwd:i,devNo:o,picFolder:a,cbInterval:s};return PJF.communication.CallShellExt("FaceSnapDeviceExt","InitDevice",c,r)},StartSnap:function(t){return PJF.communication.CallShellExt("FaceSnapDeviceExt","StartSnap",{},t)},StopSnap:function(t){return PJF.communication.CallShellExt("FaceSnapDeviceExt","StopSnap",{},t)},DisposeDevice:function(t){return PJF.communication.CallShellExt("FaceSnapDeviceExt","DisposeDevice",{},t)},ClearCacheFile:function(t,e){var n={date:t};return PJF.communication.CallShellExt("FaceSnapDeviceExt","ClearCacheFile",n,e)}},PJF.communication.device={GET_CARDINFO_COMMAND:"getCardInfo",GET_ACCOUNT_PASSWORD:"getAccountPassword",GET_FINGER_INFO:"getFingerInfo",GET_BANK_BOOK_INFO:"getBankBookInfo",WRITE_FINGER_INFO:"writeFingerInfo",WRITE_BANK_BOOK:"writeBankBook",GET_USERINFO_COMMAND:"getUserInfo",PRINT_DOC:"printDoc",PRINT_SCREEN:"printScreen",GET_IDENTITY_CARD_INFO:"getIdentityCardInfo",
GET_IC_CARD_INFO:"getIcCardInfo",GET_CONF_VALUE:"getConfValue",GET_FINGER_PORT:"getFingerPort",GET_FINGER_TYPE:"getFingerType",GET_PIC_PATH:"getPicPath",WRITE_PIC:"writePic",GET_CONF_FILE:"getConfFile",ENCODE:"encode",DECODE:"decode",GET_BP_PORT:"getBpPort",GET_FILE_BYTES:"getFileBytes",ENCRYPT_PARAM:"encryptParam",ENCRYPT_0X88:"encrypt0x88",CALENDER_CUR_DATE:"calendarCurDate",LOG_ERROR:"logError",SET_TAB_TITLE:"setTabTitle",GET_USERINFO:"getUserInfo",GEN_ARQC:"genARQC",GET_TX_DETAIL:"getTxDetail",SEND_ARQC:"sendARQC",TRANSC_DISP_CONFIRM:"transcDispConfirm",SINGLE_QUESTION:"singleQuestion",MULTI_QUESTION:"multiQuestion",GET_SCHEDULE:"getSchedule",OPEN_NATIVE_WINDOW:"openNativeWindow",OPEN_INNER_WINDOW:"openInnerWindow",GETDEVCONF:"getDevConfig",MAC_CONTENT:"macContent",OPEN_AUTH_PAGE:"openAuthPage",INVOKE_OTHER_SIDE:"invokeOtherSide",AUTH_PACK_UPLOAD:"authPackUpload",TAB_CLOSE:"tabClose",OPEN_TODOINFO:"openTodoInfo",DO_COMMAND:"doCommonCommand",SEND_HTTP:"sendHttp",
GET_MESSAGE_BYNO:"getMessageByKey",GET_CLIENTENV_PROPERTY:"getClientEnv",SET_APP_DATA:"setAppData",GET_APP_DATA:"getAppData",REMOVE_APP_DATA:"removeAppData",SOFT_PHONE:"softPhone",CLICK_MOUSE:"clickMouse",REGISTER_EVENT:"registerEvent",SEND_EVENT:"sendEvent",RIGHT_PANEL_METHOD:"rightPanelCommand",CHECK_FILE_SIZE:"checkFileSize",CONFIRM_TRANSC_DISP:"confirmTranscDisp",LOAD_DEV_CONFIG:"loadDevConfig",SAVE_DEV_CONFIG:"saveDevConfig",TEST_DEV_CONFIG:"testDevConfig",GET_COMPUTER_INFO:"getComputerInfo",OPEN_FRONT_CONFIG:"openFrontConfig",SET_SELECT:"setSelect",CALCULATE_DATA:"calculateData",PRINT_TEXT:"printUrlText",EXECUTE_JS:"executeJS",WRITE_TRACK:"writeTrack",GET_TAB_NUM:"getTabNum",LOG_JS:"logJs",LINE_UP_CALL:"lineupCall",CLOSE_WIN:"closeWin",GET_IP_BY_ROUTEID:"getIPByRouteId",UPLOAD_HTTP_REQ:"uploadHttpReq",TAR_PACKAGE:"tarPackage",ENCODE_URL:"encodeUrl",CALL_DEVICE:"callDevice",GET_UC:"getUC",PRINT_VOUCHER:"printVoucher",PRINT_DOWNLOAD_BATCHFILE:"printDownloadBatchFile",
PJF_CACHE:"pjfCache",CALL_DEVICE_ASYNC:"callDeviceAsync",ENCRYPT_E2E:"encryptE2E",CR_2_TAB:"Cr2Tab",CAMERA_SHOOT:"cameraShoot",FILE_UTILS:"fileUtils"},PJF.communication.client={isInP2:function(){return PJF.communication.isInClient()},encryptParam:function(t){return[0,t]},macContent:function(t){return[0,t]},getClientEnv:function(){return[1,""]},getUniqueNo:function(){var t=PJF.communication.CallClient("getUniqueNo","");return t.success?[0,t.result]:[1,t.error]},init:function(){for(var t in PJF.communication.device){var o=PJF.communication.device[t];PJF.communication.client[o]=function(){try{for(var t=!0,e={},n=0;n<arguments.length;n++)e["param"+n]=arguments[n];for(var i in param){t=!1;break}return t||(e=""),PJF.communication.CallClient(o,e).retVal}catch(t){return 1}}}}},PJF.communication.client.init(),PJF.communication.client.checkVerifyCode=function(t,e){return alert("Not implemented: PJF.communication.client.checkVerifyCode"),1},
PJF.communication.client.serviceEvaluate=function(t,e,n,i){return alert("Not implemented: PJF.communication.client.serviceEvaluate"),1},PJF.communication.client.inputNumber=function(t,e,n,i){return alert("Not implemented: PJF.communication.client.inputNumber"),1},PJF.communication.client.readCISN=function(t){return alert("Not implemented: PJF.communication.client.readCISN"),1},PJF.communication.client.generateKeyPair=function(t,e){return alert("Not implemented: PJF.communication.client.generateKeyPair"),1},PJF.communication.client.downLoadAK=function(t,e,n,i){return alert("Not implemented: PJF.communication.client.downLoadAK"),1},PJF.communication.client.delAcc=function(t,e){return alert("Not implemented: PJF.communication.client.delAcc"),1},PJF.communication.client.addMachineSign=function(t,e,n,i){return alert("Not implemented: PJF.communication.client.addMachineSign"),1},PJF.communication.client.unlockCI=function(t,e){
return alert("Not implemented: PJF.communication.client.unlockCI"),1},PJF.communication.client.issueCI=function(t,e){return alert("Not implemented: PJF.communication.client.issueCI"),1},PJF.communication.client.getCheckCode=function(t,e){return alert("Not implemented: PJF.communication.client.getCheckCode"),1},PJF.communication.client.scan=function(){return alert("Not implemented: PJF.communication.client.scan"),1},PJF.communication.client.getscanners=function(){return alert("Not implemented: PJF.communication.client.getscanners"),1},PJF.communication.client.deleteFile=function(t,e){return alert("Not implemented: PJF.communication.client.deleteFile"),1},PJF.communication.client.rotate=function(t,e){return alert("Not implemented: PJF.communication.client.rotate"),1},PJF.communication.client.zoom=function(t,e,n){return alert("Not implemented: PJF.communication.client.zoom"),1},PJF.communication.client.copyFile=function(t,e){
return alert("Not implemented: PJF.communication.client.copyFile"),1},PJF.communication.client.renameFile=function(t,e){return alert("Not implemented: PJF.communication.client.renameFile"),1},PJF.communication.client.showUI=function(){return alert("Not implemented: PJF.communication.client.showUI"),1},PJF.communication.client.serviceEvaluateAsync=function(t,e,n,i,o,a){return alert("Not implemented: PJF.communication.client.serviceEvaluateAsync"),1},PJF.communication.client.getSecTrackData=function(){return alert("Not implemented: PJF.communication.client.getSecTrackData"),1},PJF.communication.client.getICCardData=function(){return alert("Not implemented: PJF.communication.client.getICCardData"),1},PJF.communication.client.validateCode=function(t,e){return alert("Not implemented: PJF.communication.client.validateCode"),1},PJF.communication.client.getCardRdWrtCap=function(){return alert("Not implemented: PJF.communication.client.getCardRdWrtCap"),1},
PJF.communication.client.printVoucher=function(t){return alert("Not implemented: PJF.communication.client.printVoucher"),1},PJF.communication.client.printTxt2DimCode=function(t,e,n){return alert("Not implemented: PJF.communication.client.printTxt2DimCode"),1},function(){var ws,_init=function(){var lockReconnect=!1,publishroutes={shell_OnKeyboardHide:"PJF.communication.shell.OnKeyboardHide",shell_OnKeyboardShow:"PJF.communication.shell.OnKeyboardShow",shell_OnKeyboardClick:"PJF.communication.shell.OnKeyboardClick",shell_OnKeyboardHeightChanged:"PJF.communication.shell.OnKeyboardHeightChanged",shell_OnLockApp:"PJF.communication.shell.OnLockApp",shell_OnLogAppend:"PJF.communication.shell.OnLogAppend",shell_OnDnsResolved:"PJF.communication.shell.OnDnsResolved",shell_OnHtmlCaptured:"PJF.communication.shell.OnHtmlToPicDone",shell_OnCallBack:"PJF.communication.OnShellCallBack",FileUpload_OnUploadNew:"PJF.communication.FileUpload.OnUploadNew",
FileUpload_OnProgressUpdate:"PJF.communication.FileUpload.OnProgressUpdate",FileUpload_OnUploadFailed:"PJF.communication.FileUpload.OnUploadFailed",FileUpload_OnUploadCompleted:"PJF.communication.FileUpload.OnUploadCompleted",FileDownload_OnDownloadNew:"PJF.communication.FileDownload.OnDownloadNew",FileDownload_OnProgressUpdate:"PJF.communication.FileDownload.OnProgressUpdate",FileDownload_OnDownloadFailed:"PJF.communication.FileDownload.OnDownloadFailed",FileDownload_OnDownloadCompleted:"PJF.communication.FileDownload.OnDownloadCompleted",Http_OnPostUploaded:"PJF.communication.Http.OnPostUploaded",Http_OnCrossDomainResponse:"PJF.communication.Http.OnCrossDomainResponse",SocketClient_OnEvent:"PJF.communication.SocketClient.OnEvent",SocketServer_OnEvent:"PJF.communication.SocketServer.OnEvent",device:"PJF.communication.devices.OnDeviceEvents"};ws=new WebSocket("ws://127.0.0.1:12320/"),ws.onopen=function(t){console.log("websocket opened.")},ws.onmessage=function(event){try{
var jArgs=JSON.parse(event.data);console.log("websokcet received Message, from:"+jArgs.from+"; data:"+jArgs.data),console.log("client time:"+PJF.util.formatDate(new Date,"yyyyMMddHHmmss"));var funcName=publishroutes[jArgs.from];eval(funcName).apply(window,jArgs.data)}catch(t){console.log("wsEvt.js dispatch message failed:"+t)}},ws.onclose=function(t){console.log("websocket close observed:"+JSON.stringify(t)),1e3!=t.code&&(navigator.onLine||console.log("offline."),_reconnect())},ws.onerror=function(t){console.log("websocket error observed:"+JSON.stringify(t)),_reconnect()};var _reconnect=function(){console.log("retry websokcet init."),lockReconnect||(lockReconnect=!0,setTimeout(function(){_init(),lockReconnect=!1},2e3))}};PJF.util.isKylinSTM()&&_init()}(),"Linux aarch64"!=navigator.platform&&function(){var e,t,o,a,n,s;(function(t){var e=null;t.isInClient=function(){return null===e&&(window.external&&"InvokeFromJs"in external?(e="windows",
!0):window.client&&"callShell"in window.client?(e="android",!0):e=!1),!!e},t.getClientType=function(){return e},t.inClientInnerFlag=t.isInClient();var n=/^[a-z]+:\/\//i;t.createSubWebview=function(t){n.test(t)||(t=location.protocol+"//"+location.host+t),PJF.communication.SinglePoint(t)}}(PJF.communication),PJF.util||(PJF.util={}),PJF.util.compareVersion||(PJF.util.compareVersion=function(t,e){if("string"!=typeof(t=t||"")&&(t+=""),t===(e=e||""))return 0;for(var n,i,o=t.split("."),a=e.split("."),s=0,r=o.length;s<r;s++){if((n=parseInt(o[s]))<(i=parseInt(a[s])))return-1;if(i<n)return 1}return a.length>o.length?-1:1}),function(t,e){if(t.isInClient()){var n="android"===t.getClientType();if(!PJF.constants||"stm"!==PJF.constants.termType||n){var o=e.getUniqueNo;if(e.getUniqueNo=function(){return r(o())},n){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),s=a.length;e.getUniqueNo=function(){var t=o();return 0===t[0]&&t[1].length<24&&(t[1]=t[1]+function(t){
var e=[];for(i=0;i<t;i++)e[i]=a[0|Math.random()*s];return e.join("")}(20)),r(t)}}}}function r(t){return 0===t[0]&&PJF.userInfo&&(t[1]=t[1]+"-"+PJF.userInfo.userCode),t}}(PJF.communication,PJF.communication.client),function(){var t=PJF.communication.GetClientInfo();"string"==typeof t&&(t=JSON.parse(t));var e=t.success?t.result:"1.0",n=PJF.communication.getClientType();("windows"===n&&0<=PJF.util.compareVersion(e,"2.0.5.0")||"android"===n&&0<=PJF.util.compareVersion(e,"1.4.6"))&&(PJF.communication.SinglePoint=PJF.communication.Tabs.OpenNewTab)}(),"android"===(e=PJF.communication).getClientType()?e.GetAppTempFolder=function(){return e.CallClient("getAppTempFolder",{})}:e.GetAppTempFolder=function(){var t=e.fileSystem.getAppStorageFolder();return t.success&&(t.result=t.result+"/Temp"),t},PJF.constants&&"stm"===PJF.constants.termType&&window.external&&"InvokeFromJs"in external)?console.log("cross pad not load in windows stm"):(!function(s){var t=0;s.generateEventId=function(){
return"_autoGenEventId_"+t+++"_"};var i=s.getClientType(),o="windows"===i,a="android"===i;function r(t,e){var n=function(t,e){switch(t){case"setvalue":t="presidentDataStorage";break;case"getvalue":t="presidentDataGet";break;case"delvalue":t="presidentDataDel";break;case"writelog":t="jsLogWR",e.type="w",e.msg=e.logStr;break;case"readlog":t="jsLogWR",e.type="r";break;case"fileOperation":var n=JSON.parse(e.jsonArgs),i=n.tasks[0];i.source&&(i.source=i.source.replace("/AppData/Local/Craig","")),i.dest&&(i.dest=i.dest.replace("/AppData/Local/Craig","")),n.operation==s.fileSystem.FO_COPY?(t="copyFile",e={srcFile:i.source,targetFile:i.dest}):n.operation==s.fileSystem.FO_DELETE?(t="deleteFile",e={srcFile:i.source}):n.operation==s.fileSystem.FO_MOVE?(t="moveFile",e={srcFile:i.source,name:i.dest}):n.operation==s.fileSystem.FO_RENAME?(t="renameFile",e={srcFile:i.source,name:i.dest}):n.operation==s.fileSystem.FO_DIR?(t="listLocalFileByTime",e={dirName:i.source
}):n.operation==s.fileSystem.FO_MKDIR&&(t="mkdir",e={dir:i.source});break;case"readImage":t="getLocalImage",e.localPath=e.imagePath;break;case"ExecSql":t="execSql";break;case"playsound":t="playSound";break;case"opendoconline":t=/\.pdf$/i.test(e.docFullAddr)?"openPDF":"openWord",e.url=e.docFullAddr;break;case"getIpAddress":t="getDeviceIp";break;case"getMacAddress":t="getDeviceMac";break;case"singlepoint":t="openNewWebView";break;case"sendhttp":var o=e.data;"string"==typeof o?e.data=encodeURI(o):"object"==typeof o&&(e.data=PJF.util.toAjaxParam(o));break;case"deviceCall":"cameraPreview"!==e.funcName&&(t="deviceCall"+e.deviceName+e.funcName,"string"==typeof e.jsonArgs&&(e.jsonArgs=JSON.parse(e.jsonArgs)),e=$.extend(e.jsonArgs,{eventId:e.eventId}))}return{methodName:t,inData:e}}(t,e),i=prompt(n.methodName,n.inData&&JSON.stringify(n.inData));return"string"==typeof i?(i=i.replace(/##/g,'\\"'),JSON.parse(i)):i}s.CallClient=function(t,e){try{switch(i){case"windows":return n={methodName:t,
inData:e},JSON.parse(external.InvokeFromJs(JSON.stringify(n)));case"android":return r(t,e);default:return{success:!1,error:"illegal: this method must be called in client",errorCode:"1",result:""}}}catch(t){return{success:!1,error:"call client exception"+t,errorCode:"1",result:""}}var n},s.HtmlToJpg=function(t,e,n,i){var o=PJF.communication.generateEventId();PJF.event.onceSubscriber(o,i);var a={html:encodeURIComponent(t),imgWidth:e,imgHeight:n,eventId:o};return this.CallClient("htmlToJpg",a)},s.DnsResolve=function(t,e,n){var i={domainName:t,serverIp:e};return $.isFunction(n)&&(o?PJF.event.onceSubscriber(PJF.padClientEvents.dns.dnsResolved,n):a&&(i.eventId=this.generateEventId())),this.CallClient("dnsResolve",i)},s.readTextFile=function(t,e){var n=this.generateEventId();return o&&PJF.event.onceSubscriber(n,e),PJF.communication.CallClient("readTextFile",{eventId:n,jsonArgs:JSON.stringify(t)})},a&&(s.log.WriteLog=function(t){var e={logStr:t}
;return PJF.communication.CallClient("writelog",e)},s.log.WriteAppMonLog=function(t){var e={logStr:t,otherInfo:""};return PJF.communication.CallClient("WriteAppMonLog",e)}),s.getLocation=function(){return o?{success:!1,errorMsg:"windows not support"}:PJF.communication.CallClient("getLocation",{})},s.previewPhotosAndroid=function(t,e,n){var i=this.generateEventId(),o=this.generateEventId();return PJF.event.onceSubscriber(i,function(){PJF.event.removeSubscriber(o),$.isFunction(e)&&e()}),$.isFunction(n)&&PJF.event.addSubscriber(o,function(t){}),PJF.communication.CallClient("previewPhotos",{eventId:this.generateEventId(),jsonArgs:JSON.stringify({path:t,onCloseEventId:i,onDeleteImgId:o})})};var c=s.CallShellExt.bind(s);s.CallShellExt=function(t,e,n,i){switch(this.getClientType()){case"android":return function(t,e,n,i){var o=null,a=s.generateEventId();"MediaCaptureExt"===t?"TakePicture"===e?o=s.CallClient("takePics",{path:n.Folder,eventId:a}):"RecordVideo"===e?(n.eventId=a,
o=s.CallClient("MediaCaptureExtRecordVideo",n)):"RecordAudio"===e?(n.eventId=a,o=s.CallClient("MediaCaptureExtRecordAudio",n)):"GetThumbnailImage"===e&&(n.eventId=a,o=s.CallClient("GetThumbnailImage",n)):"MediaViewerExt"===t&&(n.eventId=a,o=s.CallClient("CaptureExtOpenMediaViewer",n));o||(console.log("no shell ext transfomr, use default: ",t,e,n),n.eventId=a,o=s.CallClient(t+e,n));return o?($.isFunction(i)&&PJF.event.onceSubscriber(a,i),o):c(t,e,n,i)}(t,e,n,i);default:return c(t,e,n,i)}},"android"===s.getClientType()&&(s.CallClientPro=function(t,e,n,i){var o=s.generateEventId();(n=n||{}).eventId=o;var a=s.CallClient(e,n);return a&&$.isFunction(i)&&PJF.event.onceSubscriber(o,i),a}),s.Android2Mdm=function(t,e){var n={ticket:t,versionName:e};return PJF.communication.CallClient("android2mdm",n)},s.noticeClientUserStatusChanged=function(t){return this.CallClient("noticeClientUserStatusChanged",t)}}(PJF.communication),t=PJF.event,o=t.publish.bind(t),a=Array.prototype.slice,
t.publish=function(t,e,n){"onCompCreated"!==t&&console.log(">>>publish -- ",t,e,n),"string"==typeof e&&(e=e.replace(/##/g,'\\"'));var i=a.call(arguments,2);o.apply(null,[t,e].concat(i))},function(d){var t="android"===d.getClientType(),h=!0;if(t){var e=PJF.communication.GetClientInfo();"string"==typeof e&&(e=JSON.parse(e));var n=e.success?e.result:"1.0";h=0<PJF.util.compareVersion("1.4.4",n)}function m(t,e,n,i){return d.devices.CallDevice("PAD_SXT","cameraPreview",{path:t+"/"+(new Date).getTime()+".jpg",width:e,height:n},i)}function p(t,e,n,i,o){return h?m(t,e,n,i):(a=t,s=e,r=n,c=i,l=o,u=PJF.communication.generateEventId(),PJF.event.onceSubscriber(u,f.bind(null,l,s,r,c)),d.CallClient("takePics",{path:a,eventId:u,width:s,height:r}));var a,s,r,c,l,u}function f(t,e,n,i,o){var a;(o=JSON.parse(o)).success&&(o=function(t,e,n){var s=[];"string"==typeof n.result&&(n.result=JSON.parse(n.result)||[]);var i=n.result;if(n.success&&200<=t){i.forEach(function(t){
var e=t.split("."),n=e[e.length-1],i=t.replace(new RegExp("."+n+"$"),"_thumbnail."+n),o=d.MediaCaptureExt.GetThumbnailImage(t,i,200,200,n),a=o;"string"==typeof o&&(a=JSON.parse(o)),a.success?(s.push(i),s.push(a.result)):(s.push(""),s.push(""),console.error("Error happed when make thumbnail",o))})}return{pathArr:i,thumbnailArr:s}}(e,0,o),o=2===t?function(t){for(var e=[],n=t.pathArr,i=t.thumbnailArr,o=0;o<n.length;o++)e.push({path:n[o],thumbnail:i[2*o],base64:i[2*o+1]});return{success:!0,result:e}}(o):{success:!0,result:(a=o).pathArr.concat(a.thumbnailArr)}),$.isFunction(i)&&i(o)}function o(t,e,n,i,o){var a,s,r,c,l,u=d.getClientType();if("android"===u)p(t,e,n,i,o);else{if("windows"!==u)return{success:!1,error:"take photo must be called in shell"};a=t,s=e,r=n,c=i,l=o,d.MediaCaptureExt.TakePicture(a,s,r,f.bind(null,l,s,r,c))}}d.TakePhoto=function(t,e,n,i){return o(t,e,n,i,1)},d.TakePhoto2=function(t,e,n,i){return o(t,e,n,i,2)},t&&(d.MediaCaptureExt.TakePicture=d.TakePhoto),
t&&(d.androidTakePhoto=m),d.DeleteDir=t?function(t){return PJF.communication.fileSystem.fileOperation(PJF.communication.fileSystem.FO_DELETE,[{source:t}])}:function(t){var e='RD /S /Q "{path}"'.replace("{path}",t);return PJF.communication.fileSystem.runWinCmd(e)}}(PJF.communication),(n=PJF.html)&&n.resize2keyboard&&$(function(){setTimeout(function(){n.resize2keyboard()},10)}),(s=PJF.communication).anyofficeLogin=function(t,e,n,i,o){var a=s.generateEventId();return PJF.event.onceSubscriber(a,o),s.CallClient("anyOfficeLogin",{hostIp:t,hostPort:e,userName:n,userPass:i,eventId:a})},s.anyofficeAddList=function(t,e){return s.CallClient("anyOfficeAddList",{useWhitelist:!!e,addList:t})},s.setCanDeviceBack=function(t){return s.CallClient("setCanDeviceBack",{back:!!t})},s.getLocation=function(t){var e=s.generateEventId();return PJF.event.onceSubscriber(e,t),s.CallClient("getLocation",{eventId:e})},s.barcodeScan=function(t){var e=s.generateEventId();return PJF.event.onceSubscriber(e,t),
s.CallClient("barcodeScan",{eventId:e})},s.navigation=function(t,e,n){return s.CallClient("navigation",{address:n,lat:t,lon:e})})}(),PJF.multiCenter=function(){var a={},s="_sys_domain_setting_",r="mobile"===PJF.constants.termType;function i(t,e){e=e||a.getCenterID()||"1";var n=a._centerMap[e];return n?n[t]||"":(console.error("no centerId found: "+e),"")}function o(t,e){var n=i(t,e);return n&&(n=n.split(":")),n}var c="xxx";return $.extend(a,{_save:function(t){var e;e=r?PJF.client.storage.localSet:PJF.util.localSet;var n=t.RESULT_DATA.scp,i=function(){switch(PJF.constants.termType){case"mobile":return"mob";case"pad":return"pub";case"stm":return"mgt"}}(),o={centerID:n,domain:a._getIPByCluster(i,n),port:a.getPortByCluster(i,n),cnt:t.RESULT_DATA.dns};a._centerMap[n].cnt=t.RESULT_DATA.dns,e(s,c=o)},_queryCenter:function(t,e,n,i){return PJF.communication.cpsJsonReq({fwServiceId:"stm.DNSLocator",async:i,fwTranId:"DNSLocator",jsonData:JSON.stringify({insid:t,devChlTp:"003"}),
success:function(t){a._save(t),e&&e(t)},failure:function(t){n&&n(t)}})},_getIPByCluster:function(t,e){var n=o(t,e);return n?n[0]:""},getCenterCfg:function(){var t;return"xxx"==c&&(t=r?PJF.client.storage.localGet:PJF.util.localGet,(c=t(s))?console.log(">>>> read center cfg ok"):console.log(">>>>> no center cfg found <<<<<")),c},getCenterID:function(){return(a.getCenterCfg()||{}).centerID},getDomainByCenter:function(t,e){return i(t,e)},getPortByCluster:function(t,e){var n=o(t,e);return n&&1<n.length?n[1]:80}})}(),PJF.multiCenter._centerMap={1:{pub:"pub.nemc.jh",mgt:"mgt.nemc.jh",cnt:"cnt01.nemc.jh",stm:"stm.nemc.jh",lt:"lt.ecip.jh",im:"im.nemc.jh",mob:"mb.by.nemc.jh"},0:{pub:"pub.wn.nemc.jh",mgt:"mgt.wn.nemc.jh",cnt:"cnt01.wn.nemc.jh",stm:"stm.wn.nemc.jh",lt:"lt.ecip.jh",im:"im.nemc.jh",mob:"mb.wn.nemc.jh"},2:{mgt:"mgt.nemc.jh"}},PJF.namespace("PJF.util"),$.extend(PJF.util,function(t){function e(n){return function(t,e){n.setValue(t,JSON.stringify({_s_warp_:e}))}}function n(n){
return function(t){var e=n.getValue(t);return e.success?(e.result=JSON.safeParse(e.result,e.result),$.isPlainObject(e.result)&&e.result.hasOwnProperty("_s_warp_")&&(e=e.result._s_warp_),e):null}}var i,a=0;function s(t,e){return-1!==(t=t||"").indexOf(e)}var r=/jsonData=([^&]+)/;function c(t){var e=r.exec(t);return e&&e[1]&&(o=l(e[1]),o&&(t+="&"+$.param(o))),t}function l(t){var e=PJF.util.encryptData(t);return e?{_terminal_type:PJF.constants.termType,OPER_CODE:PJF.userInfo.userCode,macData:e}:null}return{localSet:e(t.localStorage),localGet:n(t.localStorage),sessionSet:e(t.sessionStorage),sessionGet:n(t.sessionStorage),encryptData:function(t){if(!PJF.util._canMacEncrypt())return null;if(i){var e=PJF.communication.SecAPI.generateMac(i.userId,i.secretKey,i.secNodeId,t);return e.success?e.result:(console.log("error in Encrypt jsonData ",e),null)}return(i=PJF.util.sessionGet("_sys_pjf_encrypt_info_"))?void 0:null},padCrossReqMacEncrypt:function(t){if(PJF.userInfo&&PJF.userInfo.userCode){
if(!PJF.util._canMacEncrypt())return null;if(!s(t.url,"macData=")&&s(t.url,"/bosWeb/")&&s(t.url,".action")){var e=!1;if(t.data)if("string"!=typeof t.data||s(t.url,"macData=")){if("string"==typeof t.data.jsonData){var n=l(t.data.jsonData);n&&$.extend(t.data,n),e=!0}}else t.data=c(t.data),e=!0;else e||(t.url=c(t.url))}}},_canMacEncrypt:function(){if(0===a&&(a=!1,PJF.communication.isInClient())){var t=PJF.communication.GetClientInfo();"string"==typeof t&&(t=JSON.parse(t));var e=t.success?t.result:"1.0",n=PJF.communication.getClientType();("windows"===n&&0<=PJF.util.compareVersion(e,"2.0.8.0")||"android"===n&&0<=PJF.util.compareVersion(e,"1.4.8"))&&(a=!0)}return a||(console.warn("can not Mac Encrypt Json data"),PJF.constants.NO_AJAX_PREFILTER=!0),a}}}(PJF.communication)),PJF.namespace("PJF.html"),PJF.html.getUrlParam=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(e);return null!=n?decodeURIComponent(n[2]):null},function(){
var e=JSON.parse.bind(JSON);JSON.parse=function(t){return"object"==typeof t?t:e(t)}}(),window.PJF=window.PJF||{},PJF.communication=PJF.communication||{},PJF.communication.shellTab=function(t){var i=$({}),o="tabCommu.",s=window.external&&"InvokeFromJs"in external?"windows":window.client&&"callShell"in window.client?"android":"browser";var r={success:!1,error:"illegal: this method must be called in client",errorCode:"1",result:""};function c(t,e){switch(s){case"windows":return o=t,a=e,JSON.parse(external.InvokeFromJs(JSON.stringify({methodName:o,inData:a})));case"android":return n=e,i=prompt(t,JSON.stringify(n)).replace(/##/g,'\\"'),JSON.parse(i);default:return r}var n,i,o,a}function l(t){var e=JSON.stringify({tabIndex:t,onlyHide:!1});switch(s){case"windows":return function(t){try{external.InvokeFromJsPro("IeTabControl","CloseThisTab",t,"")}catch(t){console.log("须在客户端里调用此方法")}}(e);case"android":return void prompt("CloseThisTab",e);default:return r}}function n(t,n,e){
if(!t||!$.isFunction(n))return console.log("invalid args");i[e](o+t,function(t,e){n(e)})}return{getCurrentTabIndex:function(){return c("getCurrentTabIndex",{})},tabActiveWithMsg:function(t,e,n){var i=PJF.communication.Tabs.GetCurrentTabIndex(),o=i.success?i.result:-1,a=c("activateTabByIndex",{tabIndex:t,jsToInvoke:"PJF.communication.shellTab._tabMsgDispatch('"+encodeURIComponent(JSON.stringify({eventName:e,data:n}))+"')"});return(this._close_webview||l)(o),a},_close_webview:l,_tabMsgDispatch:function(t){var e;try{e=JSON.parse(decodeURIComponent(t))}catch(t){return console.error(t)}if(!e||!e.eventName)return console.warn("invalid tabMsg!!!");i.trigger(o+e.eventName,e.data)},onMsg:function(t,e){n(t,e,"on")},onceMsg:function(t,e){n(t,e,"one")},offMsg:function(t){i.off(o+t)}}}(),PJF.namespace("PJF.stm.client"),PJF.apply(PJF.stm.client,{callbackList:{},mustDoneBeforeHashChange:{},speMenu:["ACC10001","SPB30001","SPB20001","SPB30002","SPB30003"],isNoPageJump:function(t){
return-1!=PJF.constants.NO_PAGE_JUMP_LIST_DEVICE.indexOf("ALL")||-1!=PJF.constants.NO_PAGE_JUMP_LIST_DEVICE.indexOf(t)},noLoadingList:["PIN_getPinLength","WaitForTaken","CDB_ReadCard","IDC_readCard","callThreeDevice","getIDCardInfo"],callClient:function(i,o,a,s,r,c){if(!1!==a.loadingConf&&-1==PJF.stm.client.noLoadingList.indexOf(o))var t=$.extend({msg:"",opacity:.1,noIcon:!0,timeout:a.timeout||a.iTimeout},a.loadingConf),l=new PJF.ui.loading(t);if(a.deviceStartSound&&PJF.communication.player.PlaySoundByUrl(a.deviceStartSound,!0),!$.isEmptyObject(PJF.otherInfo.moduleParams)){var e=-1<i.indexOf("App_")?i.substr(4):i;PJF.otherInfo.moduleParams[e]&&"remote"==PJF.otherInfo.moduleParams[e].Apl_Tp_ID&&a.iotFunc&&(a._iotCall=!0)}console.log(i+"-"+o+"调用外设参数:",JSON.stringify(a));var u=PJF.communication.devices.CallDevice(i,o,a,function(t){PJF.event.publish(PJF.stmEvent.PJF_STM_CALL_DEVICE_BACK,u.eventId),u.eventId&&delete PJF.stm.client.callbackList[u.eventId],
!1!==a.loadingConf&&-1==PJF.stm.client.noLoadingList.indexOf(o)&&l.destroy(),console.log(i+"-"+o+"外设返回结果:",t);var e=PJF.stm.client.initCallback(t,r,c,a);if(!e.status){var n=["外设模块:",i,",命令:",o,",调用出错，错误码为:",e.errorCode,",错误信息为:",e.errorMsg];PJF.event.publish(PJF.stmEvent.DEVICE_ERR,n.join(""))}s&&s(e)});return PJF.event.publish(PJF.stmEvent.PJF_STM_CALL_DEVICE,u.eventId),u.eventId&&PJF.stm.client.isNoPageJump(i)&&(PJF.stm.client.callbackList[u.eventId]=i),u.success||(PJF.event.publish(PJF.stmEvent.PJF_STM_CALL_DEVICE_BACK,u.eventId),-1==PJF.stm.client.noLoadingList.indexOf(o)&&l.destroy(),PJF.event.removeSubscriber(u.eventId),u.eventId&&delete PJF.stm.client.callbackList[u.eventId],console.log("外设调用直接出错:",JSON.stringify(u)),s&&setTimeout(function(){s({status:0,errorCode:u.errorCode,errorMsg:u.error})},0)),u},callClientSync:function(t,e,n,i){console.log(t+"-"+e+"调用外设参数:",JSON.stringify(n));var o=PJF.communication.devices.CallDeviceSync(t,e,n)
;if(console.log(t+"-"+e+"外设返回结果:",JSON.stringify(o)),o.success){var a={},s=JSON.parse(o.result);return"DRV0000000"===s.pchErrCode?(a.status=1,a.info=i?i(s):s):a.status=0,a.errorCode=s.pchErrCode,a.errorMsg=s.pchError,a}return{status:0,errorCode:o.errorCode,errorMsg:o.error}},initCallback:function(e,t,n,i){var o={},a=JSON.parse(e);if(a.success){var s=JSON.parse(a.result);if(s.pchErrCode in PJF.stm.client.pchErrEscape&&(s.pchError=PJF.stm.client.pchErrEscape[s.pchErrCode]),"DRV0000000"==s.pchErrCode||s.pchErrCode==i.pchType+"0000001"){if(o.status=1,o.errorCode=s.pchErrCode,o.errorMsg=s.pchError,t)try{o.info=t(s)}catch(t){o.status=0,console.log("外设命令解析返回数据出错:"+t.message+",数据为:"+e)}else o.info=s;o.info&&"0"==o.info.pjfstatus&&(o.status=0,o.errorCode=o.info.pchErrCode,o.errorMsg=o.info.pchError)}else o.status=0,o.errorCode=s.pchErrCode,o.errorMsg=s.pchError,n&&(o.info=n(s))}else o.status=0,o.errorCode=a.errorCode,o.errorMsg=a.error;return o},eventHandler:function(t,e,n,i){
if("PIN"==t&&"pinLengthChange"==e&&PJF.event.publish(PJF.stm.client.events.PIN_LENGTH,i),"CDB"==t&&("cdbInhaled"==e?PJF.event.publish(PJF.stm.client.events.CDB_INHALED):"cdbTaken"==e&&PJF.event.publish(PJF.stm.client.events.CDB_TAKEN)),"KDB"==t&&"kdbTaken"==e&&PJF.event.publish(PJF.stm.client.events.KDB_TAKEN),"IDC"==t&&("idcInhaled"==e?PJF.event.publish(PJF.stm.client.events.IDC_INHALED):"idcTaken"==e&&PJF.event.publish(PJF.stm.client.events.IDC_TAKEN)),"HDP"==t&&("printProgress"==e?PJF.event.publish(PJF.stm.client.events.HDP_PRINT_PROGRESS,i):"printSuccess"==e?PJF.event.publish(PJF.stm.client.events.HDP_PRINT_SUCCESS,i):"printFail"==e&&PJF.event.publish(PJF.stm.client.events.HDP_PRINT_FAIL,i)),"PRT"==t&&"bookTaken"==e&&PJF.event.publish(PJF.stm.client.events.BOOK_TAKEN),
"CHK"==t&&("printProgress"==e?PJF.event.publish(PJF.stm.client.events.CHK_PRINT_PROGRESS,i):"printSuccess"==e?PJF.event.publish(PJF.stm.client.events.CHK_PRINT_SUCCESS,i):"printFail"==e&&PJF.event.publish(PJF.stm.client.events.CHK_PRINT_FAIL,i)),"TCR"==t)switch(e){case"cashInSuccess":PJF.event.publish(PJF.stm.client.events.TCR_CASH_IN_SUCCESS,i);break;case"cashInserted":PJF.event.publish(PJF.stm.client.events.TCR_CASH_INSERTED);break;case"hasRefusedCash":PJF.event.publish(PJF.stm.client.events.TCR_CASH_HAS_REFUSED);break;case"refusedCashTakenTimeout":PJF.event.publish(PJF.stm.client.events.TCR_CASH_REFUSED_TMOUT);break;case"ejectCashComplete":PJF.event.publish(PJF.stm.client.events.TCR_CASH_EJECT_COMPLETE);break;case"ejectCashFail":PJF.event.publish(PJF.stm.client.events.TCR_CASH_EJECT_FAIL,i);break;case"pushCashSucess":PJF.event.publish(PJF.stm.client.events.TCR_PUSH_CASH_SUCCESS);break;case"pushCashFail":PJF.event.publish(PJF.stm.client.events.TCR_PUSH_CASH_FAIL,i);break
;case"cashInFail":PJF.event.publish(PJF.stm.client.events.TCR_CASH_IN_FAIL,i);break;case"dispenseAndPresentComplete":PJF.event.publish(PJF.stm.client.events.TCR_CASH_DISPENSE_COMPLETE);break;case"presentBoxPresent":PJF.event.publish(PJF.stm.client.events.TCR_CASH_BOX_PRE);break;case"presentBoxCashTaken":PJF.event.publish(PJF.stm.client.events.TCR_CASH_BOX_CASH_TAKEN);break;case"cashOutFail":PJF.event.publish(PJF.stm.client.events.TCR_CASH_OUT_FAIL,i);break;case"resetSuccess":PJF.event.publish(PJF.stm.client.events.TCR_RESET_SUCCESS);break;case"resetFail":PJF.event.publish(PJF.stm.client.events.TCR_RESET_FAIL,i)}if("LHT"==t)switch(e){case"DetectTimeout":PJF.event.publish(PJF.stm.client.events.LHT_TMOUT);break;case"DetectLoss":PJF.event.publish(PJF.stm.client.events.LHT_LOSS);break;case"DetectFinish":PJF.event.publish(PJF.stm.client.events.LHT_FINISH);break;case"DetectSuccess":PJF.event.publish(PJF.stm.client.events.LHT_SUCCESS);break;case"CameraFailed":
PJF.event.publish(PJF.stm.client.events.LHT_CAM_FAILED);break;case"SdkFailed":PJF.event.publish(PJF.stm.client.events.LHT_SDK_FAILED)}if("HMI"==t&&"hmiChange"==e&&PJF.event.publish(PJF.stm.client.events.HMI_CHANGE,i),"LHA"==t&&("detectFail"==e?PJF.event.publish(PJF.stm.client.events.LHA_FAIL):"detectSuccess"==e&&PJF.event.publish(PJF.stm.client.events.LHA_SUCCESS)),"PSR"==t&&"psrOneSideCompleted"==e&&PJF.event.publish(PJF.stm.client.events.PSR_COMPLETE),"RTS"==t)switch(e){case"close":PJF.event.publish(PJF.stm.client.events.RTS_CLOSE,i);break;case"audit":PJF.event.publish(PJF.stm.client.events.RTS_AUDIT,i);break;case"call":PJF.event.publish(PJF.stm.client.events.RTS_CALL,i);break;case"queue":PJF.event.publish(PJF.stm.client.events.RTS_QUEUE);break;case"abnormal":PJF.event.publish(PJF.stm.client.events.RTS_ABNORMAL);break;case"resign":PJF.event.publish(PJF.stm.client.events.RTS_RESIGN)}"HVT"==t&&"hvtChange"==e&&PJF.event.publish(PJF.stm.client.events.HVT_CHANGE,i),
"COMMON"==t&&"reserveResult"==e&&PJF.event.publish(PJF.stm.client.events.RSV_RESULT,i),"FTC"==t&&"doorOpenNotice"==e&&PJF.event.publish(PJF.stm.client.events.DOOR_OPEN,i)},ytdHandler:function(t,e){return!PJF.util.deviceType.stm&&(t&&t(e),!0)}}),PJF.stm.client.pchErrEscape={DRVCDB0007:"读取卡片芯片或磁条信息失败，请检查银行卡插卡方向"},PJF.stm.client.events={CDB_TAKEN:"CDB_TAKEN",CDB_INHALED:"CDB_INHALED",KDB_TAKEN:"KDB_TAKEN",IDC_TAKEN:"IDC_TAKEN",IDC_INHALED:"IDC_INHALED",PIN_LENGTH:"PIN_LENGTH",CDB_STOP:"CDB_STOP",IDC_STOP:"IDC_STOP",HDP_PRINT_PROGRESS:"HDP_PRINT_PROGRESS",HDP_PRINT_SUCCESS:"HDP_PRINT_SUCCESS",HDP_PRINT_FAIL:"HDP_PRINT_FAIL",CHK_PRINT_PROGRESS:"CHK_PRINT_PROGRESS",CHK_PRINT_SUCCESS:"CHK_PRINT_SUCCESS",CHK_PRINT_FAIL:"CHK_PRINT_FAIL",BOOK_TAKEN:"BOOK_TAKEN",TCR_CASH_IN_SUCCESS:"TCR_CASH_IN_SUCCESS",TCR_CASH_INSERTED:"TCR_CASH_INSERTED",TCR_CASH_HAS_REFUSED:"TCR_CASH_HAS_REFUSED",TCR_CASH_REFUSED_TMOUT:"TCR_CASH_REFUSED_TMOUT",TCR_CASH_EJECT_COMPLETE:"TCR_CASH_EJECT_COMPLETE",
TCR_CASH_EJECT_FAIL:"TCR_CASH_EJECT_FAIL",TCR_PUSH_CASH_SUCCESS:"TCR_PUSH_CASH_SUCCESS",TCR_PUSH_CASH_FAIL:"TCR_PUSH_CASH_FAIL",TCR_CASH_IN_FAIL:"TCR_CASH_IN_FAIL",TCR_CASH_DISPENSE_COMPLETE:"TCR_CASH_DISPENSE_COMPLETE",TCR_CASH_BOX_PRE:"TCR_CASH_BOX_PRE",TCR_CASH_BOX_CASH_TAKEN:"TCR_CASH_BOX_CASH_TAKEN",TCR_CASH_OUT_FAIL:"TCR_CASH_OUT_FAIL",TCR_RESET_SUCCESS:"TCR_RESET_SUCCESS",TCR_RESET_FAIL:"TCR_RESET_FAIL",PASSBOOK_STOP:"PASSBOOK_STOP",LHT_TMOUT:"LHT_TMOUT",LHT_LOSS:"LHT_LOSS",LHT_FINISH:"LHT_FINISH",LHT_SUCCESS:"LHT_SUCCESS",LHT_CAM_FAILED:"LHT_CAM_FAILED",LHT_SDK_FAILED:"LHT_SDK_FAILED",HMI_CHANGE:"HMI_CHANGE",LHA_FAIL:"LHA_FAIL",LHA_SUCCESS:"LHA_SUCCESS",PSR_COMPLETE:"PSR_COMPLETE",RTS_CLOSE:"RTS_CLOSE",RTS_AUDIT:"RTS_AUDIT",RTS_CALL:"RTS_CALL",RTS_QUEUE:"RTS_QUEUE",RTS_ABNORMAL:"RTS_ABNORMAL",RTS_RESIGN:"RTS_RESIGN",HVT_CHANGE:"HVT_CHANGE",RSV_RESULT:"RSV_RESULT",DOOR_OPEN:"DOOR_OPEN"},PJF.stm.Pin={readPin:function(t,e){t.encryptType=t.encryptType||"P2"
;var n="e2e"==t.encryptType?"PIN_readPinE2E":"PIN_readPin";PJF.stm.log("录入密码","PJF_LOG_HARDWARE");var i={iTimes:t.iTimes,iEncodeType:2,iLength:6,timeout:t.timeout||30};$.extend(i,t),i.pUserID=PJF.otherInfo&&PJF.otherInfo.devId?PJF.otherInfo.devId:"","P2"==t.encryptType||"base64"==t.encryptType?(i.keyInfoLen=PJF.otherInfo&&PJF.otherInfo.token?PJF.otherInfo.token.length:0,i.pSecNodeID=PJF.otherInfo&&PJF.otherInfo.secNode?PJF.otherInfo.secNode:"",i.p2KeyInfo=PJF.otherInfo&&PJF.otherInfo.token?PJF.otherInfo.token:"","base64"==t.encryptType&&(i.iEncodeType=12)):"e2e"==t.encryptType&&(i.pEntity=PJF.otherInfo&&PJF.otherInfo.secNode?PJF.otherInfo.secNode:"",i.E2EkeyInfoLen=PJF.otherInfo&&PJF.otherInfo.e2etoken?PJF.otherInfo.e2etoken.length:0,i.pE2EKeyInfo=PJF.otherInfo&&PJF.otherInfo.e2etoken?PJF.otherInfo.e2etoken:""),PJF.stm.client.callClient("App_PIN",n,i,e,function(t){var e={};return e.pchSecPassword=t.pchSecPassword,e.pchSecPasswordLen=t.pchSecPasswordLen,e})},getPinLength:function(t){
PJF.stm.log("获取当前输入密码长度","PJF_LOG_HARDWARE");PJF.stm.client.callClient("App_PIN","PIN_getPinLength",{},t,function(t){var e={};return e.retvalue=t.__retvalue,e})},setSM4PrimaryKey:function(t,e){t=$.extend({pUserID:PJF.otherInfo.devId,pSecNodeID:PJF.otherInfo.secNode,p2KeyInfo:PJF.otherInfo.token,keyInfoLen:PJF.otherInfo.token.length,pchPassword:"",iAlgorithm:"2",iMainKeyId:"1",pchKey:""},t),PJF.stm.client.callClient("App_PIN","PIN_primKeyInject",t,e)},setSM4WorkKey:function(t,e){t=$.extend({pUserID:PJF.otherInfo.devId,pSecNodeID:PJF.otherInfo.secNode,p2KeyInfo:PJF.otherInfo.token,keyInfoLen:PJF.otherInfo.token.length,iAlgorithm:"2",iMainKeyId:"1",iKeyType:"0",iWorkKeyId:"2",pchKey:""},t),PJF.stm.client.callClient("App_PIN","PIN_workKeyInject",t,e)},getEncryptedData:function(t){for(var e="",n=0;n<3;n++)e+=Math.floor(10*Math.random())+"";var i=PJF.communication.getServerTime("yyyyMMddHHmmss")||PJF.util.formatDate(new Date,"yyyyMMddhhmmss")
;e+=i?new Date(i.substr(0,4),+i.substr(4,2)-1,i.substr(6,2),i.substr(8,2),i.substr(10,2),i.substr(12,2)).getTime():Date.now()+"";var o={};$.extend(o,{pchData:e,iDataLen:e.length,iWorkKeyId:"2"},t);return PJF.stm.client.callClientSync("PIN","getEncryptedData",o,function(t){return t.pchData=o.pchData,t})}},PJF.stm.CardReader={getCardNum:function(t,e){PJF.stm.log("读卡磁道","PJF_LOG_HARDWARE");t={trackNum:t.trackNum||23,timeout:t.timeout||20,deviceStartSound:void 0===t.rdcSound?"devprompt/RDC_read.wav":t.rdcSound,readPassbook:t.readPassbook,loadingConf:t.loadingConf};PJF.stm.client.callClient("RDC","getCardNum",t,e,PJF.stm.CardReader.fnSuccess)},fnSuccess:function(t){0==t.pchTrackData2.indexOf(":")&&(t.pchTrackData2=t.pchTrackData2.substr(1));var e={};e.pchTrackData2=t.pchTrackData2,e.pchTrackData3=t.pchTrackData3,-1!=e.pchTrackData2.indexOf("=")?e.accountNo=e.pchTrackData2.split("=")[0]:-1!=e.pchTrackData2.indexOf("'")?(e.accountNo=e.pchTrackData2.split("'")[0],
e.pchTrackData2=e.pchTrackData2.replace("'","=")):-1!=e.pchTrackData2.indexOf(">")?(e.accountNo=e.pchTrackData2.split(">")[0],e.pchTrackData2=e.pchTrackData2.replace(">","=")):(console.log("未能正确匹配磁道分隔符"),e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR01",e.pchError="未能正确匹配磁道分隔符");var n=PJF.util.encrypt(e.pchTrackData2);if(n?e.pchTrackData2=n:(console.log("二磁数据加密失败"),e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR02",e.pchError="二磁数据加密失败"),e.resInfo={},e.resInfo.accountNo=e.accountNo,e.resInfo.secDisInfo=e.pchTrackData2,e.resType="0",-1!=PJF.util.array.indexOf(["'","=",">"],t.pchTrackData2.substr(19,1))&&35==t.pchTrackData2.length){var i=t.pchTrackData2.substr(20,4),o=t.pchTrackData2.substr(24,3),a="0"+t.pchTrackData2.substr(27,2),s=t.pchTrackData2.substr(29,2),r=parseInt(s.charAt(0),10),c=parseInt(s.charAt(1),10),l=[Math.floor(r/2),r%2,Math.floor(c/2),c%2].join("");e.resInfo.printNo=i,e.resInfo.dvvNo=o,e.resInfo.bkNumber=a,e.resInfo.withdrawMode=l}return e}},PJF.stm.IcCard={
getICCardInfo:function(t,e){PJF.stm.log("读IC卡客户信息","PJF_LOG_HARDWARE");t=$.extend({iIcFlag:2,pchTagList:t.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",pchAIDList:t.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",piCInfoLen:t.iCInfoLen,timeout:t.timeout||20,ICC:t.ICC},t);PJF.stm.client.callClient(t.ICC?"ICC":"IC2","getICCardInfo",t,e,function(t){var e,n={resType:"1"};return n.resInfo=t.pcICInfo,(e=PJF.stm.ICMaker.fnSuccess(n)).resType=t.pICType,e})},getICDataByQPBOC:function(t,e){PJF.stm.log("获取卡片信息qPBOC","PJF_LOG_HARDWARE");var n=$.extend({aryAIDList:t.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",timeout:30},t);PJF.stm.client.callClient("IC2","getICDataByQPBOC",n,e,function(t){var e={};return e.pchD55=t.pchD55,e.pchICInfo=t.pchICInfo,e})},genARQC:function(t,e){PJF.stm.log("获取ARQC","PJF_LOG_HARDWARE");var n={iIcFlag:2,pchInput:t.pchInput,
pchAIDList:t.pchAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",piLengthD55:t.piLengthD55||2048,piLengthD60:t.piLengthD60||2048,timeout:t.timeout||20};if(n.loadingConf={msg:"设备正在处理中",opacity:.1,noIcon:!0,timeout:n.timeout},$.extend(!0,n,t),t.ARQC){var i=PJF.util.formatDate(new Date,"yyyyMMddhhmmss");t.ARQC=$.extend(t.ARQC,{transDate:i.substr(0,8),transTime:i.substr(8,16),transOper:PJF.userInfo.userCode}),"default"==t.ARQC.appType?n.pchAIDList="A000000333010101|A000000333010102|A000000333010103|A000000333010106":"1"==t.ARQC.appType?n.pchAIDList="A000000333010101":"2"==t.ARQC.appType&&(n.pchAIDList="A000000333010102"),n.pchInput=PJF.stm.ICMaker.genARQCpchInput(PJF.stm.ICMaker.decimal2Ans(t.ARQC.authAmt),PJF.stm.ICMaker.decimal2Ans(t.ARQC.otherAmt),t.ARQC.cType,t.ARQC.transDate,t.ARQC.transType,t.ARQC.transTime,t.ARQC.transOper)}PJF.stm.client.callClient("IC2","genARQC",n,e,function(t){var e={};return e.pICType=t.pICType,e.pchD55=t.pchD55,e.pchD60=t.pchD60,
e.pchD55Len=t.pchD55.length/2,e})},ARPC_ExeICScript:function(t,e){PJF.stm.log("发送写卡脚本","PJF_LOG_HARDWARE");t={iIcFlag:2,pchInput:t.pchInput,pchARPC:t.pchARPC,iStatus:t.iStatus,pchARQC:t.pchARQC,piLenGAC2:t.piLenGAC2,timeout:t.timeout||20};PJF.stm.client.callClient("IC2","ARPC_ExeICScript",t,e,function(t){var e={};return e.pIcType=t.pIcType,e.pScriptResult=t.pScriptResult,e.pchGAC2=t.pchGAC2,e})},getTxDetail:function(t,e){PJF.stm.log("读IC卡交易明细","PJF_LOG_HARDWARE");var n=$.extend({iIcFlag:2,timeout:30},t);PJF.stm.client.callClient("IC2","getTxDetail",n,e,function(t){var e={};return e.pICType=t.pICType,e.pchGAC2=t.pchGAC2,e.lenGAC2=t.lenGAC2,e})},initHYICCard:function(t,e){PJF.stm.log("上电复位","PJF_LOG_HARDWARE");var n=$.extend({timeout:20,CDB:!1,useIC1:!1},t);PJF.stm.client.callClient(n.CDB?n.useIC1?"IC1":"CDB":PJF.util.deviceType.pad?"ICC":"IC2","initHYICCard",n,e,function(t){var e={};return e.pchInitData=t.pchInitData,e.iDataLen=t.iDataLen,e})},closeHYICCard:function(t,e){
PJF.stm.log("下电","PJF_LOG_HARDWARE");var n=$.extend({timeout:20,CDB:!1,useIC1:!1},t);PJF.stm.client.callClient(n.CDB?n.useIC1?"IC1":"CDB":PJF.util.deviceType.pad?"ICC":"IC2","closeHYICCard",n,e)},readWriteHYICCard:function(t,e){PJF.stm.log("执行命令","PJF_LOG_HARDWARE");var n=$.extend({timeout:20,iCmdLength:1024,CDB:!1,useIC1:!1},t);PJF.stm.client.callClient(n.CDB?n.useIC1?"IC1":"CDB":PJF.util.deviceType.pad?"ICC":"IC2","readWriteHYICCard",n,e,function(t){var e={};return e.pchExcuteResult=t.pchExcuteResult,e})},readCard:function(t,e){PJF.stm.log("读IC卡","PJF_LOG_HARDWARE");t={pchTagList:t.pchTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",pchAIDList:t.pchAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",pchInput:t.pchInput,timeout:void 0===t.timeout?30:t.timeout};PJF.stm.client.callClient("App_IC2","IC2_ReadCard",t,e,function(t){var e={};e.pICType=t.pICType,e.pcICInfo=t.pcICInfo,e.pchD55=t.pchD55,e.pchD60=t.pchD60,e.pchGAC2=t.pchGAC2})},
m1_readCardID:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("IC2","m1_readCardID",n,e,function(t){var e={};return e.pchCardType=t.pchCardType,e.pchCardID=t.pchCardID,e.pchATR=t.pchATR,e})},m1_close:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("IC2","m1_close",n,e)},m1_readData:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("IC2","m1_readData",n,e,function(t){var e={};return e.pchData=t.pchData,e})},m1_writeData:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("IC2","m1_writeData",n,e)},m1_modifyPassword:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("IC2","m1_modifyPassword",n,e)},cancelCurOperation:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("IC2","cancelCurOperation",n,e)},ETC_getCardInfo:function(t,e){var n=$.extend({},t),i=PJF.util.deviceType.pad?"ICC":"IC2",o=PJF.util.deviceType.pad?"getETCCardInfo":"ETC_getCardInfo";PJF.stm.client.callClient(i,o,n,e,PJF.stm.IcCard.fnSuccess)},
fnSuccess:function(t){var e={};return e.pchCardNo=t.pchCardNo,e.pchBanlance=t.pchBanlance,e.pchData16=t.pchData16,e.pchData15=t.pchData15,e}},PJF.stm.Finger={registerFinger:function(t,e){PJF.stm.log("指纹模板登记","PJF_LOG_HARDWARE");t={timeout:t.timeout||20};var n=PJF.util.deviceType.tcr&&PJF.communication.isSecondScreen();PJF.stm.client.callClient(n?"FIN":"FIG",n?"FIN_registerFinger":"registerFinger",t,e,function(t){var e={};return e.pCompanyCode=t.pCompanyCode,e.pchTemlate=t.pchTemlate,e})},readFinger:function(t,e){PJF.stm.log("读取指纹特征","PJF_LOG_HARDWARE");t={timeout:t.timeout||20};var n=PJF.util.deviceType.tcr&&PJF.communication.isSecondScreen();return PJF.stm.client.callClient(n?"FIN":"FIG",n?"FIN_readFinger":"readFinger",t,e,function(t){var e={};return e.pCompanyCode=t.pCompanyCode,e.pchFeature=t.pchFeature,e})}},PJF.stm.IdCard={waitForTaken:function(t,e){var n={timeout:t.timeout||30};PJF.stm.client.callClient("IDC","WaitForTaken",n,e,function(t){})},getIDCardInfo:function(t,e){
PJF.stm.log("读取信息","PJF_LOG_HARDWARE");var n={timeout:t.timeout||20};$.extend(n,t),PJF.stm.client.callClient("IDC","getIDCardInfo",n,e,PJF.stm.IdCard.fnSuccess)},scanIDCard:function(t,e){PJF.stm.log("扫描身份证","PJF_LOG_HARDWARE");var n={iDpi:t.dpi||150,dpi:t.dpi||150,imageType:t.imageType||2,timeout:t.timeout||20};$.extend(n,t),PJF.stm.client.callClient("IDC","scanIDCard",n,e)},eject:function(t,e){if(!PJF.stm.client.ytdHandler(e,PJF.constants.DEVICE_SUCC_INFO)){var n={timeout:t.timeout||60};$.extend(n,t),PJF.stm.util.clearAuthInfo(),PJF.stm.client.callClient("IDC","ejectDev",n,e,function(t){return{}})}},ejectDev:function(o,a){PJF.stm.log("退证","PJF_LOG_SELECT"),PJF.stm.client.ytdHandler(o,PJF.constants.DEVICE_SUCC_INFO)||PJF.stm.IdCard.eject({},function(t){if(1==t.status){a&&a.idcSound?PJF.communication.player.PlaySoundByUrl(a.idcSound):PJF.communication.player.PlaySoundByUrl("devprompt/IDC_taken.wav");var e,n=new PJF.ui.loading({msg:a&&a.ejectMsg||"请取走您的身份证",timeout:30
}),i=setTimeout(function(){n.destroy(),PJF.event.removeSubscriber(PJF.stm.client.events.IDC_TAKEN,e),o&&o(t)},3e4);PJF.event.onceSubscriber(PJF.stm.client.events.IDC_TAKEN,e=function(){n.destroy(),clearTimeout(i),o&&o(t)})}else o&&o(t),console.log("吐出二代证失败，错误信息为:"+JSON.stringify(t))})},inhaleIDCard:function(t){PJF.stm.client.callClient("IDC","inhaleIDCard",{tmimeout:60},t)},readCard:function(t,e){PJF.stm.log("读证","PJF_LOG_HARDWARE");t={pchPhotoPath:t.pchPhotoPath,frontPhotoPath:t.frontPhotoPath,backPhotoPath:t.backPhotoPath,dpi:t.dpi||150,imageType:t.imageType||2,timeout:t.timeout||60,deviceStartSound:void 0===t.idcSound?"devprompt/IDC_insert.wav":t.idcSound};PJF.stm.client.callClient("App_IDC","IDC_readCard",t,e,PJF.stm.IdCard.fnSuccess)},fnSuccess:function(t){var e,n={},i={},o=t.pchInfo.split("|");if(-1<["81","82","83"].indexOf(o[5].substr(0,2))||"J"===o[0])return n.pjfstatus="0",n.pchErrCode="PJF_IdCard_PARSE_ERR02",n.pchError="港澳台居民居住证，移步至柜面办理",n;"I"==o[0]&&(e=!0),
e?(i.isForeign=!0,i.engName=o[1],i.sex=o[2],i.identity=o[3],i.areaCode=o[4],i.name=o[5],i.validDate=o[6].replace(/\s/g,""),i.birth=o[7],i.version=o[8],i.issueOfficeCode=o[9]):(i.name=o[0],i.sex=o[1],i.nation=o[2],i.birth=o[3],i.address=o[4],i.identity=o[5].toUpperCase(),i.issueOffice=o[6],i.validDate=o[7].replace(/\s/g,"")),PJF.stm.log("读身份证成功","PJF_LOG_HARDWARE"),n.pchInfo=i,!e&&-1<o[2].indexOf("族")&&(i.nation=o[2].substring(0,o[2].indexOf("族")));var a=e?o[6].replace(/\s/g,"").split("-")[1]:o[7].replace(/\s/g,"").split("-")[1];"99991231"==a&&(a="长期",i.validDate=i.validDate.split("-")[0]+"-"+a);var s,r=PJF.communication.getServerTime("yyyyMMdd");if((s=a)&&null==s.match(/\D/)){var c=r||PJF.util.formatDate(new Date);8!=a.length?(n.pjfstatus="0",n.pchErrCode="PJF_IdCard_PARSE_ERR00",n.pchError="身份证有效日期结束时间格式错误,结束时间即为"+a):parseInt(c)>parseInt(a)&&(n.pjfstatus="0",n.pchErrCode="PJF_IdCard_PARSE_ERR01",n.pchError="身份证已过期，请更换身份证后再办理")}else"长期"!=a&&(n.pjfstatus="0",
n.pchErrCode="PJF_IdCard_PARSE_ERR00",n.pchError="身份证有效日期结束时间格式错误,结束时间即为"+a);return n},getChannelStatus:function(t){if(!PJF.stm.client.ytdHandler(t,PJF.constants.DEVICE_SUCC_INFO)){PJF.stm.client.callClient("IDC","getChannelStatus",{timeout:20},t,function(t){var e={};return e.status=t.status,e})}},stopInhale:function(t,e){PJF.stm.log("停止进证","PJF_LOG_HARDWARE");var n=$.extend({},t);PJF.stm.client.callClient("IDC","stopInhale",n,e)},getDNCtrlVersion:function(t){PJF.stm.client.callClient("IDC","getDNCtrlVersion",{},t,function(t){var e={};return e.pchCtrlVersion=t.pchCtrlVersion,e})},getIDVerifyData:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("IDC","getIDVerifyData",n,e,function(t){var e={};return e.pchIDVerifyData=t.pchIDVerifyData,e.pchRservedData=t.pchRservedData,e})},getCertificateData:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("IDC","getCertificateData",n,e,function(t){var e={};return e.pchIDVerifyData=t.pchIDVerifyData,
e.pchRservedData=t.pchRservedData,e})}},PJF.stm.eSign={startSignature:function(t,e){PJF.stm.log("启动签名","PJF_LOG_HARDWARE");t={x:t.x,y:t.y,w:t.w,h:t.h,pUserID:PJF.otherInfo.devId,pSecNodeID:PJF.otherInfo.secNode,p2KeyInfo:PJF.otherInfo.token,keyInfoLen:PJF.otherInfo.token.length};if(PJF.util.isKylinSTM()){var n=screen.width/document.body.clientWidth;t.x*=n,t.y*=n,t.w*=n,t.h*=n}PJF.fsm.get(PJF.fsm.fmIds.STM_SIGNATURE).openSignature(),PJF.stm.client.callClient("YGB","startSignature",t,e)},clearSignature:function(t,e){PJF.stm.log("清除签名","PJF_LOG_HARDWARE"),PJF.stm.client.callClient("YGB","clearSignature",{},e)},endSign:function(t){PJF.stm.log("结束签名","PJF_LOG_HARDWARE"),PJF.stm.client.callClient("YGB","endSign",{},t)},getSignature:function(t){PJF.stm.log("获取电子签名","PJF_LOG_HARDWARE");var e={pUserID:PJF.otherInfo.devId,pSecNodeID:PJF.otherInfo.secNode,p2KeyInfo:PJF.otherInfo.token,keyInfoLen:PJF.otherInfo.token.length,photoPath:PJF.stm.baseDir+"/sign/"+PJF.otherInfo.SVC_ID+".jpg"}
;PJF.fsm.get(PJF.fsm.fmIds.STM_SIGNATURE).closeSignature();var n="android"==PJF.communication.getClientType()&&"1.4.6"==PJF.communication.GetApplicationVersion().result;PJF.stm.client.callClient(PJF.util.deviceType.pad&&!n?"App_YGB":"YGB","getSignature",e,t,function(t){var e={};return e.code=t.code,e.photoContent=t.photoContent,e.pchSignData=t.pchSignData,e})}},PJF.stm.ICMaker={waitForTaken:function(t,e){var n={timeout:t.timeout||30};PJF.stm.client.callClient("CDB","WaitForTaken",n,e,function(t){})},inhaleCard:function(t,e){t={time:t.time,timeout:t.time};PJF.stm.client.callClient("CDB","inhaleCard",t,e,function(t){return PJF.event.publish(PJF.stm.client.events.CDB_INHALED,PJF.util.formatDate(new Date,"yyyyMMddHHmmss"),1),{}})},chooseCard:function(e,n){e={boxNo:e.boxNo};var i=function(t){new PJF.ui.errorMessageBox({content:t,buttonConfs:[{name:"确定",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){template.loadPage("homepage")}}]})}
;PJF.stm.ICMaker.getChannelStatus(function(t){1==t.status?1==t.info.status?i("卡槽已经有卡"):PJF.stm.client.callClient("CDB","chooseCard",e,n):i("获取卡通道状态失败<br>错误码:"+t.errorCode+"<br>错误信息:"+t.errorMsg)})},getICCardInfo:function(t,e){PJF.stm.log("读IC卡客户信息","PJF_LOG_HARDWARE");t=$.extend({iIcFlag:t.iIcFlag||1,aryTagList:t.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",aryAIDList:t.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",piCInfoLen:t.piCInfoLen||4096,loadingConf:{msg:PJF.i18n.getI18nResource("pjfCommon.genARQCTip")}},t);"DA003"===PJF.orgInfo.instSvrlLgPsnID&&(t.aryAIDList="A00000047400000001|A0000000031010|A000000241010102|A0000000041010|A000000333010101|A000000333010102|A000000333010103|A000000333010106"),PJF.stm.client.callClient("CDB","getICCardInfo",t,e,PJF.stm.ICMaker.fnSuccess)},genARQC:function(t,e){if(t=t||{},PJF.stm.log("从IC卡获取ARQC","PJF_LOG_HARDWARE"),!PJF.util.deviceType.ytd||t.CDB){var n={iIcFlag:1,pchInput:t.pchInput,
pchAIDList:t.pchAIDList,piLengthD55:t.piLengthD55||2048,piLengthD60:t.piLengthD55||2048,timeout:t.timeout||20};if(n.loadingConf={msg:PJF.util.deviceType.ytd?"请放置您的银行卡":PJF.i18n.getI18nResource("pjfI18n.arqcMsg"),opacity:.1,noIcon:!0,timeout:n.timeout},$.extend(!0,n,t),t.ARQC){var i=PJF.util.formatDate(new Date,"yyyyMMddhhmmss");t.ARQC=$.extend(t.ARQC,{transDate:i.substr(0,8),transTime:i.substr(8,16),transOper:PJF.userInfo.userCode}),"default"==t.ARQC.appType?n.pchAIDList="A000000333010101|A000000333010102|A000000333010103|A000000333010106":"1"==t.ARQC.appType?n.pchAIDList="A000000333010101":"2"==t.ARQC.appType&&(n.pchAIDList="A000000333010102"),n.pchInput=PJF.stm.ICMaker.genARQCpchInput(PJF.stm.ICMaker.decimal2Ans(t.ARQC.authAmt),PJF.stm.ICMaker.decimal2Ans(t.ARQC.otherAmt),t.ARQC.cType,t.ARQC.transDate,t.ARQC.transType,t.ARQC.transTime,t.ARQC.transOper)}PJF.util.deviceType.stm?PJF.stm.ICMaker.getICCardInfo({},function(){PJF.stm.client.callClient("CDB","genARQC",n,e,o)
}):PJF.stm.client.callClient("CDB","genARQC",n,e,o)}else PJF.ytd.ICC.genARQC(t,e);function o(t){var e={};return e.pICType=t.pIcType,e.pchD55=t.pchD55,e.pchD60=t.pchD60,e.pchInput=n.pchInput,e.pchD55Len=t.pchD55.length/2,e}},ARPC_ExeICScript:function(t,e){PJF.stm.log("发送写卡脚本","PJF_LOG_HARDWARE");var n={iIcFlag:t.iIcFlag||1,pchInput:t.pchInput,pchARPC:t.pchARPC,iStatus:t.iStatus,pchARQC:t.pchARQC,timeout:t.timeout||20,piLenGAC2:t.piLenGAC2||2048};n.loadingConf={msg:"设备正在处理中",opacity:.1,noIcon:!0,timeout:n.timeout},$.extend(!0,n,t),PJF.stm.client.callClient("CDB","ARPC_ExeICScript",n,e,function(t){var e={};return e.pIcType=t.pIcType,e.pScriptResult=t.pScriptResult,e.pchGAC2=t.pchGAC2,e})},getTxDetail:function(t,e){PJF.stm.log("读IC卡交易明细","PJF_LOG_HARDWARE");t={iIcFlag:1,pchAIDList:t.pchAIDList,timeout:t.timeout||20};PJF.stm.client.callClient("CDB","getTxDetail",t,e,function(t){var e={};return e.pICType=t.pICType,e.pchGAC2=t.pchGAC2,e.lenGAC2=t.lenGAC2,e})},getCardNum:function(t,e){
PJF.stm.log("读卡磁道","PJF_LOG_HARDWARE");t={trackNum:t.trackNum||23,timeout:t.timeout||20};PJF.stm.client.callClient("CDB","getCardNum",t,e,function(t){var e={};return e.pchTrackData2=t.pchTrackData2,e.pchTrackData3=t.pchTrackData3,e})},ejectCard:function(o,a){if(PJF.stm.log("退卡","PJF_LOG_SELECT"),(a=$.extend({},a)).CDB||!PJF.stm.client.ytdHandler(o,PJF.constants.DEVICE_SUCC_INFO)){if("ZNK"==a.socialCard)return a=$.extend({pchIp:"127.0.0.1",iPort:"11041",timeout:30,iIsValidCard:"0"},a),void PJF.stm.ZNK.putCardOut(a,o);PJF.stm.ICMaker.getChannelStatus(function(t){1==t.status?0==t.info.status?s({content:"卡槽没有卡",fn:function(){o&&o({status:0,errorMsg:"卡槽没有卡"})}}):PJF.stm.ICMaker.ejectDev(function(e){if(e.status){var t;a.cdbEjectSound?PJF.communication.player.PlaySoundByUrl(a.cdbEjectSound):PJF.communication.player.PlaySoundByUrl("devprompt/CDB_taken.wav",!0);var n=new PJF.ui.loading({msg:PJF.i18n.getI18nResource("pjfI18n.takeIcCardTip"),timeout:30}),i=setTimeout(function(){
PJF.event.removeSubscriber(PJF.stm.client.events.CDB_TAKEN,t),n.destroy(),a.stmManage&&(a.stmManage.recycle_type="Popout",a.stmManage.recycle_msg="客户发卡未取"),PJF.stm.ICMaker.confiscateDev(function(t){e.status?t.status=3:(t.status=4,s(),console.log("没收卡失败，错误代码为:"+e.errorCode)),o&&o(t)},{stmManage:a.stmManage,conReason:"吐卡超时未取",recycleType:"8"})},3e4);PJF.event.onceSubscriber(PJF.stm.client.events.CDB_TAKEN,t=function(){clearTimeout(i),n.destroy(),o&&o({status:1})})}else o?o(e):s({content:"退卡失败"}),console.log("吐卡失败，错误代码为:"+e.errorCode)},{keepAuthInfo:!0}):s({content:t.errorMsg,fn:function(){o&&o(t)}})},a),PJF.stm.IC_CARD_INFO_BAK={},PJF.stm.CUSTOM_INFO_BAK={},$.extend(!0,PJF.stm.IC_CARD_INFO_BAK,PJF.stm.IC_CARD_INFO),$.extend(!0,PJF.stm.CUSTOM_INFO_BAK,PJF.stm.CUSTOM_INFO),PJF.stm.IC_CARD_INFO_COR_BAK={},PJF.stm.CUSTOM_INFO_COR_BAK={},$.extend(!0,PJF.stm.IC_CARD_INFO_COR_BAK,PJF.stm.IC_CARD_INFO_COR),$.extend(!0,PJF.stm.CUSTOM_INFO_COR_BAK,PJF.stm.CUSTOM_INFO_COR),
PJF.stm.util.clearAuthInfo(!0),PJF.stm.util.clearCardInfo(),PJF.event.publish("STM_EJECTCARD")}function s(t){new PJF.ui.messageBox({title:"提示信息",content:t.content||"设备故障,请联系工作人员！",buttonConfs:[{bgColor:"rgb(121,198,30)",name:"确定",style:"main",width:200,height:80,onClick:t.fn||function(){}}]})}},ejectDev:function(t,e){(e=$.extend({timeout:20,iotFunc:!1,uniqueNo:"",coordinateX:PJF.otherInfo.globalParams.coordinateX,coordinateY:PJF.otherInfo.globalParams.coordinateY,angle:PJF.otherInfo.globalParams.angle},e)).iotFunc&&(e.timeout=120),PJF.stm.client.callClient("CDB","ejectDev",e,t),PJF.stm.util.clearAuthInfo(!0),PJF.stm.util.clearCardInfo()},confiscateDev:function(r,c){if(PJF.stm.log("吞卡","PJF_LOG_HARDWARE"),"ZNK"==c.socialCard)return c=$.extend({pchIp:"127.0.0.1",iPort:"11041",timeout:30,iIsValidCard:"1"},c),void PJF.stm.ZNK.putCardOut(c,r);c=c||{};var t=$.extend({timeout:20,iotFunc:!1,uniqueNo:""},c)
;var l=-1!=["ACC10001","SPB30001","SPB30002","SPB30003","SPB30005"].indexOf(PJF.otherInfo.MENU_ID),u=-1!=["CPB30008","CPB30026","CPB20005","CPB20013","CPB20006","CPB20009","CPB20014"].indexOf(PJF.otherInfo.MENU_ID),e=PJF.stm.enterMenu?PJF.stm.enterMenu.NAME:"首页",n=e+"有卡被吞，吞卡原因为"+(c.stmManage&&c.stmManage.recycle_msg?c.stmManage.recycle_msg:c.conReason);PJF.communication.callPad({busiName:n}),PJF.fsm.get([PJF.fsm.fmIds.STM_IDCARD]).is("hasId")&&PJF.communication.callPad({busiName:e+"有卡被吞，卡槽中还有身份证"}),PJF.stm.client.callClient("CDB","confiscateDev",t,function(t){if(t.status){if(PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).takeCard(),c.stmManage?($.extend(c.stmManage,{cardkey_type:"Card",device_id:PJF.otherInfo.devId,ins_id:PJF.roleInfo.orgCode}),PJF.communication.stmManageAjax({fwServiceId:"stm.doLogCardKeyFailure",jsonData:c.stmManage}),PJF.communication.addSwallowCardRecord(c.stmManage)):PJF.communication.returnCard(c),PJF.util.deviceType.tcr){var e={FRZ_STCD:0,PRMT_MOD_IND:0,
RTCRD_CARDNO:PJF.stm.IC_CARD_INFO&&PJF.stm.IC_CARD_INFO.resInfo.accountNo,RTCRD_DT:PJF.util.formatDate(new Date,"yyyyMMdd"),SSEQ_ID:PJF.otherInfo.devId,BLNG_INSID:PJF.roleInfo.orgCode,BLNG_INST_NM:PJF.roleInfo.orgName,DTSRC:1},n={_fw_service_id:"saveAtmRtcrdInfo",jsonData:JSON.stringify(e)},i=new PJF.ui.loading({msg:"",noIcon:!0});console.log("tcr吞没卡新增交易请求参数为:"+JSON.stringify(e)),PJF.communication.ajax({data:n,url:"ecpJson.action",async:!1,type:"post",success:function(t,e,n){i.destroy(),"00"==t.BK_STATUS?console.log("吞没卡新增成功"):console.log("吞没卡新增失败:"+t.BK_DESC)},failure:function(t,e,n){i.destroy(),console.log("吞没卡新增通信失败:"+e)}})}r&&r(t)}else if(!t.status&&PJF.otherInfo.MENU_ID&&(l||u)){var o=PJF.stm.enterMenu?PJF.stm.enterMenu.NAME:"首页",a=PJF.userInfo.userCode+"设备"+o+"吞卡失败";PJF.communication.callPad({busiName:a});var s=PJF.util.generateUUid();$("body").append('<div id="'+s+'"></div>'),new PJF.ui.fingerReader({dom:s,authTip:"吞卡失败，请工作人员授权通过后返回首页点击“退卡/证”取卡，取卡后请检查该卡是否正常。",
success:function(t){console.log("吞卡失败场景，指纹验证通过"),l?template.loadPage("homepage"):u&&r&&r(t)},failure:function(t){console.log("吞卡失败场景，指纹验证失败，返回数据："+JSON.stringify(t))}})}else r&&r(t)},function(t){return{}}),!c.stmManage&&PJF.stm.IC_CARD_INFO?(PJF.stm.IC_CARD_INFO_BAK={},PJF.stm.CUSTOM_INFO_BAK={},$.extend(!0,PJF.stm.IC_CARD_INFO_BAK,PJF.stm.IC_CARD_INFO),PJF.stm.CUSTOM_INFO&&$.extend(!0,PJF.stm.CUSTOM_INFO_BAK,PJF.stm.CUSTOM_INFO)):!c.stmManage&&PJF.stm.IC_CARD_INFO_COR&&(PJF.stm.IC_CARD_INFO_COR_BAK={},PJF.stm.CUSTOM_INFO_COR_BAK={},$.extend(!0,PJF.stm.IC_CARD_INFO_COR_BAK,PJF.stm.IC_CARD_INFO_COR),PJF.stm.CUSTOM_INFO_COR&&$.extend(!0,PJF.stm.CUSTOM_INFO_COR_BAK,PJF.stm.CUSTOM_INFO_COR)),PJF.stm.util.clearAuthInfo(),PJF.stm.util.clearAuthInfo(!0),PJF.stm.util.clearCardInfo()},getChannelStatus:function(t,e){if((e=e||{}).CDB||!PJF.stm.client.ytdHandler(t,PJF.constants.DEVICE_SUCC_INFO)){e={timeout:20};PJF.stm.client.callClient("CDB","getChannelStatus",e,t,function(t){var e={}
;return e.status=t.status,e})}},readCard:function(t,n){PJF.stm.util.clearCardInfo();var e=void 0===t.timeout?30:t.timeout;t={iIcFlag:t.iIcFlag||1,aryTagList:t.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",aryAIDList:t.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106|A0000000031010|A000000241010102|A0000000041010|A0000000651010",piCInfoLen:t.piCInfoLen||4096,trackNum:t.trackNum||2,cardSource:0,timeout:e,otherBnkCard:t.otherBnkCard,loadingConf:{noLayer:!0,opacity:.1,noIcon:!0,msg:"",timeout:e},deviceStartSound:void 0===t.cdbSound?"devprompt/CDB_insert.wav":t.cdbSound};"DA003"===PJF.orgInfo.instSvrlLgPsnID&&(t.aryAIDList="A00000047400000001|A0000000031010|A000000241010102|A0000000041010|A000000333010101|A000000333010102|A000000333010103|A000000333010106");PJF.stm.client.callClient("App_CDB","CDB_ReadCard",t,function(t){if(1!=t.status||2!=t.info.resType&&0!=t.info.resType)n&&n(t);else{var e=t.info.stmPchTrackData2.split("=")[1]
;2==e.charAt(4)||6==e.charAt(4)?(t.status=0,t.errorCode="PJF_TRACK2_PARSE_ERR04",t.errorMsg="不允许IC复合卡通过磁条交易，"+(PJF.otherInfo.isSelfBank?"请联系工作人员":"详情请咨询网点工作人员。")):t.info.resType="0",n&&n(t)}},PJF.stm.ICMaker.fnSuccess)},cardIssue:function(i,o){PJF.stm.log("发卡","PJF_LOG_HARDWARE");var t={cardSource:i.cardSource,iIcFlag:i.iIcFlag||1,aryTagList:i.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",aryAIDList:i.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",piCInfoLen:i.piCInfoLen||4096,trackNum:i.trackNum||2,timeout:i.timeout||20};t.loadingConf={msg:"设备正在处理中",opacity:.1,noIcon:!0,timeout:t.timeout},$.extend(!0,t,i);var a={};if(PJF.stm.client.newCard=$.extend(i.stmManage,{cardkey_type:"Card",device_id:PJF.otherInfo.devId}),"ZNK"==t.socialCard){t=$.extend({pchIp:"127.0.0.1",iPort:"11041",pchOperDate:t.timeout,ARQC:{appType:"default",authAmt:"0.00",otherAmt:"0.00",transType:"31",cType:"156"}},t);var n=function(e){PJF.stm.ZNK.putCardOut({pchIp:t.pchIp,
iPort:t.iPort,timeout:t.timeout,iIsValidCard:"1",stmManage:PJF.stm.client.newCard,conReason:PJF.stm.client.newCard.recycle_msg},function(t){t.status&&o&&o(e)})};function s(t){return"DRV0000000"==t||"DRVSCS0033"!=t&&-1!=t.indexOf("DRVSCS")}var r=function(t){s(t.errorCode)?(PJF.communication.stmManageAjax({fwServiceId:"stm.doModifyCardKeySurplus",jsonData:PJF.stm.client.newCard}),console.log("发卡返回错误码为:"+t.errorCode+",卡箱数量将减一。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newCard))):console.log("发卡返回错误码为:"+t.errorCode+",卡箱数量将不变。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newCard))};PJF.stm.ZNK.putCardIn(t,function(e){e.status?PJF.stm.ZNK.getICCardInfo(t,function(t){t.status?($.extend(!0,a,t),$.extend(PJF.stm.client.newCard,{cardkey_no:t.info.resInfo.accountNo}),PJF.communication.stmManageAjax({fwServiceId:"stm.doReadCardKey",jsonData:PJF.stm.client.newCard,maskBody:!0,success:function(t){o&&o(a)},failure:function(t){PJF.stm.client.newCard.recycle_type="Read",
PJF.stm.client.newCard.recycle_msg=t.BK_DESC,n({status:0,errorMsg:t.BK_DESC,conReason:t.BK_DESC})}})):s(t.errorCode)?(PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg="发卡出错,出卡或读卡出错:"+t.errorMsg,e.info=e.info||{},e.info.conReason=PJF.stm.client.newCard.recycle_msg,n(t)):o&&o(t),r(t)}):(s(e.errorCode)?(PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg="发卡出错,出卡或读卡出错:"+e.errorMsg,e.info.conReason=PJF.stm.client.newCard.recycle_msg,n(e)):o&&o(e),r(e))})}else PJF.stm.client.callClient("App_CDB","CDB_CardIssue",t,function(t){var n=function(e){PJF.stm.ICMaker.confiscateDev(function(t){(e=e||{}).confiscateResult=t,o&&o(e)},{stmManage:PJF.stm.client.newCard,conReason:e.conReason})};function e(t){return"DRV0000000"==t||"DRVCDB0012"!=t&&"DRVCDB0001"!=t&&"DRVCDB0011"!=t&&-1!=t.indexOf("DRVCDB")}t.status?($.extend(!0,a,t),$.extend(PJF.stm.client.newCard,{cardkey_no:t.info.resInfo.accountNo}),"1"==t.info.resType?PJF.stm.ICMaker.genARQC({CDB:!0,
ARQC:i.ARQC},function(e){e.status?PJF.communication.stmManageAjax({fwServiceId:"stm.doReadCardKey",jsonData:PJF.stm.client.newCard,maskBody:!0,success:function(t){$.extend(!0,a,e),o&&o(a)},failure:function(t){PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg=t.BK_DESC,n({status:0,errorMsg:t.BK_DESC,conReason:t.BK_DESC})}}):(PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg="发卡出错,生成arqc出错:"+e.errorMsg,$.extend(e,{conReason:"发卡出错，生成arqc出错"}),n(e),console.log("cardIssue获取arqc失败:"+JSON.stringify(e)))}):PJF.communication.stmManageAjax({fwServiceId:"stm.doReadCardKey",jsonData:PJF.stm.client.newCard,maskBody:!0,success:function(t){o&&o(a)},failure:function(t){PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg=t.BK_DESC,n({status:0,errorMsg:t.BK_DESC,conReason:t.BK_DESC})}})):(e(t.errorCode)?(PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg="发卡出错,出卡或读卡出错:"+t.errorMsg,$.extend(t,{
conReason:"发卡出错,出卡或读卡出错"}),n(t)):o&&o(t),console.log("cardIssue从卡箱发卡失败:"+JSON.stringify(t))),e(t.errorCode)?(PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).inhaleCard(),PJF.communication.stmManageAjax({fwServiceId:"stm.doModifyCardKeySurplus",jsonData:PJF.stm.client.newCard}),console.log("发卡返回错误码为:"+t.errorCode+",卡箱数量将减一。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newCard))):console.log("发卡返回错误码为:"+t.errorCode+",卡箱数量将不变。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newCard))},PJF.stm.ICMaker.fnSuccess)},etcIssue:function(t,n){PJF.stm.log("ETC发卡","PJF_LOG_HARDWARE");var e={cardSource:t.cardSource,iIcFlag:t.iIcFlag||1,aryTagList:t.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",aryAIDList:t.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",piCInfoLen:t.piCInfoLen||4096,trackNum:t.trackNum||2,timeout:t.timeout||20};e.loadingConf={msg:"设备正在处理中",opacity:.1,noIcon:!0,timeout:e.timeout},$.extend(!0,e,t);var i={};function o(t){
return"DRV0000000"==t||"DRVCDB0012"!=t&&"DRVCDB0001"!=t&&"DRVCDB0011"!=t&&-1!=t.indexOf("DRVCDB")}PJF.stm.client.newCard=$.extend(t.stmManage,{cardkey_type:"Card",device_id:PJF.otherInfo.devId});var a=function(e){PJF.stm.ICMaker.confiscateDev(function(t){(e=e||{}).confiscateResult=t,n&&n(e)},{stmManage:PJF.stm.client.newCard,conReason:e.conReason})},s=function(t){o(t.errorCode)?(PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).inhaleCard(),PJF.communication.stmManageAjax({fwServiceId:"stm.doModifyCardKeySurplus",jsonData:PJF.stm.client.newCard}),console.log("发卡返回错误码为:"+t.errorCode+",卡箱数量将减一。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newCard))):console.log("发卡返回错误码为:"+t.errorCode+",卡箱数量将不变。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newCard))};PJF.stm.ICMaker.getChannelStatus(function(t){1==t.status?0!=t.info.status?(t.status=0,n(t),s(t)):PJF.stm.client.callClient("CDB","chooseCard",e,function(t){t.status?PJF.stm.ICMaker.ETC_getCardInfo(e,function(t){
t.status?($.extend(!0,i,t),$.extend(PJF.stm.client.newCard,{cardkey_no:t.info.pchCardNo}),PJF.communication.stmManageAjax({fwServiceId:"stm.doReadCardKey",jsonData:PJF.stm.client.newCard,maskBody:!0,success:function(t){n&&n(i)},failure:function(t){PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg=t.BK_DESC,a({status:0,errorMsg:t.BK_DESC,conReason:t.BK_DESC})}})):o(t.errorCode)?(PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg="发卡出错,出卡或读卡出错:"+t.errorMsg,$.extend(t,{conReason:"发卡出错,出卡或读卡出错"}),a(t)):n&&n(t),s(t)}):(o(t.errorCode)?(PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg="发卡出错,出卡或读卡出错:"+t.errorMsg,$.extend(t,{conReason:"发卡出错,出卡或读卡出错"}),a(t)):n&&n(t),s(t))}):(n(t),s(t))})},cardSwl:function(t,e){t={iIcFlag:t.iIcFlag||1,aryTagList:t.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",aryAIDList:t.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",
piCInfoLen:t.piCInfoLen||4096,trackNum:t.trackNum||2,timeout:t.timeout||20};PJF.stm.client.callClient("App_CDB","CDB_CardSwl",t,e,PJF.stm.ICMaker.fnSuccess)},fnSuccess:function(t){var e={};e.resType=t.resType;var n=t.resInfo;1==e.resType?PJF.stm.log("读卡成功，卡号为"+n.split("B")[0].substr(4),"PJF_LOG_HARDWARE"):PJF.stm.log("读卡成功，卡号为"+n.split("=")[0],"PJF_LOG_HARDWARE");var i,o,a={},s={A:"accountNo",B:"userName",C:"identityCardType",D:"identityCardNo",E:"secDisInfo",F:"firDisInfo",G:"balance",H:"balanceLimit",I:"invalidDate",J:"ICCardNo"};if(1==e.resType){for(var r=10;4<n.length&&-1<=r;){r--;var c=n.substr(0,4),l=parseInt(n.substr(1,3),10);a[s[c[0]]]=n.substr(4,l),n=n.slice(4+l)}-1!=r&&0==r&&""==n||(e.resInfo="IC卡数据格式错误,数据为:"+t.resInfo,e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR02",e.pchError=e.resInfo)}else-1!=(n=t.pchTrackData2).indexOf("=")?(a.accountNo=n.split("=")[0],e.stmPchTrackData2=n):-1!=n.indexOf("'")?(a.accountNo=n.split("'")[0],n=n.replace("'","="),
e.stmPchTrackData2=n):-1!=n.indexOf(">")?(a.accountNo=n.split(">")[0],n=n.replace(">","="),e.stmPchTrackData2=n):(console.log("未能正确匹配磁道分隔符"),e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR01",e.pchError="未能正确匹配磁道分隔符"),a.secDisInfo=n;return a.balance&&(a.balance=(parseFloat(a.balance)/100).toFixed(2)),1!=e.resType?i=PJF.util.encrypt(a.secDisInfo):(i=PJF.util.Encrypt0x88(40),(o=PJF.util.encrypt(a.secDisInfo))?a.equalSecDisInfo=o:(console.log("等效二磁数据加密失败"),e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR03",e.pchError="等效二磁数据加密失败")),i?a.secDisInfo=i:(console.log("二磁数据加密失败"),e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR02",e.pchError="二磁数据加密失败"),e.resInfo=a,e.robotId=t.robotId,e.pchD55=t.pchD55||"",e.pchD55Len=e.pchD55.length/2,e},decimal2Ans:function(t){var e=t.length;t.indexOf(".")!=e-3&&alert("金额表示非法！");var n=new Array(2);return(n=t.split("."))[0]+n[1]},stopInhale:function(t,e){PJF.stm.log("停止进卡","PJF_LOG_HARDWARE");var n=$.extend({},t)
;PJF.stm.client.callClient("CDB","stopInhale",n,e)},genARQCpchInput:function(t,e,n,i,o,a,s){function r(t,e){if(e){if(t){for(var n=12-t.length,i="";0<n;)i+="0",n--;return"012"+i+t}return"012000000000000"}return t?t.length<10?"00"+t.length+t:"0"+t.length+t:"000"}return"P"+r(t,!0)+"Q"+r(e,!0)+"R"+r(n)+"S"+r(i)+"T"+r(o)+"U"+r(a)+"W"+r(s,!0)},getBoxStatus:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("CDB","getBoxStatus",n,e,function(t){var e={};return e.iStatus=t.iStatus,e})},getRecBoxStatus:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("CDB","getRecBoxStatus",n,e,function(t){var e={};return e.iStatus=t.iStatus,e})},mem_verifyType:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("CDB","mem_verifyType",n,e,function(t){var e={};return e.iCardType=t.iCardType,e})},mem_readData:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("CDB","mem_readData",n,e,function(t){var e={};return e.pchData=t.pchData,e})},mem_verifyPwd:function(t,e){
var n=$.extend({},t);PJF.stm.client.callClient("CDB","mem_verifyPwd",n,e)},mem_writeData:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("CDB","mem_writeData",n,e)},mem_modifyPwd:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("CDB","mem_modifyPwd",n,e)},mem_readErrCntAndPwd:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("CDB","mem_readErrCntAndPwd",n,e,function(t){var e={};return e.iErrCnt=t.iErrCnt,e.pchPwd=t.pchPwd,e})},ETC_getCardInfo:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("CDB","ETC_getCardInfo",n,e,PJF.stm.IcCard.fnSuccess)}},PJF.stm.KDB={waitForTaken:function(t,e){var n={timeout:t.timeout||30};PJF.stm.client.callClient("KDB","WaitForTaken",n,e,function(t){})},publish:function(e,o){PJF.stm.log("发盾","PJF_LOG_HARDWARE");PJF.stm.client.callClient("App_KDB","KDB_Publish",{},function(n){var t,i=function(e){PJF.stm.KDB.confiscateDev({stmManage:PJF.stm.client.newKey,conReason:e.conReason},function(t){o&&o(e)})}
;if(PJF.stm.client.newKey=$.extend(e.stmManage,{cardkey_type:"Key",device_id:PJF.otherInfo.devId}),"DRV0000000"==(t=n.errorCode)||"DRVKDB0007"!=t&&"DRVKDB0001"!=t&&"DRVKDB0003"!=t&&-1!=t.indexOf("DRVKDB")){PJF.communication.stmManageAjax({fwServiceId:"stm.doModifyCardKeySurplus",jsonData:PJF.stm.client.newKey}),console.log("发盾返回错误码为:"+n.errorCode+",盾箱数量将减一。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newKey)),PJF.communication.stmManageAjax({fwServiceId:"stm.doReadCardKey",jsonData:PJF.stm.client.newKey,maskBody:!0,success:function(t){var e;(e=n).status?o&&o(e):(PJF.stm.client.newKey.recycle_type="Read",PJF.stm.client.newKey.recycle_msg="外设出盾失败，错误信息为:"+e.errorMsg,$.extend(e,{conReason:"外设出盾失败"}),i(e))},failure:function(t){n.status=0,n.errorMsg=t.BK_DESC,PJF.stm.client.newKey.recycle_type="Read",PJF.stm.client.newKey.recycle_msg=t.BK_DESC,$.extend(n,{conReason:t.BK_DESC}),i(n)}})
}else console.log("发盾返回错误码为:"+n.errorCode+",盾箱数量将不变。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newKey)),o&&o(n)},function(t){var e={};return e.status=t.status,e.keyData=t.keyData,e})},eject:function(o,a,s){function r(t){new PJF.ui.messageBox({title:"提示信息",content:t||"设备故障,请联系工作人员！",buttonConfs:[{bgColor:"rgb(121,198,30)",name:"确定",style:"main",width:200,height:80,onClick:function(){}}]})}PJF.stm.log("吐盾","PJF_LOG_HARDWARE"),PJF.stm.KDB.ejectDev({iotFunc:s.iotFunc,uniqueNo:s.uniqueNo},function(t){if(1==t.status){o&&o(t);var e,n=new PJF.ui.loading({msg:"请取走您的网银盾",timeout:20});PJF.communication.player.PlaySoundByUrl("devprompt/KDB_taken.wav");var i=setTimeout(function(){PJF.event.removeSubscriber(PJF.stm.client.events.KDB_TAKEN,e),n.destroy(),s.stmManage&&(s.stmManage.recycle_type="Popout"),PJF.stm.KDB.confiscateDev({stmManage:s.stmManage,conReason:"吐盾超时未取",iotFunc:s.iotFunc,uniqueNo:s.uniqueNo},function(t){t.status?t.status=3:(t.status=4,r(t.errorMsg),
console.log("没收网银盾失败，错误代码为:"+t.errorCode)),a&&a({success:!1})})},2e4);PJF.event.onceSubscriber(PJF.stm.client.events.KDB_TAKEN,e=function(){clearTimeout(i),n.destroy(),a&&a({success:!0})})}else o?o(t):r(t.errorMsg),console.log("吐盾失败,错误信息为:"+JSON.stringify(t))})},ejectDev:function(t,e){(t={timeout:t.timeout||20,iotFunc:t.iotFunc,uniqueNo:t.uniqueNo,coordinateX:PJF.otherInfo.globalParams.coordinateX,coordinateY:PJF.otherInfo.globalParams.coordinateY,angle:PJF.otherInfo.globalParams.angle}).iotFunc&&(t.timeout=120),PJF.stm.client.callClient("App_KDB","KDB_Eject",t,e,function(t){var e={};return e.status=t.status,e})},confiscateDev:function(e,n){PJF.stm.log("吞盾","PJF_LOG_HARDWARE");e=$.extend({timeout:20,iotFunc:!1,uniqueNo:""},e);var t=(PJF.stm.enterMenu?PJF.stm.enterMenu.NAME:"首页")+"有盾被吞，吞盾原因为"+(e.stmManage&&e.stmManage.recycle_msg?e.stmManage.recycle_msg:e.conReason);PJF.communication.callPad({busiName:t}),PJF.stm.client.callClient("App_KDB","KDB_Confiscate",e,function(t){
t.status&&e.stmManage&&($.extend(e.stmManage,{cardkey_type:"Key",device_id:PJF.otherInfo.devId,ins_id:PJF.roleInfo.orgCode}),PJF.communication.stmManageAjax({fwServiceId:"stm.doLogCardKeyFailure",jsonData:e.stmManage})),n&&n(t)},function(t){return{}})},getChannelStatus:function(t){PJF.stm.client.callClient("KDB","getChannelStatus",{timeout:20},t,function(t){return t})}},PJF.stm.ReceiptPrinter={doPrint:function(e,n){var i,t=e.pchContent.split("&",100),o=e.pchContent.split("&");t.length!=o.length&&(i=!0,o.splice(0,100));e={pchContent:t.join("&"),timeout:e.timeout||20};PJF.communication.player.PlaySoundByUrl("devprompt/TPT_taken.wav",!0);PJF.stm.client.callClient("TPT","doPrint",e,function(t){"1"==t.status&&i?PJF.stm.ReceiptPrinter.doPrint({timeout:e.timeout,pchContent:o.join("&")},n):(PJF.stm.client.callClient("COMMON","getDevStatus",{pchType:"TPT"},function(t){"TPT0000006"==t.errorCode?PJF.communication.callPad({busiName:"STM终端凭条打印纸张即将用完，请及时添加"
}):"TPT0000004"==t.errorCode?PJF.communication.callPad({busiName:"STM终端凭条打印纸张已经用完，请立即添加"}):"TPT0000005"==t.errorCode&&PJF.communication.callPad({busiName:PJF.otherInfo.devId+"设备办理"+(PJF.otherInfo.MENU_ID&&PJF.stm.menuTree&&PJF.stm.menuTree[PJF.otherInfo.MENU_ID]&&PJF.stm.menuTree[PJF.otherInfo.MENU_ID].NAME)+"业务打印回执卡纸"})},function(t){return t}),n&&n(t))},function(t){return{}})}},PJF.stm.SXT={openCamera:function(t,e){PJF.stm.log("打开摄像头","PJF_LOG_HARDWARE");var n=$("#"+t.domId)[0];if(n){var i=n.getBoundingClientRect(),o=$.extend({},{x:i.left+window.screenLeft,y:i.top+window.screenTop,w:i.width,h:i.height,iWidth:t.iWidth||640,iHeight:t.iHeight||480,timeout:t.timeout||30,iIndex:t.iIndex||1,showWaterMark:void 0===t.showWaterMark||t.showWaterMark});return!1===t.loadingConf&&(o.loadingConf=!1),PJF.fsm.get(PJF.fsm.fmIds.STM_CAMERA).openCamera(),PJF.stm.client.callClient("SXT","cameraPreview",o,e,function(t){return t})}console.log("openCamera找不到摄像头开启的DOM元素")},takePhoto:function(t,e){
return PJF.stm.log("拍照","PJF_LOG_HARDWARE"),t=$.extend({iIndex:1,imageType:2,iExpRate:70,timeout:30,iWidth:t.iWidth||640,iHeight:t.iHeight||480},t),PJF.stm.client.callClient("SXT","takePhoto",t,e,function(t){var e={};return e.pbContent=t.imgBase64,e})},closeCamera:function(t,e){return PJF.stm.log("关闭摄像头","PJF_LOG_HARDWARE"),t=$.extend({iIndex:1},t),PJF.fsm.get(PJF.fsm.fmIds.STM_CAMERA).closeCamera(),PJF.stm.client.callClient("SXT","stopPreview",t,e,function(t){return t})}},PJF.stm.register={registerMachine:function(){var t;(PJF.stm.SMS_SER_NO=0,PJF.userInfo={},PJF.userInfo.userCode="01000000",PJF.userInfo.orgCode="442000034",PJF.roleInfo={},PJF.roleInfo.orgCode="442000034",PJF.roleInfo.noRepeatRoleAuthInfoList=[],PJF.otherInfo={},PJF.otherInfo.secNode="102001",PJF.otherInfo.devId="44201006",PJF.otherInfo.vtaId="vtm06",PJF.otherInfo.vtaTeller="88761",PJF.otherInfo.vtaPass=1,PJF.otherInfo.picPath=PJF.constants.PIC_PATH,PJF.otherInfo.chaType="10110109",
PJF.otherInfo.cashChaType="20470109",PJF.otherInfo.authType="01",PJF.otherInfo.faceType="01",PJF.otherInfo.typeInfo="STM",PJF.otherInfo.moduleParams={},PJF.orgInfo={},PJF.orgInfo.instLevel1BranchId="442000000",PJF.orgInfo.instSvrlLgPsnID="CN000",PJF.roleInfo.orgName="龙华支行",PJF.orgCode={},PJF.orgCode.instLevel1BranchId="442000000",PJF.otherInfo.token="AzEwMjAwMQAxMDIwMDEAw8Pdhp/j2EhE6nn6GPGLSZbdfEcdzumIOunebscgqyiw6lkfHdnJql/yEOxkzpRv6Bv+0l3H8kv33QYbQwZ/oX+tAnEB1Tn4OTv1QsNJ6Fz0WBb7WTjW53v54UXqS81Q/Ek2rNtSGHycZxcGorMBZjJXeqHvQKcK3UEkpPSohphhlgABEQQAARAEAAQRBAABEQQyMDE1MDIwMTIwNTg0NAAAAAAAMjAxNTAyMDEyMjAwMDAAAAAAADIwMTUwMjAyMjIwMDAwAAAAAAADAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAA",PJF.otherInfo.globalParams={},
PJF.communication.isInClient())?"android"==PJF.communication.getClientType()?(t=PJF.communication.GetAppTempFolder()).success&&(PJF.stm.baseDir=t.result):(t=PJF.communication.fileSystem.getAppStorageFolder()).success&&(PJF.stm.baseDir=t.result):PJF.stm.baseDir="d:";PJF.otherInfo.sysParam=PJF.util.safeParse(PJF.communication.localStorage.getValue("ClientSysParamInfo").result,{}),PJF.constants.CCBS_TRANSFORM=PJF.otherInfo.sysParam.ORG_MENU_TABLE||PJF.constants.CCBS_TRANSFORM,PJF.monitor.startFsm(),PJF.stm.client.redefine(),-1!=location.href.indexOf("fromPad")?PJF.stm.register.registerPad():PJF.communication.isInClient()?(PJF.monitor.startClickMonitor(),PJF.monitor.startDeviceEventMonitor(),PJF.stm.register.registerStm(),PJF.stm.register.registerTimeoutFn()):(PJF.stm.register.getToken(),PJF.stm.register.genTemplate(),PJF.stm.register.getParentOrgs())},registerPad:function(){var l;return function(n){PJF.stm.faceAudit={},l&&l.destroy(),l=new PJF.ui.loading({text:"页面正在加载中，请稍候……"})
;var t=PJF.communication.localStorage.getValue("_sys_stm_data_");if(!t.success)return new PJF.ui.errorMessageBox({content:"获取STM初始数据失败",buttonConfs:[{style:"main",bgColor:"rgb(20,149,214)",name:"退出",onClick:function(){PJF.communication.Tabs.CloseThisTab()}}]}),void l.destroy();var e=PJF.util.getValue(window,"PJF._extra.custAuthInfo.sencePhoto"),i=PJF.util.getValue(window,"PJF._extra.custAuthInfo.identity");if(PJF.otherInfo.uploadIdenAuth=!!PJF.otherInfo.uploadIdenAuth,$.extend(!0,PJF,JSON.parse(t.result)),PJF.otherInfo.padInit||(PJF.otherInfo.padInit=!0,PJF.util.deviceType.ytd=!0,PJF.util.deviceType.pad=!0,PJF.monitor.startDeviceEventMonitor(),PJF.stm.register.getParentOrgs(),PJF.otherInfo.chaTypeId="0109"+PJF.otherInfo.devId+"           ",PJF.stm.register.getToken(),PJF.stm.register.getAuditPositions(),PJF.stm.register.getElecSeal(),PJF.stm.register.getGlobalParams()),PJF._extra.noComfirm)return PJF.stm.idenAuth={idenAudit:{},authInfo:{}},
1==PJF._extra.custAuthInfo.authFlag?(PJF.stm.idenAuth.idenAudit={STM_IDENTITY_AUDIT_CODE:PJF._extra.custAuthInfo.adtOprId,STM_IDENTITY_AUDIT_NAME:PJF._extra.custAuthInfo.adtOprNm},PJF.stm.idenAuth.authInfo.operCode=PJF._extra.custAuthInfo.adtOprId,PJF.stm.idenAuth.authInfo.operName=PJF._extra.custAuthInfo.adtOprNm,PJF.otherInfo.authType="DF001"==PJF.orgInfo.instSvrlLgPsnID?"02":"03"):2==PJF._extra.custAuthInfo.authFlag&&(PJF.stm.idenAuth.idenAudit={STM_IDENTITY_AUDIT_CODE:PJF._extra.custAuthInfo.coAuthEmpNo,STM_IDENTITY_AUDIT_NAME:PJF._extra.custAuthInfo.coAuthEmpNm},PJF.stm.idenAuth.authInfo.operCode=PJF._extra.custAuthInfo.coAuthEmpNo,PJF.stm.idenAuth.authInfo.operName=PJF._extra.custAuthInfo.coAuthEmpNm,PJF.otherInfo.authType="02"),PJF.otherInfo.uploadIdenAuth=!0,void c();if(!PJF._extra.custAuthInfo)return l.destroy(),void new PJF.ui.errorMessageBox({content:"客户没有进行身份验核",buttonConfs:[{style:"main",bgColor:"rgb(20,149,214)",name:"退出",onClick:function(){
PJF.communication.Tabs.CloseThisTab()}}]});if(e===PJF._extra.custAuthInfo.sencePhoto&&i===PJF._extra.custAuthInfo.identity&&PJF.otherInfo.uploadIdenAuth)c();else if(PJF.otherInfo.uploadIdenAuth=!1,PJF.namespace("PJF.stm.idenAuth"),PJF.stm.idenAuth.isAuth=!0,PJF.stm.idenAuth.custInfo={},PJF.stm.idenAuth.custInfo.name=PJF._extra.custAuthInfo.name,PJF.stm.idenAuth.custInfo.sex=PJF._extra.custAuthInfo.sex,PJF.stm.idenAuth.custInfo.nation=PJF._extra.custAuthInfo.nation,PJF.stm.idenAuth.custInfo.birth=PJF._extra.custAuthInfo.birth,PJF.stm.idenAuth.custInfo.address=PJF._extra.custAuthInfo.address,PJF.stm.idenAuth.custInfo.identity=PJF._extra.custAuthInfo.identity,PJF.stm.idenAuth.custInfo.issueOffice=PJF._extra.custAuthInfo.issueOffice,PJF.stm.idenAuth.custInfo.validDate=PJF._extra.custAuthInfo.validDate||"-",PJF.stm.idenAuth.custInfo.valid_begin=PJF.stm.idenAuth.custInfo.validDate.split("-")[0],PJF.stm.idenAuth.custInfo.valid_end=PJF.stm.idenAuth.custInfo.validDate.split("-")[1],
PJF.stm.idenAuth.custInfo.pbContent=PJF.communication.fileSystem.readImage(PJF._extra.custAuthInfo.sencePhoto).result,PJF.stm.idenAuth.authInfo={},1==PJF._extra.custAuthInfo.authFlag?(PJF.stm.idenAuth.idenAudit={STM_IDENTITY_AUDIT_CODE:PJF._extra.custAuthInfo.adtOprId,STM_IDENTITY_AUDIT_NAME:PJF._extra.custAuthInfo.adtOprNm},PJF.stm.idenAuth.authInfo.operCode=PJF._extra.custAuthInfo.adtOprId,PJF.stm.idenAuth.authInfo.operName=PJF._extra.custAuthInfo.adtOprNm,PJF.otherInfo.authType="DF001"==PJF.orgInfo.instSvrlLgPsnID?"02":"03"):2==PJF._extra.custAuthInfo.authFlag&&(PJF.stm.idenAuth.idenAudit={STM_IDENTITY_AUDIT_CODE:PJF._extra.custAuthInfo.coAuthEmpNo,STM_IDENTITY_AUDIT_NAME:PJF._extra.custAuthInfo.coAuthEmpNm},PJF.stm.idenAuth.authInfo.operCode=PJF._extra.custAuthInfo.coAuthEmpNo,PJF.stm.idenAuth.authInfo.operName=PJF._extra.custAuthInfo.coAuthEmpNm,PJF.otherInfo.authType="02"),PJF.stm.idenAuth.idenAudit.STM_FACE_SMLR_DGR=PJF._extra.custAuthInfo.smlr,
PJF.stm.idenAuth.idenAudit.STM_FACE_BLACK=PJF._extra.custAuthInfo.black,PJF.otherInfo.padUserMobileNo="",PJF.stm.register.getPadUserMobileNo(),PJF.stm.idenAuth.custInfo.photo=PJF._extra.custAuthInfo.sencePhotoName,PJF.stm.idenAuth.custInfo.idPhoto=PJF._extra.custAuthInfo.pchPhotoName,PJF.stm.idenAuth.custInfo.idFront=PJF._extra.custAuthInfo.frontPhotoName,PJF.stm.idenAuth.custInfo.idBack=PJF._extra.custAuthInfo.backPhotoName,!PJF.communication.isInClient()||1!=PJF._extra.custAuthInfo.authFlag&&2!=PJF._extra.custAuthInfo.authFlag)PJF.otherInfo.uploadIdenAuth=!0,c();else{var o={};o[PJF.stm.idenAuth.custInfo.photo]={path:PJF._extra.custAuthInfo.sencePhoto},o[PJF.stm.idenAuth.custInfo.idPhoto]={path:PJF._extra.custAuthInfo.pchPhotoPath},o[PJF.stm.idenAuth.custInfo.idFront]={path:PJF._extra.custAuthInfo.frontPhotoPath},o[PJF.stm.idenAuth.custInfo.idBack]={path:PJF._extra.custAuthInfo.backPhotoPath};var a=[];for(var s in o)a.push({dest:PJF.stm.baseDir+"/identity/"+s,source:o[s].path})
;var r=PJF.communication.fileSystem.fileOperation("FO_COPY",a);if(!r.success)return new PJF.ui.errorMessageBox({content:"身份审核的图片没有全部拷贝成功:"+r.error,buttonConfs:[{style:"main",bgColor:"rgb(20,149,214)",name:"退出",onClick:function(){PJF.communication.Tabs.CloseThisTab()}}]}),void l.destroy();PJF.otherInfo.uploadIdenAuth=!0,c()}function c(){PJF.fsm.create({id:PJF.fsm.fmIds.STM_PAD_TEMPLATEINFO,initial:"nope",done:"yes",actions:[{name:"notTemplateInfoAuth",from:"yes",to:"nope"},{name:"templateInfoAuth",from:"nope",to:"yes"}]}),l.destroy(),PJF.stm.register.genTemplate({padMenuUrl:!0},function(){"DF001"==PJF.orgInfo.instSvrlLgPsnID&&$(".template_logo").css("background-image","url(icon/logo_zd.png)");var t=document.createElement("a"),e=n||PJF.html.getUrlParam("fromPad")||"subMenuPage";t.href="#!"+e,t.onclick=function(t){PJF.event.publish("STM_MENU_CLICK",PJF.otherInfo.MENU_ID,t,window),!1===t.defaultPrevented&&PJF.spa.getLocation()==e&&template.refresh()},document.body.appendChild(t),t.click(),
document.body.removeChild(t)})}}}(),orgCodeException:function(){PJF.communication.localStorage.removeItem("pjfLoginOrgCode"),window.location.href="http://"+window.location.host+"/bosWeb/page/stm/common/stmTemplatePage.html"},errorCodeHandler:function(t,e,n,i){new PJF.ui.errorMessageBox({content:t,detailMsg:e,buttonConfs:[{style:"main",bgColor:"rgb(20,149,214)",name:n,onClick:i}]})},getToken:function(){var t={};t.userId=PJF.otherInfo.devId;var e={_fw_service_id:"getUserKeysKit"};e.jsonData=PJF.util.json2str(t),PJF.communication.ajax({data:e,async:!1,url:"ecpJson.action",success:function(t){if(t&&t._e2e)PJF.otherInfo.token=t._pin.retValue,PJF.otherInfo.e2etoken=t._e2e;else new PJF.ui.messageBox({title:"提示信息",content:"获取服务器密钥失败:"+(t&&t.BK_DESC),buttonConfs:[{name:"确定",style:"main",width:200,height:80}]})}})},getOrgDesc:function(){new PJF.communication.ajax({url:"/bosWeb/ecpJson.action",async:!1,data:{_fw_service_id:"orgTextService",nodeArr:[PJF.roleInfo.orgCode]},success:function(t){
t&&0<t.length&&t[0].name?PJF.roleInfo.orgName=t[0].name:console.log("无法获取机构表中机构对应的名称:"+PJF.roleInfo.orgCode)},failure:function(){console.log('获取机构表中机构对应的名称失败"'+PJF.roleInfo.orgCode)}})},getParentOrgs:function(){PJF.communication.cpsJsonReq({jsonData:JSON.stringify({ccbins_id:PJF.roleInfo.orgCode}),async:!1,fwServiceId:"databaseTransaction",fwTranId:"findList",sqlId:"validate.queryOrgClassInfo",success:function(t){t.database_result&&t.database_result[0]&&(PJF.roleInfo.blngOrgs=t.database_result[0])},failure:function(t){}}),PJF.roleInfo.blngOrgs=PJF.roleInfo.blngOrgs||{BLNG_BO_INSID:PJF.roleInfo.orgCode}},getElecSeal:function(){var t={Txn_InsID:PJF.userInfo.orgCode,HstBnk_FstLvlBr_InsID:PJF.orgCode.instLevel1BranchId,Txn_Chnl_Cd:"1",_auth_info:{TXN_STFF_ID:"99999999"}};PJF.roleInfo._elec_seal_switch=!1,PJF.communication.cpsJsonReq({jsonData:PJF.util.json2str(t),fwServiceId:"simpleTransaction",fwTranId:"A0161M543-stm",success:function(t){
console.log("A0161M543 success:"+JSON.stringify(t)),PJF.roleInfo._elec_seal_switch=0==t.Swtc_StCd},failure:function(t){console.log("A0161M543 fail:"+JSON.stringify(t))}})},getAuditPositions:function(){if("DA003"!==PJF.orgInfo.instSvrlLgPsnID){var t={};t.deviceType=PJF.otherInfo.typeInfo,t.insId=PJF.roleInfo.orgCode;var e=PJF.constants.MGT_SERVER+"/bosWeb/ecpJson.action",n="jsonData="+JSON.stringify(PJF.communication.addParam(t))+"&_fw_service_id=stm.getAuditPositions";console.log("跨域获得岗位黑名单参数为:"+n),PJF.communication.Http.SendCrossDomainRequest(e,n,3e4,function(t,e){console.log("跨域返回结果,status:"+t+";responseData:"+e),(t=JSON.parse(t)).success&&e?(e=JSON.parse(e))&&e.BK_STATUS&&e.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?(console.log("获得岗位黑名单成功;"+JSON.stringify(e.positions)),PJF.otherInfo.auditPos=e.positions):console.log("获得岗位黑名单失败"):console.log("获得岗位黑名单通信失败")})}},getGlobalParams:function(){var t={insid:PJF.roleInfo.orgCode,dev_id:PJF.otherInfo.devId,device_type:PJF.otherInfo.typeInfo,
biz_type:PJF.otherInfo.bizType,province_code:PJF.otherInfo.typeInfo};PJF.communication.cpsJsonReq({jsonData:PJF.util.json2str(t),fwServiceId:"stm.queryGlobalParam",fwTranId:"stm.queryGlobalParam",async:!1,maskAll:!0,success:function(t){console.log("queryGlobalParam success:"+JSON.stringify(t)),t.RESULT_DATA&&(PJF.otherInfo.notComplement="00"==t.RESULT_DATA.recordSwitch),PJF.otherInfo.globalParams=t.RESULT_DATA||{}},failure:function(t){console.log("queryGlobalParam fail:"+JSON.stringify(t))}})},selfSocketHandler:function(){if(PJF.otherInfo.isSelfBank&&PJF.otherInfo.hasDoor){i=function(t){if("CMD_BUSI_STM_faceIdentifyResult"==t.cmdName){var e,n=PJF.util.safeParse(t.cmdParas);PJF.stm.util.getQRQM(n.Cst_ID),PJF.otherInfo.snInfo={},PJF.otherInfo.snInfo.cstId=n.Cst_ID,PJF.otherInfo.snInfo.name=n.Idv_Lgl_Nm,PJF.otherInfo.snInfo.identity=n.Crdt_No,PJF.otherInfo.snInfo.tpCd=n.Crdt_TpCd,PJF.otherInfo.snInfo.cstId?e={Cst_Id_MtdCd:"4",Cst_ID:PJF.otherInfo.snInfo.cstId
}:PJF.otherInfo.snInfo.name&&PJF.otherInfo.snInfo.identity&&PJF.otherInfo.snInfo.tpCd&&(e={Cst_Id_MtdCd:"1",Id_Crdt_TpCd:PJF.otherInfo.snInfo.tpCd,Id_Crdt_No:PJF.otherInfo.snInfo.identity,Id_Idv_Lgl_Nm:PJF.otherInfo.snInfo.name}),e&&PJF.communication.cpsJsonReq({fwServiceId:"simpleTransaction",fwTranId:"A00421639-stm",jsonData:JSON.stringify(PJF.apply(e,{MULTI_TENANCY_ID:PJF.orgInfo.instSvrlLgPsnID,Apl_Scn_TpCd:1,CsInf_Enqr_MtdCd:"1"})),success:function(t){PJF.otherInfo.snInfo.sex=t.Gnd_Cd,PJF.otherInfo.snInfo.cstId=t.Cst_ID,PJF.otherInfo.snInfo.name=t.Idv_Lgl_Nm,PJF.otherInfo.snInfo.identity=t.Crdt_No,PJF.otherInfo.snInfo.tpCd=t.Crdt_TpCd,PJF.event.publish("PJF_SELFBANK_FACEIDEN_CHANGE")},failure:function(t){console.log("无人银行进入舱门调用A00421639交易失败:",JSON.stringify(t))}})}if("CMD_BUSI_STM_doorOpenNotice"==t.cmdName){if("outside"==t.cmdParas.position&&"soundIndex"!=PJF.spa.getLocation()&&setTimeout(function(){template.loadPage("soundIndex",{doorOpened:!0})},1e3),
"inside"==t.cmdParas.position){var i=PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).is("hasCard"),o=PJF.fsm.get(PJF.fsm.fmIds.STM_IDCARD).is("hasId");console.log("出门有卡:"+i+"；有证:"+o),i&&o?PJF.stm.ICMaker.ejectCard(function(){PJF.stm.IdCard.ejectDev(function(){})}):i&&!o?PJF.stm.ICMaker.ejectCard(function(){}):!i&&o?PJF.stm.IdCard.ejectDev(function(){}):PJF.communication.player.SpeekText("请拿好随身物品，欢迎下次光临",100),"homepage"!=PJF.spa.getLocation()&&template.loadPage("homepage")}PJF.stm.idenAuth={},PJF.otherInfo.snInfo={},PJF.otherInfo.selfHasContract=!1,STM.common.clearFaceContractInfo(),PJF.event.publish("PJF_SELFBANK_FACEIDEN_CHANGE"),PJF.event.publish("QRQM_MENUS")}},(n=PJF.communication.SocketServer.StartServer("4599","",function(t){var e=PJF.util.safeParse(t);if(e.success){var n=e.result;PJF.event.removeSubscriber(n),PJF.event.addSubscriber(n,function(t,e){console.log("socket type:"+t+",data:"+e);var n=PJF.util.safeParse(e).eventData
;-1==["Started","Stoped","SocketAccept","SocketClosed"].indexOf(t)&&n&&(console.log("socket accept result:"+n),i(PJF.util.safeParse(n)))})}else console.log("start socket callbackRet error:"+(e&&e.error))}))&&n.success?console.log("start socket server success"):console.log("start socket server error:"+(n&&n.error));var t={Orig_Stm_ID:PJF.otherInfo.devId,Eqmt_Modl:"IP_CAMERA"},e="";PJF.communication.cpsJsonReq({jsonData:JSON.stringify(t),fwServiceId:"simpleTransaction",fwTranId:"A0161W709-stm",async:!1,success:function(t){console.log("A0161W709 success:"+JSON.stringify(t)),t.EQMT_GRP&&$.isArray(t.EQMT_GRP)&&(e=t.EQMT_GRP[0].Iot_Equip_ID)},failure:function(t){console.log("A0161W709 failure:"+JSON.stringify(t))}}),PJF.stm.RTS.setIotID({pchIOTId:e,pchDevId:PJF.otherInfo.devId,loadingConf:!1},function(t){console.log("selfbank setiotid result:"+JSON.stringify(t))})}var i,n},registerSuccess:function(t){console.log("stm后端注册成功:"+JSON.stringify(t)),
PJF.communication.fileSystem.runWinCmd('"start /b rd /s /q c:\\$Recycle.bin"'),PJF.communication.fileSystem.runWinCmd('"start /b rd /s /q d:\\$Recycle.bin"'),PJF.otherInfo.devId=t.dev_id,PJF.otherInfo.vtaId=t.vta_account,PJF.otherInfo.vtaPass=t.vta_pass,PJF.otherInfo.vtaTeller=t.vta_teller,PJF.otherInfo.dev_operUser=t.dev_operUser,PJF.userInfo.userCode=t.dev_id,PJF.communication.localStorage.setValue("pjfLoginDevId",t.dev_id),PJF.roleInfo.orgCode=t.insid,PJF.userInfo.orgCode=t.insid,0==t.insid.indexOf("01075")&&(PJF.orgInfo.instSvrlLgPsnID="DF001"),PJF.stm.register.getParentOrgs(),PJF.communication.localStorage.setValue("pjfLoginOrgCode",t.insid),PJF.roleInfo.orgName=t.insName,PJF.orgCode.instLevel1BranchId=t.province_code,"010741100"==t.province_code&&(PJF.orgInfo.instSvrlLgPsnID="DA003"),PJF.orgInfo.instLevel1BranchId=t.province_code,PJF.otherInfo.bizType=t.biz_type,PJF.otherInfo.chaTypeId="0109"+t.dev_id+"           ",PJF.otherInfo.faceType=t.biz_check,
PJF.otherInfo.remoteBiz=t.remoteBiz,t.channel_id&&(PJF.otherInfo.cashChaId=t.channel_id),t.rcbslst&&(PJF.otherInfo.moduleParams=t.rcbslst);var c=t.device_type,l=t.vendor_code,u=t.model_code;PJF.otherInfo.isSelfBank="21"==t.term_Layout||"22"==t.term_Layout,PJF.otherInfo.hasDoor="21"==t.term_Layout,PJF.otherInfo.selfHasContract=!1,PJF.otherInfo.snInfo={},PJF.otherInfo.typeInfo=t.device_type,PJF.otherInfo.venderCode=t.vendor_code,PJF.otherInfo.venderName=t.vendor_name,PJF.otherInfo.modelCode=t.model_code,console.log("当前设备信息为，硬件类型："+c+"，设备厂商代码："+l+"，硬件信息："+u),PJF.otherInfo.isSelfBank&&("ZT2199"==PJF.otherInfo.modelCode?PJF.otherInfo.selfBizTp="1":"VTM600B-B03"==PJF.otherInfo.modelCode?PJF.otherInfo.selfBizTp="2":"VTM600B-B02"==PJF.otherInfo.modelCode?PJF.otherInfo.selfBizTp="3":"BST260B-A09"==PJF.otherInfo.modelCode&&(PJF.otherInfo.selfBizTp="4")),c==PJF.constants.STM_NAME||c==PJF.constants.ICM_NAME||c==PJF.constants.TCR_NAME?(PJF.util.deviceType.stm=!0,
c==PJF.constants.ICM_NAME?PJF.util.deviceType.icm=!0:c==PJF.constants.TCR_NAME&&(PJF.util.deviceType.tcr=!0)):c==PJF.constants.YTD_NAME&&(PJF.util.deviceType.ytd=!0),PJF.stm.register.getGlobalParams(),PJF.roleInfo.isBino="01"==PJF.otherInfo.globalParams.binocularSwitch&&PJF.util.deviceType.stm&&!PJF.util.deviceType.icm,PJF.roleInfo.isVoice="01"==PJF.otherInfo.globalParams.VoiceNaviSwitch&&PJF.util.deviceType.stm&&!PJF.util.deviceType.icm;var e=PJF.util.formatDate(new Date,"yyyyMMdd"),n=PJF.util.formatDate(new Date,"hhmmss");PJF.stm.log("-----------------------STM启动信息-----------------------"),PJF.stm.log("时间:"+e.substr(0,4)+"/"+e.substr(4,2)+"/"+e.substr(6)+" "+n.substr(0,2)+":"+n.substr(2,2)+":"+n.substr(4)),PJF.stm.log("银行号:"+PJF.roleInfo.orgCode),PJF.stm.log("设备号:"+PJF.otherInfo.devId+",类型:"+PJF.otherInfo.typeInfo),PJF.stm.log("版本号:"+PJF.otherInfo.verInfo),t.auth_type&&(PJF.otherInfo.authType=t.auth_type),c&&l&&u?PJF.communication.devices.IsDeviceRegistered(c,l,u,function(t){
var e=JSON.parse(t);if(e.success)if("False"==JSON.parse(e.result).Registered)PJF.communication.devices.RegisterDevice(c,l,u,function(){new PJF.ui.messageBox({title:"提示信息",content:"设备已经完成注册，即将重启",buttonConfs:[{name:"确定",style:"main",width:200,height:80,onClick:function(){PJF.communication.devices.ResetDevice("ALL")}}]})});else{PJF.stm.register.getToken(),PJF.stm.register.getOrgDesc(),PJF.stm.register.getAuditPositions(),PJF.stm.register.getElecSeal(),PJF.communication.sendToMDM(),PJF.stm.register.selfSocketHandler(),PJF.constants.IS_REMOTECONTROL&&"540000000"==PJF.orgInfo.instLevel1BranchId&&"080000"<PJF.util.formatDate(new Date,"hhmmss")&&PJF.util.formatDate(new Date,"hhmmss")<"200000"&&PJF.stmRemoteControl.enableMonitor();var n=PJF.communication.localStorage.getValue("ClientSysParamInfo");if(n.success)try{n=JSON.parse(n.result);try{PJF.event.addSubscriber(PJF.constants.IM_CONNECTED_EVENT,function(){window.im=i,$(".template_welcome").css("background-image","url(icon/im_connected.png)")
});var i=new PJF.im({url:PJF.constants.IM_URL,id:PJF.userInfo.userCode,type:"stm",orgCode:PJF.roleInfo.orgCode,pwd:PJF.constants.DEF_IM_PASSWORD,recMsgHandler:function(t){console.log("im msg rec:"+PJF.util.htmlDecode(t));var e={};try{e=JSON.parse(PJF.util.htmlDecode(t))}catch(t){console.log("im 解析消息失败")}"homepage"==template.getLocation()&&e.STM_SWITCH_MENU_SIGNAL&&(PJF.otherInfo._onBranch=e.STM_SWITCH_MENU_SIGNAL,PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).is("noCard")?PJF.stm.ICMaker.stopInhale({loadingConf:{msg:"设备正在处理中..."}},function(){template.refresh()}):template.refresh()),PJF.otherInfo.smartBank&&"00"==e.BK_CODE&&e.Cst_ID&&(console.log("smart bank cst id received:"+e.Cst_ID),PJF.stm.util.modSmartMenus(),PJF.stm.util.queryUsedMenus(e.Cst_ID))}})}catch(t){i=null,console.log("im登录失败")}if(-1<JSON.parse(n.smartBank||"[]").indexOf(PJF.roleInfo.orgCode)){PJF.otherInfo.smartBank=!0,PJF.otherInfo.smartIP=[];var o={RI_CatCd:"04",Blng_InsID:PJF.orgInfo.instLevel1BranchId,Srv_Ind:"1"}
;PJF.communication.cpsJsonReq({jsonData:JSON.stringify(o),fwServiceId:"simpleTransaction",fwTranId:"A0161S201",success:function(t){for(var e in t.RES_GRP)console.log("S201 success ip:"+t.RES_GRP[e].EQMT_RES_GRP.IP_Adr),PJF.otherInfo.smartIP.push(t.RES_GRP[e].EQMT_RES_GRP.IP_Adr)},failure:function(t){console.log("S201 failure:"+JSON.stringify(t))}})}PJF.roleInfo._elec_seal_capability=!0;var a=JSON.parse(n.faceOrg||"[]");PJF.otherInfo.faceOrg=-1<a.indexOf(PJF.orgInfo.instLevel1BranchId.substr(0,3))}catch(t){console.log("解析ClientSysParamInfo出错")}else console.log("读取ClientSysParamInfo失败");if(PJF.otherInfo.merge=PJF.otherInfo.sysParam.merge&&-1<PJF.otherInfo.sysParam.merge.indexOf(PJF.otherInfo.devId),console.log("merge:"+PJF.otherInfo.merge),PJF.otherInfo.merge){PJF.communication.IAT.VoiceWakeUpStart("小智你好",-1,function(t){});var s=PJF.constants.ON_PROD?"11.49.186.17:8103":"128.196.102.76:1000",r=function(t){
var e='appid=1zh5Gy6J,svc=iatnlp,auf=audio/L16;rate=16000,aue=raw,type=1,uid=660Y5r,url=128.128.98.38:1028,extend_params={"params":"org=stm,token=D2572A0D1,ability=ab_atsnlp,eos=2000"}';PJF.constants.ON_PROD&&(e='appid=1zh5Gy6J,svc=iatnlp,auf=audio/L16;rate=16000,aue=raw,type=1,uid=660Y5r,url=11.49.186.17:1028,extend_params={"params":"org=stm,token=D2572A0D1,ability=ab_atsnlp,eos=2000"}');var n=PJF.stm.baseDir+"/identity/yuyin.wav";PJF.communication.IAT.StartTransForm(e,function(t){console.log("start transform callback:"+t)}),PJF.communication.IAT.StartRecording(n,function(t){console.log("语音唤醒，声音解析结果:"+t),PJF.communication.IAT.StopRecording(),PJF.communication.TTS.VoiceStop();var e="string"==typeof t?JSON.parse(t):t;if(e.success){if("谢谢"==e.result)return void console.log("已休眠，请重新唤醒");if(e.result){var n={KnPt_Char_Cd:"03",Rel_Inf:e.result};PJF.stm.util.smartHandler_query(n,function(t){PJF.communication.TTS.VoicePlay(s,null,t.KnPt_Ass_Cntnt.replace(/<\/?font[^>]*>/gi,""),20,function(t){
var e=JSON.parse(t);e.success||console.log("语音合成异常"+e.error)})})}r(120)}},t)};PJF.event.addSubscriber("VoiceWakeUp",function(t){console.log("VoiceWakeUp callback:"+t),PJF.communication.TTS.VoiceStop(),PJF.communication.TTS.VoicePlay(s,null,"您好！",10,function(t){var e=JSON.parse(t);e.success||console.log("语音合成异常"+e.error)}),r()})}PJF.stm.register.genTemplate()}else new PJF.ui.messageBox({title:"提示信息",content:"设备注册失败，请联系系统管理员注册本设备",buttonConfs:[{name:"确定",style:"main",width:200,height:80}]})}):PJF.stm.register.errorCodeHandler("设备注册信息不完整，请联系系统管理员完善注册","","确定",PJF.communication.AppExit)},registerTimeoutFn:function(){var c,l,u;PJF.event.addSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c=function(e){PJF.stm.register.registerTimeoutFn._time=e;var t="homepage"==template.getLocation();if(!template.getNewPageObj()||!template.getNewPageObj().noConfiscateCard){
if(PJF.util.deviceType.ytd&&PJF.constants.YTD_TIMEOUT&&-1==PJF.constants.NO_MONITOR_PAGE.indexOf(template.getLocation())&&!t&&PJF.fsm.isDone([PJF.fsm.fmIds.STM_CAMERA,PJF.fsm.fmIds.STM_SIGNATURE])){PJF.event.removeSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c);var n=new PJF.ui.errorMessageBox({content:"您已经"+e+"秒没有进行设备操作，系统将会在10秒后返回首页，请点击确认键以取消此操作",buttonConfs:[{name:"确定",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){clearTimeout(i),PJF.event.addSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c)}}]}),i=setTimeout(function(){template.loadPage("homepage"),n.destroy(),PJF.event.addSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c)},1e4)}if(PJF.util.deviceType.stm&&PJF.constants.STM_TIMEOUT&&-1==PJF.constants.NO_MONITOR_PAGE.indexOf(template.getLocation())&&-1==PJF.constants.NO_OVERTIME_CONFISCATE.indexOf(PJF.otherInfo.MENU_ID)){if(console.log("********超时有卡hasCard:"+PJF.fsm.get([PJF.fsm.fmIds.STM_ICCARD]).is("hasCard")+"*********"),
PJF.fsm.get([PJF.fsm.fmIds.STM_ICCARD]).is("hasCard")){if(clearInterval(u),$(".pjf_hp_timeoutDiv").remove(),PJF.event.addSubscriber("OVER_30_NO_REACTION",l),0<$(".errorMsgbox_container").length)return;PJF.event.removeSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c),PJF.communication.player.PlaySoundByUrl("app/common/confiscateTip.mp3",!0);var o=PJF.util.generateUUid(),a="../../../css/stmimg/stm_timeout_tip.gif";"DA003"===PJF.orgInfo.instSvrlLgPsnID&&(a="../../../css/stmimg/stm_timeout_tip_"+PJF.i18n.getLanguage()+".gif"),$("body").append('<div id="'+o+'"><div class="pjf_timeout_loading"></div><img class="pjf_timeout_img" src='+a+"></div>");var s=new PJF.ui.loading({opacity:.7,msg:"",noIcon:!0});$("#"+o).off("click.random").on("click.random",function(t){s&&s.destroy(),$("#"+o).children("img").attr("src",""),$("#"+o).remove(),clearTimeout(r),PJF.event.addSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c)});var r=setTimeout(function(){if(!homepage.confiscateCard)if(homepage.confiscateCard=!0,
"DA003"===PJF.orgInfo.instSvrlLgPsnID)PJF.stm.ICMaker.confiscateDev(function(t){console.log("建亚STM进行未操作超时吞卡操作"),template.loadPage("homepage")},{conReason:e+"秒没有进行设备操作",recycleType:"8"});else{var t=PJF.util.generateUUid();$("body").append("<div id="+t+"></div>"),PJF.stm.register.registerTimeoutFn.window=new PJF.ui.window({dom:t,width:1200,height:830,href:"/bosWeb/page/stm/common/timeoutPage.html"})}s&&s.destroy(),$("#"+o).children("img").attr("src",""),$("#"+o).remove(),PJF.event.addSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c)},1e4)}if("DA003"===PJF.orgInfo.instSvrlLgPsnID&&PJF.util.isExist("PJF.stm.CUSTOM_INFO")&&"3"==PJF.stm.CUSTOM_INFO.authType){o=PJF.util.generateUUid();$("body").append('<div id="'+o+'" class="pjf_hw_noCardTmoutDiv"><p class="pjf_hw_noCardTmoutBg">'+PJF.i18n.getI18nResource("pjfI18n.obTimoutTip")+"</p></div>");s=new PJF.ui.loading({opacity:.5,msg:"",noIcon:!0,timeout:10});$("#"+o).off("click.random").on("click.random",function(t){s&&s.destroy(),$("#"+o).remove(),
clearTimeout(r),PJF.event.addSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c)});r=setTimeout(function(){s&&s.destroy(),$("#"+o).remove(),PJF.event.addSubscriber(PJF.stmEvent.OVER_60_NO_REACTION,c),template.loadPage("homepage")},1e4)}}PJF.otherInfo.smartBank&&PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).is("noCard")&&PJF.fsm.get(PJF.fsm.fmIds.STM_IDCARD).is("noId")&&PJF.stm.util.devIdleLog(!0)}});var a=[],o=!1;PJF.event.addSubscriber("OVER_30_NO_REACTION",l=function(t){if("CN000"===PJF.orgInfo.instSvrlLgPsnID&&!(0<$(".pjf_hp_timeoutDiv").length)){var e="homepage"==template.getLocation();if(PJF.util.deviceType.stm&&e&&!PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).is("hasCard")){PJF.event.removeSubscriber("OVER_30_NO_REACTION",l);var n=function(){if(0<a.length){var e=PJF.util.generateUUid();$("body").append('<div class="pjf_hp_timeoutDiv" id="'+e+'"><img id="viewer"><span>关闭广告</span></div>');var t=document.getElementById("viewer"),n=0,i=a.length,o=function(){t.src=a[n],n=++n>i-1?0:n};o(),
u=setInterval(o,5e3),$("#"+e).off("click.random").on("click.random",function(t){clearInterval(u),$("#"+e).remove(),PJF.event.addSubscriber("OVER_30_NO_REACTION",l)}),$("#"+e+"> img").off("click.viewer").on("click.viewer",function(t){t.stopPropagation()})}};if(o)return void n();var i={CCB_InsID:PJF.roleInfo.orgCode,Query_Dt:PJF.communication.getServerTime(),Query_TyCd:"1",Adv_Grp:[{Blng_Step:"00"}],OPER_CODE:PJF.otherInfo.devId};console.log("queryAdvFilePathZhyh req:"+JSON.stringify(i)),PJF.communication.cpsJsonReq({jsonData:JSON.stringify(i),url:"ecpJson.action",fwServiceId:"queryAdvFilePathZhyh",fwTranId:"queryAdvFilePathZhyh",success:function(t){console.log("queryAdvFilePathZhyh success:"+JSON.stringify(t)),o=!0,t.Adv_Grp&&t.Adv_Grp.forEach(function(t){"2"!=t.Path_Type&&a.push(t.Res_Path)}),n()},failure:function(t){console.log("queryAdvFilePathZhyh failure:"+JSON.stringify(t)),o=!0}})}}}),PJF.event.addSubscriber("RESTART_30_MONITOR",function(){var t="homepage"==template.getLocation()
;PJF.util.deviceType.stm&&t&&!PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).is("hasCard")&&(PJF.event.removeSubscriber("OVER_30_NO_REACTION",l),PJF.event.addSubscriber("OVER_30_NO_REACTION",l))})},registerStm:function(){var cpuId=PJF.communication.GetCpuNo().result,ipMacs=PJF.communication.GetMachine().result,verInfo=PJF.communication.GetClientInfo().result,insId="",devId="";if(PJF.constants.NEED_LOGIN){var insIdRes=PJF.communication.localStorage.getValue("pjfLoginOrgCode");insIdRes.success?(insId=insIdRes.result,console.log("本地insId为"+insId)):console.log("本地不存在机构编号")}var devIdRes=PJF.communication.localStorage.getValue("pjfLoginDevId");devIdRes.success?(devId=devIdRes.result,console.log("本地devId为"+devId)):console.log("本地不存在设备编号");var ips=[],macs=[];if(ipMacs){ipMacs=eval(ipMacs);for(var a=0;a<ipMacs.length;a++){var result=ipMacs[a];-1==PJF.constants.NOT_REG_IP.indexOf(result.IP)&&(ips.push(result.IP),macs.push(result.MAC))}}PJF.otherInfo.IPS=ips,PJF.otherInfo.MACS=macs,
PJF.otherInfo.verInfo=verInfo;var routeAddress=PJF.communication.localStorage.getValue("stmRouteUrl");if(console.log("获取路由地址结果为:"+routeAddress.result),PJF.constants.GROUP&&"true"==PJF.html.getUrlParam("isRoute")){console.log("已跳转到对应地址");var registerInfo=PJF.communication.localStorage.getValue("clientRegInfo");if(console.log("获取本地注册信息结果为:"+registerInfo.result),registerInfo.success){PJF.communication.localStorage.removeItem("stmRouteUrl");var tempObj=PJF.communication.localStorage.getValue("pjfRouteConstants");if(!tempObj.success)return console.log("设备无法从本地获取集群信息"),void PJF.stm.register.errorCodeHandler("设备无法从本地获取集群信息","请联系管理员","确定",PJF.communication.AppExit);var tempObjResult=JSON.parse(tempObj.result);PJF.constants.AUTH_SERVER=tempObjResult.auth,PJF.constants.MGT_SERVER=tempObjResult.mgt,PJF.constants.PUB_SERVER=tempObjResult.pub,PJF.constants.FHTS_GROUP=tempObjResult.fhts,PJF.constants.IM_URL=tempObjResult.im_url,PJF.constants.IM_HTTP_URL=tempObjResult.im_http_url
;var info=JSON.parse(registerInfo.result);return void PJF.stm.register.registerSuccess(info)}return console.log("设备无法从本地获取注册信息"),void PJF.stm.register.errorCodeHandler("设备无法从本地获取注册信息","请联系管理员","确定",PJF.communication.AppExit)}var action="ecpJson.action",fw_id="registerTermService",jsonData={};jsonData={msg_type:"register",msg_ver:"v1.0",execute_time:PJF.util.formatDate(new Date,"yyyyMMddhhmm"),msg_info:{cpu_id:cpuId,ips:ips,macs:macs,ins_id:insId,dev_id:devId,client_version:PJF.otherInfo.verInfo}};var data={};data._fw_service_id=fw_id,data.jsonData=PJF.util.json2str(jsonData),console.log("即将查询设备注册信息，data:"+JSON.stringify(jsonData)),PJF.communication.ajax({data:data,async:!1,url:action,success:function(e){if(console.log("查询设备注册信息返回结果为:"+JSON.stringify(e)),e.dev_id){if(PJF.communication.localStorage.setValue("clientRegInfo",JSON.stringify(e)),0==e.insid.indexOf("01075")){var t={centerID:"1",domain:i=PJF.constants.ZD_DOMAIN,port:"80",cnt:i}
;PJF.communication.localStorage.setValue("_sys_domain_setting_",JSON.stringify({_s_warp_:t}));var n="http://"+i+"/bosWeb/page/stm/common/stmTemplatePage.html?isRoute=true";return PJF.communication.localStorage.setValue("stmRouteUrl",n),PJF.communication.localStorage.setValue("pjfRouteConstants",JSON.stringify({auth:"http://"+i,mgt:"http://"+i,pub:"http://"+i,fhts:"http://"+i+"/bosWeb/ecpJson.action",im_url:PJF.constants.ON_PROD?"ws://"+PJF.multiCenter.getDomainByCenter("im")+":7070/ws/server":PJF.constants.IM_URL,im_http_url:PJF.constants.ON_PROD?"http://"+PJF.multiCenter.getDomainByCenter("im")+":9090":PJF.constants.IM_HTTP_URL})),console.log("中德地址全路径为为:"+n),void(location.href=n)}if("010741100"===e.province_code){var i;t={centerID:"1",domain:i=PJF.constants.ON_PROD?"oy.oecip.jh":location.host,port:"80",cnt:i};return PJF.communication.localStorage.setValue("_sys_domain_setting_",JSON.stringify({_s_warp_:t})),void PJF.stm.register.registerSuccess(e)}
console.log("====当前客户端地址===="+location.href),PJF.multiCenter._queryCenter(e.insid,function(t){!function(t){PJF.constants.ON_DEV&&(t=location.host);var e="http://"+t+"/bosWeb/page/stm/common/stmTemplatePage.html?isRoute=true",n=window.location.href.search("#!");0<n&&(e+=window.location.href.slice(n)),PJF.communication.localStorage.setValue("stmRouteUrl",e),PJF.communication.localStorage.setValue("pjfRouteConstants",JSON.stringify({auth:"http://"+(PJF.constants.ON_DEV?t:PJF.multiCenter.getDomainByCenter("stm")),mgt:"http://"+(PJF.constants.ON_DEV?t:PJF.multiCenter.getDomainByCenter("mgt")),pub:"http://"+(PJF.constants.ON_DEV?t:PJF.multiCenter.getDomainByCenter("pub")),fhts:"http://"+(PJF.constants.ON_DEV?t:PJF.multiCenter.getDomainByCenter("lt"))+"/bosWeb/ecpJson.action",im_url:PJF.constants.ON_DEV?PJF.constants.IM_URL:"ws://"+PJF.multiCenter.getDomainByCenter("im")+":7070/ws/server",
im_http_url:PJF.constants.ON_DEV?PJF.constants.IM_HTTP_URL:"http://"+PJF.multiCenter.getDomainByCenter("im")+":9090"})),console.log("获取路由信息成功，将跳转到:"+t),console.log("将要跳转的地址全路径为为:"+e),location.href=e}(PJF.multiCenter.getDomainByCenter("cnt"))},function(t){console.log("获取路由信息失败:"+JSON.stringify(t)),PJF.stm.register.registerSuccess(e)},!1)}else{var o=e.error_code,a=e.errorMessage,s=e.helpMessage;switch(console.log("错误码为: "+o),o){case"1111":case"2222":case"3333":PJF.stm.register.errorCodeHandler(a,s,"确定",PJF.communication.AppExit);break;case"4444":case"0000":PJF.communication.localStorage.removeItem("pjfLoginDevId"),PJF.stm.register.errorCodeHandler(a,s,"确定",PJF.communication.AppExit);break;case"9999":case"6666":case"5555":case"8888":PJF.stm.register.errorCodeHandler(a,s,"确定",PJF.communication.AppExit);break;default:new PJF.ui.messageBox({title:"提示信息",content:"本设备没有注册，请联系系统管理员注册本设备",buttonConfs:[{name:"确定",style:"main",width:200,height:80,onClick:PJF.communication.AppExit}]})}}}})},
genTemplate:function(t,e){var n=new PJF.ui.loading({text:"页面正在加载中，请稍候……"});var i=setInterval(function(){0==PJF.constants.jsLoadingCount&&(n.destroy(),window.template instanceof PJF.ui.component?(PJF.stm.util.clearCardInfo(),template.clearTopBar()):PJF.sm4Auth.register(function(){window.template=new PJF.ui.template($.extend({dom:"template",pageRouting:stmRouting,process:process,tips:stmTips,postfixHandler:[function(){if(PJF.util.isCCBSTransform())return"_ccbstransform"},function(){return PJF.otherInfo.isSelfBank?"_self":"01"===PJF.otherInfo.globalParams.useNewViewStatus?"_ext":void 0}]},t))}),clearInterval(i),e&&e())},500)},getPadUserMobileNo:function(){if(PJF.util.isExist("PJF._extra.custAuthInfo.identity")){var t={Cst_Id_MtdCd:"1"};t.MULTI_TENANCY_ID=PJF.orgInfo.instSvrlLgPsnID,t.Id_Crdt_TpCd="1010",t.Id_Crdt_No=PJF._extra.custAuthInfo.identity,t.Id_Idv_Lgl_Nm=PJF._extra.custAuthInfo.name;var n="";PJF.communication.cpsJsonReq({fwServiceId:"simpleTransaction",maskAll:!0,
jsonData:JSON.stringify(t),fwTranId:"A0042Q028-stm",success:function(t){if(t.TEL_INFO&&0<t.TEL_INFO.Vld_Rcrd_Cnt){for(var e in t.TEL_INFO.TEL_GROUP)"104"==t.TEL_INFO.TEL_GROUP[e].Ctc_Inf_TpCd&&(n=t.TEL_INFO.TEL_GROUP[e].TelCtcMod_No);PJF.otherInfo.padUserMobileNo=n}},failure:function(t){console.log("查询客户手机失败:"+JSON.stringify(t))}})}else PJF.otherInfo.padUserMobileNo=""}},PJF.stm.CHK={printCheck:function(t,o){var e=!0;if(-1!=PJF.constants.NOT_SUPPORT_CHECK.indexOf(PJF.otherInfo.devId)&&(e=!1),e){var i,a,s,r={},n=PJF.util.safeParse(PJF.communication.localStorage.getValue("checkPrintOffset").result,{}),c={iSlotNum:1,iAdjX:n.X||0,iAdjY:n.Y||0};$.extend(c,t),PJF.event.onceSubscriber(PJF.stm.client.events.CHK_PRINT_SUCCESS,a=function(t){i&&i.destroy();var e=t.split("|")[1],n=t.split("|")[0];l(n,null,null,e)}),PJF.event.onceSubscriber(PJF.stm.client.events.CHK_PRINT_FAIL,s=function(t){i&&i.destroy();var e=t.split("|")[0],n=t.split("|")[1];l(t.split("|")[2],e,n)});var l=function(t,e,n,i){
PJF.event.removeSubscriber(PJF.stm.client.events.CHK_PRINT_SUCCESS,a),PJF.event.removeSubscriber(PJF.stm.client.events.CHK_PRINT_FAIL,s),$.extend(r.info,{iPrintedCount:t,printBatchNo:i}),console.log("支票callback:"+JSON.stringify(r)),e&&(r.status=0,r.errorCode=e,r.errorMsg=n),o&&o(r)};PJF.stm.client.callClient("CHK","printCheck",c,function(t){1==(r=t).status?i=new PJF.ui.loading({msg:"票据正在打印中,请稍候...",opacity:.1,noIcon:!0}):(PJF.event.removeSubscriber(PJF.stm.client.events.HDP_PRINT_SUCCESS,a),PJF.event.removeSubscriber(PJF.stm.client.events.HDP_PRINT_FAIL,s),o&&o(t))})}else{c={iSlotNum:1};function u(t){var e={};return e.iPrintedCount=t.iPrintedCount,e.printBatchNo=t.printBatchNo,e}$.extend(c,t),PJF.stm.client.callClient("CHK","printCheck",c,o,u,u)}},getCheckNo:function(t,e){var n={iTimeout:20};$.extend(n,t),PJF.stm.client.callClient("CHK","getCheckNo",n,e,function(t){var e={};return e.pchCheckNo=t.pchCheckNo,e})},takeCheck:function(t,e){var n={};$.extend(n,t),
PJF.stm.client.callClient("CHK","takeCheck",n,e)},setMagCodeOffset:function(t,e){var n={};$.extend(n,t),PJF.stm.client.callClient("CHK","setMagCodeOffset",n,e)},getMagCodeOffset:function(t,e){var n={};$.extend(n,t),PJF.stm.client.callClient("CHK","getMagCodeOffset",n,e,function(t){var e={};return e.iXOffset=t.iXOffset,e.iYOffset=t.iYOffset,e})}},PJF.stm.CKS={scanVerifyCheck:function(t,e){var n={iScanTimes:2,iCheckType:0,iTimeout:60};$.extend(n,t),PJF.stm.client.callClient("CKS","scanVerifyCheck",n,e,function(t){var e={};return e.iVerifyResult=t.iVerifyResult,e})},checkControl:function(t,e){var n={iCmd:1};$.extend(n,t),PJF.stm.client.callClient("CKS","checkControl",n,e)}},PJF.stm.HDP={preparePrinter:function(t,e){var n={};$.extend(n,t),PJF.stm.client.callClient("HDP","preparePrinter",n,e)},startPrintReceipt:function(t,i){var e=!0;if(-1!=PJF.constants.NOT_SUPPORT_RECEIPT.indexOf(PJF.otherInfo.devId)&&(e=!1),e){var o,a,s,r={},n={iSlotType:1,iChapterType:0,loadingConf:{msg:"文件正在打印中,请稍候..."
}};$.extend(n,t),PJF.event.onceSubscriber(PJF.stm.client.events.HDP_PRINT_SUCCESS,a=function(t){o&&o.destroy(),c(t)}),PJF.event.onceSubscriber(PJF.stm.client.events.HDP_PRINT_FAIL,s=function(t){o&&o.destroy();var e=t.split("|")[0],n=t.split("|")[1];c(t.split("|")[2],e,n)});var c=function(t,e,n){PJF.event.removeSubscriber(PJF.stm.client.events.HDP_PRINT_SUCCESS,a),PJF.event.removeSubscriber(PJF.stm.client.events.HDP_PRINT_FAIL,s),$.extend(r.info,{printProgressData:t}),console.log("回单callback:"+JSON.stringify(r)),e&&(r.status=0,r.errorCode=e,r.errorMsg=n,"1"==e?PJF.communication.callPad({busiName:PJF.otherInfo.devId+"设备办理"+(PJF.otherInfo.MENU_ID&&PJF.stm.menuTree&&PJF.stm.menuTree[PJF.otherInfo.MENU_ID]&&PJF.stm.menuTree[PJF.otherInfo.MENU_ID].NAME)+"业务打印机卡纸"}):"3"==e&&PJF.communication.callPad({busiName:PJF.otherInfo.devId+"设备办理"+(PJF.otherInfo.MENU_ID&&PJF.stm.menuTree&&PJF.stm.menuTree[PJF.otherInfo.MENU_ID]&&PJF.stm.menuTree[PJF.otherInfo.MENU_ID].NAME)+"业务打印机缺纸"})),i&&i(r)}
;PJF.stm.client.callClient("HDP","startPrintReceipt",n,function(t){1==(r=t).status?o=new PJF.ui.loading({msg:"文件正在打印中,请稍候...",opacity:.1,noIcon:!0}):(PJF.event.removeSubscriber(PJF.stm.client.events.HDP_PRINT_SUCCESS,a),PJF.event.removeSubscriber(PJF.stm.client.events.HDP_PRINT_FAIL,s),i&&i(t))})}else{var l=0;n={iSlotType:1,iChapterType:0,loadingConf:{msg:"文件正在打印中,请稍候..."}};$.extend(n,t),PJF.event.addSubscriber(PJF.stm.client.events.HDP_PRINT_PROGRESS,function(t){l=t}),PJF.stm.client.callClient("HDP","startPrintReceipt",n,i,function(t){var e={};return PJF.event.removeSubscriber(PJF.stm.client.events.HDP_PRINT_PROGRESS),e.printProgressData=l,e},function(t){var e={};return PJF.event.removeSubscriber(PJF.stm.client.events.HDP_PRINT_PROGRESS),e.printProgressData=l,e})}},printPDFFile:function(t,e){var n={};$.extend(n,t),PJF.stm.client.callClient("HDP","printPDFFile",n,e)},printUniVoucher:function(t,r){var c={iSlotType:1};if($.extend(c,t),c.pchPrintStr=encodeURIComponent(t.pchPrintStr),
c.response){var l={},u=Object.keys(c.response),d=u.length,h=function(n,t){var e,i,o;if(n==d)return(o=(o=t)||{status:1}).info=o.info||{},o.info.eachResult=l,void(r&&r(o));var a=c.response[u[n]].paperPrintFlag;if(console.log(u[n]+" paperPrintFlag: "+a),a)if(e=c.response[u[n]].printContent,i=c.response[u[n]].elecSealInfo,c.pchPrintStr=encodeURIComponent(e),i){i=JSON.parse(i),c.iChapterType="0";var s=i.sealId;PJF.stm.util.elecSealHandler(i,function(t){if(t.status){if(!t.localExist){var e={};e[s]={sealLocalPath:t.localUrl,sealRemotePath:i.sealRemotePath,sealFileMd5:i.sealFileMd5},PJF.communication.localStorage.setValue("pjfElecSealInfo",JSON.stringify(e))}i.sealLocalPath=t.localUrl,c.pchElecSealInfo=encodeURIComponent(JSON.stringify(i)),PJF.stm.client.callClient("HDP","printUniVoucher",c,function(t){console.log("printUniVoucher结果为:"+JSON.stringify(t)),l[s]=t,h(++n,t)})}else PJF.stm.client.callClient("HDP","printUniVoucher",c,function(t){
console.log("download failure printUniVoucher结果为:"+JSON.stringify(t)),l[s]={status:0,info:{},errorCode:"PJF_HDP_DOWNLOAD_ERR01",errorMsg:"下载电子印章失败"},h(++n,t)})})}else PJF.stm.client.callClient("HDP","printUniVoucher",c,function(t){console.log("noelec seal printUniVoucher结果为:"+JSON.stringify(t)),l["noElecSeal_"+n]=t,h(++n,t)});else PJF.stm.client.callClient("HDP","printUniVoucher",c,function(t){console.log("false paperPrintFlag printUniVoucher结果为:"+JSON.stringify(t)),l["printFlagFalse_"+n]=t,h(++n,t)})};h(0)}else PJF.stm.client.callClient("HDP","printUniVoucher",c,r)},GenUniVoucherPreview:function(t,e){var n={};$.extend(n,t),PJF.stm.client.callClient("App_DEV","GenUniVoucherPreview",n,e)},getPaperSlotStatus:function(t,e){var n={};$.extend(n,t),PJF.stm.client.callClient("HDP","getPaperSlotStatus",n,e,function(t){var e={};return e.iStatus=t.iStatus,e})}},PJF.stm.PRT={inhalePassbook:function(t,e){$.extend({timeout:30},t),PJF.fsm.get(PJF.fsm.fmIds.STM_PRT).inhalePassbook(),
PJF.stm.client.callClient("PRT","inhalePassbook",t,e)},ejectPassbook:function(t,e){$.extend({timeout:30},t),PJF.fsm.get(PJF.fsm.fmIds.STM_PRT).ejectPassbook(),PJF.stm.client.callClient("PRT","ejectPassbook",t,e)},getCardNum:function(t,e){$.extend({timeout:30},t),PJF.stm.client.callClient("PRT","getCardNum",t,e,"DA003"===PJF.orgInfo.instSvrlLgPsnID?function(t){var e={};e.pchTrackData2=t.pchTrackData2,e.pchTrackData3=t.pchTrackData3,-1==PJF.util.array.indexOf(["'","=",">"],e.pchTrackData2[12])&&(console.log("建亚未能正确匹配磁道分隔符"),e.pjfstatus="0",e.pchErrCode="PJF_PRT_PARSE_ERR01",e.pchError="存折打印机未能正确匹配磁道分隔符"),e.accountNo=e.pchTrackData2.substr(0,12),e.printNo=e.pchTrackData2.substr(13,4),e.dvvNo=e.pchTrackData2.substr(17,3),e.bkNumber="0"+e.pchTrackData2.substr(20,2);var n=e.pchTrackData2.substr(22,2),i=parseInt(n.charAt(0),10),o=parseInt(n.charAt(1),10);return e.withdrawMode=[Math.floor(i/2),i%2,Math.floor(o/2),o%2].join(""),e}:function(t){var e={};e.pchTrackData2=t.pchTrackData2,
e.pchTrackData3=t.pchTrackData3,-1==PJF.util.array.indexOf(["'","=",">"],e.pchTrackData2[19])&&(console.log("未能正确匹配磁道分隔符"),e.pjfstatus="0",e.pchErrCode="PJF_PRT_PARSE_ERR01",e.pchError="存折打印机未能正确匹配磁道分隔符"),e.accountNo=e.pchTrackData2.substr(0,19),e.printNo=e.pchTrackData2.substr(20,4),e.dvvNo=e.pchTrackData2.substr(24,3),e.bkNumber="0"+e.pchTrackData2.substr(27,2);var n=e.pchTrackData2.substr(29,2),i=parseInt(n.charAt(0),10),o=parseInt(n.charAt(1),10);return e.withdrawMode=[Math.floor(i/2),i%2,Math.floor(o/2),o%2].join(""),e})},doVoucherPrint:function(t,e){$.extend({timeout:30},t),PJF.stm.client.callClient("PRT","doVoucherPrint",t,e)},doPrintUniVoucher:function(t,e){var n={iSlotType:1};$.extend(n,t),n.pchPrintStr=encodeURIComponent(t.pchPrintStr),n.pchElecSealInfo=encodeURIComponent(t.pchElecSealInfo),PJF.stm.client.callClient("PRT","doPrintUniVoucher",n,e)},stopInhalePassbook:function(t,e){$.extend({},t),PJF.stm.client.callClient("PRT","stopInhalePassbook",t,e)}},PJF.stm.TDC={
getTDCode:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("TDC","getTDCode",n,e,function(t){var e={};return e.pchData=t.pchData,e})}},PJF.stm.App_DEV={BarcodePathDecode:function(t,e){var n={};$.extend(n,t),PJF.stm.client.callClient("App_DEV","BarcodePathDecode",n,e,function(t){var e={};return e.szbadcodebuff=t.szbadcodebuff,e.szbadcodelen=t.szbadcodelen,e})},BarcodeMem2FileEncode:function(t,e){var n={};$.extend(n,t),PJF.stm.client.callClient("App_DEV","BarcodeMem2FileEncode",n,e)}},PJF.stm.EMD={getCardNum:function(t,e){var n=$.extend({iTimeout:30},t);PJF.stm.client.callClient("EMD","getCardNum",n,e,function(t){var e={};return e.pchCardNum=t.pchCardNum,e})}},PJF.stm.SCA={scanOnePaper:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("SCA","scanOnePaper",n,e,function(t){var e={};return e.pchImageFileName=t.pchImageFileName,e.pchCodeValue=t.pchCodeValue,e})},scanNextStep:function(t,e){var n=$.extend({timeout:30},t)
;PJF.stm.client.callClient("SCA","scanNextStep",n,e)},terminateScan:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("SCA","terminateScan",n,e)}},PJF.stm.ZFM={readCISN:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","readCISN",n,e,function(t){var e={};return e.pchCIID=t.pchCIID,e})},generateKeyPair:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","generateKeyPair",n,e,function(t){var e={};return e.pchChipID=t.pchChipID,e.pchVK=t.pchVK,e})},downLoadAK:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","downLoadAK",n,e)},delAcc:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","delAcc",n,e)},addMachineSign:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","addMachineSign",n,e,function(t){var e={};return e.pchNewSign=t.pchNewSign,e})},unlockCI:function(t,e){var n=$.extend({timeout:20,cStep:1
},t);PJF.stm.client.callClient("ZFM","unlockCI",n,e)},issueCI:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","issueCI",n,e)},getCheckCode:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","getCheckCode",n,e,function(t){var e={};return e.pchCheckCode=t.pchCheckCode,e})}},PJF.stm.TCR={initCashIn:function(t,e){PJF.communication.fileSystem.fileOperation("FO_MKDIR",[{source:"crownFsn/"+e.fsnDir,dest:""}],function(t){});var n={pchFSNFilesDir:PJF.stm.baseDir+"/crownFsn/"+e.fsnDir,pchFSNNumberTxtPath:PJF.stm.baseDir+"/Temp/"+e.txtFile,pchInstNo:PJF.roleInfo.orgCode};PJF.stm.client.callClient("TCR","initCashIn",n,t)},insertCash:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("TCR","insertCash",n,e)},ejectStackerCash:function(t,e){var n,i,o,a,s,r=$.extend({timeout:20},t),c={};PJF.event.addSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,a=function(){n&&n.destroy(),PJF.stm.log("取退钞-出钞，打开闸口","PJF_LOG_HARDWARE"),
s=new PJF.ui.loading({msg:"请取走钞票",opacity:0,timeout:r.iCashTakenTimeout||120,noIcon:!1})}),PJF.event.onceSubscriber(PJF.stm.client.events.TCR_CASH_EJECT_COMPLETE,i=function(){PJF.stm.log("取退钞-取缓存区钞票成功","PJF_LOG_HARDWARE"),console.log("退出暂存区过程中成功"),n&&n.destroy(),s&&s.destroy(),l()}),PJF.event.onceSubscriber(PJF.stm.client.events.TCR_CASH_EJECT_FAIL,o=function(){PJF.stm.log("取退钞-取缓存区钞票失败","PJF_LOG_HARDWARE"),console.log("退出暂存区过程中失败"),n&&n.destroy(),s&&s.destroy(),l(!0)});var l=function(t){PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_EJECT_COMPLETE,i),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_EJECT_FAIL,o),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,a),t&&(c.status=0,c.errorCode="PJF_TCR_EJECT_ERR00",c.errorMsg="退出缓存区钞票失败"),e&&e(c)};PJF.stm.client.callClient("TCR","ejectStackerCash",r,function(t){c=t,PJF.stm.log("取退钞-取缓存区钞票开始","PJF_LOG_HARDWARE"),1==t.status?n=new PJF.ui.loading({msg:"",opacity:.5
}):(PJF.stm.log("取退钞-取缓存区钞票失败","PJF_LOG_HARDWARE"),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_EJECT_COMPLETE,i),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_EJECT_FAIL,o),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,a),e&&e(t))})},finishCashIn:function(t,e){var n=$.extend({},e);PJF.stm.client.callClient("TCR","finishCashIn",n,t)},mixAmount:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("TCR","mixAmount",n,e,function(t){var e={};""==t.pchMixResult&&(console.log("预配钞函数调用失败，返回为空字符串"),e.pjfstatus="0",e.pchErrCode="PJF_TCR_MIX_ERR00",e.pchError="预配钞函数调用失败，返回为空字符串");var n=t.pchMixResult.split("|");return e.hundredYuan=n[0],e.fiftyYuan=n[1],e.twentyYuan=n[2],e.tenYuan=n[3],e.fiveYuan=n[4],e.oneYuan=n[5],e.totalNum=parseInt(n[0])+parseInt(n[1])+parseInt(n[2])+parseInt(n[3])+parseInt(n[4])+parseInt(n[5]),e})},dispenseAndPresent:function(t,i){PJF.communication.fileSystem.fileOperation("FO_MKDIR",[{source:"crownFsn/"+t.fsnDir,dest:""
}],function(t){});var o,a,s,r,c,l,u=$.extend({pchFSNFilesDir:PJF.stm.baseDir+"/crownFsn/"+t.fsnDir,pchFSNNumberTxtPath:PJF.stm.baseDir+"/Temp/"+t.txtFile,pchInstNo:PJF.roleInfo.orgCode,timeout:120},t),d={},h=100*parseInt(t.pchMixFmt.split("|")[0])+50*parseInt(t.pchMixFmt.split("|")[1])+20*parseInt(t.pchMixFmt.split("|")[2])+10*parseInt(t.pchMixFmt.split("|")[3])+5*parseInt(t.pchMixFmt.split("|")[4])+parseInt(t.pchMixFmt.split("|")[5]);function m(t){var e=PJF.stm.IC_CARD_INFO&&PJF.stm.IC_CARD_INFO.resInfo.accountNo,n=PJF.stm.IC_CARD_INFO&&PJF.stm.IC_CARD_INFO.isPassbook&&PJF.stm.IC_CARD_INFO.resInfo.accountNo||PJF.stm.PASSBOOK_INFO&&PJF.stm.PASSBOOK_INFO.resInfo.accountNo,i={TCR_INOUT_FLAG:t,TCR_RET_STATUS:d.errorCode,TCR_RET_DES:d.errorMsg,TCR_AMT:h+"",TCR_DNMN_INFO:u.pchMixFmt,TCR_ACCOUNT_NO:e||n,TCR_ACCOUNT_TYPE:e?"1":"2"};PJF.stm.TCR.tcrLogHandler(i)}PJF.event.addSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,c=function(){o&&o.destroy(),a=new PJF.ui.loading({msg:"请取走钞票",
opacity:.5,timeout:u.timeout})}),PJF.event.addSubscriber(PJF.stm.client.events.TCR_CASH_BOX_CASH_TAKEN,l=function(){o&&o.destroy(),a&&a.destroy(),p("3")}),PJF.event.addSubscriber(PJF.stm.client.events.TCR_CASH_DISPENSE_COMPLETE,s=function(){console.log("取款过程中成功"),m("2")}),PJF.event.addSubscriber(PJF.stm.client.events.TCR_CASH_OUT_FAIL,r=function(t){o&&o.destroy(),a&&a.destroy();var e=t.split("|")[0],n=t.split("|")[1];p("2",e,n)});var p=function(t,e,n){PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_DISPENSE_COMPLETE,s),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_OUT_FAIL,r),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,c),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_BOX_CASH_TAKEN,l),console.log("dispense cash callback:"+JSON.stringify(d)),e&&(d.status=0,d.errorCode=e,d.errorMsg=n),m(t),i&&i(d)};PJF.stm.client.callClient("TCR","dispenseAndPresent",u,function(t){1==(d=t).status?o=new PJF.ui.loading({msg:"正在出钞",opacity:.5,
timeout:u.timeout}):(PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_DISPENSE_COMPLETE,s),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_OUT_FAIL,r),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,c),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_BOX_CASH_TAKEN,l),m("2"),i&&i(t))})},openShutter:function(t,e){var n=$.extend({},e);PJF.stm.client.callClient("TCR","openShutter",n,t)},closeShutter:function(t,e){var n=$.extend({},e);PJF.stm.client.callClient("TCR","closeShutter",n,t)},getCashBoxInfo:function(t,e){var n=$.extend({},e);PJF.stm.client.callClient("TCR","getCashBoxInfo",n,t,function(t){var e={},n=t.boxInfo||"",i=[],o={},a=(n.split("#"),n.split("#"));for(var s in a){var r=a[s].split("|");if("R"==r[1]){var c={};c.sequence=r[0],c.amount=r[2],c.count=r[3],c.total=parseInt(r[2])*parseInt(r[3]),c.maxCount=r[4],c.state=r[5],i.push(c)}else if("C"==r[1]){o.sequence=r[0],o.amount=r[2];var l=r[3].split("$");o.recycleCount={hundredYuan:l[0],
fiftyYuan:l[1],twentyYuan:l[2],tenYuan:l[3],fiveYuan:l[4],oneYuan:l[5],totalNum:parseInt(l[0])+parseInt(l[1])+parseInt(l[2])+parseInt(l[3])+parseInt(l[4])+parseInt(l[5])},o.totalSum=100*parseInt(l[0])+50*parseInt(l[1])+20*parseInt(l[2])+10*parseInt(l[3])+5*parseInt(l[4])+parseInt(l[5]),o.maxCount=r[4],o.state=r[5]}}return e.cycleInfo=i,e.recycleInfo=o,e.boxInfo=n,e},function(t){var e={};return e.boxInfo=t.boxInfo,e})},setCashBoxInfo:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("TCR","setCashBoxInfo",n,e)},tcrLogHandler:function(t){var e={BRANCH_ID:PJF.roleInfo.orgCode,STM_DEV_ID:PJF.otherInfo.devId,STM_SVC_ID:PJF.otherInfo.SVC_ID,TCR_SUB_SEQID:PJF.util.formatDate(new Date,"yyyyMMddhhmmss")+Math.random().toString().substr(2,6),STM_MNU_ID:PJF.otherInfo.MENU_ID,TXN_ITT_CHNL_ID:PJF.otherInfo.cashChaId};$.extend(e,t);var n=new PJF.ui.loading({msg:"",noIcon:!0}),i=PJF.constants.MGT_SERVER+"/bosWeb/ecpJson.action",o="jsonData="+JSON.stringify(e)+"&_fw_service_id=tcrLogRecord"
;console.log("记录TCR日志请求参数为:"+o),PJF.communication.Http.SendCrossDomainRequest(i,o,3e4,function(t,e){console.log("跨域返回结果,status:"+t+";responseData:"+e),n.destroy(),(t=JSON.parse(t)).success&&e?(e=JSON.parse(e))&&e.BK_STATUS&&e.BK_STATUS==PJF.constants.BK_CODE_SUCCESS?console.log("记录TCR日志成功"):console.log("记录TCR日志失败"):console.log("记录TCR日志通信失败")})},getTCRDeviceStatus:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("TCR","getTCRDeviceStatus",n,e,function(t){var e={};return e.pchStatus=JSON.parse(t.pchStatus),e})},setSNBlackList:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("TCR","setSNBlackList",n,e)},setReservedCashNum:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("TCR","setReservedCashNum",n,e)},resetTCRDev:function(t,n){var i,o,a,s,r={},e={};$.extend(e,t),PJF.event.onceSubscriber(PJF.stm.client.events.TCR_RESET_SUCCESS,o=function(){i&&i.destroy(),c(null,null)}),PJF.event.onceSubscriber(PJF.stm.client.events.TCR_RESET_FAIL,a=function(t){
i&&i.destroy();var e=t.split("|")[0],n=t.split("|")[1];c(e,n)}),PJF.event.addSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,s=function(){console.log("reset present cash")});var c=function(t,e){PJF.event.removeSubscriber(PJF.stm.client.events.TCR_RESET_SUCCESS,o),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_RESET_FAIL,a),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,s),console.log("reset callback:"+JSON.stringify(r)),t&&(r.status=0,r.errorCode=t,r.errorMsg=e),n&&n(r)};PJF.stm.client.callClient("TCR","resetTCRDev",e,function(t){1==(r=t).status?i=new PJF.ui.loading({msg:"",opacity:.1,noIcon:!0}):(PJF.event.removeSubscriber(PJF.stm.client.events.TCR_RESET_SUCCESS,o),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_RESET_FAIL,a),PJF.event.removeSubscriber(PJF.stm.client.events.TCR_CASH_BOX_PRE,s),n&&n(t))})}},PJF.stm.SAM={psamPowerOn:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("SAM","psamPowerOn",n,e,function(t){var e={}
;return e.pchData=t.pchData,e.iDataLen=t.iDataLen,e})},psamPowerOff:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("SAM","psamPowerOff",n,e)},execCmd:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("SAM","execCmd",n,e,function(t){var e={};return e.pchOutData=t.pchOutData,e.iOutDataLen=t.iOutDataLen,e})},delAcc:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","delAcc",n,e)},addMachineSign:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","addMachineSign",n,e,function(t){var e={};return e.pchNewSign=t.pchNewSign,e})},unlockCI:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","unlockCI",n,e)},issueCI:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","issueCI",n,e)},getCheckCode:function(t,e){var n=$.extend({timeout:20,cStep:1},t);PJF.stm.client.callClient("ZFM","getCheckCode",n,e,function(t){var e={}
;return e.pchCheckCode=t.pchCheckCode,e})}},PJF.stm.LHT={openCamera:function(t,e){PJF.stm.log("人脸识别打开摄像头","PJF_LOG_HARDWARE");var n=$("#"+t.domId)[0];if(n){var i=n.getBoundingClientRect(),o=location.host;-1!=o.indexOf(".wn.")&&(o="cnt01.nemc.jh");var a=$.extend({iIndex:1,frameRate:30},{left:t.left||i.left+window.screenLeft,top:t.top||i.top+window.screenTop,height:t.height||i.height,width:t.width||i.width,pchUrl:"http://"+(PJF.constants.ON_PROD?o:PJF.constants.LHT_URL)+"/bosWeb/page/stm/common/web_small/index.html",showWaterMark:void 0===t.showWaterMark||t.showWaterMark,showFaceRect:void 0===t.showFaceRect||t.showFaceRect});PJF.stm.client.callClient("LHT","openCamera",a,e)}else console.log("openCamera找不到摄像头开启的DOM元素")},startDetect:function(t,n){PJF.stm.log("人脸识别开始检测","PJF_LOG_HARDWARE");var e,i,o,a,s,r,c=$.extend({motion:0,detectMode:1,picMode:0,photoHeight:480,photoWidth:640,expressRate:70,timeout:10,photoPath:""},t),l={}
;PJF.event.addSubscriber(PJF.stm.client.events.LHT_LOSS,i=function(){e&&e.destroy(),c.noSound||PJF.communication.player.PlaySoundByUrl("app/common/faceLoss.mp3",!0),u(!1,{errorCode:"LHT_LOSS_ERR",errorMsg:"人像采集失败"})}),PJF.event.addSubscriber(PJF.stm.client.events.LHT_TMOUT,o=function(){e&&e.destroy(),c.noSound||PJF.communication.player.PlaySoundByUrl("app/common/faceTimeout.mp3",!0),u(!1,{errorCode:"LHT_TMOUT_ERR",errorMsg:"检测超时"})}),PJF.event.addSubscriber(PJF.stm.client.events.LHT_CAM_FAILED,s=function(){e&&e.destroy(),u(!1,{errorCode:"LHT_CAM_FAILED_ERR",errorMsg:"检测中摄像头读取异常"})}),PJF.event.addSubscriber(PJF.stm.client.events.LHT_SDK_FAILED,r=function(){e&&e.destroy(),u(!1,{errorCode:"LHT_SDK_FAILED_ERR",errorMsg:"检测中SDK内部调用错误"})}),PJF.event.addSubscriber(PJF.stm.client.events.LHT_FINISH,a=function(){e&&e.destroy(),u(!0)});var u=function(t,e){PJF.event.removeSubscriber(PJF.stm.client.events.LHT_LOSS,i),PJF.event.removeSubscriber(PJF.stm.client.events.LHT_TMOUT,o),
PJF.event.removeSubscriber(PJF.stm.client.events.LHT_FINISH,a),PJF.event.removeSubscriber(PJF.stm.client.events.LHT_CAM_FAILED,s),PJF.event.removeSubscriber(PJF.stm.client.events.LHT_SDK_FAILED,r),t||(l.status=0,l.errorCode=e.errorCode,l.errorMsg=e.errorMsg),console.log("start detect:"+JSON.stringify(l)),n&&n(l)};PJF.stm.client.callClient("LHT","startDetect",c,function(t){1==(l=t).status?!1!==c.loadingConf&&(e=new PJF.ui.loading({msg:"",opacity:.1,noIcon:!0,timeout:c.timeout})):(PJF.event.removeSubscriber(PJF.stm.client.events.LHT_LOSS,i),PJF.event.removeSubscriber(PJF.stm.client.events.LHT_TMOUT,o),PJF.event.removeSubscriber(PJF.stm.client.events.LHT_FINISH,a),PJF.event.removeSubscriber(PJF.stm.client.events.LHT_CAM_FAILED,s),PJF.event.removeSubscriber(PJF.stm.client.events.LHT_SDK_FAILED,r),n&&n(t))})},endDetect:function(e,t){PJF.stm.log("人脸识别停止检测","PJF_LOG_HARDWARE");var n,i,o=$.extend({},t),a={};PJF.event.addSubscriber(PJF.stm.client.events.LHT_SUCCESS,i=function(){n&&n.destroy(),
PJF.event.removeSubscriber(PJF.stm.client.events.LHT_SUCCESS,i),console.log("end detect:"+JSON.stringify(a)),e&&e(a)});PJF.stm.client.callClient("LHT","endDetect",o,function(t){1==(a=t).status?!1!==o.loadingConf&&(n=new PJF.ui.loading({msg:"",opacity:.1,noIcon:!0})):(PJF.event.removeSubscriber(PJF.stm.client.events.LHT_SUCCESS,i),e&&e(t))})},closeCamera:function(t,e){PJF.stm.log("人脸识别关闭摄像头","PJF_LOG_HARDWARE");var n=$.extend({},e);PJF.stm.client.callClient("LHT","closeCamera",n,t)}},PJF.stm.LHA={fnErrorCode:function(t){var e=t||{};return"DRVLHT0000"==t.errorCode&&(e.status=1),e},openCamera:function(t,n){PJF.stm.log("人脸识别打开摄像头","PJF_LOG_HARDWARE");var e=$("#"+t.domId)[0];if(e){var i=e.getBoundingClientRect(),o=location.host;-1!=o.indexOf(".wn.")&&(o="cnt01.nemc.jh");var a=$.extend({iIndex:1,frameRate:30},{left:t.left||i.left+window.screenLeft,top:t.top||i.top+window.screenTop,height:t.height||i.height,width:t.width||i.width,
pchUrl:"http://"+(PJF.constants.ON_PROD?o:PJF.constants.LHT_URL)+"/bosWeb/page/stm/common/web_small/index.html",showWaterMark:void 0===t.showWaterMark||t.showWaterMark,showFaceRect:void 0===t.showFaceRect||t.showFaceRect,loadingConf:t.loadingConf});if(PJF.util.isKylinSTM()){var s=screen.width/document.body.clientWidth;a.left*=s,a.top*=s,a.height*=s,a.width*=s}PJF.stm.client.callClient("LHA","openCamera",a,function(t){var e=PJF.stm.LHA.fnErrorCode(t);n&&n(e)})}else console.log("openCamera找不到摄像头开启的DOM元素")},startDetect:function(t,n){PJF.stm.log("人脸识别开始检测","PJF_LOG_HARDWARE");var e,i,o,a=$.extend({motion:10,detectMode:1,picMode:0,photoHeight:480,photoWidth:640,expressRate:70,timeout:10,photoPath:""},t),s={};PJF.event.addSubscriber(PJF.stm.client.events.LHA_SUCCESS,i=function(){e&&e.destroy(),r(!0)}),PJF.event.addSubscriber(PJF.stm.client.events.LHA_FAIL,o=function(){e&&e.destroy(),r(!1,{errorCode:"LHA_LOSS_ERR",errorMsg:"人像采集失败"})});var r=function(t,e){
PJF.event.removeSubscriber(PJF.stm.client.events.LHA_SUCCESS,i),PJF.event.removeSubscriber(PJF.stm.client.events.LHA_FAIL,o),t||(s.status=0,s.errorCode=e.errorCode,s.errorMsg=e.errorMsg),console.log("lha start detect:"+JSON.stringify(s)),n&&n(s)},c=function(t){1==(s=t).status?!1!==a.loadingConf&&(e=new PJF.ui.loading({msg:"",opacity:.1,noIcon:!0,timeout:a.timeout})):(PJF.event.removeSubscriber(PJF.stm.client.events.LHA_SUCCESS,i),PJF.event.removeSubscriber(PJF.stm.client.events.LHA_FAIL,o),n&&n(t))};PJF.stm.client.callClient("LHA","startDetect",a,function(t){var e=PJF.stm.LHA.fnErrorCode(t);c(e)})},endDetect:function(n,t){PJF.stm.log("人脸识别停止检测","PJF_LOG_HARDWARE");var e=$.extend({},t);PJF.stm.client.callClient("LHA","endDetect",e,function(t){var e=PJF.stm.LHA.fnErrorCode(t);n&&n(e)})},closeCamera:function(n,t){PJF.stm.log("人脸识别关闭摄像头","PJF_LOG_HARDWARE");var e=$.extend({},t);PJF.stm.client.callClient("LHA","closeCamera",e,function(t){var e=PJF.stm.LHA.fnErrorCode(t);n&&n(e)})},
faceDetectFromImage:function(t,n){var e=$.extend({faceCount:1},t);function i(t){var e={faceBase64:""};try{e.faceBase64=PJF.util.safeParse(t.faceArray)[0]}catch(t){console.log(t.stack)}return e}PJF.stm.client.callClient("LHA","faceDetectFromImage",e,function(t){var e=PJF.stm.LHA.fnErrorCode(t);n&&n(e)},i,i)}},PJF.stm.ZNK={getStatus:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","getStatus",n,e,function(t){var e={};return e.pchLastOptId=t.pchLastOptId,e.pchStatus=t.pchStatus,e})},reset:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","reset",n,e)},addCard:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","addCard",n,e,function(t){var e={};return e.pchSpareSlotCnt=t.pchSpareSlotCnt,e})},addCardBatch:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","addCardBatch",n,e,function(t){var e={}
;return e.pchSpareSlotCnt=t.pchSpareSlotCnt,e})},addCardManual:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","addCardManual",n,e,function(t){var e={};return e.pchSpareSlotCnt=t.pchSpareSlotCnt,e})},stopAddCard:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","stopAddCard",n,e)},getCardByNo:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","getCardByNo",n,e)},getCardNum:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","getCardNum",n,e,PJF.stm.CardReader.fnSuccess)},getICCardInfo:function(e,i){var t=$.extend({timeout:30,iPort:"11041",iIcFlag:1,aryTagList:e.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",aryAIDList:e.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106"},e);PJF.stm.client.callClient("ZNK","getICCardInfo",t,function(n){
if(1==n.status&&e.ARQC&&"1"==n.info.resType)PJF.stm.ZNK.genARQC({ARQC:e.ARQC,pchIp:e.pchIp},function(t){var e=$.extend(!0,{},n,t);e=$.extend(!0,e,{info:{resInfo:t.info}}),i&&i(e)});else if(1==n.status&&"3"==n.info.resType){var t=n.info.stmPchTrackData2.split("=")[1];2==t.charAt(4)||6==t.charAt(4)?(n.status=0,n.errorCode="PJF_TRACK2_PARSE_ERR04",n.errorMsg="不允许IC复合卡通过磁条交易，"+(PJF.otherInfo.isSelfBank?"请联系工作人员":"详情请咨询网点工作人员。")):n.info.resType="0",i&&i(n)}else i&&i(n)},function(t){var e={};return e.resType="1"==t.pICType?"1":"0",e.resInfo=t.pcICInfo,"3"==t.pICType&&(e.pchTrackData2=t.pcICInfo),PJF.stm.ICMaker.fnSuccess(e)})},genARQC:function(t,e){var n={iPort:"11041",iIcFlag:1,pchInput:t.pchInput,pchAIDList:t.pchAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",piLengthD55:t.piLengthD55||2048,piLengthD60:t.piLengthD60||2048,timeout:t.timeout||20};if(n.loadingConf={msg:"设备正在处理中",opacity:.1,noIcon:!0,timeout:n.timeout},$.extend(!0,n,t),t.ARQC){
var i=PJF.util.formatDate(new Date,"yyyyMMddhhmmss");t.ARQC=$.extend(t.ARQC,{transDate:i.substr(0,8),transTime:i.substr(8,16),transOper:PJF.userInfo.userCode}),"default"==t.ARQC.appType?n.pchAIDList="A000000333010101|A000000333010102|A000000333010103|A000000333010106":"1"==t.ARQC.appType?n.pchAIDList="A000000333010101":"2"==t.ARQC.appType&&(n.pchAIDList="A000000333010102"),n.pchInput=PJF.stm.ICMaker.genARQCpchInput(PJF.stm.ICMaker.decimal2Ans(t.ARQC.authAmt),PJF.stm.ICMaker.decimal2Ans(t.ARQC.otherAmt),t.ARQC.cType,t.ARQC.transDate,t.ARQC.transType,t.ARQC.transTime,t.ARQC.transOper)}PJF.stm.client.callClient("ZNK","genARQC",n,e,function(t){var e={};return e.pICType=t.pIcType,e.pchD55=t.pchD55,e.pchD60=t.pchD60,e.pchInput=n.pchInput,e.pchD55Len=t.pchD55.length/2,e})},getCardToReadSlot:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","getCardToReadSlot",n,e)},recoverReadSlotToChunk:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t)
;PJF.stm.client.callClient("ZNK","recoverReadSlotToChunk",n,e)},spitCard:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","spitCard",n,e,function(t){var e={};return e.pchStaffId=t.pchStaffId,e})},recoveSpitToChunk:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","recoveSpitToChunk",n,e)},queryCardsExistByNo:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","queryCardsExistByNo",n,e,function(t){var e={};return e.pchCardInfos=t.pchCardInfos,e})},getRetainedCardInfo:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","getRetainedCardInfo",n,e,function(t){var e={};return e.pchCardInfos=t.pchCardInfos,e})},restoreDev:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","restoreDev",n,e)},putCardIn:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t)
;PJF.stm.client.callClient("ZNK","putCardIn",n,e,function(t){var e={};return e.pchStaffId=t.pchStaffId,e.pchStaffName=t.pchStaffName,e})},putCardOut:function(t,r){var c=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","putCardOut",c,function(e){if("ZNK"==c.socialCard&&"1"==c.iIsValidCard){var n=-1!=["ACC10001","SPB30001","SPB30002","SPB30003","SPB30005"].indexOf(PJF.otherInfo.MENU_ID),i=-1!=["CPB30008","CPB30026","CPB20005","CPB20013","CPB20006","CPB20009","CPB20014"].indexOf(PJF.otherInfo.MENU_ID),t=PJF.stm.enterMenu?PJF.stm.enterMenu.NAME:"首页",o=t+"有卡被吞，吞卡原因为"+(c.stmManage&&c.stmManage.recycle_msg?c.stmManage.recycle_msg:c.conReason);if(PJF.communication.callPad({busiName:o}),PJF.fsm.get(PJF.fsm.fmIds.STM_IDCARD).is("hasId")&&PJF.communication.callPad({busiName:t+"有卡被吞，卡槽中还有身份证"}),e.status)c.stmManage?($.extend(c.stmManage,{cardkey_type:"Card",device_id:PJF.otherInfo.devId,ins_id:PJF.roleInfo.orgCode}),PJF.communication.stmManageAjax({
fwServiceId:"stm.doLogCardKeyFailure",jsonData:c.stmManage}),PJF.communication.addSwallowCardRecord(c.stmManage)):PJF.communication.returnCard(c),r&&r(e);else if(!e.status&&PJF.otherInfo.MENU_ID&&(n||i)){var a=PJF.stm.enterMenu?PJF.stm.enterMenu.NAME:"首页";PJF.communication.callPad({busiName:PJF.userInfo.userCode+"设备"+a+"吞卡失败"});var s=PJF.util.generateUUid();$("body").append('<div id="'+s+'"></div>'),new PJF.ui.fingerReader({dom:s,authTip:"吞卡失败，请工作人员授权通过后返回首页点击“退卡/证”取卡，取卡后请检查该卡是否正常。",success:function(t){console.log("吞卡失败场景，指纹验证通过"),n?template.loadPage("homepage"):i&&r&&r(e)},failure:function(t){console.log("吞卡失败场景，指纹验证失败，返回数据："+JSON.stringify(t)),r&&r(e)}})}else r&&r(e);PJF.stm.util.clearAuthInfo(),PJF.stm.util.clearAuthInfo(!0),PJF.stm.util.clearCardInfo()}else r&&r(e)})},writeMagnet2Card:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","writeMagnet2Card",n,e)},powerOnIMC:function(t,e){var n=$.extend({iPort:"11041"},t)
;PJF.stm.client.callClient("ZNK","powerOnIMC",n,e,function(t){var e={};return e.pchATR=t.pchATR,e})},powerOffIMC:function(t,e){var n=$.extend({iPort:"11041"},t);PJF.stm.client.callClient("ZNK","powerOffIMC",n,e)},execICCmd:function(t,e){var n=$.extend({iPort:"11041"},t);PJF.stm.client.callClient("ZNK","execICCmd",n,e,function(t){var e={};return e.pchRes=t.pchRes,e})},printCardFace:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","printCardFace",n,e)},bulgeCardFace:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","bulgeCardFace",n,e)},queryAllBlankCardTypeExist:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t);PJF.stm.client.callClient("ZNK","queryAllBlankCardTypeExist",n,e,function(t){var e={};return""==t.pchCardInfos?e.pchCardInfos=[]:e.pchCardInfos=JSON.parse(t.pchCardInfos),e})},cardStoreTrans:function(t,e){var n=$.extend({timeout:30,iPort:"11041"},t)
;PJF.stm.client.callClient("ZNK","cardStoreTrans",n,e,function(t){var e={};return e.pchOut=t.pchOut,e})}},PJF.stm.EXT={getDevStatus:function(t,e){var n=$.extend({timeout:20},t);PJF.stm.client.callClient("EXT","getDevStatus",n,e,function(t){var e={};return e.pchExtSN=t.pchExtSN,e})},initHYICCard:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("EXT","initHYICCard",n,e,function(t){var e={};return e.pchInitData=t.pchInitData,e})},closeHYICCard:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("EXT","closeHYICCard",n,e)},readWriteHYICCard:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("EXT","readWriteHYICCard",n,e,function(t){var e={};return e.pchExcuteResult=t.pchExcuteResult,e})},getCardNum:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("EXT","getCardNum",n,e,PJF.stm.CardReader.fnSuccess)},resetDev:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("EXT","resetDev",n,e)}},
PJF.stm.AppIME={fnCallBack:function(t){var e=JSON.parse(t),n={status:0};if(e.success){var i=JSON.parse(e.result);n.errorCode=i.pchErrCode,n.errorMsg=i.pchError,"IME0000000"==i.pchErrCode&&(n.status=1)}return n},openSoftKeyboard:function(t,n){var i=this;PJF.orgInfo&&"DA003"===PJF.orgInfo.instSvrlLgPsnID&&(t.hmode="2"),t=$.extend({hmode:0},t),PJF.communication.devices.CallDevice("AppIME","openSoftKeyboard",t,function(t){var e=i.fnCallBack(t);n&&n(e)})},closeSoftKeyboard:function(t,n){var i=this;t=$.extend({},t),PJF.communication.devices.CallDevice("AppIME","closeSoftKeyboard",t,function(t){var e=i.fnCallBack(t);n&&n(e)})}},PJF.stm.SIU={openSIU:function(t,e){var n=$.extend({timeout:20},t);PJF.stm.client.callClient("SIU","openSIU",n,e)},closeSIU:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("SIU","closeSIU",n,e)}},PJF.stm.PSR={getDevStatus:function(t,e){var n=$.extend({pchReserve:"",timeout:20},t);PJF.stm.client.callClient("PSR","getDevStatus",n,e)},
resetDev:function(t,e){var n=$.extend({pchReserve:""},t);PJF.stm.client.callClient("PSR","resetDev",n,e)},cancelDev:function(t,e){var n=$.extend({pchReserve:""},t);PJF.stm.client.callClient("PSR","cancelDev",n,e)},scanAndRead:function(t,e){var n=$.extend({timeout:60,iDpi:"300"},t);PJF.stm.client.callClient("PSR","scanAndRead",n,e,PJF.stm.PSR.fnSuccess)},scanAndReadAllInfo:function(t,e){var n=$.extend({timeout:60,iDpi:"300"},t);PJF.stm.client.callClient("PSR","scanAndReadAllInfo",n,e,PJF.stm.PSR.fnSuccess)},fnSuccess:function(t){var e={},n={};t.pchInfo=JSON.parse(t.pchInfo),n.recognizeType=t.pchInfo.recognizeType,n.side=t.pchInfo.side,n.credType=t.pchInfo.credType,n.subCredType=t.pchInfo.subCredType,n.reserve=t.pchInfo.reserve,"A"==n.credType?(n.credID=t.pchInfo.MRZCredID,n.EnglishName=t.pchInfo.EnglishName,n.sex=t.pchInfo.sex,n.birthday=t.pchInfo.birthday.replace(/-/g,""),n.validity="-"+t.pchInfo.validity.replace(/-/g,""),n.issueNationCode=t.pchInfo.issueNationCode,
n.nationCode=t.pchInfo.nationCode,n.loss=!("1"!=n.recognizeType||n.credID&&n.EnglishName&&n.sex&&n.birthday&&n.validity&&n.issueNationCode&&n.nationCode),n.nativeName=t.pchInfo.nativeName,n.nativeCredID=t.pchInfo.nativeCredID,n.issueOffice=t.pchInfo.issueOffice):(-1==t.pchInfo.validity.indexOf("-")&&(t.pchInfo.validity=(t.pchInfo.issueDate||"").replace(/[-\.]/g,"")+"-"+t.pchInfo.validity),n.credID=t.pchInfo.credID||t.pchInfo.MRZCredID,n.nativeName=t.pchInfo.nativeName,n.EnglishName=t.pchInfo.EnglishName,n.sex=t.pchInfo.sex,n.birthday=t.pchInfo.birthday.replace(/-/g,""),n.validity=t.pchInfo.validity,n.issueOffice=t.pchInfo.issueOffice,n.issueDate=t.pchInfo.issueDate,n.nativeCredID=t.pchInfo.nativeCredID,n.issueTimes=t.pchInfo.issueTimes,"C"==n.credType&&(n.address=t.pchInfo.address,n.profession=t.pchInfo.profession,"C2"==n.subCredType&&(n.validity=t.pchInfo.validityTime,n.issueDate=t.pchInfo.validityTime.split("-")[0])),
n.loss=!("1"!=n.recognizeType||n.credID&&n.nativeName&&n.EnglishName&&n.sex&&n.birthday&&n.validity&&n.issueOffice&&n.issueDate));var i=(e.pchInfo=n).validity.replace(/\s/g,"").split("-")[1],o=PJF.communication.getServerTime("yyyyMMdd"),a=o||PJF.util.formatDate(new Date);return parseInt(a)>parseInt(i)&&(e.pjfstatus="0",e.pchErrCode="PJF_PSR_PARSE_ERR01",e.pchError="证件已过期，请更换有效证件办理业务"),e}},PJF.stm.RTS={fnErrorCode:function(t){var e=t||{};return"RTS0000000"===t.errorCode&&(e.status=1),e},call:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("RTS","ZS_SMCS_Call",n,function(t){e&&e(PJF.stm.RTS.fnErrorCode(t))})},close:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("RTS","ZS_SMCS_Close",n,function(t){e&&e(PJF.stm.RTS.fnErrorCode(t))})},transmit:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("RTS","ZS_SMCS_SetTransmitData",n,function(t){e&&e(PJF.stm.RTS.fnErrorCode(t))})},setIotID:function(t,e){var n=$.extend({pchIOTId:""},t)
;PJF.stm.client.callClient("RTS","ZS_SMCS_SetIotID",n,function(t){e&&e(PJF.stm.RTS.fnErrorCode(t))})}},PJF.stm.PTP={fnErrorCode:function(t){var e=t||{};return"ONLINE0000"===t.errorCode&&(e.status=1),e},getDevStatus:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("PTP","getDevStatus",n,function(t){e&&e(PJF.stm.PTP.fnErrorCode(t))})},startPrintPhoto:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("PTP","startPrintPhoto",n,e)},resetDev:function(t,e){var n=$.extend({},t);PJF.stm.client.callClient("PTP","resetDev",n,e)}},PJF.stm.HVT={checkStatus:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("HVT","checkHandVoiceDeviceStatus",n,e)}},PJF.stm.FTC={openCabin:function(t,e){var n=$.extend({pchIp:"127.0.0.1",iPort:"21019",timeout:30},t);PJF.stm.client.callClient("FTC","openCabin",n,e)},getCabinStatus:function(t,e){var n=$.extend({pchIp:"127.0.0.1",iPort:"21019",timeout:30},t)
;PJF.stm.client.callClient("FTC","getCabinStatus",n,e)},getFtcStatus:function(t,e){var n=$.extend({pchIp:"127.0.0.1",iPort:"21019",timeout:30},t);PJF.stm.client.callClient("FTC","getFtcStatus",n,e)},getDevStatus:function(t,e){var n=$.extend({pchIp:"127.0.0.1",iPort:"21019",timeout:30},t);PJF.stm.client.callClient("FTC","getDevStatus",n,e)},resetDev:function(t,e){var n=$.extend({pchIp:"127.0.0.1",iPort:"21019",timeout:30},t);PJF.stm.client.callClient("FTC","resetDev",n,e)}},PJF.stm.ID2={getID2CardInfo:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("ID2","getID2CardInfo",n,e,PJF.stm.IdCard.fnSuccess)},stopReadID2:function(t,e){var n=$.extend({timeout:30},t);PJF.stm.client.callClient("ID2","stopReadID2",n,e)}},PJF.namespace("PJF.ytd"),PJF.ytd.COMMON={getDevStatus:function(t,e){var n=$.extend({timeout:30},t);return PJF.stm.client.callClient("COMMON","getDevStatus",n,e)},resetDev:function(t,e){var n=$.extend({},t)
;return PJF.stm.client.callClient("COMMON","resetDev",n,e)},closeDev:function(t,e){var n=$.extend({},t);return PJF.stm.client.callClient("COMMON","closeDev",n,e)},getDevSN:function(t,e){var n=$.extend({},t);return PJF.stm.client.callClient("COMMON","getDevSN",n,e,function(t){var e={};return e.pchDevSN=t.pchDevSN,e})}},PJF.ytd.PIN={readPin:function(t,e){PJF.stm.Pin.readPin(t,e)}},PJF.ytd.RDC={getCardNum:function(t,e){var n=$.extend({trackNum:23,timeout:30,deviceStartSound:t.rdcSound||"devprompt/RDC_read.wav",readPassbook:t.readPassbook},t);return PJF.stm.client.callClient("RDC","getCardNum",n,e,function(t){return t.readPassbook=n.readPassbook,PJF.ytd.RDC.fnSuccess(t)})},fnSuccess:function(t){0==t.pchTrackData2.indexOf(":")&&(t.pchTrackData2=t.pchTrackData2.substr(1));var e={};e.pchTrackData2=t.pchTrackData2,e.pchTrackData3=t.pchTrackData3,-1!=e.pchTrackData2.indexOf("=")?(e.accountNo=e.pchTrackData2.split("=")[0],
e.ytdPchTrackData2=e.pchTrackData2):-1!=e.pchTrackData2.indexOf("'")?(e.accountNo=e.pchTrackData2.split("'")[0],e.pchTrackData2=e.pchTrackData2.replace("'","="),e.ytdPchTrackData2=e.pchTrackData2.replace("'","=")):-1!=e.pchTrackData2.indexOf(">")?(e.accountNo=e.pchTrackData2.split(">")[0],e.pchTrackData2=e.pchTrackData2.replace(">","="),e.ytdPchTrackData2=e.pchTrackData2.replace(">","=")):(console.log("未能正确匹配磁道分隔符"),e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR01",e.pchError="未能正确匹配磁道分隔符");var n=PJF.util.encrypt(e.pchTrackData2);if(n?e.pchTrackData2=n:(console.log("二磁数据加密失败"),e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR02",e.pchError="二磁数据加密失败"),e.resInfo={},e.resInfo.accountNo=e.accountNo,e.resInfo.secDisInfo=e.pchTrackData2,e.resType="0",-1!=PJF.util.array.indexOf(["'","=",">"],t.pchTrackData2.substr(19,1))&&35==t.pchTrackData2.length){
var i=t.pchTrackData2.substr(20,4),o=t.pchTrackData2.substr(24,3),a="0"+t.pchTrackData2.substr(27,2),s=t.pchTrackData2.substr(29,2),r=parseInt(s.charAt(0),10),c=parseInt(s.charAt(1),10),l=[Math.floor(r/2),r%2,Math.floor(c/2),c%2].join("");e.resInfo.printNo=i,e.resInfo.dvvNo=o,e.resInfo.bkNumber=a,e.resInfo.withdrawMode=l}return e},wrtCart:function(t,e){var n=$.extend({trackNum:23,timeout:30},t);return PJF.stm.client.callClient("RDC","wrtCart",n,e)}},PJF.ytd.ICC={getICCardInfo:function(t,n){var i=$.extend({iIcFlag:3,aryTagList:"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",aryAIDList:"A000000333010101|A000000333010102|A000000333010103|A000000333010106",piCInfoLen:4096,timeout:30,loadingConf:{msg:"请放置您的银行卡",opacity:.1,noIcon:!0,timeout:30}},t);if(i.ARQC){var e=PJF.util.formatDate(new Date,"yyyyMMddhhmmss");i.ARQC=$.extend(i.ARQC,{transDate:e.substr(0,8),transTime:e.substr(8,16),transOper:PJF.userInfo.userCode}),
"default"==i.ARQC.appType?i.ARQC.pchAIDList="A000000333010101|A000000333010102|A000000333010103|A000000333010106":"1"==i.ARQC.appType?i.ARQC.pchAIDList="A000000333010101":"2"==i.ARQC.appType&&(i.ARQC.pchAIDList="A000000333010102"),i.ARQC.piLengthD55=i.ARQC.piLengthD55||2048,i.ARQC.piLengthD60=i.ARQC.piLengthD60||2048,i.ARQC.timeout=i.ARQC.timeout||20,i.ARQC.pchInput=PJF.stm.ICMaker.genARQCpchInput(PJF.stm.ICMaker.decimal2Ans(i.ARQC.authAmt),PJF.stm.ICMaker.decimal2Ans(i.ARQC.otherAmt),i.ARQC.cType,i.ARQC.transDate,i.ARQC.transType,i.ARQC.transTime,i.ARQC.transOper)}return PJF.stm.client.callClient("ICC","getICCardInfo",i,function(e){1==e.status&&i.ARQC&&1==e.info.resType?PJF.stm.ICMaker.genARQC(i.ARQC,function(t){1==t.status&&(e.ARQC=t.info),n&&n(e)}):n&&n(e)},PJF.ytd.ICC.fnSuccess)},fnSuccess:function(t){var e={};e.pICType=t.pICType,e.resType=PJF.constants.IS_DOWNGRADE?"1":"2";var n=t.pcICInfo,i={},o={A:"accountNo",B:"userName",C:"identityCardType",D:"identityCardNo",E:"secDisInfo",
F:"firDisInfo",G:"balance",H:"balanceLimit",I:"invalidDate",J:"ICCardNo"};function a(t){return!!t&&null==t.match(/\D/)}function s(t){e.resInfo="IC卡数据格式错误,数据为:"+t.resInfo,e.pjfstatus="0",e.pchErrCode="PJF_IC_PARSE_ERR01",e.pchError=e.resInfo}for(var r=10;4<n.length&&-1<=r;){r--;var c=n.substr(0,4),l=parseInt(n.substr(1,3),10);i[o[c[0]]]=n.substr(4,l),n=n.slice(4+l)}if(-1==r||0!=r||""!=n)if(-1==(n=t.pcICInfo).indexOf("A")||-1==n.lastIndexOf("I")||-1==n.lastIndexOf("J"))s(t);else{var u=n.substring(4,n.indexOf("B")),d=u.length;"F"==u.charAt(d-1)&&(u=u.substr(0,d-1));var h=n.substring(n.lastIndexOf("I")+4,n.lastIndexOf("J")),m=n.substring(n.lastIndexOf("J")+4);a(u)&&a(h)&&(a(m.substr(0,3))||""===m.substr(0,3))?(0==m.length?m="001":1==m.length?m="00"+m:2==m.length?m="0"+m:3<m.length&&(m=m.substr(0,3)),(i={}).accountNo=u,i.userName="",i.identityCardType="",i.identityCardNo="",i.secDisInfo="",i.firDisInfo="",i.balance="",i.balanceLimit="",i.invalidDate=h,i.ICCardNo=m):s(t)}
i.balance&&(i.balance=(parseFloat(i.balance)/100).toFixed(2));var p=PJF.util.Encrypt0x88(40),f=PJF.util.encrypt(i.secDisInfo);if(f?i.equalSecDisInfo=f:(console.log("等效二磁数据加密失败"),e.pjfstatus="0",e.pchErrCode="PJF_TRACK2_PARSE_ERR03",e.pchError="等效二磁数据加密失败"),p?i.secDisInfo=p:(console.log("二磁数据加密失败"),e.pjfstatus="0",e.pchErrCode="PJF_IC_PARSE_ERR02",e.pchError="二磁数据加密失败"),i.accountNo){var g=i.accountNo,P=g.length;"F"==g.charAt(P-1)&&(g=g.substr(0,P-1)),i.accountNo=g}if(i.ICCardNo){var v=i.ICCardNo;0==v.length?v="001":1==v.length?v="00"+v:2==v.length?v="0"+v:3<v.length&&(v=v.substr(0,3)),i.ICCardNo=v}return e.resInfo=i,e},genARQC:function(t,e){var n=$.extend(!0,{iIcFlag:3,piLengthD55:2048,piLengthD60:2048,loadingConf:{msg:"请放置您的银行卡",opacity:.1,noIcon:!0}},t);if(n.ARQC){var i=PJF.util.formatDate(new Date,"yyyyMMddhhmmss");n.ARQC=$.extend(n.ARQC,{transDate:i.substr(0,8),transTime:i.substr(8,16),transOper:PJF.userInfo.userCode}),
"default"==n.ARQC.appType?n.pchAIDList="A000000333010101|A000000333010102|A000000333010103|A000000333010106":"1"==n.ARQC.appType?n.pchAIDList="A000000333010101":"2"==n.ARQC.appType&&(n.pchAIDList="A000000333010102"),n.pchInput=PJF.stm.ICMaker.genARQCpchInput(PJF.stm.ICMaker.decimal2Ans(n.ARQC.authAmt),PJF.stm.ICMaker.decimal2Ans(n.ARQC.otherAmt),n.ARQC.cType,n.ARQC.transDate,n.ARQC.transType,n.ARQC.transTime,n.ARQC.transOper)}function o(t){return t.pchD55Len=t.pchD55.length/2,t}PJF.ytd.ICC.getICCardInfo({},function(){return PJF.stm.client.callClient("ICC","genARQC",n,e,o)})},ARPC_ExeICScript:function(t,e){var n=$.extend({iIcFlag:3,timeout:30,iLenGAC2:2048},t);return PJF.stm.client.callClient("ICC","ARPC_ExeICScript",n,e)},getTxDetail:function(t,e){var n=$.extend({iIcFlag:3,iLenGAC2:2048,pchAIDList:"A000000333010101|A000000333010102|A000000333010103|A000000333010106"},t);return PJF.stm.client.callClient("ICC","getTxDetail",n,e)}},PJF.ytd.FIG={registerFinger:function(t,e){
var n=$.extend({},t);return PJF.stm.client.callClient("FIG","registerFinger",n,e)},readFinger:function(t,e){var n=$.extend({timeout:30},t);return PJF.stm.client.callClient("FIG","readFinger",n,e)}},PJF.ytd.IDC={getIDCardInfo:function(t,e){var n=$.extend({timeout:60},t);return n.pchPhotoPath=PJF.stm.baseDir+"/identity/"+t.pchPhotoName,n.frontPhotoPath=PJF.stm.baseDir+"/identity/"+t.frontPhotoName,n.backPhotoPath=PJF.stm.baseDir+"/identity/"+t.backPhotoName,PJF.stm.client.callClient(PJF.util.deviceType.pad?"App_IDC":"IDC",PJF.util.deviceType.pad?"IDC_readCard":"getIDCardInfo",n,e,PJF.ytd.IDC.fnSuccess)},fnSuccess:function(t){var e,n={},i={},o=t.pchInfo.split("|");if(0===["81","82","83"].indexOf(o[5].substr(0,2))||"J"===o[0])return n.pjfstatus="0",n.pchErrCode="PJF_IdCard_PARSE_ERR02",n.pchError="港澳台居民居住证，移步至柜面办理",n;"I"==o[0]&&(e=!0),e?(i.isForeign=!0,i.engName=o[1],i.sex=o[2],i.identity=o[3],i.areaCode=o[4],i.name=o[5],i.validDate=o[6].replace(/\s/g,""),i.birth=o[7],i.version=o[8],
i.issueOfficeCode=o[9]):(i.name=o[0],i.sex=o[1],i.nation=o[2],i.birth=o[3],i.address=o[4],i.identity=o[5].toUpperCase(),i.issueOffice=o[6],i.validDate=o[7].replace(/\s/g,"")),n.pchInfo=i,!e&&-1<o[2].indexOf("族")&&(i.nation=o[2].substring(0,o[2].indexOf("族")));var a=e?o[6].replace(/\s/g,"").split("-")[1]:o[7].replace(/\s/g,"").split("-")[1];"99991231"==a&&(a="长期",i.validDate=i.validDate.split("-")[0]+"-"+a);var s,r=PJF.communication.getServerTime("yyyyMMdd");if((s=a)&&null==s.match(/\D/)){var c=r||PJF.util.formatDate(new Date);8!=a.length?(n.pjfstatus="0",n.pchErrCode="PJF_IDC_PARSE_ERR00",n.pchError="身份证有效日期结束时间格式错误,结束时间即为"+a):parseInt(c)>parseInt(a)&&(n.pjfstatus="0",n.pchErrCode="PJF_IDC_PARSE_ERR01",n.pchError="身份证已过期，请更换身份证后再办理")}else"长期"!=a&&(n.pjfstatus="0",n.pchErrCode="PJF_IDC_PARSE_ERR00",n.pchError="身份证有效日期结束时间格式错误,结束时间即为"+a);return n}},PJF.ytd.TDC={getTDCode:function(t,e){var n=$.extend({timeout:30},t);return PJF.stm.client.callClient("TDC","getTDCode",n,e)}},PJF.ytd.TPT={
doPrint:function(t,e){var n=$.extend({timeout:30},t);return PJF.stm.client.callClient("TPT","doPrint",n,e)}},PJF.ytd.SXT={takePhoto:function(t,e){var n=$.extend({iIndex:1,imageType:2,iExpRate:70,iWidth:640,iHeight:480},t);return PJF.stm.client.callClient("SXT","takePhoto",n,e)},getCurFrame:function(t,e){var n=$.extend({iIndex:1,iType:3,iRate:70},t);return PJF.stm.client.callClient("SXT","getCurFrame",n,e)},cameraPreview:function(t,e){var n=$.extend({iIndex:1,iWidth:640,iHeight:480,showWaterMark:!0},t),i=$("#"+n.domId)[0];if(i){var o=i.getBoundingClientRect(),a=$.extend(n,{x:o.left+window.screenLeft,y:o.top+window.screenTop,w:o.width,h:o.height});return PJF.fsm.get(PJF.fsm.fmIds.STM_CAMERA).openCamera(),PJF.stm.client.callClient("SXT","cameraPreview",a,e)}console.log("openCamera找不到摄像头开启的DOM元素")},stopPreview:function(t,e){var n=$.extend({iIndex:1},t);return PJF.fsm.get(PJF.fsm.fmIds.STM_CAMERA).closeCamera(),PJF.stm.client.callClient("SXT","stopPreview",n,e)}},PJF.ytd.ODC={
getODCInfo:function(t,e){var n=$.extend({timeout:30},t);return PJF.stm.client.callClient("ODC","getODCInfo",n,e)}},PJF.ytd.MLT={callThreeDevice:function(t,e){var n=$.extend({timeout:20},t);return PJF.stm.client.callClient("MLT","callThreeDevice",n,e,function(t){return t.readPassbook=n.readPassbook,PJF.ytd.MLT.fnSuccess(t)})},fnSuccess:function(t){var e=t.piType;if(1==e||2==e){var n,i={},o=t.pchCardData||t.pcICInfo;return i.pcICInfo=o,(n=PJF.ytd.ICC.fnSuccess(i)).type=e,n}if(3==e){var a,s={};o=t.pchCardData||t.pchTrackData2;return s.pchTrackData2=o,s.readPassbook=t.readPassbook,(a=PJF.ytd.RDC.fnSuccess(s)).type=e,a}if(4==e){var r={};o=t.pchInfo;return r.pchInfo=o,PJF.ytd.IDC.fnSuccess(r)}console.log("输出信息中读取卡片的设备类别字段错误")},callTwoDevice:function(t,e){var n=$.extend({timeout:20},t);return PJF.stm.client.callClient("MLT","callTwoDevice",n,e,PJF.ytd.MLT.fnSuccess)},callFourDevice:function(t,e){var n=$.extend({timeout:20},t)
;return PJF.stm.client.callClient("MLT","callFourDevice",n,e,PJF.ytd.MLT.fnSuccess)},closeMltDev:function(t,e){var n=$.extend({timeout:20},t);return PJF.stm.client.callClient("MLT","closeMltDev",n,e)}},PJF.stm.vta={hasLogin:!1,terminalSnapShot:function(t){console.log("拍照开始:"+t),t=PJF.stm.baseDir+"/identity/"+t;var e=parent.document.getElementById("EspaceMediaOCX").mediaTerminalSnapShot(t);return 0==e||(new PJF.ui.errorMessageBox({content:"摄像头调用失败",detailMsg:"错误码为:"+e,buttonConfs:[{name:"确认",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){template.loadPage("homepage")}}]}),!1)},terminalSendFile:function(t){console.log("发送文件:"+t),t=PJF.stm.baseDir+"/identity/"+t;var e=parent.document.getElementById("EspaceMediaOCX").mediaTerminalSendFile(t);return 0==e||(new PJF.ui.errorMessageBox({content:"发送文件失败",detailMsg:"错误码为:"+e,buttonConfs:[{name:"确认",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){template.loadPage("homepage")}}]}),!1)},createWindow:function(data){
var hd=$("#"+data.domId),he=hd[0],br=he.getBoundingClientRect(),args={x:br.left+window.screenLeft,y:br.top+window.screenTop,w:br.width,h:br.height,showWaterMark:void 0===data.showWaterMark||data.showWaterMark},frameArgs={imageType:3,iExpRate:100,iIndex:1};console.log("创建窗口开始"),PJF.communication.devices.CallDevice("WindowFactory","Create",args,function(e){console.log("enter create window,result is "+e);var jsonData=eval("("+e+")");if(jsonData.success){var hwnd=JSON.parse(jsonData.result).hwnd;console.log("创建窗口成功,句柄:"+hwnd);var Terminal=parent.document.getElementById("EspaceMediaOCX");Terminal.mediaTerminalSetLocalVedioHandle(hwnd),Terminal.mediaTerminalSetRemoteVedioHandle(hwnd)}else alert("窗口创建失败,请联系管理员"),template.loadPage("homepage")})},closeWindow:function(t){console.log("关闭窗口"),PJF.stm.client.callClient("WindowFactory","Close",{},function(t){console.log("window关闭成功")})},terminalSendMsg:function(t){console.log("开始sendMsg:"+t)
;var e=parent.document.getElementById("EspaceMediaOCX").mediaTerminalSendMsg(t);return 0==e||(new PJF.ui.errorMessageBox({content:"发送消息失败",detailMsg:"错误码为:"+e,buttonConfs:[{name:"确认",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){template.loadPage("homepage")}}]}),!1)},terminalReceiveMsg:function(t){console.log("开始receiveMsgMsg:"+t),PJF.stm.vta.terminalRecMsg(t)},initTerminal:function(){if(window.vtaTalking=!1,!PJF.stm.vta.hasLogin&&PJF.util.isExist("PJF.otherInfo.vtaId")&&PJF.util.isExist("PJF.otherInfo.authType")&&"01"==PJF.otherInfo.authType){var t=parent.document.getElementById("EspaceMediaOCX").mediaTerminalLogin(PJF.otherInfo.vtaId,1);0==t?(window.vtaLoginTimeId&&window.clearTimeout(window.vtaLoginTimeId),Ext.vtmId=PJF.otherInfo.vtaId,PJF.stm.vta.hasLogin=!0):"9009"==t?(new PJF.ui.errorMessageBox({content:"视频服务账号已登陆,请过3分钟再使用系统功能",buttonConfs:[{name:"确认",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){}}]}),window.vtaLoginTimeId=setTimeout(function(){
PJF.stm.vta.initTerminal()},6e4)):new PJF.ui.errorMessageBox({content:"视频服务登录失败",detailMsg:"错误码为:"+t,buttonConfs:[{name:"确认",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){}}]})}},callTerminal:function(){console.log("开始callTerminal.."),window.vtaComplete=!1,window.vtaLoading=new PJF.ui.loading({noIcon:!0,msg:"",opacity:.1,timeout:99});var t=parent.document.getElementById("EspaceMediaOCX").mediaTerminalCall("2",PJF.otherInfo.vtaTeller,"");return PJF.stm.vta.createWindow({domId:"takePhoto"}),0==t||(window.vtaLoading.destroy(),new PJF.ui.errorMessageBox({content:"呼叫坐席失败",detailMsg:"错误码为:"+t,buttonConfs:[{name:"确认",btnBgColor:"rgb(65,159,245)",style:"main",onClick:function(){PJF.stm.vta.closeWindow(),template.loadPage("homepage")}}]}),!1)},destroyTerminal:function(){window.vtaComplete=!0;var t=parent.document.getElementById("EspaceMediaOCX").mediaTerminalReleaseCall();console.log("ReleaseCall:"+t)},handleTaking:function(eventInfo){console.log("taking event:"+eventInfo)
;var _eventInfo=eval("("+eventInfo+")"),_callMode=_eventInfo.callmode;window.vtaLoading&&window.vtaLoading.destroy(),"onewayvideo"==_callMode?(window.vtaTalking=!0,PJF.communication.devices.CallDevice("WindowFactory","Show",{},function(t){PJF.communication.player.PlaySoundByUrl("devprompt/SXT_selfCheck.wav"),PJF.stm.vta.connectSuccess()})):PJF.stm.vta.destroyTerminal()},handleRelease:function(eventInfo){if(console.log("release:"+eventInfo+"vtaTalking:"+window.vtaTalking),window.vtaTalking){window.vtaTalking=!1;var eventInfo=eval("("+eventInfo+")"),remoteNum=eventInfo.remote_number;window.vtaComplete||(PJF.stm.vta.closeWindow(),window.vtaLoading&&window.vtaLoading.destroy(),PJF.stm.vta.destroyTerminal(),new PJF.ui.errorMessageBox({content:"坐席繁忙，请重新操作",buttonConfs:[{name:"确定",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){template.loadPage("homepage")}}]}))}else PJF.stm.vta.closeWindow(),window.vtaLoading&&window.vtaLoading.destroy(),new PJF.ui.errorMessageBox({
content:"后台坐席繁忙，请稍后重试",buttonConfs:[{name:"重新呼叫",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){PJF.stm.vta.callTerminal()}},{name:"取消",style:"main",onClick:function(){template.loadPage("homepage")}}]})},handleCamerFail:function(t){PJF.stm.vta.closeWindow(),window.vtaLoading&&window.vtaLoading.destroy(),new PJF.ui.messageBox({title:"提示信息",content:"摄像头启动失败",buttonConfs:[{name:"重新呼叫",style:"main",appendStyle:"confirm",width:200,height:80,onClick:function(){PJF.stm.vta.callTerminal()}},{style:"main",name:"取消",style:"main",width:200,height:80,onClick:function(){template.loadPage("homepage")}}]})},handleVideoFail:function(){PJF.stm.vta.closeWindow(),window.vtaLoading&&window.vtaLoading.destroy(),new PJF.ui.messageBox({title:"提示信息",content:"视频启动失败",buttonConfs:[{name:"重新呼叫",style:"main",appendStyle:"confirm",width:200,height:80,onClick:function(){PJF.stm.vta.callTerminal()}},{style:"main",name:"取消",style:"main",width:200,height:80,onClick:function(){
template.loadPage("homepage")}}]})},showFailedEvent:function(){"01"==PJF.otherInfo.authType&&new PJF.ui.errorMessageBox({content:"加载华为视频控件失败，请联系设备管理员",buttonConfs:[{style:"main",name:"确定",onClick:function(){}}]})}},PJF.namespace("PJF.stm.iot"),function(t){t.cdbIssue=function(o,a){var s={cardSource:o.cardSource,iIcFlag:o.iIcFlag||1,aryTagList:o.aryTagList||"x41,x42,x43,x44,x45,x46,x47,x48,x49,x4A",aryAIDList:o.aryAIDList||"A000000333010101|A000000333010102|A000000333010103|A000000333010106",piCInfoLen:o.piCInfoLen||4096,trackNum:o.trackNum||2,timeout:o.timeout||20,iotFunc:!0,uniqueNo:"",coordinateX:PJF.otherInfo.globalParams.coordinateX,coordinateY:PJF.otherInfo.globalParams.coordinateY,angle:PJF.otherInfo.globalParams.angle};s.loadingConf={msg:"设备正在处理中",opacity:.1,noIcon:!0,timeout:s.timeout},$.extend(!0,s,o),PJF.stm.client.callClient("App_CDB","CDB_CardIssue",s,function(e){if(console.log("cdbIssue issRes:"+JSON.stringify(e)),e.info&&e.info.robotId){var n={}
;o.robotIdList.forEach(function(t){t.robotIotId===e.info.robotId&&PJF.util.extend(n,t)}),PJF.util.extend(!0,o.stmManage,{cardkey_type:"Card",device_id:n.device_id,box_no:n.box_no})}PJF.stm.client.newCard=o.stmManage;var i=function(e){PJF.stm.ICMaker.confiscateDev(function(t){(e=e||{}).confiscateResult=t,a&&a(e)},{stmManage:PJF.stm.client.newCard,conReason:e.conReason,iotFunc:!0,uniqueNo:s.uniqueNo})};function t(t){return"DRV0000000"==t||"DRVCDB0012"!=t&&"DRVCDB0001"!=t&&"DRVCDB0011"!=t&&-1!=t.indexOf("DRVCDB")}e.status?($.extend(PJF.stm.client.newCard,{cardkey_no:e.info.resInfo.accountNo}),PJF.communication.stmManageAjax({fwServiceId:"stm.doReadCardKey",jsonData:PJF.stm.client.newCard,success:function(t){a&&a(e)},failure:function(t){PJF.stm.client.newCard.recycle_type="Read",PJF.stm.client.newCard.recycle_msg=t.BK_DESC,i({status:0,errorMsg:t.BK_DESC,conReason:t.BK_DESC})}})):(t(e.errorCode)?(PJF.stm.client.newCard.recycle_type="Read",
PJF.stm.client.newCard.recycle_msg="发卡出错,出卡或读卡出错:"+e.errorMsg,$.extend(e,{conReason:"发卡出错,出卡或读卡出错"}),i(e)):a&&a(e),console.log("cdbIssue从机器人发卡失败:"+JSON.stringify(e))),t(e.errorCode)?(PJF.communication.stmManageAjax({fwServiceId:"stm.doModifyCardKeySurplus",jsonData:PJF.stm.client.newCard}),console.log("cdbIssue发卡返回错误码为:"+e.errorCode+",卡箱数量将减一。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newCard))):console.log("cdbIssue发卡返回错误码为:"+e.errorCode+",卡箱数量将不变。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newCard))},PJF.stm.ICMaker.fnSuccess)},t.cdbEject=function(o,a){a=$.extend({},a);PJF.stm.ICMaker.ejectDev(function(e){if(e.status){var t;a.cdbEjectSound?PJF.communication.player.PlaySoundByUrl(a.cdbEjectSound):PJF.communication.player.PlaySoundByUrl("devprompt/CDB_taken.wav",!0);var n=new PJF.ui.loading({msg:PJF.i18n.getI18nResource("pjfI18n.takeIcCardTip"),timeout:30}),i=setTimeout(function(){PJF.event.removeSubscriber(PJF.stm.client.events.CDB_TAKEN,t),n.destroy(),
a.stmManage&&(a.stmManage.recycle_type="Popout",a.stmManage.recycle_msg="客户发卡未取"),PJF.stm.ICMaker.confiscateDev(function(t){e.status?t.status=3:(t.status=4,console.log("没收卡失败，错误代码为:"+e.errorCode)),o&&o(t)},{stmManage:a.stmManage,conReason:"吐卡超时未取",recycleType:"8",iotFunc:!0,uniqueNo:a.uniqueNo})},3e4);PJF.event.onceSubscriber(PJF.stm.client.events.CDB_TAKEN,t=function(){clearTimeout(i),n.destroy(),o&&o({status:1})})}else o&&o(e)},{keepAuthInfo:!0,iotFunc:!0,uniqueNo:a.uniqueNo}),PJF.stm.IC_CARD_INFO_BAK={},PJF.stm.CUSTOM_INFO_BAK={},$.extend(!0,PJF.stm.IC_CARD_INFO_BAK,PJF.stm.IC_CARD_INFO),$.extend(!0,PJF.stm.CUSTOM_INFO_BAK,PJF.stm.CUSTOM_INFO),PJF.stm.IC_CARD_INFO_COR_BAK={},PJF.stm.CUSTOM_INFO_COR_BAK={},$.extend(!0,PJF.stm.IC_CARD_INFO_COR_BAK,PJF.stm.IC_CARD_INFO_COR),$.extend(!0,PJF.stm.CUSTOM_INFO_COR_BAK,PJF.stm.CUSTOM_INFO_COR),PJF.stm.util.clearAuthInfo(!0),PJF.stm.util.clearCardInfo(),PJF.event.publish("STM_EJECTCARD")},t.kdbPublish=function(o,a){var s={iotFunc:!0,
uniqueNo:"",coordinateX:PJF.otherInfo.globalParams.coordinateX,coordinateY:PJF.otherInfo.globalParams.coordinateY,angle:PJF.otherInfo.globalParams.angle};$.extend(s,o),PJF.stm.client.callClient("App_KDB","KDB_Publish",s,function(e){console.log("kdbPublish pubRes:"+JSON.stringify(e));var t,n=function(e){PJF.stm.KDB.confiscateDev({stmManage:PJF.stm.client.newKey,conReason:e.conReason,iotFunc:!0,uniqueNo:s.uniqueNo},function(t){a&&a(e)})};if(e.info&&e.info.robotId){var i={};o.robotIdList.forEach(function(t){t.robotIotId===e.info.robotId&&PJF.util.extend(i,t)}),PJF.util.extend(!0,o.stmManage,{cardkey_type:"Key",device_id:i.device_id,box_no:i.box_no,cardkey_no:i.key_no_to_send})}PJF.stm.client.newKey=o.stmManage,"DRV0000000"==(t=e.errorCode)||"DRVKDB0007"!=t&&"DRVKDB0001"!=t&&"DRVKDB0003"!=t&&-1!=t.indexOf("DRVKDB")?(PJF.communication.stmManageAjax({fwServiceId:"stm.doModifyCardKeySurplus",jsonData:PJF.stm.client.newKey}),
console.log("kdbPublish发盾返回错误码为:"+e.errorCode+",盾箱数量将减一。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newKey)),PJF.communication.stmManageAjax({fwServiceId:"stm.doReadCardKey",jsonData:PJF.stm.client.newKey,success:function(t){e.status?a&&a(e):(PJF.stm.client.newKey.recycle_type="Read",PJF.stm.client.newKey.recycle_msg="外设出盾失败，错误信息为:"+e.errorMsg,$.extend(e,{conReason:"外设出盾失败"}),n(e))},failure:function(t){e.status=0,e.errorMsg=t.BK_DESC,PJF.stm.client.newKey.recycle_type="Read",PJF.stm.client.newKey.recycle_msg=t.BK_DESC,$.extend(e,{conReason:t.BK_DESC}),n(e)}})):(console.log("kdbPublish发盾返回错误码为:"+e.errorCode+",盾箱数量将不变。doModifyCardKeySurplus参数为:"+JSON.stringify(PJF.stm.client.newKey)),a&&a(e))},function(t){var e={};return e.status=t.status,e.keyData=t.keyData,e.robotId=t.robotId,e})}}(PJF.stm.iot={}),PJF.namespace("PJF.stm.client"),function(t){PJF.stm.client.redefine=function(){i.forEach(function(t){t()})}
;var n,a=PJF.communication.fileSystem.getAppResourceDir().result,c=function(t){new PJF.ui.errorMessageBox({content:t,buttonConfs:[{style:"main",name:"确定",width:200,height:80,onClick:function(){template.loadPage("homepage")}}]})},e=PJF.communication.fileSystem.readImage(a+"webcache/AdBase_442000000_1.jpg"),l=e.success?e.result:"",i=[function(){var o=PJF.communication.player.PlaySoundByUrl;PJF.communication.player.PlaySoundByUrl=function(t,e){if("DA003"!=PJF.orgInfo.instSvrlLgPsnID){if(-1==t.indexOf("devprompt")&&(t=t.replace(new RegExp(".wav$","gm"),".mp3")),e&&"cn"!=PJF.i18n.getLanguage()&&PJF.otherInfo.MENU_ID&&PJF.constants.I18N_MENUS[PJF.i18n.getLanguage()]&&-1<PJF.constants.I18N_MENUS[PJF.i18n.getLanguage()].indexOf(PJF.otherInfo.MENU_ID)){var n=t.replace(/([^.]*)\.(wav|mp3)$/,"$1")+"_"+PJF.i18n.getLanguage()+".mp3",i=PJF.communication.fileSystem.getFileSize(a+n);console.log("getFileSize result:"+JSON.stringify(i)+",i18nPath:"+n),i.success&&(t=n)}console.log("客户端即将播放声音文件:"+t),
o.apply(PJF.communication.player,[t])}}},function(){if(PJF.util.supportHideWebView()){var e={};PJF.event.addSubscriber(PJF.stmEvent.PJF_STM_CALL_DEVICE,function(t){e[t]=!0}),PJF.event.addSubscriber(PJF.stmEvent.PJF_STM_CALL_DEVICE_BACK,function(t){delete e[t]}),PJF.communication.Tabs.CloseThisTab,PJF.communication.Tabs.CanCloseThisTab=function(){if(n)return n=!1,2;if(console.log("点击右上角隐藏stm webview"),!$.isEmptyObject(e)){for(var t in e)PJF.event.removeSubscriber(t);e={},PJF.stm.client.callbackList={}}return 2},PJF.event.addSubscriber(PJF.stmEvent.PJF_RELOAD_PADURL,function(t){PJF.stm.register.registerPad(t||"")})}},function(){var n=PJF.stm.ICMaker.cardIssue;PJF.stm.ICMaker.cardIssue=function(a,t){if(PJF.otherInfo.moduleParams.CDB&&"remote"==PJF.otherInfo.moduleParams.CDB.Apl_Tp_ID&&"ZNK"!=a.socialCard){var s=new PJF.ui.loading({msg:"",noIcon:!0,opacity:.1});if(a.ARQC){var e=PJF.util.formatDate(new Date,"yyyyMMddhhmmss");a.ARQC=$.extend(a.ARQC,{transDate:e.substr(0,8),
transTime:e.substr(8,16),transOper:PJF.userInfo.userCode}),"default"==a.ARQC.appType?a.pchAIDList="A000000333010101|A000000333010102|A000000333010103|A000000333010106":"1"==a.ARQC.appType?a.pchAIDList="A000000333010101":"2"==a.ARQC.appType&&(a.pchAIDList="A000000333010102"),a.pchInput=PJF.stm.ICMaker.genARQCpchInput(PJF.stm.ICMaker.decimal2Ans(a.ARQC.authAmt),PJF.stm.ICMaker.decimal2Ans(a.ARQC.otherAmt),a.ARQC.cType,a.ARQC.transDate,a.ARQC.transType,a.ARQC.transTime,a.ARQC.transOper)}var r=arguments;PJF.communication.devices.CallDevice("COMMON","resourceRequest",{devType:"CDB",timeout:120,robotIdList:a.robotIdList,_iotCall:!0,uniqueNo:a.uniqueNo},function(t){if(s&&s.destroy(),console.log("cdb resourceRequest data:"+t),(t=PJF.util.safeParse(t)).success){var e=PJF.util.safeParse(t.result).pchErrCode;if("DRV0000023"===e){var n=PJF.util.generateUUid()
;$("body").append('<div id="'+n+'"><div id="_cdbContent"><p class="pjf_stm_title">卡资源预约中，请稍候</p><img style="max-width: 8rem; max-height: 6rem;margin:0.5rem auto;display: block;" src="data:image/png;base64,'+l+'"><div class="pjf_stm_bottom" style="width: 100%; left: 0;"><span id="_cdbCancel"></span></div></div></div>');var i=new PJF.ui.window({dom:n,width:1e3,height:800,htmlDomId:"_cdbContent",domLoadedCallBack:function(){new PJF.ui.linkButton({dom:"_cdbCancel",style:"main",btnBgColor:"rgb(65,159,245)",textColor:"rgb(255,255,255)",name:"取消等待",onClick:function(){PJF.event.removeSubscriber(PJF.stm.client.events.RSV_RESULT),clearTimeout(o),PJF.communication.devices.CallDevice("COMMON","cancelQueue",{devType:"CDB",timeout:120,_iotCall:!0,uniqueNo:a.uniqueNo}),i.destroy(),$("#"+n).remove(),template.loadPage("homepage")}})}});PJF.event.onceSubscriber(PJF.stm.client.events.RSV_RESULT,function(t){clearTimeout(o),i.destroy(),$("#"+n).remove(),
"success"===(t=PJF.util.safeParse(t)).state?(PJF.util.extend(r[0],{robotIotId:t.info}),PJF.stm.iot.cdbIssue.apply(PJF.stm.iot,r)):c("发卡：资源调度失败，请稍后再试<br>"+t.state)});var o=setTimeout(function(){PJF.event.removeSubscriber(PJF.stm.client.events.RSV_RESULT),PJF.communication.devices.CallDevice("COMMON","cancelQueue",{devType:"CDB",timeout:120,_iotCall:!0,uniqueNo:a.uniqueNo}),i.destroy(),$("#"+n).remove(),c("发卡：资源调度超时，请稍后再试")},12e4)}else"DRV0000000"===e?PJF.stm.iot.cdbIssue.apply(PJF.stm.iot,r):c("发卡：预约资源失败，请稍后再试<br>错误码："+e)}else c("发卡：预约资源失败，请稍后再试")})}else n.apply(PJF.stm.ICMaker,arguments)}},function(){var e=PJF.stm.KDB.publish;PJF.stm.KDB.publish=function(a,t){if(PJF.otherInfo.moduleParams.KDB&&"remote"==PJF.otherInfo.moduleParams.KDB.Apl_Tp_ID){var s=new PJF.ui.loading({msg:"",noIcon:!0,opacity:.1}),r=arguments;PJF.communication.devices.CallDevice("COMMON","resourceRequest",{devType:"KDB",timeout:120,robotIdList:a.robotIdList,_iotCall:!0,uniqueNo:a.uniqueNo},function(t){
if(s&&s.destroy(),console.log("kdb resourceRequest data:"+t),(t=PJF.util.safeParse(t)).success){var e=PJF.util.safeParse(t.result).pchErrCode;if("DRV0000023"===e){var n=PJF.util.generateUUid();$("body").append('<div id="'+n+'"><div id="_kdbContent"><p class="pjf_stm_title">盾资源预约中，请稍候</p><img style="max-width: 8rem; max-height: 6rem;margin:0.5rem auto;display: block;" src="data:image/png;base64,'+l+'"><div class="pjf_stm_bottom" style="width: 100%; left: 0;"><span id="_kdbCancel"></span></div></div></div>');var i=new PJF.ui.window({dom:n,width:1e3,height:800,htmlDomId:"_kdbContent",domLoadedCallBack:function(){new PJF.ui.linkButton({dom:"_kdbCancel",style:"main",btnBgColor:"rgb(65,159,245)",textColor:"rgb(255,255,255)",name:"取消等待",onClick:function(){PJF.event.removeSubscriber(PJF.stm.client.events.RSV_RESULT),clearTimeout(o),PJF.communication.devices.CallDevice("COMMON","cancelQueue",{devType:"KDB",timeout:120,_iotCall:!0,uniqueNo:a.uniqueNo}),i.destroy(),$("#"+n).remove(),
template.loadPage("homepage")}})}});PJF.event.onceSubscriber(PJF.stm.client.events.RSV_RESULT,function(t){clearTimeout(o),i.destroy(),$("#"+n).remove(),"success"===(t=PJF.util.safeParse(t)).state?(PJF.util.extend(r[0],{robotIotId:t.info}),PJF.stm.iot.kdbPublish.apply(PJF.stm.iot,r)):c("发盾：资源调度失败，请稍后再试<br>"+t.state)});var o=setTimeout(function(){PJF.event.removeSubscriber(PJF.stm.client.events.RSV_RESULT),PJF.communication.devices.CallDevice("COMMON","cancelQueue",{devType:"KDB",timeout:120,_iotCall:!0,uniqueNo:a.uniqueNo}),i.destroy(),$("#"+n).remove(),c("发盾：资源调度超时，请稍后再试")},12e4)}else"DRV0000000"===e?PJF.stm.iot.kdbPublish.apply(PJF.stm.iot,r):c("发盾：预约资源失败，请稍后再试<br>错误码："+e)}else c("发盾：预约资源失败，请稍后再试")})}else e.apply(PJF.stm.KDB,arguments)}},function(){var n=PJF.stm.ICMaker.ejectCard;PJF.stm.ICMaker.ejectCard=function(t,e){e=$.extend({},e),
PJF.otherInfo.moduleParams.CDB&&"remote"==PJF.otherInfo.moduleParams.CDB.Apl_Tp_ID&&e.iotFunc?PJF.stm.iot.cdbEject.apply(PJF.stm.iot,arguments):n.apply(PJF.stm.ICMaker,arguments)}}]}(),PJF.namespace("PJF.i18n"),function(){var r,a="cn",c=[];PJF.i18n={init:function(){return r||(Vue.use(VueI18n),r=new VueI18n({locale:a,messages:PJF.i18n.resource,fallbackLocale:a,dateTimeFormats:{cn:{short:{year:"numeric",month:"short",day:"numeric"},long:{year:"numeric",month:"short",day:"numeric",weekday:"long"}},en:{short:{year:"numeric",month:"short",day:"numeric"},long:{year:"numeric",month:"short",day:"numeric",weekday:"short"}}}}),c.forEach(function(t){PJF.i18n.addI18nResource(t.lan,t.appId,t.obj)}),PJF.i18n.loadCss(),r)},getVueI18n:function(){return r},setLanguage:function(t){a=t,r&&(r.locale=t),PJF.i18n.fitCss()},getLanguage:function(){return a},addI18nResource:function(t,e,n){if(e&&n)if(r){e=e.split(".");for(var i={},o=0,a=i;o<e.length;o++)a[e[o]]=o==e.length-1?n:{},a=a[e[o]]
;var s=PJF.i18n.getI18nResource("",t);$.isEmptyObject(s)||(i=$.extend(!0,s,i)),r.mergeLocaleMessage(t,i)}else c.push({lan:t,appId:e,obj:n})},getI18nResource:function(t,e){e=e||a;var n=r.t(t,e);if(n==t){var i=r.getLocaleMessage(e);if(t&&i){t=t.split(".");for(var o=0;o<t.length;o++){if(!i[t[o]]){i=null;break}i=i[t[o]]}}return i}return n}}}(),function(){var css=function(){
/**
    @preserve
    <!-- 英文 -->
    <style reg = "en">
    .template_navbtn_home {
      background-image: url(/bosWeb/css/stmimg/homepageBtn_en.png);
    }
    </style>
   <!-- 繁体 -->
   <style reg = "fan">
   .template_navbtn_home {
      background-image: url(/bosWeb/css/stmimg/homepageBtn_fan.png);
    }
   </style>
    <!-- 维文 -->
    <style reg = "wei">
    body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,input,textarea,p,th,td {
      font-family: 'ALKATIP Basma Tom',Arial,'Microsoft Yahei','微软雅黑',sans-serif;
    }
    </style>
    <style reg = "wei" menuid = "true">
    .stm-btn-main .stm-btn-text {
      font-size: 0.2rem;
      line-height: 0.25rem;
    }
    </style>
    <style pjf-if = "PJF.otherInfo.isSelfBank || (PJF.otherInfo.globalParams.useNewViewStatus === '01')">
    .template_top {
      background: #fff;
    }
    .template_posdate {
      color: #666666;
    }
    .template_pos {
      font-size: .16rem;
      color: #222222;
    }
    .template_date .template_version_id .template_dev_id {
      font-size: .14rem;
    }
    .template_welcomeText {
      width: 0;
    }
    .template_middle {
      margin: 0 .1rem;
    }
    .template_search {
      width: 5.69rem;
      height: .56rem;
      background: #F0F0F0;
      border-radius: 100px;
      line-height: .56rem;
    }
    .template_searchHint {
      width: auto;
      flex: 1;
      padding-left: 0.3rem;
      margin-left: 0;
    }
    .template_searchContent {
      top: .56rem;
    }
    </style>
   <style pjf-if = "PJF.orgInfo.instSvrlLgPsnID == 'DA003'">
   .errorMsgbox_content_text_content {
    display: inline-block;
    text-align: left;
    word-break: keep-all;
    word-wrap: break-word;
    width: 100%;
    }
   </style>
  */}.toString().match(/^[\s\S]*\/\*{2}([\s\S]*)\*\//)[1].replace(/(?:<style([^>]*?)>([\s\S]*?)<\/style>)/gi,function(t,e,n){return e&&n?"<style "+e+' type = "text/css" pjfI18nCss = "true">'+n+"</style>":""}).replace("@preserve","");PJF.i18n.loadCss=function(){$(css).appendTo(document.head),PJF.i18n.defineMenuId(),PJF.i18n.fitCss()},PJF.i18n.fitCss=function(){var i18nCssDoms=document.querySelectorAll('style[pjfI18nCss="true"]'),lan=PJF.i18n.getLanguage();Array.prototype.forEach.call(i18nCssDoms,function(style){var reg=style.getAttribute("reg"),pjfIf=style.getAttribute("pjf-if");if(reg&&new RegExp(reg).test(lan)){var whiteMenuIds=style.getAttribute("menuid")||"";"true"==whiteMenuIds&&(whiteMenuIds=PJF.constants.I18N_MENUS[lan]||""),style.disabled=!!whiteMenuIds&&!whiteMenuIds.split(",").some(function(t){return PJF.otherInfo.MENU_ID==t})}else if(pjfIf)try{eval(pjfIf)?style.disabled=!1:style.disabled=!0}catch(t){console.log("pjf-if error:",t.message)}else style.disabled=!0})},
PJF.i18n.defineMenuId=function(){PJF.otherInfo=PJF.otherInfo||{};var e=PJF.otherInfo.MENU_ID;Object.defineProperty(PJF.otherInfo,"MENU_ID",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){t===e||t!=t&&e!=e||(e=t,PJF.i18n.fitCss())}})}}(),PJF.i18n.resource={cn:{pjfI18n:{devId:"设备编号",devVersion:"设备版本",selectRequired:"该项为必填项",takeIcCardTip:"请取走您的银行卡",popIcCardTip:"卡槽已经有卡，请点弹出按钮取出卡",popIcCardBtn:"弹卡",loadingMsg:"业务正在处理中，请稍候……",detailMsg:"详细信息",arqcMsg:"设备正在处理中",errorSerNum:"全局跟踪号：",errorKeyword:"暂时未能处理您的请求，请联系大堂经理。"}},en:{pjfI18n:{devId:"dev Id",devVersion:"dev version",selectRequired:"Required fields",takeIcCardTip:"Please take your card",popIcCardTip:"Please click Pop The Card button and insert the card again",popIcCardBtn:"Pop The Card",loadingMsg:"In Progress",detailMsg:"Detail Message",arqcMsg:"In Progress",errorSerNum:"Series number:",
obTimoutTip:"Online Banking Account will automatically log out after counting down for 10 seconds.Please touch the screen to continue."}},wei:{},fan:{pjfI18n:{devId:"設備編號",devVersion:"設備版本",selectRequired:"該項為必輸項",takeIcCardTip:"請拿走你的銀行卡",popIcCardTip:"卡槽已經有卡，請點擊彈出按鈕取走卡",popIcCardBtn:"彈卡",loadingMsg:"業務正在處理中，請稍候",detailMsg:"詳細信息",arqcMsg:"設備正在處理中",errorSerNum:"全局跟蹤號：",errorKeyword:"暫時未能處理您的請求，請聯繫大堂經理。",obTimoutTip:"網上銀行戶口將於10秒倒數計時結束後自動退出，請點擊屏幕繼續。"}}},PJF.ui.animateLabel=PJF.extend(PJF.ui.component,{init:function(t){this.options={orient:"horizontal",orientClass:"pjf-animateLabel-goRight"},$.extend(this.options,t),this.initHtml(),this.adjustCSS(),this.bindEvent()},initHtml:function(){this.com.append(['<div class="pjf-animateLabel-frame">','<div class="pjf-animateLabel-cont"></div>','<div class="pjf-animateLabel-img"></div>',"</div>"].join("")),this.frame=this.com.find(".pjf-animateLabel-frame:first"),this.cont=this.com.find(".pjf-animateLabel-cont:first"),
this.icon=this.com.find(".pjf-animateLabel-img:first")},adjustCSS:function(){var t=this.options;"vertical"===t.orient&&(t.orientClass="pjf-animateLabel-goBottom"),t.width&&this.frame.width(t.width/PJF.constants.DEFAULT_FONTSIZE+"rem"),t.height&&this.frame.height(t.height/PJF.constants.DEFAULT_FONTSIZE+"rem"),!1===t.showBorder&&this.cont.css({border:"none"}),!1===t.showBackground&&this.cont.css({background:"none"});var e=t.height/PJF.constants.DEFAULT_FONTSIZE+"rem";"vertical"===t.orient&&(e=t.width/PJF.constants.DEFAULT_FONTSIZE+"rem"),t.iconUrl&&this.icon.css("background-image","url("+t.iconUrl+")"),this.icon.height(e),this.icon.width(e)},bindEvent:function(){var n=this,i=this.options.orientClass;this.icon.on("click",function(){$(this).hasClass(i)?(n.icon.removeClass(i),n.cont.stop().fadeOut(1500)):(n._onClickIcon(),n.options.async||(n.icon.addClass(i),n.cont.stop().fadeIn(1500)))}),this.icon.on("transitionend",function(){var t=$(this).data("runOnce"),e=$(this).hasClass(i)
;t?$(this).removeData("runOnce"):(e?(n.options.async||n.setContent(n.options.content),n._onAnimateEnd()):n.setContent(""),$(this).data("runOnce",!0))})},_onClickIcon:function(){this.options.onClickIcon&&this.options.onClickIcon.call()},_onAnimateEnd:function(){this.options.onAnimateEnd&&this.options.onAnimateEnd.call()}}),PJF.apply(PJF.ui.animateLabel.prototype,{setContent:function(t){this.cont.html(t)},showContent:function(){var t=this.options.orientClass;this.icon.addClass(t),this.cont.stop().fadeIn(1500)},getClassName:function(){return"PJF.ui.animateLabel"},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null}}),PJF.ui.linkButton=PJF.extend(PJF.ui.component,{dom:null,specialHandlerMap:{"auth-code":"authCodeClickHandler","icon-cycle":"iconCycleClickHandler",group:"groupBtnClickHandler","pag-btn":"pagBtnClickHandler","icon-switch":"iconSwitchBtnClickHandler"},specialInitHandlerMap:{main:"mainBtnInitHandler"},specialDomCreateHandlerMap:{},
specialInitedHandlerMap:{"icon-switch":"iconSwitchInitedHandler","auth-code":"authCodeInitedHandler"},specialStatusChangeHandlerMap:{},btnGroupMap:{},init:function(t){var e=this,n={dom:t.dom,text:t.name,authCodeRepeatText:t.authCodeRepeatText,iconUrl:t.iconUrl,leftIconUrl:t.leftIconUrl,choosedUrl:t.choosedUrl,disabledIconUrl:t.disabledIconUrl,disabled:t.disabled,handler:t.onClick,href:t.href,isRepeat:void 0===t.isRepeat||t.isRepeat,style:t.style||"default",fontSize:t.fontSize,appendStyle:t.appendStyle,bgColor:t.bgColor,textColor:t.textColor,disabledTextColor:t.disabledTextColor,showBorder:t.showBorder,delayTime:t.delayTime||1e3,align:t.align,width:t.width,height:t.height,imgTextMargin:t.imgTextMargin,imgWidth:t.imgWidth,imgHeight:t.imgHeight,textAlign:t.textAlign,appendClass:t.appendClass,groupId:t.groupId,switchBtnchecked:t.switchBtnchecked,authCodeTime:t.authCodeTime||60,groupClickHandler:t.groupClickHandler,menuId:t.menuId,btnBgColor:t.btnBgColor,
switchBtnDisableInfo:t.switchBtnDisableInfo||"已签约",beforeClickHandler:t.beforeClickHandler};n.iconUrl=PJF.util.addAtchBtchNoToUrl(n.iconUrl),n.leftIconUrl=PJF.util.addAtchBtchNoToUrl(n.leftIconUrl),n.disabledIconUrl=PJF.util.addAtchBtchNoToUrl(n.disabledIconUrl),this.p=n,this.specialInitHandlerMap[n.style]&&this[this.specialInitHandlerMap[n.style]](),this.createBtnDom(n),this.adjustStyle(),this.regClickHandler(n.handler),n.disabled&&0<this.com.length&&this.disable(),void 0!==n.groupId&&(this.btnGroupMap[n.groupId]=this.btnGroupMap[n.groupId]||[],this.btnGroupMap[n.groupId].push(this),n.groupClickHandler&&(this.groupClickHandlerWrapper=function(){n.groupClickHandler.apply(e,Array.prototype.slice.call(arguments))},PJF.event.addSubscriber("GROUP_CLICK_"+n.groupId,this.groupClickHandlerWrapper))),this.specialInitedHandlerMap[n.style]&&this[this.specialInitedHandlerMap[n.style]]()},authCodeInitedHandler:function(){this.com.css("background","-ms-linear-gradient(top,#a5d3f8,#43a2fb)"),
this.com.find(".stm-btn-text").css("color","white"),this.com.find(".stm-btn-text").css("text-shadow","0px 0px 0px #666")},mainBtnInitHandler:function(){this.p.bgColor=void 0},iconSwitchInitedHandler:function(){var e,t,n=this.p.switchBtnDisableInfo;$('<span class="icon-switch-status-desc">'+n+"</span>").appendTo(this.com),this.checkboxImg=$('<span class="stm-btn-icon-switch-icon"></span>').appendTo(this.com),PJF.apply(this,{getValue:(t=this,function(){return t.checkboxImg.hasClass("stm-btn-icon-switch-checked-fake")}),setValue:(e=this,function(t){t?e.checkboxImg.removeClass("stm-btn-icon-switch-checked-fake").addClass("stm-btn-icon-switch-checked-fake"):e.checkboxImg.removeClass("stm-btn-icon-switch-checked-fake")})}),this.p.switchBtnchecked&&(this.p.disabled?this.checkboxImg.remove():this.setValue(!0))},iconCycleCreateHandler:function(t){var e=[];e.push('<span class="btn-content">'),t.iconUrl&&e.push('<img class="stm-btn-img" src="'+t.iconUrl+'"/>'),e.push("</span>");var n=t.text||""
;e.push('<p class="stm-btn-text">'+n+"</p>"),this.com.append(e.join(""))},createBtnDom:function(t){var e=this.com,n=t.text||"",i=t.style;if(e.addClass("stm-btn stm-btn-"+i),t.leftIconUrl&&e.prepend('<img src="'+t.leftIconUrl+'" class = "stm-btn-left-icon" >'),t.appendClass&&e.addClass(t.appendClass),t.href&&e.attr("href",t.href),void 0!==t.btnBgColor?e.css("background-color",t.btnBgColor):e.addClass("stm-btn-defaultBg"),this.specialDomCreateHandlerMap[i])this[this.specialDomCreateHandlerMap[i]](t);else{var o=[];o.push('<span class="btn-content">'),t.iconUrl&&o.push('<img class="stm-btn-img" src="'+t.iconUrl+'"/>'),"default"===i&&2==n.length&&(n=n.substring(0,1)+"&nbsp;&nbsp;"+n.substring(1,2)),o.push('<p class="stm-btn-text">'+n+"</p>"),o.push("</span>"),e.append(o.join(""))}},adjustStyle:function(){this.p.width&&this.com.css("width",this.p.width/PJF.constants.DEFAULT_FONTSIZE+"rem"),this.p.height&&this.com.css("height",this.p.height/PJF.constants.DEFAULT_FONTSIZE+"rem"),
this.p.fontSize&&this.com.find(".stm-btn-text").css("font-size",this.p.fontSize/PJF.constants.DEFAULT_FONTSIZE+"rem");var t=this.imgContainer=$(".stm-btn-img",this.com);this.p.imgWidth&&("auto"==this.p.imgWidth?t.css("width",this.p.imgWidth):t.css("width",this.p.imgWidth/PJF.constants.DEFAULT_FONTSIZE+"rem")),this.p.imgHeight&&("auto"==this.p.imgHeight?t.css("height",this.p.imgHeight):t.css("height",this.p.imgHeight/PJF.constants.DEFAULT_FONTSIZE+"rem")),"icon-cycle"==this.p.style&&this.com.removeClass("stm-btn-bg-none").addClass("stm-btn-bg-none"),this.p.textColor&&this.com.find(".stm-btn-text").css("color",this.p.textColor),null!=this.p.imgTextMargin&&this.com.find(".stm-btn-img").css("margin-bottom",this.p.imgTextMargin+"px"),this.p.appendStyle&&this.com.addClass("stm-btn-"+this.p.style+"-"+this.p.appendStyle),!1===this.p.showBorder&&this.com.css("border","none")},updateBtnBackGroundColor:function(t){this.com.css("background-color",t)},commonClickAfterHandler:function(t){
var e=this.p,n=e.style,i=this.specialHandlerMap[n];i&&this[i](),e.groupClickHandler&&e.groupId&&PJF.event.publish("GROUP_CLICK_"+e.groupId,this),null!=e.menuId&&PJF.event.publish("STM_MENU_CLICK",e.menuId,t,this)},authCodeClickHandler:function(){this.disable();var t=this.p.authCodeTime,e=this,n=this.p.authCodeRepeatText||this.p.text;0<t&&(e.updateButtonText(n+" ( "+(t<10?"0"+t:t)+" ) "),e.com.css("background","-ms-linear-gradient(top, #A8A8A8,#A8A8A8)"),e.com.find(".stm-btn-text").css("color","#4F4F4F"),t--);var i=setInterval(function(){if(0==t)return e.updateButtonText(n),e.com.css("background","-ms-linear-gradient(top, #a5d3f8,  #43a2fb)"),e.com.find(".stm-btn-text").css("color","white"),clearInterval(i),void e.enable();e.updateButtonText(n+" ( "+(t<10?"0"+t:t)+" ) "),t--},1e3);this.intervalId=i},iconCycleClickHandler:function(){this.com.removeClass("stm-btn-icon-cycle-curr").addClass("stm-btn-icon-cycle-curr")
;for(var t=this.btnGroupMap[this.p.groupId]||[],e=0,n=t.length;e<n;e++)t[e].com&&(t[e]!==this?(t[e].com.removeClass("stm-btn-icon-cycle-curr"),t[e].imgContainer.attr("src",t[e].p.iconUrl)):t[e].imgContainer.attr("src",t[e].p.choosedUrl))},groupBtnClickHandler:function(){for(var t=this.btnGroupMap[this.p.groupId]||[],e=0,n=t.length;e<n;e++)t[e].com&&(t[e]!==this?t[e].com.removeClass("stm-btn-group-curr"):t[e].com.removeClass("stm-btn-group-curr").addClass("stm-btn-group-curr"))},pagBtnClickHandler:function(){},iconSwitchBtnClickHandler:function(){this.isDisabled()||this.checkboxImg.toggleClass("stm-btn-icon-switch-checked-fake")},commonStatusChangeHandler:function(t){var e=this.specialStatusChangeHandlerMap[this.p.style];if(e&&this[e])this[e](t);else{var n=this.com.find("img.stm-btn-img");t?(this.p.disabledIconUrl&&this.p.iconUrl&&n.attr("src",this.p.iconUrl),
this.p.disabledTextColor?this.p.textColor?this.com.find(".stm-btn-text").css("color",this.p.textColor):this.com.find(".stm-btn-text").css("color",""):this.p.textColor&&this.com.find(".stm-btn-text").css("color",this.p.textColor)):(this.p.disabledIconUrl&&n.attr("src",this.p.disabledIconUrl),this.p.disabledTextColor?this.com.find(".stm-btn-text").css("color",this.p.disabledTextColor):this.com.find(".stm-btn-text").css("color",""))}},commonClickBeforeHandler:function(t){return null!=this.p.menuId&&PJF.event.publish("STM_MENU_CLICK_BEFOREHANDLER",this.p.menuId,t,this),!this.p.beforeClickHandler||this.p.beforeClickHandler()},regClickHandler:function(t){var a,s=this;this.com.off("click"),this.p.originHandler=t,this.p.handler=(a=t,function(t,e,n,i){if(s.isDisabled())t&&t.preventDefault();else{if(!n){PJF.constants.lastClickBtn=PJF.constants.lastClickBtn||0;var o=(new Date).getTime()-PJF.constants.lastClickBtn;if(PJF.constants.lastClickBtn=(new Date).getTime(),
o<PJF.constants.BUTTON_REPEAT_TIME)return console.log("重复快速点击,此次点击无效:"+s.p.dom+","+s.p.text),void(t&&t.preventDefault())}if(!1!==s.commonClickBeforeHandler(t)){if(console.log("stm button id "+s.p.dom+","+s.p.text+" clicked"),s.p.isRepeat||s.disable(),e||PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav"),!i&&a&&!1===a.call(s,t))return!1;s.com&&s.com.trigger(PJF.stmEvent.LINKBTN_CLICK),s.commonClickAfterHandler(t),t&&t.stopPropagation()}}}),this.com.on("click",this.p.handler)},bindClickHandler:function(t){this.regClickHandler(t)},triggerBtnHandler:function(t){this.com.trigger("click",[!0,!0,t])},getClassName:function(){return"PJF.ui.linkButton"}}),PJF.apply(PJF.ui.linkButton.prototype,{isDisabled:function(){return!0===this.disableStatus},isReadyOnly:function(){return!1},isDisplay:function(){return!1!==this.visibleStatus},disable:function(){"image"!=this.p.style&&this.com.removeClass("stm-btn-disabled").addClass("stm-btn-disabled"),this.disableStatus=!0,
this.checkboxImg&&this.checkboxImg.remove(),this.commonStatusChangeHandler(!1)},readOnly:function(t){var e=this,n=this.com;t?(e.overlayer=$('<div class="pjf_stmbutton_overlayer"></div>'),e.overlayer.bind("click",function(t){return e.overlayer.focus(),!1}),n.append(e.overlayer)):n.find(".pjf_stmbutton_overlayer").remove()},enable:function(){this.com.removeClass("stm-btn-disabled"),this.disableStatus=!1,this.commonStatusChangeHandler(!0)},setVisible:function(t){t?(this.com.show(),this.visibleStatus=!0):(this.com.hide(),this.visibleStatus=!1)},updateButtonText:function(t){var e=this.com.find("p.stm-btn-text");e.length<1?alert("Error:未找到文本节点！"):(e.html(t),this.p.text=t)},updateIconSwitchText:function(t){this.com.find(".icon-switch-status-desc").text(t)},getButtonText:function(){return this.p.text},destroy:function(){if(PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.groupClickHandlerWrapper&&PJF.event.removeSubscriber("GROUP_CLICK_"+this.p.groupId,this.groupClickHandlerWrapper),
this.groupClickHandlerWrapper=null,this.p.groupId){var t=this.btnGroupMap[this.p.groupId]||[],e=t.indexOf(this);-1!=e&&t.splice(e,1)}this.com=null,clearInterval(this.intervalId)},validateParam:function(t){return t.dom?document.getElementById(t.dom)?(this.dom=t.dom,!0):(alert("提示：linkButton的dom属性 "+t.dom+" 指定的容器不存在！"),!1):(alert("提示：linkButton的dom属性不能为空！"),!1)}}),PJF.ui.list=PJF.extend(PJF.ui.component,{dom:null,init:function(t){if(t=this.params=this.conf=PJF.apply({data:[],url:null,queryParams:t.queryParam||t.queryParams,timeOut:PJF.constants.AJAX_TIMEOUT,defaultSelectedItems:[],currentSelectedItems:[],singleSelect:!0,height:null,rowTpl:null,onClick:null,dataFilter:null,rowFormatter:null,onLoadSuccess:null},t),this.paginationOptions={pageSize:t.pageSize||5,totalPath:t.totalPath||"total",rowsPath:t.rowsPath||"rows",pageSizeParamName:t.pageSizeParamName||"REC_IN_PAGE",pageNumberParamName:t.pageNumberParamName||"PAGE_JUMP",
paginationParamsLevelName:t.paginationParamsLevelName||"_pagination",isLocalPagination:t.isLocalPagination&&!t.url,singlePageMode:t.singlePageMode,pageChangeHandler:t.pageChangeHandler,currentPage:t.currentPage||0,totalPage:t.currentPage?t.currentPage+1:1,total:0},this.isInit=!1,this.conf.currentSelectedItems=$.extend([],this.conf.defaultSelectedItems),this.createListBasicDom(),this.paginationOptions.isLocalPagination){this.paginationOptions.currentPage=1;var e=this._dataFilter(this.conf.data);this._loadData(e,{direction:!0})}else this._loadData(this.conf.data,{direction:!0});this.regEvent()},createListBasicDom:function(){this.com.addClass("stm-list-container");this.com.append(["\x3c!-- 外层遮罩 用于遮挡滚动条 --\x3e",'<div class="stm-list-outer-mask">',"\x3c!-- 滚动条将被遮挡 内部存放具体的列表内容 --\x3e",'<div class="stm-list-inner-mask"></div>',"\x3c!-- 加载提示 --\x3e",'<div class="stm-list-loading-container"><span class="stm-list-loading">加载中...</span></div>',"</div>"].join("")),
this.conf.height&&this.com.height(this.conf.height/PJF.constants.DEFAULT_FONTSIZE+"rem"),this.conf.width&&this.com.width(this.conf.width/PJF.constants.DEFAULT_FONTSIZE+"rem");var t=parseInt(this.com.width(),10),e=parseInt(this.com.height(),10);this.outerMask=$("div.stm-list-outer-mask",this.com),this.listContainer=$("div.stm-list-inner-mask",this.com),this.loading=$("div.stm-list-loading-container",this.com),this.outerMask.css({width:t-17+"px",height:e+"px"}),PJF.util.deviceType.icm?this.listContainer.css({width:t-17+"px",height:e+"px"}):this.listContainer.css({width:t+"px",height:e+"px",paddingRight:"17px"}),this.isInit=!0},setDefaultSelected:function(t){var e=this.paginationOptions,n=0;e.isLocalPagination&&(n+=(e.currentPage-1)*e.pageSize),e.singlePageMode&&(n=0);for(var i={},o=0,a=(t=t||[]).length;o<a;o++)i["item_"+t[o]]=!0;var s=this;$("div.list-item",this.com).each(function(){var t=$(this),e=t.attr("data-index");e=parseInt(e,10)+n,i["item_"+e]&&(t.addClass("list-item-curr"),
s.currentListItem=this)})},_loadData:function(t,e){this.conf.url?(this.conf.data=[],this._handleListLoading(e)):(this.listContainer.html(""),this.renderRows(t),this.updatePagination(),this.conf.onLoadSuccess&&this.conf.onLoadSuccess.call(this))},loadData:function(t,e){this.listContainer.empty(),this.conf.url="";var n=this.paginationOptions;n.currentPage=1,n.totalPage=1,n.total=0,this.conf.data=t,this.conf.currentSelectedItems=$.extend([],this.conf.defaultSelectedItems),this._loadData(this._dataFilter(t),{direction:!0}),this.updatePagination()},renderRows:function(t,e){var n=this.conf;n.dataFilter&&(t=n.dataFilter(t));var i=this.combinateRowDom(t,e);e?this.listContainer.append(i):this.listContainer.html(i),this.currentListItem=null,this.setDefaultSelected(n.currentSelectedItems)},combinateRowDom:function(t,e){if(!t)return"";var n=this.conf,i=[],o=n.rowFormatter,a=n.rowTpl
;/^[a-zA-Z0-9_]+$/.test(a)&&$("#"+a).length&&(a=document.getElementById(a).innerHTML||document.getElementById(a).text);for(var s=!0===e?this.conf.data.length:0,r=0,c=t.length;r<c;r++)i.push('<div class="list-item" data-index="'+(r+s)+'">'),o?i.push(o(r,t[r],t)):a?i.push(PJF.html.template(a,t[r])):i.push(" "),i.push("</div>");return i.join("")},regEvent:function(){var r=this;this.listContainer.on("click","div.list-item",function(){var t=$(this),e=t.attr("data-index");e=parseInt(e,10);var n=r.paginationOptions,i=0;if(n.isLocalPagination&&(i=(n.currentPage-1)*n.pageSize),e+=i,!1!==r.conf.singleSelect)r.currentListItem===this?(t.removeClass("list-item-curr"),n.isLocalPagination&&(r.conf.currentSelectedItems=[]),r.currentListItem=null,r.conf.onClick&&r.conf.onClick(e,r.conf.data[e],!1)):($(r.currentListItem).removeClass("list-item-curr"),t.addClass("list-item-curr"),n.isLocalPagination&&(r.conf.currentSelectedItems=[e]),r.currentListItem=this,
r.conf.onClick&&r.conf.onClick(e,r.conf.data[e],!0));else{if(t.toggleClass("list-item-curr"),n.isLocalPagination)if(t.hasClass("list-item-curr")){for(var o=!1,a=0,s=r.conf.currentSelectedItems.length;a<s;a++)r.conf.currentSelectedItems[a]===e&&(o=!0);o||r.conf.currentSelectedItems.push(e),r.conf.currentSelectedItems.sort()}else for(a=0,s=r.conf.currentSelectedItems.length;a<s;a++)r.conf.currentSelectedItems[a]===e&&r.conf.currentSelectedItems.splice(a,1);r.conf.onClick&&r.conf.onClick(e,r.conf.data[e],t.hasClass("list-item-curr"))}})},_handleListLoading:function(i){var t=this.conf;if(t.url){var o=this,e=this.prepareParams(i.direction);!1!==e&&(this._showLoading(),PJF.communication.cpsJsonReq($.extend({},t.queryParams,{url:t.url,dataType:"json",data:e,async:!0,type:"post",timeout:t.timeOut,success:function(t,e,n){try{o.conf.data=rows=o._dataFilter(t),rows&&0<rows.length&&(o.paginationOptions.currentPage+=i.direction?1:-1),o.renderRows(rows,!1),o.updatePagination()}catch(t){
console.log("error: "+t.message)}o._hideLoading(),o.conf.onLoadSuccess&&o.conf.onLoadSuccess.call(o)},failure:function(t){new PJF.ui.errorMessageBox({data:t}),o._hideLoading()}})))}else{var n=this.paginationOptions;if(n.isLocalPagination){var a=n.currentPage,s=n.totalPage;if((a+=i.direction?1:-1)<1||s<a)return void console.log("翻页结束：currentPage = "+a+" and totalPage = "+s+" direction = "+i.direction);this.paginationOptions.currentPage+=i.direction?1:-1,this._loadData(this._dataFilter(this.conf.data))}}},_showLoading:function(){this.isLoading=!0,this.loading.css("display","block")},_hideLoading:function(){this.isLoading=!1,this.loading.css("display","none")},_dataFilter:function(data){var obj={},paginationOptions=this.paginationOptions;if(data)if(data instanceof Array)obj={rows:data,total:data.length};else{this.___data=data;try{obj.rows=eval("this.___data."+paginationOptions.rowsPath)}catch(t){console.warn("当前数据 无法根据rowsPath("+paginationOptions.rowsPath+")取到行数据"),obj.rows=[]}
obj.rows&&void 0===obj.rows.length&&(obj.rows=[obj.rows]);try{obj.total=eval("this.___data."+paginationOptions.totalPath)}catch(t){console.warn("当前数据 无法根据rowsPath("+paginationOptions.rowsPath+")取到总记录数"),obj.total=0}}else obj={rows:[],total:0};try{paginationOptions.total=parseInt(obj.total,10)}catch(t){paginationOptions.total=0}if(paginationOptions.totalPage=Math.ceil(paginationOptions.total/paginationOptions.pageSize),paginationOptions.isLocalPagination){var startIndex=(paginationOptions.currentPage-1)*paginationOptions.pageSize;return obj.rows.slice(startIndex,startIndex+paginationOptions.pageSize)}return obj.rows},prepareParams:function(direction){var conf=this.conf,paginationOptions=this.paginationOptions,params=conf.queryParams||{},reqParams={};PJF.apply(reqParams,params),reqParams.jsonData=reqParams.jsonData||{},"string"==typeof reqParams.jsonData&&(reqParams.jsonData=eval("("+reqParams.jsonData+")"))
;var paginationInfo={},currentPage=paginationOptions.currentPage,totalPage=paginationOptions.totalPage;return currentPage+=direction?1:-1,currentPage<1||totalPage<currentPage?(console.log("翻页结束：currentPage = "+currentPage+" and totalPage = "+totalPage+" direction = "+direction),!1):(paginationInfo[paginationOptions.pageSizeParamName]=paginationOptions.pageSize,paginationInfo[paginationOptions.pageNumberParamName]=currentPage,"."==paginationOptions.paginationParamsLevelName?PJF.apply(reqParams,paginationInfo):reqParams.jsonData[paginationOptions.paginationParamsLevelName]=paginationInfo,reqParams.jsonData=PJF.util.json2str(reqParams.jsonData),conf.queryParams=reqParams,console.log("will req = "+currentPage),reqParams)},addPaginationBar:function(t,e,n){var i,o,a=this.paginationOptions,s=this;t&&a.prevBtn===t?alert("重复绑定上一页按钮"):e&&a.nextBtn===e?alert("重复绑定下一页按钮"):(t&&(t.bindClickHandler((i=t.p.originHandler,function(){i&&i.call(t),s._handleListLoading({direction:!1})})),a.prevBtn=t),
e&&(e.bindClickHandler((o=e.p.originHandler,function(){o&&o.call(e),s._handleListLoading({direction:!0})})),a.nextBtn=e),n&&(a.paginationDesc=$("#"+n)),this.updatePagination())},updatePagination:function(){var t=this.paginationOptions;if(!t.isLocalPagination&&!this.conf.url)return t.prevBtn&&t.prevBtn.disable(),t.nextBtn&&t.nextBtn.disable(),void(t.paginationDesc&&t.paginationDesc.html("1/1"));var e=t.currentPage||1,n=t.totalPage||1;1<e?t.prevBtn&&t.prevBtn.enable():t.prevBtn&&t.prevBtn.disable(),e<n?t.nextBtn&&t.nextBtn.enable():t.nextBtn&&t.nextBtn.disable(),t.paginationDesc&&t.paginationDesc.html(e+"/"+n),this.paginationOptions.pageChangeHandler&&this.paginationOptions.pageChangeHandler.call(this,e,n)},nextPage:function(){this._handleListLoading({direction:!0})},prevPage:function(){this._handleListLoading({direction:!1})},updateQueryParam:function(t){this.conf.queryParams=$.extend({},this.conf.queryParams,t)},refreshSelectRowIndex:function(t){var e=this.getSelectedItem(!0),n=[]
;if(!e)return!(this.conf.currentSelectedItems=[]);for(var i=0,o=(this.conf.currentSelectedItems=e).length;i<o;i++){for(var a=0,s=!1,r=0;r<t.length;r++)if(e[i]>t[r])a++;else if(e[i]==t[r]){s=!0;break}!s&&0<=e[i]-a&&n.push(e[i]-a)}this.conf.currentSelectedItems=n},deleteRows:function(t){if(!t)return alert("Error: deleteRows 方法参数不能为空！"),!1;var e=!1;t.sort();var n=this.paginationOptions,i=0;n.isLocalPagination&&(i+=(n.currentPage-1)*n.pageSize),n.singlePageMode&&(i=0);for(var o={},a=0,s=t.length;a<s;a++)o["item_"+t[a]]=!0,this.conf.url||this.conf.data.splice(t[a]-a,1),e=!0;return!1!==e&&(this.conf.url?$("div.list-item",this.com).each(function(){var t=$(this),e=t.attr("data-index");e=parseInt(e,10)+i,!0===o["item_"+e]&&t.remove()}):(this.refreshSelectRowIndex(t),this._loadData(this._dataFilter(this.conf.data))),!0)},getSelectedItem:function(e){var n=0,t=this.paginationOptions;if(t.isLocalPagination&&(n+=(t.currentPage-1)*t.pageSize),!1===this.conf.singleSelect){var i=[],o=this
;if(t.isLocalPagination)for(var a in o.conf.currentSelectedItems){var s=o.conf.currentSelectedItems[a];i.push(e?s:o.conf.data[s])}else $("div.list-item-curr",this.com).each(function(){var t=parseInt($(this).attr("data-index"),10)+n;i.push(e?t:o.conf.data[t])});return i.length?i:null}if(this.currentListItem){s=parseInt($(this.currentListItem).attr("data-index"),10)+n;return e?[s]:this.conf.data[s]}return null},_selectRow:function(t,n){n=!!n,t instanceof Array||(t=[t]);var i=this.conf;if(!1!==i.singleSelect&&n&&1<t.length)alert("Error: 单选状态下 只能选中一行！");else{var e=this.paginationOptions,o=0;e.isLocalPagination&&(o+=(e.currentPage-1)*e.pageSize),e.singlePageMode&&(o=0);for(var a={},s=0,r=t.length;s<r;s++)a["item_"+t[s]]=n;var c=this;$("div.list-item",this.com).each(function(){var t=$(this),e=t.attr("data-index");e=parseInt(e,10)+o,
!1===i.singleSelect?!0===a["item_"+e]?t.removeClass("list-item-curr").addClass("list-item-curr"):!1===a["item_"+e]&&t.removeClass("list-item-curr"):!0===a["item_"+e]?(t.removeClass("list-item-curr").addClass("list-item-curr"),c.currentListItem=this):!1===a["item_"+e]?(t.removeClass("list-item-curr"),c.currentListItem===this&&(c.currentListItem=null)):!0===n&&t.removeClass("list-item-curr")})}},checkRow:function(t,e){this._selectRow(t,!0),e&&e(t)},unCheckRow:function(t){this._selectRow(t,!1)},getClassName:function(){return"PJF.ui.list"},setRequestOptions:function(t){this.paginationOptions.currentPage=0,this.paginationOptions.totalPage=1,this.paginationOptions.total=0,$.extend(!0,this.conf,t),$.extend(!0,this.paginationOptions,t),this._loadData(null,{direction:!0})}}),PJF.apply(PJF.ui.list.prototype,{destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null},validateParam:function(t){var e=(t.currentSelectedItems||[]).length
;return!1!==t.singleSelect&&1<e?(alert("Error: 单选状态下 默认选中不能大于1. currentSelectedItems.length = "+e),!1):!!t.dom||(alert("提示：list 的dom属性不能为空！"),!1)}}),PJF.ui.simpleTable=PJF.extend(PJF.ui.component,{init:function(t){this.options={width:600,height:400},$.extend(this.options,t),this._widthCalculate(),this.createDom(),this.adjustCss(),this.bindEvent()},createDom:function(){this._createFrame(),this._getDOMRefer(),this._createHead(),this._createRows()},_createFrame:function(){this.com.append("<div  class='pjf_stmTable_head'><table class='f'  border=0 ><thead class='bh'></thead></table></div><div class='pjf_stmTable_body'><table class='f'><tbody></tbody></table> </div>")},_widthCalculate:function(){var t=this.options,e=t.column,n=e[e.length-1],i=parseInt($("html").css("font-Size"))/PJF.constants.DEFAULT_FONTSIZE,o=0;$.each(n,function(t,e){if(isNaN(Number(e.width))){var n=e.title.length;e.width=24*n}o+=Number(e.width)});var a=17+(n.length-1)+2;if(o<t.width-a/i){var s=(t.width-a/i-o)/n.length
;$.each(n,function(t,e){e.width+=s})}},_getDOMRefer:function(){this.head=this.com.find(".pjf_stmTable_head"),this.body=this.com.find(".pjf_stmTable_body"),this.headContent=this.head.find("thead"),this.bodyContent=this.body.find("tbody")},_createHead:function(){var t,n,m;t=this.options,n=t.column,m=[],$.each(n,function(t,e){var u=e.length,d=t==n.length-1,h=0==t;m.push("<tr>"),$.each(e,function(t,e){var n=e.colspan,i=e.title,o=e.field,a=e.width,s=t==u-1,r="bt br",c="bb";h&&(r=r.replace("bt","")),s&&(r=r.replace("br","")),d&&(c=c.replace("bb",""));var l="<th field='"+o+"' colspan='"+n+"' class='"+r+"'><div style='width:"+(d?a/PJF.constants.DEFAULT_FONTSIZE:"")+"rem'>"+i+"</div></th>";s&&(l+="<th class='empty "+c+"' style='border-left: none'><div style='width:17px'></div></th>"),m.push(l)}),m.push("</tr>")}),this.headContent.append(m.join())},_createRows:function(){var t,e,r,c;t=this.options,$.isPlainObject(t.data)?t.data=[].concat(t.data):void 0===t.data&&(t.data=[]),r=[],e=t.data,
c=t.column[t.column.length-1],$.each(e,function(t,s){r.push("<tr rowIndex='"+t+"'>"),$.each(c,function(t,e){var n=t==c.length-1,i=s[e.field],o=e.align||"center",a="<td class='"+(n?"bb":"br bb")+"'><div style='padding:0 4px;width:"+e.width/PJF.constants.DEFAULT_FONTSIZE+"rem' align='"+o+"'>"+i+"</div></td>";n&&(a+="<th class='empty bb'><div style='width:17px'></div></th>"),r.push(a)}),r.push("</tr>")}),this.bodyContent.append(r.join())},_clearTable:function(){this.options.data=[],this.bodyContent.empty()},adjustCss:function(){var t,e,n,i,o;t=this.options,i=(e=parseInt($("html").css("font-Size")))/PJF.constants.DEFAULT_FONTSIZE,n=this.head.height(),o=t.height*i-n,this.com.css({width:t.width/PJF.constants.DEFAULT_FONTSIZE+"rem",height:t.height/PJF.constants.DEFAULT_FONTSIZE+"rem"}),this.body.css({height:o/e+"rem"}),PJF.util.deviceType.icm&&(this.body.addClass("pjf_stmTable_showScroll"),this.body.find(".empty>div").css({width:"0px"}))},bindEvent:function(){var e,n;e=(n=this).options,
this.body.off("click").on("click","[rowIndex]",function(){var t=$(this).attr("rowIndex");$.isFunction(e.onClick)&&e.onClick.call(t,e.data[t])}),this.body.off("scroll").on("scroll",function(){var t=$(this).scrollLeft();this.scrollWidth,e.width;n.head.scrollLeft(t)})},loadData:function(t){var e;e=this.options,this._clearTable(),$.isPlainObject(t)?e.data=[].concat(t):$.isArray(t)?e.data=t:alert("传入参数类型必须为数组或对象"),this._createRows(),PJF.util.deviceType.icm&&this.body.find(".empty>div").css({width:"0px"})}}),PJF.apply(PJF.ui.simpleTable.prototype,{getClassName:function(){return"PJF.ui.simpleTable"},destroy:function(){this.com.remove(),this.com=null,PJF.ui.componentMgr.remove(this.id)}}),PJF.ui.slides=PJF.extend(PJF.ui.component,{init:function(t){this.options={data:[],height:300,slideWidth:200,slideHeight:200,slideMarginRight:12,slideBorderWidth:2,type:"arrow",templates:this.templates},$.extend(this.options,t),this.options.slideWidth=this.options.slideWidth/PJF.constants.DEFAULT_FONTSIZE,
this.options.slideHeight=this.options.slideHeight/PJF.constants.DEFAULT_FONTSIZE,this.options.slideMarginRight=this.options.slideMarginRight/PJF.constants.DEFAULT_FONTSIZE;var e=this.options,n=this.initHtml();e.dom&&this.com.append(n),this.cssSlides(),this.bindEvents()},templates:function(t){return""},initHtml:function(){var t="";switch(this.options.type){case"arrow":t+='<div class="stm_slides_container stm_slides_container_arrow"><div class="stm_slides_view stm_slides_view_arrow">'+this.initSlidesHtml()+"</div></div>";break;case"circle":t+='<div class="stm_slides_container stm_slides_container_circle"><div class="stm_slides_view stm_slides_view_circle">'+this.initSlidesHtml()+"</div>"+this.initCircleHtml()+"</div>"}return t},initCircleHtml:function(){var t=this.options.data,e="";e+='<div class="stm_slides_circles">';for(var n=0;n<t.length;n++)e+='<div class="stm_slides_circle'+(0==n?" stm_slides_circle_selected":"")+'" slideIndex='+n+"></div>";return e+="</div>"},
initSlidesHtml:function(){var t=this.options,e=t.data,n="";switch(t.type){case"arrow":n+='<div class="stm_slides_view_slides_arrow">';for(var i=0;i<e.length;i++)n+='<div class="stm_slides_view_slide_arrow" dataIndex="'+i+'">'+t.templates(e[i])+"</div>";n+="</div>";break;case"circle":n+='<div class="stm_slides_view_slides_circle">';for(i=0;i<e.length;i++)n+='<div class="stm_slides_view_slide_circle" dataIndex="'+i+'">'+t.templates(e[i])+"</div>";n+="</div>"}return n},cssSlides:function(){var t=this,e=t.options;switch(e.type){case"arrow":var n=t.com.find(".stm_slides_container_arrow"),i=t.com.find(".stm_slides_view_arrow"),o=t.com.find(".stm_slides_view_slides_arrow"),a=t.com.find(".stm_slides_view_slide_arrow");n.css({height:2*e.slideHeight+e.slideMarginRight+"rem",width:4*e.slideWidth+4*e.slideMarginRight+"rem"}),a.css({width:e.slideWidth+"rem",height:e.slideHeight+"rem",border:e.slideBorderWidth+"px solid #BFE9F0","margin-right":e.slideMarginRight+"rem"});break;case"circle":
n=t.com.find(".stm_slides_container_circle"),i=t.com.find(".stm_slides_view_circle"),o=t.com.find(".stm_slides_view_slides_circle"),a=t.com.find(".stm_slides_view_slide_circle");var s=t.com.find(".stm_slides_circles");n.css({height:e.slideHeight+.3+.2+"rem"}),i.css({height:e.slideHeight+"rem"});var r=e.data.length,c=i.width();c=i.width()/$("html").css("font-size").split("px")[0],o.css({width:c*r+"rem"}),a.css({width:c+"rem"});var l=(c-(.2*r+.1*(r-1)))/2;s.css({"padding-left":l+"rem"})}},bindEvents:function(){var t=this.options;switch(t.type){case"arrow":var n=this.com.find(".stm_slides_view_slides_arrow"),e=this.com.find(".stm_slides_view_slide_arrow");t.data.length,t.slideWidth,t.slideBorderWidth,t.slideMarginRight;e.unbind("click").bind("click",function(){t.onClick&&t.onClick instanceof Function&&(PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav"),t.onClick(t.data[$(this).attr("dataIndex")]))});break;case"circle":
var i=this.com.find(".stm_slides_circle"),o=this.com.find(".stm_slides_view_circle"),a=(n=this.com.find(".stm_slides_view_slides_circle"),e=this.com.find(".stm_slides_view_slide_circle"),o.width()/$("html").css("font-size").split("px")[0]);i.unbind("click").bind("click",function(){i.removeClass("stm_slides_circle_selected");var t=$(this).attr("slideIndex");i.eq(t).addClass("stm_slides_circle_selected");var e=-t*a+"rem";n.css({left:e,transition:"all 0.3s ease 0s"})}),e.unbind("click").bind("click",function(){t.onClick&&t.onClick instanceof Function&&(PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav"),t.onClick(t.data[$(this).attr("dataIndex")]))})}},setData:function(t){this.options.data=t;var e=this.initSlidesHtml(),n=this.com.find(".stm_slides_view");n.children().remove(),n.append(e),"circle"==this.options.type&&(this.com.find(".stm_slides_circles").remove(),this.com.find(".stm_slides_container").append(this.initCircleHtml())),this.cssSlides(),this.bindEvents()}}),
PJF.apply(PJF.ui.slides.prototype,{getClassName:function(){return"PJF.ui.slides"},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null}}),PJF.ui.panel=PJF.extend(PJF.ui.component,{init:function(conf){this.content=$("#"+this.dom).html(),this.options={id:null,title:null,iconUrl:null,width:1760,height:800,left:null,top:null,href:null,cache:!0,border:!0,content:null,tools:null,loadingMessage:"Loading...",extractor:function(t){var e=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(t);return e?e[1]:t},onLoad:function(){},isLoaded:!1,domLoadedCallBack:function(){},initMargin:20};var me=this;$.extend(this.options,conf);var title=me.options.title,initMargin=me.options.initMargin,iconUrl=me.options.iconUrl,body=this.com.addClass("stmPanel-body"),pageArea=me.getPageArea(),width,height,width=me.options.width;width?(width=me.options.width,height=me.options.height):(width=pageArea.width-8*initMargin,height=pageArea.height-3*initMargin),
console.log("width:",width+" , height:",height),$(body).css({width:width+"px",height:height+"px"});var stmPanel=$('<div class="stmPanel" ></div>').insertBefore(body);if($(stmPanel).append(body),this.options.content)$(".stmPanel-body").html(this.options.content);else if(this.options.htmlDomId){var html=$("#"+this.options.htmlDomId).html();this.com.html(html),this.options.domLoadedCallBack(),$("#"+this.options.htmlDomId).remove()}$(stmPanel).find("div.stmPanel").css({"overflow-x":"auto","overflow-y":"auto","padding-bottom":"0px"}),me.options.tools&&"string"==typeof me.options.tools&&stmPanel.find(">div.stmPanel-header>div.stmPanel-tool .stmPanel-tool-a").appendTo(me.options.tools);var padHeader=$('<div class="stmPanel-header"><div class="stmPanel-title">'+me.options.title+"</div></div>").prependTo(stmPanel);me.options.iconUrl&&(padHeader.find(".stmPanel-title").addClass("stmPanel-with-icon"),
$('<img class="stmPanel-icon" src="'+me.options.iconUrl+'"/>').addClass(me.options.iconCls).appendTo(padHeader)),$(stmPanel).find(".stmPanel-icon").click(function(){me.options.onclick instanceof Function&&me.options.onclick.call(me)});var tool=$('<div class="stmPanel-tool"></div>').appendTo(padHeader);if(tool.bind("click",function(t){t.stopPropagation()}),me.options.tools)if("string"==typeof me.options.tools)$(me.options.tools).children().each(function(){$(this).addClass($(this).attr("iconCls")).addClass("stmPanel-tool-a").appendTo(tool)});else for(var i=0;i<me.options.tools.length;i++){var t=$('<a href="javascript:void(0)"></a>').addClass(me.options.tools[i].iconCls).appendTo(tool);me.options.tools[i].handler&&t.bind("click",eval(me.options.tools[i].handler))}me.options.href&&me.loadDataByUrl(me.options.href),me.setPanelSize(),this.move(this.com.parent()),null==me.options.title||""==me.options.title?(this.com.siblings("div.stmPanel-header").hide(),
this.com.parent().removeClass("stmPanel-withHeader").addClass("stmPanel-withOutHeader")):this.com.parent().removeClass("stmPanel-withOutHeader").addClass("stmPanel-withHeader")},move:function(t){t.css({left:this.options.left,top:this.options.top})},getPageArea:function(){return"BackCompat"==document.compatMode?{width:Math.max((document.body.scrollWidth,document.body.clientWidth)),height:Math.max((document.body.scrollHeight,document.body.clientHeight))}:{width:Math.max((document.documentElement.scrollWidth,document.documentElement.clientWidth)),height:Math.max((document.documentElement.scrollHeight,document.documentElement.clientHeight))}},setPanelSize:function(){var t=this,e=t.com.parent(),n=e.children("div.stmPanel-header"),i=e.children("div.stmPanel-body");if(1==t.options.fit){var o=e.parent();o.addClass("stmPanel-noscroll"),"BODY"==o[0].tagName&&$("html").addClass("stmPanel-fit"),t.options.width=o.width(),t.options.height="auto"}isNaN(t.options.width)?(e.width("auto"),
n.add(i).width("auto")):(e.width(t.options.width+"px"),n.width(t.options.width+"px"),i.width(t.options.width+"px")),isNaN(t.options.height)?i.height("auto"):(e.height(t.options.height+"px"),i.height(e.height()-n.outerHeight()+"px"))},loadDataByUrl:function(t,e){var n=this;if(n.options.href&&(e||!n.options.isLoaded||!n.options.cache)){n.options.isLoaded=!1;var i=n.com;i.html($('<div class="stmPanel-loading"></div>').html(n.options.loadingMessage));var o=i;$.ajax({url:t,cache:!1,success:function(t){i.html(n.options.extractor.call(o,t)),$.parser&&$.parser.parse(i),n.options.onLoad&&n.options.onLoad.apply(o,arguments),n.options.isLoaded=!0,i.parent().css({"overflow-x":"auto","overflow-y":"auto"})}})}},destroy:function(){this.com.removeAttr("class").removeAttr("title").removeAttr("style").children().remove(),this.com.empty(),$("#"+this.dom).html(this.content),this.com.clone().insertAfter(this.com.parent()),this.com.parent().remove(),PJF.ui.componentMgr.remove(this.id),this.content=null,
this.com=null,this.params=null,PJF.communication.ajaxMgr&&PJF.communication.ajaxMgr.remove(this)},setUrl:function(t,e){this.options.href=t,this.loadDataByUrl(t,!0),this.options.onLoad=e},setContent:function(t){t&&$(".stmPanel-body").html(t)},setTitle:function(t){this.com.siblings("div.stmPanel-header").show(),this.com.siblings("div.stmPanel-header").find("div.stmPanel-title").html(t)},showTitle:function(){this.com.siblings("div.stmPanel-header").show(),this.com.parent().removeClass("stmPanel-withOutHeader").addClass("stmPanel-withHeader")},hideTitle:function(){this.com.siblings("div.stmPanel-header").hide(),this.com.parent().removeClass("stmPanel-withHeader").addClass("stmPanel-withOutHeader")}}),PJF.apply(PJF.ui.panel.prototype,{getClassName:function(){return"PJF.ui.panel"}}),PJF.ui.tab=PJF.extend(PJF.ui.component,{init:function(t){this.options={initMargin:20,domLoadedCallBack:function(){},onSelect:function(){}},$.extend(this.options,t),this.clickTitle={},this.com.addClass("stm-tab")
;var e=this.createHtml();this.options.dom&&this.com.append(e),this.tab={titleContainer:this.com.find(".tab_title_container")},this.adjustTabStyle(),this.tab.tabContainer=this.com.find(".tab_container"),this.tab.panelContainer=this.com.find(".tab_panels");var n=this.com.find(".tab_panels").children();this.options.domLoadedCallBack(n),this.defaultSelectedTab(),this.bindEvents()},getPageArea:function(){return"BackCompat"==document.compatMode?{width:Math.max((document.body.scrollWidth,document.body.clientWidth)),height:Math.max((document.body.scrollHeight,document.body.clientHeight))}:{width:Math.max((document.documentElement.scrollWidth,document.documentElement.clientWidth)),height:Math.max((document.documentElement.scrollHeight,document.documentElement.clientHeight))}},createHtml:function(){var t=this.options,e=(this.options.iconUrl,[]),n='<div class="tab_container">';if(t.titles&&t.titles instanceof Array)for(var i=t.titles,o=0,a=i.length;o<a;o++){var s="tab-"+PJF.util.generateUUid()
;e.push(s),n+='<div id="'+s+'" dataindex="'+o+'" class="tab_title_container">',t.closables&&t.closables[o]&&(n+='<div class="tab_tool_close" dataindex="'+o+'"></div>'),n+=' <div class="tab_title_context"  ><span >'+i[o]+"</span></div>",n+="</div>"}n+="</div>",n+='<div class="tab_panels">';var r=t.htmlDomIds;if(r){if((a=r.length)!=t.titles.length)return void alert("创建Tab组件失败，Tab 选项卡表头与html dom id个数不一致");if(r&&r instanceof Array){for(o=0;o<a;o++){var c=0;for(a=t.titles.length;c<a;c++)if(c==o){n+='<div   id="'+e[o]+'" class="tab_panel" dataindex="'+o+'">',n+=$("#"+r[o]).html(),n+="</div>",$("#"+r[o]).remove();break}}n+="</div>"}}else for(o=0;o<i.length;o++)n+='<div   id="'+e[o]+'" class="tab_panel" dataindex="'+o+'">',n+="</div>";return n},adjustTabStyle:function(){this.options;var t,e,n=this.options.backgroundColors;this.options.iconCls,this.getPageArea(),this.options.initMargin;t=this.options.width,e=this.options.height,
isNaN(t)?this.com.width("auto"):this.com.css("width",t/PJF.constants.DEFAULT_FONTSIZE+"rem"),isNaN(e)?this.com.height("auto"):this.com.css("height",e/PJF.constants.DEFAULT_FONTSIZE+"rem"),this.tab.titleContainer.each(function(t){for(var e in n)t==e&&$(this).css({backgroundColor:n[e]})})},defaultSelectedTab:function(){this.options.backgroundColors;this.tab.titleContainer.each(function(t){0==t?$(this).addClass("tab_title_selected"):$(this).addClass("tab_title_unselected")});var t=this.com.children(".tab_panels").children(".tab_panel");t.addClass("tab_panel_hidden"),t.each(function(t){0==t&&$(this).removeClass("tab_panel_hidden").addClass("tab_panel_selected")}),this.options.onSelect&&this.options.onSelect(0,this.options.titles[0])},bindEvents:function(){var a=this.options,s=(this.options.iconCls,this);s.tab.tabContainer.on("click",".tab_title_container",function(){var e=this,n=$(this).attr("dataindex"),i="tab_title_selected",o="tab_title_unselected";s.tab.titleContainer.each(function(){
var t=$(this).attr("dataindex");n==t?$(e).hasClass(i)||(s.select(n),s.options.onSelect&&s.options.onSelect(n,a.titles[n]),$(e).addClass(i).removeClass(o)):$(this).addClass(o).removeClass(i)})}),s.tab.tabContainer.on("click",".tab_tool_close",function(t){var e=$(this).attr("dataindex");s.remove(e),t.stopPropagation()})},add:function(t){var e=this.options,n="",i="";if(t){t instanceof Array||(t=[t]);for(var o=0,a=t.length;o<a;o++){var s=t[o];e.titles.push(s.title),e.backgroundColors.push(s.backgroundColor),e.closables.push(s.closable);var r="tab-"+PJF.util.generateUUid(),c=e.titles.length-1;n+='<div id="'+r+'" dataindex="'+c+'" class="tab_title_container tab_title_unselected" style="background-color: '+s.backgroundColor+'">',s.closable&&(n+='<div class="tab_tool_close" dataindex="'+c+'"></div>'),n+=' <div class="tab_title_context"  ><span >'+s.title+"</span></div>",n+="</div>",i+='<div id="'+r+'" class="tab_panel tab_panel_hidden" dataindex="'+c+'">',i+=s.content,i+="</div>"}
this.tab.tabContainer.append(n),this.tab.panelContainer.append(i),this.tab.titleContainer=this.com.find(".tab_title_container");var l=this.tab.tabContainer.find(".tab_title_selected");l&&l.length||$(this.tab.titleContainer[0]).trigger("click")}},removeTitle:function(t){for(var e=this.options.titles,n=0,i=e.length;n<i;n++)if(e[n]==t){this.remove(n);break}},remove:function(e){var t=this.options,n=t.titles[e];t.titles.splice(e,1),t.backgroundColors.splice(e,1),this.tab.titleContainer.each(function(t){t==e?$(this).remove():e<t&&($(this).find(".tab_tool_close").attr("dataindex",t-1),$(this).attr("dataindex",t-1))}),this.tab.panelContainer.children().each(function(t){t==e?$(this).remove():e<t&&$(this).attr("dataindex",t-1)}),this.tab.titleContainer=this.com.find(".tab_title_container"),this.options.onRemove&&this.options.onRemove(e,n),$(this.tab.titleContainer[0]).trigger("click")},select:function(e){var n;this.options.backgroundColors
;if(0<this.com.find(".tab_title_container").eq(e).length){this.tab.titleContainer.each(function(t){e==t&&(n=$(this).attr("id"))})}this.com.children(".tab_panels").children(".tab_panel").each(function(){$(this).removeClass("tab_panel_selected").addClass("tab_panel_hidden");var t=$(this).attr("id");n==t&&$(this).removeClass("tab_panel_hidden").addClass("tab_panel_selected")})},selectTab:function(t){var e=$('span:contains("'+t+'")')[0];e&&$(e).trigger("click")},destroy:function(){this.com.remove(),PJF.ui.componentMgr.remove(this.id)}}),PJF.apply(PJF.ui.tab.prototype,{getClassName:function(){return"PJF.ui.tab"}}),function(exports){var _loadedResource={},_loadPhase={},_newPage,_oldPage,_notTriggerHashChange,_waitingToLoad=[],_cbs={beforeLoadPage:function(){},beforeNewPageLoad:function(){},afterNewPageLoad:function(){},newPageLoadSucc:function(){},newPageLoadErr:function(){},beforeNewPageInit:function(){},afterNewPageInit:function(){},newPageInitSucc:function(){},newPageInitErr:function(){},
beforeOldPageDestroy:function(){},afterOldPageDestroy:function(){},oldPageDestroySucc:function(){},oldPageDestroyErr:function(){},switchAnimate:function(t,e,n){t?t.fadeOut(200,n):n()},loadingInitFunction:function(){},loadingDestroyFunction:function(){}},_params={routing:{},useJsBkDoor:!0,useJsCache:!1,cbs:_cbs,homepage:"homepage",postfix:[],newPageTmpl:"",pageContainer:""},_getLocation=exports.getLocation=function(){var t=window.location.href,e=t.search("#!");return 0<e?t.slice(e+2):""};function _changeLoadPhase(t){$.extend(_loadPhase,t),_loadPhase.scriptDoms&&_loadPhase.scriptDoms.forEach(function(t){document.head.removeChild(t)})}function _beforeLoadPage(t,e,n){n||!_cbs.beforeLoadPage?($.extend(_loadPhase,{pageId:t,isLoading:!0,loadErr:!1,scriptDoms:[],cssStr:"",htmlStr:"",htmlCssStr:"",initData:e,FHTS:!1}),0==t.indexOf("FHTS")?_loadFHTSPage(t):_loadPage(t)):_cbs.beforeLoadPage(t,e,_beforeLoadPage)}function _loadFHTSPage(pageid){
var id=pageid.split("-")[2],transId=pageid.split("-")[1];$.extend(_loadPhase,{FHTS:!0}),PJF.communication.FHTSCpsJsonReq({jsonData:JSON.stringify({PgFc_Txn_SN:id}),fwServiceId:"simpleTransaction",fwTranId:transId,async:!0,loadingText:PJF.i18n.getI18nResource("pjfCommon.loadingPageMsg"),maskAll:!0,success:function(data){try{var html=data.Bsn_Dsc,js=data.Insn_Dtl_Inf,css="<style>"+data.Tpl_Dsc+"</style>",ctx=eval("("+js+")");if(ctx.compsContainer={},ctx.beforeInitCmp&&!1===ctx.beforeInitCmp(_loadPhase.initData))return void(_loadPhase.isLoading=!1);if(_loadPhase.cssStr=css,_loadPhase.pageInfo=ctx,_loadPhase.htmlStr=html,_loadPhase.FHTS&&_loadPhase.pageInfo.vueConf){var _parseRst=_parseI18nHtml(html);_loadPhase.htmlCssStr=_parseRst.css,_loadPhase.htmlStr=_parseRst.html}_switchPage(function(){try{ctx.compsContainer=PJF.html.tagScan(_newPage.children(),ctx,ctx.compsContainer),ctx.afterInitCmp&&ctx.afterInitCmp(_loadPhase.initData)}catch(t){
_loadFHTSErr(t,"初始化页面"+pageid+"失败, 错误信息:"+t.message,void 0)}})}catch(t){_loadFHTSErr(t,"初始化页面"+pageid+"失败, 错误信息:"+t.message,void 0)}},failure:function(t){(t=t||{}).BK_DESC="加载分行特色功能失败，"+t.BK_DESC,_loadFHTSErr(void 0,t,null,!0)},complete:function(){}})}function _loadFHTSErr(t,e,n,i){t&&console.log(t.stack),_loadPhase={},new PJF.ui.errorMessageBox({data:"object"==typeof e?e:null,content:e,detailMsg:n,buttonConfs:[{bgColor:"rgb(121,198,30)",name:i?"返回首页":"确定",style:"main",width:200,height:80,onClick:function(){i&&template&&template.loadPage("homepage")}}]})}function _loadPage(t){var e=_params.routing[t];if(!e)return console.log(t+"没有定义,页面无法跳转"),void(_loadPhase={});_params.cbs.loadingInitFunction(),e.css=e.css||[];for(var n=0;n<_params.postfix.length;n++)e=$.extend(e,_params.routing[t+_params.postfix[n]]);$.extend(!0,_loadPhase,{fileCount:e.js.length+e.css.length+1,pageInfo:e,initData:e.initData}),_params.cbs.beforeNewPageLoad(),_loadFile("html",e.html),_loadFile("css",e.css),
_loadFile("js",e.js)}exports.init=function(t){$.extend(!0,_params,t),window.onhashchange=function(){$.extend(_loadPhase,{isLoading:!0}),_beforeLoadPage(exports.getLocation()||_params.homepage)},exports.getLocation()?_beforeLoadPage(exports.getLocation()):_params.homepage&&(location.hash="!"+_params.homepage)},exports.loadPage=function(t,e){if(_loadPhase.isLoading)return setTimeout(function(){exports.loadPage(t,e)},100),void console.log("页面正在加载中, 页面:"+t+"将稍后加载");exports.getLocation()!=t?($.extend(_loadPhase,{initData:e,isLoading:!0}),location.hash="!"+t):exports.refresh(e)},exports.refresh=function(t){console.log("刷新页面:"+exports.getLocation()),_beforeLoadPage(exports.getLocation(),t)},exports.goback=function(){},exports.goforward=function(){};var _toAbsURL=(YBa=function(t){var e=document.createElement("a");return e.href=t,e.href},""===YBa("")?function(t){var e=document.createElement("div");return e.innerHTML='<a href="'+t.replace(/"/g,"%22")+'"/>',e.firstChild.href}:YBa),YBa
;function _loadFile(o,t){"string"==typeof t&&(t=[t]),t.forEach(function(n){if(n)if("js"==o){var e;if(_params.useJsBkDoor){var i=_toAbsURL(n).split("bosWeb/page/")[1];$.ajax({async:!1,url:"/bosWeb/FileServlet?type=status&path="+i,success:function(t){"true"==t&&(_loadedResource[n]=!1,e="/bosWeb/FileServlet?type=load&path="+i)}})}if(_loadedResource[n])return _loadEnd();var t=document.createElement("script");t.src=e||n,t.onerror=function(){_loadErr(n),document.head.removeChild(t)},t.onload=function(){_loadedResource[n]=!(e||!_params.useJsCache),_loadEnd(),document.head.removeChild(t)},_loadPhase.scriptDoms.push(t),document.head.appendChild(t)}else _loadedResource[n]?("css"==o?_loadPhase.cssStr+=_loadedResource[n]:"html"==o&&(_loadPhase.htmlStr=_loadedResource[n].htmlStr,_loadPhase.htmlCssStr=_loadedResource[n].htmlCssStr),_loadEnd()):$.ajax({url:n,success:function(t){if("css"==o)t=["<style>",t,"</style>"].join(""),_loadPhase.cssStr+=t,_loadedResource[n]=t;else{var e=_parseI18nHtml(t)
;_loadedResource[n]={},_loadedResource[n].htmlCssStr=_loadPhase.htmlCssStr=e.css,_loadedResource[n].htmlStr=_loadPhase.htmlStr=e.html}_loadEnd()},error:function(){_loadErr(n)}});else _loadEnd()})}function _loadEnd(){if(0==--_loadPhase.fileCount){if(_params.cbs.afterNewPageLoad(),_loadPhase.loadErr)return _loadPhase={},_params.cbs.loadingDestroyFunction(),void _params.cbs.newPageLoadErr();_params.cbs.newPageLoadSucc(),_switchPage()}}function _loadErr(t){_loadPhase.loadErr=!0,_loadEnd()}function _switchPage(e){_newPage&&(_oldPage=_newPage),_params.cbs.switchAnimate(_oldPage,_newPage,function(){try{_destroyOldPage(),_createNewPage(),_params.cbs.loadingDestroyFunction(),e&&e()}catch(t){console.log("页面切换动画回调失败:"+t.message)}finally{_loadPhase={};var t=_waitingToLoad.shift();t&&exports.loadPage.apply(exports,t)}})}function _destroyOldPage(){if(_oldPage)try{_params.cbs.beforeOldPageDestroy();var e=!0;_oldPage.pageObj.vueCmp&&_oldPage.pageObj.vueCmp.$destroy(),
_oldPage.pageObj.destroy&&_oldPage.pageObj.destroy(),e=!1,_params.cbs.oldPageDestroySucc(_oldPage.pageId)}catch(t){e&&_params.cbs.oldPageDestroyErr(_oldPage.pageId,t),console.log(_oldPage.pageId+" destroy error : "+t.message),console.log(t.stack)}finally{_params.cbs.afterOldPageDestroy(_oldPage.pageId),_oldPage.cssObj.remove(),_oldPage.remove()}}function _createNewPage(){_newPage=$(_params.newPageTmpl).appendTo(_params.pageContainer);var e=PJF.util.generateUUid()+Date.now();_newPage.attr("id",e),_newPage.append(_loadPhase.htmlStr),_newPage.cssObj=$(_loadPhase.cssStr+_loadPhase.htmlCssStr).appendTo(document.head),_newPage.pageId=_loadPhase.pageId;try{var n=!0;_oldPage&&_oldPage.pageObj&&_oldPage.pageObj.beforeNextPageInit&&_oldPage.pageObj.beforeNextPageInit();var t=function(){if(_newPage.pageObj.vueConf){_newPage.pageObj.vueCmp=new Vue($.extend({el:_newPage[0],i18n:PJF.i18n.getVueI18n()},_newPage.pageObj.vueConf()));var t=$("#"+e);t.pageId=_newPage.pageId,t.pageObj=_newPage.pageObj,
t.cssObj=_newPage.cssObj,_newPage=t}};_loadPhase.FHTS?(_newPage.pageObj={beforeClickSubMenu:_loadPhase.pageInfo.beforeClickSubMenu,beforeClickHomePage:_loadPhase.pageInfo.beforeClickHomePage,destroy:_loadPhase.pageInfo.destroy,vueConf:_loadPhase.pageInfo.vueConf},t(),_params.cbs.beforeNewPageInit(_newPage.pageId)):(_newPage.pageObj=new window[_loadPhase.pageInfo.className],t(),_params.cbs.beforeNewPageInit(_newPage.pageId),_newPage.pageObj.init(_loadPhase.initData)),n=!1,_params.cbs.newPageInitSucc(_newPage.pageId)}catch(t){console.log(_newPage.pageId+" init error : "+t.message),console.log(t.stack),n&&_params.cbs.newPageInitErr(_newPage.pageId,t)}finally{_params.cbs.afterNewPageInit()}}function _parseI18nHtml(t,s){s=void 0===s||s;var e=PJF.i18n.getLanguage(),r={html:"",css:"",i18nJson:{}};for(var n in r.html=t.replace(/(?:<style([^>]*?)>([\s\S]*?)<\/style>)|(?:<i18n([^>]*?)>([\s\S]*)<\/i18n>)/gi,function(t,e,n,i,o){if(e||n){var a=">";e&&e.match(/reg\s*=/)&&(a=' pjfI18nCss = "true">'),
r.css+="<style "+e+a+n+"</style>"}else i&&o&&s&&i.replace(/appId\s*=\s*["']([^"']*)["']/,function(t,e){try{r.i18nJson[e]=JSON.parse(o)}catch(t){console.log("页面<i18n>解析出错:"+t.message)}});return""}),r.i18nJson)for(var e in r.i18nJson[n])PJF.i18n.addI18nResource(e,n,r.i18nJson[n][e]);return r}exports.getNewPage=function(){return _newPage},exports.getOldPage=function(){return _oldPage}}(PJF.spa={}),PJF.ui.template=PJF.extend(PJF.ui.component,{init:function(t){var i=this;PJF.html.resetRem(),PJF.util.adaptKeyBoard(400,100),PJF.i18n.init(),$(document).on("keydown",function(t){8!=t.keyCode||"INPUT"==t.target.tagName.toUpperCase()||"TEXTAREA"==t.target.tagName.toUpperCase()||t.preventDefault()}),document.body.style.height=document.body.clientHeight+"px",$(window).bind("resize",function(){PJF.html.resetRem({width:!0}),PJF.constants.ON_PROD&&console.log("屏幕高宽发生变化,高:"+$(window).height()+",宽:"+$(window).width())}),this.conf=$.extend({process:{},onPageLoad:function(){}},t),this.pageCom={},
this.topbar={},this.compLength=0,PJF.roleInfo=PJF.roleInfo||{},PJF.otherInfo=PJF.otherInfo||{},PJF.otherInfo.isSelfBank&&document.body.classList.add("pjf_is_self"),PJF.util.deviceType.pad||document.documentElement.classList.add("pjf_stm_none_zooming"),this.prePageid=this.getLocation()||"homepage";var e,n="";PJF.util.deviceType.pad||(n='<div id="template_middle" class="template_middle"><div id="template_search" class="template_search"><input id="template_searchHint" class="template_searchHint" type="text">'+(PJF.otherInfo.isSelfBank||"01"===PJF.otherInfo.globalParams.useNewViewStatus?'<div class="template_search_self"><div class="template_search_self_icon"><div>搜索</div></div></div>':"")+'<div id="template_searchContent" class="template_searchContent"></div></div></div>'),
this.com.append('<div class="template_cntr"><div id="pjf_template_top_vue" class="template_top"><div class="template_left"><div class="template_navbar"><div class="template_navbtn"><div class="template_navbtn_home"></div></div></div><div class="template_welcome"><div class="template_posdate"><div class="template_pos">'+PJF.roleInfo.orgName+'</div><div class="template_dev_id">{{ $t("pjfI18n.devId") }}:'+PJF.otherInfo.devId+'</div><div class="template_version_id">{{ $t("pjfI18n.devVersion") }}:'+PJF.otherInfo.verInfo+'</div><div class="template_date">{{ $d(new Date(), "long") }}</div></div><div class="template_welcomeText"></div></div></div>'+n+'<div id="template_right" class="template_right"><div class="template_logo"></div></div></div><div class="template_content"></div></div>'),PJF.orgInfo&&"DF001"==PJF.orgInfo.instSvrlLgPsnID&&$(".template_logo").css("background-image","url(icon/logo_zd.png)"),
PJF.orgInfo&&"DA003"==PJF.orgInfo.instSvrlLgPsnID&&$(".template_logo").css("background-image","url(icon/logo_hw.png)"),this.initTopVue(),this.guide=new PJF.ui.guide({}),PJF.event.addSubscriber("onCompCreated",function(t){i.newpage&&(i.pageCom[i.newpage.pageId]=i.pageCom[i.newpage.pageId]||[],i.pageCom[i.newpage.pageId].push(t))}),PJF.event.addSubscriber(PJF.constants.IM_CONNECTING_EVENT,function(){$(".template_welcome").css("background-image","url(icon/im_connecting.gif)")}),PJF.event.addSubscriber(PJF.constants.IM_CONNECT_FAIL,function(){$(".template_welcome").css("background-image","url(icon/im_connect_fail.png)")}),PJF.event.addSubscriber(PJF.constants.IM_DISCONNECTING_EVENT,function(){$(".template_welcome").css("background-image","url(icon/im_disconnecting.gif)")}),PJF.event.addSubscriber(PJF.constants.IM_DISCONNECTED_EVENT,function(){$(".template_welcome").css("background-image","url(icon/im_disconnected.png)")}),PJF.event.addSubscriber(PJF.constants.IM_CONNECTED_EVENT,function(){
$(".template_welcome").css("background-image","url(icon/im_connected.png)")}),this.com.find(".template_navbtn").bind("click",function(){i.navbarDisabled||(i.newpage&&i.newpage.pageObj&&i.newpage.pageObj.beforeClickHomePage?!1!==i.newpage.pageObj.beforeClickHomePage()&&(PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav"),i.loadPage("homepage")):(console.log(i.newpage.pageid+"没有实现beforeClickHomePage方法"),i.isIframe||(PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav"),i.loadPage("homepage"))))});var o=[];t.postfixHandler=t.postfixHandler||[];for(var a=0;a<t.postfixHandler.length;a++)o.push(t.postfixHandler[a]());PJF.spa.init({routing:t.pageRouting,newPageTmpl:'<div class = "template_newpage"></div>',pageContainer:i.com.find(".template_content"),homepage:t.padMenuUrl?null:"homepage",postfix:o,cbs:{loadingInitFunction:function(){e&&e.destroy(),e=new PJF.ui.loading({noDestroy:!0,text:PJF.i18n.getI18nResource("pjfCommon.loadingPageMsg")})},
loadingDestroyFunction:function(){e&&e.destroy(),e=null},newPageLoadErr:function(){new PJF.ui.errorMessageBox({content:"网络故障，获取页面失败",buttonConfs:[{bgColor:"rgb(121,198,30)",name:"返回首页",style:"main",width:200,height:80,onClick:function(){template&&template.loadPage("homepage")}}]})},newPageInitErr:function(t,e){new PJF.ui.errorMessageBox({content:"初始化页面"+t+"失败, 错误信息:"+e.message,buttonConfs:[{bgColor:"rgb(121,198,30)",name:"确定",style:"main",width:200,height:80,onClick:function(){}}]})},newPageInitSucc:function(t){if(i.newpage.obj=i.getNewPageObj(),i.conf.onPageLoad&&i.conf.onPageLoad.call(i),i.conf.pageRouting[t]){var e=$.extend(!0,{},i.conf.pageRouting[t].tips,i.conf.tips[PJF.otherInfo.MENU_ID+t]);i.guide.begin(e,[i.oldpage&&i.oldpage.obj,i.newpage.obj])}},beforeNewPageInit:function(t){PJF.i18n.fitCss(),i.newpage=PJF.spa.getNewPage(),i.pageid=t,i.newpage.process=i.addProcess(t)},afterNewPageInit:function(){i.newpage.css({opacity:1})},beforeOldPageDestroy:function(){
i.oldpage=PJF.spa.getOldPage(),i.oldpage.process&&i.oldpage.process.destroy()},afterOldPageDestroy:function(t){for(;i.pageCom[t]&&0<i.pageCom[t].length;){var e=i.pageCom[t].pop();try{e.destroy()}catch(t){console.log(t.stack),console.log(e.getClassName()+" destroy error : "+t.message)}}i.guide.stop()},beforeLoadPage:function(t,e,n){function s(){console.log("hashchange to page :"+t),PJF.event.publish("STM_HASH_CHANGE",i.prePageid,t),i.prePageid=t,n(t,e,!0)}PJF.communication.isInClient()?(PJF.event.publish(PJF.stmEvent.BEFORE_HASH_CHANGE),function n(){var i=Object.keys(PJF.stm.client.callbackList);if(0<i.length){var o=0,a=[];0==PJF.ui.loading.count&&a.push(new PJF.ui.loading({})),i.forEach(function(t){var e=PJF.event.getCallBackList(t)[0];PJF.event.getCallBackList(t)[0]=function(){if(e.apply(PJF.stm.client,arguments),i.length!=++o)0==PJF.ui.loading.count&&(console.log("回调执行后，没有遮罩"),a.push(new PJF.ui.loading({})));else{for(var t=0;t<a.length;t++)a[t].destroy();n()}}})}else s()}()):s()}}})
},initTopVue:function(){this.topVue=new Vue({el:"#pjf_template_top_vue",i18n:PJF.i18n.getVueI18n(),data:{language:"cn",activeLanguage:!0},methods:{chooseLanguage:function(t){this.$emit("languageChanged",t),this.language=t,PJF.i18n.setLanguage(t)},aLan:function(t){return t==this.language?{"text-decoration":"underline","font-weight":"bold"}:{color:"black"}}}}),this.topVue.$on("showOrHide",function(t){this.activeLanguage=t})},loadPage:function(t,e){!PJF.util.deviceType.pad||"homepage"!=t&&"subMenuPage"!=t?(PJF.util.deviceType.pad&&-1!=PJF.constants.PRINT_PAGE_IDS.indexOf(t)&&PJF.fsm.get(PJF.fsm.fmIds.STM_PAD_TEMPLATEINFO).is("yes")&&(t="padCommonTransactionEnd",PJF.fsm.get(PJF.fsm.fmIds.STM_PAD_TEMPLATEINFO).notTemplateInfoAuth()),PJF.spa.loadPage(t,e)):PJF.communication.Tabs.CloseThisTab()},refresh:function(t){PJF.spa.refresh(t)},getLocation:function(){return PJF.spa.getLocation()},triggerGuide:function(t){this.guide.triggerGuide(t)},addTopBarComp:function(t){var n=this
;if("array"==PJF.util.getType(t))for(var e in t)i(t[e]);else"object"==PJF.util.getType(t)&&i(t);function i(t){var e=t.id?t.id:"TemplateComp_"+n.compLength;return t.cssClass="template_rightBtns",t.id=e,t.component="PJF.ui.linkButton",t.conf=t,n.topbar[e]=n.addComponent("template_right",t),n.topbar[e]}},getTopBarComp:function(t){if("string"==typeof t&&this.topbar[t])return this.topbar[t]},clearTopBar:function(){for(a in this.topbar)this.topbar[a]&&(this.topbar[a].destroy(),this.topbar[a]=null)},leftTopSwitch:function(t){"welcomeInfo"==t?(this.com.find(".template_welcome").show(),this.disableNavbar(!1),this.com.find(".template_navbar").hide()):"navBar"==t?(this.com.find(".template_welcome").hide(),this.com.find(".template_navbar").show()):(this.com.find(".template_welcome").toggle(),this.com.find(".template_navbar").toggle())},setNavbar:function(t,e,n,i){if(!(PJF.util.deviceType.pad||t<2)){if(PJF.stm.menuTree&&PJF.stm.menuTree[i]){var o=PJF.i18n.getLanguage().toUpperCase()
;PJF.stm.menuTree[i]["NAME_"+o]&&(e=PJF.stm.menuTree[i]["NAME_"+o])}e=e.split("<br>").join("");var a,s,r=this,c=r.com.find(".template_navbtn"),l=c.filter(".template_navbtn_"+(t-1));s=0<l.length?l:$(c[0]);var u=c.filter(".template_navbtn_"+t);0<u.length?((a=u)[0].style.width="",a.show(),a.find("span").text(e).show()):(a=$('<div class="template_navbtn template_navbtn_'+t+'" style="color:#0065b3;font-weight: bold;"><span>'+e+"</span></div>")).insertAfter(s),a.off("click").on("click",function(){r.newpage&&r.newpage.obj&&r.newpage.obj.beforeClickSubMenu&&!1===r.newpage.obj.beforeClickSubMenu(n,i)||(console.log(r.newpage.pageid+"没有实现beforeClickSubMenu方法"),PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav"),r.loadPage(n,i))}),a.nextAll().hide(),1<c.length&&r.com.find(".template_navbtn").each(function(t){2<=t&&$(this).addClass("template_nav_arrow")}),r.leftTopSwitch("navBar"),a.width(a.find("span").width()+1)}},getNewPageObj:function(){return this.newpage.pageObj},
addComponent:function(r,t){var c=this;if("array"==PJF.util.getType(t)){var e=[];for(a in t)e.push(n(t[a]));return e}if("object"==PJF.util.getType(t))return n(t);function n(t){var e,n=t.component,i=t.id?t.id:"TemplateComp_"+c.compLength,o=t.cssClass?t.cssClass:"",a=t.conf;t.style instanceof Object&&t.style;r=r?$("#"+r):c.newpage,a.dom=i,a.noDestroy=!0;var s=$("<div id='"+i+"'class='"+o+"'></div>");return r.prepend(s),e=new(PJF.ui[n.substring(7)])(a),c.compLength++,e}},disableNavbar:function(t){this.navbarDisabled=t},addProcess:function(t){var e,n=this.conf.pageRouting[t]||{};PJF.otherInfo.MENU_ID=PJF.otherInfo.MENU_ID||"";var i=this.conf.process[PJF.otherInfo.MENU_ID+t];if(n.process||i){var o=[];if(i)o=i.data.slice(0,i.data.length-1);else{var a=this.conf.process[n.process[0]].data;try{for(var s in a)o.push(PJF.i18n.getI18nResource(a[s])?PJF.i18n.getI18nResource(a[s]):a[s])}catch(t){o=a}}this.com.find(".template_newpage").prepend('<div id="'+t+'_process"></div>'),e=new PJF.ui.process({
dom:t+"_process",data:o});var r=i?i.data[i.data.length-1]:n.process[1];return e.setDoing(r),e}}}),PJF.ui.textfield=PJF.extend(PJF.ui.component,{init:function(t){var i=this;i.value=null,i.changed=!1,i.conf=$.extend({},t),i.com.addClass("pjf_stmtextfield"),i.mouseObj={},i.conf.placeHolder&&i.setPlaceHolder(i.conf.placeHolder),i.com.wrap('<div class="pjf_stmtextfield_cntr"></div>'),i.cntr=i.com.parent(".pjf_stmtextfield_cntr"),i.disabled(i.conf.disabled),i.readOnly(i.conf.readOnly),i.setComSize(),i.bindEvents(),i.conf.defaultValue&&i.setValue(i.conf.defaultValue+""),i.conf.datatype&&i.com.bind("focus",function(){clearInterval(i.time),i.value=i.getValue(),i.time=setInterval(function(){try{var t=i.getCursorPosition(),e=i.com[0].value.substr(0,t),n=i._adjustCursorPosition(t,e);i.com[0].value=i.fixValue(i.getValue()),i.setCursorPosition(n),i.changed=i.value!=i.getValue(),i.changed||(i.value=i.getValue())}catch(t){console.log("textfield focus error : ",t.stack)}},20)}).bind("blur",function(){
clearInterval(i.time)})},modifyProperty:function(t){$.extend(this.conf,t)},setComSize:function(){var t="INPUT"===this.com[0].nodeName.toUpperCase();if(this.conf.width){var e=this.conf.width/PJF.constants.DEFAULT_FONTSIZE+"rem";this.com.css({width:e})}if(this.conf.height){var n=this.conf.height/PJF.constants.DEFAULT_FONTSIZE+"rem";t?this.com.css({height:n,"line-height":n}):this.com.css({height:n})}},fixValue:function(t,e){if(e&&(t||0==t)&&""!=t&&$.isNumeric(new Number(t))&&this.conf.precision&&(t=Number(t).toFixed(this.conf.precision)),"money"==this.conf.datatype){var n,i,o=/(\d+)(\d{3})/,a=t.indexOf(".");if(0<=a){for(n=t.substring(0,a),i=t.substring(a+1,t.length);o.test(n);)n=n.replace(o,"$1,$2");t=n+"."+i}else for(;o.test(t);)t=t.replace(o,"$1,$2")}if("card"==this.conf.datatype){var s=" ";for(o=/(\S{4})(\S+)/;o.test(t);)t=t.replace(o,"$1"+s+"$2")}if("mobile"==this.conf.datatype){s=" ";var r=/^(\d{3})(\d+)/,c=/(\d{4})(\d+)/
;for(r.test(t)&&(t=t.replace(r,"$1"+s+"$2"));c.test(t);)t=t.replace(c,"$1"+s+"$2")}return t},bindEvents:function(){var e=this;e.com.bind("mousedown",function(t){e.mouseObj.startX=t.pageX,e.mouseObj.startY=t.pageY}),e.com.bind("mouseup",function(t){e.mouseObj.endX=t.pageX,e.mouseObj.endY=t.pageY}),e.com.bind("focus",function(t){t.data&&t.data.isClick||(e.params.onFocus&&e.params.onFocus(),e.com.addClass("pjf_stmtextfield_focus"))}),e.com.bind("blur",function(){e.com.removeClass("pjf_stmtextfield_focus"),e.conf.notOpenKb||PJF.util.closeKeyboard(),e.conf.blur&&e.conf.blur(),e.setValue(e.fixValue(e.getValue(),!0)),e.validated(),e.changed&&e.conf.datatype&&(e.changed=!1,e.params.onChange instanceof Function&&e.params.onChange())}),e.conf.datatype||e.com.bind("change",function(){e.params.onChange instanceof Function&&e.params.onChange()}),e.com.bind("click",function(){""==$(this).val()&&$(this).select();var t=e.com&&e.com[0]&&e.com[0].selectionStart;console.log("click cursor position:",t),
e.com[0].setSelectionRange(t,t),Math.abs(e.mouseObj.endX-e.mouseObj.startX)<=3&&Math.abs(e.mouseObj.endY-e.mouseObj.startY)<=3&&!e.conf.notOpenKb&&PJF.util.openKeyboard(e.conf.hmode)})},validated:function(){var me=this,conf=me.conf,value=me.getValue(),$container=me.cntr,$input=me.com,$tip=me.cntr.find(".pjf_stmtextfield_msg");if(!0===conf.required){if($tip.remove(),""==value){var required=PJF.i18n.getI18nResource("pjfI18n.selectRequired");return $('<span class="pjf_stmtextfield_msg">'+required+"</span>").appendTo($container),$input.addClass("pjf_stmtextfield_error"),$container.find(".pjf_stmtextfield_msg").css({top:$input.height()}),required}$input.removeClass("pjf_stmtextfield_error")}else if(""==value)return $tip.remove(),void $input.removeClass("pjf_stmtextfield_error");if(null!=conf.validType){var msgArray=[];if(conf.validType&&(conf.validType instanceof Array||(conf.validType=[conf.validType],conf.invalidMessage=[conf.invalidMessage]),
conf.validType instanceof Array))for(var i in conf.validType){var msg=conf.invalidMessage[i],typeParam=/([a-zA-Z0-9_]+)(.*)/.exec(conf.validType[i]),rule=PJF.validator.rules()[typeParam[1]],status=rule(value,eval(typeParam[2]));status||msgArray.push(msg)}var msgStr=msgArray.join("、");return $tip.remove(),""!=msgStr?($('<span class="pjf_stmtextfield_msg">'+msgArray.join("、")+"</span>").appendTo($container),$input.addClass("pjf_stmtextfield_error"),$container.find(".pjf_stmtextfield_msg").css({top:$input.height()})):$input.removeClass("pjf_stmtextfield_error"),msgStr}},disabled:function(t){this.com.attr("disabled",t)},readOnly:function(t){var e=this;this.readOnlyFlag!=t&&(this.readOnlyFlag=t,e.com.attr("readOnly",t),t?(e.overlayer=$('<div class="pjf_stmtextfield_overlayer"></div>'),e.overlayer.bind("click",function(t){return e.focus(),!1}),e.cntr.append(e.overlayer)):e.cntr.find(".pjf_stmtextfield_overlayer").remove())},setValue:function(t,e){
("INPUT"===this.com[0].nodeName.toUpperCase()||"string"!=typeof t||(t=(t=t.replace(new RegExp("\\\\n","gm"),"\n")).replace(new RegExp("\\\\r","gm"),"\r")),e)&&(e=this.com[0].value!=t);this.com[0].value=this.fixValue(t,!0),e&&this.params.onChange&&this.params.onChange()},getValue:function(){var t=this.com.val();return"money"==this.conf.datatype?t=t.replace(new RegExp(",","gm"),""):"card"!=this.conf.datatype&&"mobile"!=this.conf.datatype||(t=t.replace(new RegExp(" ","gm"),"")),PJF.util.trim(t)},getPlaceHolder:function(){return this.com.attr("placeHolder")},setPlaceHolder:function(t){this.com.attr({placeHolder:t})},focus:function(){this.readOnly?($(".pjf_stmtextfield").removeClass("pjf_stmtextfield_focus"),this.com.addClass("pjf_stmtextfield_focus"),$("body").bind("click.stmtextfield",function(){$(".pjf_stmtextfield").removeClass("pjf_stmtextfield_focus"),$("body").unbind("click.stmtextfield")}),this.params.onFocus&&this.params.onFocus()):this.com.focus()},blur:function(){this.com.blur()
},getCursorPosition:function(){var t=0;if(document.selection){var e=document.selection.createRange();e.text="",e.setEndPoint("StartTpStart",this.com[0].createTextRange()),t=e.text.length}else t=this.com[0].selectionStart;return t},setCursorPosition:function(t){if(document.selection){document.selection.createRange();var e=this.com[0].createTextRange();e.moveStart("character",t),e.collapse(),e.select()}else this.com[0].setSelectionRange(t,t)},_adjustCursorPosition:function(t,e){var n=0;return" "==e.substr(e.length-1,1)&&(n=1),t+(this.fixValue(e.replace(/\s/g,"")).length-e.length)+n},destroy:function(){clearInterval(this.time),this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null}}),PJF.ui.simpleTable=PJF.extend(PJF.ui.component,{init:function(t){this.options={width:600,height:400},$.extend(this.options,t),this._widthCalculate(),this.createDom(),this.adjustCss(),this.bindEvent()},createDom:function(){this._createFrame(),this._getDOMRefer(),
this._createHead(),this._createRows()},_createFrame:function(){this.com.append("<div  class='pjf_stmTable_head'><table class='f'  border=0 ><thead class='bh'></thead></table></div><div class='pjf_stmTable_body'><table class='f'><tbody></tbody></table> </div>")},_widthCalculate:function(){var t=this.options,e=t.column,n=e[e.length-1],i=parseInt($("html").css("font-Size"))/PJF.constants.DEFAULT_FONTSIZE,o=0;$.each(n,function(t,e){if(isNaN(Number(e.width))){var n=e.title.length;e.width=24*n}o+=Number(e.width)});var a=17+(n.length-1)+2;if(o<t.width-a/i){var s=(t.width-a/i-o)/n.length;$.each(n,function(t,e){e.width+=s})}},_getDOMRefer:function(){this.head=this.com.find(".pjf_stmTable_head"),this.body=this.com.find(".pjf_stmTable_body"),this.headContent=this.head.find("thead"),this.bodyContent=this.body.find("tbody")},_createHead:function(){var t,n,m;t=this.options,n=t.column,m=[],$.each(n,function(t,e){var u=e.length,d=t==n.length-1,h=0==t;m.push("<tr>"),$.each(e,function(t,e){
var n=e.colspan,i=e.title,o=e.field,a=e.width,s=t==u-1,r="bt br",c="bb";h&&(r=r.replace("bt","")),s&&(r=r.replace("br","")),d&&(c=c.replace("bb",""));var l="<th field='"+o+"' colspan='"+n+"' class='"+r+"'><div style='width:"+(d?a/PJF.constants.DEFAULT_FONTSIZE:"")+"rem'>"+i+"</div></th>";s&&(l+="<th class='empty "+c+"' style='border-left: none'><div style='width:17px'></div></th>"),m.push(l)}),m.push("</tr>")}),this.headContent.append(m.join())},_createRows:function(){var t,e,r,c;t=this.options,$.isPlainObject(t.data)?t.data=[].concat(t.data):void 0===t.data&&(t.data=[]),r=[],e=t.data,c=t.column[t.column.length-1],$.each(e,function(t,s){r.push("<tr rowIndex='"+t+"'>"),$.each(c,function(t,e){var n=t==c.length-1,i=s[e.field],o=e.align||"center",a="<td class='"+(n?"bb":"br bb")+"'><div style='padding:0 4px;width:"+e.width/PJF.constants.DEFAULT_FONTSIZE+"rem' align='"+o+"'>"+i+"</div></td>";n&&(a+="<th class='empty bb'><div style='width:17px'></div></th>"),r.push(a)}),r.push("</tr>")}),
this.bodyContent.append(r.join())},_clearTable:function(){this.options.data=[],this.bodyContent.empty()},adjustCss:function(){var t,e,n,i,o;t=this.options,i=(e=parseInt($("html").css("font-Size")))/PJF.constants.DEFAULT_FONTSIZE,n=this.head.height(),o=t.height*i-n,this.com.css({width:t.width/PJF.constants.DEFAULT_FONTSIZE+"rem",height:t.height/PJF.constants.DEFAULT_FONTSIZE+"rem"}),this.body.css({height:o/e+"rem"}),PJF.util.deviceType.icm&&(this.body.addClass("pjf_stmTable_showScroll"),this.body.find(".empty>div").css({width:"0px"}))},bindEvent:function(){var e,n;e=(n=this).options,this.body.off("click").on("click","[rowIndex]",function(){var t=$(this).attr("rowIndex");$.isFunction(e.onClick)&&e.onClick.call(t,e.data[t])}),this.body.off("scroll").on("scroll",function(){var t=$(this).scrollLeft();this.scrollWidth,e.width;n.head.scrollLeft(t)})},loadData:function(t){var e;e=this.options,this._clearTable(),
$.isPlainObject(t)?e.data=[].concat(t):$.isArray(t)?e.data=t:alert("传入参数类型必须为数组或对象"),this._createRows(),PJF.util.deviceType.icm&&this.body.find(".empty>div").css({width:"0px"})}}),PJF.apply(PJF.ui.simpleTable.prototype,{getClassName:function(){return"PJF.ui.simpleTable"},destroy:function(){this.com.remove(),this.com=null,PJF.ui.componentMgr.remove(this.id)}}),PJF.ui.label=PJF.extend(PJF.ui.component,{init:function(t){this.options={align:"justify",separator:":",fontWeight:"bold",onClick:function(){}},$.extend(this.options,t),this.options.dom&&(this.options.doms=[this.options.dom]),this.options.value&&(this.options.values=[this.options.value]),this.jqComs=[];var i=this;this.options.doms.reduce(function(t,e,n){i.jqComs.push($("#"+e))},{}),this.initHtml(),this.bindEvent()},bindEvent:function(){var n=this,t=n.options.doms;setTimeout(function(){$.each(t,function(t,e){$("#"+e).on("click",function(){n.options.onClick instanceof Function&&n.options.onClick.call(this,t)})})},0)},
initHtml:function(){var i=this.options;switch(this.options.align){case"justify":$.each(i.doms,function(t,e){var o="",n=i.width/PJF.constants.DEFAULT_FONTSIZE||1.2,a=n/.3,s=i.values[t].length;$.each(i.values[t].split(""),function(t,e){if(a<s){var n=s-s%a,i=s%a;o+=t<n?"<span class='stm_lable_sub' style='width:"+1/a*100+"%;'>"+e+"</span>":"<span class='stm_lable_sub stm_lable_remain' style='width:"+1/i*100+"%;'>"+e+"</span>",a%(t+1)==0&&0<t&&(o+="<br/>")}else o+="<span class='stm_lable_sub' style='width:"+1/s*100+"%;'>"+e+"</span>"}),o="<div class='stm_lable "+("normal"==i.fontWeight?"stm_lable_normal":"")+"' "+(i.width?"style='width:"+i.width/PJF.constants.DEFAULT_FONTSIZE+"rem;'":"")+">"+o+"</div><span class='stm_lable_sep'>"+i.separator+"</span>",$("#"+e).append(o),$("#"+e).find(".stm_lable_remain").first().css("text-align","left"),$("#"+e).find(".stm_lable_remain").last().css("text-align","right")});break;case"redefined":$.each(i.doms,function(t,e){var n=""
;n="<div class='stm_lable "+("normal"==i.fontWeight?"stm_lable_normal":"")+"' "+(i.width?"style='"+i.cssStyle+"; width:"+i.width/PJF.constants.DEFAULT_FONTSIZE+"rem;'":"")+"><span>"+i.values[t]+"</span></div><span class='stm_lable_sep'>"+i.separator+"</span>",$("#"+e).append(n)});break;default:alert("no such style")}},setValue:function(t){var e=this.options.doms,n=this.options.values;$.isPlainObject(t)&&(t=[].concat(t)),$.each(t,function(t,e){n[e.index]&&(n[e.index]=e.value)}),$.each(e,function(t,e){$("#"+e).empty()}),this.initHtml()},getValue:function(n){var t=this.options.values,i=[];return n=[].concat(n),$.each(t,function(t,e){(void 0===n[0]||-1<$.inArray(t,n))&&i.push({key:t,value:e})}),i}}),PJF.apply(PJF.ui.label.prototype,{destroy:function(){for(var t=0;t<this.jqComs;t++)this.jqComs[t].remove();PJF.ui.componentMgr.remove(this.id)}}),PJF.ui.voice=PJF.extend(PJF.ui.component,{init:function(i){
var t="<div class='pjf-voice-boxContainer'><div class='pjf-voice-mask'></div><div class='pjf-voice-content'><img class='pjf-voice-content-cancel' src='icon/hp_smartCancel.png'>"+(PJF.otherInfo.isSelfBank?"":"<div class='pjf-voice-boxTitle'><span style='color: red;'>温馨提示：</span><span class='pjf-voice-boxTitle-span'>{{:title}}</span></div>")+"<div class='pjf-voice-boxImg'></div><div class='pjf-voice-boxFooter'>点击麦克风按钮，开始语音输入!</div></div></div>",o=this;i.keepCss||this.com.addClass("pjf-voice");var a={file:PJF.stm.baseDir+"/identity/yuyin.wav",param:'appid=1zh5Gy6J,svc=iatnlp,auf=audio/L16;rate=16000,aue=raw,type=1,uid=660Y5r,url=128.128.98.38:1028,extend_params={"params":"org=stm,token=D2572A0D1,ability=ab_atsnlp,eos=2000"}'};PJF.constants.ON_PROD&&$.extend(a,{param:'appid=1zh5Gy6J,svc=iatnlp,auf=audio/L16;rate=16000,aue=raw,type=1,uid=660Y5r,url=11.49.186.17:1028,extend_params={"params":"org=stm,token=D2572A0D1,ability=ab_atsnlp,eos=2000"}'}),this.com.off("click").on("click",function(){
o.msgBox=$(PJF.html.template(t,{title:i.title})).appendTo($("body")),o.msgBox.find(".pjf-voice-boxImg").on("click",function(){var t=PJF.communication.IAT.StartTransForm(a.param,function(){}),e=t;if("string"==typeof t&&(e=JSON.parse(t)),e.success){var n=new PJF.ui.loading({msg:"语音录入中"});PJF.communication.IAT.StartRecording(a.file,function(t){n&&n.destroy(),console.log("声音解析结果:"+t);var e="string"==typeof t?JSON.parse(t):t;i.afterRecord&&i.afterRecord(e)}),o.hideBox()}else new PJF.ui.errorMessageBox({content:"语音识别失败<br>"+e.error,buttonConfs:[{style:"main",name:"确定",width:200,height:80,onClick:function(){o.hideBox()}}]})}),o.msgBox.find(".pjf-voice-content-cancel").on("click",function(){PJF.communication.IAT.StopRecording(function(t){console.log("语音停止识别结果:"+t)}),i.cancel&&i.cancel(),o.hideBox()})})},hideBox:function(){this.msgBox&&(this.msgBox.off("click"),this.msgBox.remove())},destroy:function(){this.hideBox(),PJF.ui.componentMgr.remove(this.id),this.com.remove()}}),
PJF.ui.areaSelector=PJF.extend(PJF.ui.component,{init:function(t){this.options={provinceDomId:this.generateId(),cityDomId:this.generateId(),countyDomId:this.generateId(),cityName:!0,countyName:!0,nullOption:!1,nullLabel:!1,categoryId:"110256"},$.extend(this.options,t);this.initHtml(),this.initData()},initHtml:function(){var t=this;$("#"+t.options.dom).append('<div class="stm_as_container"></div>');var e=t.com.find(".stm_as_container"),n=t.options,i=n.nullLabel?"":"省";e.append("<span id='"+n.provinceDomId+"'></span><span class='stm_as_prelabel'>"+i+"</span>");var o={dom:n.provinceDomId,nullOption:n.nullOption,textAlign:"center",placeholder:n.nullLabel?"省":"",width:n.width||160,onChange:function(){t.provinceOnChange(),n.provinceOnChange instanceof Function&&n.provinceOnChange(t.getProvinceValue())}};if(n.provinceSelect=new PJF.ui.select(o),n.cityName){i=n.nullLabel?"":"市";e.append("<span id='"+n.cityDomId+"'></span><span class='stm_as_prelabel'>"+i+"</span>");var a={dom:n.cityDomId,
nullOption:n.nullOption,textAlign:"center",width:n.width||160,placeholder:n.nullLabel?"市":"",onChange:function(){t.cityOnChange(),n.cityOnChange instanceof Function&&n.cityOnChange(t.getCityValue())}};n.citySelect=new PJF.ui.select(a)}if(n.countyName){i=n.nullLabel?"":"区";e.append("<span id='"+n.countyDomId+"'></span><span class='stm_as_prelabel'>"+i+"</span>");var s={dom:n.countyDomId,placeholder:n.nullLabel?"区":"",nullOption:n.nullOption,textAlign:"center",width:n.width||160,onChange:function(){n.countyOnChange instanceof Function&&n.countyOnChange(t.getCountyValue())}};n.countySelect=new PJF.ui.select(s)}},sendRequest:function(t){var e=[];return this.options.appId?PJF.communication.getStandardCode({categoryId:this.options.categoryId,appId:this.options.appId,clcd:t,async:!1,success:function(t){t.forEach(function(t){t.name=t.itemValue,t.desc=t.itemName}),e=t}}):PJF.communication.ajax({url:"ecpJson?_fw_service_id=getCitys&inData={}&provinceCode="+t,type:"get",dataType:"json",async:!1,
success:function(t){e=t},failure:function(){console.log("请求数据失败！")}}),e},provinceOnChange:function(){var t=this.options,e=t.provinceSelect.getValue(),n=t.provinceSelect.getText();if(""!=e){if(t.appId||e!=PJF.constants.AREA_BEIJING&&e!=PJF.constants.AREA_TIANJING&&e!=PJF.constants.AREA_SHANGHAI&&e!=PJF.constants.AREA_CHONGQING){if(t.cityName){var i=this.sendRequest(e);t.citySelect.setData(i),t.citySelect.setValue(""),t.countyName&&(t.countySelect.setData([]),t.countySelect.setValue(""))}}else if(t.cityName){var o=[{name:e,desc:n}];if(t.citySelect.setData(o),t.citySelect.setValue(""),t.countyName){var a=this.sendRequest(e);t.countySelect.setData(a),t.countySelect.setValue("")}}}else t.nullOption&&t.cityName&&(t.citySelect.setData([]),t.countyName&&t.countySelect.setData([]))},cityOnChange:function(){var t=this.options,e=t.citySelect.getValue();if(""!=e){if(t.countyName){var n=this.sendRequest(e);t.countySelect.setData(n),t.countySelect.setValue("")}
}else t.nullOption&&t.countyName&&t.countySelect.setData([])},initData:function(){var t=this.options,e=this.sendRequest(t.clcd?t.clcd:"101573");t.provinceSelect.setData(e)},getProvinceValue:function(){return this.options.provinceSelect.getValue()},getProvinceText:function(){return this.options.provinceSelect.getText()},getCityValue:function(){return this.options.citySelect.getValue()},getCityText:function(){return this.options.citySelect.getText()},getCountyValue:function(){return this.options.countySelect.getValue()},getCountyText:function(){return this.options.countySelect.getText()},disable:function(){this.options.provinceSelect.disabled(),this.options.citySelect.disabled(),this.options.countySelect.disabled()},enable:function(){this.options.provinceSelect.enable(),this.options.citySelect.enable(),this.options.countySelect.enable()},readOnly:function(t){this.options.provinceSelect&&this.options.provinceSelect.readOnly(t),this.options.citySelect&&this.options.citySelect.readOnly(t),
this.options.countySelect&&this.options.countySelect.readOnly(t)},setReadOnly:function(t){},setProvinceValue:function(t){this.options.provinceSelect.setValue(t)},setCityValue:function(t){this.provinceOnChange(),this.options.citySelect.setValue(t)},setCountyValue:function(t){this.cityOnChange(),this.options.countySelect.setValue(t)},setValue:function(t){if(6==t.length){var e=t.substring(0,2)+"0000";if(this.options.provinceSelect.setValue(e),this.options.cityName){this.provinceOnChange();var n=t.substring(0,4)+"00";if(e!=PJF.constants.AREA_BEIJING&&e!=PJF.constants.AREA_TIANJING&&e!=PJF.constants.AREA_SHANGHAI&&e!=PJF.constants.AREA_CHONGQING?this.options.citySelect.setValue(n):this.options.citySelect.setValue(e),this.options.countyName){this.cityOnChange();this.options.countySelect.setValue(t)}}}},getClassName:function(){return"PJF.ui.areaSelector"},destroy:function(){this.options.provinceSelect.destroy(),this.options.cityName&&this.options.citySelect.destroy(),
this.options.countyName&&this.options.countySelect.destroy(),this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null}}),PJF.apply(PJF.ui.areaSelector.prototype,{}),PJF.ui.select=PJF.extend(PJF.ui.component,{init:function(t){this.options={baseFontSize:30,width:240,initLabel:null,prefix:!1,placeholder:"",resizeFontSize:!0,inputId:this.generateId(),selectId:this.generateId(),textAlign:"left",optionAlign:"center",showUp:!1,multiple:!1,timeoutId:null,onChange:null,containerId:this.generateId()},$.extend(this.options,t),this.options.multiple&&!t.optionAlign&&(this.options.optionAlign="left");this.initHtml(),this.initCss(),this.initData(),this.bindEvents()},autoComplete:function(){var e=this,n=this.com.find(".stm_select_input");n.removeAttr("readonly"),e.options.autoComplete&&!e.options.fnAjax&&(window.clearInterval(e.intervalId),e.intervalId=window.setInterval(function(){var t=n.val().trim();e.preValue!=t&&(e.onKeyPress(),e.preValue=t)},300)),
e.options.fnAjax instanceof Function&&(window.clearInterval(e.intervalId),e.intervalId=window.setInterval(function(){var t=n.val().trim();e.preValue!=t&&(e.options.fnAjax(t),e.preValue=t)},300))},triggerKeyup:function(){this.com.find(".stm_select_input").trigger("keyup")},onKeyPress:function(){var t=this.com.find(".stm_select_input").val().trim(),e=[],n=this.data;if(""===t)e=n;else for(var i=0;i<n.length;i++)0<=n[i].desc.toLowerCase().indexOf(t,0)&&e.push(n[i]);this.hideDiv();var o=$("#"+this.options.selectId);o.find("option").remove(),o.append(this.formatter(e)),this.addDiv(this.options.selectId,this.options.inputId,this.options.containerId)},initHtml:function(){var t=this.options,e='<div class="stm_select_root"><div class="stm_select_container">';e+='<input placeholder="'+t.placeholder+'" readonly="readonly"   id="'+t.inputId+'" class="stm_select_input stm_select_input_'+t.textAlign+'"/><select style="display:none"  id="'+t.selectId+'"></select>',
t.initLabel&&(e+='<div class="stm_select_initLable">'+t.initLabel+"</div>"),e+="</div></div>",$("#"+t.dom).append(e)},initCss:function(){var t=this.options,e=this.com.find(".stm_select_container"),n=this.com.find(".stm_select_initLable"),i=this.com.find(".stm_select_input");if(e.css({width:t.width/PJF.constants.DEFAULT_FONTSIZE+"rem"}),t.initLabel){var o=n.eq(0).width();t.prefix?(n.css({left:"0.1rem"}),i.css({"padding-left":(o+15)/PJF.constants.DEFAULT_FONTSIZE+"rem"})):i.css({"padding-right":(o+15)/PJF.constants.DEFAULT_FONTSIZE+"rem"})}else{var a=(t.width-35)/PJF.constants.DEFAULT_FONTSIZE,s=(t.width-25)/PJF.constants.DEFAULT_FONTSIZE,r=35/PJF.constants.DEFAULT_FONTSIZE,c=25/PJF.constants.DEFAULT_FONTSIZE;!0===t.autoComplete?i.addClass("stm_select_input_bg_auto").css({"padding-right":r+"rem","background-position":a+"rem center"}):i.addClass("stm_select_input_bg").css({"padding-right":c+"rem","background-position":s+"rem center"})}
(this.options.autoComplete||this.options.fnAjax)&&i.removeAttr("readonly"),this.options.multiple&&i.attr("readonly","readonly")},initData:function(){var e=this;if(e.options.url){e.sendRequest("101573",function(t){e.setData(t)},function(){})}else e.options.data?e.setData(e.options.data):e.setData([]);if(!e.options.initLabel&&!e.options.multiple){var t=$("#"+e.options.selectId).find("option").eq(0).val();t=t||"",e.setValue(t)}e.options.nullOption&&e.setValue(""),this.options.defaultValue&&e.setValue(this.options.defaultValue)},bindEvents:function(){var n=this;$("#"+this.options.inputId).unbind("focus").bind("focus",function(){(n.options.autoComplete||n.options.fnAjax instanceof Function&&PJF.communication.isInClient())&&PJF.util.openKeyboard(n.options.hmode),n.addDiv(n.options.selectId,n.options.inputId,n.options.containerId),n.options.onFocus instanceof Function&&n.options.onFocus()}).unbind("blur").bind("blur",function(t,e){
PJF.otherInfo.typeInfo!=PJF.constants.ICM_NAME&&(console.log("blur==========================="),!0!==e&&(console.log("blur==========+hideDiv================="),n.hideDiv(),n.validated())),(n.options.autoComplete||n.options.fnAjax instanceof Function&&PJF.communication.isInClient())&&PJF.util.closeKeyboard()}).unbind("change").bind("change",function(){n.options.onChange instanceof Function&&n.options.onChange()}),this.options.initLabel&&this.com.find(".stm_select_initLable").unbind("click").bind("click",function(){$("#"+n.options.inputId).trigger("focus")})},unbindEvents:function(){$("#"+this.options.inputId).unbind("focus").unbind("blur").unbind("change"),this.options.initLabel&&this.com.find(".stm_select_initLable").unbind("click")},unbindBlurEvent:function(){console.log("unbindBlurEvent===========================");var t=this.options.doms;if("date"==this.options.selType)for(var e=0;e<t.length;e++){var n=PJF.ui.componentMgr.get($("#"+t[e]).attr("componentid"))
;$("#"+n.options.inputId).unbind("blur")}else $("#"+this.options.inputId).unbind("blur")},bindBlurEvent:function(){console.log("bindBlurEvent===========================");var i=this,o=i.options.doms;$("#"+this.options.inputId).unbind("blur").bind("blur",function(t,e){if(console.log("new + blur==========================="),!0!==e)if(console.log("new + blur============+hideDiv==============="),"date"==i.options.selType)for(var n=0;n<o.length;n++){PJF.ui.componentMgr.get($("#"+o[n]).attr("componentid")).hideDiv()}else i.hideDiv(),i.validated();(i.options.autoComplete||i.options.fnAjax instanceof Function&&PJF.communication.isInClient())&&PJF.util.closeKeyboard()})},showErrorMsg:function(){},sendRequest:function(t,e,n){var i=this;PJF.communication.ajax({url:i.options.url,type:"get",dataType:"json",async:!1,success:function(t){i.data=t,e instanceof Function&&e(t)},failure:function(){n instanceof Function&&n()}})},hideDiv:function(){window.clearInterval(this.intervalId),
$("#"+this.options.containerId).remove()},addDiv:function(t,i,e){var a=this;(a.options.autoComplete||a.options.fnAjax instanceof Function)&&a.autoComplete();$("#"+i).offset();var n=$("#"+i).attr("disabled"),o=$("#"+i).hasClass("pjf_readonly_input");if(!n&&!o){$("#"+e).remove();var s="<div id="+e+" class='area_ctrlarea'><div class='area_negative"+(PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME?"":" area_negative_noScroll")+(a.options.multiple?" multiple":"")+"'><ul class='area_div"+("left"==a.options.optionAlign?" alignLeft":"")+"'>",r=0;if($("#"+t).find("option").each(function(t){var e=$(this).attr("value"),n=$(this).text();if("date"!=a.options.selType&&a.options.resizeFontSize){var i=n.match(/[1-9a-zA-Z]/g)||[],o=2*(n.length-i.length)+i.length;r=(r=parseInt((2*a.options.width-30)/o))>a.options.baseFontSize?a.options.baseFontSize:r,r/=PJF.constants.DEFAULT_FONTSIZE,
"data-selected"==$(this).attr("data-selected")?(s+="<li data-value='"+e+"' style='font-size:"+r+"rem;' class='areaSelected'",t):s+="<li data-value='"+e+"' style='font-size:"+.9*r+"rem;'"}else"data-selected"==$(this).attr("data-selected")?(s+="<li data-value='"+e+"' class='areaSelected'",t):s+="<li data-value='"+e+"'";s+=">"+n+"</li>"}),s+="</ul></div></div>",a.options.showToBody?$(s).appendTo($("body")):$(s).appendTo(a.com.find(".stm_select_root")),$("#"+e).find(".area_div li").unbind("click").bind("click",function(){console.log("===============click:"+$(this).text());var t=$(this).attr("data-value");if((a.options.autoComplete||a.options.fnAjax instanceof Function)&&window.clearInterval(a.intervalId),a.options.multiple?$(this).hasClass("areaSelected")?($(this).removeClass("areaSelected"),$(this).css("font-size",.9*r+"rem"),a.setValue(t,!1,!0)):($(this).addClass("areaSelected"),$(this).css("font-size",r+"rem"),a.setValue(t)):a.setValue(t),
PJF.otherInfo.typeInfo!=PJF.constants.ICM_NAME)a.bindBlurEvent();else if("date"==a.options.selType)for(var e=a.options.doms,n=0;n<e.length;n++){PJF.ui.componentMgr.get($("#"+e[n]).attr("componentid")).hideDiv()}else a.hideDiv();a.options.multiple?$("#"+i).trigger("change"):"date"==a.options.selType?($("#"+i).trigger("change"),PJF.otherInfo.typeInfo!=PJF.constants.ICM_NAME?$("#"+i).trigger("blur").trigger("focus"):$("#"+i).trigger("blur")):($("#"+i).trigger("change"),$("#"+i).trigger("blur"))}),$("#"+e).css({width:a.options.width/PJF.constants.DEFAULT_FONTSIZE+"rem"}),5<=$("#"+t).find("option").length&&$("#"+e).find(".area_negative").css({height:248/PJF.constants.DEFAULT_FONTSIZE+"rem"}),a.options.showToBody){var c=$("#"+i)[0].getBoundingClientRect().top+$("#"+i).height()+1,l=$("#"+i)[0].getBoundingClientRect().left;if((u=$("#"+e).height())<$(window).height()-c)$("#"+e).css({top:c,left:l});else{c=$("#"+i)[0].getBoundingClientRect().top-u-1;$("#"+e).css({top:c,left:l})}}
if(a.options.showUp){var u=$("#"+e).height();$("#"+e).css({top:"-"+u+"px"})}a.options.areaZIndex&&$("#"+e).css("z-index",a.options.areaZIndex),PJF.otherInfo.typeInfo!=PJF.constants.ICM_NAME&&$("#"+e).find(".area_div").attr("tabIndex","-1").unbind("mousedown").bind("mousedown",function(t){console.log("mousedown==========================="),a.unbindBlurEvent()}).unbind("mouseleave").bind("mouseleave",function(t){console.log("mouseout==========================="),$("#"+a.options.inputId).trigger("blur",!a.options.multiple),console.log("******************trigger blur finished********************"),a.bindBlurEvent()}).unbind("blur").bind("blur",function(t){console.log("add blur-------------------------"),0<a.com.find(".stm_select_root").find($(document.activeElement)).length||a.hideDiv()})}},formatter:function(t){for(var e="",n=0;n<t.length;n++)e+="<option value='"+t[n].name+"'>"+t[n].desc+"</option>";return e},getValue:function(){var t=$("#"+this.options.selectId)
;if(""===$("#"+this.options.inputId).val())return"";if(this.options.multiple){var e=new Array;return t.find("option[data-selected]").each(function(){var t=$(this).val();t&&e.push(t)}),e}var n=t.find("option[data-selected]").val();return n||""},getText:function(){return $("#"+this.options.inputId).val()},setText:function(t){$("#"+this.options.inputId).val(t)},setValue:function(n,t,i){var o=this,e=$("#"+o.options.inputId),a=$("#"+o.options.selectId),s=1;o.options.autoComplete&&!o.options.fnAjax&&(o.hideDiv(),(a=$("#"+o.options.selectId)).find("option").remove(),a.append(o.formatter(o.data)));if($.isArray(n)&&o.options.multiple){var r=n;for(var c in a.find("option").each(function(){$(this).val||$(this).removeAttr("data-selected")}),r)r[c]&&$("#"+o.options.selectId+" option[value="+r[c]+"]").attr("data-selected","data-selected")}else o.options.multiple||a.find("option").each(function(){$(this).removeAttr("data-selected")}),a.find("option").each(function(){if($(this).val()==n){
if(i)$(this).removeAttr("data-selected");else{o.preValue=$(this).text(),$(this).attr("data-selected","data-selected");var t=$(this).text(),e=t.match(/[1-9a-zA-Z]/g)||[];s=2*(t.length-e.length)+e.length}return!1}});var l=[];if(a.find("option[data-selected='data-selected']").each(function(){""!=$(this).val()&&null!=$(this).val()&&l.push($(this).text())}),0<l.length?e.val(l.toString()):e.val(a.find("option[data-selected]").eq(0).text()),""!==n||o.options.nullOption)o.options.initLabel&&o.options.hideLabelForNull&&((u=o.com.find(".stm_select_initLable")).css({display:"none"}),$("#"+this.options.inputId).css({"padding-right":"0.05rem"}));else if(e.val(""),o.options.initLabel&&o.options.hideLabelForNull){var u,d=(u=o.com.find(".stm_select_initLable")).eq(0).width();u.css({display:"block"}),e.css({"padding-right":(d+15)/PJF.constants.DEFAULT_FONTSIZE+"rem"})}"date"==o.options.selType&&$("#"+o.options.inputId).trigger("change"),t&&$("#"+o.options.inputId).trigger("change")
;var h=parseInt((2*o.options.width-40)/s);h=h>o.options.baseFontSize?o.options.baseFontSize:h,h/=PJF.constants.DEFAULT_FONTSIZE,"date"!=o.options.selType&&o.options.resizeFontSize&&e.css({"font-size":.9*h+"rem"})},setData:function(t){var e=this,n=$("#"+e.options.selectId),i=$("#"+e.options.containerId);e.data=t,n.find("option").remove(),n.append(e.formatter(t)),e.options.nullOption&&(n.prepend("<option value=''>"+(e.options.nullOptionText||PJF.i18n.getI18nResource("pjfCommon.selectNull"))+"</option>"),e.select(0)),0<i.length&&"date"!=e.options.selType&&(e.hideDiv(),e.addDiv(e.options.selectId,e.options.inputId,e.options.containerId))},getData:function(){return this.data},select:function(t){var e=$("#"+this.options.selectId).find("option").eq(t).val();this.setValue(e)},readOnly:function(t){var e=this,n=this.com.find(".stm_select_container"),i=this.com.find(".stm_select_input");t?(i.attr("readonly","readonly"),e.overlayer=$('<div class="pjf_stmtextfield_overlayer"></div>'),
e.overlayer.bind("click",function(t){return e.overlayer.focus(),!1}),n.append(e.overlayer)):(i.removeAttr("readonly"),n.find(".pjf_stmtextfield_overlayer").remove())},validated:function(){var t=this.options,e=this.getValue(),n=this.com.find(".stm_select_root"),i=this.com.find(".stm_select_container"),o=this.com.find(".pjf_stmtextfield_msg");if(!0===t.required){if(o.remove(),""==e){var a=PJF.i18n.getI18nResource("pjfI18n.selectRequired");return $('<span class="pjf_stmtextfield_msg">'+a+"</span>").appendTo(n),i.addClass("pjf_stmtextfield_error"),n.find(".pjf_stmtextfield_msg").css({top:i.height()}),a}i.removeClass("pjf_stmtextfield_error")}},disabled:function(){$("#"+this.options.inputId).attr("disabled","disabled")},enable:function(){$("#"+this.options.inputId).removeAttr("disabled")},show:function(){this.com.css({display:"inline-block"})},hide:function(){this.com.css({display:"none"})}}),PJF.apply(PJF.ui.select.prototype,{getClassName:function(){return"PJF.ui.select"},
destroy:function(){$("#"+this.options.containerId).remove(),this.com.remove(),PJF.ui.componentMgr.remove(this.id),window.clearInterval(this.intervalId),this.com=null,this.params=null,this.id=null}}),PJF.ui.process=PJF.extend(PJF.ui.component,{init:function(t){this.options={},$.extend(this.options,t);var e=this.options;this.com.addClass("stm-process");var n=this.initHtml();e.dom&&this.com.append(n),this.adjustCsstyle()},adjustCsstyle:function(){var t=this.options.data;this.com.find("li").css({width:100/(t.length-1)-.5+"%"});var e=this.com.find("li.stepBridge").width(),n=this.com.find("div.stepIco").width();this.com.find(".stepText").css({width:e/PJF.constants.DEFAULT_FONTSIZE+"rem",marginLeft:-(e-n)/(2*PJF.constants.DEFAULT_FONTSIZE)+"rem"}),this.com.find(".stepIco:first").addClass("doingIcon").children().addClass("doing")},initHtml:function(){var t=this.options.data;console.log(t);var e=[];for(var n in e.push('<div class="stepInfo">'),e.push("<ul>"),t){if(n==t.length-1)break
;e.push('<li class="stepBridge"></li>')}e.push("</ul>");var i=0,o=690/(t.length-1);for(var a in t)e.push('<div><div style="top:-0.07rem;left:'+parseInt(i-5)/PJF.constants.DEFAULT_FONTSIZE+'rem" class="stepIco stepIco'+(parseInt(a)+1)+'"><div class="stepText">'+t[a]+"</div></div></div>"),i+=o;return e.push("</div>"),e.join("")}}),PJF.apply(PJF.ui.process.prototype,{getClassName:function(){return"PJF.ui.process"},setDoing:function(e){this.com.find("div.stepIco").each(function(t){t+1<e?($(this).removeClass("doingIcon").addClass("done"),$(this).children().removeClass("doing").addClass("done")):e<t+1?($(this).removeClass("doingIcon done"),$(this).children().removeClass("doing").removeClass("done")):($(this).removeClass("done").addClass("doingIcon"),$(this).children().removeClass("done").addClass("doing"))}),this.com.find("li.stepBridge").each(function(t){t+1<e?$(this).addClass("done"):$(this).removeClass("done")})},destroy:function(){this.com.remove(),PJF.ui.componentMgr.remove(this.id)}}),
PJF.ui.pie=PJF.extend(PJF.ui.component,{init:function(t){this.colorStore=["#e40002","#48bd33","#3366cc","#cc6633","#999933","#996699","#3399cc","#cc9933","#9999cc","#8cb469","#65666d","#fab042","#91abbc","#1edefd","#e0f080","#c9daff","#b49369","#8e97b3","#87fdff","#cc9999"],this.options={size:{w:null,h:null},precision:1,scaleRate:1,scanStep:Math.PI/1440,initAngle:Math.PI/6},$.extend(this.options,t),this.trimData(),this.scalePixel(),this.createDom(),this.drawWhat(),this.bindEvent()},scalePixel:function(){var t=this.options.scaleRate=parseFloat($("html").css("fontSize"))/100,e=this.options,o=function(t,e,n){for(var i in t)"number"==typeof t[i]&&-1==e.indexOf(i)?t[i]=t[i]*n:$.isPlainObject(t[i])&&o(t[i],e,n)};o(e,["tipRowNum","precision"],t)},createDom:function(){var t=this.options,e=this.options.size={w:t.width||this.com.width(),h:t.height||this.com.height()};this.com.html("<canvas width = "+e.w+" height = "+e.h+"></canvas>"),this.canvas=this.com.find("canvas"),
this.pen=this.canvas[0].getContext("2d")},trimData:function(){},drawWhat:function(t){this.options.type="ring";try{this["draw_"+this.options.type](t)}catch(t){alert(t.message)}},bindEvent:function(){var o=this;o.canvas.on("mousedown",function(t){var e,n,i=(e=t,n=o.canvas.offset(),{x:e.clientX-n.left,y:e.clientY-n.top});o._clearAll(),o.drawWhat(i)})},draw_ring:function(t,e){var n=this.options.ringParams,i=n.radius,o=n.ringCenter,a=n.innerRadius||0;this.$_assembleRingData(n.ringData),this._drawCombinePiece(n.ringData,o,i,a,t),this._drawTipsNSquare(t),n.showTitle&&this._drawTitle()},_drawCombinePiece:function(t,n,i,o,a){var s=this,r=s.pen,c=this.options.initAngle;$.each(t,function(t,e){s.__drawPiece(n,i,o,{fillColor:e.color},c,e.angle),a&&r.isPointInPath(a.x,a.y)&&s.options.onRingClick instanceof Function&&s.options.onRingClick.call(this,e),c+=e.angle})},_drawTipsNSquare:function(P){var v=this,C=this.pen,t=this.options.ringParams.ringTips,e=t.orient,n=this.options.ringParams.ringData
;switch(e){case"vertical":!function(t,e,n){for(var i=t.tipStyle.font||10,o=t.tipStyle.color||"black",a=t.tipStart,s=t.tipSpace,r=0,c=e.length,l=a.sx,u=a.sy,d=s.xSpace,h=s.ySpace;r<c;r++){v.__drawSquare({sx:l,sy:u-.9*i},{color:"transparent"},{w:i+d,h:i}),n&&C.isPointInPath(n.x,n.y)&&v.options.onRingClick instanceof Function&&v.options.onRingClick.call(this,e[r]),v.__drawSquare({sx:l,sy:u-.6*i},e[r],{w:.6*i,h:.6*i});var m=v.__drawFonts({sx:l+i,sy:u},e[r].title+" "+e[r].percent,{font:i+"px 黑体",color:o});v.__drawLine({sx:l+1*i,sy:u+3},{ex:l+1*i+m.width,ey:u+3}),u+=h}}(t,n,P),i(t,n);break;case"horizontal":!function(t,e){for(var n=t.tipStyle.font||18,i=t.tipStyle.color||"black",o=t.tipRowNum,a=t.tipStart,s=t.tipSpace,r=0,c=e.length,l=Number(o||2),u=s.xSpace,d=s.ySpace,h=a.sx,m=a.sy;r<c;r++){var p=h+r%l*u,f=m+parseInt(r/l)*d;v.__drawSquare({sx:p,sy:f-.9*n},{color:"transparent"},{w:n+u,h:n}),
P&&C.isPointInPath(P.x,P.y)&&v.options.onRingClick instanceof Function&&v.options.onRingClick.call(this,e[r]),v.__drawSquare({sx:p,sy:f-.6*n},e[r],{w:.6*n,h:.6*n});var g=v.__drawFonts({sx:p+1*n,sy:f},e[r].title+" "+e[r].percent,{font:n+"px 黑体",color:i});v.__drawLine({sx:p+1*n,sy:f+3},{ex:p+1*n+g.width,ey:f+3})}}(t,n),i(t,n)}function i(t,e){for(var o=v.options.ringParams.ringCenter,n=t.tipStyle.font||18,i=v.options.initAngle,a=v.options.ringParams.radius,s=v.options.ringParams.innerRadius,r=.7*(Number(a)+Number(s)),c=v.$_round2Ellipse(r,v.options.ringParams.sightAngel||90),l=v.$_round2Ellipse(a,v.options.ringParams.sightAngel||90),u=[],d=function(t,e){return t>Math.PI/9?(i=e,{sx:o.cx+r*Math.cos(i),sy:o.cy+c*Math.sin(i)}):(n=e,{out:!0,sx:o.cx+1.25*a*Math.cos(n),sy:o.cy+1.25*l*Math.sin(n)});var n,i},h=0,m=i;h<e.length;h++){var p=m+.5*e[h].angle,f=d(e[h].angle,p);f.percent=e[h].percent,f.height=n,f.lineColor=e[h].color||v.colorStore[h],f.lineSPosition={sx:o.cx+a*Math.cos(p),
sy:o.cy+a*Math.sin(p)},u.push(f),m+=e[h].angle}v._avoidOverlap(u),u.forEach(function(t){v.__drawFonts(t,t.percent,{font:.9*n+"px  黑体",align:t.out?"left":"center",baseline:"middle"})})}},_avoidOverlap:function(t){for(var e,n=this,i=t.filter(function(t){return t.out}),o=0,a=0,s=i.length;a<s;a++)(e=i[a].sy-o)<0&&(i[a].sy=i[a].sy-e),o=i[a].sy+i[a].height;i.forEach(function(t){n.__drawLine(t.lineSPosition,{ex:t.sx,ey:t.sy},t.lineColor)})},_drawTitle:function(){var t=0,e=this.options.ringParams.ringTitle,n=e.titleStart,i=e.titleStyle;for(this.__drawFonts({sx:n.sx,sy:n.sy},e.title,{font:"bolder "+i.font+"px 黑体",color:i.color});t<e.title.length*i.font;)this.__draw5corner({cx:n.sx+t,cy:n.sy+i.font},5,{color:"red"}),t+=10},__drawRound:function(t,e,n,i){var o=this.pen,a=this.$_getSubStyle("fillColor",n),s=this.$_getSubStyle("compose",n),r=this.$_getSubStyle("alpha",n);o.beginPath(),o.save(),r&&(o.globalAlpha=r),s&&(o.globalCompositeOperation=s),o.fillStyle=a,o.arc(t.cx,t.cy,e,0,2*Math.PI),
o.fill(),o.restore(),o.closePath()},__drawPiece:function(o,t,e,n,i,a){var s=i,r=this.pen,c=this.options.scanStep,l=this.$_round2Ellipse(t,this.options.ringParams.sightAngel||90),u=this.$_round2Ellipse(e,this.options.ringParams.sightAngel||90),d=this.$_getSubStyle("fillColor",n),h=function(t,e,n,i){r.lineTo(o.cx+n*Math.cos(t),o.cy+i*Math.sin(t)+e||0)};r.save(),r.beginPath();var m=r.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,t);for(m.addColorStop(0,d),m.addColorStop(.9,d),m.addColorStop(.99,"#CBCBD2"),m.addColorStop(1,d),r.fillStyle=d,h(s,0,e,u);s<i+a;)h(s,0,t,l),s+=c;for(h(s,0,e,u);i<s;)h(s,0,e,u),s-=c;h(s,0,e,u),r.fill(),r.closePath(),r.restore()},__drawSquare:function(t,e,n){var i=this.pen;i.save(),i.beginPath(),i.fillStyle=e.color,i.rect(t.sx,t.sy,n.w,n.h),i.fill(),i.closePath(),i.restore()},__drawFonts:function(t,e,n){var i,o=this.pen;return o.save(),o.beginPath(),o.fillStyle=n&&n.color||"#000000",o.font=n&&n.font||"17px 黑体 ",n.align&&(o.textAlign=n.align),
n.baseline&&(o.textBaseline=n.baseline),i=o.measureText(e),o.fillText(e,t.sx,t.sy),o.closePath(),o.restore(),i},__drawLine:function(t,e,n){var i=this.pen;i.save(),i.beginPath(),i.strokeStyle=n||"black",i.moveTo(t.sx,t.sy),i.lineTo(e.ex,e.ey),i.stroke(),i.closePath(),i.restore()},__draw5corner:function(t,e,n){var i,o,a=this.pen,s=.38*e,r=.1*Math.PI,c=.2*Math.PI;a.save(),a.beginPath(),a.fillStyle=n.color||"green",a.moveTo(t.cx,t.cy);for(var l=0;l<11;l++){i=r+c*l,o=0<l%2?e:s,a.lineTo(t.cx+o*Math.cos(i),t.cy+o*Math.sin(i))}a.fill(),a.closePath(),a.restore()},_clearAll:function(){this.__clearArea({sx:0,sy:0},this.options.size)},__clearArea:function(t,e){this.pen.clearRect(t.sx,t.sy,e.w,e.h)},$_getSubStyle:function(t,e){return e[t]},$_round2Ellipse:function(t,e){return Math.sin(e/180*Math.PI)*t},$_compressPixel:function(t){return t*this.options.scaleRate},$_number2Percent:function(t,e){return(100*parseFloat(t/e)).toFixed(this.options.precision)+"%"},$_number2Angle:function(t,e){
return t/e*(2*Math.PI)},$_assembleRingData:function(n){var i=this,o=0,a=this.options.ringParams.ringDataKey,s=n.length,r=0,c=0;$.each(n,function(t,e){e.title=e[a.title],e.quantity=parseFloat(e[a.quantity]),0<t&&e.quantity>n[t-1].quantity&&(c=t),o+=e.quantity}),$.each(n,function(t,e){e.percent=i.$_number2Percent(e.quantity,o),r+=Number((e.quantity/o*100).toFixed(i.options.precision)),t===s-1&&(n[c].percent=(100-r+parseFloat(n[c].percent)).toFixed(i.options.precision)+"%"),e.angle=i.$_number2Angle(e.quantity,o),e.color=e.color||i.colorStore[t]}),this.options.ringParams.totalQty=o},$_heightLightColor:function(){},$_dimLightColor:function(){},validateRingData:function(t){return t instanceof Array&&0<t.length},refreshPaint:function(t){this.validateRingData(t)?(this.options.ringParams.ringData=t,this._clearAll(),this.drawWhat()):console.error("传入data不符合要求：非空数组，成员大于0个")}}),PJF.apply(PJF.ui.pie.prototype,{getClassName:function(){return"PJF.ui.pie"},destroy:function(){
PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null}}),PJF.ui.virtualKeyboard=PJF.extend(PJF.ui.component,{init:function(t){var i=this;i.conf=$.extend({value:"number",onClick:function(){},type:"",onEnterClick:function(){}},t),
i.com.append('<div class="vtkeyboard_cntr"><input id="virInput" class="vtkeyboard_input" type="text" readonly="true" /><div id="clearA" class="vtkeyboard_clinput" btnid="12"></div><div class="vtkeyboard_btnBox"><div class="vtkeyboard_btn" btnid="1">1</div><div class="vtkeyboard_btn" btnid="2">2</div><div class="vtkeyboard_btn" btnid="3">3</div><div class="vtkeyboard_btn" btnid="15" id="backSpace"><div class="Esc_icon"></div></div><div class="vtkeyboard_btn" btnid="4">4</div><div class="vtkeyboard_btn" btnid="5">5</div><div class="vtkeyboard_btn" btnid="6">6</div><div class="vtkeyboard_btn" btnid="12" style="font-size: .21rem">清空</div><div class="vtkeyboard_btn" btnid="7">7</div><div class="vtkeyboard_btn" btnid="8">8</div><div class="vtkeyboard_btn" btnid="9">9</div><div class="vtkeyboard_btn" btnid="00">00</div><div class="vtkeyboard_btn" btnid="10">.</div><div class="vtkeyboard_btn" btnid="0">0</div><div class="vtkeyboard_btn_big" btnid="000">000</div></div></div>'),
i.inputBox=i.com.find("input"),i.value=[],i.btncl=i.com.find("#clearA"),i.btnbs=i.com.find("#backSpace"),i.btncl.bind("click",function(){var t=$(this);"12"===t.attr("btnid")&&(i.value=[],i.com.find("#virInput").val(""),t.removeClass("vtkeyboard_clinput_d"),i.conf.onClick.call(i,i.value))}),i.btns=i.com.find(".vtkeyboard_btn,.vtkeyboard_btn_big"),i.btns.bind("click",function(){PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav");var t=$(this),e=t.attr("btnid");t[0].className;if("12"===e)i.btncl.trigger("click");else{var n=i.getValue();"15"===e&&1==n.length&&i.btncl.trigger("click"),i.pushValue(t.text()),i.conf.onClick.call(i,i.value)}"10"!==e&&"12"!==e&&"15"!==e&&$("#clearA").addClass("vtkeyboard_clinput_d")}),i.btnbs.bind("mousedown",function(){var t,e;t=setTimeout(function(){e=setInterval(function(){1==i.getValue().length&&i.btncl.trigger("click"),i.pushValue("")},150)},500),i.btnbs.bind("mouseup mouseout",function(){clearTimeout(t),clearInterval(e),
i.btnbs.unbind("mouseup mouseout")})})},bindEvent:function(t,e){"onClick"==t&&(this.conf.onClick=e)},pushValue:function(t){var e=function(t){0<t.length&&n.value.push(t),n.inputBox.val(n.value.join(""))},n=this;if(t){if("int"==n.conf.type){if("."==t)return;if(11<(s=n.getValue()).length+t.length){var i=s.length+t.length-11;t=t.slice(0,t.length-i)}return void e(t)}if("money"==n.conf.type){if(""===(s=n.getValue())&&"."===t)return;if("0"===s||"00"===s||"000"===s){if("."===t)1<(r=n.getValue()).length&&(r=r.slice(0,1),n.value.pop(),n.value.push(r));else n.value.pop();return void e(t)}if("."===t){for(var o in n.value)if("."===n.value[o])return;return void e(t)}for(var o in n.value)if("."===n.value[o]){var a;if(2<(a=n.getValue().split("."))[1].length+t.length){i=a[1].length+t.length-2;t=t.slice(0,t.length-i)}return void e(t)}n.value.push(t)}else{if("card"===n.conf.type){var s=n.getValue();if("."===t)return;if(27<s.length+t.length){i=s.length+t.length-27;t=t.slice(0,t.length-i)}return void e(t)}
n.value.push(t)}}else{var r;0!=n.value.length&&(1<n.value.length?r=n.value.pop():(r=n.value[0],n.value=[]),1<r.length&&(r=r.slice(0,r.length-1),n.value.push(r)))}n.inputBox.val(n.value.join(""))},getValue:function(){return this.inputBox.val()},modifyParam:function(t){$.extend(!0,this.conf,t)},setValue:function(t){var e,n;this.value=[],this.inputBox.val(this.value.join("")),n=/^[0-9.]*$/;for(var i=0,o=(e=t.split("")).length;i<o;i++){var a=e[i];if(!n.test(a))return void console.log('invalid character is detected ==> "'+a+'"');a="."===a?"10":a,this.pushValue(e[i])}}}),PJF.ui.selectCombo=PJF.extend(PJF.ui.component,{init:function(t){this.options={confs:[]},$.extend(this.options,t);this.domArr=[],this.selectArr=[],this.initHtml(),this.bindEvents()},initHtml:function(){$("#"+this.options.dom).append('<div class="stm_selectCombo_container"></div>');for(var t=this.com.find(".stm_selectCombo_container"),e=(this.options,this.options.confs),n=e.length,i=0;i<n;i++){var o=this.generateId()
;t.append("<div class='stm_selectCombo_select' id="+o+"></div>"),this.domArr.push(o),e[i].dom=o}for(i=0;i<n;i++){e[i].doms=this.domArr;var a=new PJF.ui.select(e[i]);this.selectArr.push(a)}},bindEvents:function(){for(var e=this,n=(this.com.find(".stm_selectCombo_container"),this.selectArr),t=this.domArr,i=0;i<n.length;i++)n[i].unbindEvents(),$("#"+n[i].options.inputId).unbind("focus").bind("focus",function(){console.log("selectCombo-------------------------------focus");for(var t=0;t<n.length;t++)n[t].addDiv(n[t].options.selectId,n[t].options.inputId,n[t].options.containerId);e.cssDiv()}).unbind("blur").bind("blur",function(t){if(PJF.otherInfo.typeInfo!=PJF.constants.ICM_NAME){console.log("selectCombo-------------------------------blur");for(var e=0;e<n.length;e++)n[e].hideDiv()}}).keyup(function(t){e.cssDiv()}),n[i].options.initLabel&&$("#"+t[i]).find(".stm_select_initLable").unbind("click").bind("click",function(){$(this).parent().find(".stm_select_input").trigger("focus")})},
cssDiv:function(){for(var t=this.selectArr,e=0;e<t.length;e++)0==e?$("#"+t[e].options.containerId).css({"border-right":"none"}):e==t.length-1?$("#"+t[e].options.containerId).css({"border-left":"none"}):$("#"+t[e].options.containerId).css({"border-left":"none","border-right":"none"})},getValue:function(){for(var t=[],e=this.selectArr,n=0;n<e.length;n++)t.push(e[n].getValue());return t},readOnly:function(t){for(var e=this.selectArr,n=0;n<e.length;n++)e[n].readOnly(t)},setValue:function(t){for(var e=this.selectArr,n=0;n<e.length;n++)e[n].setValue(t[n])},disabled:function(){for(var t=this.selectArr,e=0;e<t.length;e++)t[e].disabled()},enable:function(){for(var t=this.selectArr,e=0;e<t.length;e++)t[e].enable()}}),PJF.apply(PJF.ui.selectCombo.prototype,{getClassName:function(){return"PJF.ui.selectCombo"},destroy:function(){for(var t=this.selectArr,e=0;e<t.length;e++)t[e].destroy();PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.selectArr=null,this.domArr=null,this.options=null,
this.com=null,this.id=null}}),PJF.ui.date=PJF.extend(PJF.ui.component,{init:function(t){this.options={yearFlag:"年",monthFlag:"月",dayFlag:"日",startYear:"",width:120,hideDay:!1,nullOption:!1},$.extend(this.options,t);var e=this.options.width;this.options.width=[],e instanceof Array?this.options.width=e:(this.options.width[0]=e,this.options.width[1]=e,this.options.width[2]=e);this.selectCombo={},this.initHtml(),this.bindEvents();var n=(this.options.defaultValue?this.options.defaultValue:null)||(this.options.minDate?this.options.minDate:null)||new Date;if(n&&!this.options.nullOption){var i=n.getFullYear(),o=n.getMonth()+1;o<10&&(o="0"+o);var a=n.getDate();a<10&&(a="0"+a),this.setValue(""+i+o+a)}},initHtml:function(){var t=this,e=[{initLabel:"年",hideLabelForNull:!0,textAlign:"center",data:t.generateData((t.options.minDate?t.options.minDate.getFullYear():null)||t.options.startYear||(new Date).getFullYear(),2200,t.options.yearFlag),
defaultValue:!t.options.nullOption&&(t.options.minDate?t.options.minDate.getFullYear():(new Date).getFullYear()),selType:"date",nullOption:t.options.nullOption,width:t.options.width[0]},{initLabel:"月",hideLabelForNull:!0,textAlign:"center",data:t.generateData((t.options.minDate?t.options.minDate.getMonth()+1:null)||1,12,t.options.monthFlag),defaultValue:!t.options.nullOption&&(t.options.minDate?t.options.minDate.getMonth()+1:(new Date).getMonth()+1),selType:"date",nullOption:t.options.nullOption,width:t.options.width[1]}];t.options.hideDay||e.push({initLabel:"日",hideLabelForNull:!0,textAlign:"center",data:t.generateData((t.options.minDate?t.options.minDate.getDate():null)||1,31,t.options.dayFlag),defaultValue:!t.options.nullOption&&(t.options.minDate?t.options.minDate.getDate():(new Date).getDate()),nullOption:t.options.nullOption,selType:"date",width:t.options.width[2]}),t.selectCombo=new PJF.ui.selectCombo({dom:t.options.dom,id:t.options.id,confs:e})},bindEvents:function(){
var r=this,c=r.selectCombo.selectArr;!r.options.hideDay&&$("#"+c[1].options.inputId).unbind("change").bind("change",function(){var t=r.options.dayFlag,e=parseInt(r.selectCombo.getValue()[1]),n=[1,3,5,7,8,10,12],i=[],o=r.options.minDate,a=parseInt(r.selectCombo.getValue()[0]);if(o){i=2==e?r.generateData(a==o.getFullYear()&&e==o.getMonth()+1?o.getDate():1,2==e&&r.isLeapYear()?29:28,t):-1<n.indexOf(e)?r.generateData(a==o.getFullYear()&&e==o.getMonth()+1?o.getDate():1,31,t):r.generateData(a==o.getFullYear()&&e==o.getMonth()+1?o.getDate():1,30,t);var s=c[2].getValue();c[2].setData(i),c[2].setValue(a==o.getFullYear()&&e==o.getMonth()+1&&s<o.getDate()?o.getDate():s),r.selectCombo.cssDiv()}else{i=2==e?r.isLeapYear()?r.generateData(1,29,t):r.generateData(1,28,t):-1<n.indexOf(e)?r.generateData(1,31,t):r.generateData(1,30,t);s=c[2].getValue();c[2].setData(i),c[2].setValue(s),r.selectCombo.cssDiv()}}),$("#"+c[0].options.inputId).unbind("change").bind("change",function(){
var t=[],e=parseInt(r.selectCombo.getValue()[0]),n=r.options.minDate;if(n){t=r.generateData(e==n.getFullYear()?n.getMonth()+1:1,12,r.options.monthFlag);var i=c[1].getValue();c[1].setData(t),c[1].setValue(e==n.getFullYear()&&i<n.getMonth()+1?n.getMonth()+1:i)}!r.options.hideDay&&$("#"+c[1].options.inputId).trigger("change")})},isLeapYear:function(){var t=parseInt(this.selectCombo.getValue()[0]);return t%4==0&&t%100!=0||t%100==0&&t%400==0},getValue:function(){var t=this.selectCombo.getValue(),e=(0<t[0]&&t[0]<10?"0"+t[0]:t[0])+"",n=(0<t[1]&&t[1]<10?"0"+t[1]:t[1])+"";return this.options.hideDay?e+n:e+n+((0<t[2]&&t[2]<10?"0"+t[2]:t[2])+"")},setValue:function(t){var e=[],n=parseInt(t.substr(0,4)),i=parseInt(t.substr(4,2)),o=1;e=this.options.hideDay?[n,i]:[n,i,o=parseInt(t.substr(6,2))],!this.isValidDate(n,i,o)||this.options.minDate&&PJF.util.formatDate(this.options.minDate)>t||this.selectCombo.setValue(e)},generateData:function(t,e,n){for(var i=[],o=t;o<e+1;o++){var a={};a.name=o,a.desc=o+n,
i.push(a)}return i},readOnly:function(t){t?this.disabled():this.enable()},disabled:function(){this.selectCombo.disabled()},enable:function(){this.selectCombo.enable()},isValidDate:function(t,e,n){var i=new Date(t,e-1,n);return t==i.getFullYear()&&e-1==i.getMonth()&&n==i.getDate()}}),PJF.apply(PJF.ui.date.prototype,{getClassName:function(){return"PJF.ui.date"},validateParam:function(t){return!(t.width instanceof Array&&t.width.length<3)||(alert("Error: width 参数设置不正确"),!1)},destroy:function(){this.selectCombo.destroy(),PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.selectCombo=null,this.com=null,this.id=null}}),PJF.ui.checkbox=PJF.extend(PJF.ui.component,{init:function(t){this.options={type:"vertical",buttonStyle:!1,defaultChecked:{},singleSelect:!1,classic:!0,onClick:function(){}},$.extend(this.options,t);this.options;this.com.addClass("stm-checkbox");var e=this.initHtml();this.com.append(e),this.adjustStyle(),this.bindEvent()},adjustStyle:function(){var t=this.options
;if("horizontal"==this.options.type&&this.com.find(".list-item-checkbox").each(function(){$(this).addClass("list-item-checkbox-horizontal")}),this.com.find(".checkbox-text").each(function(){40<$(this).html().length&&$(this).css("position","relative").css("left","50px").css("margin-left","0px")}),t.colCount){if(isNaN(Number(t.colCount)))return;var e=this.com.find(".list-item-checkbox"),o=(this.com.find(".checkbox-container").innerWidth()-5)/t.colCount;$.each(e,function(t,e){var n=$(e).outerWidth(),i=Math.ceil(n/o)*o;$(e).outerWidth(i)})}},bindEvent:function(){var n=this,i=n.options.singleSelect,t=n.options.buttonStyle;n.com.find(".list-item-checkbox");t?n.com.find(".list-item-checkbox-button").bind("click",function(t){switch(PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav"),i){case!0:if(!$(this).hasClass("checkbox-item-disabled")){n.options.defaultChecked=[],n.com.find(".list-item-checkbox-button").each(function(){$(this).removeClass("checkbox-icon-checked-button")
}),$(this).addClass("checkbox-icon-checked-button");var e=$(this).children().text();n.options.defaultChecked[""+e]=!0,n.options.onClick.call(this)}break;case!1:if(!$(this).hasClass("checkbox-item-disabled")){e=$(this).children().text();$(this).hasClass("checkbox-icon-checked-button")?($(this).removeClass("checkbox-icon-checked-button"),n.options.classic||$(this).addClass("checkbox-icon-classicTip"),n.options.defaultChecked[""+e]=!1):($(this).addClass("checkbox-icon-checked-button").removeClass("checkbox-icon-classicTip"),n.options.defaultChecked[""+e]=!0),n.options.onClick.call(this)}}}):n.com.find(".list-item-checkbox").bind("click",function(t){switch(PJF.communication.player.PlaySoundByUrl("devprompt/COMMON_click.wav"),i){case!0:if(!$(this).hasClass("checkbox-item-disabled")){n.options.defaultChecked=[],n.com.find(".list-item-checkbox").each(function(){$(this).removeClass("radio-icon-checked")}),$(this).addClass("radio-icon-checked");var e=$(this).children().text()
;n.options.defaultChecked[""+e]=!0,n.options.onClick.call(this)}break;case!1:if(!$(this).hasClass("checkbox-item-disabled")){e=$(this).children().text();$(this).hasClass("checkbox-icon-checked")?($(this).removeClass("checkbox-icon-checked"),n.options.classic||$(this).addClass("checkbox-icon-classicTip"),n.options.defaultChecked[""+e]=!1):($(this).addClass("checkbox-icon-checked").removeClass("checkbox-icon-classicTip"),n.options.defaultChecked[""+e]=!0),n.options.onClick.call(this)}}})},initHtml:function(){var t=this.options.data,e=this.options.singleSelect,n=this.options.buttonStyle,i=[];if(i.push('<div class="checkbox-container">'),n)var o="checkbox-icon-unchecked-button";else o=e?"radio-icon-unchecked":"checkbox-icon-unchecked";for(var a in t){var s=t[a];"object"==typeof s?(this.options.dataMode=!0,
n?i.push('<div class="checkbox-btnStyle"><div class="list-item-checkbox-button '+o+'"><span class="checkbox-text-button" data-value="'+s.value+'">'+s.desc+"</span></div></div>"):this.options.classic||e?i.push('<div class="list-item-checkbox '+o+'"><span class="checkbox-text" data-value="'+s.value+'">'+s.desc+"</span></div>"):i.push('<div class="list-item-checkbox '+o+' checkbox-icon-classicTip" ><span class="checkbox-text" data-value="'+s.value+'">'+s.desc+"</span></div>")):n?i.push('<div class="checkbox-btnStyle"><div class="list-item-checkbox-button '+o+'"><span class="checkbox-text-button" data-value="'+s+'">'+s+"</span></div></div>"):this.options.classic||e?i.push('<div class="list-item-checkbox '+o+'"><span class="checkbox-text" data-value="'+s+'">'+s+"</span></div>"):i.push('<div class="list-item-checkbox '+o+' checkbox-icon-classicTip" ><span class="checkbox-text" data-value="'+s+'">'+s+"</span></div>")}return i.push("</div>"),i.join("")}}),PJF.apply(PJF.ui.checkbox.prototype,{
getClassName:function(){return"PJF.ui.checkbox"},getValue:function(){var t,e=this.options.dataMode,n=[],i=this.options.defaultChecked;if(this.options.buttonStyle)if(e)(t=this).com.find(".checkbox-icon-checked-button").each(function(){var t=$(this).children(".checkbox-text-button");n.push(t.attr("data-value"))});else for(var o in i)i[o]&&n.push(o);else if(e)((t=this).options.singleSelect?t.com.find(".radio-icon-checked"):t.com.find(".checkbox-icon-checked")).each(function(){var t=$(this).children(".checkbox-text");n.push(t.attr("data-value"))});else for(var o in i)i[o]&&n.push(o);return n},setValue:function(i,t){var o=this,e=o.options.buttonStyle,a=o.options.singleSelect;e?o.com.find(".list-item-checkbox-button").each(function(){switch(a){case!0:var t=$(this).children(".checkbox-text-button").attr("data-value");$(this).removeClass("checkbox-icon-checked-button"),"object"==typeof(n=i[0])&&(n=n.value),t==n&&(o.options.defaultChecked=[],$(this).addClass("checkbox-icon-checked-button"),
o.options.defaultChecked[""+t]=!0);break;case!1:t=$(this).children(".checkbox-text-button").attr("data-value");for(var e in i){var n;"object"==typeof(n=i[e])&&(n=n.value),t==n&&($(this).addClass("checkbox-icon-checked-button"),o.options.classic||$(this).removeClass("checkbox-icon-classicTip"),o.options.defaultChecked[""+t]=!0)}}}):o.com.find(".list-item-checkbox").each(function(){switch(a){case!0:var t=$(this).children(".checkbox-text").attr("data-value");$(this).removeClass("radio-icon-checked"),"object"==typeof(n=i[0])&&(n=n.value),t==n&&(o.options.defaultChecked=[],$(this).addClass("radio-icon-checked"),o.options.defaultChecked[""+t]=!0);break;case!1:t=$(this).children(".checkbox-text").attr("data-value");for(var e in i){var n;"object"==typeof(n=i[e])&&(n=n.value),t==n&&($(this).addClass("checkbox-icon-checked"),o.options.classic||$(this).removeClass("checkbox-icon-classicTip"),o.options.defaultChecked[""+t]=!0)}}}),t&&o.options.onClick()&&o.options.onClick.call(this)},
disabled:function(n){var i=this,o=i.options.singleSelect,t=i.options.buttonStyle;if(void 0===n)if(t)for(var e=i.com.find(".list-item-checkbox-button"),a=0;a<e.length;a++)i.disabled(a+1);else for(var s=i.com.find(".list-item-checkbox"),r=0;r<s.length;r++)i.disabled(r+1);else t?i.com.find(".list-item-checkbox-button").each(function(t){if(parseInt(t)+1==n){$(this).addClass("checkbox-item-disabled").attr("disabled","disabled");var e=$(this).hasClass("checkbox-icon-checked-button");e?$(this).addClass("checkbox-icon-checked-button-disabled"):$(this).addClass("checkbox-icon-unchecked-button-disabled"),o&&e&&$(this).parent().siblings().children().addClass("checkbox-item-disabled").attr("disabled","disabled"),i.options.classic||$(this).removeClass("checkbox-icon-classicTip")}}):i.com.find(".list-item-checkbox").each(function(t){if(parseInt(t)+1==n){$(this).addClass("checkbox-item-disabled").attr("disabled","disabled");var e=$(this).hasClass("radio-icon-checked")
;o&&e&&$(this).siblings().addClass("checkbox-item-disabled").attr("disabled","disabled"),i.options.classic||$(this).removeClass("checkbox-icon-classicTip")}})},enabled:function(e){var n=this,t=n.options.buttonStyle;if(void 0===e)if(t)for(var i=n.com.find(".list-item-checkbox-button"),o=0;o<i.length;o++)n.enabled(o+1);else for(var a=n.com.find(".list-item-checkbox"),s=0;s<a.length;s++)n.enabled(s+1);else t?this.com.find(".list-item-checkbox-button").each(function(t){parseInt(t)+1==e&&($(this).removeClass("checkbox-item-disabled").removeAttr("disabled"),$(this).removeClass("checkbox-icon-checked-button-disabled"),$(this).removeClass("checkbox-icon-unchecked-button-disabled"),n.options.classic||$(this).addClass("checkbox-icon-classicTip"))}):this.com.find(".list-item-checkbox").each(function(t){parseInt(t)+1==e&&($(this).removeClass("checkbox-item-disabled").removeAttr("disabled"),n.options.classic||$(this).addClass("checkbox-icon-classicTip"))})},destroy:function(){
PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null},cancelSelected:function(n){var i=this,o=i.options.singleSelect,t=i.options.buttonStyle,a=this.options.dataMode,s=this.options.defaultChecked;if(void 0===n)if(t)for(var e=i.com.find(".list-item-checkbox-button"),r=0;r<e.length;r++)i.cancelSelected(r+1);else for(var c=i.com.find(".list-item-checkbox"),l=0;l<c.length;l++)i.cancelSelected(l+1);else t?i.com.find(".list-item-checkbox-button").each(function(t){if(parseInt(t)+1==n&&($(this).hasClass("checkbox-icon-checked-button")&&$(this).removeClass("checkbox-icon-checked-button"),i.options.classic||$(this).addClass("checkbox-icon-classicTip"),!a)){var e=$(this).find("span").html();delete s[e]}}):i.com.find(".list-item-checkbox").each(function(t){if(parseInt(t)+1==n){if(o)$(this).hasClass("radio-icon-checked")&&$(this).removeClass("radio-icon-checked");else $(this).hasClass("checkbox-icon-checked")&&$(this).removeClass("checkbox-icon-checked")
;if(i.options.classic||$(this).addClass("checkbox-icon-classicTip"),!a){var e=$(this).find("span").html();delete s[e]}}})}}),PJF.ui.icCardReader=PJF.extend(PJF.ui.component,{init:function(t){this.params={infoMsg:resource.ICCARD_INSERT_MSG,success:function(t){},failure:function(t){},icCardInfo:null,deviceHandler:null,otherBnkCard:null,timeout:30,failureMsg:resource.ICCARD_READ_FAIL_MSG,interval:null,timeoutid:null},$.extend(this.params,t);var r=this;this.initUi(this.params),r.params.allowPassbook&&$(".pjf_stm_content_left").css("background-image","url('../../../css/stmimg/stm_cardPassbookImg.gif')"),r.params.allowYTDPb&&!PJF.util.deviceType.pad&&$(".pjf_stm_content_left").css("background-image","url('../../../css/stmimg/ytd_cardPassbookImg.gif')"),"DF001"==PJF.orgInfo.instSvrlLgPsnID&&$(".pjf_stm_content_left").css("background-image","url('../../../css/stmimg/cardin_zd.gif')"),
"DA003"===PJF.orgInfo.instSvrlLgPsnID&&$(".pjf_stm_content_left").css("background-image","url('../../../css/stmimg/hw_cardBg.gif')"),PJF.otherInfo.isSelfBank&&PJF.otherInfo.selfBizTp&&$(".pjf_stm_content_left").css("background-image","url('../../../css/stmimg/insertcard_mov_"+PJF.otherInfo.selfBizTp+".gif')").css("background-size","contain"),r.params.timeoutid=setTimeout(function(){try{if(PJF.constants.IS_DEBUG)return void r.params.success(PJF.stm.IC_CARD_INFO);if(PJF.util.deviceType.stm&&PJF.stm.ICMaker.getChannelStatus(function(t){if(1==t.status)if(0!=t.info.status)new PJF.ui.messageBox({title:"提示信息",content:PJF.i18n.getI18nResource("pjfI18n.popIcCardTip"),buttonConfs:[{bgColor:"rgb(121,198,30)",name:PJF.i18n.getI18nResource("pjfI18n.popIcCardBtn"),style:"main",width:200,height:80,onClick:function(){PJF.stm.ICMaker.ejectCard(function(){template&&template.loadPage("homepage")})}}]});else{var e,n,i,o=new PJF.ui.loading({noLayer:!0,noIcon:!0,msg:"",timeout:r.params.timeout
}),a=function(){o&&o.destroy()},s=function(){o.destroy(),o=null,e=new PJF.ui.loading({msg:PJF.i18n.getI18nResource("pjfCommon.readCardTip"),opacity:.1}),n=!0,!i&&r.params.allowPassbook&&PJF.ytd.COMMON.resetDev({pchType:"RDC",loadingConf:!1},function(){console.log("插入IC卡，复位RDC完成")})};PJF.event.onceSubscriber(PJF.stm.client.events.CDB_STOP,a),PJF.event.onceSubscriber(PJF.stm.client.events.CDB_INHALED,s),PJF.stm.ICMaker.readCard({cdbSound:r.params.cdbSound},function(){PJF.event.removeSubscriber(PJF.stm.client.events.CDB_STOP,a),PJF.event.removeSubscriber(PJF.stm.client.events.CDB_INHALED,s),o&&o.destroy(),e&&e.destroy(),r.callBack.apply(r,arguments)}),r.params.allowPassbook&&PJF.stm.CardReader.getCardNum({loadingConf:{timeout:30,noLayer:!0},rdcSound:"",readPassbook:!0,timeout:30},function(t){i=!0,"DRV0000020"==t.errorCode||"DRV0000002"==t.errorCode||n||PJF.stm.ICMaker.stopInhale({loadingConf:!1},function(){console.log("读折完成，停止进卡"),t.status?t.info.isRdcResult=!0:t.pbError=!0,r.callBack(t)
})})}else{new PJF.ui.messageBox({title:"提示信息",content:"获取卡槽状态失败",buttonConfs:[{bgColor:"rgb(121,198,30)",name:"返回首页",style:"main",width:200,height:80,onClick:function(){template&&template.loadPage("homepage")}}]});console.log("icCardReader获取卡通道错误:"+JSON.stringify(t))}}),PJF.util.deviceType.ytd){var e=new PJF.ui.loading({noLayer:!0,noIcon:!0,msg:"",timeout:r.params.timeout});PJF.ytd.MLT.callThreeDevice({timeout:30,readPassbook:r.params.allowYTDPb},function(n){function i(t){e&&e.destroy(),"DRV0000020"==t.errorCode&&PJF.event.publish("MLT_Cancel"),r.callBack.apply(r,arguments)}1!=n.status||!r.params.ARQC||"1"!=n.info.type&&"2"!=n.info.type?(1==n.status&&"3"==n.info.type&&(n.info.isRdcResult=!0),i(n)):PJF.ytd.ICC.genARQC({ARQC:r.params.ARQC},function(t){var e=$.extend(!0,{},n,t);i(e=$.extend(!0,e,{info:{resInfo:t.info}}))})})}}catch(t){$("#tradeMsg").text(r.params.failureMsg),console.log(t),r.params.failure("DEVICE00001")}},2)},initUi:function(t){if(PJF.util.deviceType.stm){var e=""
;"DA003"===PJF.orgInfo.instSvrlLgPsnID&&(e='<img src="../../../css/stmimg/hw_tipLogo.png"><label style="color:#EC871D;font-size:0.35rem">'+PJF.i18n.getI18nResource("pjfCommon.templateInfoTip")+'</label><label style="display:block;font-size: 0.2rem;width: 70%;margin:0 auto;">'+PJF.i18n.getI18nResource("pjfCommon.hwIcCardWarn")+"</label>");var n=e+'<div class="pjf_stm_content_left pjf_stm_icCardImg" '+(this.params.photoUrl?"style=\"background-image:url('"+this.params.photoUrl+"');\"":"")+"></div>";PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME?n='<div class="pjf_stm_content_left pjf_stm_icmicCardImg" ></div>':PJF.otherInfo.typeInfo==PJF.constants.TCR_NAME&&(n='<div class="pjf_stm_content_left pjf_stm_tcricCardImg" ></div>')}else if(PJF.util.deviceType.ytd)n='<div class="pjf_stm_content_left '+(PJF.util.deviceType.pad?"pjf_pad_icCardImg":"pjf_ytd_icCardImg")+'" '+(this.params.photoUrl?"style=\"background-image:url('"+this.params.photoUrl+"');\"":"")+"></div>";$("#"+t.dom).append(n)},
callBack:function(t){0==t.status?"DRV0000020"!=t.errorCode&&this.params.failure(t):this.params.success(t.info)},getClassName:function(){return"PJF.ui.icCardReader"}}),PJF.apply(PJF.ui.icCardReader.prototype,{}),PJF.ui.passbookReader=PJF.extend(PJF.ui.component,{init:function(t){this.params={infoMsg:resource.ICCARD_INSERT_MSG,success:function(t){},failure:function(t){},timeout:30,failureMsg:resource.ICCARD_READ_FAIL_MSG,interval:null,timeoutid:null},$.extend(this.params,t);this.initUi(this.params),this.triggerRead()},initUi:function(t){if(PJF.util.deviceType.stm){
var e='<div class="pjf_stm_content_left pjf_stm_bankbookImg" '+(this.params.photoUrl?"style=\"background-image:url('"+this.params.photoUrl+"');\"":"")+'></div><div class="pjf_stm_content_right" style="display:none;"><div class="pjf_stm_bankbookMsg"><ul><li><div class="pjf_stm_msg"><span class="stm_info_span"></span>'+resource.DEVICE_INFO_MSG+'</div></li><li><div class="pjf_stm_cardreader_msg">'+t.infoMsg+'<span id="timeout"></span></div></li><li><div id="tradeMsg" class="pjf_stm_cardreader_msg"></div></li></ul></div></div>'
;PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME?e='<div class="pjf_stm_content_left pjf_stm_bankbookImg" ></div><div class="pjf_stm_content_right" style="display:none;"><div class="pjf_stm_bankbookMsg"><ul><li><div class="pjf_stm_msg"><span class="stm_info_span"></span>'+resource.DEVICE_INFO_MSG+'</div></li><li><div class="pjf_stm_cardreader_msg">'+t.infoMsg+'<span id="timeout"></span></div></li><li><div id="tradeMsg" class="pjf_stm_cardreader_msg"></div></li></ul></div></div>':PJF.otherInfo.typeInfo==PJF.constants.TCR_NAME&&(e='<div class="pjf_stm_content_left pjf_stm_bankbookImg" ></div><div class="pjf_stm_content_right" style="display:none;"><div class="pjf_stm_bankbookMsg"><ul><li><div class="pjf_stm_msg"><span class="stm_info_span"></span>'+resource.DEVICE_INFO_MSG+'</div></li><li><div class="pjf_stm_cardreader_msg">'+t.infoMsg+'<span id="timeout"></span></div></li><li><div id="tradeMsg" class="pjf_stm_cardreader_msg"></div></li></ul></div></div>')
}else if(PJF.util.deviceType.ytd)e='<div class="pjf_stm_content_left '+(PJF.util.deviceType.pad?"pjf_pad_icCardImg":"pjf_ytd_icCardImg")+'" '+(this.params.photoUrl?"style=\"background-image:url('"+this.params.photoUrl+"');\"":"")+'></div><div class="pjf_stm_content_right" style="display:none;"><div class="pjf_stm_bankbookMsg"><ul><li><div class="pjf_stm_msg"><span class="stm_info_span"></span>'+resource.DEVICE_INFO_MSG+'</div></li><li><div class="pjf_stm_cardreader_msg">'+t.infoMsg+'<span id="timeout"></span></div></li><li><div id="tradeMsg" class="pjf_stm_cardreader_msg"></div></li></ul></div></div>';$("#"+t.dom).append(e)},triggerRead:function(){var o=this;o.params.timeoutid=setTimeout(function(){try{var e=new PJF.ui.loading({noLayer:!0,noIcon:!0,msg:"",timeout:o.params.timeout}),n=function(){e&&e.destroy()};function i(t){PJF.event.removeSubscriber(PJF.stm.client.events.PASSBOOK_STOP,n),e&&e.destroy(),"DRV0000020"==t.errorCode&&PJF.event.publish("RDC_Cancel")}
if(PJF.event.onceSubscriber(PJF.stm.client.events.PASSBOOK_STOP,n),PJF.util.deviceType.stm){var t=function(){PJF.stm.CardReader.getCardNum({loadingConf:{timeout:20,noLayer:!0},rdcSound:o.params.rdcSound,readPassbook:o.params.readPassbook,timeout:o.params.timeout},function(t){i(t),o.callBack.apply(o,arguments)})};PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).is("hasCard")?(console.log("卡槽有ic卡"),PJF.stm.ICMaker.ejectDev(function(){t()})):t()}PJF.util.deviceType.ytd&&PJF.ytd.RDC.getCardNum({loadingConf:{timeout:30,noLayer:!0},rdcSound:o.params.rdcSound,readPassbook:o.params.readPassbook,timeout:o.params.timeout},function(t){i(t),o.callBack.apply(o,arguments)})}catch(t){$("#tradeMsg").text(o.params.failureMsg),console.log(t),o.params.failure("DEVICE00001")}},2)},callBack:function(t){0==t.status?"DRV0000020"!=t.errorCode&&this.params.failure(t):this.params.success(t.info)},getClassName:function(){return"PJF.ui.passbookReader"}}),PJF.apply(PJF.ui.passbookReader.prototype,{}),
PJF.ui.password=PJF.extend(PJF.ui.component,{pwd:null,init:function(t){this.params={infoMsg:"",success:function(t){},failure:function(t){},timeout:20,isCheckPwd:!1,validateStr:"",encryptType:"P2",firstInputPwd:"",secondInputPwd:"",pinSound:"PIN_inputPwd.wav",pinSound2:"PIN_inputPwd2.wav"},$.extend(this.params,t);var i=this;(pwd=this).initUi(this.params),PJF.otherInfo.isSelfBank&&PJF.otherInfo.selfBizTp&&$(".pjf_stm_passswordImg").css("background-image","url('../../../css/stmimg/inputpassword_mov_"+PJF.otherInfo.selfBizTp+".gif')"),PJF.event.addSubscriber(PJF.stm.client.events.PIN_LENGTH,function(t){var e=t.split("|")[0],n=t.split("|")[1];i.com.find(".stm_password_textfield_"+e).val(PJF.util.generateUUid().substr(0,n||-1))},window,!0),this.triggerReadCard()},triggerReadCard:function(){var e=this;e.com.find(".stm_password_textfield_1").val(""),e.com.find(".stm_password_textfield_2").val(""),this.inputText1&&this.inputText1.focus(),e.com.find("#passwordMsg").text(""),
setTimeout(function(){try{if(PJF.constants.IS_DEBUG)return void e.params.success(PJF.debug.constants.PSWD.pchPassword);var t={iTimes:1,pinSound:e.params.pinSound,encryptType:e.params.encryptType,timeout:e.params.timeout,loadingConf:e.params.loadingConf};"e2e"==e.params.encryptType&&$.extend(t,{pPan:e.params.pPan,nPanLength:e.params.pPan.length}),PJF.stm.Pin.readPin(t,function(){e.firstPinCallBack.apply(e,arguments)})}catch(t){alert(t.message)}},2)},firstPinCallBack:function(t){var e=this;if(0==t.status)e.params.failure(t);else if(e.com.find(".stm_password_textfield_1").val("000000"),e.params.firstInputPwd=t.info.pchSecPassword,this.params.isCheckPwd){var n={iTimes:2,pinSound:e.params.pinSound2,encryptType:e.params.encryptType};"e2e"==e.params.encryptType&&$.extend(n,{pPan:e.params.pPan,nPanLength:e.params.pPan.length}),this.inputText2&&this.inputText2.focus(),PJF.stm.Pin.readPin(n,function(){e.secondPinCallBack.apply(e,arguments)})}else this.params.success(t.info.pchSecPassword)},
secondPinCallBack:function(t){var e=this;if(0==t.status)this.params.failure(t);else{e.com.find(".stm_password_textfield_2").val("000000");var n=$("#passwordMsg");e.params.secondInputPwd=t.info.pchSecPassword,e.params.firstInputPwd==e.params.secondInputPwd?e.isStrPwd(e.params.firstInputPwd,e.params.validateStr)?(n.text(""),e.params.success(t.info.pchSecPassword)):(n.text("密码过于简单"),t.notStrPwd=!0,t.status="0",t.errorCode="PJF_PWD_ERR02",t.errorMsg="密码过于简单",e.params.failure(t)):(n.text("两次密码输入不一致"),t.wrongPwd=!0,t.status="0",t.errorCode="PJF_PWD_ERR01",t.errorMsg="两次密码输入不一致",e.params.failure(t))}},initUi:function(t){var e,n,i="",o=PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME?"pjf_stm_icmpassswordImg":"pjf_stm_passswordImg";PJF.util.deviceType.pad?o="pjf_stm_icmpassswordImg":PJF.util.deviceType.tcr&&(o="pjf_stm_tcrpassswordImg"),"DF001"==PJF.orgInfo.instSvrlLgPsnID&&(o="pjf_stm_passswordImg_zd");var a="";"DA003"===PJF.orgInfo.instSvrlLgPsnID&&(o="pjf_stm_passswordImg_hw",
a='<div style="text-align: center;"><img src="../../../css/stmimg/hw_tipLogo.png"><label style="color:#EC871D;font-size:0.35rem">'+PJF.i18n.getI18nResource("pjfCommon.templateInfoTip")+'</label><label style="display:block;font-size: 0.2rem;width: 60%;margin:0 auto;">'+PJF.i18n.getI18nResource("pjfCommon.hwPwdWarn")+"</label></div>"),t.isCheckPwd?(e=PJF.util.generateUUid(),n=PJF.util.generateUUid(),
i=a+'<div class="pjf_stm_content_left '+o+'"></div><div class="pjf_stm_content_right"><div class="pjf_stm_passwordMsg"><ul><li class="pjf_stm_password_title">'+PJF.i18n.getI18nResource("pjfCommon.checkPwdTip1")+'</li><li><input id="'+e+'" class="stm_password_textfield stm_password_textfield_1" type="password" readonly=readonly/></li><li class="pjf_stm_password_title">'+PJF.i18n.getI18nResource("pjfCommon.checkPwdTip2")+'</li><li><input id="'+n+'"class="stm_password_textfield stm_password_textfield_2" type="password" readonly=readonly/></li><li id="passwordMsg" style="color:red;"></li></ul></div></div>'):i=a+'<div><div class="pjf_stm_passwordMsg clear_float single_password"><ul><li><input id="'+(e=PJF.util.generateUUid())+'"class="stm_password_textfield stm_password_textfield_1" type="password" readonly=readonly/></li><li style="display: none"><div class="pjf_stm_msg"></div></li><li style="display: none"><div class="pjf_stm_cardreader_msg">'+t.infoMsg+'</div></li></ul></div></div><div class=" single_passwordImg"><div class="'+o+' clear_float"></div></div>',
$("#"+t.dom).append(i),this.inputText1=new PJF.ui.textfield({dom:e}),this.inputText1.readOnly(!0),t.isCheckPwd&&(this.inputText2=new PJF.ui.textfield({dom:n}),this.inputText2.readOnly(!0))},getClassName:function(){return"PJF.ui.password"},setIntervalPwdLen:function(e){var n=this;$("#passwordMsg").text(""),this.intervalId=window.setInterval(function(){PJF.stm.Pin.getPinLength(function(t){0==t.status?n.params.failure(t):n.com.find(".stm_password_textfield_"+e).val(PJF.util.generateUUid().substr(0,t.info.retvalue||-1))})},200)},clearIntervalPwdLen:function(t){window.clearInterval(this.intervalId)},isStrPwd:function(t,e){var n=PJF.communication.Decrypt(t,PJF.otherInfo.devId,PJF.otherInfo.token,PJF.otherInfo.secNode);if(!n.success)return!0;t=n.result;var i=[];i.push(function(t){return t.match(/^[0-9]{6}$/g)});i.push(function(t){return!t.match(/^([0-9]{1})\1{5}$/g)});i.push(function(t){for(var e=!0,n=0;n<t.length-1;n++)if(t.charCodeAt(n)-t.charCodeAt(n+1)!=1){e=!1;break}var i=!0
;for(n=0;n<t.length-1;n++)if(t.charCodeAt(n+1)-t.charCodeAt(n)!=1){i=!1;break}return!e&&!i});i.push(function(t){return!t.match(/^([0-9]{1})\1{1}([0-9]{1})\2{1}([0-9]{1})\3{1}$/g)&&!t.match(/^([0-9]{1})\1{2}([0-9]{1})\2{2}$/g)});i.push(function(t,e){return(!e.match(/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$/)||"0"!=e[10]||"0"!=e[12]||t.substring(0,4)!=e.substring(6,10)||t[4]!=e[11]||t[5]!=e[13])&&-1==e.indexOf(t)});for(var o=0;o<i.length;o++){if(!i[o].call(this,t,e))return!1}return!0}}),PJF.apply(PJF.ui.password.prototype,{destroy:function(){this.clearIntervalPwdLen(),PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.params=null,this.id=null}}),PJF.ui.window=PJF.extend(PJF.ui.panel,{init:function(t){this.options={id:null,width:800,height:400,left:null,top:null,href:null,cache:!0,border:!0,content:null,tools:null,loadingMessage:"Loading...",extractor:function(t){var e=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(t);return e?e[1]:t},
onLoad:function(){},isLoaded:!1,domLoadedCallBack:function(){},initMargin:20,modal:!0,zIndex:9e3,retainDom:!0},$.extend(this.options,t),this.options.retainDom&&(this.copyComObj=this.com.clone(!1,!1).empty().insertAfter(this.com),this.copyComObj.attr("id",""));this.com.addClass("stmwindow");var e,n,i,o=this.getPageArea();e=this.options.width,i=this.options.initMargin,e?(e=this.options.width,n=this.options.height):(e=o.width-8*i,n=o.height-3*i),this.com.css({width:isNaN(e)?"auto":e/PJF.constants.DEFAULT_FONTSIZE+"rem",height:n/PJF.constants.DEFAULT_FONTSIZE+"rem"}),this.com.append('<div class="stmwindow-body"></div>'),this.options.content?this.com.find(".stmwindow-body").append(this.options.content):this.options.htmlDomId&&(this.com.find(".stmwindow-body").html($("#"+this.options.htmlDomId).children().detach()),this.options.domLoadedCallBack()),this.com.css({"overflow-x":"auto","overflow-y":"auto","padding-bottom":"0px",position:"absolute"}),
this.options.href&&this.loadDataByUrl(this.options.href),this.setLeft(),this.setTop(),this.addMask(),this.show()},loadDataByUrl:function(t,e){var n=this;if(n.options.href&&(e||!n.options.isLoaded||!n.options.cache)){n.options.isLoaded=!1;var i=n.com.find(".stmwindow-body");i.html($('<div class="stmPanel-loading"></div>').html(n.options.loadingMessage));var o=i;$.ajax({url:t,cache:!1,success:function(t){i.html(n.options.extractor.call(o,t)),$.parser&&$.parser.parse(i),i.parent().css({"overflow-x":"auto","overflow-y":"auto"}),n.options.onLoad&&n.options.onLoad.apply(o,arguments),n.options.isLoaded=!0}})}},setLeft:function(){var t=this.com.width();this.com.offset({left:($(window).width()-t)/2})},setTop:function(){var t=this.com.height(),e=$(".template_top").height();this.com.offset({top:($(window).height()-t+e)/2})},move:function(){this.com.css({position:"absolute",left:this.options.left,top:this.options.top})},getPageArea:function(){return"BackCompat"==document.compatMode?{
width:Math.max((document.body.scrollWidth,document.body.clientWidth)),height:Math.max((document.body.scrollHeight,document.body.clientHeight))}:{width:Math.max((document.documentElement.scrollWidth,document.documentElement.clientWidth)),height:Math.max((document.documentElement.scrollHeight,document.documentElement.clientHeight))}},addMask:function(){var t,e,n=this.com;(n.mask&&n.mask.remove(),1==this.options.modal)&&(n.mask=$('<div class="window-mask"></div>').insertAfter($(n)),n.parents().hasClass("template_cntr")?(n.parents().each(function(){$(this).hasClass("template_cntr")&&(t=$(this).width(),e=$(this).height())}),n.mask.css({width:t,height:e,display:"none"})):n.mask.css({width:this.getPageArea().width,height:this.getPageArea().height,display:"none"}));n.mask&&(n.mask.css({display:"block",zIndex:this.options.zIndex++}),n.css("z-index",this.options.zIndex++))},hide:function(){var t=this.com;t.next().hasClass("window-mask")&&(t.next().hide(),t.hide())},show:function(){var t=this.com
;t.next().hasClass("window-mask")&&(t.next().show(),t.show())}}),PJF.apply(PJF.ui.window.prototype,{getClassName:function(){return"PJF.ui.window"},subComponentsDestroy:function(t){if(t.is("[componentid]")){var e=t.attr("componentid");PJF.ui.componentMgr.get(e).destroy()}else for(var n=t.children(),i=0;i<n.length;i++)this.subComponentsDestroy($(n[i]))},destroy:function(){this.com&&(this.subComponentsDestroy(this.com.find(".stmwindow-body")),this.com.next().remove(),this.com.remove(),this.options.retainDom&&this.copyComObj.attr("id",this.options.dom),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null)}}),PJF.ui.identityCard=PJF.extend(PJF.ui.component,{init:function(t){this.params={infoMsg:resource.IDENTITY_INSERT_MSG,pchPhotoName:"",frontPhotoName:"",backPhotoName:"",success:function(t){},failure:function(t){},timeout:60},$.extend(this.params,t),this.initUi(this.params),
"DF001"==PJF.orgInfo.instSvrlLgPsnID&&$(".pjf_stm_content_left").css("background-image","url('../../../css/stmimg/insertidcard_mov_zd.gif')"),PJF.otherInfo.isSelfBank&&PJF.otherInfo.selfBizTp&&!t.supportEId&&$(".pjf_stm_content_left").css("background-image","url('../../../css/stmimg/insertidcard_mov_"+PJF.otherInfo.selfBizTp+".gif')").css("background-size","contain"),!t.supportEId||"2"!=PJF.otherInfo.selfBizTp&&"3"!=PJF.otherInfo.selfBizTp||$(".pjf_stm_content_left").css("background-image","url('../../../css/stmimg/eIdImg_mov_"+PJF.otherInfo.selfBizTp+".gif')").css("background-size","contain"),this.idenHanlder()},idenHanlder:function(){var s=this,n=this,i=this.params;setTimeout(function(){try{if(PJF.constants.IS_DEBUG)return void n.params.success(PJF.stm.idenAuth.custInfo);if(PJF.util.deviceType.stm){var a={pchPhotoPath:PJF.stm.baseDir+"/identity/"+n.params.pchPhotoName,frontPhotoPath:PJF.stm.baseDir+"/identity/"+n.params.frontPhotoName,
backPhotoPath:PJF.stm.baseDir+"/identity/"+n.params.backPhotoName,imageType:2,idcSound:i.idcSound,timeout:s.params.timeout};i.supportEId&&(a.idcSound="app/common/idAndEId.mp3"),PJF.stm.IdCard.getChannelStatus(function(t){if(1==t.status)if(0==t.info.status){var e,n=new PJF.ui.loading({noLayer:!0,noIcon:!0,msg:"",timeout:s.params.timeout}),i=function(){n&&n.destroy()},o=function(){n.destroy(),n=null,e=new PJF.ui.loading({msg:PJF.i18n.getI18nResource("pjfCommon.readIDCardTip"),opacity:.1})};PJF.event.onceSubscriber(PJF.stm.client.events.IDC_STOP,i),PJF.event.onceSubscriber(PJF.stm.client.events.IDC_INHALED,o),PJF.stm.IdCard.readCard(a,function(){PJF.event.removeSubscriber(PJF.stm.client.events.IDC_STOP,i),PJF.event.removeSubscriber(PJF.stm.client.events.IDC_INHALED,o),n&&n.destroy(),e&&e.destroy(),s.callBack.apply(s,arguments)})}else new PJF.ui.messageBox({title:"提示信息",content:"卡槽已经有身份证，请点弹出按钮取出身份证",buttonConfs:[{bgColor:"rgb(121,198,30)",name:"弹身份证",style:"main",width:200,height:80,
onClick:function(){PJF.stm.IdCard.ejectDev(function(){template&&template.loadPage("homepage")})}}]});else{new PJF.ui.messageBox({title:"提示信息",content:"获取身份证卡槽状态失败",buttonConfs:[{bgColor:"rgb(121,198,30)",name:"返回首页",style:"main",width:200,height:80,onClick:function(){template&&template.loadPage("homepage")}}]});console.log("icdentityCard获取卡通道错误:"+JSON.stringify(t)),PJF.event.publish("IDC_Channel_Fail")}})}if(PJF.util.deviceType.ytd){var t={pchPhotoName:n.params.pchPhotoName,frontPhotoName:n.params.frontPhotoName,backPhotoName:n.params.backPhotoName,iFlag:1,idcSound:i.idcSound},e=new PJF.ui.loading({noLayer:!0,noIcon:!0,msg:"",timeout:s.params.timeout});PJF.ytd.IDC.getIDCardInfo(t,function(t){e&&e.destroy(),"DRV0000020"==t.errorCode&&PJF.event.publish("IDC_Cancel"),s.callBack.apply(s,arguments)})}}catch(t){alert(t.message)}},0)},initUi:function(t){var e;PJF.util.deviceType.stm&&(e='<div class="pjf_stm_content_left pjf_stm_identityStyle pjf_stm_identityCardImg">',
PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME?e='<div class="pjf_stm_content_left pjf_stm_identityStyle pjf_stm_icmidentityCardImg">':PJF.otherInfo.typeInfo==PJF.constants.TCR_NAME&&(e='<div class="pjf_stm_content_left pjf_stm_identityStyle pjf_stm_tcridentityCardImg">'),t.supportEId&&(e='<div class="pjf_stm_content_left pjf_stm_identityStyle pjf_stm_eIdImg">')),PJF.util.deviceType.ytd&&(e='<div class="pjf_stm_content_left pjf_ytd_identityCardImg">'),e+='</div><div class="pjf_stm_content_right" style="display:none;"><div class="pjf_stm_identityCardMsg"><ul><li><div class="pjf_stm_msg"><span class="stm_info_span"></span>'+resource.DEVICE_INFO_MSG+'</div></li><li><div class="pjf_stm_cardreader_msg">'+t.infoMsg+"</div></li></ul></div></div>",$("#"+t.dom).append(e)},callBack:function(t){0==t.status?"DRV0000020"!=t.errorCode&&this.params.failure(t):this.params.success(t.info.pchInfo)},getClassName:function(){return"PJF.ui.identityCard"}}),PJF.apply(PJF.ui.identityCard.prototype,{}),
PJF.ui.grid=PJF.extend(PJF.ui.component,{init:function(t){this.gridDom={},this.gridData=t.data,this.gridCurrentLoadedRows=[],this.gridAllRows=[],t=this.params=this.conf=PJF.apply(t,{scaleRate:parseInt($("html").css("fontSize"),10)/PJF.constants.DEFAULT_FONTSIZE,width:t.width||860,height:t.height||300,autoResizeWidth:!!t.autoResizeWidth,horizontalScrollBarHeight:t.horizontalScrollBarHeight||17,verticalScrollBarHeight:t.verticalScrollBarHeight||17,gridLayoutClass:t.gridLayoutClass,minShowRowCount:t.minShowRowCount,maxShowRowCount:t.maxShowRowCount,minContentHeight:t.minContentHeight||67*t.minShowRowCount||201,maxContentAutoSizeHeight:t.maxContentAutoSizeHeight||67*t.maxShowRowCount||670,singleSelect:!(!1===t.singleSelect),rownumbers:t.rownumbers,url:t.url,async:!(!1===t.async),type:t.type,traditional:t.traditional,queryParams:t.queryParams||{},pageSizeParamName:t.pageSizeParamName,pageNumberParamName:t.pageNumberParamName,paginationParamsLevelName:t.paginationParamsLevelName,
totalPath:t.totalPath||"total",rowsPath:t.rowsPath||"rows",currentPath:t.currentPath||"PAGE_JUMP",showHead:t.showHead,showBorder:t.showBorder,isShowCheckAllIcon:t.isShowCheckAllIcon,columns:t.columns,defaultAlign:t.defaultAlign||"left",nowrap:void 0===t.nowrap||t.nowrap,initMsg:t.initMsg||"很抱歉，没有您所需要的数据",noDataMsg:t.noDataMsg||"很抱歉，没有您所需要的数据",loadingMsg:t.loadingMsg||"加载中...",sortName:t.sortName,sortOrder:t.sortOrder||"asc",onClickRow:t.onClickRow,onDblClickRow:t.onDblClickRow,isClickRowOnCheck:t.isClickRowOnCheck,isCheckOnClickRow:t.isCheckOnClickRow,onBeforeCheckRow:t.onBeforeCheckRow,onCheckRow:t.onCheckRow,onBeforeUnCheckRow:t.onBeforeUnCheckRow,onUnCheckRow:t.onUnCheckRow,onCheckAll:t.onCheckAll,onUnCheckAll:t.onUnCheckAll,rowStyler:t.rowStyler,onBeforeLoad:t.onBeforeLoad||function(){},onLoadSuccess:t.onLoadSuccess,onLoadFailure:t.onLoadFailure,onLoadError:t.onLoadError}),this.gridOptions={gridColumnClassPrefix:t.dom+"-grid-cell-field-",hasCheckOrRadio:!1,isNeedAdjustRowHeight:!1,
hasSorted:!1,status:1,isRequesting:!1,isTouched:!1,hideScrollBarTimeout:null,lastScrollTop:-1,paginationOptions:{currentPageNumber:1,currentPageGroupNumber:1,totalPageGroupNumber:1,totalPageNumber:1,isLocalPagination:!!t.isLocalPagination,reqType:t.reqType,isFirstReq:!0,pageSize:t.pageSize||10,showNumberSize:t.showNumberSize||6,isShowPaginationNumber:t.isShowPaginationNumber,pagination:!(!1===t.pagination),isAppendMode:!(!1===t.isAppendMode),pageChangeHandler:t.pageChangeHandler,paginationBtnStatus:{first:!1,prev:!1,next:!1,last:!1},isShowLoading:!1,prevBtn:null,nextBtn:null,paginationDesc:null,reqDirection:!1,sendPath:t.sendPath||".",ccbsPath:t.ccbsPath||"_COMMON.COMA",PAGE_STA_KEY:void 0,OPM_ITI_ID:void 0,PAGE_STA_KEY_ARRAY:[],lastPAG_STA_KEY:void 0},columnOptions:{fixedColumnWidth:0,autoColumns:{}},gridConstant:{GRID_HEAD_HEIGHT:70,BORDER_LR_TOTAL_WIDTH:4,GRID_SCROLL_BAR_WIDTH:this.getSrollBarWidth(),ckColumnWidth:25,GRID_ROW_NUMBER_FIELD_WIDTH:60,GRID_COLUMN_WIDTH_SIZE:24,
GRID_ROW_NUMBER_FIELD:"GRID-ROWNUMBER"},checkOptions:{checkedRowIndexMap:new PJF.util.Collection,allPageCheckedRowIndexMap:new PJF.util.Collection,isAddOrRemoveData:!1,lastCheckedRowDom:null}},this.paramsFilter(),this.renderGrid(),this.regEventHandler()},paramsFilter:function(){var t=this.conf;if(t.rownumbers){var e=this.gridOptions.gridConstant;t.columns[0].splice(0,0,{field:e.GRID_ROW_NUMBER_FIELD,width:e.GRID_ROW_NUMBER_FIELD_WIDTH,rowNumber:!0,title:"序号",align:"center"})}t.minContentHeight+=t.verticalScrollBarHeight,t.maxContentAutoSizeHeight+=t.verticalScrollBarHeight},renderGrid:function(){this.createGridDom(),this.createHeaderDom(),this._loadData()},renderContent:function(){var t=this.gridOptions.paginationOptions;this.conf.url&&!t.isAppendMode&&this.clearCheckedRowIndex(),this.createBodyDom(),this.createFooterDom(),this.renderPagination()},createGridDom:function(){if(!this.com.hasClass("YTD-Grid")){this.com.addClass="YTD-Grid"
;$(["\x3c!-- 表格最外层 --\x3e",' <div class="grid-container">','<style type="text/css"></style>'," \x3c!-- 可能的表格title --\x3e",' <div class="grid-title">grid-title</div>',' <div class="clear"></div>'," \x3c!-- 可能的预留的按钮栏位 --\x3e",'  <div class="grid-toolbar">grid-toolbar</div>','   <div class="clear"></div>',"     \x3c!-- 表格的内容显示区 --\x3e",'       <div class="grid-content-scroll-mask-outer">','<span class="grid-content-scroll-v-mask-scroll"></span>','<span class="grid-content-scroll-h-mask-scroll"></span>','       <div class="grid-content-scroll-mask-inner">','       <div class="grid-content">',"\x3c!-- 表格表头 --\x3e",'<div class="grid-header">','     <div class="grid-header-left-container">','     \t\t<div class="grid-header-left"></div>',"     </div>",'     <div class="grid-header-right-container">','          <div class="grid-header-right"></div>',"     </div>","   </div>",'     <div class="clear"></div>',"     \x3c!-- 表格内容区 --\x3e",'     <div class="grid-body">','        <div class="grid-body-left-container">','          <div class="grid-body-left"></div>',"        </div>",'        <div class="grid-body-right-container">','            <div class="grid-body-right"></div>',"        </div>","        \x3c!-- 表格提示信息--\x3e",'        <div class="grid-notification-msg"></div>',"    </div>",'    <div class="clear"></div>',"    \x3c!-- 表格页脚 --\x3e",'    <div class="grid-footer">','     <div class="grid-footer-left"></div>','    <div class="grid-footer-right"></div>',"   </div>"," </div>","</div>","</div>",'<div class="clear"></div>'," \x3c!-- 分页栏 --\x3e",'<div class="grid-pagination-bar"></div>',"</div>"].join("")).appendTo(this.com)
;var t=$("div.grid-container",this.com);this.gridDom={container:t,style:t.children("style")[0],title:$("div.grid-title",t),toolbar:$("div.grid-toolbar",t),contentScrollMaskOuter:$("div.grid-content-scroll-mask-outer",t),contentScrollMaskInner:$("div.grid-content-scroll-mask-inner",t),contentScrollBarV:$("span.grid-content-scroll-v-mask-scroll",t),contentScrollBarH:$("span.grid-content-scroll-h-mask-scroll",t),content:$("div.grid-content",t),header:$("div.grid-header",t),headerLeft:$("div.grid-header-left",t),headerLeftContainer:$("div.grid-header-left-container",t),headerRight:$("div.grid-header-right",t),headerRightContainer:$("div.grid-header-right-container",t),body:$("div.grid-body",t),bodyLeftContainer:$("div.grid-body-left-container",t),bodyLeft:$("div.grid-body-left",t),bodyRightContainer:$("div.grid-body-right-container",t),bodyRight:$("div.grid-body-right",t),footer:$("div.grid-footer",t),footerLeft:$("div.grid-footer-left",t),footerRight:$("div.grid-footer-right",t),
notificationMsg:$("div.grid-notification-msg",t),paginationBar:$("div.grid-pagination-bar",t)}}},createHeaderDom:function(){if(!1!==this.conf.showHead){this.gridOptions.columnOptions.isAllFixedWidth=!0;var t=this.conf.columns[0],e=[];e.push('<div class="grid-head-row">');for(var n=0,i=t.length;n<i;n++)e.push(this.headerRender(t[n]));e.push('<span class="grid-head-empty-cell">&nbsp;</span>'),e.push("</div>"),this.gridDom.headerRight.html(e.join(""))}else this.gridDom.header.hide()},headerRender:function(t){var e=[],n="";t.width&&"auto"!==t.width?(t.width=parseFloat(parseFloat(t.width,10).toFixed(3)),n+="width:"+t.width/PJF.constants.DEFAULT_FONTSIZE+"rem;",this.gridOptions.columnOptions.fixedColumnWidth+=t.width,t.isUserDefWidth=!0):this.gridOptions.columnOptions.isAllFixedWidth=!1,t.headAlign=t.headAlign||t.align||this.conf.defaultAlign,n+="text-align:"+t.headAlign+";",void 0===t.title&&(t.title=""),
e.push('<div class="grid-cell grid-head-cell '+this.gridOptions.gridColumnClassPrefix+t.field+(t.hidden?" grid-hidden-cell":"")+'" field="'+t.field+'" style="'+n+'">'),e.push('<div class="grid-cell-container grid-head-cell-container" field="'+t.field+'">');var i=this.isCheckOrRadio(t);return i?(e.push('<div class="grid-ck '+(t.isCheckbox&&!1!==this.conf.isShowCheckAllIcon?"grid-"+i:"")+'" field="'+t.field+'"></div>'),this.gridOptions.columnOptions.fixedColumnWidth+=this.gridOptions.gridConstant.ckColumnWidth,this.gridOptions.hasCheckOrRadio=!0):e.push('<div class="cell-text header-cell-text" field="'+t.field+'">'+t.title+"</div>"),e.push("</div></div>"),e.join("")},createBodyDom:function(){0!==this.gridData.rows.length?this.bodyRender():this.setNotificationMsg(!0)},bodyRender:function(){var t=this.gridCurrentLoadedRows;if(t&&t instanceof Array&&0!==t.length){this.conf.isLocalPagination&&!this.conf.url?this.gridAllRows=this.gridData.rows:this.gridAllRows=t
;for(var e=this.conf.columns[0],n=[],i=-1,o=!1,a=this.gridOptions.checkOptions,s=a.allPageCheckedRowIndexMap,r=0,c=t.length;r<c;r++){var l=this.getAbsoluteRowIndex(r);o=s.containsKey(l+""),n.push(this.rowRender(r,t[r],e,o)),o&&(i=r,this.addCheckedRowIndex(r,!1))}this.gridDom.notificationMsg.hide(),this.gridDom.bodyRight.html(n.join("")),-1!=i&&(a.lastCheckedRowDom=this.getRowDom(i))}},rowRender:function(t,e,n,i){var o=this.conf,a=[],s=this._rowStyler(t,e);a.push('<div class="grid-row'+(t%2==0?" grid-row-odd":"")+(i?" grid-row-checked":"")+'" rowIndex="'+t+'" style="'+s+'">');for(var r=0,c=n.length;r<c;r++){var l=n[r],u="",d="";l.width&&"auto"!==l.width&&(l.width=parseFloat(parseFloat(l.width,10).toFixed(3)),u+="width:"+l.width/PJF.constants.DEFAULT_FONTSIZE+"rem;",!1===o.nowrap&&(d+="white-space:normal;",this.gridOptions.isNeedAdjustRowHeight=!0)),l.align=l.align||o.defaultAlign,u+="text-align:"+l.align,
a.push('<div class="grid-cell grid-body-cell '+this.gridOptions.gridColumnClassPrefix+l.field+(l.hidden?" grid-hidden-cell":"")+'" field="'+l.field+'" style="'+u+'">'),a.push('<div class="grid-cell-container grid-body-cell-container" field="'+l.field+'">');var h=this.isCheckOrRadio(l);if(h)a.push('<div class="grid-ck grid-'+h+(i?" grid-"+h+"-checked":"")+'" field="'+l.field+'"></div>');else{var m=e[l.field];l.formatter&&(m=l.formatter(m,e,t,l)),null==m&&(m=""),!0===l.rowNumber&&(m=t+1),a.push('<div class="cell-text body-cell-text" field="'+l.field+'" style="'+d+'">'+m+"</div>")}a.push("</div></div>")}return a.push("</div>"),a.join("")},createFooterDom:function(){},footerRender:function(){},renderPagination:function(){this.createPaginationDom(),this.createPagination(),this.regPaginationBtnClickHandler()},createPaginationDom:function(){if(this.gridOptions.paginationOptions.pagination){var t=this.gridDom,e=this.gridDom.paginationBar
;e.html(['<div class="grid-pagination-container">','<span class="grid-pagination-btn grid-pagination-first"> </span>','<span class="grid-pagination-btn grid-pagination-prev"> </span>','<div class="grid-pagination-number-container"> </div>','<span class="grid-pagination-btn grid-pagination-next"> </span>','<span class="grid-pagination-btn grid-pagination-last"> </span>','<span class="grid-pagination-btn grid-pagination-desc"> </span>',"</div>"].join("")),t.paginationFirst=$("span.grid-pagination-first",e),t.paginationPrev=$("span.grid-pagination-prev",e),t.paginationNumber=$("div.grid-pagination-number-container",e),t.paginationNext=$("span.grid-pagination-next",e),t.paginationLast=$("span.grid-pagination-last",e),t.paginationDesc=$("span.grid-pagination-desc",e),t.paginationDesc.html("0/0")}},createPagination:function(){var t=this.gridData||{},e=t.total||0,n=Number(t[this.conf.currentPath]);if(!(e<=0)){var i=this.gridOptions.paginationOptions,o=i.pageSize;isNaN(n)&&(n=null),
i.currentPageNumber=n||i.currentPageNumber,i.totalPageNumber=Math.ceil(e/o),i.totalPageGroupNumber=Math.ceil(i.totalPageNumber/i.showNumberSize),this.updatePagination(),this.updatePaginationBtnStatus()}},updatePaginationParams:function(t,e){if(arguments.length){var n=this.gridOptions.paginationOptions;1!=arguments.length||"Object"!=typeof e?n.pageSize=t||n.pageSize:$.extend(n,e)}},updatePagination:function(){var t=this.gridOptions.paginationOptions;if(!t.reqType){t.currentPageGroupNumber,t.showNumberSize,t.currentPageNumber,t.totalPageNumber;this.updatePaginationBtnStatus()}},updatePaginationBtnStatus:function(t,e,n,i){var o=this.gridDom,a=!1,s=!1,r=!1,c=!1,l=this.gridOptions.paginationOptions,u=l.currentPageNumber,d=l.totalPageNumber;1<u&&(a=!0),1<u&&(s=!0),u<d&&(r=!0),u<d&&(c=!0),null!=t&&(a=t),null!=e&&(s=e),null!=n&&(r=n),null!=i&&(c=i),l.paginationBtnStatus={first:a,prev:s,next:r,last:c},u=9<u?u:"0"+u,d=9<d?d:"0"+d,o.paginationDesc&&o.paginationDesc.html(u+"/"+d),
s?l.prevBtn&&l.prevBtn.enable():l.prevBtn&&l.prevBtn.disable(),r?l.nextBtn&&l.nextBtn.enable():l.nextBtn&&l.nextBtn.disable(),l.paginationDesc&&l.paginationDesc.html(u+"/"+d),PJF.event.publish(this.conf.dom+"_PageChange",{target:this,currentPageNumber:parseInt(u,10),totalPageNumber:d,prevBtnStatus:s,nextBtnStatus:r})},regPaginationBtnClickHandler:function(){var i=this,t=this.gridDom,n=this.gridOptions.paginationOptions;!1!==n.pagination&&(t.paginationNumber.unbind().bind("click",function(t){var e=$(t.target);if(e.hasClass("grid-pagination-number")&&!e.hasClass("grid-pagination-marginLine")){var n=parseInt(e.attr("number"),10);i.pageChangeHandler(n),t.stopPropagation()}}),t.paginationFirst.unbind().bind("click",function(t){n.paginationBtnStatus.first&&(i.pageChangeHandler(1,1),t.stopPropagation())}),t.paginationPrev.unbind().bind("click",function(t){if(n.paginationBtnStatus.prev){if(n.reqType)return i.specialPageChangeHandler(!0),void t.stopPropagation();var e=n.currentPageNumber
;(e-=1)<1?alert("Error: 内部逻辑错误 currentPageNumber =  "+e):(i.pageChangeHandler(e),t.stopPropagation())}}),t.paginationNext.unbind().bind("click",function(t){if(n.paginationBtnStatus.next){if(n.reqType)return i.specialPageChangeHandler(!1),void t.stopPropagation();var e=n.currentPageNumber;(e+=1)>n.totalPageNumber?alert("Error: 内部逻辑错误 currentPageNumber =  "+e+" > totalPageNumber("+n.totalPageNumber+")"):(i.pageChangeHandler(e),t.stopPropagation())}}),t.paginationLast.unbind().bind("click",function(t){n.paginationBtnStatus.last&&(i.pageChangeHandler(n.totalPageNumber,n.totalPageGroupNumber),t.stopPropagation())}))},pageChangeHandler:function(t,e){if(this.conf.pageChangeHandler&&!1===this.conf.pageChangeHandler(t))return;var n=this.gridOptions.paginationOptions;n.preCurrentPageNumber=n.currentPageNumber,n.currentPageNumber!=t&&(n.currentPageNumber=t,e||(e=Math.ceil(t/n.showNumberSize)),n.currentPageGroupNumber=e,!1===n.isAppendMode&&this.clearCheckedRowIndex(!1),this.updatePagination(),
this._loadData())},specialPageChangeHandler:function(t){if(this.conf.pageChangeHandler&&!1===this.conf.pageChangeHandler(t))return;this.gridOptions.paginationOptions.reqDirection=t,this._loadData()},pageChangeFailure:function(){if(this.gridDom.paginationNumber){var t=this.gridOptions.paginationOptions;t.currentPageNumber=t.preCurrentPageNumber||1,this.updatePagination()}},showLoading:function(t){var e=this.gridDom;if(!this.gridOptions.paginationOptions.showLoading){if(!e.loadingMask){var n='<div id="'+this.conf.dom+'_grid_loadding" class="grid-loading-mask"> </div>',i='<div class="grid-loading-container"><div class="grid-loading-content">'+this.conf.loadingMsg+"</div></div>";e.loadingMask=$(n).appendTo(e.contentScrollMaskOuter),e.loadingMsg=$(i).appendTo(e.contentScrollMaskOuter)}e.loadingMask.css("display","block"),e.loadingMsg.css("display","block"),this.gridOptions.paginationOptions.showLoading=!0}},removeLoading:function(){var t=this.gridDom.loadingMask,e=this.gridDom.loadingMsg
;t&&(t.css("display","none"),e.css("display","none")),this.gridOptions.paginationOptions.showLoading=!1},resetPagination:function(){var t=this.gridOptions.paginationOptions;PJF.apply(t,{currentPageNumber:1,currentPageGroupNumber:1,totalPageGroupNumber:1,totalPageNumber:1,paginationBtnStatus:{first:!1,prev:!1,next:!1,last:!1}}),PJF.apply(this.gridOptions,{lastScrollTop:-1}),this.renderPagination()},_generatePrependPageStyle:function(){var t=[];if(this.conf.customHeaderStyle){var e=this.conf.dom;for(var n in this.conf.customHeaderStyle){var i=this.conf.customHeaderStyle[n];i instanceof Array&&(i=i.join(";")),t.push("#"+e+' div.header-cell-text[field="'+n+'"]{'+i+"}")}}return t.join("")},addPrependPageStyle:function(){var e=this._generatePrependPageStyle();try{this.gridDom.style.innerHTML=this.gridDom.style.innerHTML+e}catch(t){this.gridDom.style.styleSheet.cssText=this.gridDom.style.innerHTML+e}},updatePageStyle:function(t,e){var n=this.gridOptions,i=n.columnOptions.autoColumns,o=[]
;o.push(this._generatePrependPageStyle());for(var a=0,s=i.length;a<s;a++){var r=i[a];if(0<=t){var c=r.currentColumnMaxWidth*(parseInt($("html").css("fontSize"))/100)+t;a+1==s&&(c+=e||0)}else c=r.currentColumnMaxWidth*(parseInt($("html").css("fontSize"))/100);o.push("."+n.gridColumnClassPrefix+r.field+"{width:"+c+"px;min-width:"+c+"px;}")}try{this.gridDom.style.innerHTML=o.join("")}catch(t){this.gridDom.style.styleSheet.cssText=o.join("")}},_dataFilter:function(t){if(this.gridOptions.paginationOptions.isAppendMode&&1<this.gridOptions.status)return this._dataFormatter(t);this._dataFormatter();var e=this.gridData.rows,n=-1,i=-1,o=this.gridOptions.paginationOptions;if(o.isLocalPagination){var a=o.currentPageNumber,s=o.pageSize;n=(a-1)*s,i=a*s,e=e.slice(n,i)}this.gridCurrentLoadedRows=e,this._dataSorter(n,i)},_dataFormatter:function(tempData){var isFromReq=!!tempData;if(this.gridData=this.gridData||{},this.tempData=tempData||(this.gridData||{}),
this.tempData)if(this.tempData instanceof Array)this.tempData={total:this.tempData.length,rows:this.tempData};else{if(void 0===this.tempData.rows)try{var rowsExpress="this.tempData."+this.conf.rowsPath;this.tempData.rows=eval("("+rowsExpress+")"),this.tempData.rows?$.isPlainObject(this.tempData.rows)&&(this.tempData.rows=[].concat(this.tempData.rows)):this.tempData.rows=[]}catch(t){this.tempData.rows=[]}else this.tempData.rows instanceof Array||($.isPlainObject(this.tempData.rows)?this.tempData.rows=[].concat(this.tempData.rows):(alert("Error: 表格数据中 rows属性必须为数组或者对象object！"),this.tempData.rows=[]));if(void 0===this.tempData.total)try{var totalExpress="this.tempData."+this.conf.totalPath;this.tempData.total=eval("("+totalExpress+")")}catch(t){this.tempData.total=0}try{this.tempData.total=parseInt(this.tempData.total,10),this.tempData.total||(this.tempData.total=0)}catch(t){alert("Error: 表格数据中 total字段不是数字！"),this.tempData.total=0}
0===this.tempData.total&&(this.tempData.total=this.tempData.rows.length)}else this.tempData={total:0,rows:[]};if(isFromReq)return this.gridData.rows=(this.gridData.rows||[]).concat(this,this.tempData.rows),this.tempData.rows;this.gridData=this.tempData},_dataSorter:function(t,e){var n=this.conf.sortName;if(n){var i=this.conf.sortOrder,o=this.getColumn(n);if(o){var a=o.sorter||function(t,e,n,i){return e<t?1:-1};this.gridCurrentLoadedRows.sort(function(t,e){return a(t[n],e[n],t,e)*("asc"==i?1:-1)});var s=this.gridOptions.paginationOptions;s.isLocalPagination?this.gridData.rows.splice.apply(this.gridData.rows,[t,s.pageSize].concat(this.gridCurrentLoadedRows)):this.gridData.rows=this.gridCurrentLoadedRows}else alert("Error: 参数sortName("+n+")指定的列不存在！")}},_loadData:function(){var t=this.conf;this.showLoading(),t.url?this._doSendReq():this._doLoadData()},updateReqParams:function(t){$.extend(this.conf,t)},_prepareReqParams:function(){
var conf=this.conf,paginationOptions=this.gridOptions.paginationOptions,queryParams=conf.queryParams;if(queryParams){queryParams.jsonData=queryParams.jsonData||{};var jsonData=queryParams.jsonData;if("string"==typeof queryParams.jsonData)try{queryParams.jsonData=eval("("+queryParams.jsonData+")")}catch(t){alert("Error: queryParams属性jsonData不是标准的JSON字符串。")}var REC_IN_PAGE_Key=conf.pageSizeParamName||"REC_IN_PAGE",PAGE_JUMP_key=conf.pageNumberParamName||"PAGE_JUMP",paginationParams={};paginationParams[REC_IN_PAGE_Key]=paginationOptions.pageSize,paginationParams[PAGE_JUMP_key]=paginationOptions.currentPageNumber;var paginationParamsLevelName=conf.paginationParamsLevelName||"_pagination";if("."==paginationParamsLevelName)for(var x in paginationParams)queryParams.jsonData[x]=paginationParams[x];else queryParams.jsonData[paginationParamsLevelName]=paginationParams;return this._handleReqTypeParams(paginationOptions,queryParams)}},_handleReqTypeParams:function(t,e){switch(t.reqType){
case"CCBS":return this._setCCBSReqParams(t,e);case"P6":return this._setP6ReqParams(t,e);case"P6_1":return this._setP6_1ReqParams(t,e);case"CCMS":return this._setCCMSReqParams(t,e)}},_getReqTypeValueByKey:function(key,isParseInt,defaultValue){var keyPath="",paginationOptions=this.gridOptions.paginationOptions;keyPath="."==paginationOptions.ccbsPath?"this.gridData."+key:"this.gridData."+paginationOptions.ccbsPath+"."+key;var value="";try{value=eval("("+keyPath+")"),value=null==value?"":value}catch(t){value=""}if(isParseInt)try{value=parseInt(value),isNaN(value)&&(value=defaultValue||0)}catch(t){value=defaultValue||0,"undefined"!=typeof console&&console.log("Error--\x3e parse value("+value+") to int error!")}return value},_setCCBSReqParams:function(t,e){var n={};if(t.isFirstReq)n.INM_MSG_STATUS=32769,n.INM_PAGE_CTL={},n.INM_PAGE_CTL.INM_PAGE_UP_DOWN=0;else{this.gridData
;var i=this._getReqTypeValueByKey("OPM_PAGE_CTL.OPM_PAGE_STA_KEY"),o=this._getReqTypeValueByKey("OPM_PAGE_CTL.OPM_PAGE_END_KEY"),a=this._getReqTypeValueByKey("OPM_PAGE_CTL.OPM_PAGE_NO_DATA");if(t.OPM_ITI_ID=this._getReqTypeValueByKey("OPM_ITI_ID"),n.INM_ITI_ID=t.OPM_ITI_ID,n.INM_MSG_STATUS=36865,n.INM_PAGE_CTL={},n.INM_PAGE_CTL.INM_PAGE_STA_KEY="",n.INM_PAGE_CTL.INM_PAGE_END_KEY="",t.reqDirection){if(i==t.firstSTA_KEY)return!1;n.INM_PAGE_CTL.INM_PAGE_UP_DOWN=1;var s=t.PAGE_STA_KEY_ARRAY.pop();console.log("请求上页---\x3e"+s),n.INM_PAGE_CTL.INM_PAGE_STA_KEY=s||""}else{if("1"==a)return!1;n.INM_PAGE_CTL.INM_PAGE_UP_DOWN=2,n.INM_PAGE_CTL.INM_PAGE_END_KEY=o}}var r=e.jsonData;if("."==t.sendPath)for(var c in n)r[c]=n[c];else r[t.sendPath]=n},_setP6ReqParams:function(t,e){var n={};if(t.isFirstReq)n.FLOW_STATUS="00000000";else{var i=this._getReqTypeValueByKey("FLOW_STATUS");if("00000000"==i)return"undefined"!=typeof console&&console.log("Error: 主机系统已经主动终止了本套会话，外围系统不可在继续交谈！"),!1
;var o=this._getReqTypeValueByKey("PAGE_STA_KEY"),a=this._getReqTypeValueByKey("PAGE_END_KEY"),s=this._getReqTypeValueByKey("CONV_NO_DATA"),r=this._getReqTypeValueByKey("FLOW_ITI_ID");if(n.FLOW_STATUS=i,n.FLOW_ITI_ID=r,n.PAGE_STA_KEY=o,n.PAGE_END_KEY=a,t.reqDirection){var c=t.PAGE_STA_KEY_ARRAY.pop();n.PAGE_UP_DOWN=1,n.PAGE_STA_KEY=c||""}else{if("Y"==s)return!1;n.PAGE_UP_DOWN=2}}var l=e.jsonData;if("."==t.sendPath)for(var u in n)l[u]=n[u];else l[t.sendPath]=n},_setP6_1ReqParams:function(t,e){var n={};if(t.isFirstReq)n.FLOW_STATUS="00000000";else{var i=this._getReqTypeValueByKey("FLOW_STATUS");if("00000000"==i)return"undefined"!=typeof console&&console.log("Error: 主机系统已经主动终止了本套会话，外围系统不可在继续交谈！"),!1;var o=this._getReqTypeValueByKey("PAGE_STA_KEY"),a=this._getReqTypeValueByKey("PAGE_END_KEY"),s=this._getReqTypeValueByKey("CONV_NO_DATA"),r=this._getReqTypeValueByKey("FLOW_ITI_ID");if(n.FLOW_STATUS=i,n.FLOW_ITI_ID=r,n.PAGE_STA_KEY=o,n.PAGE_END_KEY=a,t.reqDirection){t.PAGE_STA_KEY_ARRAY.pop()
;n.PAGE_UP_DOWN=1}else{if("Y"==s)return!1;n.PAGE_UP_DOWN=2}}var c=e.jsonData;if("."==t.sendPath)for(var l in n)c[l]=n[l];else c[t.sendPath]=n},_setCCMSReqParams:function(t,e){var n={};if(n.INQUIRE_NUM=t.pageSize,t.isFirstReq)n.PAGE_NO=1;else{var i=parseInt(this._getReqTypeValueByKey("PAGE_NO")),o=parseInt(this._getReqTypeValueByKey("TOT_PAGE_NUM"));if(t.reqDirection){if(1==i)return!1;n.PAGE_NO=i-1}else{if(i==o||0==o)return!1;n.PAGE_NO=i+1}}var a=e.jsonData;if("."===t.sendPath)for(var s in n)a[s]=n[s];else a[t.sendPath]=n},_doSendReq:function(){var t=this.conf,i=this;!1!==this._prepareReqParams()&&(!1!==t.onBeforeLoad.call(this,t.queryParams)?PJF.communication.cpsJsonReq($.extend({},t.queryParams,{url:t.url,dataType:t.dataType||PJF.constants.AJAX_DATA_TYPE,data:t.queryParams,maskAll:!1,async:t.async,traditional:t.traditional,type:t.type||PJF.constants.AJAX_METHOD,timeOut:t.timeOut||PJF.constants.AJAX_TIMEOUT,success:function(t){i._successCallBack(t)},failure:function(t){
i._successCallBack(t)},error:function(t,e,n){i._errorCallBack(t,e,n)}})):this._successCallBack())},_successCallBack:function(t,e,n){if(this.gridOptions.paginationOptions.isAppendMode&&1<this.gridOptions.status)return this._doAppendData(t,e,n),this.gridOptions.isRequesting=!1,void console.log("---------set isRequesting = fasle in success callback--------------------");this.gridData=t||{},this._doLoadData(),this.gridOptions.status++,this.gridOptions.isRequesting=!1},_errorCallBack:function(t,e,n){if(this.conf.onLoadError&&this.conf.onLoadError(t,e,n),this.pageChangeFailure(),this.gridOptions.paginationOptions.isAppendMode&&1<this.gridOptions.status)return this._doAppendData(t,e,n),console.log("---------set to false in error--------------------"),void(this.gridOptions.isRequesting=!1);this.gridData={},this._doLoadData(),this.gridOptions.isRequesting=!1},_dataErrorHandler:function(t){var e=t||this.gridData
;e&&e.BK_STATUS&&e.BK_STATUS!=PJF.constants.BK_CODE_SUCCESS&&this.conf.onLoadFailure&&this.conf.onLoadFailure(e)},_loadHandler:function(){switch(this.gridOptions.paginationOptions.reqType){case"CCBS":this._CCBSLoadHandler();break;case"P6":case"P6_1":this._P6LoadHandler();break;case"CCMS":this._CCMSLoadHandler()}},_CCBSLoadHandler:function(){var t=this.gridOptions.paginationOptions;t.isFirstReq=!1;var e=this._getReqTypeValueByKey("OPM_PAGE_CTL.OPM_PAGE_NO_DATA"),n=this._getReqTypeValueByKey("OPM_PAGE_CTL.OPM_PAGE_STA_KEY");t.lastPAG_STA_KEY&&!t.reqDirection&&t.PAGE_STA_KEY_ARRAY.push(t.lastPAG_STA_KEY),t.lastPAG_STA_KEY=n,void 0===t.PAGE_STA_KEY&&(t.PAGE_STA_KEY=n);var i=!1,o=!1;o="1"!=e,(i=t.PAGE_STA_KEY!=n)?t.prevBtn&&t.prevBtn.enable():t.prevBtn&&t.prevBtn.disable(),o?t.nextBtn&&t.nextBtn.enable():t.nextBtn&&t.nextBtn.disable(),t.paginationBtnStatus.prev=i,t.paginationBtnStatus.next=o},_P6LoadHandler:function(){var t=this.gridOptions.paginationOptions;t.isFirstReq=!1
;var e=this._getReqTypeValueByKey("CONV_NO_DATA"),n=this._getReqTypeValueByKey("PAGE_STA_KEY");t.lastPAG_STA_KEY&&!t.reqDirection&&t.PAGE_STA_KEY_ARRAY.push(t.lastPAG_STA_KEY),t.lastPAG_STA_KEY=n,void 0===t.PAGE_STA_KEY&&(t.PAGE_STA_KEY=n);var i=!1,o=!1;o="Y"!=e&&""!==n,(i=t.PAGE_STA_KEY!=n)?t.prevBtn&&t.prevBtn.enable():t.prevBtn&&t.prevBtn.disable(),o?t.nextBtn&&t.nextBtn.enable():t.nextBtn&&t.nextBtn.disable(),t.paginationBtnStatus.prev=i,t.paginationBtnStatus.next=o},_CCMSLoadHandler:function(){var t=this.gridOptions.paginationOptions;t.isFirstReq=!1;var e=this._getReqTypeValueByKey("PAGE_NO"),n=this._getReqTypeValueByKey("TOT_PAGE_NUM"),i=!1,o=!1;o=e!=n&&"0"!=n,(i=1!=e)?t.prevBtn&&t.prevBtn.enable():t.prevBtn&&t.prevBtn.disable(),o?t.nextBtn&&t.nextBtn.enable():t.nextBtn&&t.nextBtn.disable(),t.paginationBtnStatus.prev=i,t.paginationBtnStatus.next=o,t.paginationDesc.html(e+"/"+n)},_onLoadSuccess:function(){this._loadHandler(),
this.conf.onLoadSuccess&&this.conf.onLoadSuccess.call(this),this.removeLoading(),this._refreshScrollBar(),this._hideScrollBar({delay:1500}),this.adjustGridStyle()},_doLoadData:function(){if(this.conf.loadFilter){var t=this.conf.loadFilter(this.gridData);t&&(this.gridData=t)}this._dataErrorHandler(),this._dataFilter(),this.renderContent(),this._onLoadSuccess()},_doAppendData:function(t,e,n){if(this.conf.loadFilter){var i=this.conf.loadFilter(t);i&&(t=i)}this._dataErrorHandler(t);var o=this._dataFilter(t||{});this.appendRows(o),this._onLoadSuccess()},resizeColumnWidth:function(t){var e=this.gridDom;e.contentScrollMaskInner.css("width",""),e.contentScrollMaskInner.css("height",""),e.contentScrollMaskOuter.css("width",""),e.contentScrollMaskOuter.css("height","");try{e.style.innerHTML=""}catch(t){e.style.styleSheet.cssText=""}this.addPrependPageStyle(),e.headerRight.css("width",""),e.bodyRight.css("width","")
;var n=this.gridOptions.gridConstant,i=e.content.innerWidth()-17,o=e.container.innerWidth()-17-n.BORDER_LR_TOTAL_WIDTH-n.GRID_SCROLL_BAR_WIDTH,a=(n.GRID_SCROLL_BAR_WIDTH,0),s=this.conf.columns[0];this.gridOptions.columnOptions.autoColumns=[];for(var r=this.gridOptions.columnOptions.autoColumns,c=0,l=0,u=0,d=s.length;u<d;u++){var h=s[u];if(1!=h.hidden){var m=this.getColumnMaxWidth(h);a+=h.currentColumnMaxWidth=m,l++,h.isUserDefWidth||h.isCheckOrRadio||(r.push(h),c++)}}var p=0,f=0;if((a=(a+=8*l-4)*parseInt($("html").css("fontSize"))/100+17)<=o){var g=o-a;p=g/c,f=g-c*(p=parseFloat(p.toFixed(3)))}else a+=1+n.GRID_SCROLL_BAR_WIDTH,e.headerRight.width(a+n.BORDER_LR_TOTAL_WIDTH+17+"px"),e.bodyRight.width(a-n.GRID_SCROLL_BAR_WIDTH+n.BORDER_LR_TOTAL_WIDTH+17+"px");a<=o?this.updatePageStyle(p,f):this.updatePageStyle(-1)},resizeRowHeight:function(){if(navigator.userAgent.toLowerCase().match(/msie ([\d.]+)/)){var t=this.gridDom;$("div.grid-row",t.bodyRight).each(function(t){var e=$(this)
;$(this).height(e.height()+"px")})}},resetGridStatus:function(t){var e=this.gridOptions,n=e.paginationOptions;n.isFirstReq=!0,n.PAGE_STA_KEY=void 0,n.PAGE_STA_KEY_ARRAY=[],n.OPM_ITI_ID=void 0,e.hasSorted=!1,e.status=1,this.gridData=null,this.gridData={total:0,rows:[]},this.gridCurrentLoadedRows=null,this.gridCurrentLoadedRows=[],this.gridAllRows=[],this.clearCheckedRowIndex(),this.gridDom.bodyRight.html(""),this.setNotificationMsg()},setNotificationMsg:function(t){var e=t?this.conf.noDataMsg:this.conf.initMsg;try{this.gridDom.bodyRight.html("")}catch(t){}this.gridDom.notificationMsg.html(e),this.gridDom.notificationMsg.show()},adjustGridStyle:function(t){var e=this.conf,n=this.gridDom;if(e.showBorder&&n.contentScrollMaskOuter.removeClass("grid-container-border").addClass("grid-container-border"),isNaN(e.width)?n.container.css("width","auto"):n.container.css("width",e.width/PJF.constants.DEFAULT_FONTSIZE+"rem"),n.container.css("height",e.height/PJF.constants.DEFAULT_FONTSIZE+"rem"),
e.gridLayoutClass&&n.container.removeClass(e.gridLayoutClass).addClass(e.gridLayoutClass),t)n.content.css("height",""),n.bodyRightContainer.css("height","");else if("auto"!=e.height){var i,o,a;a=!1===e.showHead?0:this.gridOptions.gridConstant.GRID_HEAD_HEIGHT,0,this.gridOptions.paginationOptions.pagination,o=(e.height-0)/PJF.constants.DEFAULT_FONTSIZE,i=PJF.util.deviceType.icm?(e.height-a-17/e.scaleRate)/PJF.constants.DEFAULT_FONTSIZE:(e.height-a-0)/PJF.constants.DEFAULT_FONTSIZE,n.content.height(o+"rem"),n.bodyRightContainer.height(i+"rem")}else"auto"===e.height&&(n.bodyRightContainer.css("max-height",e.maxContentAutoSizeHeight/PJF.constants.DEFAULT_FONTSIZE+"rem"),n.bodyRightContainer.css("min-height",e.minContentHeight/PJF.constants.DEFAULT_FONTSIZE+"rem"));this.resizeColumnWidth(),this.resizeRowHeight(),this.gridContentWidth=n.content.width()||this.gridContentWidth||0,this.gridContentHeight=n.content.height()||this.gridContentHeight||0,
PJF.util.deviceType.icm?n.contentScrollMaskInner.css("width",this.gridContentWidth-17+"px"):n.contentScrollMaskInner.css("width",this.gridContentWidth+"px"),n.contentScrollMaskInner.css("height",this.gridContentHeight+"px"),n.contentScrollMaskOuter.css("width",this.gridContentWidth-e.horizontalScrollBarHeight+"px")},resize:function(){arguments.length?alert("resize 暂时不支持任何参数！未免引起bug 请勿使用任何参数！"):this.adjustGridStyle()},regEventHandler:function(){var o=this.gridDom,a=this.gridOptions,s=a.paginationOptions,r=this.conf,c=this;r.url&&s.isAppendMode&&o.bodyRightContainer.scroll(function(t){if(!t.isTrigger&&!(o.bodyRightContainer.height()+o.bodyRightContainer.scrollTop()<o.bodyRight.height())){if(s.reqType)return c.specialPageChangeHandler(!1),void t.stopPropagation();var e=Math.ceil(s.totalPageNumber/s.pageSize);s.currentPageNumber>=e||c.pageChangeHandler(s.currentPageNumber+1)}}),o.bodyRight.unbind().bind("click",function(t){
var e=$(t.target),n=e.hasClass("grid-ck"),i=e.closest("div.grid-row");if(i.length){var o=i.attr("rowindex"),a=e.attr("field");!1!==r.isCheckOnClickRow||n?(!1===r.isClickRowOnCheck&&n||c._onClickRow(o,a),i.hasClass("grid-row-checked")?c.unCheckRow(o,i):c.checkRow(o,i),t.stopPropagation()):c._onClickRow(o,a)}}).bind("dblclick",function(t){var e=$(t.target),n=e.closest("div.grid-row");if(n.length){var i=n.attr("rowindex"),o=e.attr("field");c._onDblClickRow(i,o),t.stopPropagation()}}),o.headerRight.unbind().bind("click",function(t){var e=$(t.target).closest("div.grid-cell");if(e.length){if(!1===c.conf.singleSelect){var n=$("div.grid-checkbox",e);1==n.length&&(n.hasClass("grid-checkbox-checked")?c.unCheckAllRow():c.checkAllRow())}t.stopPropagation()}}),o.bodyRightContainer.scrollLeft(1),o.bodyRightContainer.scrollLeft(0),o.bodyRightContainer.scrollTop(0),o.bodyRightContainer.scrollTop(1),o.bodyRightContainer.scrollTop(0),o.bodyRightContainer.bind("scroll",function(t){
o.headerRightContainer.scrollLeft($(this).scrollLeft()),function(t){c._refreshScrollBar();var e=t.scrollHeight,n=t.clientHeight,i=t.scrollTop;if(i<=a.lastScrollTop)return a.lastScrollTop=i;if(a.lastScrollTop=i,!r.scrollToRefresh)return;if(!r.url||a.isRequesting)return;if(s.currentPageNumber>=s.totalPageNumber)return;if(!s.paginationBtnStatus.next)return;if(a.lastScrollTop=i,n+i+5<e)return;c._showScrollBar(),a.isRequesting=!0,c.showLoading(),o.paginationNext.trigger("click")}(this)}),o.bodyRightContainer.bind("mousedown",function(){c._showScrollBar()}),o.bodyRightContainer.bind("mouseup",function(){})},addPaginationBar:function(t,e,n){var i=this.gridOptions.paginationOptions;if(!1!==i.pagination){var o,a,s=this.gridDom;if(t&&i.prevBtn===t)alert("重复绑定上一页按钮");else if(e&&i.nextBtn===e)alert("重复绑定下一页按钮");else t&&(t.bindClickHandler((o=t.p.originHandler,function(){o&&o.call(t),s.paginationPrev&&s.paginationPrev.trigger("click")})),i.prevBtn=t),e&&(e.bindClickHandler((a=e.p.originHandler,
function(){a&&a.call(e),s.paginationNext&&s.paginationNext.trigger("click")})),i.nextBtn=e),n&&(i.paginationDesc=$("#"+n))}else alert("error...当前grid pagination为false 不分页！")},_refreshScrollBar:function(){var t=this.gridDom.bodyRightContainer.get(0),e=t.scrollHeight,n=t.clientHeight,i=t.scrollTop,o=t.scrollWidth,a=t.clientWidth,s=t.scrollLeft,r=this.gridDom.contentScrollBarV,c=this.gridDom.contentScrollBarH,l=n/e*n,u=a/o*a,d=e-n,h=o-a,m=i/d,p=s/h,f=this.gridOptions.gridConstant.GRID_HEAD_HEIGHT*this.conf.scaleRate+m*(n-l),g=p*(a-u),P=PJF.util.deviceType.icm;r.css({height:l+"px",top:f+"px",visibility:0==d||P?"hidden":"visible"}),c.css({width:u+"px",left:g+"px",visibility:0==h||P?"hidden":"visible"}),this._hideScrollBar({delay:1500})},_showScrollBar:function(t){t=t||{},clearTimeout(this.gridOptions.hideScrollBarTimeout),this.gridDom.contentScrollBarH.fadeIn(t.time||500),this.gridDom.contentScrollBarV.fadeIn(t.time||500)},_hideScrollBar:function(t){},_getRowCountInBody:function(){
var t=this.gridDom.bodyRightContainer;return $("div.grid-row",t).length},checkRow:function(t,e){var n=this._getRowCountInBody()-1;if(void 0===t&&void 0===e||n<t)return alert("Error: rowIndex rowDom 不能全为空或超出索引域！"),!1;if(e||(e=this.getRowDom(t)),void 0===t&&(t=e.attr("rowindex")),t=parseInt(t,10),!1!==this._onBeforeCheckRow(t)){var i=this.gridOptions.checkOptions;if(this.conf.singleSelect&&(i.lastCheckedRowDom&&this.unCheckRow(i.lastCheckedRowDom.attr("rowindex")),this.clearCheckedRowIndex()),e.removeClass("grid-row-checked").addClass("grid-row-checked"),this.gridOptions.hasCheckOrRadio){var o="grid-"+(this.conf.singleSelect?"radio":"checkbox")+"-checked";$("div.grid-ck",e).removeClass(o).addClass(o)}i.lastCheckedRowDom=e,this.addCheckedRowIndex(t),this._updateCheckAllStatus(),this._onCheckRow(t)}},checkAllRow:function(){this.clearCheckedRowIndex();var e=this;this.gridDom;if(this.getRowDom().removeClass("grid-row-checked").addClass("grid-row-checked"),this.gridOptions.hasCheckOrRadio){
var t=this.conf.singleSelect?"radio":"checkbox",n="grid-"+t+"-checked";$.each(this.getColumnDom(t,null,!1),function(t){$("div.grid-ck",this).removeClass(n).addClass(n),e.addCheckedRowIndex(t)})}else for(var i=this.gridAllRows.length,o=0;o<i;o++)this.addCheckedRowIndex(o);this._updateCheckAllStatus(),this._onCheckAll()},unCheckRow:function(t,e){var n=this._getRowCountInBody()-1;if(void 0===t&&void 0===e||n<t)return alert("Error: rowIndex rowDom 不能全为空或超出索引域！"),!1;if(e||(e=this.getRowDom(t)),void 0===t&&(t=e.attr("rowindex")),t=parseInt(t,10),!1===this._onBeforeUnCheckRow(t))return!1;if(e.removeClass("grid-row-checked"),this.gridOptions.hasCheckOrRadio){var i="grid-"+(this.conf.singleSelect?"radio":"checkbox")+"-checked";$("div.grid-ck",e).removeClass(i)}this.removeCheckedRowIndex(t),!1!==this.conf.singleSelect&&(this.gridOptions.checkOptions.lastCheckedRowDom=null),this._updateCheckAllStatus(),this._onUnCheckRow(t)},unCheckAllRow:function(){this.gridDom
;if(this.getRowDom().removeClass("grid-row-checked"),this.gridOptions.hasCheckOrRadio){var t=this.conf.singleSelect?"radio":"checkbox",e="grid-"+t+"-checked";$.each(this.getColumnDom(t,null,!1),function(){$("div.grid-ck",this).removeClass(e)})}this.clearCheckedRowIndex(),this._updateCheckAllStatus(),this._onUnCheckAll()},_updateCheckAllStatus:function(){if(this.gridOptions.hasCheckOrRadio&&!this.conf.singleSelect){var t=this.getCurrentPageCheckedRowIndexs().length,e=this._getRowCountInBody(),n=this.gridDom.headerRight;t===e&&0!=t?$("div.grid-checkbox",n).removeClass("grid-checkbox-checked").addClass("grid-checkbox-checked"):$("div.grid-checkbox",n).removeClass("grid-checkbox-checked")}},getSelectedRow:function(t){if(!this.conf.singleSelect)return alert("Error: 当前状态为多选，请使用 getSelectedRows 方法！"),null;var e=this.gridOptions.checkOptions.checkedRowIndexMap,n=null;if(!this.gridOptions.paginationOptions.isAppendMode&&this.conf.url)(n=this.gridCurrentLoadedRows[e.keys[0]])||(n=null);else{
var i=t?this.getAllPageCheckedRows():this.getCurrentPageCheckedRows();n=0<i.length?i[0]:null}return n},getSelectedRows:function(t){var e=[];if(this.conf.singleSelect)return alert("Error: 当前状态为单选，请使用 getSelectedRow 方法！"),e;var n=this.gridOptions.checkOptions.checkedRowIndexMap.keys;if(!this.gridOptions.paginationOptions.isAppendMode&&this.conf.url)for(var i=0,o=n.length;i<o;i++)e.push(this.gridCurrentLoadedRows[n[i]]);else e=t?this.getAllPageCheckedRows():this.getCurrentPageCheckedRows();return e},getRowData:function(t,e){if(e||this.gridOptions.paginationOptions.isLocalPagination){if(t=this.getAbsoluteRowIndex(t),this.gridOptions.paginationOptions.isLocalPagination){var n=this.gridAllRows;return(i=n.length)<=t?(alert("Error: getRowData方法，当前总计 "+i+" 条数据 , rowIndex("+t+") 越界！"),null):n[t]}return alert("Error: 分本地分页模式，无法获取其他页数据！"),null}var i,o=this.gridAllRows;return(i=o.length)<=t?(alert("Error: getRowData方法，当前总计 "+i+" 条数据 , rowIndex("+t+") 越界！"),null):o[t]},getGridData:function(){
return this.gridData},getAllRows:function(){return this.gridAllRows},getCurrentLoadedRows:function(){return this.getAllRows()},_displayColumns:function(t,e){e=!!e;for(var n="grid-hidden-cell",i=0,o=t.length;i<o;i++){var a=this.getColumnDom(t[i],null,!0,!1);$.each(a,function(){e?this.removeClass(n):this.removeClass(n).addClass(n)});var s=this.getColumn(t[i]);s&&(s.hidden=!e)}this.adjustGridStyle()},appendRow:function(t,e){var n=this.gridAllRows.length;e=!!e,this.insertRows([n],[t],[e])},appendRows:function(t,e){if(!(t instanceof Array))return alert("Error: appendRows 参数 必须为数组！"),!1;var n=t.length,i=-1;if(null!=e){if(!(e instanceof Array))return alert("Error: appendRows 参数 必须为数组！"),!1;if(n!=(i=e.length))return alert("Error: appendRows 数组参数长度必须一致！"),!1}else e=[];for(var o=[],a=this.gridAllRows.length,s=0;s<n;s++)o.push(a+s),-1==i&&e.push(!1);this.insertRows(o,t,e)},insertRow:function(t,e,n){n=!!n,this.insertRows([t],[e],[n])},insertRows:function(t,e,n){
if(!(t instanceof Array&&t instanceof Array))return alert("Error: insertRows 方法参数必须为数组!"),!1;var i=t.length,o=e.length,a=-1;if(null!=n){if(!(t instanceof Array))return alert("Error: insertRows 方法 参数必须全为数组！"),!1;if(a=n.length,i!=o||o!=a)return alert("Error: insertRows 方法 数据参数必须长度一致！"),!1}else if(i!=o)return alert("Error: insertRows 方法 数据参数必须长度一致！"),!1;if(!(i<1)){this.gridDom.notificationMsg.hide();for(var s=!1,r=this.conf.columns[0],c=this.gridDom.bodyRight,l=this.gridOptions.checkOptions,u=l.checkedRowIndexMap,d=l.allPageCheckedRowIndexMap,h=this.gridAllRows,m=0;m<i;m++){-1!=a&&(s=n[m]);var p=this.rowRender(t[m],e[m],r,!!s),f=this.getRowDom(t[m]);if(0==f.length?0==h.length?c.html(p):c.append(p):($(p).insertBefore(f),this.adjustCheckedRowIndexMaps(t[m],!0),this.refreshRowIndex()),this.adjustRows(!0,t[m],e[m]),s){u.add(t[m]+"",e[m]);var g=this.getAbsoluteRowIndex(t[m]);d.add(g+"",e[m]),l.lastCheckedRowDom=this.getRowDom(t[m])}}this._updateCheckAllStatus(),this.adjustGridStyle(),
l.isAddOrRemoveData=!0}},refreshRowIndex:function(){this.getRowDom().each(function(t){$(this).attr("rowindex")!=t&&($(this).attr("rowindex",t),$(".body-cell-text[field=GRID-ROWNUMBER]",$(this)).html(t+1)),$(this).removeClass("grid-row-odd"),t%2==0&&$(this).addClass("grid-row-odd")})},deleteRow:function(t){return null==t?(alert("Error: deleteRows 方法参数不能为空！"),!1):this.deleteRows([t])},deleteRows:function(t){var e=this;if(!t)return alert("Error: deleteRows 方法参数不能为空！"),!1;var n=!1;if(this.gridOptions.checkOptions.lastCheckedRowDom){var i=this.gridOptions.checkOptions.lastCheckedRowDom.attr("rowindex");t.forEach(function(t){i==t&&(e.gridOptions.checkOptions.lastCheckedRowDom=null)})}t.sort();for(var o=[],a=0,s=t.length;a<s;a++){var r=t[a],c=this.getRowDom(r);c.length&&(n=!0,c.remove(),this.adjustCheckedRowIndexMaps(r-a,!1),o.push(r))}if(!1===n)return!1;for(a=0,s=o.length;a<s;a++)this.adjustRows(!1,o[a]-a);return this.gridOptions.checkOptions.isAddOrRemoveData=!0,this.refreshRowIndex(),
this._updateCheckAllStatus(),this.adjustGridStyle(),!0},_onClickRow:function(t,e){this.conf.onClickRow&&this.conf.onClickRow(t,e,this.getRowData(t))},_onDblClickRow:function(t,e){this.conf.onDblClickRow&&this.conf.onDblClickRow(t,e,this.getRowData(t))},_onBeforeCheckRow:function(t){var e=!0;return this.conf.onBeforeCheckRow&&(e=this.conf.onBeforeCheckRow(t,this.getRowData(t))),e},_onBeforeUnCheckRow:function(t){var e=!0;return this.conf.onBeforeUnCheckRow&&(e=this.conf.onBeforeUnCheckRow(t,this.getRowData(t))),e},_onCheckRow:function(t){this.conf.onCheckRow&&this.conf.onCheckRow(t,this.getRowData(t))},_onUnCheckRow:function(t){this.conf.onUnCheckRow&&this.conf.onUnCheckRow(t,this.getRowData(t))},_onCheckAll:function(){this.conf.onCheckAll&&this.conf.onCheckAll()},_onUnCheckAll:function(){this.conf.onUnCheckAll&&this.conf.onUnCheckAll()},_rowStyler:function(t,e){var n="";return this.conf.rowStyler&&(n=this.conf.rowStyler(t,e)),n=n||""},getBrowserVersion:function(){var t="",e=""
;if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){t="firefox";var n=new Number(RegExp.$1);e=Math.floor(n)}if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){t="ie";var i=new Number(RegExp.$1);e=Math.floor(i)}if(/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)){t="opera";var o=new Number(RegExp.$1);e=Math.floor(o)}return-1<navigator.userAgent.toLowerCase().indexOf("chrome")&&-1!=navigator.userAgent.toLowerCase().indexOf("safari")&&(t="chrome",e=""),-1==navigator.userAgent.toLowerCase().indexOf("chrome")&&-1!=navigator.userAgent.toLowerCase().indexOf("safari")&&(t="safari",e=""),{browserName:t,browserVersion:e}},getSrollBarWidth:function(){return 17},getAbsoluteRowIndex:function(t,e){if(!1===e)return t;t=parseInt(t,10);var n=this.gridOptions.paginationOptions;n.isLocalPagination&&(t=(n.currentPageNumber-1)*n.pageSize+t);return t},addCheckedRowIndex:function(t,e){t=""+t;var n=this.gridOptions.checkOptions;if(n.checkedRowIndexMap.add(t,this.getRowData(t)),!1!==e){
var i=this.getAbsoluteRowIndex(t);n.allPageCheckedRowIndexMap.add(i+"",this.getRowData(t))}},removeCheckedRowIndex:function(t,e){t=""+t;var n=this.gridOptions.checkOptions;if(n.checkedRowIndexMap.removeKey(t),!1!==e){var i=this.getAbsoluteRowIndex(t);n.allPageCheckedRowIndexMap.removeKey(i+"")}},clearCheckedRowIndex:function(t){var e=this.gridOptions.checkOptions;e.checkedRowIndexMap.clear(),e.lastCheckedRowDom=null,(e.isAddOrRemoveData=!1)!==t&&e.allPageCheckedRowIndexMap.clear()},clearCurrentCheckedRowIndex:function(){this.clearCheckedRowIndex(!1);for(var t=this.gridOptions.checkOptions,e=this.gridOptions.paginationOptions,n=e.currentPageNumber,i=e.pageSize,o=n*i,a=(n-1)*i;a<o;a++)t.allPageCheckedRowIndexMap.removeKey(a+"")},getAllPageCheckedRowIndexs:function(){return this.gridOptions.checkOptions.allPageCheckedRowIndexMap.keys},getAllPageCheckedRows:function(){return this.gridOptions.checkOptions.allPageCheckedRowIndexMap.items},getCurrentPageCheckedRowIndexs:function(){
return this.gridOptions.checkOptions.checkedRowIndexMap.keys},getCurrentPageCheckedRows:function(){return this.gridOptions.checkOptions.checkedRowIndexMap.items},_updateRowIndexMaps:function(t,e,n){var i=e.items,o=e.keys,a=-1;e.clear();for(var s=0,r=o.length;s<r;s++)((a=parseInt(o[s],10))!=t||n)&&(t<=a&&(a+=n?1:-1),0<=a&&e.add(a+"",i[s]))},adjustCheckedRowIndexMaps:function(t,e){var n=this.gridOptions.checkOptions,i=n.checkedRowIndexMap,o=n.allPageCheckedRowIndexMap,a=this.getAbsoluteRowIndex(t);this._updateRowIndexMaps(t,i,e),this._updateRowIndexMaps(a,o,e)},adjustRows:function(t,e,n){var i=this.gridAllRows,o=this.gridOptions.paginationOptions,a=this.getAbsoluteRowIndex(e,!!o.isLocalPagination);t?(i.splice(a,0,n),this.gridData.total+=1):(i.splice(a,1),this.gridData.total-=1)},isCheckOrRadio:function(t){return("checkbox"==t.field||"radio"==t.field)&&(this.conf.singleSelect?t.field="radio":t.field="checkbox",t.isCheckbox=!("checkbox"!=t.field),t.isCheckOrRadio=!0,t.field)},
getPaginationOptions:function(){return this.gridOptions.paginationOptions},getColumnMaxWidth:function(t){if(!0===t.hidden)return 0;if(this.isCheckOrRadio(t))return this.gridOptions.gridConstant.ckColumnWidth;if(t.width&&"auto"!==t.width)return t.width;var e=this.getColumnDom(t.field,null,!0),n=t.title.length*this.gridOptions.gridConstant.GRID_COLUMN_WIDTH_SIZE;return e.length?$.each(e,function(t){var e=$(this).width()/1;n<e&&(n=e)}):alert("Error: 未查找到指定列("+t.field+") dom"),n+8},getColumnDom:function(t,e,n,i){var o=this.gridOptions.gridColumnClassPrefix+t,a=this.gridDom,s=[];return n&&s.push($("div."+o,a.headerRight)),i||$("div."+o,a.bodyRight).each(function(){s.push($(this))}),null!=e?(e=parseInt(e,10),n&&(e+=1),[s[e]]):s},getColumn:function(t){if(!t)return alert("Error: getColumn 参数 field 参数不能为空"),null;for(var e=this.conf.columns[0],n=0,i=e.length;n<i;n++){var o=e[n];if(o.field===t)return o}return!1},getRowDom:function(t){var e=this.gridDom
;return null!=t?$("div.grid-row[rowindex="+t+"]",e.bodyRight):$("div.grid-row",e.bodyRight)},validateParam:function(t){if(!document.getElementById(t.dom))return alert("Error: dom 属性不能为空且指定dom节点必须存在！"),!1;if(!(t.columns&&1===t.columns.length&&t.columns[0]instanceof Array))return alert("Error: columns 参数必须为二维数组!"),!1;for(var e={},n="",i=0,o=t.columns[0].length;i<o;i++){if(!(n=t.columns[0][i].field))return alert("Error: 第 "+(i+1)+" 列的field属性不能为空或者空字符串或者0！"),!1;if("checkbox"==n&&!1!==t.singleSelect)return alert("Error: 单选状态下，不能存在field为checkbox的列，请使用radio！"),!1;if("radio"==n&&!1===t.singleSelect)return alert("Error: 多选状态下，不能存在field为radio的列，请使用checkbox！"),!1;if(e[n])return alert("Error: 列的field属性不能重复！重复字段名:["+n+"]！"),!1;e[n]=1}return!0},destroy:function(){this.com.remove(),PJF.ui.componentMgr.remove(this.id)},getClassName:function(){return"PJF.ui.grid"}}),PJF.apply(PJF.ui.grid.prototype,{loadData:function(t){this.clearData(!1),$.isPlainObject(t)&&(t=[].concat(t)),this.gridData=t,
this._loadData()},clearData:function(t){this.resetGridStatus(),this.resetPagination(),!1!==t&&this.adjustGridStyle(!0)},sendReq:function(){this.conf.url?(this.clearData(),this._loadData()):alert("Error: 无请求地址 , url　属性为空！")},refresh:function(){var t=this.gridOptions.paginationOptions;this.conf.url?t.isAppendMode&&this.clearData():t.isLocalPagination?this.clearCurrentCheckedRowIndex():this.clearCheckedRowIndex(),this._loadData()},bindEventAction:function(t,e){},hideColumn:function(t){return t?this.hideColumns([t]):(alert("Error: field 参数不能为空！"),!1)},showColumn:function(t){return t?this.showColumns([t]):(alert("Error: field 参数不能为空！"),!1)},hideColumns:function(t){return t instanceof Array?(this._displayColumns(t,!1),!0):(alert("Error: hideColumns 参数必须是数组"),!1)},showColumns:function(t){return t instanceof Array?(this._displayColumns(t,!0),!0):(alert("Error: hideColumns 参数必须是数组"),!1)},show:function(t){this.com.css("display",""),!0===t.resize&&this.resize()},hide:function(){
this.com.css("display","none")}}),PJF.ui.tip=PJF.extend(PJF.ui.component,{init:function(t){this.options={width:450,tipMessage:""},$.extend(this.options,t),this.initHtml(),this.com.find(".stm_tip_text").css({width:this.options.width/PJF.constants.DEFAULT_FONTSIZE+"rem"})},initHtml:function(){var t='<div class="stm_tip_container"><span class="stm_tip_arrow"></span><span class="stm_tip_text">'+this.options.tipMessage+"</span><div>";this.com.append(t)}}),PJF.apply(PJF.ui.tip.prototype,{getClassName:function(){return"PJF.ui.tip"},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null}}),PJF.ui.info=PJF.extend(PJF.ui.component,{init:function(t){this.conf=$.extend({width:600},t),this.com.append('<ul class="pjf_stm_info"></ul>'),this.cntr=this.com.find("ul"),this.com.width(this.conf.width),this.setData(this.conf.data)},setData:function(t){this.cntr.html(""),this.addData(t)},addData:function(t){for(var e in t){
var n=$('<li class="pjf_stm_info_list"><span>'+t[e].name+"：</span><span>"+t[e].desc+"</span></li>").data("key",t[e].key);this.cntr.append(n)}},editList:function(e){var t=this.com.find("li");for(var n in e)t.each(function(){var t=$(this);t.data("key")==e[n].key&&t.html("<span>"+e[n].name+"：</span><span>"+e[n].desc+"</span>").data("key",e[n].key)})},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null}}),PJF.ui.table=PJF.extend(PJF.ui.component,{init:function(t){this.options={columnWidths:["25%","65%","8%"]},$.extend(this.options,t);var e=this.initHtml();this.com.append(e),this.tablecontainer=$("div.table-container",this.com),this.loadData(this.options.data),this.bindEvent()},bindEvent:function(){var o=this,a=o.options.data;o.com.find(".list-item-table").each(function(e){var n=$(this).find(".item-operation").children().text(),i=$(this);""!=n&&i.find(".item-operation").bind("click",function(){console.log("index:",e);var t=i.attr("dataindex")
;t==e&&(console.log(n),o.options.onclick.call(o,a[t]))})})},initHtml:function(){this.options.data;var t=[];return t.push('<div class="table-container">'),t.push("</div>"),t.join("")}}),PJF.apply(PJF.ui.table.prototype,{getClassName:function(){return"PJF.ui.table"},loadData:function(t){if(null!=t&&null!=t){var e=[],n=this.options.columnWidths;for(var i in t)e.push('<div  dataindex="'+i+'" class="list-item-table"><div class="item-key"  style="width:'+n[0]+'">'+t[i].key+':</div><div class="item-value" style="width:'+n[1]+'">'+t[i].value+'</div><div class="item-operation" style="width:'+n[2]+'"><span style="color:red">'+t[i].operation+"</span></div></div>");this.tablecontainer.append(e.join(""))}}}),PJF.ui.fingerReader=PJF.extend(PJF.ui.component,{init:function(conf){var $this=this;this.params={width:200,height:80,winWidth:800,winHeight:500,okBtn:null,cancelBtn:null,success:function(t){},failure:function(t){},
Auth_Post:"G00000000001,G00000000002,G00000000003,G00000000004,G00000000005,G00000000006,G00000000007,G00000000008",infoMsg:resource.FINGERREADER_INFO_MSG,timeout:20,parentDom:window.template&&template.newpage,windowRetainDom:!0},this.constants={USERNAME_PWD_NOT_INLEGE:"用户名或密码不合法！",USERNAME_PWD_NOT_NULL:"用户名和密码不能为空！",USERNAME_PWD_NOT_CORRECT:"用户名和密码不正确！",NETWORK_ERR:"网络通信错误，请稍后再试！"},this.loginBaseData={addrtype:"",channelType:"12999990",orglevel:"",outBean:null,loginMode:"11",strServId:"",fingerInfo:"",postId:"",magId:"",updateVersion:"1.0",singleloginmode:"0",serviceId:"commonLoginCheckService",update_file_list:null,branchId:"",ccbsId:"",terminalParam:{logicTerminalNo:"350896600ECP003",terminalStat:""},adapterId:"ecpJson2Bean",clientVersion:"1.0",roleId:""},"DF001"==PJF.orgInfo.instSvrlLgPsnID&&(this.params.Auth_Post="G000ZD000001,G000ZD000002,G000ZD000003,G000ZD000004,G000ZD000005,G000ZD000006,G000ZD000007,G000ZD000008,GX09Z0000004"),$.extend(this.params,conf),
$this.params.successHandler=function(data){if($this.params.checkSamePer){var checkPerId;if(PJF.util.isExist("PJF.stm.idenAuth.custInfo"))checkPerId=PJF.stm.idenAuth.custInfo.identity;else{if(!PJF.util.isExist("PJF.stm.CUSTOM_INFO")||"1010"!=PJF.stm.CUSTOM_INFO.Crdt_TpCd)return void $this.params.success(data);checkPerId=PJF.stm.CUSTOM_INFO.Crdt_No}function isSamePer(t,e,n){var i={CCB_EMPID:t,Crdt_TpCd:"1010",Crdt_No:e,_pagination:{REC_IN_PAGE:10,PAGE_JUMP:1}};console.log("检测是否同一人请求参数为"+JSON.stringify(i)),PJF.communication.cpsJsonReq({jsonData:JSON.stringify(i),fwServiceId:"simpleTransaction",fwTranId:"A0861e030-stm",success:function(t){console.log("检测是否同一人成功，返回结果为"+JSON.stringify(t.EMPE_VDO)),t.EMPE_VDO&&t.EMPE_VDO[0]?$this.params.failure("授权不成功，无法对自办业务授权"):n&&n()},failure:function(t){console.log("检测是否同一人失败，返回结果为"+JSON.stringify(t)),$this.params.failure("检测授权人员和客户是否同一人交易失败")}})}var info=eval("("+data.AUTH_INFO+")");isSamePer(info.empeid,checkPerId,function(){
conf.checkMasId?(console.log("存在checkMasId，进行户主与授权人是否为同一人检查"),isSamePer(info.empeid,conf.checkMasId,function(){$this.params.success(data)})):$this.params.success(data)})}else $this.params.success(data)},console.log("******************1.before*******************"),console.log("******************PJF.constants.IS_DEBUG*******************"+PJF.constants.IS_DEBUG),PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME||$this.params.padFlag||"DA003"==PJF.orgInfo.instSvrlLgPsnID?(console.log("******************2.ICM*******************"),console.log("是否为特殊PAD业务："+$this.params.padFlag),console.log("建亚："+("DA003"==PJF.orgInfo.instSvrlLgPsnID)),$this.initUiICM($this.params)):(console.log("******************3.NOT ICM*******************"),$this.params.dom?($this.initUi($this.params),setTimeout(function(){try{if(PJF.constants.IS_DEBUG)return void conf.success(PJF.debug.constants.FINGER);var t={timeout:$this.params.timeout};PJF.stm.Finger.readFinger(t,function(){
$this.readFingerCallBack.apply($this,arguments)})}catch(t){alert("读取指纹失败")}},0)):setTimeout(function(){try{if(PJF.constants.IS_DEBUG)return void conf.success(PJF.debug.constants.FINGER);var t={timeout:$this.params.timeout};PJF.stm.Finger.readFinger(t,function(){$this.readFingerCallBack2.apply($this,arguments)})}catch(t){alert("读取指纹失败")}},0))},readFingerCallBack:function(t){var i=this;if(console.log("读取指纹回调result:"+JSON.stringify(t)),t.status){var e=t.info.pchFeature,n={Auth_Type:"2",Auth_PW:e};PJF.apply(n,{OPER_CODE:PJF.userInfo&&PJF.userInfo.userCode?PJF.userInfo.userCode:"",Auth_Org:PJF.roleInfo&&PJF.roleInfo.orgCode?PJF.roleInfo.orgCode:"",Auth_Post:this.params.Auth_Post,Illegal_Post:PJF.otherInfo&&PJF.otherInfo.auditPos&&PJF.otherInfo.MENU_ID?PJF.otherInfo.auditPos[PJF.otherInfo.MENU_ID]:"",Uaap_Ip:PJF.otherInfo&&PJF.otherInfo.IPS?PJF.otherInfo.IPS[0]:"127.0.0.1"}),console.log("指纹验证请求参数:"+JSON.stringify(n)),PJF.communication.ajax({url:"/bosWeb/ecpJson.action",async:!1,data:{
_fw_service_id:"doStmAuthCheck",jsonData:PJF.util.json2str(n)},success:function(t){"00"==t.TX_STATUS&&"0000000000"==t.RSP_CODE?(i.params.dom&&(i.clearMessage(),i.pop.destroy(),i.com.find("#pjf_stm_fr").remove()),t.fingerInfo=e,t.AUTH_INFO=t.AUTH_INFO.replace(/\\/g,""),console.log("fingerReader 为AUTH_INFO去掉/后的数据为:"+t.AUTH_INFO),i.params.successHandler(t),console.log("指纹验证成功")):(console.log("指纹验证失败data:"+JSON.stringify(t)),i.params.dom?(i.setMessage("指纹验证失败"),i.btn2.enable()):i.params.failure("指纹验证失败:"+t.ERROR_MSG))},failure:function(t,e,n){console.log("指纹验证失败ts:"+JSON.stringify(e)),i.params.dom?(i.setMessage("指纹验证失败"),i.btn2.enable()):i.params.failure("指纹验证失败:"+e)}})}else console.log("指纹读取失败"),i.params.dom?(i.setMessage("指纹读取失败"),i.btn2.enable()):i.params.failure("指纹读取失败:"+t.errorMsg)},readFingerCallBack2:function(t){var i=this;if(console.log("读取指纹回调result:"+JSON.stringify(t)),t.status){var e=t.info.pchFeature,n={Auth_Type:"2",Auth_PW:e};PJF.apply(n,{
OPER_CODE:PJF.userInfo&&PJF.userInfo.userCode?PJF.userInfo.userCode:"",Auth_Org:PJF.roleInfo&&PJF.roleInfo.orgCode?PJF.roleInfo.orgCode:"",Auth_Post:this.params.Auth_Post,Illegal_Post:PJF.otherInfo&&PJF.otherInfo.auditPos&&PJF.otherInfo.MENU_ID?PJF.otherInfo.auditPos[PJF.otherInfo.MENU_ID]:"",Uaap_Ip:PJF.otherInfo&&PJF.otherInfo.IPS?PJF.otherInfo.IPS[0]:"127.0.0.1"}),console.log("指纹验证请求参数:"+JSON.stringify(n)),PJF.communication.ajax({url:"/bosWeb/ecpJson.action",async:!1,data:{_fw_service_id:"doStmAuthCheck",jsonData:PJF.util.json2str(n)},success:function(t){i.fingerReaderBtn&&i.fingerReaderBtn.enable(),"00"==t.TX_STATUS&&"0000000000"==t.RSP_CODE?(i.destroyLoginWin(),t.fingerInfo=e,t.AUTH_INFO=t.AUTH_INFO.replace(/\\/g,""),console.log("fingerReader 为AUTH_INFO去掉/后的数据为:"+t.AUTH_INFO),i.params.successHandler(t),console.log("指纹验证成功")):(console.log("指纹验证失败data:"+JSON.stringify(t)),i.params.failure("指纹验证失败:"+t.ERROR_MSG),
PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME&&i.setErrorTip("指纹验证失败:"+t.ERROR_MSG,"fr_fingerErrMsg"))},failure:function(t,e,n){console.log("指纹验证失败ts:"+JSON.stringify(e)),i.fingerReaderBtn&&i.fingerReaderBtn.enable(),i.params.failure("指纹验证失败:"+e),PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME&&i.setErrorTip("指纹验证失败:"+e,"fr_fingerErrMsg")}})}else console.log("指纹读取失败"),i.fingerReaderBtn&&i.fingerReaderBtn.enable(),i.params.failure("指纹读取失败:"+t.errorMsg),PJF.otherInfo.typeInfo==PJF.constants.ICM_NAME&&i.setErrorTip("指纹读取失败:"+t.errorMsg,"fr_fingerErrMsg")},destroyLoginWin:function(){this.pop&&this.pop.destroy(),$("body").find(".fr_login_mask").remove(),$("#"+this.windowId).remove()},initUiICM:function(t){var e=this;this.prepareLoginData(),$("body").find(".fr_login_mask").remove(),$("body").append("<div class='fr_login_mask'></div>");e.windowId=PJF.util.generateUUid(),e.params.parentDom.append("<div id ='"+e.windowId+"' style='z-index:9999;';></div>"),e.pop=new PJF.ui.window({
dom:e.windowId,content:'<div class="fr_login-page-container">\x3c!-- 登录界面title --\x3e<p class="fr_login-form-title">用户登录</p>\x3c!-- 登录界面Tab --\x3e<div id="fr_loginFormTab"></div>\x3c!-- 指纹登录 --\x3e<div id="fr_fingerLogin" style="display:none;"><p class="fr_error-msg" id="fr_fingerErrMsg"></p><form class="fr_login-form" id="fr_fingerLoginForm"></form><div class="fr_login-form-btns2"><a id="fr_fingerReaderBtnDom"></a><a id="fr_fingerCancelBtnDom"></a></div></div>\x3c!-- 用户编号or 用户名 --\x3e<div id="fr_usernameLogin" style="display:none;"><p class="fr_error-msg" id="fr_userErrMsg"></p><form class="fr_login-form" id="fr_usernameLoginForm"><ul><li ><label class="fr_pjf_stm_login_label">用户编号/用户名:</label><input type="text" id="fr_usernameDom"></li><li ><label class="fr_pjf_stm_login_label">密码:</label><input type="password" id="fr_passwordDom"></li></ul></form><div class="fr_login-form-btns"><a id="fr_cancelBtnDom"></a><a id="fr_loginBtnDom"></a></div></div></div>',width:700,height:500,
retainDom:e.params.windowRetainDom});new PJF.ui.tab({dom:"fr_loginFormTab",titles:["指纹","密码"],backgroundColors:["rgb(20,130,201)","rgb(20,130,201)"],iconUrl:["stm/update.png","stm/insert.png"],htmlDomIds:["fr_fingerLogin","fr_usernameLogin"],height:"600px",width:"800px",domLoadedCallBack:function(){e.initFingerForm(),e.initUserNameForm()}});$("#"+e.windowId).css({"z-index":"99999"}),$("#"+e.windowId+">.stmwindow-body").css({height:"100%"})},prepareLoginData:function(){var e=this.loginBaseData;try{var t=PJF.communication.GetIp();t.success?e.clientIp=t.result:e.clientIp="192.168.1.1"}catch(t){e.clientIp="192.168.1.1"}try{var n=PJF.communication.GetMac();n.success?e.terminalParam.terminalMACAddr=n.result:e.terminalParam.terminalMACAddr="11-11-11-11-11-11"}catch(t){e.terminalParam.terminalMACAddr="11-11-11-11-11-11"}e.orgCode=PJF.roleInfo.orgCode||"350635037",e.terminalParam.channelType="20170029"},initFingerForm:function(){var e=this;e.fingerReaderBtn=new PJF.ui.linkButton({
dom:"fr_fingerReaderBtnDom",style:"main",bgColor:"rgb(190,94,165)",name:"读取指纹",onClick:function(){e.setErrorTip("","fr_fingerErrMsg"),e.fingerReaderBtn.disable(),setTimeout(function(){try{if(PJF.constants.IS_DEBUG)return void conf.success(PJF.debug.constants.FINGER);var t={timeout:e.params.timeout};PJF.stm.Finger.readFinger(t,function(){e.readFingerCallBack2.apply(e,arguments)})}catch(t){alert("读取指纹失败")}},0)}}),this.fingerReaderCancelBtn=new PJF.ui.linkButton({dom:"fr_fingerCancelBtnDom",style:"main",bgColor:"rgb(20,147,214)",name:"取消",onClick:function(){e.destroyLoginWin()}})},initUserNameForm:function(){var e=this;this.username=new PJF.ui.textfield({dom:"fr_usernameDom"}),this.password=new PJF.ui.textfield({dom:"fr_passwordDom"}),this.cancelBtn=new PJF.ui.linkButton({dom:"fr_cancelBtnDom",style:"main",bgColor:"rgb(20,147,214)",name:"取消",onClick:function(){e.destroyLoginWin()}}),this.loginBtn=new PJF.ui.linkButton({dom:"fr_loginBtnDom",style:"main",bgColor:"rgb(190,94,165)",name:"验证",
onClick:function(){e.validateUserNameForm()&&(e.setErrorTip("","fr_userErrMsg"),e.usernameFormLogin(e.combinateUserNameLoginData(),function(t){console.log("登录成功"),console.log(JSON.stringify(t)),e.destroyLoginWin(),e.params.successHandler(t)}))}})},combinateUserNameLoginData:function(){var t=PJF.apply({},this.loginBaseData);t.userCode=this.userCode,t.userPwd=this.userPwd,this.userPwd="",t.userId=t.userCode;var e={_fw_service_id:"commonLoginCheckService",jsonClass:"com.ccb.model.InputLoginBean"};return e.jsonData=PJF.util.json2str(t),e},usernameFormLogin:function(t,e){var i=this,n=PJF.util.encrypt(PJF.util.trim(this.password.getValue()));if(n){var o={Auth_Type:"1",Auth_ID:PJF.util.trim(this.username.getValue()),Auth_PW:n};PJF.apply(o,{OPER_CODE:PJF.otherInfo&&PJF.otherInfo.devId?PJF.otherInfo.devId:"",Auth_Org:PJF.roleInfo&&PJF.roleInfo.orgCode?PJF.roleInfo.orgCode:"",Auth_Post:this.params.Auth_Post,
Illegal_Post:PJF.otherInfo&&PJF.otherInfo.auditPos&&PJF.otherInfo.MENU_ID?PJF.otherInfo.auditPos[PJF.otherInfo.MENU_ID]:"",Uaap_Ip:PJF.otherInfo&&PJF.otherInfo.IPS?PJF.otherInfo.IPS[0]:"127.0.0.1"}),console.log("密码登录请求参数:"+JSON.stringify(o)),PJF.communication.ajax({url:"/bosWeb/ecpJson.action",async:!1,data:{_fw_service_id:"doStmAuthCheck",jsonData:PJF.util.json2str(o)},success:function(t){"00"==t.TX_STATUS&&"0000000000"==t.RSP_CODE?(e&&e(t),console.log("密码验证成功")):(console.log("密码验证失败data:"+JSON.stringify(t)),i.params.failure(t.ERROR_MSG),i.setErrorTip(t.ERROR_MSG||"登录失败，未知错误","fr_userErrMsg"))},failure:function(t,e,n){console.log("密码验证失败ts:"+JSON.stringify(e)),i.params.failure("密码验证失败:"+e)}})}else i.setErrorTip("加密出错，请重试","fr_userErrMsg")},validateUserNameForm:function(){var t=PJF.util.trim(this.username.getValue()),e=PJF.util.trim(this.password.getValue());return t&&e?(this.userCode=t,this.userPwd=e,!0):(this.setErrorTip(this.constants.USERNAME_PWD_NOT_NULL,"fr_userErrMsg"),!1)},
setErrorTip:function(t,e){$("#"+e).html(t)},initUi:function(e){var t=e.authTip||"请工作人员按指纹",n=$("<div id='pjf_stm_fr'><div class='pjf_stm_title pjf_stm_fr_title'>指纹审核</div><div class='pjf_stm_fr_window'><div class='pjf_stm_fr_left'></div><div class='pjf_stm_fr_right'>"+t+"<div class='pjf_stm_fr_msg'></div></div></div><div class='pjf_stm_fr_btn'><div id='pjf_stm_fr_btn1'></div><div id='pjf_stm_fr_btn2'></div></div></div>"),i=this;i.com.append(n),i.windowId=PJF.util.generateUUid(),template.newpage.append("<div id ='"+i.windowId+"'></div>"),i.pop=new PJF.ui.window({dom:i.windowId,htmlDomId:"pjf_stm_fr",width:1070,height:590,domLoadedCallBack:function(){i.btn1=new PJF.ui.linkButton({dom:"pjf_stm_fr_btn1",name:"取消审核",style:"main",onClick:function(){i.com.find("#pjf_stm_fr").remove(),i.pop.destroy(),i.readFingerResult&&i.readFingerResult.eventId&&PJF.event.removeSubscriber(i.readFingerResult.eventId),"function"==typeof e.cancelAuth&&e.cancelAuth()}}),i.btn2=new PJF.ui.linkButton({
dom:"pjf_stm_fr_btn2",name:"重新审核",style:"main",disabled:!0,onClick:function(){setTimeout(function(){try{if(PJF.constants.IS_DEBUG)return void e.success(PJF.debug.constants.FINGER);i.clearMessage();var t={timeout:i.params.timeout};i.readFingerResult=PJF.stm.Finger.readFinger(t,function(){i.readFingerCallBack.apply(i,arguments)}),i.btn2.disable()}catch(t){alert("读取指纹失败")}},0)}})}})},setMessage:function(t){$("#"+this.windowId).find(".pjf_stm_fr_msg").text(t)},clearMessage:function(){this.setMessage("")},getClassName:function(){return"PJF.ui.fingerReader"},destroy:function(){this.destroyLoginWin(),this.com&&this.com.remove(),PJF.ui.componentMgr.remove(this.id)}}),PJF.ui.signature=PJF.extend(PJF.ui.component,{init:function(t){this.params={width:200,height:125,winWidth:800,winHeight:500,okBtn:null,cancelBtn:null,signatureWin:null,noSign:!1,localSign:!1,success:function(t){},failure:function(t){}},$.extend(this.params,t),this.initUi(this.params)},initUi:function(a){var s=this;if(a.dom){
s.com.append("<div class='pjf_stm_signaturecontent'></div>"),$(".pjf_stm_signaturecontent").css({width:s.params.width/PJF.constants.DEFAULT_FONTSIZE+"rem",height:s.params.height/PJF.constants.DEFAULT_FONTSIZE+"rem"}).unbind("click").bind("click",function(){if(s.params.noSign)s.params.success();else{s.openWin(),s.zdStyle();var t=$(".pjf_stm_signature_content"),e=t.offset(),n=t.width(),i=t.height();if(PJF.communication.player.SpeekText("已为您呼叫工作人员前来确认,请稍候",100),a.localSign){var o=$("<canvas width = '"+n+"' height = '"+i+"'></canvas>").appendTo(t);s.canvasSign=new PJF.ui.sign({canvas:o[0]})}else PJF.stm.eSign.startSignature({x:e.left,y:e.top,w:n,h:i},function(t){})}})}else{s.openWin(),$("#stm_signature_window_div").css({top:"3.7rem",left:"0rem",width:"12.36rem"}),$("#stm_signature_window_div .pjf_stm_signature_bottom").css({width:"12rem"}),a.photoContent&&($(".stmwindow-body").css({width:"70%"}),$("#stm_signature_window_div .pjf_stm_signature_bottom").css({width:"70%"}),
$("#stm_signature_window_div").append("<div class='stm_signature_window_pic'><img src='data:image/jpg;base64,"+a.photoContent+"' /></div>")),s.zdStyle();var t=$(".pjf_stm_signature_content"),e=t.offset(),n=t.width(),i=t.width()/2;if(a.localSign){var o=$("<canvas width = '"+n+"' height = '"+t.height()+"'></canvas>").appendTo(t);this.canvasSign=new PJF.ui.sign({canvas:o[0]})}else PJF.stm.eSign.startSignature({x:e.left,y:e.top,w:n,h:i},function(t){})}},zdStyle:function(){this.params.localSign&&(this.params.dom?($("#stm_signature_window_div").css({width:"100%",height:"100%",top:"0rem",left:"0rem"}),$("#stm_signature_window_div .pjf_stm_signature_bottom").css({width:"100%"}),$(".pjf_stm_signature_content").css({width:"100%",height:"7.3rem"})):this.params.photoContent?($("#stm_signature_window_div").css({height:"100%",top:"0rem"}),$(".pjf_stm_signature_content").css({width:"8rem",height:"7rem"})):($("#stm_signature_window_div").css({height:"100%",top:"0rem"}),
$(".pjf_stm_signature_content").css({width:"12rem",height:"7rem"})))},openWin:function(){var t=this;if(t.params.signatureWin)t.params.signatureWin.show();else{var e=t.params.sigTips?'<div class="stm_signature_signTip">'+t.params.sigTips+"</div>":"",n='<div class="stm_signature_openwin" id="stm_signature_win" style="display:none;"><div class="pjf_stm_signature_title">'+(t.params.staffOperation?"请您使用电磁笔以正楷字体 确认":"客户签名：请您使用电磁笔以正楷字体签名确认")+"</div>"+e+'<div class="pjf_stm_signature_content"></div><div class="pjf_stm_signature_bottom"><a id="stm_signature_cancel"></a><a id="stm_signature_okbtn"></a></div></div><div id="stm_signature_window_div"></div>';template.newpage.append(n),$(".pjf_stm_signature_content").css({width:(t.params.winWidth-200)/PJF.constants.DEFAULT_FONTSIZE+"rem",height:(t.params.winHeight-200)/PJF.constants.DEFAULT_FONTSIZE+"rem"}),$(".pjf_stm_signature_bottom").css({width:(t.params.winWidth-30)/PJF.constants.DEFAULT_FONTSIZE+"rem"}),
t.params.signatureWin=new PJF.ui.window({dom:"stm_signature_window_div",htmlDomId:"stm_signature_win",width:t.params.winWidth,height:t.params.winHeight,domLoadedCallBack:function(){t.params.cancelBtn=new PJF.ui.linkButton({dom:"stm_signature_cancel",bgColor:"rgb(215, 98, 183)",style:"smaller",name:"重签",onClick:function(){t.params.localSign?t.canvasSign.clear():PJF.stm.eSign.clearSignature()}}),t.params.okBtn=new PJF.ui.linkButton({dom:"stm_signature_okbtn",bgColor:"rgb(215, 98, 183)",style:"smaller",name:"确认",onClick:function(){t.params.signatureWin.hide(),$("#stm_signature_window_div").hide(),$("#stm_signature_win").hide(),t.showSignature(),PJF.constants.IS_DEBUG&&t.params.success(PJF.debug.constants.SIGNATURE)}})}})}},showSignature:function(e,n){var i=this,o=$(".pjf_stm_signaturecontent");o.empty();if(this.params.localSign)if(!0!==e){var t=this.canvasSign.getSign();PJF.communication.saveBase64Image(t,PJF.stm.baseDir+"/sign/"+PJF.otherInfo.SVC_ID+".jpg"),this.params.success(t,""),
o.append("<img style='width:2rem;height:1.25rem' src='data:image/jpg;base64,"+t+"' />")}else n&&n();else PJF.stm.eSign.getSignature(function(t){!0!==e?0==t.status?i.params.failure(t.errorCode,t):(i.params.success(t.info.photoContent,t.info.pchSignData),o.append("<img style='width:2rem;height:1.25rem' src='data:image/jpg;base64,"+t.info.photoContent+"' />")):n&&n()})},getClassName:function(){return"PJF.ui.signature"}}),PJF.apply(PJF.ui.signature.prototype,{destroy:function(t){var e=this;e.hasDestroyed||e.showSignature(!0,function(){e.hasDestroyed=!0,t&&t(),e.params.signatureWin.destroy(),$("#stm_signature_win").remove(),$("#stm_signature_window_div").remove()})}}),PJF.ui.messageBox=PJF.extend(PJF.ui.component,{init:function(t){this.errorMessageBox=new PJF.ui.errorMessageBox({showIcon:!1,content:t.content,buttonConfs:t.buttonConfs})}}),PJF.apply(PJF.ui.messageBox.prototype,{destroy:function(){this.errorMessageBox.destroy()},newDestroy:function(){this.errorMessageBox.destroy(),
PJF.ui.componentMgr.remove(this.id),this.com&&this.com.remove(),this.errorMessageBox=null,this.com=null,this.id=null}}),PJF.ui.multiInfo=PJF.extend(PJF.ui.component,{init:function(t){this.options={units:[],width:1074,height:600},this.trimData(t),this.createDom(),this.adjustCss()},trimData:function(t){$.extend(this.options,t)},createDom:function(){var n=this,t=n.options.units,i=['<div class="pjf-mInfo-frame"><ul class="pjf-mInfo-ul">'];$.each(t,function(t,e){try{i.push(n._createLiUnit(e))}catch(t){console.error(t.message)}}),i.push(["</ul></div>"]),n.com.append(i.join("")),n.frame=n.com.find(".pjf-mInfo-frame"),n.ul=n.com.find(".pjf-mInfo-ul")},adjustCss:function(){var t=this.options,e=PJF.constants.DEFAULT_FONTSIZE;this.frame.css({width:"auto"===t.width?t.width:t.width/e+"rem",height:"inherit"}),PJF.util.deviceType.icm&&this.ul.css({"overflow-y":"initial","padding-right":"0"})},_createLiUnit:function(t){var n=[]
;return n.push('<li class="pjf-mInfo-unit"><div class="pjf-mInfo-icon"><div class="pjf-mInfo-icon-inner"><div class="pif-mInfo-icon-combine"><div class="pjf-mInfo-img" style="background-image: url('+t.iconUrl+')"></div><p class="pjf-mInfo-instr">'+t.title+'</p></div></div></div><div class="pjf-mInfo-detail">'),$.each(t.content,function(t,e){n.push(function(t){var i=[],o=t.name,e=t.desc;"string"==typeof e&&(e=[].concat(e));return i.push("<table>"),$.each(e,function(t,e){var n=0===t?o+" :":"";i.push('<tr><td style="white-space: nowrap;vertical-align: top">'+n+'</td><td style="padding-left: .15rem ; word-break: break-all;-ms-word-break: break-all;">'+e+"</td></tr>")}),i.push("</table>"),i.join("")}(e))}),n.push("</div></li>"),n.join("")}}),PJF.apply(PJF.ui.multiInfo.prototype,{getClassName:function(){return"PJF.ui.multiInfo"},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null}}),PJF.ui.loading=PJF.extend(PJF.ui.component,{init:function(t){
var e=PJF.ui.loading.object;for(var n in e)e[n].css("display","none");var i,o=this;t.msg=t.text||t.msg;try{i=PJF.i18n.getI18nResource("pjfI18n.loadingMsg")}catch(t){i="业务正在处理中，请稍候……"}var a={msg:i,opacity:"0.5",target:"body"};o.conf=$.extend(a,t);var s=$(o.conf.target).css("position","relative");o.cntr=$('<div id="pjf_laoding_'+this.generateId()+'" componentId="'+this.id+'"></div>'),s.append(o.cntr),o.conf.noIcon?o.msgBox=$('</div><div class="pjf_laoding_msg">'+o.conf.msg+"</div>"):o.msgBox=$('</div><div class="pjf_laoding_msg"><div class="pjf_laoding_ico"></div>'+o.conf.msg+"</div>"),o.conf.noLayer||(o.layer=$('<div class="pjf_loading_layer"></div>'),o.cntr.append(o.layer).append(o.msgBox),o.layer.css("opacity",o.conf.opacity)),o.countDown=$('<div class="pjf_laoding_countDown"></div>'),o.conf.timeout&&(o.cntr.append(o.countDown),o.countDown.css("width","2rem"),o.countDown.css("height","2rem"),o.countDown.css("background-size","2rem 2rem"),
"DA003"===PJF.orgInfo.instSvrlLgPsnID&&o.countDown.css("background-image","url(../../../css/stmimg/newLoading_fan.gif)"),o.conf.timeout<10?o.countDown.text("0"+o.conf.timeout):o.countDown.text(o.conf.timeout),100<=o.conf.timeout&&o.countDown.css("font-size","0.45rem"),o.interval=setInterval(function(){o.conf.timeout--,o.conf.timeout<10?o.countDown.text("0"+o.conf.timeout):o.countDown.text(o.conf.timeout),o.conf.timeout<100&&o.countDown.css("font-size","0.6rem"),0==o.conf.timeout&&(o.countDown.css("background-image",""),clearInterval(o.interval),o.destroy(),o.conf.afterCountDown&&o.conf.afterCountDown())},1e3)),o.msgBox.css({lineHeight:o.msgBox.height()+"px",left:(o.cntr.width()-o.msgBox.width())/2+"px"}),window.parent==window||o.conf.noLayer||template.disableNavbar(!0),o.zdStyle(),PJF.event.publish("PJF_STM_LOCK"),PJF.ui.loading.count++,PJF.ui.loading.object.push(o.cntr)},setMessage:function(t){this.msgBox.text(t),this.conf.noIcon||this.msgBox.prepend('<div class="pjf_laoding_ico">'),
this.zdStyle(),this.msgBox.css({lineHeight:this.msgBox.height()+"px",left:(this.cntr.width()-this.msgBox.width())/2+"px"})},zdStyle:function(){PJF.orgInfo&&"DF001"==PJF.orgInfo.instSvrlLgPsnID&&$(".pjf_laoding_ico").css({"background-image":"url(icon/zd_loading.png)",width:"1.6rem"})},destroy:function(){for(var t=PJF.ui.loading.object,e="",n=0;n<t.length;n++)if(t[n]==this.cntr){e=n;break}PJF.ui.componentMgr.remove(this.id);if(clearInterval(this.interval),this.cntr&&this.cntr.remove(),this.layer&&this.layer.remove(),this.msgBox.remove(),this.countDown.remove(),window.parent!=window&&template.disableNavbar(!1),!this.hasDestroy){PJF.event.publish("PJF_STM_UNLOCK"),PJF.ui.loading.count--,PJF.ui.loading.object.splice(e,1);var i=PJF.ui.loading.object.length;i&&PJF.ui.loading.object[i-1].css("display","block")}this.hasDestroy=!0},getClassName:function(){return"PJF.ui.loading"}}),PJF.ui.loading.count=0,PJF.ui.loading.object=[],PJF.ui.coverFlow=PJF.extend(PJF.ui.component,{defaultSettings:{
liClassArray:["pos_0","pos_1","pos_2","pos_3","pos_4","pos_5","pos_6","pos_7","pos_8"],liClassPrefix:"pos_",textClassArray:["imgInfo_0","imgInfo_1","imgInfo_2","imgInfo_3","imgInfo_4","imgInfo_5","imgInfo_6","imgInfo_7","imgInfo_8"],textClassPrefix:"imgInfo_",textCss:[["20px","14px"],["20px","14px"],["30px","23px"],["20px","14px"],["35px","27px"]]},elements:{componentWidth:960,textHeight:[40,35,35,30,30,20,20]},init:function(t){var e=this,n=this.defaultSettings;this.conf=t,this.data=[],this.onChoose=t.onChoose,this.com.addClass("ytd_coverFlow"),this.ulId=this.generateId(),$("<ul id='"+this.ulId+"'></ul>").appendTo(this.com),this.ulDom=this.com.find("#"+this.ulId);for(var i=0;i<t.data.length;i++){var o=i<n.liClassArray.length?i:i%2==0?n.liClassArray.length-1:n.liClassArray.length-2,a="<li class ='"+n.liClassPrefix+o+"'><img src = '"+t.data[i].url+"' ></img>"
;t.data[i].text&&(a+="<div class = '"+n.textClassPrefix+o+"'><span class = 'imgInfoFont'>"+(t.data[i].text?t.data[i].text:"")+"</span></div>"),a+="</li>";var s=$(a);o%2==0?s.appendTo(this.ulDom)&&this.data.push(t.data[i]):s.prependTo(this.ulDom)&&this.data.unshift(t.data[i])}this.liAttrs=[],this.liDoms=this.com.find("li"),this.com.find("li").each(function(){e.liAttrs.push([$(this).css("left"),$(this).css("top"),$(this).css("opacity"),$(this).css("zIndex"),$(this).css("width"),$(this).attr("class")])}),this.textAttrs=[],this.textDoms=this.com.find("div"),this.fontResize(),this.initEvent()},initEvent:function(){var o=this,a=this.defaultSettings,s=this.conf;this.com.delegate("li","click",function(){var t=$(this).attr("class").substring(a.liClassPrefix.length),e=parseInt((parseInt(t)+1)/2);0==t?o.chooseMiddle():t%2!=0?o.moveRight(e,"normal"):o.moveLeft(e,"normal"),s.chooseAfterClick&&o.onChoose&&o.chooseMiddle()}),this.com.delegate("li","mousedown",function(t){return o.startXY={
x:t.clientX,y:t.clientY},o.startMoveNum=0,!(o.startMove=!0)}),this.com.bind("mouseleave",function(t){return o.startMove=!1,o.startXY=null,!1}),this.com.bind("mouseup",function(t){return o.startMove=!1,o.startXY=null,!1}),this.com.delegate("li","mousemove",function(t){if(o.startXY){var e=(t.clientX-o.startXY.x)/o.elements.componentWidth*(a.liClassArray.length-2),n=parseInt(e),i=n-o.startMoveNum;!o.checkAnimated&&s.chooseAfterDrag&&0<Math.abs(i)&&(o.checkAnimated=setInterval(function(){for(var t=!0,e=0;e<o.liDoms.length;e++)if($(o.liDoms[e]).is(":animated")){t=!1;break}t&&(clearInterval(o.checkAnimated),o.checkAnimated=null,o.chooseMiddle())},400)),i<0?o.moveLeft(-i,100):0<i&&o.moveRight(i,100),o.startMoveNum=n}})},moveRight:function(t,e){for(var n=0;n<t;n++)this.liAttrs.push(this.liAttrs[0]),this.liAttrs.shift(),this.data.unshift(this.data[this.data.length-1]),this.data.pop();this.shift(e)},moveLeft:function(t,e){
for(var n=0;n<t;n++)this.liAttrs.unshift(this.liAttrs[this.liAttrs.length-1]),this.liAttrs.pop(),this.data.push(this.data[0]),this.data.shift();this.shift(e)},shift:function(t){for(var e=0;e<this.liDoms.length;e++)this.liDoms[e].style.zIndex=this.liAttrs[e][3],$(this.liDoms[e]).animate({left:this.liAttrs[e][0],top:this.liAttrs[e][1],opacity:this.liAttrs[e][2],width:this.liAttrs[e][4]},t),$(this.liDoms[e]).attr("class",this.liAttrs[e][5]);for(e=0;e<this.textDoms.length;e++){var n=$(this.textDoms[e]).parent().attr("class"),i=this.defaultSettings.textClassPrefix+n.substring(4);$(this.textDoms[e]).attr("class",i)}this.fontResize()},fontResize:function(){for(var t=0;t<this.textDoms.length;t++){$(this.textDoms[t]).removeAttr("style");var e=$(this.textDoms[t]).find("span").text();if(7<e.length&&e.length<=14){var n=7*$(this.textDoms[t]).css("fontSize").match(/\d+/)[0]/(e.length+2)+"px";$(this.textDoms[t]).css("fontSize",n)}else if(14<e.length){
n=$(this.textDoms[t]).css("fontSize").match(/\d+/)[0]/2+"px";var i=$(this.textDoms[t]).css("line-height").match(/\d+/)[0]/2+"px";$(this.textDoms[t]).css("fontSize",n),$(this.textDoms[t]).css("line-height",i)}}},chooseMiddle:function(){this.onChoose&&this.onChoose(this.getSelected())},getValues:function(){},choosePic:function(t){if(t)for(var e=0;e<this.liDoms.length;e++){if($(this.liDoms[e]).find("img").attr("src")==t.url){$(this.liDoms[e]).trigger("click");break}}},getSelected:function(){return this.data[parseInt(this.data.length/2)]},getClassName:function(){return"PJF.ui.coverFlow"},destroy:function(){this.com.children().remove(),this.com.removeClass("ytd_coverFlow"),PJF.ui.componentMgr.remove(this.id),this.com=null,this.id=null},disable:function(){this.com.undelegate("click").undelegate("mousedown").undelegate("mousemove"),this.com.unbind("mouseup").unbind("mouseleave"),this.com.css("background-color","#F0F0F0").css("opacity",.6)},enable:function(){this.initEvent(),
this.com.css("background-color","transparent").css("opacity",1)}}),PJF.ui.errorMessageBox=PJF.extend(PJF.ui.component,{init:function(t){var e=this;this.options={btnConf:{style:"main",bgColor:"rgb(20,149.214)",name:"确定",onClick:function(){e.disableBtn(),e.destroy()}},buttonConfs:[],content:"",showIcon:!0,detailMsg:"",data:null},$.extend(this.options,t),this.initData(),e.linkBtns=[];this.options;PJF.event.publish(PJF.stmEvent.INIT_ERR_MSG_BOX,this.options.content,this.options.detailMsg),this.initHtml(),this.initCss(),this.bindEvents()},initData:function(){if(this.options.data&&this.options.data.BK_DESC){"系统错误，请稍后再试"==this.options.data.BK_DESC&&(this.options.data.BK_DESC="暂时未能处理您的请求，请联系大堂经理。");var t=this.options.data.BK_DESC||"",e=this.options.data.BK_CODE?"错误代码："+(this.options.data.BK_CODE||""):"",n=PJF.i18n.getI18nResource("pjfI18n.errorSerNum")+(this.options.data._COMMON?this.options.data._COMMON.SYS_EVT_TRACE_ID:""),i=this.options.data.BK_DESC_RAW||"",o="暂时未能处理您的请求，请联系大堂经理。<br>"
;0==(this.options.content=t).indexOf(o)?(this.options.content=PJF.i18n.getI18nResource("pjfI18n.errorKeyword"),t=t.substr(o.length+9)):t=i,t=t?"错误描述："+t:t,this.options.content+="<br>"+n,PJF.util.deviceType.pad&&(this.options.content=this.options.content.replace("暂时未能处理您的请求，请联系大堂经理","暂时未处理您的请求，具体请点击详细信息")),(e||t)&&(this.options.detailMsg=[e,t].join("<br>"))}PJF.otherInfo.isSelfBank&&(this.options.detailMsg&&(this.options.detailMsg=this.options.detailMsg.replace("大堂经理","工作人员")),this.options.content&&(this.options.content=this.options.content.replace("大堂经理","工作人员")))},initHtml:function(){var t,e,a=this,s=a.options;try{e=PJF.i18n.getI18nResource("pjfI18n.detailMsg")}catch(t){e="详细信息"}if(console.log("content:"+s.content+",detailMsg:"+s.detailMsg),this.com=$('<div class="errorMsgbox_container"></div>'),
t='<div class="errorMsgbox_mask"></div><div class="errorMsgbox_main"><div class="errorMsgbox_content"><div class="errorMsgbox_content_icon"></div><div class="errorMsgbox_content_text errorMsgbox_vertical-center"><span class="errorMsgbox_content_text_content">'+s.content+(""!=s.detailMsg?'<br/><span class="errorMsgbox_content_text_detail"><span class="errorMsgbox_content_text_detail_text">'+e+'</span><span class="errorMsgbox_content_text_detail_icon_down"></span><br/><span class="errorMsgbox_content_text_detail_content">'+s.detailMsg+"</span></span>":"")+'</span></div></div><div class="errorMsgbox_buttons"><span class="errorMsgbox_buttons_spans"></span></div></div>',$("body").append(this.com),this.com.append(t),!1!==s.buttonConfs){if(0==s.buttonConfs.length){var n=a.generateId(),i=s.btnConf;i.dom=n,i.noDestroy=!0,a.com.find(".errorMsgbox_buttons_spans").append('<span class="errorMsgbox_buttons_btn" id="'+n+'"></span>');var o=new PJF.ui.linkButton(i);a.linkBtns.push(o)}
for(var r in s.buttonConfs)!function(t){var e=s.buttonConfs[t],n=e.dom||"errmsgbox"+a.generateId();e.dom=n,e.noDestroy=!0;var i=e.onClick;e.onClick=function(){if(!1!==e.isClose&&a.disableBtn(),i)try{i()}catch(t){console.log("errorMessagebox执行回调出错:"+t.message)}!1!==e.isClose&&setTimeout(function(){a.destroy()},0)},a.com.find(".errorMsgbox_buttons_spans").append('<span class="errorMsgbox_buttons_btn" id="'+n+'"></span>');var o=new PJF.ui.linkButton(e);a.linkBtns.push(o)}(r)}},initCss:function(){var t=this.options;""!=t.detailMsg&&this.com.find(".errorMsgbox_content_text_detail_content").hide(),!1===t.showIcon&&(this.com.find(".errorMsgbox_content_text").css({width:"100%"}),this.com.find(".errorMsgbox_content_icon").css({display:"none"}),this.com.find(".errorMsgbox_content_text_content").css({"text-align":"center"}))},bindEvents:function(){if(""!=this.options.detailMsg){
var t=this.com.find(".errorMsgbox_content_text_detail_content"),e=this.com.find(".errorMsgbox_content_text_detail_icon_down");this.com.find(".errorMsgbox_content_text_detail").unbind("click").bind("click",function(){"none"==t.css("display")?t.slideDown("slows",function(){e.addClass("errorMsgbox_content_text_detail_icon_up")}):t.slideUp("slows",function(){e.removeClass("errorMsgbox_content_text_detail_icon_up")})})}}}),PJF.apply(PJF.ui.errorMessageBox.prototype,{getClassName:function(){return"PJF.ui.errorMessageBox"},destroy:function(){if(!this.hasDestroy){try{var t=this.linkBtns;for(var e in t)t[e].destroy()}catch(t){console.log("errorMessageBox destroy btn error :"+t.message)}this.com&&this.com.fadeOut("slow",function(){$(this).remove()}),PJF.ui.componentMgr.remove(this.id),this.com=null,this.params=null,this.id=null,this.hasDestroy=!0}},disableBtn:function(){var t=this.linkBtns;for(var e in t)t[e].disable()}}),PJF.ui.btnTextfield=PJF.extend(PJF.ui.component,{init:function(t){
var n=this;this.options={textfieldDomId:this.generateId(),buttonDomId:this.generateId()},t.pwdSupport&&$.extend(n.options,{infoMsg:"",success:function(t){},failure:function(t){},timeout:20,isCheckPwd:!1,validateStr:"",encryptType:"P2",firstInputPwd:"",secondInputPwd:"",pinSound:"PIN_inputPwd.wav",pinSound2:"PIN_inputPwd2.wav",iTimes:1}),$.extend(n.options,t),$("#"+n.options.dom).append('<div class="stm_as_container"></div>');var e=n.com.find(".stm_as_container"),i=n.options;e.append("<input id='"+i.textfieldDomId+(t.pwdSupport?"' type='password":"")+"'>");var o={dom:i.textfieldDomId};$.extend(o,t.textfieldConf),n.options.pwdSupport&&$.extend(o,{readOnly:!0,width:n.options.tfWidth||240,height:n.options.tfHeight||80,defaultValue:n.options.defaultValue}),i.textfield=new PJF.ui.textfield(o),e.append("<span id='"+i.buttonDomId+"'></span>");var a={dom:i.buttonDomId,style:"textfield"};$.extend(a,t.buttonConf),n.options.pwdSupport&&$.extend(a,{appendStyle:"confirm",style:"main",
btnBgColor:n.options.btnBgColor||"rgb(65,159,245)",textColor:n.options.btnTextColor||"rgb(255,255,255)",name:n.options.btnName||"读取密码",width:n.options.btnWidth||100,height:n.options.btnHeight||80,onClick:function(){n.options.pwdSupport&&(PJF.event.addSubscriber(PJF.stm.client.events.PIN_LENGTH,function(t){t.split("|")[0];var e=t.split("|")[1];n.com.find(".pjf_stmtextfield").val(PJF.util.generateUUid().substr(0,e||-1))},window,!0),n.triggerReadCard(),n.options.button.disable())}}),i.button=new PJF.ui.linkButton(a)},triggerReadCard:function(){var t=this;t.com.find(".pjf_stmtextfield").val(""),t.options.textfield&&t.options.textfield.focus(),setTimeout(function(){try{PJF.stm.Pin.readPin(t.options,function(){t.firstPinCallBack.apply(t,arguments)})}catch(t){alert(t.message)}},2)},firstPinCallBack:function(t){var e=this;0==t.status?(e.options.enableFlag&&e.options.button.enable(),e.options.textfield.setValue(""),e.options.failure(t)):(e.options.firstInputPwd=t.info.pchSecPassword,
e.options.pwdValue=t.info.pchSecPassword,e.options.isCheckPwd?(e.options.textfield&&e.options.textfield.focus(),e.options.iTimes=2,PJF.stm.Pin.readPin(e.options,function(){e.secondPinCallBack.apply(e,arguments)})):(e.options.enableFlag&&e.options.button.enable(),e.options.success(t.info.pchSecPassword)))},secondPinCallBack:function(t){var e=this;e.options.button.disable(),0==t.status?e.options.failure(t):(e.com.find(".pjf_stmtextfield").val(""),e.options.secondInputPwd=t.info.pchSecPassword,e.options.pwdValue=t.info.pchSecPassword,e.options.firstInputPwd==e.options.secondInputPwd?e.isStrPwd(e.options.firstInputPwd,e.options.validateStr)?e.options.success(t.info.pchSecPassword):(t.notStrPwd=!0,t.status="0",t.errorCode="PJF_PWD_ERR02",t.errorMsg="密码过于简单",e.options.failure(t)):(t.wrongPwd=!0,t.status="0",t.errorCode="PJF_PWD_ERR01",t.errorMsg="两次密码输入不一致",e.options.failure(t)))},isStrPwd:function(t,e){
var n=PJF.communication.Decrypt(t,PJF.otherInfo.devId,PJF.otherInfo.token,PJF.otherInfo.secNode);if(!n.success)return!0;t=n.result;var i=[];i.push(function(t){return t.match(/^[0-9]{6}$/g)});i.push(function(t){return!t.match(/^([0-9]{1})\1{5}$/g)});i.push(function(t){for(var e=!0,n=0;n<t.length-1;n++)if(t.charCodeAt(n)-t.charCodeAt(n+1)!=1){e=!1;break}var i=!0;for(n=0;n<t.length-1;n++)if(t.charCodeAt(n+1)-t.charCodeAt(n)!=1){i=!1;break}return!e&&!i});i.push(function(t){return!t.match(/^([0-9]{1})\1{1}([0-9]{1})\2{1}([0-9]{1})\3{1}$/g)&&!t.match(/^([0-9]{1})\1{2}([0-9]{1})\2{2}$/g)});i.push(function(t,e){return(!e.match(/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$/)||"0"!=e[10]||"0"!=e[12]||t.substring(0,4)!=e.substring(6,10)||t[4]!=e[11]||t[5]!=e[13])&&-1==e.indexOf(t)});for(var o=0;o<i.length;o++){if(!i[o].call(this,t,e))return!1}return!0},clearIntervalPwdLen:function(t){window.clearInterval(this.intervalId)},getTextfieldObject:function(){
return this.options.textfield},getButtonObject:function(){return this.options.button},readOnly:function(t){this.options.textfield.readOnly(t),this.options.button.readOnly(t)},setValue:function(t){this.options.pwdValue=t,this.options.textfield.setValue(t.substr(0,6))},getValue:function(){return this.options.pwdValue},destroy:function(){this.options.textfield.destroy(),this.options.button.destroy(),this.com.remove(),PJF.ui.componentMgr.remove(this.id),this.options=null,this.com=null,this.params=null,this.id=null}}),PJF.ui.phoneNumber=PJF.extend(PJF.ui.component,{init:function(t){this.initProperties();t.type=t.type||"interMobile";var e=this.properties[t.type];t.inputIds=t.inputIds||e.inputIds,e.inputIds=t.inputIds,t.width=t.width||e.width,e.width=t.width,t.tips=t.tips||e.tips,e.tips=t.tips,e.layout=t.layout||"horizontal",this.settings=e,$("#"+t.dom).append('<div class="stm_phoneNumber_container"></div>')
;for(var n=this.com.find(".stm_phoneNumber_container"),i="",o=0;o<t.inputIds.length;o++)i+='<input id ="'+t.inputIds[o]+'" type = "text"></input>',"interTele"==t.type&&"vertical"==t.layout&&"1"==o?i+="<div class='stm_blank_content'></div>":o<t.inputIds.length-1&&(i+="<span class='pjf_dateSpan_separate'></span>");n.append(i);for(o=0;o<t.inputIds.length;o++){var a={dom:t.inputIds[o],width:t.width[o],placeHolder:e.tips[o]};t.textfieldConf&&$.extend(a,t.textfieldConf[o]),this.textFieldObjs[o]=new PJF.ui.textfield(a)}t.defaultValue&&this.setValue(t.defaultValue)},initProperties:function(){this.properties={interTele:{inputIds:["TelCtcMod_Itnl_DstcNo","TelCtcMod_Dmst_DstcNo","TelCtcMod_No","TelCtcMod_Exn_No"],tips:["国际区号","国内区号","电话号码","分机号"],width:[150,150,250,150]},interMobile:{inputIds:["TelCtcMod_Itnl_DstcNo","TelCtcMod_No"],tips:["国际区号","移动电话号码"],width:[150,250]}},this.textFieldObjs=[],this.settings={}},getPhoneNumberObject:function(){return this.textFieldObjs},getValue:function(){
for(var t={},e=0;e<this.textFieldObjs.length;e++){var n=this.textFieldObjs[e].getValue();t[this.settings.inputIds[e]]=n}return t},setValue:function(t){for(var e in t){var n=PJF.util.array.indexOf(this.settings.inputIds,e);0<=n&&(this.textFieldObjs[n].com.val(t[e]),this.textFieldObjs[n].com.triggerHandler("blur"))}},readOnly:function(t){for(var e=0;e<this.textFieldObjs.length;e++)this.textFieldObjs[e].readOnly(t)},disabled:function(t){for(var e=0;e<this.textFieldObjs.length;e++)this.textFieldObjs[e].disabled(t)}}),PJF.apply(PJF.ui.phoneNumber.prototype,{getClassName:function(){return"PJF.ui.phoneNumber"},validateParam:function(t){return!!t.dom},destroy:function(){for(var t=0;t<this.textFieldObjs.length;t++)this.textFieldObjs[t].destroy();PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.textFieldObjs=null,this.settings=null,this.com=null,this.id=null}}),PJF.ui.address=PJF.extend(PJF.ui.component,{init:function(t){this.options={layout:"horizontal",stateDomId:this.generateId(),
areaDomId:this.generateId(),detailDomId:this.generateId()},$.extend(this.options,t);this.initHtml()},initHtml:function(){var t=this,e=t.options;$("#"+e.dom).append('<div class="stm_address_container"></div>');var n=this.com.find(".stm_address_container");n.append("<span id='"+e.stateDomId+"'></span><span class='stm_as_prelabel'></span>");var i={dom:e.stateDomId,data:e.data,nullOption:e.nullOption,defaultValue:e.defaultValue,textAlign:"center",width:e.width&&e.width[0]||160,onChange:function(){t.stateOnChange()}};e.stateOtherConf&&$.extend(i,e.stateOtherConf),e.stateSelect=new PJF.ui.select(i),"vertical"==e.layout&&n.append("<div class='stm_blank_content'></div>"),n.append("<span id='"+e.areaDomId+"'></span>");var o={dom:e.areaDomId,width:e.width&&e.width[1]||160,cityName:e.cityName,countyName:e.countyName,nullOption:e.nullOption,nullLabel:!0};e.areaSelect=new PJF.ui.areaSelector(o),"vertical"==e.layout&&n.append("<div class='stm_blank_content'></div>"),
n.append("<input id='"+e.detailDomId+"'>");var a={dom:e.detailDomId,width:e.width&&e.width[2]||320};e.textfieldConf&&$.extend(a,e.textfieldConf),e.detail=new PJF.ui.textfield(a),t.stateOnChange()},stateOnChange:function(){var t=this.options,e=t.stateSelect.getValue();""!=e&&(e==t.chinaValue?("vertical"==t.layout&&$(this.com.find(".stm_blank_content")[1]).css("display","block"),t.areaSelect.com.css("display","inline-block")):(t.areaSelect.com.css("display","none"),"vertical"==t.layout&&$(this.com.find(".stm_blank_content")[1]).css("display","none")))},getStateObject:function(){return this.options.stateSelect},getAreaObject:function(){return this.options.areaSelect},getDetailObject:function(){return this.options.detail},setValue:function(t){var e=this.options,n=t.state;e.stateSelect.setValue(n),this.stateOnChange(),n==e.chinaValue&&(e.areaSelect.setProvinceValue(t.province),e.areaSelect.setCityValue(t.city),e.areaSelect.setCountyValue(t.country)),e.detail.setValue(t.address)},
getValue:function(){var t=this.options,e=t.stateSelect.getValue(),n={};return(n.state=e)==t.chinaValue&&(n.province=t.areaSelect.getProvinceValue(),n.city=t.areaSelect.getCityValue(),n.country=t.areaSelect.getCountyValue()),n.address=t.detail.getValue(),n},getText:function(){var t=this.options,e=t.stateSelect.getValue(),n=[];return n.push(t.stateSelect.getText()),e==t.chinaValue&&(n.push(t.areaSelect.getProvinceText()),n.push(t.areaSelect.getCityText()),n.push(t.areaSelect.getCountyText())),n.push(t.detail.getValue()),n},readOnly:function(t){this.options.stateSelect.readOnly(t),this.options.areaSelect.readOnly(t),this.options.detail.readOnly(t)}}),PJF.apply(PJF.ui.address.prototype,{getClassName:function(){return"PJF.ui.address"},validateParam:function(t){return!(!t.dom||!t.chinaValue)},destroy:function(){this.options.stateSelect.destroy(),this.options.areaSelect.destroy(),this.options.detail.destroy(),PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.options=null,
this.com=null,this.id=null}}),PJF.ui.calendar=PJF.extend(PJF.ui.component,{init:function(t){this.options={width:"",optionAlign:"left",yearTextDomId:this.generateId(),defaultDate:new Date},$.extend(this.options,t),this.oldYearValue=this.options.defaultDate.getFullYear(),this.oldMonthValue=this.options.defaultDate.getMonth()+1,this.oldDayValue=this.options.defaultDate.getDate();this.initHtml(),this.drawCalendar(this.options.defaultDate),this.bindEvents(),this.drawYearText(),this.setMonthValue(),this.setInputValue()},initHtml:function(){
var t='<div class="calendar_main"><div class="calendar_top"><input class="calendar_input" type="text" readonly="readonly" /><span class="calendar_top_icon"></span></div><div class="calendar_body" style="display:none;'+("right"==this.options.optionAlign?"right:0":"")+'"><div class="calendar_body_bar"><span class="yearpick_left calendar_pickicon_left"></span><span class="year_text"></span><span class="yearpick_right calendar_pickicon_right"></span><span class="monthpick_left calendar_pickicon_left"></span><span class="month_text calendar_pickicon_text"></span><span class="monthpick_right calendar_pickicon_right"></span></div><div class="calendar_body_content"></div></div></div>';(this.com.append(t),this.options.width)&&(this.com.find(".calendar_top").css({width:this.options.width/PJF.constants.DEFAULT_FONTSIZE+"rem"}),this.com.find(".calendar_input").css({width:this.options.width/PJF.constants.DEFAULT_FONTSIZE-.5+"rem"}))},drawCalendar:function(t){var e=this
;e.com.find(".calendar_body_content").children().remove();e.com.find(".calendar_body_content").append('<span class="calendar_specialweek">日</span><span>一</span><span>二</span><span>三</span><span>四</span><span>五</span><span class="calendar_specialweek">六</span>');var n=t.getFullYear(),i=t.getMonth()+1,o=t.getDate(),a=t;a.setMonth(i),a.setDate(0);var s=new Date(a).getDate(),r="";a=t;for(var c=new Date(a.setDate(1)).getDay(),l=0;l<c;l++)r+="<span></span>";for(var u=1;u<=s;u++)r+='<span class="day_text'+((c+u)%7==0||(c+u)%7==1?" calendar_specialweek":"")+(u==o?" calendar_day_picked":"")+'">'+(u<10?"0"+u:u)+"</span>";e.com.find(".calendar_body_content").append(r),e.oldYearValue=e.yearValue||e.oldYearValue,e.oldMonthValue=e.monthValue||e.oldMonthValue,e.oldDayValue=e.dayValue||e.oldDayValue,e.yearValue=n,e.monthValue=i,e.dayValue=o,e.bindDateEvent(),e.com.find(".calendar_body").focus()},bindEvents:function(){var t=this,e=this.$calendar_body=t.com.find(".calendar_body")
;t.com.find(".calendar_top_icon").unbind("click").bind("click",function(){"none"==e.css("display")?(e.slideDown(),e.focus()):t.hideCalendarDrop()}),e.attr("tabIndex","-1").on("blur",function(){0<e.find($(document.activeElement)).length||(t.validated(),t.hideCalendarDrop())})},drawYearText:function(){var o=this;o.com.find(".year_text").children().remove(),o.com.find(".year_text").append('<input class="calendar_pickicon_text" id="'+o.options.yearTextDomId+'">');var t={dom:o.options.yearTextDomId,hmode:4,width:80},a=o.options.yearTextfield=new PJF.ui.textfield(t);o.setYearValue(),a.com.bind("blur",function(){var t=a.getValue(),e=new Number(t);if($.isNumeric(e)&&1900<=e&&4==t.length){var n=!1;0<o.$calendar_body.find($(document.activeElement)).length&&(n=!0);var i=new Date(t,o.monthValue-1,o.dayValue);o.drawCalendar(i),o.setYearValue(),o.setInputValue(),n||(o.validated(),o.hideCalendarDrop())}})},hideCalendarDrop:function(){this.$calendar_body.slideUp(),
!this.options.onChange||this.yearValue==this.oldYearValue&&this.monthValue==this.oldMonthValue&&this.dayValue==this.oldDayValue||this.options.onChange()},bindDateEvent:function(){var e=this;e.com.find(".day_text").unbind("click").bind("click",function(){e.com.find(".calendar_day_picked").removeClass("calendar_day_picked"),$(this).addClass("calendar_day_picked"),e.oldDayValue=e.dayValue,e.dayValue=Number($(this).text()),e.setInputValue(),e.$calendar_body.focus()}),e.com.find(".yearpick_left").unbind("click").bind("click",function(){var t=new Date(e.yearValue-1,e.monthValue-1,e.dayValue);e.drawCalendar(t),e.setYearValue(),e.setInputValue()}),e.com.find(".yearpick_right").unbind("click").bind("click",function(){var t=new Date(e.yearValue+1,e.monthValue-1,e.dayValue);e.drawCalendar(t),e.setYearValue(),e.setInputValue()}),e.com.find(".monthpick_left").unbind("click").bind("click",function(){if(!(e.monthValue-1<1)){var t=new Date(e.yearValue,e.monthValue-2,e.dayValue);e.drawCalendar(t),
e.setMonthValue(),e.setInputValue()}}),e.com.find(".monthpick_right").unbind("click").bind("click",function(){if(!(12<e.monthValue+1)){var t=new Date(e.yearValue,e.monthValue,e.dayValue);e.drawCalendar(t),e.setMonthValue(),e.setInputValue()}})},readOnly:function(t){var e=this,n=e.com.find(".calendar_top");t?(e.overlayer=$('<div class="pjf_stmtextfield_overlayer"></div>'),e.overlayer.bind("click",function(t){return e.overlayer.focus(),!1}),n.append(e.overlayer)):n.find(".pjf_stmtextfield_overlayer").remove()},validated:function(){if(null!=this.options.validType){var me=this,options=me.options,value=me.getValue(),$container=me.com.find(".calendar_main"),$input=me.com.find(".calendar_top"),$tip=$container.find(".pjf_stmtextfield_msg"),msgArray=[];if(options.validType&&(options.validType instanceof Array||(options.validType=[options.validType],options.invalidMessage=[options.invalidMessage]),options.validType instanceof Array))for(var i in options.validType){
var msg=options.invalidMessage[i],typeParam=/([a-zA-Z0-9_]+)(.*)/.exec(options.validType[i]),rule=PJF.validator.rules()[typeParam[1]],status=rule(value,eval(typeParam[2]));status||msgArray.push(msg)}var msgStr=msgArray.join("、");return $tip.remove(),""!=msgStr?($('<span class="pjf_stmtextfield_msg">'+msgArray.join("、")+"</span>").appendTo($container),$input.addClass("calendar_error"),$container.find(".pjf_stmtextfield_msg").css({top:$input.height()})):$input.removeClass("calendar_error"),msgStr}},setYearValue:function(){this.options.yearTextfield.setValue(this.yearValue)},setMonthValue:function(){this.com.find(".month_text").text(this.monthValue<10?"0"+this.monthValue:this.monthValue)},setInputValue:function(){var t=this.yearValue+"-"+(this.monthValue<10?"0"+this.monthValue:this.monthValue)+"-"+(this.dayValue<10?"0"+this.dayValue:this.dayValue);this.com.find(".calendar_input").val(t)},getValue:function(){return new Date(this.yearValue,this.monthValue-1,this.dayValue)},
setValue:function(t){this.drawCalendar(t),this.setYearValue(),this.setMonthValue(),this.setInputValue(),this.validated()}}),PJF.apply(PJF.ui.calendar.prototype,{getClassName:function(){return"PJF.ui.calendar"},destroy:function(){this.options.yearTextfield.destroy(),PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.options=null,this.com=null,this.id=null}}),PJF.ui.tree=PJF.extend(PJF.ui.component,{init:function(t){this.options={dom:null,url:"",cpsReq:null,ajaxParam:null,params:null,data:null,enableExpandAsync:!1,multiple:!1,onlyChild:!1,onBeforeExpand:null,onCheck:null},$.extend(this.options,t);var e=this.options;$("#"+e.dom).append('<div class="stm_tree_container"></div>'),this.initTree(),this.bindEvents()},sendRequest:function(n){var i=this;i.options.url&&(i.options.cpsReq?(PJF.roleInfo.noRepeatRoleAuthInfoList=[],PJF.communication.cpsJsonReq({url:i.options.url,async:!1,fwServiceId:i.options.cpsReq.fwServiceId,fwTranId:i.options.cpsReq.fwTranId,
jsonData:i.options.cpsReq.jsonData,sqlId:i.options.cpsReq.sqlId,success:function(t){var e=t;"function"==typeof i.options.cpsReq.convertData&&(e=i.options.cpsReq.convertData(t)),n instanceof Function&&n(e)},failure:function(t){"function"==typeof i.options.fnFailure&&i.options.fnFailure(t)}})):i.options.ajaxReq&&PJF.communication.ajax({url:i.options.url,type:"get",dataType:"json",data:i.options.ajaxReq.data,async:!1,success:function(t){var e=t;"function"==typeof i.options.ajaxReq.convertData&&(e=i.options.ajaxReq.convertData(t)),n instanceof Function&&n(e)},failure:function(t){"function"==typeof i.options.fnFailure&&i.options.fnFailure(t)}}))},initTree:function(){var e=this;if(e.options.url){e.sendRequest(function(t){e.data=t})}else e.data=e.options.data;e.com.find(".stm_tree_container").append(e.createTree(e.data,!0,""))},initSubTree:function(i,o,t){var a=this;if(a.options.url){var e=a.options.onBeforeExpand(t)
;a.options.cpsReq?$.extend(a.options.cpsReq.jsonData,e):a.options.ajaxReq&&$.extend(a.options.ajaxReq.data,e);var s=a.data,r=o.split("_");a.sendRequest(function(t){for(var e="",n=0;n<r.length;n++)(e=0==n?s[r[0]]:e.children[r[n]]).children||(e.children=t);i.append(a.createTree(t,!0,o+"_"))})}},getDataByIndex:function(t){if(0==t||t){for(var e=this.data,n=t.split("_"),i="",o=0;o<n.length;o++)i=0==o?e[n[0]]:i.children[n[o]];return i}},createTree:function(t,e,n){if(!t)return"";for(var i='<ul style="display:'+(e?"block":"none")+'">',o=0;o<t.length;o++){var a=t[o],s=n+o;i+='<li id="treeItem_'+a.id+'" data-index='+s+" data-value="+a.value+">",i+='<span class="icon fold stm_treeItem_'+(a.open?"open":"close")+'"></span>',this.options.onlyChild&&(a.isParent||a.children)?i+='<a target="_blank">'+a.name+"</a>":(i+='<span class="check '+(a.checked?"curSelectedNode":"")+'">',i+='<span class="icon stm_treeItem_'+(this.options.multiple?"checkbox":"radio")+'"></span>',
i+='<a target="_blank">'+a.name+"</a>",i+="</span>"),i+=this.createTree(a.children,a.open,s+"_"),i+="</li>"}return i+="</ul>"},bindEvents:function(){var o=this,a=(o.data,this.com.find(".stm_tree_container"));a.on("click","ul li span.fold",function(){var t=$(this),e=$(this.parentNode).attr("data-index"),n=o.getDataByIndex(e);t.hasClass("stm_treeItem_open")?(n.open=!1,t.removeClass("stm_treeItem_open").addClass("stm_treeItem_close"),$(this.parentNode).children("ul").slideUp("fast")):t.hasClass("stm_treeItem_close")&&(n.open=!0,o.options.url&&o.options.enableExpandAsync&&o.initSubTree($(this.parentNode),e,n),t.removeClass("stm_treeItem_close").addClass("stm_treeItem_open"),$(this.parentNode).children("ul").slideDown("fast"))}),a.on("click",".check",function(){var t=$(this),e=$(this.parentNode).attr("data-index"),n=o.getDataByIndex(e),i=a.find(".curSelectedNode");t.hasClass("curSelectedNode")?(n.checked=!1,
t.removeClass("curSelectedNode")):(!o.options.multiple&&i&&i.length&&(o.getDataByIndex(i.parent("li").attr("data-index")).checked=!1,i.removeClass("curSelectedNode")),n.checked=!0,t.addClass("curSelectedNode")),o.options.onCheck instanceof Function&&o.options.onCheck(n)})},setCheckedNode:function(t){$.isArray(t)||(t=[t]);var n=this,e=this.com.find(".stm_tree_container");e.find(".curSelectedNode");e.find(".curSelectedNode").each(function(t){var e=$(this);n.getDataByIndex(e.parent("li").attr("data-index")).checked=!1,e.removeClass("curSelectedNode")});var i=[];for(var o in t){var a="";if(t[o]&&(a=e.find("ul li[data-value="+t[o]+"]")),a&&a.length){var s=n.getDataByIndex(a.attr("data-index"));s.checked=!0,i.push(s),$(a.find(".check")[0]).addClass("curSelectedNode")}if(!n.options.multiple)break}n.options.onCheck instanceof Function&&n.options.onCheck(i)},getCheckedNode:function(){var n=this,t=this.com.find(".stm_tree_container"),i=[],o=[],e={}
;return t.find(".curSelectedNode").each(function(t){var e=$(this).parent("li").attr("data-index");o.push(e),i.push(n.getDataByIndex(e))}),e.item=i,e.index=o,e},destroy:function(){PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.com=null,this.id=null}}),PJF.ui.treeSelect=PJF.extend(PJF.ui.component,{init:function(t){this.options={inputId:this.generateId(),containerId:this.generateId(),url:"",cpsReq:null,ajaxReq:null,data:null,multiple:!1,tree:null,treeContainer:null,enableExpandAsync:!1,currentSelectedItems:[],onlyChild:!1,width:400,maxHeight:350,onChange:null,onBeforeExpand:null},$.extend(this.options,t);this.initHtml(),this.bindEvents()},initHtml:function(){var t=this.options;$("#"+t.dom).append('<div class="stm_treeSelect_container"></div>');var e=this.com.find(".stm_treeSelect_container");e.append('<input id="'+t.inputId+'" readonly="readonly" class="stm_select_input stm_select_input_bg" style="padding-right:0.25rem" />'),e.css({
width:t.width/PJF.constants.DEFAULT_FONTSIZE+"rem"}),t.treeContainer||(t.treeContainer=$("<div id='"+t.containerId+"' class='stm_treeSelect_treeContainer'></div>"),t.treeContainer.appendTo(e),$("#"+t.containerId).css({top:$("#"+t.inputId).innerHeight()+"px",width:t.width/PJF.constants.DEFAULT_FONTSIZE+"rem","max-Height":t.maxHeight/PJF.constants.DEFAULT_FONTSIZE+"rem"})),this.createTree()},createTree:function(){var s=this,r=s.options;r.tree=new PJF.ui.tree({dom:r.containerId,multiple:r.multiple,onlyChild:r.onlyChild,url:r.url,cpsReq:r.cpsReq,ajaxReq:r.ajaxReq,data:r.data,enableExpandAsync:r.enableExpandAsync,onBeforeExpand:r.onBeforeExpand,onCheck:function(t){var e=r.tree.getCheckedNode(),n=e.item,i=[];r.currentSelectedItems=n,r.currentSelectedIndexs=e.index;var o=$("#"+r.inputId).val();for(var a in $("#"+r.inputId).val(""),n)i.push(n[a].name);$("#"+r.inputId).val(i.toString()),r.multiple||s.hideDiv(),r.onChange&&o!=i.toString()&&s.options.onChange(t)}})},hideDiv:function(){
$("#"+this.options.containerId).css("display","none")},bindEvents:function(){var t=this;$("#"+t.options.inputId).unbind("click").bind("click",function(){$("#"+t.options.containerId).css("display","block")}),t.com.find(".stm_treeSelect_container").unbind("mouseleave").bind("mouseleave",function(){t.hideDiv()})},getText:function(){return $("#"+this.options.inputId).val()},getSelectedPath:function(){var t=this.options.currentSelectedIndexs;return t?this.options.multiple?t:t[0]:""},getValueByIndex:function(t){return this.options.tree.getDataByIndex(t)},getValue:function(){var t=this.options;if(""===$("#"+this.options.inputId).val())return"";var e=t.currentSelectedItems,n=new Array;for(var i in e)n.push(e[i].value);return t.multiple?n:n[0]},setValue:function(t){this.options.tree.setCheckedNode(t)},setText:function(t){$("#"+this.options.inputId).val(t)},readOnly:function(t){var e=this,n=this.com.find(".stm_treeSelect_container")
;t?(e.overlayer=$('<div class="pjf_stmtextfield_overlayer"></div>'),e.overlayer.bind("click",function(t){return e.overlayer.focus(),!1}),n.append(e.overlayer)):n.find(".pjf_stmtextfield_overlayer").remove()},disabled:function(){$("#"+this.options.inputId).attr("disabled","disabled")},enable:function(){$("#"+this.options.inputId).removeAttr("disabled")}}),PJF.apply(PJF.ui.treeSelect.prototype,{getClassName:function(){return"PJF.ui.treeSelect"},validateParam:function(t){return!t.data||!t.url},destroy:function(){this.options.tree.destroy(),PJF.ui.componentMgr.remove(this.id),this.com.remove(),this.options=null,this.com=null,this.id=null}}),function(){var t,r,o,c,l=[],a=[],e=function(){};e.prototype={begin:function(t,e){this.stop(),c=e;var i=this,o=this.cfg=$.extend(!0,{},t);if(o.entry&&(l=l.concat(o.entry)),o.process)for(var n in o.process)if(o.process[n].ele){var a=o.process[n].ele.split("@"),s=!1===o.process[n].once?"on":"one";!function(n){
var t="click"===a[1]?PJF.stmEvent.LINKBTN_CLICK+" ":"";t+=a[1]+".stmGuide",$(document.body)[s](t,"#"+a[0],function(){for(var t=[],e=n;e.next&&o.process[e.next];)t.push(o.process[e.next]),e=o.process[e.next];!1===n.immediately?(l=l.concat([n]).concat(t),!r&&i.next()):(l=[n].concat(t),i.next())})}(o.process[n])}this.next()},next:function(){this.stop(!1,!1);var t,e=l.shift();if(e){if(e.show){var n=e.show.apply(e,c);if(!1===n)return this.next();$.extend(e,n)}e.sound&&PJF.communication.player.PlaySoundByUrl(e.sound),e.msg&&(t=e.msg,o||(o=(o=$('<div class="pjf_smartTip_msg" style=""><span></span><div class = "pjf_smartTip_xiaozhi"></div></div>').appendTo(document.body)).find("span")),o.html(t)),e.guide&&e.guide.split(";").forEach(function(t){var e=t.split("@");if(document.getElementById(e[0])){var n=document.getElementById(e[0]).getBoundingClientRect(),i=$("<div/>").appendTo(document.body);a.push(i),"frame"==e[1]?(i.css({position:"absolute",left:n.left-6,top:n.top-6,height:n.height+12,
width:n.width+12,"z-index":9999999}),i.addClass("pjf_smartTip_frame_blink")):"finger"==e[1]&&(i.css({position:"absolute",left:n.left+n.width,top:n.top+n.height/2-25,"z-index":9999999}),i.addClass("pjf_smartTip_finger"))}});var i=this;r=setTimeout(function(){i.next()},e.duration||5e3)}},stop:function(t,e){t=void 0===t||t,e=void 0===e||e,clearTimeout(r),r=null,t&&(l=[]),a.forEach(function(t){t.remove()}),a=[],o&&o.parent().remove(),o=null,e&&$(document.body).off(".stmGuide")},triggerGuide:function(t){if(this.stop(!0,!1),this.cfg.process&&this.cfg.process[t]){var e=this.cfg.process[t];l=[e],this.next()}}},PJF.ui.guide=function(){return t||(t=new e),t}}(),PJF.ui.sign=function(t){var e;t.canvas?(e=t.canvas,this.outer=!0):((e=document.createElement("canvas")).width=t.w,e.height=t.h,e.classList="pjf_canvas_sign",e.style.left=t.left+"px",e.style.top=t.top+"px",document.body.appendChild(e));var n=e.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,e.width,e.height),n.strokeStyle="#444",
n.lineWidth=3,this.canvas=e,this.ctx=n,this.$canvas=$(this.canvas),this.bindEvent()},PJF.apply(PJF.ui.sign.prototype,{bindEvent:function(){this._onmove=function(t){console.log("move",t);var e=this._getCoord(t);this.ctx.lineTo(e.x,e.y),this.ctx.stroke(),this.ctx.beginPath(),this._lastCoord=e,this.ctx.moveTo(e.x,e.y)}.bind(this),this._onstart=function(t){console.log("start",t),this.ctx.beginPath(),this._lastCoord=this._getCoord(t),this.$canvas.on("mousemove.sign touchmove.sign",this._onmove),this.$canvas.on("mouseup.sign touchend.sign",this._onend)}.bind(this),this._onend=function(t){console.log("end",t),this.$canvas.off("mousemove.sign touchmove.sign",this._onmove),this.$canvas.off("mouseup.sign touchend.sign",this._onend)}.bind(this),this.$canvas.on("mousedown.sign touchstart.sign",this._onstart)},_getCoord:function(t){var e,n;if((t=t.originalEvent).changedTouches&&t.changedTouches[0]){var i=this.canvas.getBoundingClientRect();e=t.changedTouches[0].pageX-i.left,
n=t.changedTouches[0].pageY-i.top}else t.offsetX&&(e=t.offsetX,n=t.offsetY);return console.log("pointer at:",e,n),{x:e,y:n}},clear:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},getSign:function(t,e){t=t||"image/jpeg";var n=this.canvas.toDataURL(t).replace("data:image/jpeg;base64,","");return e&&this.destroy(),n},destroy:function(){this.$canvas.off(".sign")}}),PJF.ui.nonIdentityCard=PJF.extend(PJF.ui.component,{init:function(t){this.params={infoMsg:resource.IDENTITY_INSERT_MSG,pchPhotoName:"",frontPhotoName:"",backPhotoName:"",success:function(t){},failure:function(t){},timeout:60},$.extend(this.params,t),this.initUi(this.params),this.triggerRead()},triggerRead:function(a){var s=this;setTimeout(function(){var t=PJF.stm.baseDir+"/identity/"+s.params.pchPhotoName,e=PJF.stm.baseDir+"/identity/"+s.params.frontPhotoName,n=PJF.stm.baseDir+"/identity/"+s.params.backPhotoName,i={timeout:s.params.timeout,pchCredTypes:s.params.pchCredTypes,
pchOperateTypes:s.params.pchOperateTypes,pchPhotoPath:t,pchFrontPhotoPath:e,pchBackPhotoPath:n,loadingConf:s.params.loadingConf},o=new PJF.ui.loading({noLayer:!0,noIcon:!0,msg:"",timeout:s.params.timeout});a&&$.extend(i,a),PJF.stm.PSR.scanAndReadAllInfo(i,function(){o&&o.destroy(),s.callBack.apply(s,arguments)})},0)},initUi:function(t){$("#"+t.dom).append('<div class="pjf_stm_content_left pjf_stm_nonIdentityImg"></div>')},callBack:function(t){0==t.status?"DRV0000020"!=t.errorCode&&this.params.failure(t):this.params.success(t.info.pchInfo)},getClassName:function(){return"PJF.ui.nonIdentityCard"}}),PJF.apply(PJF.ui.nonIdentityCard.prototype,{}),PJF.namespace("PJF.debug.constants"),PJF.debug={createClientInfo:function(){PJF.userInfo={terminalId:"",orgCode:"110378300",userId:"77976569",userName:"董杰",rightWidgets:[],userCode:"77976569",ccbinsChnShrtnm:"北京银地支行",usrNmCpaFullnm:"dongjie",operLevel:"",userCcbssState:"",empeIdLandNm:"dongjie1.bj",blngInsid:"110378300",ccbsId:"110378300021",
ccbEmpid:"77976569",hmnrscEmpid:"110372001040008"},PJF.otherInfo={topId:"",txnList:[],topPort:"",logicTerminalNo:"110378300A01003",token:"ticket-1-MFWqLjUShceoi9vgRDmWjWNiCMj9e0Bbbll",macAddress:"shenye.zh",chaTypeId:"002911037830000        ",clientIP:"128.160.216.133",chaType:"20170029"},PJF.orgInfo={orgType:"104030100",orgInstRgonIdCd:"BJ",orgState:"2",loginModeName:"",acCrTpCdSet:"B01",orgPropertyName:"",provinceCode:"",prefLngCd:"zh",parentOrgCode:"110005300",ctyRgonCd:"156",orgPhysicClass:"",orgCode:"110378300",preBusiDay:"",ancestorOrgCode:"110005300",instSvrlLgPsnNm:"建行总行",adivCd:"110106",orgShortCName:"北京银地支行",orgEName:"BEIJING YINDI OFFICE",postCode:"",loginMode:"",hrMns:"8",parentOrgLevel:"3",instSvrlLgPsnID:"CN000",lclCcyCd:"156",dccOrgCode:"",instLevel1BranchId:"110000000",tmzonCd:"29",instLevel1BranchChnFullNm:"中国建设银行股份有限公司北京市分行",orgCName:"中国建设银行股份有限公司北京银地支行",orgEAdd:"",orgLocationInfo:{bldNm:"",cntyanddstcTpcd:"",strNm:"",urbnAtnmsdstcTpcd:"",ltt:"",provAtnmSrgonTpcd:"",
rskCtyInd:"",ccbinsId:"110378300",floorNum:"",gergSptlCordDsc:"",rsdncCommNm:"",provAtnmsrgonCd:"",zipecd:"100070",unitNo:"",ccbinsandloreledTm:null,lgt:"",ccbinsandlorelstTm:null,dtlAdr:"银地家园1号楼首层04北侧",cntyanddstcCd:"",gergTpcd:"",roomNo:"",ccbinsandlorelmdfDsc:"",gergDsc:"",bdno:"",loId:"",urbnAtnmsdstcCd:"",ctyCd:"156",ccbinsAndLoRetpcd:"",provAtnmsrgonTpcd:"",mlbxNo:""},orgShortEName:"",orgCAdd:"",curBusiDay:"",orgClass:"4",orgProperty:"",levOne_code:"110000",levTwo_code:"110000"},PJF.roleInfo={positionPriority:"",signControls:[],noRepeatRoleAuthInfoList:[],authRolesMap:{},id:"G00000000006_110378300",positionTypeCode:"",roleAuthInfos:"",expNode2:"",pstMgrDepId:"010230000",pstMgrDeptNm:"总行渠道与运营管理部",expNode1:"110378300_G00000000006=G00000000006|110378300_G00000000007=G00000000007",orgCode:"110378300",positionId:"G00000000006",roleAuthInfoList:[{ahrNm:"注销账户或解除协议",pstRlId:"J000000048",aplId:"Y0000000000000000033",pstRlNm:"财富交易员",avyId:"n22.002.050.010",ahrId:"85"}],positionDesc:"高级柜员",
systemId:"",positionName:"高级柜员",insFTUInd:"0"},PJF.userInfo.userName=PJF.debug.constants.USER_NAME||PJF.userInfo.userName,PJF.userInfo.userCode=PJF.debug.constants.USER_CODE||PJF.userInfo.userCode,PJF.userInfo.orgCode=PJF.debug.constants.ORG_CODE||PJF.userInfo.orgCode,PJF.userInfo.ccbsId=PJF.debug.constants.CCBS_ID||PJF.userInfo.ccbsId,PJF.otherInfo.token=PJF.debug.constants.TOKEN||PJF.otherInfo.token,PJF.otherInfo.transSerNo=PJF.debug.constants.TRANS_SER_NO||PJF.otherInfo.transSerNo,PJF.otherInfo.macAddress=PJF.debug.constants.MAC_ADDRESS||PJF.otherInfo.macAddress,PJF.otherInfo.clientIP=PJF.debug.constants.CLIENT_IP||PJF.otherInfo.clientIP,PJF.otherInfo.logicTerminalNo=PJF.debug.constants.LOGIC_TERMINAL_NO||PJF.otherInfo.logicTerminalNo,PJF.orgInfo.orgShortCName=PJF.debug.constants.ORG_SHORT_CNAME||PJF.orgInfo.orgShortCName,PJF.orgInfo.orgClass=PJF.debug.constants.ORG_CLASS||PJF.orgInfo.orgClass,PJF.roleInfo.positionId=PJF.debug.constants.POSITION_ID||PJF.roleInfo.positionId,
PJF.roleInfo.noRepeatRoleAuthInfoList=PJF.debug.constants.NO_REPEAT_ROLE_AUTH_INFO_LIST||PJF.roleInfo.noRepeatRoleAuthInfoList,PJF.roleInfo.orgCode=PJF.debug.constants.ORG_CODE||PJF.roleInfo.orgCode}},function(){if(PJF.communication.isInClient()&&!PJF.util.isKylinSTM()){function i(){var t=window.location.href,e=t.search("#!");return 0<e?t.slice(e+2):"unknown pageid"}var o=PJF.constants.ON_PROD?1e3:Number.MAX_VALUE;console.log=function(){try{var e=[];Array.prototype.forEach.call(arguments,function(t){"string"==typeof t&&"object"==typeof(t=function(t){if("object"==typeof(t=PJF.util.safeParse(t)))for(var e in t)t[e]=PJF.util.safeParse(t[e]),"string"==typeof t[e]&&t[e].length>o?t[e]="该字段值过长，已省略":"object"==typeof t[e]&&arguments.callee(t[e]);return t}(t))&&(t=JSON.stringify(t)),e.push(t)});var t=PJF.util.getValue(PJF,"otherInfo.sysParam.STM_LOG_DEVICES");if(PJF.constants.ON_PROD)if("1"!=t){var n=PJF.util.stringToHex(PJF.util.des("stmencry",PJF.util.string16ToHex(e.join(" ")),1))
;PJF.communication.log.WriteLog([i(),",encrypted,",n].join(""))}else PJF.communication.log.WriteLog(" ");else PJF.communication.log.WriteLog([i(),",",e.join(" ")].join(""))}catch(t){PJF.communication.log.WriteLog("stm记录日志出错:"+t.message)}},PJF.constants.ON_PROD||(console.debug=console.log)}}(),PJF.stm.log=function(t,e){if(PJF.util.deviceType.tcr)try{e?PJF.logTag[e]?t?PJF.communication.isInClient()&&PJF.communication.log.WriteAppMonLog([PJF.logTag[e],":",t].join("")):PJF.communication.isInClient()&&PJF.communication.log.WriteAppMonLog(PJF.logTag[e]):PJF.communication.isInClient()&&PJF.communication.log.WriteAppMonLog("stm记录日志出错，无对应标签："+e):PJF.communication.isInClient()&&PJF.communication.log.WriteAppMonLog(t)}catch(t){PJF.communication.log.WriteAppMonLog("stm记录日志出错:"+t.message)}else PJF.communication.isInClient()&&PJF.communication.log.WriteAppMonLog(" ")},window.onerror=function(t,e,n){console.log(["js执行出错:",t,". 地址为:",e,". 行号为:",n].join("")),
alert(["执行出错:",t,". 地址为:",e,". 行号为:",n].join(""))},function(t){var l,u,i=Object.keys(PJF.ui).reduce(function(t,e,n){return t[e.toUpperCase()]=e,t},{}),d={TAB:function(t,e){var n=t.domLoadedCallBack;return t.domLoadedCallBack=function(i){$(e).children("tab-nav").each(function(t){for(var e=this.childNodes.length,n=0;n<e;n++)a(this.childNodes[n],i[t])}),n&&n.apply(this,arguments)},{stop:!0,pjfCom:new PJF.ui[i[e.tagName]](t)}}},c="<{{:domTag}} id='{{:domId}}' {{:attributes}} ></{{:domTag}}>",h={textfield:"input",DEFAULT:"div",linkButton:"a",label:"a"},n={STMTABLE:"table",TABLE:"none",STMLABEL:"label",LABEL:"none"};function m(t){var e=n[t]||t||"";return i[e.toUpperCase()]}function p(t,e,n){for(var i="",o=0;o<t.attributes.length;o++)i+=[t.attributes[o].nodeName,"='",t.attributes[o].nodeValue,"' "].join("");e.dom||(e.dom="x"+PJF.util.generateUUid());var a,s,r=PJF.html.template(c,{domTag:(a=t.tagName,s=m(a),h[s]||h.DEFAULT),attributes:i,domId:e.dom});$(n).append(r)}function f(t,e){return{
stop:!0,pjfCom:new(PJF.ui[m(e.tagName)])(t)}}function a(t,e){var n;if(e=e||t.parentNode,m(t.tagName)){if(function(t,e){var n=$(t).data();p(t,n,e);var i=d[t.tagName]||f,o=$.extend({},n);for(var a in o)"string"==typeof o[a]&&("ctx."==o[a].substr(0,4)?o[a]=PJF.util.getValue(l,o[a].substr(4)):o[a]=PJF.util.safeParse(o[a]));var s=$(t).attr("pjf-extendConf");s&&$.extend(o,PJF.util.getValue(l,s));var r=i(o,t),c=$(t).attr("pjf-name");return c&&(u[c]=r.pjfCom),r}(t,e).stop)return}else n=t.cloneNode(!1),e.appendChild(n);for(var i=t.childNodes.length,o=0;o<i;o++)a(t.childNodes[o],n||t)}t.tagScan=function(t,e,n){return"string"==typeof t&&(t="#"+t),l=e||{},u=n||{},$(t).each(function(t,e){a(e)}),$(t).remove(),u}}(PJF.html),PJF.namespace("PJF.monitor"),function(t){var e,n,i,o=0,a=0,s=!!document.addEventListener;_eventEnd=function(){window.template&&template.getLocation&&"homepage"===template.getLocation()?_restartMonitor():0!=a||0!=o?_stopClickMonitor():_startClickMonitor()};var r,c=function(){
_restartMonitor()};_startClickMonitor=function(){e=setInterval(function(){console.log("over 90000 no reaction"),PJF.event.publish(PJF.stmEvent.OVER_60_NO_REACTION,90)},9e4),n=setInterval(function(){console.log("over 30s no reaction"),PJF.event.publish("OVER_30_NO_REACTION",30)},3e4),i=setInterval(function(){if(PJF.otherInfo.isSelfBank&&PJF.otherInfo.hasDoor){console.log("over 20s no reaction selfbank");var t=template.getLocation();if(-1===PJF.constants.NO_SELF_SMART.indexOf(t)&&!PJF.ui.componentMgr.get("stm_monitor_selfbank_20s_errmsgbox")){if(r==t)return;r=t,PJF.communication.player.SpeekText("如果您有问题可以点工作人员",100),new PJF.ui.errorMessageBox({id:"stm_monitor_selfbank_20s_errmsgbox",content:'尊敬的客户, 若您需要帮助您可以点击屏幕上红色"工作人员"按钮, 将有远程工作人员视频为您指导',buttonConfs:[{appendStyle:"confirm",style:"main",bgColor:"rgb(20,149,214)",name:"我知道了",onClick:function(){}}]})}}},2e4),$(document).on("input.stmMonitor",function(t){_restartMonitor()}),
s?document.addEventListener("click",c,!0):$(document).on("click.stmMonitor",c)},_stopClickMonitor=function(){clearInterval(e),clearInterval(n),clearInterval(i),$(document).off(".stmMonitor"),s&&document.removeEventListener("click",c,!0)},_restartMonitor=function(){_stopClickMonitor(),_startClickMonitor()},t.startClickMonitor=function(){PJF.event.addSubscriber(PJF.stmEvent.PJF_STM_CALL_DEVICE,function(){a++,_eventEnd()}),PJF.event.addSubscriber(PJF.stmEvent.PJF_STM_CALL_DEVICE_BACK,function(){a--,_eventEnd()}),PJF.event.addSubscriber(PJF.stmEvent.PJF_STM_LOCK,function(){o++,_eventEnd()}),PJF.event.addSubscriber(PJF.stmEvent.PJF_STM_UNLOCK,function(){o--,_eventEnd()}),_startClickMonitor()},t.startDeviceEventMonitor=function(){PJF.event.addSubscriber(PJF.PadClientEvents.device.genDeviceEvent,function(){console.log("外设返回事件:"+JSON.stringify(arguments)),PJF.stm.client.eventHandler.apply(window,arguments)}),PJF.event.addSubscriber("STM_PAGE_CHANGE",function(){}),
PJF.event.addSubscriber(PJF.stm.client.events.IDC_TAKEN,function(){PJF.stm.util.clearAuthInfo(),PJF.fsm.get(PJF.fsm.fmIds.STM_IDCARD).takeId()}),PJF.event.addSubscriber(PJF.stm.client.events.CDB_INHALED,function(){PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).inhaleCard(),PJF.stm.util.devIdleLog()}),PJF.event.addSubscriber(PJF.stm.client.events.IDC_INHALED,function(){PJF.fsm.get(PJF.fsm.fmIds.STM_IDCARD).inhaleId(),PJF.stm.util.devIdleLog()}),PJF.event.addSubscriber(PJF.stm.client.events.CDB_TAKEN,function(){PJF.stm.util.clearAuthInfo(!0),PJF.stm.util.clearCardInfo(),PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).takeCard(),PJF.stm.util.modSmartMenus()}),PJF.event.addSubscriber(PJF.stm.client.events.HMI_CHANGE,function(t){if(PJF.otherInfo&&PJF.fsm.get(PJF.fsm.fmIds.STM_ICCARD).is("noCard")&&template.getLocation&&"homepage"==template.getLocation()){var o=PJF.util.generateUUid();if($("body").append('<div id="'+o+'_smart"></div>').append('<div id="'+o+'_self"></div>'),
PJF.otherInfo.smartBank&&!PJF.otherInfo.isSelfBank)if("0"==t)PJF.stm.util.modSmartMenus();else{var n=function(i){PJF.stm.SXT.closeCamera({iIndex:1,loadingConf:!1},function(t){if(1==t.status){if(console.log("close success"),$("#"+o+"_smart").remove(),!i)return;var e=PJF.util.getPic("/identity/"+o+"_smart.JPG"),n={Eqmt_ID:PJF.otherInfo.devId,BO_ID:PJF.roleInfo.orgCode,serviceName:"receivePic",JID:PJF.otherInfo.devId+"stm",src:e,Scn_Idr:"007",Ovrlsttn_Trck_No:PJF.roleInfo.orgCode+PJF.otherInfo.devId+Math.random().toString().substr(2,15)};PJF.stm.util.sendSocketReq(JSON.stringify(n),null,null)}else console.log("close failure"),a()})},a=function(){$("#"+o+"_smart").remove(),PJF.stm.util.getSmartMenus("ACC10001|SIG20001|TRM20001|ZHC20001|CRD20003")};PJF.stm.SXT.openCamera({domId:o+"_smart",timeout:30,iIndex:1,loadingConf:!1},function(t){var e;1==t.status?(console.log("open camera success"),e={iIndex:1,imageType:2,iExpRate:70,timeout:30,
pchPhotoPath:PJF.stm.baseDir+"/identity/"+o+"_smart.JPG",loadingConf:!1},PJF.stm.SXT.takePhoto(e,function(t){1==t.status?(console.log("take photo success"),n(!0)):(console.log("take photo failure"),n(),a())})):(console.log("open camera failure"),n(),a())})}if(PJF.otherInfo.isSelfBank&&PJF.constants.lhaDebug)if("1"==t){var e=function(){PJF.stm.LHA.endDetect(function(t){t.status?i(!0):(console.log("end fail:"+JSON.stringify(t)),i())},{loadingConf:!1})},i=function(n){PJF.stm.LHA.closeCamera(function(t){if(t.status){if(console.log("close success"),$("#"+o+"_self").remove(),!n)return;var e={Eqmt_ID:PJF.otherInfo.devId,Stm_Chnl_ID:"2019",Stm_Chnl_Txn_CD:"2019-NALL",Br_ID:PJF.orgInfo.instLevel1BranchId,Br_ID_Inf:PJF.roleInfo.orgCode,base64_Ecrp_Txn_Inf:PJF.util.getPic("/identity/"+o+"_self.JPG")};PJF.communication.cpsJsonReq({jsonData:JSON.stringify(e),fwServiceId:"simpleTransaction",fwTranId:"A0161W608-stm",success:function(t){console.log("A0161W608 success:"+JSON.stringify(t)),
t.MEDM_AU_SET&&(PJF.stm.util.getQRQM(t.MEDM_AU_SET.Cst_ID),PJF.otherInfo.snInfo={},PJF.otherInfo.snInfo.cstId=t.MEDM_AU_SET.Cst_ID,PJF.otherInfo.snInfo.name=t.MEDM_AU_SET.Cst_Nm,PJF.otherInfo.snInfo.identity=t.MEDM_AU_SET.Crdt_No,PJF.otherInfo.snInfo.tpCd=t.MEDM_AU_SET.CrdTp_Cd)},failure:function(t){console.log("A0161W608 failure:"+JSON.stringify(t))}})}else console.log("close failure")},{loadingConf:!1})};PJF.stm.LHA.openCamera({domId:o+"_self",left:"0",top:"0",width:"0",height:"0",loadingConf:!1},function(t){t.status?PJF.stm.LHA.startDetect({motion:0,photoPath:PJF.stm.baseDir+"/identity/"+o+"_self.JPG",timeout:10,loadingConf:!1,noSound:!0,detectWidth:100,detectHeight:100,saveFaceOnly:1},function(t){t.status?e():(console.log("detect fail:"+JSON.stringify(t)),i())}):(console.log("open fail:"+JSON.stringify(t)),i())})}else PJF.stm.LHA.closeCamera(function(t){console.log("homepage close camera:"+JSON.stringify(t))},{loadingConf:!1})}})},t.startFsm=function(){PJF.fsm.create({
id:PJF.fsm.fmIds.STM_CAMERA,initial:"close",done:"close",actions:[{name:"openCamera",from:"close",to:"open"},{name:"closeCamera",from:"open",to:"close"}]}),PJF.fsm.create({id:PJF.fsm.fmIds.STM_SIGNATURE,initial:"close",done:"close",actions:[{name:"openSignature",from:"close",to:"open"},{name:"closeSignature",from:"open",to:"close"}]}),PJF.fsm.create({id:PJF.fsm.fmIds.STM_ICCARD,initial:"noCard",done:"noCard",actions:[{name:"inhaleCard",from:"noCard",to:"hasCard"},{name:"takeCard",from:"hasCard",to:"noCard"}]}),PJF.fsm.create({id:PJF.fsm.fmIds.STM_IDCARD,initial:"noId",done:"noId",actions:[{name:"inhaleId",from:"noId",to:"hasId"},{name:"takeId",from:"hasId",to:"noId"}]}),PJF.fsm.create({id:PJF.fsm.fmIds.STM_PRT,initial:"noPassbook",done:"noPassbook",actions:[{name:"inhalePassbook",from:"noPassbook",to:"hasPassbook"},{name:"ejectPassbook",from:"hasPassbook",to:"noPassbook"}]})}}(PJF.monitor),PJF.namespace("PJF.stmRemoteControl"),PJF.stmRemoteControl={enableMonitor:function(){
var i=this,o=18e4,a=setInterval(function(){var t={dev_ID:PJF.otherInfo.devId};console.log("接收远程指令请求参数为"+JSON.stringify(t));var e=PJF.constants.AUTH_SERVER+"/bosWeb/ecpJson.action",n="jsonData="+JSON.stringify(t)+"&_fw_service_id=getSTMDevCnConfDB";PJF.communication.Http.SendCrossDomainRequest(e,n,3e4,function(t,e){if(console.log("跨域返回结果,status:"+t+";responseData:"+e),(t=JSON.parse(t)).success&&e)if((e=JSON.parse(e))&&e.BK_STATUS&&e.BK_STATUS==PJF.constants.BK_CODE_SUCCESS)if(console.log("接收远程指令成功"),"0"===e.cmd)console.log("等待远程控管状态");else{function n(){PJF.fsm.get([PJF.fsm.fmIds.STM_IDCARD]).is("noId")?i.errMsgHandler(e.cmd):setTimeout(function(){i.errMsgHandler(e.cmd)},o)}clearInterval(a),PJF.fsm.get([PJF.fsm.fmIds.STM_ICCARD]).is("noCard")?n():setTimeout(function(){n()},o)}else console.log("接收远程指令失败");else console.log("通信失败，接收远程指令")})},12e5)},errMsgHandler:function(t,e){var n=this,i=new PJF.ui.errorMessageBox({
content:"尊敬的客户，因设备出现异常状态，需要重启或退出应用，如您还有业务未完成，请选择“我还未完成业务”，并请在完成后选择其他设备继续您的业务，如您已结束交易，则选择“我已完成业务”，谢谢您的配合。",buttonConfs:[{name:"我还未完成业务",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){clearTimeout(o),e?setTimeout(function(){n.cmdHandler(t)},18e4):setTimeout(function(){n.errMsgHandler(t,!0)},18e4)}},{name:"我已完成业务",style:"main",btnBgColor:"rgb(65,159,245)",onClick:function(){clearTimeout(o),n.cmdHandler(t)}}]}),o=setTimeout(function(){i.destroy(),n.cmdHandler(t)},2e4)},cmdHandler:function(t){switch(t){case"1":PJF.communication.fileSystem.runWinCmd("shutdown -r");break;case"2":PJF.communication.fileSystem.runWinCmd("shutdown -s");break;case"3":PJF.communication.AppRestart();break;case"4":PJF.communication.AppExit();break;default:console.log("远程控管指令错误,cmd为"+t)}}},PJF.namespace("PJF.sm4Auth"),function(){
var n,o="_pjf_stm_registersm4_date",a=PJF.communication.getServerTime()||PJF.util.formatDate(new Date),i=["VTM600S-Z","BST808C","ZT2189","ZT2190","CASHWAY35AG-JR1","CASHWAY35AG-JR2","SCM750","CTM900"];PJF.sm4Auth.register=function(e){PJF.util.getValue(window,"PJF.otherInfo.sysParam.SM4_DEVICE_LIST");if((!PJF.util.deviceType.stm||PJF.util.deviceType.tcr||PJF.util.deviceType.icm||-1==i.indexOf(PJF.otherInfo.modelCode))&&(n=!1),void 0===n&&($.ajax({url:"ecpJson.action",timeout:5e3,async:!1,dataType:"json",data:{_fw_service_id:"stm.queryApplicationParam",jsonData:JSON.stringify({param_id:"STM_TERM_KEYT",device_id:PJF.otherInfo.devId,BRANCH_ID:PJF.roleInfo.orgCode,ins_id:PJF.roleInfo.orgCode,OPER_CODE:PJF.otherInfo.devId})},success:function(t){t&&t.RESULT_DATA&&t.RESULT_DATA[0]&&"1"==t.RESULT_DATA[0].KeytSwitch&&(n=!0)}}),n=!!n),n){var t=PJF.communication.localStorage.getValue(o);t.success&&t.result?(t=t.result,console.log("成功获取SM4主密钥注册日期",t),r({registerTime:t,success:function(t){
PJF.otherInfo.sm4Auth=!0,e&&e()},failure:function(t){console.log("sm4认证失败:",JSON.stringify(t)),new PJF.ui.errorMessageBox({content:"sm4认证失败, 请重新注册",detailMsg:t.BK_DESC,buttonConfs:[{style:"main",bgColor:"rgb(20,149,214)",name:"注册",onClick:function(){s(function(){PJF.sm4Auth.register(e)})}},{style:"main",bgColor:"rgb(20,149,214)",name:"退出",onClick:function(){PJF.communication.AppExit()}}]})}})):s(function(){PJF.sm4Auth.register(e)})}else e()};var s=function(e){var n,i,t=JSON.stringify({destNodeId:"120000",deviceId:PJF.otherInfo.devId,macAddr:PJF.otherInfo.MACS&&PJF.otherInfo.MACS[0],registerTime:a,stmGI:PJF.constants.SM4_MAINKEY_INDEX,stmAlg:"4",phoneNumber:"11111111111"});console.log("请求主密钥参数为:",t),PJF.communication.cpsJsonReq({url:"ecpJson",fwServiceId:"getStmDeriveKey",maskAll:!0,jsonData:t,fwTranId:"getStmDeriveKey",success:function(t){console.log("获取主密钥结果为:",JSON.stringify(t)),i=t.key,n=t.password,PJF.stm.Pin.setSM4PrimaryKey({pchPassword:n,pchKey:i},function(t){
0==t.status?new PJF.ui.errorMessageBox({content:"sm4灌注密钥失败",detailMsg:t.errorCode+","+t.errorMsg,buttonConfs:[{style:"main",bgColor:"rgb(20,149,214)",name:"重新注册",onClick:function(){s(e)}},{style:"main",bgColor:"rgb(20,149,214)",name:"退出",onClick:function(){PJF.communication.AppExit()}}]}):(PJF.communication.localStorage.setValue(o,a),e())})},failure:function(t){console.log(JSON.stringify(t)),new PJF.ui.errorMessageBox({data:t,buttonConfs:[{style:"main",bgColor:"rgb(20,149,214)",name:"重试",onClick:function(){s(e)}},{style:"main",bgColor:"rgb(20,149,214)",name:"退出",onClick:function(){PJF.communication.AppExit()}}]})}})},r=function(i){var t=JSON.stringify({destNodeId:"120000",deviceId:PJF.otherInfo.devId,macAddr:PJF.otherInfo.MACS&&PJF.otherInfo.MACS[0],deviceRegisterTime:i.registerTime,wkRegisterTime:a,keyType:"1",IMKGI:PJF.constants.SM4_MAINKEY_INDEX,WKGI:PJF.constants.SM4_WORKKEY_INDEX,stmAlg:"4"});console.log("获取工作密钥参数为:",t),PJF.communication.cpsJsonReq({async:i.async,url:"ecpJson",
fwServiceId:"getStmDeriveKeyForWk",maskAll:!0,jsonData:t,fwTranId:"getStmDeriveKeyForWk",success:function(t){console.log("获取工作密钥结果为:",JSON.stringify(t)),PJF.stm.Pin.setSM4WorkKey({pchKey:t.key},function(t){if("0"==t.status)i.failure&&i.failure({BK_STATUS:"01",BK_DESC:t.errorMsg,BK_CODE:t.errorCode});else{var e=PJF.stm.Pin.getEncryptedData({});if(0==e.status)i.failure&&i.failure({BK_STATUS:"01",BK_DESC:e.errorMsg,BK_CODE:e.errorCode});else{var n=JSON.stringify({destNodeId:"120000",deviceId:PJF.otherInfo.devId,macAddr:PJF.otherInfo.MACS&&PJF.otherInfo.MACS[0],registerTime:a,keyType:"1",ARQC:btoa(PJF.util.hexToString(e.info.pchEncryptedData)),plain:btoa(e.info.pchData),IMKGI:PJF.constants.SM4_WORKKEY_INDEX,stmAlg:"4"});console.log("认证SM4参数为:",n),PJF.communication.cpsJsonReq({async:i.async,url:"ecpJson",fwServiceId:"verifyStmARQC",maskAll:!0,jsonData:n,fwTranId:"verifyStmARQC",success:function(t){console.log("验证sm4:",JSON.stringify(t)),
t.code===btoa(PJF.util.hexToString(e.info.pchResponseData))?i.success&&i.success(t):i.failure&&i.failure($.extend(t,{BK_STATUS:"01",BK_DESC:"响应码不匹配，注册失败"}))},failure:i.failure})}}})},failure:i.failure})};PJF.sm4Auth.sm4Authentication=r}(),function(p){p.fn.qrcode=function(l){var n;function e(t){this.mode=n,this.data=t}function u(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function d(t,e){if(null==t.length)throw Error(t.length+"/"+e);for(var n=0;n<t.length&&0==t[n];)n++;this.num=Array(t.length-n+e);for(var i=0;i<t.length-n;i++)this.num[i]=t[i+n]}function h(t,e){this.totalCount=t,this.dataCount=e}function s(){this.buffer=[],this.length=0}e.prototype={getLength:function(){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}},u.prototype={addData:function(t){this.dataList.push(new e(t)),this.dataCache=null},isDark:function(t,e){
if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){if(this.typeNumber<1){var t=1;for(t=1;t<40;t++){for(var e=h.getRSBlocks(t,this.errorCorrectLevel),n=new s,i=0,o=0;o<e.length;o++)i+=e[o].dataCount;for(o=0;o<this.dataList.length;o++)e=this.dataList[o],n.put(e.mode,4),n.put(e.getLength(),m.getLengthInBits(e.mode,t)),e.write(n);if(n.getLengthInBits()<=8*i)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[n][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),
this.setupTypeInfo(t,e),7<=this.typeNumber&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=u.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(this.modules[t+n][e+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},getBestMaskPattern:function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var i=m.getLostPoint(this);(0==n||i<t)&&(t=i,e=n)}return e},createMovieClip:function(t,e,n){for(t=t.createEmptyMovieClip(e,n),this.make(),e=0;e<this.modules.length;e++){n=1*e;for(var i=0;i<this.modules[e].length;i++){var o=1*i;this.modules[e][i]&&(t.beginFill(0,100),t.moveTo(o,n),t.lineTo(o+1,n),t.lineTo(o+1,n+1),t.lineTo(o,n+1),t.endFill())}}return t},setupTimingPattern:function(){
for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=0==t%2);for(t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=0==t%2)},setupPositionAdjustPattern:function(){for(var t=m.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var i=t[e],o=t[n];if(null==this.modules[i][o])for(var a=-2;a<=2;a++)for(var s=-2;s<=2;s++)this.modules[i+a][o+s]=-2==a||2==a||-2==s||2==s||0==a&&0==s}},setupTypeNumber:function(t){for(var e=m.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i}for(n=0;n<18;n++)i=!t&&1==(e>>n&1),this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i},setupTypeInfo:function(t,e){for(var n=m.getBCHTypeInfo(this.errorCorrectLevel<<3|e),i=0;i<15;i++){var o=!t&&1==(n>>i&1);i<6?this.modules[i][8]=o:i<8?this.modules[i+1][8]=o:this.modules[this.moduleCount-15+i][8]=o}for(i=0;i<15;i++)o=!t&&1==(n>>i&1),
i<8?this.modules[8][this.moduleCount-i-1]=o:i<9?this.modules[8][15-i-1+1]=o:this.modules[8][15-i-1]=o;this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var n=-1,i=this.moduleCount-1,o=7,a=0,s=this.moduleCount-1;0<s;s-=2)for(6==s&&s--;;){for(var r=0;r<2;r++)if(null==this.modules[i][s-r]){var c=!1;a<t.length&&(c=1==(t[a]>>>o&1)),m.getMask(e,i,s-r)&&(c=!c),this.modules[i][s-r]=c,-1==--o&&(a++,o=7)}if((i+=n)<0||this.moduleCount<=i){i-=n,n=-n;break}}}},u.PAD0=236,u.PAD1=17,u.createData=function(t,e,n){e=h.getRSBlocks(t,e);for(var i=new s,o=0;o<n.length;o++){var a=n[o];i.put(a.mode,4),i.put(a.getLength(),m.getLengthInBits(a.mode,t)),a.write(i)}for(o=t=0;o<e.length;o++)t+=e[o].dataCount;if(i.getLengthInBits()>8*t)throw Error("code length overflow. ("+i.getLengthInBits()+">"+8*t+")");for(i.getLengthInBits()+4<=8*t&&i.put(0,4);0!=i.getLengthInBits()%8;)i.putBit(!1);for(;!(i.getLengthInBits()>=8*t)&&(i.put(u.PAD0,8),!(i.getLengthInBits()>=8*t));)i.put(u.PAD1,8)
;return u.createBytes(i,e)},u.createBytes=function(t,e){for(var n=0,i=0,o=0,a=Array(e.length),s=Array(e.length),r=0;r<e.length;r++){var c=e[r].dataCount,l=e[r].totalCount-c;i=Math.max(i,c),o=Math.max(o,l);a[r]=Array(c);for(var u=0;u<a[r].length;u++)a[r][u]=255&t.buffer[u+n];for(n+=c,u=m.getErrorCorrectPolynomial(l),c=new d(a[r],u.getLength()-1).mod(u),s[r]=Array(u.getLength()-1),u=0;u<s[r].length;u++)l=u+c.getLength()-s[r].length,s[r][u]=0<=l?c.get(l):0}for(u=r=0;u<e.length;u++)r+=e[u].totalCount;for(n=Array(r),u=c=0;u<i;u++)for(r=0;r<e.length;r++)u<a[r].length&&(n[c++]=a[r][u]);for(u=0;u<o;u++)for(r=0;r<e.length;r++)u<s[r].length&&(n[c++]=s[r][u]);return n},n=4;for(var m={
PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=m.getBCHDigit(e)-m.getBCHDigit(m.G15);)e^=m.G15<<m.getBCHDigit(e)-m.getBCHDigit(m.G15);return(t<<10|e)^m.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=m.getBCHDigit(e)-m.getBCHDigit(m.G18);)e^=m.G18<<m.getBCHDigit(e)-m.getBCHDigit(m.G18);return t<<12|e},
getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return m.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case 0:return 0==(e+n)%2;case 1:return 0==e%2;case 2:return 0==n%3;case 3:return 0==(e+n)%3;case 4:return 0==(Math.floor(e/2)+Math.floor(n/3))%2;case 5:return 0==e*n%2+e*n%3;case 6:return 0==(e*n%2+e*n%3)%2;case 7:return 0==(e*n%3+(e+n)%2)%2;default:throw Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new d([1],0),n=0;n<t;n++)e=e.multiply(new d([1,o.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case 1:return 10;case 2:return 9;case n:case 8:return 8;default:throw Error("mode:"+t)}else if(e<27)switch(t){case 1:return 12;case 2:return 11;case n:return 16;case 8:return 10;default:throw Error("mode:"+t)}else{if(!(e<41))throw Error("type:"+e);switch(t){case 1:return 14;case 2:return 13;case n:return 16;case 8:return 12;default:throw Error("mode:"+t)}}},
getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,i=0;i<e;i++)for(var o=0;o<e;o++){for(var a=0,s=t.isDark(i,o),r=-1;r<=1;r++)if(!(i+r<0||e<=i+r))for(var c=-1;c<=1;c++)o+c<0||e<=o+c||0==r&&0==c||s==t.isDark(i+r,o+c)&&a++;5<a&&(n+=3+a-5)}for(i=0;i<e-1;i++)for(o=0;o<e-1;o++)a=0,t.isDark(i,o)&&a++,t.isDark(i+1,o)&&a++,t.isDark(i,o+1)&&a++,t.isDark(i+1,o+1)&&a++,(0==a||4==a)&&(n+=3);for(i=0;i<e;i++)for(o=0;o<e-6;o++)t.isDark(i,o)&&!t.isDark(i,o+1)&&t.isDark(i,o+2)&&t.isDark(i,o+3)&&t.isDark(i,o+4)&&!t.isDark(i,o+5)&&t.isDark(i,o+6)&&(n+=40);for(o=0;o<e;o++)for(i=0;i<e-6;i++)t.isDark(i,o)&&!t.isDark(i+1,o)&&t.isDark(i+2,o)&&t.isDark(i+3,o)&&t.isDark(i+4,o)&&!t.isDark(i+5,o)&&t.isDark(i+6,o)&&(n+=40);for(o=a=0;o<e;o++)for(i=0;i<e;i++)t.isDark(i,o)&&a++;return n+10*(t=Math.abs(100*a/e/e-50)/5)}},o={glog:function(t){if(t<1)throw Error("glog("+t+")");return o.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;256<=t;)t-=255;return o.EXP_TABLE[t]},EXP_TABLE:Array(256),
LOG_TABLE:Array(256)},t=0;t<8;t++)o.EXP_TABLE[t]=1<<t;for(t=8;t<256;t++)o.EXP_TABLE[t]=o.EXP_TABLE[t-4]^o.EXP_TABLE[t-5]^o.EXP_TABLE[t-6]^o.EXP_TABLE[t-8];for(t=0;t<255;t++)o.LOG_TABLE[o.EXP_TABLE[t]]=t;return d.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<t.getLength();i++)e[n+i]^=o.gexp(o.glog(this.get(n))+o.glog(t.get(i)));return new d(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=o.glog(this.get(0))-o.glog(t.get(0)),n=Array(this.getLength()),i=0;i<this.getLength();i++)n[i]=this.get(i);for(i=0;i<t.getLength();i++)n[i]^=o.gexp(o.glog(t.get(i))+e);return new d(n,0).mod(t)}},
h.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],
h.getRSBlocks=function(t,e){var n=h.getRsBlockTable(t,e);if(null==n)throw Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var i=n.length/3,o=[],a=0;a<i;a++)for(var s=n[3*a+0],r=n[3*a+1],c=n[3*a+2],l=0;l<s;l++)o.push(new h(r,c));return o},h.getRsBlockTable=function(t,e){switch(e){case 1:return h.RS_BLOCK_TABLE[4*(t-1)+0];case 0:return h.RS_BLOCK_TABLE[4*(t-1)+1];case 3:return h.RS_BLOCK_TABLE[4*(t-1)+2];case 2:return h.RS_BLOCK_TABLE[4*(t-1)+3]}},s.prototype={get:function(t){return 1==(this.buffer[Math.floor(t/8)]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},"string"==typeof l&&(l={text:l}),l=p.extend({},{render:"canvas",width:256,height:256,typeNumber:-1,correctLevel:2,background:"#ffffff",foreground:"#000000"},l),this.each(function(){
var t;if("canvas"==l.render){(t=new u(l.typeNumber,l.correctLevel)).addData(l.text),t.make();var e=document.createElement("canvas");e.width=l.width,e.height=l.height;for(var n=e.getContext("2d"),i=l.width/t.getModuleCount(),o=l.height/t.getModuleCount(),a=0;a<t.getModuleCount();a++)for(var s=0;s<t.getModuleCount();s++){n.fillStyle=t.isDark(a,s)?l.foreground:l.background;var r=Math.ceil((s+1)*i)-Math.floor(s*i),c=Math.ceil((a+1)*i)-Math.floor(a*i);n.fillRect(Math.round(s*i),Math.round(a*o),r,c)}}else for((t=new u(l.typeNumber,l.correctLevel)).addData(l.text),t.make(),e=p("<table></table>").css("width",l.width+"px").css("height",l.height+"px").css("border","0px").css("border-collapse","collapse").css("background-color",l.background),n=l.width/t.getModuleCount(),i=l.height/t.getModuleCount(),o=0;o<t.getModuleCount();o++)for(a=p("<tr></tr>").css("height",i+"px").appendTo(e),
s=0;s<t.getModuleCount();s++)p("<td></td>").css("width",n+"px").css("background-color",t.isDark(o,s)?l.foreground:l.background).appendTo(a);t=e,jQuery(t).appendTo(this)})}}(jQuery),function(n){function i(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var o={};i.m=n,i.c=o,i.i=function(t){return t},i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=12)}([function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0});var o,a=e.SET_A=0,s=e.SET_B=1,r=e.SET_C=2,c=(e.SHIFT=98,e.START_A=103),l=e.START_B=104,u=e.START_C=105;e.MODULO=103,e.STOP=106,
e.SET_BY_CODE=(i(o={},c,a),i(o,l,s),i(o,u,r),o),e.SWAP={101:a,100:s,99:r},e.A_START_CHAR=String.fromCharCode(208),e.B_START_CHAR=String.fromCharCode(209),e.C_START_CHAR=String.fromCharCode(210),e.A_CHARS="[\0-_È-Ï]",e.B_CHARS="[ -È-Ï]",e.C_CHARS="(Ï*[0-9]{2}Ï*)",
e.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]
},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};e.default=function(t,e){return i({},t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),a=n(13),s=(i=a)&&i.__esModule?i:{default:i},c=n(0),r=function(t){function r(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e
}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t.substring(1),e));return n.bytes=t.split("").map(function(t){return t.charCodeAt(0)}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(r,s.default),o(r,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var t=this.bytes,e=t.shift()-105,n=c.SET_BY_CODE[e];if(void 0===n)throw new RangeError("The encoding does not start with a start character.");var i=r.next(t,1,n);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:r.getBar(e)+i.result+r.getBar((i.checksum+e)%c.MODULO)+r.getBar(c.STOP)}}}],[{key:"getBar",value:function(t){return c.BARS[t]?c.BARS[t].toString():""}},{
key:"correctIndex",value:function(t,e){if(e===c.SET_A){var n=t.shift();return n<32?n+64:n-32}return e===c.SET_B?t.shift()-32:10*(t.shift()-48)+t.shift()-48}},{key:"next",value:function(t,e,n){if(!t.length)return{result:"",checksum:0};var i=void 0,o=void 0;if(200<=t[0]){o=t.shift()-105;var a=c.SWAP[o];void 0!==a?i=r.next(t,e+1,a):(n!==c.SET_A&&n!==c.SET_B||o!==c.SHIFT||(t[0]=n===c.SET_A?95<t[0]?t[0]-96:t[0]:t[0]<32?t[0]+96:t[0]),i=r.next(t,e+1,n))}else o=r.correctIndex(t,n),i=r.next(t,e+1,n);var s=o*e;return{result:r.getBar(o)+i.result,checksum:s+i.checksum}}}]),r}();e.default=r},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){
if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function i(t,e){o(this,i);var n=a(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return n.name="InvalidInputException",n.symbology=t,n.input=e,n.message='"'+n.input+'" is not a valid input for '+n.symbology,n}return s(i,Error),i}(),r=function(t){function e(){o(this,e);var t=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return s(e,Error),e}(),c=function(t){function e(){o(this,e);var t=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}
return s(e,Error),e}();e.InvalidInputException=i,e.InvalidElementException=r,e.NoElementException=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var n in e)e.hasOwnProperty(n)&&"string"==typeof t[n=e[n]]&&(t[n]=parseInt(t[n],10));return"string"==typeof t.displayValue&&(t.displayValue="false"!=t.displayValue),t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}}},function(t,e,n){"use strict";function c(t,e){
return e.height+(e.displayValue&&0<t.text.length?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function l(t,e,n){if(n.displayValue&&e<t){if("center"==n.textAlign)return Math.floor((t-e)/2);if("left"==n.textAlign)return 0;if("right"==n.textAlign)return Math.floor(t-e)}return 0}function u(t,e,n){var i;if(n)i=n;else{if("undefined"==typeof document)return 0;i=document.createElement("canvas").getContext("2d")}return i.font=e.fontOptions+" "+e.fontSize+"px "+e.font,i.measureText(t).width}Object.defineProperty(e,"__esModule",{value:!0}),e.getTotalWidthOfEncodings=e.calculateEncodingAttributes=e.getBarcodePadding=e.getEncodingHeight=e.getMaximumHeightOfEncodings=void 0;var i,o=n(1),d=(i=o)&&i.__esModule?i:{default:i};e.getMaximumHeightOfEncodings=function(t){for(var e=0,n=0;n<t.length;n++)t[n].height>e&&(e=t[n].height);return e},e.getEncodingHeight=c,e.getBarcodePadding=l,e.calculateEncodingAttributes=function(t,e,n){for(var i=0;i<t.length;i++){var o,a=t[i],s=(0,d.default)(e,a.options)
;o=s.displayValue?u(a.text,s,n):0;var r=a.data.length*s.width;a.width=Math.ceil(Math.max(o,r)),a.height=c(a,s),a.barcodePadding=l(o,r,s)}},e.getTotalWidthOfEncodings=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n].width;return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(19);e.default={CODE128:i.CODE128,CODE128A:i.CODE128A,CODE128B:i.CODE128B,CODE128C:i.CODE128C}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),o=function(){function e(t){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,e),this.api=t}return i(e,[{key:"handleCatch",value:function(t){if("InvalidInputException"!==t.name)throw t
;if(this.api._options.valid===this.api._defaults.valid)throw t.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(t){try{var e=t.apply(void 0,arguments);return this.api._options.valid(!0),e}catch(t){return this.handleCatch(t),this.api}}}]),e}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t.marginTop=t.marginTop||t.margin,t.marginBottom=t.marginBottom||t.margin,t.marginRight=t.marginRight||t.margin,t.marginLeft=t.marginLeft||t.margin,t}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function a(t){if("string"==typeof t)return function(t){var e=document.querySelectorAll(t);if(0!==e.length){for(var n=[],i=0;i<e.length;i++)n.push(a(e[i]));return n}}(t);if(Array.isArray(t)){for(var e=[],n=0;n<t.length;n++)e.push(a(t[n]));return e}if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLImageElement)return i=t,{
element:o=document.createElement("canvas"),options:(0,r.default)(i),renderer:c.default.CanvasRenderer,afterRender:function(){i.setAttribute("src",o.toDataURL())}};var i,o;if(t&&"svg"===t.nodeName||"undefined"!=typeof SVGElement&&t instanceof SVGElement)return{element:t,options:(0,r.default)(t),renderer:c.default.SVGRenderer};if("undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement)return{element:t,options:(0,r.default)(t),renderer:c.default.CanvasRenderer};if(t&&t.getContext)return{element:t,renderer:c.default.CanvasRenderer};if(t&&"object"===(void 0===t?"undefined":s(t))&&!t.nodeName)return{element:t,renderer:c.default.ObjectRenderer};throw new l.InvalidElementException}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(n(20)),c=i(n(22)),l=n(3);e.default=a
},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var i=[];return function t(e){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else e.text=e.text||"",e.data=e.data||"",i.push(e)}(t),i}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n){var i=new e(t=""+t,n);if(!i.valid())throw new p.InvalidInputException(i.constructor.name,t);var o=i.encode();o=(0,r.default)(o);for(var a=0;a<o.length;a++)o[a].options=(0,l.default)(n,o[a].options);return o}function o(){return s.default.CODE128?"CODE128":Object.keys(s.default)[0]}function a(t,e,n){e=(0,r.default)(e);for(var i=0;i<e.length;i++)e[i].options=(0,l.default)(n,e[i].options),(0,u.default)(e[i].options);(0,u.default)(n),new(0,t.renderer)(t.element,e,n).render(),t.afterRender&&t.afterRender()}var s=i(n(7)),l=i(n(1)),r=i(n(11)),u=i(n(9)),d=i(n(10)),h=i(n(4)),m=i(n(8)),p=n(3),f=i(n(5)),g=function(){},P=function(t,e,n){var i=new g
;if(void 0===t)throw Error("No element to render on was provided.");return i._renderProperties=(0,d.default)(t),i._encodings=[],i._options=f.default,i._errorHandler=new m.default(i),void 0!==e&&((n=n||{}).format||(n.format=o()),i.options(n)[n.format](e,n).render()),i};for(var v in P.getModule=function(t){return s.default[t]},s.default)s.default.hasOwnProperty(v)&&function(s,r){g.prototype[r]=g.prototype[r.toUpperCase()]=g.prototype[r.toLowerCase()]=function(i,o){var a=this;return a._errorHandler.wrapBarcodeCall(function(){o.text=void 0===o.text?void 0:""+o.text;var t=(0,l.default)(a._options,o);t=(0,h.default)(t);var e=s[r],n=c(i,e,t);return a._encodings.push(n),a})}}(s.default,v);g.prototype.options=function(t){return this._options=(0,l.default)(this._options,t),this},g.prototype.blank=function(t){var e=new Array(t+1).join("0");return this._encodings.push({data:e}),this},g.prototype.init=function(){var e
;if(this._renderProperties)for(var t in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){e=this._renderProperties[t];var n=(0,l.default)(this._options,e.options);"auto"==n.format&&(n.format=o()),this._errorHandler.wrapBarcodeCall(function(){var t=c(n.value,s.default[n.format.toUpperCase()],n);a(e,t,n)})}},g.prototype.render=function(){if(!this._renderProperties)throw new p.NoElementException;if(Array.isArray(this._renderProperties))for(var t=0;t<this._renderProperties.length;t++)a(this._renderProperties[t],this._encodings,this._options);else a(this._renderProperties,this._encodings,this._options);return this},g.prototype._defaults=f.default,"undefined"!=typeof window&&(window.JsBarcode=P),"undefined"!=typeof jQuery&&(jQuery.fn.JsBarcode=function(t,e){var n=[];return jQuery(this).each(function(){n.push(this)}),P(n,t,e)}),t.exports=P},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})
;e.default=function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.data=e,this.text=n.text||e,this.options=n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),a=n(2),s=(i=a)&&i.__esModule?i:{default:i},r=n(0),c=function(t){function n(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,r.A_START_CHAR+t,e))}return function(t,e){
if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,s.default),o(n,[{key:"valid",value:function(){return new RegExp("^"+r.A_CHARS+"+$").test(this.data)}}]),n}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),a=n(2),s=(i=a)&&i.__esModule?i:{default:i},r=n(0),c=function(t){function n(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){
if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,r.B_START_CHAR+t,e))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,s.default),o(n,[{key:"valid",value:function(){return new RegExp("^"+r.B_CHARS+"+$").test(this.data)}}]),n}();e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}
}(),a=n(2),s=(i=a)&&i.__esModule?i:{default:i},r=n(0),c=function(t){function n(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,r.C_START_CHAR+t,e))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,s.default),o(n,[{key:"valid",value:function(){return new RegExp("^"+r.C_CHARS+"+$").test(this.data)}}]),n}();e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function o(t,e){
if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}Object.defineProperty(e,"__esModule",{value:!0});var a=i(n(2)),s=i(n(18)),r=function(t){function i(t,e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var n=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,(0,s.default)(t),e));else n=o(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e));return o(n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,a.default),i}();e.default=r},function(t,e,n){"use strict";function a(t,e){
var n=e?r.A_CHARS:r.B_CHARS,i=t.match(new RegExp("^("+n+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(i)return i[1]+String.fromCharCode(204)+s(t.substring(i[1].length));var o=t.match(new RegExp("^"+n+"+"))[0];return o.length===t.length?t:o+String.fromCharCode(e?205:206)+a(t.substring(o.length),!e)}function s(t){var e=l(t),n=e.length;if(n===t.length)return t;t=t.substring(n);var i=o(t)>=c(t);return e+String.fromCharCode(i?206:205)+a(t,i)}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=function(t){return t.match(new RegExp("^"+r.A_CHARS+"*"))[0].length},c=function(t){return t.match(new RegExp("^"+r.B_CHARS+"*"))[0].length},l=function(t){return t.match(new RegExp("^"+r.C_CHARS+"*"))[0]};e.default=function(t){var e=void 0;if(2<=l(t).length)e=r.C_START_CHAR+s(t);else{var n=o(t)>c(t);e=(n?r.A_START_CHAR:r.B_START_CHAR)+a(t,n)}return e.replace(/[\xCD\xCE]([\s\S])[\xCD\xCE]/,function(t,e){return String.fromCharCode(203)+e})}},function(t,e,n){"use strict";function i(t){
return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.CODE128C=e.CODE128B=e.CODE128A=e.CODE128=void 0;var o=i(n(17)),a=i(n(14)),s=i(n(15)),r=i(n(16));e.CODE128=o.default,e.CODE128A=a.default,e.CODE128B=s.default,e.CODE128C=r.default},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(4)),a=i(n(5));e.default=function(t){var e={};for(var n in a.default)a.default.hasOwnProperty(n)&&(t.hasAttribute("jsbarcode-"+n.toLowerCase())&&(e[n]=t.getAttribute("jsbarcode-"+n.toLowerCase())),t.hasAttribute("data-"+n.toLowerCase())&&(e[n]=t.getAttribute("data-"+n.toLowerCase())));return e.value=t.getAttribute("jsbarcode-value")||t.getAttribute("data-value"),(0,o.default)(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,
"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),a=n(1),s=(i=a)&&i.__esModule?i:{default:i},r=n(6),c=function(){function i(t,e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,i),this.canvas=t,this.encodings=e,this.options=n}return o(i,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var e=(0,s.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(e,this.encodings[t]),this.drawCanvasText(e,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,r.calculateEncodingAttributes)(this.encodings,this.options,t);var e=(0,r.getTotalWidthOfEncodings)(this.encodings),n=(0,
r.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=e+this.options.marginLeft+this.options.marginRight,this.canvas.height=n,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,e){var n,i=this.canvas.getContext("2d"),o=e.data;n="top"==t.textPosition?t.marginTop+t.fontSize+t.textMargin:t.marginTop,i.fillStyle=t.lineColor;for(var a=0;a<o.length;a++){var s=a*t.width+e.barcodePadding;"1"===o[a]?i.fillRect(s,n,t.width,t.height):o[a]&&i.fillRect(s,n,t.width,t.height*o[a])}}},{key:"drawCanvasText",value:function(t,e){var n,i,o=this.canvas.getContext("2d"),a=t.fontOptions+" "+t.fontSize+"px "+t.font;t.displayValue&&(i="top"==t.textPosition?t.marginTop+t.fontSize-t.textMargin:t.height+t.textMargin+t.marginTop+t.fontSize,o.font=a,"left"==t.textAlign||0<e.barcodePadding?(n=0,
o.textAlign="left"):"right"==t.textAlign?(n=e.width-1,o.textAlign="right"):(n=e.width/2,o.textAlign="center"),o.fillText(e.text,n,i))}},{key:"moveCanvasDrawing",value:function(t){this.canvas.getContext("2d").translate(t.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),i}();e.default=c},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(n(21)),a=i(n(24)),s=i(n(23));e.default={CanvasRenderer:o.default,SVGRenderer:a.default,ObjectRenderer:s.default}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),i=function(){function i(t,e,n){(function(t,e){
if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,i),this.object=t,this.encodings=e,this.options=n}return o(i,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),i}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,o=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}(),a=n(1),s=(i=a)&&i.__esModule?i:{default:i},r=n(6),c="http://www.w3.org/2000/svg",l=function(){function i(t,e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,i),this.svg=t,this.encodings=e,this.options=n,this.document=n.xmlDocument||document}return o(i,[{key:"render",value:function(){var t=this.options.marginLeft;this.prepareSVG();for(var e=0;e<this.encodings.length;e++){
var n=this.encodings[e],i=(0,s.default)(this.options,n.options),o=this.createGroup(t,i.marginTop,this.svg);this.setGroupOptions(o,i),this.drawSvgBarcode(o,i,n),this.drawSVGText(o,i,n),t+=n.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,r.calculateEncodingAttributes)(this.encodings,this.options);var t=(0,r.getTotalWidthOfEncodings)(this.encodings),e=(0,r.getMaximumHeightOfEncodings)(this.encodings),n=t+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(n,e),this.options.background&&this.drawRect(0,0,n,e,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(t,e,n){var i,o=n.data;i="top"==e.textPosition?e.fontSize+e.textMargin:0;for(var a=0,s=0,r=0;r<o.length;r++)s=r*e.width+n.barcodePadding,"1"===o[r]?a++:0<a&&(this.drawRect(s-e.width*a,i,e.width*a,e.height,t),a=0);0<a&&this.drawRect(s-e.width*(a-1),i,e.width*a,e.height,t)}},{key:"drawSVGText",
value:function(t,e,n){var i,o,a=this.document.createElementNS(c,"text");e.displayValue&&(a.setAttribute("style","font:"+e.fontOptions+" "+e.fontSize+"px "+e.font),o="top"==e.textPosition?e.fontSize-e.textMargin:e.height+e.textMargin+e.fontSize,"left"==e.textAlign||0<n.barcodePadding?(i=0,a.setAttribute("text-anchor","start")):"right"==e.textAlign?(i=n.width-1,a.setAttribute("text-anchor","end")):(i=n.width/2,a.setAttribute("text-anchor","middle")),a.setAttribute("x",i),a.setAttribute("y",o),a.appendChild(this.document.createTextNode(n.text)),t.appendChild(a))}},{key:"setSvgAttributes",value:function(t,e){var n=this.svg;n.setAttribute("width",t+"px"),n.setAttribute("height",e+"px"),n.setAttribute("x","0px"),n.setAttribute("y","0px"),n.setAttribute("viewBox","0 0 "+t+" "+e),n.setAttribute("xmlns",c),n.setAttribute("version","1.1"),n.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(t,e,n){var i=this.document.createElementNS(c,"g")
;return i.setAttribute("transform","translate("+t+", "+e+")"),n.appendChild(i),i}},{key:"setGroupOptions",value:function(t,e){t.setAttribute("style","fill:"+e.lineColor+";")}},{key:"drawRect",value:function(t,e,n,i,o){var a=this.document.createElementNS(c,"rect");return a.setAttribute("x",t),a.setAttribute("y",e),a.setAttribute("width",n),a.setAttribute("height",i),o.appendChild(a),a}}]),i}();e.default=l}]),JSLoader.loadJavaScript("/bosWeb/STMServlet?operType=load");